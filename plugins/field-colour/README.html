<!DOCTYPE html>
  <head>
  <!-- INJECTED HEADER -->
  <meta name="viewport" content="width=device-width,maximum-scale=2">
  <link rel="icon" type="image/x-icon" href="/blockly-samples/favicon.ico" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic,500,500italic,700,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://blocklycodelabs.dev/styles/main.css" />
  <link rel="stylesheet" href="/blockly-samples/css/custom.css"/>
  <!-- END INJECTED HEADER -->
    <title>@blockly/field-colour Demo</title>
  </head>
  <body class="root" class="root">
    
  <!-- NAV BAR -->
  <nav id="toolbar">
    <a href="/blockly-samples/" id="arrow-back">
      <i class="material-icons">close</i>
      <img src="https://blocklycodelabs.dev/images/logo_knockout.png" class="logo-devs"
        alt="Blockly logo" />
    </a>

    <div class="title-grow">
      <div class="title">@blockly/field-colour Demo</div>
      <div class="subtitle">A Blockly colour field.</div>
    </div>
    5.0.15

    <a href="https://github.com/google/blockly-samples/blob/master/plugins/field-colour" class="button" target="_blank">View code</a>
    <a href="https://www.npmjs.com/package/@blockly/field-colour" class="button" target="_blank">View on npm</a>
  </nav>
  <!-- END NAV BAR -->
    <main id="main" class="has-tabs">
      <div class="drop-shadow"></div>
      
  <!-- PAGE TABS -->
  <ul id="tabs">
    <li>
      <a href="/blockly-samples/plugins/field-colour/test/index">
        Playground
      </a>
    </li>
    <li>
      <a href="/blockly-samples/plugins/field-colour/README">
        README
      </a>
    </li>
  </ul>
  <!-- END PAGE TABS -->
      
    <article class="article-container site-width">
      <div class="article">
      <h1 id="blocklyfield-colour-built-on-blocklyhttpstinyurlcombuilt-on-blocklyhttpsgithubcomgoogleblockly">@blockly/field-colour <a href="https://github.com/google/blockly"><img src="https://tinyurl.com/built-on-blockly" alt="Built on Blockly" /></a></h1>
<p>A <a href="https://www.npmjs.com/package/blockly">Blockly</a> field and blocks for
choosing and combining colours.</p>
<h2 id="installation">Installation</h2>
<h3 id="yarn">Yarn</h3>
<pre><code>yarn add @blockly/field-colour</code></pre>
<h3 id="npm">npm</h3>
<pre><code>npm install @blockly/field-colour --save</code></pre>
<h2 id="usage">Usage</h2>
<p>If you want to use this field in a block definition, you must install it by
calling <code>registerFieldColour</code> before instantiating your blocks. If another
field is registered under the same name (<code>field_colour</code>), this field will
overwrite it.</p>
<p>If you <a href="#blocks">install the blocks</a> in this package, the field will
automatically be installed.</p>
<h3 id="field">Field</h3>
<p>The colour field stores a string as its <code>value</code>, and a string as its <code>text</code>. Its
<code>value</code> is a string with the format <code>#rrggbb</code>, while its <code>text</code> may be a string
with the format <code>#rgb</code> if possible.</p>
<h4 id="colour-field">Colour field</h4>
<p><img src="https://github.com/google/blockly-samples/raw/master/plugins/field-colour/readme-media/on_block.png" alt="" /></p>
<h4 id="colour-field-with-editor-open">Colour field with editor open</h4>
<p><img src="https://github.com/google/blockly-samples/raw/master/plugins/field-colour/readme-media/with_editor.png" alt="" /></p>
<h4 id="colour-field-on-collapsed-block">Colour field on collapsed block</h4>
<p><img src="https://github.com/google/blockly-samples/raw/master/plugins/field-colour/readme-media/collapsed.png" alt="" /></p>
<h3 id="creation">Creation</h3>
<h4 id="javascript">JavaScript</h4>
<pre><code class="js language-js">import * as Blockly from 'blockly';
import {registerFieldColour} from '@blockly/field-colour';

registerFieldColour();
Blockly.Blocks['test_field_colour'] = {
  init: function () {
    this.appendDummyInput()
      .appendField('colour: ')
      .appendField(
        new FieldColour('#ff4040', null, {
          colourOptions: [
            '#ff4040',
            '#ff8080',
            '#ffc0c0',
            '#4040ff',
            '#8080ff',
            '#c0c0ff',
          ],
          colourTitles: [
            'dark pink',
            'pink',
            'light pink',
            'dark blue',
            'blue',
            'light blue',
          ],
          columns: 3,
        }),
        'FIELDNAME',
      );
  },
};</code></pre>
<h4 id="json">JSON</h4>
<pre><code class="js language-js">import * as Blockly from 'blockly';
import {registerFieldColour} from '@blockly/field-colour';

registerFieldColour();
Blockly.defineBlocksWithJsonArray([
  {
    type: 'test_field_colour',
    message0: 'colour: %1',
    args0: [
      {
        type: 'field_colour',
        name: 'FIELDNAME',
        colour: '#ff4040',
        colourOptions: [
          '#ff4040',
          '#ff8080',
          '#ffc0c0',
          '#4040ff',
          '#8080ff',
          '#c0c0ff',
        ],
        colourTitles: [
          'dark pink',
          'pink',
          'light pink',
          'dark blue',
          'blue',
          'light blue',
        ],
        columns: 3,
      },
    ],
  },
]);</code></pre>
<p>The colour constructor takes in the following:</p>
<ul>
<li>an optional <code>value</code></li>
<li>an optional <a href="#creating-a-colour-validator">validator</a></li>
<li>an optional map of options, including:<ul>
<li><code>colourOptions</code></li>
<li><code>colourTitles</code></li>
<li><code>columns</code></li></ul></li>
</ul>
<p>The <code>value</code> should be a string in the format <code>#rrggbb</code>. If no <code>value</code>
is given or the given <code>value</code> is invalid, the first entry in the
default colours array will be used.</p>
<p>The following options can also be set in JSON:</p>
<ul>
<li><code>colourOptions</code></li>
<li><code>colourTitles</code></li>
<li><code>columns</code></li>
</ul>
<p>Or they can be set using <a href="#editor-options">JavaScript hooks</a>.</p>
<h2 id="customization">Customization</h2>
<h3 id="editor-options">Editor options</h3>
<p>The <code>setColours</code>
function can be used to set the colour options of a colour field. It takes in an
array of colour strings, which must be defined in <code>#rrggbb</code> format, and an
optional array of tooltips. If the tooltip array is not provided, the default
tooltip array will be used.</p>
<p>Tooltips and colours are matched based on array index, not based on value. If
the colours array is longer than the tooltip array, the tooltips for the extra
colours will be their <code>#rrggbb</code> value.</p>
<p>The setColumns function sets the number of columns in the colour picker.</p>
<h4 id="json-1">JSON</h4>
<pre><code class="js language-js">{
  "type": "example_colour",
  "message0": "colour: %1",
  "args0": [
    {
      "type": "field_colour",
      "name": "COLOUR",
      "colour": "#ff4040"
    }
  ],
  "extensions": ["set_colours_extension"]
}</code></pre>
<pre><code class="js language-js">Blockly.Extensions.register('set_colours_extension', function () {
  var field = this.getField('COLOUR');
  field.setColours(
    ['#ff4040', '#ff8080', '#ffc0c0', '#4040ff', '#8080ff', '#c0c0ff'],
    ['dark pink', 'pink', 'light pink', 'dark blue', 'blue', 'light blue'],
  );
  field.setColumns(3);
});</code></pre>
<p>This is done using a JSON
<a href="https://developers.google.com/blockly/guides/create-custom-blocks/extensions">extension</a>.</p>
<h4 id="javascript-1">JavaScript</h4>
<pre><code class="js language-js">Blockly.Blocks['example_colour'] = {
  init: function () {
    var field = new Blockly.FieldColour('#ff4040');
    field.setColours(
      ['#ff4040', '#ff8080', '#ffc0c0', '#4040ff', '#8080ff', '#c0c0ff'],
      ['dark pink', 'pink', 'light pink', 'dark blue', 'blue', 'light blue'],
    );
    field.setColumns(3);
    this.appendDummyInput().appendField('colour:').appendField(field, 'COLOUR');
  },
};</code></pre>
<p><img src="https://github.com/google/blockly-samples/raw/master/plugins/field-colour/readme-media/customized.png" alt="Customized colour field editor" /></p>
<h4 id="creating-a-colour-validator">Creating a colour validator</h4>
<p>Note: For information on validators in general see <a href="https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators">Validators</a>.</p>
<p>A colour field's value is a <code>#rrggbb</code> format string, so any validators must
accept a <code>#rrggbb</code> format string, and return a <code>#rrggbb</code> format string, <code>null</code>,
or <code>undefined</code>.</p>
<p>Here is an example of a validator that changes the colour of the block to match
the colour of the field.</p>
<pre><code>function(newValue) {
  this.getSourceBlock().setColour(newValue);
  return newValue;
}</code></pre>
<h4 id="block-changing-colour-based-on-its-colour-field">Block changing colour based on its colour field</h4>
<p><img src="https://github.com/google/blockly-samples/raw/master/plugins/field-colour/readme-media/validator.gif" alt="" /></p>
<h3 id="blocks">Blocks</h3>
<p>This package also provides four blocks related to the colour field. Each block
has generators in JavaScript, Python, PHP, Lua, and Dart.</p>
<ul>
<li>"colour_blend" takes in two colours and a ratio and outputs a single colour.</li>
<li>"colour_picker" is a simple block with just the colour field and an output.</li>
<li>"colour_random" generates a random colour.</li>
<li>"colour_rgb" generates a colour based on red, green, and blue values.</li>
</ul>
<p>You can install all four blocks by calling <code>installAllBlocks</code>. This will
install the blocks and all of their dependencies, including the colour field.
When calling <code>installAllBlocks</code>—or any of the individual <code>installSomeBlock</code>
functions—you can supply one or more <code>CodeGenerator</code> instances (e.g.
<code>javascriptGenerator</code>), and the install function will also install the correct
generator function for each block for the corresponding language(s).</p>
<pre><code class="js language-js">import {javascriptGenerator} from 'blockly/javascript';
import {dartGenerator} from 'blockly/dart';
import {phpGenerator} from 'blockly/php';
import {pythonGenerator} from 'blockly/python';
import {luaGenerator} from 'blockly/lua';
import {installAllBlocks as installColourBlocks} from '@blockly/field-colour';

// Installs all four blocks, the colour field, and all language generators.
installColourBlocks({
  javascript: javascriptGenerator,
  dart: dartGenerator,
  lua: luaGenerator,
  python: pythonGenerator,
  php: phpGenerator,
});</code></pre>
<p>If you only want to install a single block, you can call that block's
<code>installBlock</code> function. The <code>generators</code> parameter is the same.</p>
<pre><code class="js language-js">import {javascriptGenerator} from 'blockly/javascript';
import {colourBlend} from '@blockly/field-colour';

// Installs the colour_blend block, the colour field,
// and the generator for colour_blend in JavaScript.
colourBlend.installBlock({
  javascript: javascriptGenerator,
});</code></pre>
<h4 id="message-files-and-locales">Message files and locales</h4>
<p>The blocks in this package contain text that can be
<a href="https://developers.google.com/blockly/guides/create-custom-blocks/localize-blocks">localized</a>
into multiple languages. As of August 2024, the relevant messages are
included in the core Blockly language files.</p>
<p>If your blocks show <code>%{BKY_COLOUR_BLEND_TITLE}</code> or similar text instead
of the expected text, make sure that you either:</p>
<ul>
<li>Import the <a href="https://developers.google.com/blockly/guides/configure/web/translations#import_blockly_default_modules">default Blockly modules</a>,
which includes the English langfiles, or</li>
<li>Explicitly <a href="https://developers.google.com/blockly/guides/configure/web/translations#import_blockly_languages">import a language</a>
and call <code>setLocale</code> before using these blocks.</li>
</ul>
<p>For more information on Blockly's approach to localization, see the
<a href="https://developers.google.com/blockly/guides/create-custom-blocks/localize-blocks">Localize Blocks</a>
developer guide.</p>
<h3 id="api-reference">API Reference</h3>
<ul>
<li><code>setColours</code>: Sets the colour options, and optionally the titles for the
options. The colours should be an array of <code>#rrggbb</code> strings.</li>
<li><code>setColumns</code>: Sets the number of columns the dropdown should have.</li>
</ul>
<h2 id="license">License</h2>
<p>Apache 2.0</p>
      </div>
    </article>
  </main>
  <!-- FOOTER  -->
  <footer id="footer">
    <div class="footer-wrapper site-width">
      <div class="link-list">
        <label>Developer Resources</label>
        <ul>
          <li><a target="_blank" href="https://developers.google.com/blockly/guides/overview/">Developer Docs</a></li>
          <li><a target="_blank" href="https://blocklycodelabs.dev/">Codelabs</a></li>
          <li><a target="_blank" href="https://google.github.io/blockly-samples/developer-tools/index.html">Developer
              Tools</a></li>
        </ul>
      </div>
      <div class="link-list">
        <label>Github</label>
        <ul>
          <li><a target="_blank" href="https://github.com/google/blockly/">Blockly Sources</a></li>
          <li><a target="_blank" href="https://github.com/google/blockly-samples/">Blockly Samples</a></li>
        </ul>
      </div>
      <div class="link-list">
        <label>Support</label>
        <ul>
          <li><a target="_blank" href="https://groups.google.com/forum/#!forum/blockly/">Support</a></li>
        </ul>
        <div>Published with <a href="https://pages.github.com">GitHub Pages</a></div>
      </div>
    </div>
  </footer>
  <!-- END FOOTER -->
</body>
 </html>
  