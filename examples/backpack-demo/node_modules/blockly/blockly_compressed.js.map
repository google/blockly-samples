{"version":3,"sources":["core/registry.ts","core/common.ts","core/utils/idgenerator.ts","core/events/utils.ts","core/touch.ts","core/browser_events.ts","core/utils/array.ts","core/utils/dom.ts","core/utils/xml.ts","core/dialog.ts","core/variables.ts","core/utils/deprecation.ts","core/css.ts","core/utils/style.ts","core/utils/svg_math.ts","core/xml.ts","core/serialization/registry.ts","core/serialization/blocks.ts","core/connection.ts","core/utils/math.ts","core/dropdowndiv.ts","core/utils/string.ts","core/tooltip.ts","core/utils/colour.ts","core/utils/parsing.ts","core/widgetdiv.ts","core/field_registry.ts","core/utils/aria.ts","core/field_dropdown.ts","core/utils/object.ts","core/utils/toolbox.ts","core/extensions.ts","core/keyboard_nav/ast_node.ts","core/block_animations.ts","core/clipboard.ts","core/contextmenu.ts","core/utils/svg_paths.ts","core/positionable_helpers.ts","core/shortcut_items.ts","core/procedures.ts","core/renderers/common/debug.ts","core/renderers/common/block_rendering.ts","core/utils.ts","core/variables_dynamic.ts","core/workspace_svg.ts","core/serialization/workspaces.ts","core/bump_objects.ts","core/inject.ts","core/contextmenu_items.ts","core/block_dragger.ts","core/blockly.ts","src/com/google/javascript/jscomp/js/base.js","src/com/google/javascript/jscomp/js/util/defines.js","src/com/google/javascript/jscomp/js/util/defineproperty.js","src/com/google/javascript/jscomp/js/util/global.js","src/com/google/javascript/jscomp/js/util/shouldpolyfill.js","src/com/google/javascript/jscomp/js/util/polyfill.js","src/com/google/javascript/jscomp/js/es6/globalthis.js","src/com/google/javascript/jscomp/js/es6/util/arrayiterator.js","src/com/google/javascript/jscomp/js/es6/symbol.js","src/com/google/javascript/jscomp/js/es6/util/iteratorfromarray.js","src/com/google/javascript/jscomp/js/es6/array/values.js","src/com/google/javascript/jscomp/js/util/owns.js","src/com/google/javascript/jscomp/js/es6/object/values.js","src/com/google/javascript/jscomp/js/es6/array/flat.js","src/com/google/javascript/jscomp/js/es6/object/entries.js","closure/goog/goog.js","closure/goog/base_minimal.js","core/blocks.ts","core/events/events_abstract.ts","core/events/events_ui_base.ts","core/events/events_trashcan_open.ts","core/utils/useragent.ts","core/component_manager.ts","core/events/events_selected.ts","core/input_types.ts","core/utils/size.ts","core/msg.ts","core/events/events_var_base.ts","core/events/events_var_create.ts","core/variable_model.ts","core/utils/coordinate.ts","core/workspace_comment.ts","core/utils/rect.ts","core/utils/svg.ts","core/workspace_comment_svg.ts","core/events/events_block_base.ts","core/events/events_block_change.ts","core/serialization/exceptions.ts","core/serialization/priorities.ts","core/events/events_block_create.ts","core/events/events_block_delete.ts","core/connection_type.ts","core/constants.ts","core/marker_manager.ts","core/utils/sentinel.ts","core/field.ts","core/utils/keycodes.ts","core/menu.ts","core/menuitem.ts","core/events/events_bubble_open.ts","core/scrollbar.ts","core/bubble.ts","core/config.ts","core/icon.ts","core/theme.ts","core/theme/classic.ts","core/options.ts","core/mutator.ts","core/field_label.ts","core/input.ts","core/block.ts","core/comment.ts","core/contextmenu_registry.ts","core/internal_constants.ts","core/keyboard_nav/marker.ts","core/keyboard_nav/cursor.ts","core/keyboard_nav/basic_cursor.ts","core/keyboard_nav/tab_navigate_cursor.ts","core/rendered_connection.ts","core/warning.ts","core/block_svg.ts","core/drag_target.ts","core/delete_area.ts","core/sprites.ts","core/trashcan.ts","core/events/events_toolbox_item_select.ts","core/toolbox/toolbox_item.ts","core/toolbox/category.ts","core/toolbox/separator.ts","core/toolbox/collapsible_category.ts","core/toolbox/toolbox.ts","core/theme/zelos.ts","core/theme/themes.ts","core/events/events_click.ts","core/bubble_dragger.ts","core/workspace_dragger.ts","core/gesture.ts","core/shortcut_registry.ts","core/events/events_theme_change.ts","core/events/events_viewport.ts","core/connection_db.ts","core/grid.ts","core/names.ts","core/renderers/measurables/types.ts","core/renderers/measurables/base.ts","core/renderers/measurables/row.ts","core/renderers/measurables/bottom_row.ts","core/renderers/measurables/connection.ts","core/renderers/measurables/input_connection.ts","core/renderers/measurables/external_value_input.ts","core/renderers/measurables/field.ts","core/renderers/measurables/hat.ts","core/renderers/measurables/icon.ts","core/renderers/measurables/in_row_spacer.ts","core/renderers/measurables/inline_input.ts","core/renderers/measurables/statement_input.ts","core/renderers/measurables/input_row.ts","core/renderers/measurables/jagged_edge.ts","core/renderers/measurables/next_connection.ts","core/renderers/measurables/output_connection.ts","core/renderers/measurables/previous_connection.ts","core/renderers/measurables/round_corner.ts","core/renderers/measurables/spacer_row.ts","core/renderers/measurables/square_corner.ts","core/renderers/measurables/top_row.ts","core/renderers/common/constants.ts","core/renderers/common/debugger.ts","core/renderers/common/drawer.ts","core/renderers/common/info.ts","core/events/events_marker_move.ts","core/renderers/common/marker_svg.ts","core/renderers/common/path_object.ts","core/insertion_marker_manager.ts","core/renderers/common/renderer.ts","core/theme_manager.ts","core/touch_gesture.ts","core/connection_checker.ts","core/events/events_var_delete.ts","core/events/events_var_rename.ts","core/variable_map.ts","core/workspace.ts","core/workspace_audio.ts","core/zoom_controls.ts","core/serialization/variables.ts","core/renderers/zelos/constants.ts","core/renderers/zelos/drawer.ts","core/field_image.ts","core/field_textinput.ts","core/renderers/zelos/measurables/bottom_row.ts","core/renderers/zelos/measurables/inputs.ts","core/renderers/zelos/measurables/row_elements.ts","core/renderers/zelos/measurables/top_row.ts","core/renderers/zelos/info.ts","core/renderers/zelos/marker_svg.ts","core/renderers/zelos/path_object.ts","core/renderers/zelos/renderer.ts","core/renderers/zelos/zelos.ts","core/renderers/thrasos/info.ts","core/renderers/thrasos/renderer.ts","core/renderers/thrasos/thrasos.ts","core/renderers/minimalist/constants.ts","core/renderers/minimalist/drawer.ts","core/renderers/minimalist/info.ts","core/renderers/minimalist/renderer.ts","core/renderers/minimalist/minimalist.ts","core/renderers/geras/constants.ts","core/renderers/geras/highlighter.ts","core/renderers/geras/drawer.ts","core/renderers/geras/highlight_constants.ts","core/renderers/geras/measurables/inline_input.ts","core/renderers/geras/measurables/statement_input.ts","core/renderers/geras/info.ts","core/renderers/geras/path_object.ts","core/renderers/geras/renderer.ts","core/renderers/geras/geras.ts","core/workspace_drag_surface_svg.ts","core/block_drag_surface.ts","core/scrollbar_pair.ts","core/generator.ts","core/flyout_button.ts","core/metrics_manager.ts","core/flyout_metrics_manager.ts","core/flyout_base.ts","core/flyout_vertical.ts","core/flyout_horizontal.ts","core/field_variable.ts","core/field_number.ts","core/field_multilineinput.ts","core/field_label_serializable.ts","core/field_colour.ts","core/field_checkbox.ts","core/field_angle.ts","core/events/events_block_move.ts","core/events/events_comment_base.ts","core/events/events_comment_change.ts","core/events/events_comment_create.ts","core/events/events_comment_delete.ts","core/events/events_comment_move.ts","core/events/events_block_drag.ts","core/events/events_ui.ts","core/events/workspace_events.ts","core/events/events.ts","core/main.js"],"names":["register","type","name","registryItem","opt_allowOverrides","Type","String","trim","Error","toLowerCase","caselessName","typeRegistry","typeMap","nameRegistry","nameMap","Object","create","validate","FIELD","fromJson","unregister","console","warn","getItem","opt_throwIfMissing","msg","hasItem","getClass","getObject","getAllItems","opt_cased","casedRegistry","keys","i","length","key","getClassFromOptions","options","plugin","plugins","toString","typeName","DEFAULT","getWorkspaceById","id","WorkspaceDB_","getAllWorkspaces","workspaces","workspaceId","push","registerWorkspace","workspace","unregisterWorkpace","getMainWorkspace","mainWorkspace","setMainWorkspace","getSelected","selected","setSelected","newSelection","getParentContainer","parentContainer","setParentContainer","newParent","svgResize","parentWorkspace","svg","getParentSvg","cachedSize","getCachedParentSvgSize","div","parentElement","HTMLElement","width","offsetWidth","height","offsetHeight","setAttribute","setCachedParentSvgSize","resize","getBlockTypeCounts","block","opt_stripFollowing","typeCountsMap","descendants","getDescendants","nextBlock","getNextBlock","index","indexOf","splice","checkBlock","jsonInitFactory","jsonDef","jsonInit","defineBlocksWithJsonArray","jsonArray","TEST_ONLY","defineBlocksWithJsonArrayInternal","defineBlocks","createBlockDefinitionsFromJsonArray","blocks","elem","init","definition","Blocks","getNextUniqueId","nextId","genUid","internal","setRecordUndo","newValue","recordUndo","getRecordUndo","fire","event","fireInternal","isEnabled","FIRE_QUEUE","setTimeout","fireNow","queue","filter","eventWorkspace","fireChangeListener","queueIn","forward","slice","reverse","mergedQueue","hash","isNull","isUiEvent","eventType","UI","blockId","join","lastEntry","lastEvent","MOVE","moveEvent","newParentId","newInputName","newCoordinate","CHANGE","element","VIEWPORT_CHANGE","viewportEvent","viewTop","viewLeft","scale","oldScale","CLICK","BUBBLE_OPEN","e","unshift","clearPendingUndo","disable","disabled","enable","getGroup","group","setGroup","state","setGroupInternal","getDescendantIds","ids","descendant","json","eventClass","get","EVENT","disableOrphans","CREATE","getBlockById","initialUndoFlag","parent","getParent","children","child","setEnabled","outputConnection","previousConnection","isDragging","longStart","gesture","longStop","changedTouches","longPid_","button","clientX","clientY","handleRightClick","LONGPRESS","clearTimeout","clearTouchIdentifier","touchIdentifier_","shouldHandleEvent","isMouseOrTouchEvent","checkTouchIdentifier","getTouchIdentifierFromEvent","MouseEvent","PointerEvent","pointerId","undefined","identifier","setClientFromTouch","startsWith","touchPoint","isTouchEvent","splitEventByTouches","events","newEvent","target","stopPropagation","preventDefault","conditionalBind","node","thisObject","func","opt_noCaptureIdentifier","opt_noPreventDefault","wrapFunc","captureIdentifier","call","handled","bindData","globalThis","TOUCH_MAP","addEventListener","touchWrapFunc","preventDef","bind","TouchEvent","unbind","callback","bindDatum","pop","removeEventListener","isTargetInput","isContentEditable","getAttribute","HTMLInputElement","HTMLTextAreaElement","isRightButton","ctrlKey","MAC","mouseToSvg","matrix","svgPoint","createSVGPoint","x","y","getScreenCTM","inverse","matrixTransform","getScrollDeltaPixels","deltaMode","deltaX","deltaY","LINE_MODE_MULTIPLIER","PAGE_MODE_MULTIPLIER","removeElem","arr","value","createSvgElement","attrs","opt_parent","document","createElementNS","SVG_NS","appendChild","addClass","className","classes","removeClasses","classNames","classList","split","removeClass","removeAttribute","hasClass","removeNode","parentNode","removeChild","insertAfter","newNode","refNode","siblingNode","nextSibling","insertBefore","containsNode","compareDocumentPosition","NodeType","DOCUMENT_POSITION_CONTAINED_BY","setCssTransform","transform","style","startTextWidthCache","cacheReference","cacheWidths","stopTextWidthCache","getTextWidth","textElement","textContent","baseVal","getComputedTextLength","getFastTextWidth","fontSize","fontWeight","fontFamily","getFastTextWidthWithSizeString","text","canvasContext","computeCanvas","createElement","body","getContext","font","measureText","measureFontMetrics","span","result","baseline","alignItems","offsetTop","getDocument","xmlDocument","setDocument","tagName","NAME_SPACE","createTextNode","textToDomDocument","parseFromString","oParser","DOMParser","domToText","dom","serializeToString","oSerializer","XMLSerializer","alert","message","opt_callback","alertImplementation","setAlert","alertFunction","confirm","confirmInternal","confirmImplementation","setConfirm","confirmFunction","prompt","defaultValue","promptImplementation","setPrompt","promptFunction","allUsedVarModels","ws","getAllBlocks","variables","Set","blockVariables","getVarModels","j","variable","getId","add","Array","from","values","allDeveloperVariables","getDeveloperVariables","devVars","flyoutCategory","xmlList","registerButtonCallback","createVariableButtonHandler","getTargetWorkspace","blockList","flyoutCategoryBlocks","concat","variableModelList","getVariablesOfType","mostRecentVariable","generateVariableFieldDom","textToDom","sort","VariableModel","compareByName","generateUniqueName","generateUniqueNameInternal","generateUniqueNameFromOptions","VAR_LETTER_OPTIONS","charAt","getAllVariableNames","startChar","usedNames","letters","suffix","letterIndex","inUse","potName","Number","opt_type","promptAndCheckWithAlert","defaultName","promptName","Msg","existing","nameUsedWithAnyType","replace","createVariable","renameVariable","promptText","newName","nameUsedWithOtherType","renameVariableById","defaultText","newVar","allVariables","getVariableMap","getAllVariables","variableModel","field","getOrCreateVariablePackage","opt_name","getVariable","potentialVariableMap","getPotentialVariableMap","getVariableById","isFlyout","targetWorkspace","getAddedVariables","originalVariables","allCurrentVariables","addedVariables","deprecationDate","deletionDate","opt_use","cssContent","injected","isArray","content","inject","hasCss","pathToMedia","mediaPath","cssNode","cssTextNode","head","firstChild","getSize","getSizeInternal","getComputedStyle","getSizeWithDisplay","originalDisplay","display","originalVisibility","visibility","originalPosition","position","Size","property","styles","window","getPropertyValue","getCascadedStyle","currentStyle","getPageOffset","el","pos","Coordinate","box","getBoundingClientRect","documentElement","scrollCoord","pageXOffset","scrollLeft","pageYOffset","scrollTop","left","top","getViewportPageOffset","getBorderBox","parseFloat","right","bottom","Rect","scrollIntoContainerView","container","opt_center","offset","getContainerOffsetToScrollInto","elementPos","containerPos","containerBorder","relX","relY","elementSize","spaceX","clientWidth","spaceY","clientHeight","Math","min","max","getRelativeXY","xy","parseInt","r","match","XY_REGEX","styleComponents","XY_STYLE_REGEX","getInjectionDivXY","is3dSupported","getViewportBBox","scrollOffset","getDocumentScroll","win","screenToWsCoordinates","screenCoordinates","screenX","screenY","boundingRect","getInjectionDiv","injectionDiv","clientOffsetPixels","mainOffsetPixels","getOriginOffsetInPixels","difference","finalOffsetPixels","finalOffsetMainWs","svgSize","workspaceToDom","opt_noId","treeXml","variablesElement","variablesToDom","hasChildNodes","comments","getTopComments","comment","toXmlWithXY","getTopBlocks","blockToDomWithXY","variableList","isInsertionMarker","getChildren","DocumentFragment","RTL","getWidth","blockToDom","getRelativeToSurfaceXY","round","fieldToDom","isSerializable","toXml","allFieldsToDom","inputList","input","fieldRow","fieldDom","isShadow","mutationToDom","mutation","hasAttributes","commentText","getCommentText","size","commentModel","pinned","commentElement","data","dataElement","empty","inputTypes","DUMMY","childBlock","connection","targetBlock","VALUE","STATEMENT","childShadow","getShadowDom","cloneShadow","childElem","nodeType","ELEMENT_NODE","inputsInline","inputsInlineDefault","isCollapsed","isDeletable","isMovable","isEditable","nextElem","nextShadow","nextConnection","shadow","cloneNode","textNode","nodeName","TEXT_NODE","domToPrettyText","lines","blob","indent","line","substring","doc","getElementsByTagName","clearWorkspaceAndLoadFromXml","xml","setResizesEnabled","clear","blockIds","domToWorkspace","newBlockIds","existingGroup","variablesFirst","xmlChild","childNodes","xmlChildElement","domToBlock","blockX","hasAttribute","blockY","isNaN","moveBy","TypeError","rendered","WorkspaceCommentSvg","fromXmlRendered","WorkspaceComment","fromXml","domToVariables","FINISHED_LOADING","appendDomToWorkspace","getBlocksBoundingBox","bbox","farY","topX","newLeftX","Infinity","newRightX","newY","blockXY","offsetY","ySeparation","offsetX","xmlBlock","variablesBeforeCreation","topBlock","domToBlockHeadless","topBlockSvg","setConnectionTracking","initSvg","render","disposed","updateDisabled","resizeContents","initModel","newVariables","thisVariable","VAR_CREATE","xmlVariables","mapSupportedXmlTags","childNodeMap","next","applyMutationTagNodes","xmlChildren","shouldCallInitSvg","domToMutation","applyCommentTagNodes","setCommentText","getCommentIcon","isInFlyout","blockSvg","setVisible","applyDataTagNodes","applyFieldTagNodes","domToField","findChildBlocks","xmlNode","childBlockInfo","childBlockElement","childShadowElement","applyInputTagNodes","prototypeName","getInput","setShadowDom","applyNextTagNodes","isConnected","parentConnection","connectedToParentNext","outerHTML","newBlock","xmlChildNameMap","connect","inline","setInputsInline","deletable","setDeletable","movable","setMovable","editable","setEditable","collapsed","setCollapsed","setShadow","fieldName","getField","deleteNext","serializer","SERIALIZER","save","addCoordinates","addInputBlocks","addNextBlocks","doFullSerialization","saveCoords","saveAttributes","saveExtraState","saveIcons","saveFields","saveInputBlocks","saveNextBlocks","extraState","fields","saveState","inputs","connectionState","saveConnection","getShadowState","append","appendInternal","prevRecordUndo","appendPrivate","BLOCK_CREATE","MissingBlockType","loadCoords","loadAttributes","loadExtraState","tryToConnectParent","loadIcons","loadFields","loadInputBlocks","loadNextBlocks","initBlock","getSourceBlock","RealChildOfShadow","childConnection","MissingConnection","connected","checker","connectionChecker","BadConnectionCheck","getErrorMessage","canConnectWithReason","fieldState","loadState","inputName","loadConnection","setShadowState","icons","getIcons","computeIconLocation","connectReciprocally","first","second","targetConnection","getSingleConnection","orphanBlock","foundConnection","output","typeChecker","getConnectionChecker","canConnect","getConnectionForOrphanedOutput","startBlock","toRadians","angleDegrees","PI","toDegrees","angleRadians","clamp","lowerBound","number","upperBound","temp","createDom","arrow","opacity","transition","ANIMATION_TIME","setBoundsElement","boundsElem","boundsElement","getContentDiv","clearContent","setColour","backgroundColour","borderColour","backgroundColor","borderColor","showPositionedByBlock","opt_onHide","opt_secondaryYOffset","showPositionedByRect","getScaledBboxOfBlock","showPositionedByField","positionToField","getScaledBboxOfField","getSvgRoot","scaledHeight","scaledWidth","bBox","getScaledBBox","primaryX","primaryY","secondaryY","sourceBlock","show","newOwner","rtl","secondaryX","owner","onHide","direction","renderedClassName","getRenderer","getClassName","themeClassName","getTheme","positionInternal","getPositionBelowMetrics","boundsInfo","divSize","xCoords","getPositionX","initialX","divX","initialY","finalX","finalY","PADDING_Y","arrowX","arrowY","ARROW_SIZE","BORDER_SIZE","arrowAtTop","arrowVisible","getPositionAboveMetrics","getPositionTopOfPageMetrics","sourceX","boundsLeft","boundsRight","divWidth","relativeArrowX","horizPadding","ARROW_HORIZONTAL_PADDING","isVisible","hideIfOwner","divOwner","opt_withoutAnimation","hideWithoutAnimation","hide","animateOutTimer","markFocused","metrics","getPositionMetrics","floor","repositionForWindowResize","str","prefix","shortestStringLength","array","reduce","a","b","commonWordPrefix","opt_shortest","wordPrefix","len","letter","commonWordSuffix","substr","wrap","limit","wrapLine","words","score","lastText","lineCount","lastScore","wordBreaks","steps","insertedBreaks","wrapMutate","wrapScore","wrapToText","lineLengths","linePunctuation","maxLength","pow","abs","bestScore","bestBreaks","mutatedWordBreaks","mutatedScore","isNumber","test","setCustomTooltip","customFn","customTooltip","getCustomTooltip","visible","getDiv","containerDiv","getTooltipOfObject","object","obj","getTargetObject","tooltip","bindMouseEvents","mouseOverWrapper_","onMouseOver","mouseOutWrapper_","onMouseOut","onMouseMove","unbindMouseEvents","blocked","newElement","currentTarget","poisonedElement","mouseOutPid","_e","showPid","dx","lastX","pageX","dy","lastY","pageY","sqrt","RADIUS_OK","HOVER_MS","dispose","unblock","renderContent","renderDefaultContent","tip","LIMIT","getPosition","windowWidth","windowHeight","anchorX","OFFSET_X","anchorY","OFFSET_Y","scrollY","MARGINS","scrollX","getHsvSaturation","hsvSaturation","setHsvSaturation","newSaturation","getHsvValue","hsvValue","setHsvValue","parse","hex","names","rgb","g","rgbToHex","hexToRgb","colour","hsvToHex","h","s","v","red","green","blue","sextant","remainder","val1","val2","val3","blend","colour1","colour2","factor","hex1","hex2","rgb1","rgb2","hueToHex","hue","tokenizeInterpolationInternal","parseInterpolationTokens","tokens","chars","buffer","c","rawKey","keyUpper","toUpperCase","bklyKey","rawValue","prototype","apply","mergedTokens","tokenizeInterpolation","replaceMessageReferences","interpolatedResult","checkMessageReferences","validSoFar","msgTable","m","msgKey","parseBlockColour","dereferenced","errorMsg","testOnly_setDiv","newDiv","newDispose","rendererClassName","oldOwner","positionWithAnchor","viewportBBox","anchorBBox","widgetSize","calculateY","calculateX","fieldClass","fromJsonInternal","fieldObject","setRole","roleName","ROLE_ATTRIBUTE","setState","stateName","ARIA_PREFIX","validateOptions","foundError","tuple","error","src","inherits","childCtor","parentCtor","superClass_","setPrototypeOf","constructor","mixin","source","deepMerge","convertToolboxDefToJson","toolboxDef","Element","parseToolboxTree","convertToToolboxJson","validateToolbox","toolboxJson","toolboxKind","toolboxContents","FLYOUT_TOOLBOX_KIND","CATEGORY_TOOLBOX_KIND","convertFlyoutDefToJsonArray","flyoutDef","xmlToJsonArray","hasCategories","hasCategoriesInternal","categories","item","isCategoryCollapsible","categoryInfo","contents","Node","addAttributes","attributes","attr","initFn","allExtensions","registerMixin","mixinObj","registerMutator","opt_helperFn","opt_blockList","errorPrefix","checkHasMutatorProperties","hasMutatorDialog","checkMutatorDialog","setMutator","Mutator","isRegistered","isMutator","extensionFn","mutatorProperties","checkNoMutatorProperties","getMutatorProperties","mutatorPropertiesMatch","mutationName","properties","checkXmlHooks","checkHasFunctionPair","checkJsonHooks","compose","decompose","func1","func2","hasXmlHooks","hasJsonHooks","oldProperties","newProperties","runAfterPageLoad","fn","readyState","readyStateCheckInterval","setInterval","clearInterval","buildTooltipForDropdown","dropdownName","lookupTable","blockTypesChecked","checkDropdownOptionsInTable","setTooltip","getFieldValue","warning","dropdown","FieldDropdown","isOptionListDynamic","getOptions","optionKey","buildTooltipWithFieldText","msgTemplate","getText","extensionParentTooltip","tooltipWhenNotConnected","getInputsInline","getParentConnection","topConnection","disposeUiEffect","svgGroup","getAudioManager","play","getSvgXY","clone","disposeUiStep","cloneRect","Date","rect","start","workspaceScale","percent","getTime","connectionUiEffect","ripple","Svg","CIRCLE","connectionUiStep","disconnectPid","disconnectUiEffect","disconnectUiStop","getHeightWidth","magnitude","atan","DISPLACEMENT","disconnectGroup","disconnectUiStep","DURATION","skew","val","sin","WIGGLES","copy","toCopy","copyInternal","copyData","toCopyData","paste","typeCounts","isCapacityAvailable","saveInfo","duplicate","toDuplicate","duplicateInternal","oldCopyData","pastedThing","getCurrentBlock","currentBlock","setCurrentBlock","dummyOwner","menu","populate_","menu_","position_","focus","Menu","Role","MENU","option","menuItem","MenuItem","setRightToLeft","MENUITEM","addChild","enabled","onAction","actionHandler","scope","createWidget_","menuSize","menuDom","getElement","haltPropagation","callbackFactory","config","snapRadius","select","commentDeleteOption","deleteOption","commentDuplicateOption","duplicateOption","workspaceCommentOption","wsCommentOption","wsCommentOption.callback","DEFAULT_SIZE","finalOffset","point","curve","command","points","moveTo","lineTo","lineOnAxis","arc","flags","radius","getStartPositionRect","horizontalPadding","verticalPadding","hasVerticalScrollbar","scrollbar","canScrollVertically","horizontal","horizontalPosition","LEFT","absoluteMetrics","Scrollbar","scrollbarThickness","viewMetrics","vertical","verticalPosition","TOP","canScrollHorizontally","getCornerOppositeToolbox","toolboxMetrics","hPosition","Position","horizontalLayout","RIGHT","vPosition","BOTTOM","bumpPositionRect","startRect","margin","bumpDir","savedPositions","otherEl","intersects","bumpDirection","UP","registerEscape","ShortcutRegistry","registry","escapeAction","ESCAPE","preconditionFn","readOnly","hideChaff","keyCodes","KeyCodes","ESC","registerDelete","deleteShortcut","DELETE","Gesture","inProgress","checkAndDelete","BACKSPACE","registerCopy","ctrlC","createSerializedKey","C","CTRL","altC","ALT","metaC","META","copyShortcut","COPY","registerCut","ctrlX","X","altX","metaX","cutShortcut","CUT","BlockSvg","registerPaste","ctrlV","V","altV","metaV","pasteShortcut","PASTE","registerUndo","ctrlZ","Z","altZ","metaZ","undoShortcut","UNDO","undo","registerRedo","ctrlShiftZ","SHIFT","altShiftZ","metaShiftZ","ctrlY","Y","redoShortcut","REDO","registerDefaultShortcuts","allProcedures","root","proceduresNoReturn","getBlocksByType","map","getProcedureDef","proceduresReturn","procTupleComparator","ta","tb","localeCompare","sensitivity","findLegalName","isLegalName","opt_exclude","isNameUsed","procedureBlock","procName","Names","equals","rename","legalName","oldName","getValue","renameProcedure","populateProcedures","procedureList","templateName","args","arg","nameField","updateMutatorFlyout","xmlElement","argBlock","argValue","DEFAULT_ARG","fieldContent","updateToolbox","mutatorOpenListener","bubbleType","isOpen","mutator","getWorkspace","addChangeListener","mutatorChangeListener","BLOCK_DELETE","BLOCK_CHANGE","getCallers","callers","getProcedureCall","mutateCallers","defBlock","oldRecordUndo","caller","oldMutation","oldMutationDom","newMutationDom","newMutation","getDefinition","isDebuggerEnabled","useDebugger","startDebugger","stopDebugger","rendererClass","RENDERER","theme","opt_rendererOverrides","renderer","noEvent","arrayRemove","stringButtonClickHandler","numberButtonClickHandler","colourButtonClickHandler","firstVariable","resizeSvgContents","serializerMap","load","deserializers","entries","priority","WorkspaceSvg","deserializer","pluginState","bumpObjectIntoBounds","scrollMetrics","objectMetrics","getBoundingRectangle","newYPosition","leftClamp","rightClamp","newXPosition","bumpIntoBoundsHandler","metricsManager","getMetricsManager","hasFixedEdges","BUMP_EVENTS","scrollMetricsInWsCoords","getScrollMetrics","extractObjectFromEvent","oldGroup","wasBumped","bumpTopObjectsIntoBounds","BLOCK_MOVE","getRootBlock","COMMENT_CREATE","COMMENT_MOVE","getCommentById","commentId","topBlocks","getTopBoundedElements","opt_options","getElementById","querySelector","Options","subContainer","tabIndex","State","LABEL","blockDragSurface","BlockDragSurfaceSvg","workspaceDragSurface","WorkspaceDragSurfaceSvg","createMainWorkspace","SVG","HTML_NS","XLINK_NS","defs","DEFS","rnd","random","gridPattern","Grid","gridOptions","wsOptions","zoomOptions","startScale","languageTree","flyout","addFlyout","hasTrashcan","addTrashcan","controls","addZoomControls","getThemeManager","subscribe","translate","workspaceResizeHandler","setResizeHandlerWrapper","bindDocumentEvents","toolbox","getToolbox","getFlyout","scrollToStart","trashcan","zoomControls_","moveOptions","scrollbars","ScrollbarPair","setMetrics","hasSounds","loadSounds","onKeyDown","documentEventsBound","updateInverseScreenCTM","IPAD","unbindSounds","soundBinds","audioMgr","preload","ContextMenuRegistry","undoOption","displayText","getUndoStack","scopeType","ScopeType","WORKSPACE","weight","redoOption","getRedoStack","registerCleanup","cleanOption","cleanUp","toggleOption_","shouldCollapse","timeoutFn","timeoutCounter","ms","DELAY","registerCollapse","collapseOption","collapse","registerExpand","expandOption","addDeletableBlocks_","deleteList","getDeletableBlocks_","deleteNext_","eventGroup","shift","registerDeleteAll","deletableBlocksLength","cancelCurrentGesture","deletableBlocks","ok","registerWorkspaceOptions_","registerDuplicate","isDuplicatable","BLOCK","registerComment","commentOption","registerInline","inlineOption","registerCollapseExpandBlock","collapseExpandOption","registerDisable","disableOption","getInheritedDisabled","descendantCount","registerHelp","helpOption","url","helpUrl","showHelp","registerBlockOptions_","registerDefaultOptions","initIconData","dragIconData","location","getIconLocation","icon","opt_onlyClosePopups","resizeSvgContentsLocal","realResizeSvgContents","bindEvent_","unbindEvent_","bindEventWithChecks_","global","declareModuleId","namespace","goog","$jscomp$tmp$exports$module$name","COMPILED","define","goog.define","DEBUG","DISALLOW_TEST_ONLY_CODE","provide","goog.provide","module","goog.module","goog.module.get","declareLegacyNamespace","goog.module.declareLegacyNamespace","setTestOnly","goog.setTestOnly","opt_message","require","goog.require","requireType","goog.requireType","CONNECTION_CHECKER","CURSOR","TOOLBOX","THEME","TOOLBOX_ITEM","FLYOUTS_VERTICAL_TOOLBOX","FLYOUTS_HORIZONTAL_TOOLBOX","METRICS_MANAGER","BLOCK_DRAGGER","draggingConnections","soup","soupLength","VAR_DELETE","VAR_RENAME","BLOCK_DRAG","SELECTED","MARKER_MOVE","TRASHCAN_OPEN","TOOLBOX_ITEM_SELECT","THEME_CHANGE","COMMENT_DELETE","COMMENT_CHANGE","Abstract","isBlank","toJson","run","_forward","getEventWorkspace_","UiBase","AbstractEvent","opt_workspaceId","TrashcanOpen","opt_isOpen","TOUCH_ENABLED","rawUserAgent","isJavaFx","isWebKit","isGecko","isAndroid","isIPad","isIPhone","isMac","isTablet","isMobile","raw","has","rawUpper","maxTouchPoints","JavaFx","GECKO","ANDROID","IPHONE","MOBILE","Capability","name_","POSITIONABLE","DRAG_TARGET","DELETE_AREA","AUTOHIDEABLE","ComponentManager","componentData","Map","capabilityToComponentIds","addComponent","componentInfo","component","capabilities","set","stringCapabilities","capability","removeComponent","delete","addCapability","getComponent","hasCapability","removeCapability","getComponents","sorted","componentIds","components","componentDataList","forEach","componentDatum","Selected","opt_oldElementId","opt_newElementId","oldElementId","newElementId","VarBase","opt_variable","varId","VarCreate","varType","varName","deleteVariableById","opt_id","id_","var1","var2","CATEGORY_NAME","tx","ty","distance","sum","editable_","movable_","deletable_","disposed_","isComment","addTopComment","xy_","height_","width_","content_","fireCreateEvent","removeTopComment","getHeight","setHeight","setWidth","getXY","recordNew","getContent","setContent","xmlComment","info","parseAttributes","w","commentX","commentY","xmlH","xmlW","contains","other","ANIMATE","CLIPPATH","FECOMPOSITE","FECOMPONENTTRANSFER","FEFLOOD","FEFUNCA","FEGAUSSIANBLUR","FEPOINTLIGHT","FESPECULARLIGHTING","FILTER","FOREIGNOBJECT","G","IMAGE","LINE","PATH","PATTERN","POLYGON","RECT","TEXT","TSPAN","RESIZE_SIZE","BORDER_RADIUS","TEXTAREA_OFFSET","onMouseMoveWrapper_","onMouseUpWrapper_","eventsInit_","deleteIconBorder_","deleteGroup_","resizeGroup_","foreignObject_","svgHandleTarget_","svgRectTarget_","textarea_","rendered_","autoLayout_","focused_","svgGroup_","translate_","svgRect_","useDragSurface_","getBlockDragSurface","unselect","disposeInternal_","opt_noSelect","pathMouseDown_","updateMovable","getBubbleCanvas","getGesture","handleBubbleStart","showContextMenu","oldId","addSelect","removeSelect","blurFocus","setFocus","addFocus","removeFocus","dragSurfaceGroup","surfaceTranslation","getSurfaceTranslation","moveToDragSurface","clearTransformAttributes_","translateSurface","setBlocksAndShow","moveDuringDrag","dragSurface","newLoc","skew_","commentBounds","setDragging","adding","setDeleteStyle","setAutoLayout","_enable","createEditor_","addResizeDom_","addDeleteDom_","setSize_","resizeMouseDown_","deleteMouseDown_","deleteMouseOut_","deleteMouseUp_","TOP_OFFSET","textarea","unbindDragEvents_","startDrag","resizeMouseUp_","resizeMouseMove_","newXY","moveDrag","resizeComment_","topOffset","textOffset","blur","opt_wsWidth","wsWidth","BlockBase","opt_block","BlockChange","opt_element","opt_oldValue","opt_newValue","oldValue","setValue","oldState","getExtraBlockState_","JSON","stringify","DeserializationError","toDevString","reason","childState","VARIABLES","BLOCKS","saveBlock","BlockSerializer","blockStates","BlockCreate","BlockDelete","oldXml","wasShadow","oldJson","ConnectionType","Connection","shadowDom_","check_","shadowState_","sourceBlock_","connect_","INPUT","INPUT_VALUE","parentBlock","disconnect","orphan","shadowState","stashShadowState_","applyShadowState_","setParent","orphanConnection","getConnectionForOrphanedConnection","onFailedConnect","setShadowStateInternal_","unplug","isSuperior","NEXT_STATEMENT","_otherConnection","otherConnection","disconnectInternal_","respawnShadow_","createShadowBlock_","onCheckChanged_","setCheck","check","getCheck","shadowDom","returnCurrent","neighbours","_maxLimit","getParentInput","parentInput","serializeShadow_","attemptToConnect","blockShadow","OUTPUT_VALUE","lastConnectionInStack","CAN_CONNECT","REASON_SELF_CONNECTION","REASON_WRONG_TYPE","REASON_TARGET_NULL","REASON_CHECKS_FAILED","REASON_DIFFERENT_WORKSPACES","REASON_SHADOW_PARENT","REASON_DRAG_CHECKS_FAILED","REASON_PREVIOUS_AND_OUTPUT","COLLAPSED_INPUT_NAME","COLLAPSED_FIELD_NAME","getBoundsInfo","boundPosition","boundSize","clientTop","MarkerManager","cursorSvg_","cursor_","markers","markerSvg_","registerMarker","marker","unregisterMarker","setDrawer","makeMarkerDrawer","setMarkerSvg","getDrawer","getCursor","getMarker","setCursor","cursor","drawer","setCursorSvg","cursorSvg","getBlockCanvas","markerSvg","updateMarkers","keyboardAccessibilityMode","draw","markerIds","markerId","LOCAL_MARKER","Sentinel","Field","opt_validator","opt_config","DEFAULT_VALUE","constants_","mouseDownWrapper_","textContent_","textElement_","borderRect_","fieldGroup_","tooltip_","validator_","maxDisplayLength","enabled_","visible_","isDirty_","suffixField","prefixField","clickTarget_","EDITABLE","SERIALIZABLE","value_","size_","SKIP_SETUP","configure_","setValidator","setSourceBlock","getConstants","initView","updateEditable","bindEvents_","createBorderRect_","createTextElement_","FIELD_BORDER_RECT_RADIUS","FIELD_TEXT_BASELINE_CENTER","getClickTarget_","onMouseDown_","fieldElement","_doFullSerialization","legacyState","saveLegacyState","loadLegacyState","callingClass","isClickable","showEditor_","isCurrentlyEditable","handler","getValidator","applyColour","render_","nodeValue","getDisplayText_","updateSize_","showEditor","opt_e","opt_margin","constants","xOffset","FIELD_BORDER_RECT_X_PADDING","totalWidth","totalHeight","FIELD_TEXT_HEIGHT","contentWidth","FIELD_TEXT_FONTSIZE","FIELD_TEXT_FONTWEIGHT","FIELD_TEXT_FONTFAMILY","FIELD_BORDER_RECT_HEIGHT","positionTextElement_","positionBorderRect_","halfHeight","FIELD_TEXT_BASELINE","getAbsoluteXY_","NBSP","getText_","markDirty","forceRerender","bumpNeighbours","updateMarkers_","validatedValue","doClassValidation_","processValidation_","localValidator","doValueUpdate_","doValueInvalid_","_invalidValue","setStartField","newTip","clickTarget","getTooltip","referencesVariables","refreshVariableName","idx","fieldRows","getFlipRtl","isTabNavigable","onShortcut","_shortcut","menuItems_","roleName_","element_","onKeyDownHandler_","mouseLeaveHandler_","mouseEnterHandler_","clickHandler_","mouseOverHandler_","highlightedItem_","openingCoords","handleMouseOver_","handleClick_","handleMouseEnter_","handleMouseLeave_","handleKeyEvent_","preventScroll","blur_","getMenuItem_","menuElem","currentElement","setHighlighted","currentHighlighted","ACTIVEDESCENDANT","highlightNext","highlightHelper_","highlightPrevious","highlightFirst_","highlightLast_","startIndex","delta","oldCoords","newCoords","performAction","shiftKey","metaKey","altKey","highlighted","keyCode","ENTER","SPACE","DOWN","PAGE_UP","HOME","PAGE_DOWN","END","scrollHeight","opt_value","rightToLeft_","highlight_","checked_","checkable_","actionHandler_","checkbox","contentDom","DISABLED","setCheckable","checkable","setChecked","checked","highlight","nameDep","menuGenerator","svgArrow_","arrow_","imageElement_","selectedMenuItem_","generatedOptions_","menuGenerator_","trimOptions_","selectedOption_","shouldAddBorderRect_","FIELD_DROPDOWN_SVG_ARROW","createSVGArrow_","createTextArrow_","FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW","ARROW_CHAR","FIELD_DROPDOWN_SVG_ARROW_SIZE","setAttributeNS","FIELD_DROPDOWN_SVG_ARROW_DATAURI","dropdownCreate_","menuElement","FIELD_DROPDOWN_COLOURED_DIV","primaryColour","getColour","colourTertiary","dropdownDispose_","LISTBOX","image","Image","alt","OPTION","handleMenuActionEvent_","onItemSelected_","hasImages","label","strings","shortest","prefixLength","suffixLength","applyTrim_","opt_useCache","isValueValid","fill","colourSecondary","colourPrimary","renderSelectedImage_","renderSelectedText_","imageJson","imageHeight","imageWidth","hasBorder","FIELD_DROPDOWN_BORDER_RECT_HEIGHT","IMAGE_Y_PADDING","xPadding","arrowWidth","positionSVGArrow_","textWidth","textPadding","FIELD_DROPDOWN_SVG_ARROW_PADDING","svgArrowSize","newOptions","CHECKMARK_OVERHANG","MAX_MENU_HEIGHT_VH","IMAGE_Y_OFFSET","BubbleOpen","opt_bubbleType","opt_pair","opt_class","oldHostMetrics_","ratio","startDragHandle","handlePosition_","handleLength_","scrollbarLength_","startDragMouse_","containerVisible_","isVisible_","outerSvg_","svgHandle_","svgBackground_","lengthAttribute_","positionAttribute_","pair_","margin_","DEFAULT_SCROLLBAR_MARGIN","origin_","createDom_","onMouseDownBarWrapper_","onMouseDownBar_","onMouseDownHandleWrapper_","onMouseDownHandle_","cleanUp_","unsubscribe","constrainHandleLength_","setHandleLength_","newLength","constrainHandlePosition_","setHandlePosition","newPosition","setScrollbarLength_","newSize","setPosition","opt_metrics","hostMetrics","getMetrics","metricsAreEquivalent_","resizeHorizontal_","resizeVertical_","updateMetrics_","requiresViewResize_","viewWidth","viewHeight","absoluteLeft","absoluteTop","resizeViewHorizontal","resizeContentHorizontal","viewSize","xCoordinate","scrollWidth","handleLength","maxScrollDistance","maxHandleOffset","handleOffset","resizeViewVertical","resizeContentVertical","setContainerVisible","visibilityChanged","updateDisplay_","mouseXY","getInverseScreenCTM","mouseLocation","handleXY","handleStart","handlePosition","pageLength","setupDragSurface","onMouseUpHandle_","onMouseMoveHandle_","currentMouse","resetDragSurface","getRatio_","updateMetrics","setOrigin","Bubble","shape","anchorXY","bubbleWidth","bubbleHeight","bubbleBack_","bubbleArrow_","bubbleGroup_","relativeTop_","relativeLeft_","onMouseDownResizeWrapper_","onMouseDownBubbleWrapper_","moveCallback_","resizeCallback_","workspace_","shape_","angle","ARROW_ANGLE","arrow_radians_","canvas","setAnchorLocation","getBBox","BORDER_WIDTH","setBubbleSize","positionBubble_","renderArrow_","hasResize","embossFilterId","bubbleEmboss","resizeSize","bubbleMouseDown_","setSvgId","promote","bubbleMouseUp_","registerResizeEvent","registerMoveEvent","lastChild","anchorXY_","layoutBubble_","getViewMetrics","optimalLeft","getOptimalRelativeLeft_","optimalTop","getOptimalRelativeTop_","topPosition","MIN_BLOCK_HEIGHT","startPosition","endPosition","bottomPosition","closerPosition","fartherPosition","topPositionOverlap","getOverlap_","startPositionOverlap","closerPositionOverlap","fartherPositionOverlap","mostOverlap","relativeMin","relativeLeft","bubbleRight","workspaceRight","workspaceLeft","bubbleLeft","relativeTop","bubbleTop","bubbleBottom","workspaceTop","workspaceBottom","getBubbleSize","doubleBorderWidth","relBubbleX","relBubbleY","relAnchorX","relAnchorY","rise","hypotenuse","acos","rightAngle","rightRise","rightRun","cos","bubbleSize","thickness","ARROW_THICKNESS","backoffRatio","ANCHOR_RADIUS","baseX1","baseY1","baseX2","baseY2","swirlAngle","swirlRise","ARROW_BEND","swirlRun","hexColour","paragraph","tspanElement","createNonEditableBubble","paragraphElement","iconXY","bubble","pathObject","svgPath","maxWidth","DEFAULT_SNAP_RADIUS","dragRadius","flyoutDragRadius","connectingSnapRadius","currentConnectionPreference","bumpDelay","Icon","iconGroup_","collapseHidden","SIZE","iconXY_","bubble_","block_","createIcon","drawIcon_","iconClick_","setIconLocation","getCorrectedSize","_group","_visible","Theme","opt_blockStyles","opt_categoryStyles","opt_componentStyles","startHats","blockStyles","categoryStyles","componentStyles","fontStyle","setBlockStyle","blockStyleName","blockStyle","setCategoryStyle","categoryStyleName","categoryStyle","getComponentStyle","componentName","setComponentStyle","styleValue","setFontStyle","setStartHats","defineTheme","themeObj","base","defaultBlockStyles","Classic","toolboxJsonDef","hasCollapse","hasComments","hasDisable","rawHasTrashcan","rawHasCollapse","rawHasComments","rawHasDisable","rawHasSounds","maxTrashcanContents","toolboxAtStart","toolboxPosition","endsWith","rawOneBasedIndex","oneBasedIndex","maxBlocks","maxInstances","parseMoveOptions_","hasScrollbars","parseGridOptions_","parseZoomOptions_","parseThemeOptions_","rendererOverrides","move","wheel","drag","zoom","maxScale","minScale","scaleSpeed","pinch","grid","spacing","snap","quarkNames","workspaceHeight_","workspaceWidth_","updateWorkspacePid_","sourceListener_","rootBlock_","svgDialog_","quarkNames_","setBlock","quarkXml","quarkName","workspaceOptions","hasFlyout","newWorkspaceSvg","internalIsMutator","flyoutSvg","background","svgBlockCanvas_","resizeBubble_","workspaceSize","getCanvas","flyoutScrollMetrics","translation","onBubbleMove_","recordDragTargets","tree","CORNER_RADIUS","saveConnections","thisRootBlock","this.sourceListener_","workspaceChanged_","updateWorkspace_","removeChangeListener","shouldIgnoreMutatorEvent_","MARGIN","oldExtraState","savedRendered","newExtraState","mutationGroup","updateBlockStyle","workspaceBlocks","setStyle","getStyleName","flyoutBlocks","reconnect","connectionChild","connectionParent","currentParent","findParentWs","outerWs","FieldLabel","class_","class","setClass","cssClass","Input","align","Align","appendField","insertFieldAt","removeField","opt_quiet","renderList","renderedConnection","startTrackingAll","stopTrackingAll","setAlign","ASTNode","opt_params","wsCoordinate_","type_","isConnection_","isConnectionType_","location_","processParams_","params","wsCoordinate","getLocation","getType","getWsCoordinate","isConnection","findNextForInput_","curIdx","NAVIGATE_ALL_FIELDS","createFieldNode","createInputNode","findNextForField_","fieldIdx","newInput","findPrevForInput_","findPrevForField_","navigateBetweenStacks_","curLocation","curLocationAsBlock","curRoot","resultIndex","createStackNode","findTopASTNodeForBlock_","createConnectionNode","createBlockNode","getOutAstNodeForBlock_","getTopStackBlock","findFirstFieldOrInput_","types","STACK","OUTPUT","PREVIOUS","NEXT","in","prev","out","blockPos","DEFAULT_OFFSET_Y","createWorkspaceNode","PREVIOUS_STATEMENT","createTopNode","astNode","Block","hue_","colour_","styleName_","suppressPrefixSuffix","contextMenu","parentBlock_","childBlocks_","collapsed_","isShadow_","outputShape_","isInsertionMarker_","hat","onchangeWrapper_","statementInputCount","setBlockById","isInMutator","assign","addTopBlock","addTypedBlock","doInit_","onchange","setOnChange","healStack","removeTopBlock","removeTypedBlock","removeBlockById","connections","getConnections_","opt_healStack","unplugFromRow_","unplugFromStack_","thisConnection","getOnlyValueConnection_","previousTarget","nextTarget","_all","myConnections","ignoreShadows","getInputWithBlock","getSurroundParent","prevBlock","getPreviousBlock","getFirstStatementConnection","rootBlock","previous","ordered","childBlocks","hasBlockLimits","setInsertionMarker","insertionMarker","isDisposed","getMatchingConnection","otherBlock","conn","otherConnections","setHelpUrl","getHue","parsed","onchangeFn","getVars","vars","model","updateVarName","renameVarById","newId","setFieldValue","setPreviousStatement","newBoolean","opt_check","makeConnection_","setNextStatement","setOutput","setOutputShape","outputShape","getOutputShape","ancestor","opt_maxLength","opt_emptyToken","shouldAddParentheses","checks","checkRoot","rootNode","emptyFieldPlaceholder","prevNavigateFields","current","acc","appendValueInput","appendInput_","appendStatementInput","appendDummyInput","warningPrefix","jsonInitStyle_","jsonInitColour_","interpolate_","localizedText","localizedValue","extensionNames","styleError","opt_disableCheck","overwrites","lastDummyAlign","validateTokens_","elements","interpolateArguments_","fieldStack","isInputKeyword_","inputFromJson_","fieldFromJson_","argsCount","visitedArgsHash","visitedArgsCount","token","stringToFieldJson_","dummyInput","alignmentLookup","CENTRE","alignment","moveInputBefore","refName","inputIndex","refIndex","moveNumberedInputBefore","RangeError","removeInput","getInputTargetBlock","setWarningText","_text","_opt_id","_mutator","allInputsFilled","opt_shadowBlocksAreFilled","Comment","cachedText_","paragraphElement_","onInputWrapper_","onChangeWrapper_","onWheelWrapper_","model_","resizeTextarea_","startEdit_","disposeBubble_","createBubble_","onBubbleResize_","widthMinusBorder","heightMinusBorder","createEditableBubble_","createNonEditableBubble_","updateText","registry_","reset","getContextMenuOptions","menuOptions","precondition","menuOption","COLLAPSE_CHARS","DRAG_STACK","OPPOSITE_TYPE","RENAME_VARIABLE_ID","DELETE_VARIABLE_ID","Marker","drawer_","curNode_","getCurNode","setCurNode","oldNode","Cursor","curNode","BasicCursor","getNextNode_","validNode_","getPreviousNode_","isValid","siblingOrParent","findSiblingOrParent_","getRightMostChild_","nextNode","registrationName","TabNavigateCursor","BUMP_RANDOMNESS","RenderedConnection","db_","connectionDBList","dbOpposite_","offsetInBlock_","trackedState_","TrackedState","WILL_TRACK","TRACKED","removeConnection","distanceFrom","xDiff","yDiff","bumpAwayFrom","staticConnection","addConnection","moveToOffset","blockTL","setOffsetInBlock","getOffsetInBlock","tighten","svgRoot","moveConnections","closest","maxLimit","dxy","searchForClosest","renderConstants","shapeFor","yLen","TAB_OFFSET_FROM_TOP","pathDown","xLen","NOTCH_OFFSET_LEFT","pathLeft","highlightedPath_","unhighlight","setTracking","doTracking","UNTRACKED","getNeighbours","parentRendered","childRendered","Warning","text_","setText","allWarnings","renderingDebugger","warningTextDb","commentIcon_","renderIsInProgress_","customContextMenu","getBlockStyle","makePathObject","getColourSecondary","getColourTertiary","oldParent","isClearing","oldXY","eventsEnabled","curXY","moveOffDragSurface","clearAndHide","snapToGrid","getGrid","shouldSnap","getSpacing","half","blockBounds","updateCollapsed_","collapsedInputName","collapsedFieldName","tab","tabCursor","currentNode","nextField","handleBlockStart","open","generateContextMenu","INSERTION_MARKER_COLOUR","updateInsertionMarker","animate","blockWorkspace","n","shouldHaveComment","timeout","changedState","collapsedParent","COLLAPSED_WARNING_ID","oldText","newText","updateHighlighted","updateSelected","updateDraggingDelete","styleObj","getBlockStyleForColour","bringToFront","removed","track","all","renderedConn","renderedOther","scheduleSnapAndBump","positionNearConnection","sourceConnection","opt_bubble","updateConnectionLocations_","nextHeightWidth","tabHeight","NOTCH_HEIGHT","fadeForReplacement","updateReplacementFade","highlightShapeForInput","updateShapeForInputHighlight","INLINE","DragTarget","onDragEnter","_dragElement","onDragOver","onDragExit","onDrop","getClientRect","shouldPreventMove","DeleteArea","wouldDelete_","wouldDelete","couldConnect","couldDeleteBlock","updateWouldDelete_","SPRITE","Trashcan","contents_","isLidOpen","minOpenness_","lidTask_","svgLid_","top_","left_","lidOpen_","initialized_","flyoutWorkspaceOptions","HorizontalFlyout","VerticalFlyout","onDelete_","clip","WIDTH","BODY_HEIGHT","LID_HEIGHT","SPRITE_LEFT","SPRITE_TOP","blockMouseDownWhenOpenable_","click","mouseOver_","mouseOut_","animateLid_","getComponentManager","setLidOpen","hasContents_","contentsIsOpen","openFlyout","string","fireUiEvent_","closeFlyout","autoHide","onlyClosePopups","emptyContents","setMinOpenness_","cornerPosition","MARGIN_HORIZONTAL","MARGIN_VERTICAL","positionRect","trashRect","MARGIN_HOTSPOT","frames","ANIMATION_FRAMES","setLidAngle_","MAX_LID_ANGLE","OPACITY_MIN","OPACITY_MAX","ANIMATION_LENGTH","lidAngle","openAtRight","newMin","closeLid","trashcanOpen","uiEvent","cleanedJson","cleanBlockJson_","HAS_BLOCKS_LID_ANGLE","cleanRec","blockInfo","ToolboxItemSelect","opt_oldItem","opt_newItem","oldItem","newItem","ToolboxItem","toolboxItemDef","parentToolbox","level_","parent_","getLevel","toolboxItemDef_","parentToolbox_","getClickTarget","isSelectable","isCollapsible","setVisible_","_isVisible","ToolboxCategory","categoryDef","labelDom_","iconDom_","rowContents_","rowDiv_","htmlDiv_","isDisabled_","isHidden_","flyoutItems_","cssConfig_","makeDefaultCssConfig_","parseCategoryDef_","parseContents_","itemDef","getColour_","createContainer_","TREEITEM","LEVEL","createRowContainer_","pointerEvents","createRowContentsContainer_","createIconDom_","PRESENTATION","createLabelDom_","LABELLEDBY","addColourBorder_","rowDiv","nestedPadding","paddingRight","paddingLeft","contentsContainer","toolboxIcon","isHorizontal","toolboxLabel","refreshTheme","border","borderWidth","borderRight","borderLeft","styleName","getColourfromStyle_","parseColour_","colourValue","openIcon_","iconDiv","closeIcon_","getSelectedItem","clearSelection","allAncestorsExpanded_","category","isExpanded","onClick","isSelected","defaultColour","defaultBackgroundColour","setDisabled","isDisabled","getName","getContents","updateFlyoutContents","ToolboxSeparator","separatorDef","CollapsibleToolboxCategory","subcategoriesDiv_","expanded_","toolboxItems_","cssConfig","prevIsFlyoutItem","createToolboxItem_","registryName","toolboxItem","ToolboxItemClass","setExpanded","subCategories","getChildToolboxItems","createSubCategoriesDom_","GROUP","subcategories","newCategory","newCategoryDiv","EXPANDED","handleToolboxItemResize","childToolboxItems","toggleExpanded","Toolbox","contentsDiv_","HtmlDiv","previouslySelectedItem_","selectedItem_","flyout_","boundEvents_","toolboxDef_","horizontalLayout_","contentMap_","createFlyout_","themeManager","createContentsContainer_","TREE","attachEvents_","toolboxContainer","flexDirection","clickEvent","onClick_","keyDownEvent","onKeyDown_","itemId","getToolboxItemById","setSelectedItem","selectNext_","selectPrevious_","selectParent_","selectChild_","untypedItem","FlyoutClass","renderContents_","fragment","createDocumentFragment","addToolboxItem_","toolboxItemDom","getToolboxItems","addStyle","removeStyle","toolboxRect","BIG_NUM","_couldConnect","updateCursorDeleteStyle_","getPreviouslySelectedItem","workspaceMetrics","toolboxDiv","newX","childAsCategory","refreshSelection","autoClose","shouldDeselectItem_","deselectItem_","shouldSelectItem_","selectItem_","updateFlyout_","fireSelectEvent_","selectItemByPosition","oldElement","collapsibleItem","nextItemIdx","nextItem","prevItemIdx","prevItem","Zelos","Click","opt_targetType","targetType","BubbleDragger","dragTarget_","wouldDeleteBubble_","startXY_","dragSurface_","startBubbleDrag","dragBubble","currentDragDeltaXY","pixelsToWorkspaceUnits_","oldDragTarget","getDragTarget","oldWouldDeleteBubble","shouldDelete_","updateCursorDuringBubbleDrag_","dragTarget","componentManager","isDeleteArea","endBubbleDrag","fireMoveEvent_","setOldCoordinate","pixelCoord","WorkspaceDragger","horizontalScrollEnabled_","isMovableHorizontally","verticalScrollEnabled_","isMovableVertically","startScrollXY_","endDrag","scroll","creatorWorkspace","startWorkspace_","targetBlock_","startBlock_","startField_","startBubble_","mouseDownXY_","isDraggingBubble_","isDraggingBlock_","isDraggingWorkspace_","hasExceededDragRadius_","workspaceDragger_","blockDragger_","bubbleDragger_","onUpWrapper_","onMoveWrapper_","isEnding_","hasStarted_","calledUpdateIsDragging_","mostRecentEvent_","currentDragDeltaXY_","healStack_","clearGesture","updateFromEvent_","currentXY","updateDragDelta_","changed","updateIsDragging_","currentDragDelta","limitRadius","updateIsDraggingFromFlyout_","isBlockCreatable","isScrollable","isDragTowardWorkspace","updateScreenCalculationsIfScrolled","createBlock","updateIsDraggingBubble_","startDraggingBubble_","updateIsDraggingBlock_","startDraggingBlock_","updateIsDraggingWorkspace_","wsMovable","isDraggable","BlockDraggerClass","doStart","cancel","pointerType","handleMove","handleUp","log","isBubbleClick_","doBubbleClick_","isFieldClick_","doFieldClick_","isBlockClick_","doBlockClick_","isWorkspaceClick_","doWorkspaceClick_","bringBlockToFront_","handleWsStart","setStartWorkspace_","fireWorkspaceClick_","handleFlyoutStart","setStartFlyout_","setStartBlock","setStartBubble","setTargetBlock_","hasStartBubble","hasStartBlock","fieldClickable","hasStarted","getInsertionMarkers","getCurrentDragger","currentGesture_","shortcuts","keyMap","shortcut","registeredShortcut","addKeyMapping","allowCollision","shortcutName","removeAllKeyMappings","opt_allowCollision","shortcutNames","removeKeyMapping","shortcutIdx","setKeyMap","newKeyMap","getKeyMap","legacyKeyMap","getRegistry","legacyRegistry","serializeKeyEvent_","getShortcutNamesByKeyCode","getKeyCodesByShortcutName","serializedKey","modifier","modifierKeys","getModifierState","checkModifiers_","modifiers","modifierKeyCode","ThemeChange","opt_themeName","themeName","ViewportChange","opt_top","opt_left","opt_scale","opt_oldScale","ConnectionDB","connections_","yPos","calculateIndexForYPos_","findIndexOfConnection_","bestGuess","pointer","pointerMin","pointerMax","pointerMid","maxRadius","checkConnection_","yIndex","currentX","db","currentY","isInYRange_","baseY","baseX","closestIndex","bestConnection","bestRadius","dbList","pattern","line2","line1","getPatternId","update","safeSpacing","end","setLineAttributes","x1","x2","y1","y2","reservedWordsList","opt_variablePrefix","dbReverse","variableMap_","variablePrefix_","reservedWords","setVariableMap","getNameForUserVariable_","populateVariables","NameType","VARIABLE","nameOrId","normalizedName","DEVELOPER_VARIABLE","typeDb","safeName","getDistinctName","getUserNames","userNames","safeName_","encodeURI","name1","name2","DEVELOPER_VARIABLE_TYPE","TypesContainer","NONE","HAT","ICON","SPACER","BETWEEN_ROW_SPACER","IN_ROW_SPACER","EXTERNAL_VALUE_INPUT","INLINE_INPUT","STATEMENT_INPUT","CONNECTION","PREVIOUS_CONNECTION","NEXT_CONNECTION","OUTPUT_CONNECTION","CORNER","LEFT_SQUARE_CORNER","LEFT_ROUND_CORNER","RIGHT_SQUARE_CORNER","RIGHT_ROUND_CORNER","JAGGED_EDGE","ROW","TOP_ROW","BOTTOM_ROW","INPUT_ROW","LEFT_CORNER","RIGHT_CORNER","nextTypeValue_","hasOwnProperty","isField","isHat","isIcon","isSpacer","isInRowSpacer","isInput","isExternalInput","isInlineInput","isStatementInput","isPreviousConnection","isNextConnection","isPreviousOrNextConnection","isLeftRoundedCorner","isRightRoundedCorner","isLeftSquareCorner","isRightSquareCorner","isCorner","isJaggedEdge","isRow","row","isBetweenRowSpacer","isTopRow","isBottomRow","isTopOrBottomRow","isInputRow","Types","Measurable","centerline","xPos","notchOffset","Row","widthWithConnectedBlocks","minWidth","minHeight","hasStatement","hasExternalInput","statementEdge","hasJaggedEdge","hasDummyInput","hasInlineInput","getLastInput","measure","startsWithElemSpacer","endsWithElemSpacer","getFirstSpacer","getLastSpacer","BottomRow","hasNextConnection","descenderHeight","hasLeftSquareCorner","hasRightSquareCorner","_block","connectionModel","isDynamicShape","isDynamic","InputConnection","connectionOffsetY","connectionOffsetX","connectedBlock","connectedBlockWidth","connectedBlockHeight","ExternalValueInput","MEDIUM_PADDING","EXTERNAL_VALUE_INPUT_PADDING","connectionHeight","connectionWidth","flipRtl","Hat","START_HAT","ascenderHeight","InRowSpacer","SPACER_DEFAULT_HEIGHT","InlineInput","EMPTY_INLINE_INPUT_HEIGHT","EMPTY_INLINE_INPUT_PADDING","StatementInput","STATEMENT_BOTTOM_SPACER","EMPTY_STATEMENT_INPUT_HEIGHT","STATEMENT_INPUT_NOTCH_OFFSET","InputRow","connectedBlockWidths","JaggedEdge","JAGGED_TEETH","NextConnection","OutputConnection","startX","PreviousConnection","RoundCorner","opt_position","SpacerRow","precedesStatement","followsStatement","SquareCorner","NO_PADDING","TopRow","capline","hasPreviousConnection","hasHat","ADD_START_HATS","ConstantProvider","SMALL_PADDING","MEDIUM_LARGE_PADDING","LARGE_PADDING","TAB_HEIGHT","TAB_VERTICAL_OVERLAP","TAB_WIDTH","NOTCH_WIDTH","MIN_BLOCK_WIDTH","EMPTY_BLOCK_SPACER_HEIGHT","STATEMENT_INPUT_PADDING_LEFT","BETWEEN_STATEMENT_PADDING_Y","START_HAT_HEIGHT","START_HAT_WIDTH","JAGGED_TEETH_HEIGHT","JAGGED_TEETH_WIDTH","FIELD_BORDER_RECT_Y_PADDING","FIELD_BORDER_RECT_COLOUR","FIELD_COLOUR_FULL_BLOCK","FIELD_TEXTINPUT_BOX_SHADOW","FIELD_COLOUR_DEFAULT_WIDTH","defs_","embossFilter_","disabledPatternId","disabledPattern_","debugFilterId","cssNode_","debugFilter_","CURSOR_COLOUR","MARKER_COLOUR","CURSOR_WS_WIDTH","WS_CURSOR_HEIGHT","CURSOR_STACK_PADDING","CURSOR_BLOCK_PADDING","CURSOR_STROKE_WIDTH","FULL_BLOCK_FIELDS","INSERTION_MARKER_OPACITY","SHAPES","PUZZLE","NOTCH","TALL_INPUT_FIELD_OFFSET_Y","DUMMY_INPUT_SHADOW_MIN_HEIGHT","DUMMY_INPUT_MIN_HEIGHT","TOP_ROW_MIN_HEIGHT","TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT","BOTTOM_ROW_MIN_HEIGHT","BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT","START_POINT","FIELD_COLOUR_DEFAULT_HEIGHT","FIELD_CHECKBOX_X_OFFSET","randomIdentifier","makeJaggedTeeth","makeNotch","makeStartHat","PUZZLE_TAB","makePuzzleTab","INSIDE_CORNERS","makeInsideCorners","OUTSIDE_CORNERS","makeOutsideCorners","setTheme","validatedBlockStyle_","setDynamicProperties_","setFontConstants_","setComponentConstants_","fontMetrics","createBlockStyle_","valid","parsedColour","generateSecondaryColour_","generateTertiaryColour_","inputColour","mainPath","path","makeMainPath","up","back","control1Y","overlap","control2Y","endPoint1","endPoint2","pathUp","dir","outerWidth","innerWidth","pathRight","innerTopLeftCorner","innerBottomLeftCorner","pathTop","pathBottom","topLeft","topRight","bottomLeft","bottomRight","rightHeight","selector","injectCSS_","embossFilter","feSpecularLighting","disabledPattern","createDebugFilter","debugFilter","debugComponentTransfer","cssArray","getCSS_","cssNodeId","Debug","debugElements_","svgRoot_","randomColour_","clearElems","drawSpacerRow","cursorY","isRtl","rowSpacers","isNegativeSpacing","drawSpacerElem","rowHeight","elemSpacers","drawRenderedElem","elems","drawConnection","drawRenderedRow","rows","connectedBlockBounds","drawRowWithElements","drawBoundingBox","widthWithChildren","drawDebug","rightSide","drawRender","Drawer","inlinePath_","outlinePath_","info_","topLeft_","hideHiddenIcons_","drawOutline_","drawInternals_","setPath","flipRTL","recordSizeOnBlock_","iconInfo","hiddenIcons","drawTop_","drawJaggedEdge_","drawStatementInput_","drawValueInput_","drawRightSideRow_","drawBottom_","drawLeft_","topRow","positionPreviousConnection_","startY","positionExternalValueConnection_","innerHeight","positionStatementInputConnection_","bottomRow","positionNextConnection_","rightCornerYOffset","outlinePath","positionOutputConnection_","tabBottom","drawInlineInput_","layoutField_","fieldInfo","connectionTop","connectionBottom","positionInlineInputConnection_","connX","connInfo","RenderInfo","inputRows","renderer_","isInline","createRows_","addElemSpacing_","addRowSpacing_","computeBounds_","alignRowElements_","finalize_","populateTopRow_","activeRow","lastInput","shouldStartNewRow_","addInput_","populateBottomRow_","hasPrevious","cornerClass","leftSquareCorner","rightSquareCorner","oldElems","getInRowSpacing_","widestStatementRowFields","blockWidth","widestRowWithConnectedBlocks","statementInput","alignStatementRow_","currentWidth","missingSpace","getDesiredRowWidth_","desiredWidth","addAlignmentPadding_","_row","firstSpacer","lastSpacer","oldRows","makeSpacerRow_","getSpacerRowHeight_","getSpacerRowWidth_","spacer","_prev","_next","getElemCenterline_","recordElemPositions_","xCursor","yCursor","MarkerMove","isCursor","opt_oldNode","opt_newNode","CURSOR_CLASS","MARKER_CLASS","HEIGHT_MULTIPLIER","MarkerSvg","markerSvgRect_","markerSvgLine_","markerInput_","markerBlock_","currentMarkerSvg","createDomInternal_","setParent_","applyColour_","showAtLocation_","fireMarkerEvent_","SVGAnimationElement","beginElement","connectionType","curNodeAsConnection","showWithBlock_","showWithOutput_","showWithInput_","showWithNext_","showWithPrevious_","showWithField_","showWithCoordinates_","showWithStack_","showWithBlockPrevOutput_","markerHeight","markerOffset","connectionShape","positionPrevious_","positionOutput_","positionBlock_","showCurrent_","positionLine_","positionRect_","positionInput_","heightWidth","yPadding","markerPath","flipRtl_","curBlock","getBlinkProperties_","blinkProperties","_curNode","firstElementChild","PathObject","pathString","updateShadow_","updateDisabled_","setClass_","_conn","DUPLICATE_BLOCK_ERROR","InsertionMarkerManager","localConnection_","closestConnection_","lastMarker_","lastOnStack_","wouldDeleteBlock_","fadedBlock_","highlightedBlock_","markerConnection_","topBlock_","firstMarker_","createMarkerBlock_","availableConnections_","initAvailableConnections_","updateAvailableConnections","wouldDeleteBlock","wouldConnectBlock","applyConnections","hidePreview_","inferiorConnection","candidate","getCandidate_","shouldUpdatePreviews_","maybeHidePreview_","maybeShowPreview_","imType","sourceInput","resultInput","sourceField","resultField","available","lastOnStack","candidateLocal","local","candidateClosest","curDistance","getStartRadius_","myConnection","neighbour","showPreview_","getConnectionPreviewMethod","method","PREVIEW_TYPE","INPUT_OUTLINE","showInsertionInputOutline_","INSERTION_MARKER","showInsertionMarker_","REPLACEMENT_FADE","showReplacementFade_","shouldHighlightConnection","closestChanged","localChanged","hideReplacementFade_","hideInsertionInputOutline_","hideInsertionMarker_","isLastInStack","imConn","imBlock","markerNext","markerPrev","markerOutput","isFirstInOutputStack","isFirstInStatementStack","innerConnection","previousBlockNextConnection","PreviewType","Renderer","overrides","makeConstants_","refreshDom","previousConstants","makeRenderInfo_","makeDrawer_","makeDebugger_","orphanCanConnectAtEnd","localType","ThemeManager","subscribedWorkspaces_","componentDB","prevTheme","componentList","propertyName","subscribeWorkspace","unsubscribeWorkspace","owner_","ZOOM_IN_MULTIPLIER","ZOOM_OUT_MULTIPLIER","TouchGesture","arguments","isMultiTouch_","cachedPoints","startDistance_","previousScale_","isPinchZoomEnabled_","onStartWrapper_","handleTouchStart","isMultiTouch","handleTouchMove","handleTouchEnd","getTouchPoint","pointers","point0","point1","handlePinch_","moveDistance","gestureScale","getInjectionDivXY_","aria","arrayUtils","browserEvents","deprecation","extensions","idGenerator","math","parsing","stringUtils","svgMath","svgPaths","userAgent","onCreateVariableButtonClick_String","onCreateVariableButtonClick_Number","onCreateVariableButtonClick_Colour","ConnectionChecker","opt_distance","safety","doSafetyChecks","doTypeChecks","doDragChecks","errorCode","superiorBlock","inferiorBlock","superiorConnection","checkArrayOne","checkArrayTwo","canConnectToPrevious_","VarDelete","VarRename","VariableMap","variableMap","conflictVar","renameVariableWithConflict_","renameVariableAndUses_","deleteVariable","variableId","tempVar","variableName","uses","getVariableUsesById","procedureName","deleteText","confirmText","deleteVariableInternal","list","getVariableTypes","variableTypes","flat","Workspace","internalIsFlyout","MAX_UNDO","topBlocks_","topComments_","commentDB","listeners_","undoStack_","redoStack_","blockDB","typedBlocksDB","potentialVariableMap_","connectionCheckerClass","sortObjects_","aXY","bXY","SCAN_ANGLE","filtered","remainingCapacity","remainingCapacityOfType","maxInstanceOfType","copyableBlocksCount","redo","inputStack","outputStack","inputEvent","clearUndo","createPotentialVariableMap","getById","getAll","SOUND_LIMIT","WorkspaceAudio","sounds","lastSound_","filenames","audioTest","filename","ext","canPlayType","sound","volume","playPromise","then","pause","catch","opt_volume","now","mySound","ZoomControls","zoomResetGroup","zoomOutGroup","zoomInGroup","onZoomOutWrapper_","onZoomInWrapper_","onZoomResetWrapper_","HEIGHT_","WIDTH_","SMALL_SPACING_","LARGE_SPACING_","MARGIN_HORIZONTAL_","MARGIN_VERTICAL_","createZoomOutSvg_","createZoomInSvg_","createZoomResetSvg_","zoomInTranslateY","zoomOutTranslateY","zoomoutSvg","zoom_","zoominSvg","amount","zoomCenter","fireZoomEvent_","zoomresetSvg","resetZoom_","beginCanvasTransition","scrollCenter","endCanvasTransition","ZOOM_TO_FIT_MARGIN","opt_blockDragSurface","opt_wsDragSurface","resizeHandlerWrapper_","resizesEnabled_","startScrollY","startScrollX","dragDeltaXY_","oldScale_","oldLeft_","oldTop_","workspaceDragSurface_","blockDragSurface_","toolbox_","isDragSurfaceActive_","inverseScreenCTM_","configureContextMenu","lastRecordedPageScroll_","injectionDiv_","inverseScreenCTMDirty_","highlightedBlocks_","toolboxCategoryCallbacks","flyoutButtonCallbacks","cachedParentSvg_","topBoundedElements_","dragTargetAreas_","metricsManager_","MetricsManagerClass","setTopLevelWorkspaceMetrics_","componentManager_","useWorkspaceDragSurface_","audioManager_","grid_","markerManager_","Variables","registerToolboxCategoryCallback","VariablesDynamic","Procedures","themeManager_","cachedParentSvgSize_","getMarkerManager","setMetricsManager","updateBlockStyles_","refreshToolboxSelection","ctm","opt_backgroundClass","svgBubbleCanvas_","onMouseWheel_","ToolboxClass","CursorClass","parentSvg","newTrashcan","svgTrashcan","_workspace","svgZoomControls","opt_own","updateScreenCalculations_","positionables","getUiMetrics","positionable","currScroll","maybeFireViewportChangeEvent","translateAndScaleGroup","trans","previousElement","previousSibling","coord","setContentsAndShow","imList","highlightBlock","opt_state","pasteBlock_","pasteWorkspaceComment_","jsonBlock","collide","allBlocks","otherXY","recordDeleteAreas","dragTargets","targetArea","clientRect","canWheelZoom","canWheelMove","scrollDelta","commandKey","PIXELS_PER_ZOOM_STEP","topElements","boundary","topElement","blockBoundary","parsedToolboxDef","setBrowserFocus","activeElement","setActive","scaleChange","newScale","getCTM","center","f","setScale","svgWidth","svgHeight","zoomToFit","workspaceWidth","workspaceHeight","blocksBox","doubleMargin","blocksWidth","blocksHeight","ratioX","ratioY","centerOnBlock","pixelX","multiplier","pixelY","reflow","resizeView","resizeContent","getScale","maxYScroll","maxYDisplacement","maxXDisplacement","addTopBoundedElement","removeTopBoundedElement","reenabled","getButtonCallback","removeButtonCallback","getToolboxCategoryCallback","removeToolboxCategoryCallback","isStart","autoHideables","autoHideable","xyRatio","VariableSerializer","variableStates","varState","BaseConstantProvider","GRID_UNIT","CURSOR_RADIUS","HEXAGONAL","ROUND","SQUARE","SELECTED_GLOW_COLOUR","SELECTED_GLOW_SIZE","REPLACEMENT_GLOW_COLOUR","REPLACEMENT_GLOW_SIZE","selectedGlowFilterId","selectedGlowFilter_","replacementGlowFilterId","SQUARED","ROUNDED","replacementGlowFilter_","STATEMENT_INPUT_SPACER_MIN_WIDTH","SHAPE_IN_SHAPE_PADDING","MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH","makeHexagonal","makeRounded","makeSquared","rightWidth","selectedGlowSize","replacementGlowSize","pathRightDown","pathRightUp","blockHeight","remainingHeight","maxHeight","_height","curveWidth","quarterHeight","innerTopRightCorner","innerBottomRightCorner","pathTopRight","pathBottomRight","selectedGlowFilter","selectedComponentTransfer","replacementGlowFilter","replacementComponentTransfer","BaseDrawer","beginDrawing","outputShapeType","endDrawing","hasStatementInput","drawFlatTop_","drawRightDynamicConnection_","drawFlatBottom_","drawLeftDynamicConnection_","cornerHeight","setOutlinePath","connectedBottomNextConnection","FieldImage","opt_alt","opt_onClick","opt_flipRtl","altText_","Y_PADDING","imageHeight_","setAlt","setOnClickHandler","FieldTextInput","spellcheck_","htmlInput_","isTextValid_","isBeingEdited_","onKeyInputWrapper_","onKeyDownWrapper_","fullBlockClickTarget_","spellcheck","nFields","nConnections","resizeEditor_","htmlInput","INVALID","setSpellcheck","_opt_e","opt_quietInput","quietInput","showPromptEditor_","showInlineEditor_","getValueFromEditorText_","widgetDispose_","widgetCreate_","borderRadius","BORDERRADIUS","strokeColour","boxShadow","getEditorText_","bindInputEvents_","onFinishEditing_","unbindInputEvents_","_value","onHtmlInputKeyDown_","onHtmlInputChange_","TAB","setEditorValue_","BaseBottomRow","BaseStatementInput","RightConnectionShape","BaseTopRow","BaseRenderInfo","isMultiRow","rightAlignedDummyInputs_","WeakMap","adjustXPosition_","alignmentDivider","notchTotalWidth","minXPos","prevSpacer","nextSpacer","hasPrevNotch","hasNextNotch","prevInRowSpacer","finalizeOutputConnection_","outputConnectionShape","rightConnectionWidth","finalizeHorizontalAlignment_","totalNegativeSpacing","lastElem","leftNegPadding","getNegativeSpacing_","firstElem","rightNegPadding","minBlockWidth","outerShape","innerShape","finalizeVerticalAlignment_","firstRow","hasSingleTextOrImageField","hasNonShadowConnectedBlocks","minVerticalTightNestingHeight","BaseMarkerSvg","markerCircle_","showWithInputOutput_","offsetInBlock","positionCircle_","BasePathObject","svgPathSelected_","outlines","remainingOutlines","outline","getOutlinePath_","removeOutlinePath_","BaseRenderer","hasExternalInputs","heightWithoutHat","diff","DARK_PATH_OFFSET","MAX_BOTTOM_WIDTH","Highlighter","inlineSteps_","steps_","RTL_","highlightConstants_","getHighlightConstants","highlightOffset_","OFFSET","outsideCornerPaths_","OUTSIDE_CORNER","insideCornerPaths_","INSIDE_CORNER","puzzleTabPaths_","notchPaths_","startPaths_","jaggedTeethPaths_","getPath","drawTopCorner","drawValueInput","belowTabHeight","drawStatementInput","drawRightSideRow","rightEdge","drawBottomRow","cornerElem","drawLeft","drawInlineInput","connectionRight","bottomHighlightWidth","aboveTabHeight","highlighter_","setHighlightPath","HighlightConstantProvider","constantProvider","makeInsideCorner","makeOutsideCorner","distance45outside","SQRT1_2","pathTopRtl","pathBottomRtl","pathBottomLtr","distance45inside","topLeftCornerHighlightRtl","topLeftCornerHighlightLtr","bottomLeftStartY","bottomLeftPath","highlightRtlUp","highlightRtlDown","verticalOverlap","highlightLtrUp","highlightLtrDown","hatHeight","pathRtl","pathLtr","BaseInlineInput","nextRightEdge","rowNextRightEdges","prevInput","prevRightEdge","colourDark","svgPathDark","svgPathLight","highlightPath","makeHighlightConstants_","fixedX","fixedY","newSurface","blockCanvas","bubbleCanvas","scale_","surfaceXY_","childSurfaceXY_","svg_","dragGroup_","roundX","roundY","translateSurfaceInternal_","translateBy","getWsTranslation","opt_newSurface","currentBlockElement","bumpIntoBounds","addHorizontal","addVertical","corner_","vScroll","hScroll","isPair","resizeH","resizeV","setX","setY","Generator","FUNCTION_NAME_PLACEHOLDER_","STATEMENT_SUFFIX","STATEMENT_PREFIX","INFINITE_LOOP_TRAP","INDENT","COMMENT_WRAP","ORDER_OVERRIDES","isInitialized","RESERVED_WORDS_","definitions_","functionNames_","nameDB_","FUNCTION_NAME_PLACEHOLDER_REGEXP_","RegExp","workspaceToCode","code","blockToCode","scrubNakedValue","injectId","codeString","finish","prefixLines","allNestedComments","opt_thisOnly","scrub_","SyntaxError","valueToCode","outerOrder","innerOrder","parensNeeded","outerOrderClass","innerOrderClass","statementToCode","addLoopTrap","branch","addReservedWords","provideFunction_","desiredName","functionName","PROCEDURE","codeText","oldCodeText","_opt_thisOnly","defineProperties","variableDB_","nameDb","FlyoutButton","isLabel_","svgText_","callbackKey_","cssClass_","svgText","TEXT_MARGIN_X","TEXT_MARGIN_Y","updateTransform_","onMouseUp_","isLabel","getButtonText","MetricsManager","getDimensionsPx_","getFlyoutMetrics","flyoutDimensions","getToolboxMetrics","toolboxDimensions","getSvgMetrics","getAbsoluteMetrics","flyoutMetrics","doesToolboxExist","doesFlyoutExist","atLeft","atTop","opt_getWorkspaceCoordinates","svgMetrics","getContentMetrics","blockBox","getComputedFixedEdges_","opt_viewMetrics","hScrollEnabled","vScrollEnabled","edges","getPaddedContent_","contentMetrics","contentBottom","contentRight","halfWidth","opt_contentMetrics","fixedEdges","paddedContent","contentHeight","contentTop","contentLeft","toolboxWidth","toolboxHeight","flyoutWidth","flyoutHeight","FlyoutMetricsManager","getBoundingBox_","blockBoundingBox","FlyoutItemType","Flyout","eventWrappers_","filterWrapper_","reflowWrapper_","mats_","buttons_","permanentlyDisabled_","recycledBlocks_","SCROLLBAR_MARGIN","dragAngleRange_","setMetrics_","toolboxPosition_","tabWidth_","rectMap_","GAP_X","GAP_Y","wheel_","filterForCapacity_","getFlyoutScale","positionAt_","listen","clearOldBlocks_","getDynamicCategoryContents_","parsedContent","flyoutInfo","createFlyoutInfo_","layout_","gaps","deselectAll","emptyRecycledBlocks_","defaultGap","contentInfo","categoryName","parsedDynamicContent","createFlyoutBlock_","addBlockGap_","addSeparatorGap_","createButton_","BUTTON","fnToApply","btnInfo","curButton","getRecycledBlock_","blockType","gap","sepInfo","newGap","oldBlocks","blockIsRecyclable_","recycleBlock_","addBlockListeners_","blockMouseDown_","originalBlock","placeNewBlock_","initFlyoutButton_","buttonSvg","createRect_","blockHW","moveRectToBlock_","reflowInternal_","oldBlock","svgRootOld","positionNewBlock_","flyoutOffsetPixels","oldBlockPos","oldBlockOffsetPixels","getX","getY","targetWorkspaceViewMetrics","setBackgroundPath_","atRight","cursorX","moveX","dragDirection","atan2","range","flyoutRect","oldX","buttons","FieldVariable","opt_variableTypes","opt_defaultType","defaultType_","variable_","dropdownCreate","defaultVariableName","setTypes_","defaultType","variableType","typeIsAllowed_","typeList","getVariableTypes_","isInArray","FieldNumber","opt_min","opt_max","opt_precision","min_","max_","precision_","decimalPlaces_","setConstraints","setMinInternal_","setMaxInternal_","setPrecisionInternal_","precision","setMin","getMin","setMax","getMax","setPrecision","precisionString","toLocaleString","maximumFractionDigits","decimalIndex","getPrecision","isFinite","toFixed","VALUEMIN","VALUEMAX","FieldMultilineInput","textGroup_","maxLines_","isOverflowedY_","maxLines","setMaxLines","textLines","displayLinesNumber","currentChild","lineHeight","nodes","tspan","actualEditorLines","dummyTextElement","lineWidth","paddingX","paddingY","padding","getMaxLines","FieldLabelSerializable","FieldColour","onMouseLeaveWrapper_","onMouseEnterWrapper_","onClickWrapper_","highlightedIndex_","picker_","titles_","colours_","columns_","colourOptions","colourTitles","columns","setColours","colours","opt_titles","setColumns","cell","moveHighlightBy_","getHighlighted_","COLOURS","COLUMNS","setHighlightedCell_","onMouseMove_","onMouseEnter_","onMouseLeave_","col","titles","TITLES","selectedColour","table","GRID","ROWCOUNT","COLCOUNT","title","GRIDCELL","FieldCheckbox","checkChar_","CHECK_CHAR","checkCharacter","getValueBoolean","setCheckCharacter","character","convertValueToBool_","FieldAngle","moveSurfaceWrapper_","clickSurfaceWrapper_","clickWrapper_","symbol_","line_","gauge_","editor_","clockwise_","CLOCKWISE","offset_","wrap_","WRAP","round_","mode","Mode","COMPASS","PROTRACTOR","clockwise","updateGraph_","HALF","circle","RADIUS","hide_","ownerSVGElement","displayMouseOrKeyboardValue_","wrapValue_","clockwiseFlag","angle1","largeFlag","BlockMove","currentLocation_","oldParentId","parentId","oldInputName","oldCoordinate","coordinate","blockConnection","CommentBase","opt_comment","CommentCreateDeleteHelper","CommentChange","opt_oldContents","opt_newContents","oldContents_","newContents_","CommentCreate","CommentDelete","CommentMove","newCoordinate_","comment_","oldCoordinate_","BlockDrag","opt_isStart","opt_blocks","Ui","FinishedLoading","opt_workspace","BlockDragger","draggingBlock_","draggedConnectionManager_","dragIconData_","fireDragStartEvent_","shouldDisconnect_","disconnectBlock_","dragIcons_","oldWouldDeleteBlock","updateCursorDuringBlockDrag_","fireDragEndEvent_","newValues","getNewLocationAfterDrag_","newLocation","maybeDeleteBlock_","deleted","updateBlockAfterMove_","updateToolboxStyle_","isEnd","VERSION","ALIGN_LEFT","ALIGN_CENTRE","ALIGN_RIGHT","DUMMY_INPUT","TOOLBOX_AT_TOP","TOOLBOX_AT_BOTTOM","TOOLBOX_AT_LEFT","TOOLBOX_AT_RIGHT","VARIABLE_CATEGORY_NAME","VARIABLE_DYNAMIC_CATEGORY_NAME","PROCEDURE_CATEGORY_NAME","Workspace.prototype.newBlock","WorkspaceSvg.prototype.newBlock","WorkspaceSvg.newTrashcan","WorkspaceCommentSvg.prototype.showContextMenu","Mutator.prototype.newWorkspaceSvg","Names.prototype.populateProcedures","procedures","flattenedProcedures","DropDownDiv","dropDownDiv","connectionTypes","serialization","serializationBlocks","exceptions","serializationExceptions","priorities","serializationPriorities","serializationRegistry","serializationVariables","serializationWorkspaces","ContextMenu","ContextMenuItems","Css","Events","Extensions","ShortcutItems","Themes","Tooltip","Touch","WidgetDiv","Xml","blockAnimations","blockRendering","bumpObjects","clipboard","common","dialog","fieldRegistry","geras","minimalist","thrasos","uiPosition","utils","zelos","Blockly","eventUtils","newAlert","newConfirm","newPrompt","HSV_SATURATION","HSV_VALUE","record","DIV"],"mappings":"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","file":"blockly_compressed.js","sourcesContent":["/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * This file is a universal registry that provides generic methods\n *    for registering and unregistering different types of classes.\n *\n * @namespace Blockly.registry\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.registry');\n\nimport type {Abstract} from './events/events_abstract.js';\nimport type {Field} from './field.js';\nimport type {IBlockDragger} from './interfaces/i_block_dragger.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport type {ISerializer} from './interfaces/i_serializer.js';\nimport type {IToolbox} from './interfaces/i_toolbox.js';\nimport type {Cursor} from './keyboard_nav/cursor.js';\nimport type {Options} from './options.js';\nimport type {Renderer} from './renderers/common/renderer.js';\nimport type {Theme} from './theme.js';\nimport type {ToolboxItem} from './toolbox/toolbox_item.js';\n\n\n/**\n * A map of maps. With the keys being the type and name of the class we are\n * registering and the value being the constructor function.\n * e.g. {'field': {'field_angle': Blockly.FieldAngle}}\n */\nconst typeMap: {\n  [key: string]:\n      {[key: string]: (new () => AnyDuringMigration)|AnyDuringMigration}\n} = Object.create(null);\nexport const TEST_ONLY = {typeMap};\n\n/**\n * A map of maps. With the keys being the type and caseless name of the class we\n * are registring, and the value being the most recent cased name for that\n * registration.\n */\nconst nameMap: {[key: string]: {[key: string]: string}} = Object.create(null);\n\n/**\n * The string used to register the default class for a type of plugin.\n *\n * @alias Blockly.registry.DEFAULT\n */\nexport const DEFAULT = 'default';\n\n/**\n * A name with the type of the element stored in the generic.\n *\n * @alias Blockly.registry.Type\n */\nexport class Type<_T> {\n  /** @param name The name of the registry type. */\n  constructor(private readonly name: string) {}\n\n  /**\n   * Returns the name of the type.\n   *\n   * @returns The name.\n   */\n  toString(): string {\n    return this.name;\n  }\n\n  static CONNECTION_CHECKER = new Type<IConnectionChecker>('connectionChecker');\n\n  static CURSOR = new Type<Cursor>('cursor');\n\n  static EVENT = new Type<Abstract>('event');\n\n  static FIELD = new Type<Field>('field');\n\n  static RENDERER = new Type<Renderer>('renderer');\n\n  static TOOLBOX = new Type<IToolbox>('toolbox');\n\n  static THEME = new Type<Theme>('theme');\n\n  static TOOLBOX_ITEM = new Type<ToolboxItem>('toolboxItem');\n\n  static FLYOUTS_VERTICAL_TOOLBOX = new Type<IFlyout>('flyoutsVerticalToolbox');\n\n  static FLYOUTS_HORIZONTAL_TOOLBOX =\n      new Type<IFlyout>('flyoutsHorizontalToolbox');\n\n  static METRICS_MANAGER = new Type<IMetricsManager>('metricsManager');\n\n  static BLOCK_DRAGGER = new Type<IBlockDragger>('blockDragger');\n\n  /** @internal */\n  static SERIALIZER = new Type<ISerializer>('serializer');\n}\n\n/**\n * Registers a class based on a type and name.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @param registryItem The class or object to register.\n * @param opt_allowOverrides True to prevent an error when overriding an already\n *     registered item.\n * @throws {Error} if the type or name is empty, a name with the given type has\n *     already been registered, or if the given class or object is not valid for\n *     its type.\n * @alias Blockly.registry.register\n */\nexport function register<T>(\n    type: string|Type<T>, name: string,\n    registryItem: (new (...p1: AnyDuringMigration[]) => T)|null|\n    AnyDuringMigration,\n    opt_allowOverrides?: boolean): void {\n  if (!(type instanceof Type) && typeof type !== 'string' ||\n      String(type).trim() === '') {\n    throw Error(\n        'Invalid type \"' + type + '\". The type must be a' +\n        ' non-empty string or a Blockly.registry.Type.');\n  }\n  type = String(type).toLowerCase();\n\n  if (typeof name !== 'string' || name.trim() === '') {\n    throw Error(\n        'Invalid name \"' + name + '\". The name must be a' +\n        ' non-empty string.');\n  }\n  const caselessName = name.toLowerCase();\n  if (!registryItem) {\n    throw Error('Can not register a null value');\n  }\n  let typeRegistry = typeMap[type];\n  let nameRegistry = nameMap[type];\n  // If the type registry has not been created, create it.\n  if (!typeRegistry) {\n    typeRegistry = typeMap[type] = Object.create(null);\n    nameRegistry = nameMap[type] = Object.create(null);\n  }\n\n  // Validate that the given class has all the required properties.\n  validate(type, registryItem);\n\n  // Don't throw an error if opt_allowOverrides is true.\n  if (!opt_allowOverrides && typeRegistry[caselessName]) {\n    throw Error(\n        'Name \"' + caselessName + '\" with type \"' + type +\n        '\" already registered.');\n  }\n  typeRegistry[caselessName] = registryItem;\n  nameRegistry[caselessName] = name;\n}\n\n/**\n * Checks the given registry item for properties that are required based on the\n * type.\n *\n * @param type The type of the plugin. (e.g. Field, Renderer)\n * @param registryItem A class or object that we are checking for the required\n *     properties.\n */\nfunction validate(type: string, registryItem: Function|AnyDuringMigration) {\n  switch (type) {\n    case String(Type.FIELD):\n      if (typeof registryItem.fromJson !== 'function') {\n        throw Error('Type \"' + type + '\" must have a fromJson function');\n      }\n      break;\n  }\n}\n\n/**\n * Unregisters the registry item with the given type and name.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @alias Blockly.registry.unregister\n */\nexport function unregister<T>(type: string|Type<T>, name: string) {\n  type = String(type).toLowerCase();\n  name = name.toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry || !typeRegistry[name]) {\n    console.warn(\n        'Unable to unregister [' + name + '][' + type + '] from the ' +\n        'registry.');\n    return;\n  }\n  delete typeMap[type][name];\n  delete nameMap[type][name];\n}\n\n/**\n * Gets the registry item for the given name and type. This can be either a\n * class or an object.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the plugin.\n * @returns The class or object with the given name and type or null if none\n *     exists.\n */\nfunction getItem<T>(\n    type: string|Type<T>, name: string, opt_throwIfMissing?: boolean):\n    (new (...p1: AnyDuringMigration[]) => T)|null|AnyDuringMigration {\n  type = String(type).toLowerCase();\n  name = name.toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry || !typeRegistry[name]) {\n    const msg = 'Unable to find [' + name + '][' + type + '] in the registry.';\n    if (opt_throwIfMissing) {\n      throw new Error(\n          msg + ' You must require or register a ' + type + ' plugin.');\n    } else {\n      console.warn(msg);\n    }\n    return null;\n  }\n  return typeRegistry[name];\n}\n\n/**\n * Returns whether or not the registry contains an item with the given type and\n * name.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @returns True if the registry has an item with the given type and name, false\n *     otherwise.\n * @alias Blockly.registry.hasItem\n */\nexport function hasItem<T>(type: string|Type<T>, name: string): boolean {\n  type = String(type).toLowerCase();\n  name = name.toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry) {\n    return false;\n  }\n  return !!typeRegistry[name];\n}\n\n/**\n * Gets the class for the given name and type.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the plugin.\n * @returns The class with the given name and type or null if none exists.\n * @alias Blockly.registry.getClass\n */\nexport function getClass<T>(\n    type: string|Type<T>, name: string, opt_throwIfMissing?: boolean):\n    (new (...p1: AnyDuringMigration[]) => T)|null {\n  return getItem(type, name, opt_throwIfMissing) as (\n             new (...p1: AnyDuringMigration[]) => T) |\n      null;\n}\n\n/**\n * Gets the object for the given name and type.\n *\n * @param type The type of the plugin.\n *     (e.g. Category)\n * @param name The plugin's name. (Ex. logic_category)\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the object.\n * @returns The object with the given name and type or null if none exists.\n * @alias Blockly.registry.getObject\n */\nexport function getObject<T>(\n    type: string|Type<T>, name: string, opt_throwIfMissing?: boolean): T|null {\n  return getItem(type, name, opt_throwIfMissing) as T;\n}\n\n/**\n * Returns a map of items registered with the given type.\n *\n * @param type The type of the plugin. (e.g. Category)\n * @param opt_cased Whether or not to return a map with cased keys (rather than\n *     caseless keys). False by default.\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the object. False by default.\n * @returns A map of objects with the given type, or null if none exists.\n * @alias Blockly.registry.getAllItems\n */\nexport function getAllItems<T>(\n    type: string|Type<T>, opt_cased?: boolean, opt_throwIfMissing?: boolean):\n    {[key: string]: T|null|(new (...p1: AnyDuringMigration[]) => T)}|null {\n  type = String(type).toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry) {\n    const msg = `Unable to find [${type}] in the registry.`;\n    if (opt_throwIfMissing) {\n      throw new Error(`${msg} You must require or register a ${type} plugin.`);\n    } else {\n      console.warn(msg);\n    }\n    return null;\n  }\n  if (!opt_cased) {\n    return typeRegistry;\n  }\n  const nameRegistry = nameMap[type];\n  const casedRegistry = Object.create(null);\n  const keys = Object.keys(typeRegistry);\n  for (let i = 0; i < keys.length; i++) {\n    const key = keys[i];\n    casedRegistry[nameRegistry[key]] = typeRegistry[key];\n  }\n  return casedRegistry;\n}\n\n/**\n * Gets the class from Blockly options for the given type.\n * This is used for plugins that override a built in feature. (e.g. Toolbox)\n *\n * @param type The type of the plugin.\n * @param options The option object to check for the given plugin.\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the plugin.\n * @returns The class for the plugin.\n * @alias Blockly.registry.getClassFromOptions\n */\nexport function getClassFromOptions<T>(\n    type: Type<T>, options: Options, opt_throwIfMissing?: boolean):\n    (new (...p1: AnyDuringMigration[]) => T)|null {\n  const typeName = type.toString();\n  const plugin = options.plugins[typeName] || DEFAULT;\n\n  // If the user passed in a plugin class instead of a registered plugin name.\n  if (typeof plugin === 'function') {\n    return plugin;\n  }\n  return getClass(type, plugin, opt_throwIfMissing);\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Common functions used both internally and externally, but which\n * must not be at the top level to avoid circular dependencies.\n *\n * @namespace Blockly.common\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.common');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Block} from './block.js';\nimport {BlockDefinition, Blocks} from './blocks.js';\nimport type {Connection} from './connection.js';\nimport type {ICopyable} from './interfaces/i_copyable.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/** Database of all workspaces. */\nconst WorkspaceDB_ = Object.create(null);\n\n\n/**\n * Find the workspace with the specified ID.\n *\n * @param id ID of workspace to find.\n * @returns The sought after workspace or null if not found.\n */\nexport function getWorkspaceById(id: string): Workspace|null {\n  return WorkspaceDB_[id] || null;\n}\n\n/**\n * Find all workspaces.\n *\n * @returns Array of workspaces.\n */\nexport function getAllWorkspaces(): Workspace[] {\n  const workspaces = [];\n  for (const workspaceId in WorkspaceDB_) {\n    workspaces.push(WorkspaceDB_[workspaceId]);\n  }\n  return workspaces;\n}\n\n/**\n * Register a workspace in the workspace db.\n *\n * @param workspace\n */\nexport function registerWorkspace(workspace: Workspace) {\n  WorkspaceDB_[workspace.id] = workspace;\n}\n\n/**\n * Unregister a workspace from the workspace db.\n *\n * @param workspace\n */\nexport function unregisterWorkpace(workspace: Workspace) {\n  delete WorkspaceDB_[workspace.id];\n}\n\n/**\n * The main workspace most recently used.\n * Set by Blockly.WorkspaceSvg.prototype.markFocused\n */\nlet mainWorkspace: Workspace;\n\n/**\n * Returns the last used top level workspace (based on focus).  Try not to use\n * this function, particularly if there are multiple Blockly instances on a\n * page.\n *\n * @returns The main workspace.\n * @alias Blockly.common.getMainWorkspace\n */\nexport function getMainWorkspace(): Workspace {\n  return mainWorkspace;\n}\n\n/**\n * Sets last used main workspace.\n *\n * @param workspace The most recently used top level workspace.\n * @alias Blockly.common.setMainWorkspace\n */\nexport function setMainWorkspace(workspace: Workspace) {\n  mainWorkspace = workspace;\n}\n\n/**\n * Currently selected copyable object.\n */\nlet selected: ICopyable|null = null;\n\n/**\n * Returns the currently selected copyable object.\n *\n * @alias Blockly.common.getSelected\n */\nexport function getSelected(): ICopyable|null {\n  return selected;\n}\n\n/**\n * Sets the currently selected block. This function does not visually mark the\n * block as selected or fire the required events. If you wish to\n * programmatically select a block, use `BlockSvg#select`.\n *\n * @param newSelection The newly selected block.\n * @alias Blockly.common.setSelected\n * @internal\n */\nexport function setSelected(newSelection: ICopyable|null) {\n  selected = newSelection;\n}\n\n/**\n * Container element in which to render the WidgetDiv, DropDownDiv and Tooltip.\n */\nlet parentContainer: Element|null;\n\n/**\n * Get the container element in which to render the WidgetDiv, DropDownDiv and\n * Tooltip.\n *\n * @returns The parent container.\n * @alias Blockly.common.getParentContainer\n */\nexport function getParentContainer(): Element|null {\n  return parentContainer;\n}\n\n/**\n * Set the parent container.  This is the container element that the WidgetDiv,\n * DropDownDiv, and Tooltip are rendered into the first time `Blockly.inject`\n * is called.\n * This method is a NOP if called after the first `Blockly.inject`.\n *\n * @param newParent The container element.\n * @alias Blockly.common.setParentContainer\n */\nexport function setParentContainer(newParent: Element) {\n  parentContainer = newParent;\n}\n\n/**\n * Size the SVG image to completely fill its container. Call this when the view\n * actually changes sizes (e.g. on a window resize/device orientation change).\n * See workspace.resizeContents to resize the workspace when the contents\n * change (e.g. when a block is added or removed).\n * Record the height/width of the SVG image.\n *\n * @param workspace Any workspace in the SVG.\n * @alias Blockly.common.svgResize\n */\nexport function svgResize(workspace: WorkspaceSvg) {\n  let mainWorkspace = workspace;\n  while (mainWorkspace.options.parentWorkspace) {\n    mainWorkspace = mainWorkspace.options.parentWorkspace;\n  }\n  const svg = mainWorkspace.getParentSvg();\n  const cachedSize = mainWorkspace.getCachedParentSvgSize();\n  const div = svg.parentElement;\n  if (!(div instanceof HTMLElement)) {\n    // Workspace deleted, or something.\n    return;\n  }\n\n  const width = div.offsetWidth;\n  const height = div.offsetHeight;\n  if (cachedSize.width !== width) {\n    svg.setAttribute('width', width + 'px');\n    mainWorkspace.setCachedParentSvgSize(width, null);\n  }\n  if (cachedSize.height !== height) {\n    svg.setAttribute('height', height + 'px');\n    mainWorkspace.setCachedParentSvgSize(null, height);\n  }\n  mainWorkspace.resize();\n}\n\n/**\n * All of the connections on blocks that are currently being dragged.\n */\nexport const draggingConnections: Connection[] = [];\n\n/**\n * Get a map of all the block's descendants mapping their type to the number of\n *    children with that type.\n *\n * @param block The block to map.\n * @param opt_stripFollowing Optionally ignore all following\n *    statements (blocks that are not inside a value or statement input\n *    of the block).\n * @returns Map of types to type counts for descendants of the bock.\n * @alias Blockly.common.getBlockTypeCounts\n */\nexport function getBlockTypeCounts(\n    block: Block, opt_stripFollowing?: boolean): {[key: string]: number} {\n  const typeCountsMap = Object.create(null);\n  const descendants = block.getDescendants(true);\n  if (opt_stripFollowing) {\n    const nextBlock = block.getNextBlock();\n    if (nextBlock) {\n      const index = descendants.indexOf(nextBlock);\n      descendants.splice(index, descendants.length - index);\n    }\n  }\n  for (let i = 0, checkBlock; checkBlock = descendants[i]; i++) {\n    if (typeCountsMap[checkBlock.type]) {\n      typeCountsMap[checkBlock.type]++;\n    } else {\n      typeCountsMap[checkBlock.type] = 1;\n    }\n  }\n  return typeCountsMap;\n}\n\n/**\n * Helper function for defining a block from JSON.  The resulting function has\n * the correct value of jsonDef at the point in code where jsonInit is called.\n *\n * @param jsonDef The JSON definition of a block.\n * @returns A function that calls jsonInit with the correct value\n *     of jsonDef.\n */\nfunction jsonInitFactory(jsonDef: AnyDuringMigration): () => void {\n  return function(this: Block) {\n    this.jsonInit(jsonDef);\n  };\n}\n\n/**\n * Define blocks from an array of JSON block definitions, as might be generated\n * by the Blockly Developer Tools.\n *\n * @param jsonArray An array of JSON block definitions.\n * @alias Blockly.common.defineBlocksWithJsonArray\n */\nexport function defineBlocksWithJsonArray(jsonArray: AnyDuringMigration[]) {\n  TEST_ONLY.defineBlocksWithJsonArrayInternal(jsonArray);\n}\n\n/**\n * Private version of defineBlocksWithJsonArray for stubbing in tests.\n */\nfunction defineBlocksWithJsonArrayInternal(jsonArray: AnyDuringMigration[]) {\n  defineBlocks(createBlockDefinitionsFromJsonArray(jsonArray));\n}\n\n/**\n * Define blocks from an array of JSON block definitions, as might be generated\n * by the Blockly Developer Tools.\n *\n * @param jsonArray An array of JSON block definitions.\n * @returns A map of the block\n *     definitions created.\n * @alias Blockly.common.defineBlocksWithJsonArray\n */\nexport function createBlockDefinitionsFromJsonArray(\n    jsonArray: AnyDuringMigration[]): {[key: string]: BlockDefinition} {\n  const blocks: {[key: string]: BlockDefinition} = {};\n  for (let i = 0; i < jsonArray.length; i++) {\n    const elem = jsonArray[i];\n    if (!elem) {\n      console.warn(`Block definition #${i} in JSON array is ${elem}. Skipping`);\n      continue;\n    }\n    const type = elem['type'];\n    if (!type) {\n      console.warn(\n          `Block definition #${i} in JSON array is missing a type attribute. ` +\n          'Skipping.');\n      continue;\n    }\n    blocks[type] = {init: jsonInitFactory(elem)};\n  }\n  return blocks;\n}\n\n/**\n * Add the specified block definitions to the block definitions\n * dictionary (Blockly.Blocks).\n *\n * @param blocks A map of block\n *     type names to block definitions.\n * @alias Blockly.common.defineBlocks\n */\nexport function defineBlocks(blocks: {[key: string]: BlockDefinition}) {\n  // Iterate over own enumerable properties.\n  for (const type of Object.keys(blocks)) {\n    const definition = blocks[type];\n    if (type in Blocks) {\n      console.warn(`Block definiton \"${type}\" overwrites previous definition.`);\n    }\n    Blocks[type] = definition;\n  }\n}\n\nexport const TEST_ONLY = {defineBlocksWithJsonArrayInternal};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Generators for unique IDs.\n *\n * @namespace Blockly.utils.idGenerator\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.idGenerator');\n\n/**\n * Legal characters for the universally unique IDs.  Should be all on\n * a US keyboard.  No characters that conflict with XML or JSON.\n * Requests to remove additional 'problematic' characters from this\n * soup will be denied.  That's your failure to properly escape in\n * your own environment.  Issues #251, #625, #682, #1304.\n */\nconst soup = '!#$%()*+,-./:;=?@[]^_`{|}~' +\n    'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\n/**\n * Namespace object for internal implementations we want to be able to\n * stub in tests. Do not use externally.\n *\n * @internal\n */\nconst internal = {\n  /**\n   * Generate a random unique ID.  This should be globally unique.\n   * 87 characters ^ 20 length is greater than 128 bits (better than a UUID).\n   *\n   * @returns A globally unique ID string.\n   */\n  genUid: () => {\n    const length = 20;\n    const soupLength = soup.length;\n    const id = [];\n    for (let i = 0; i < length; i++) {\n      id[i] = soup.charAt(Math.random() * soupLength);\n    }\n    return id.join('');\n  },\n};\nexport const TEST_ONLY = internal;\n\n/** Next unique ID to use. */\nlet nextId = 0;\n\n/**\n * Generate the next unique element IDs.\n * IDs are compatible with the HTML4 id attribute restrictions:\n * Use only ASCII letters, digits, '_', '-' and '.'\n *\n * For UUIDs use genUid (below) instead; this ID generator should\n * primarily be used for IDs that end up in the DOM.\n *\n * @returns The next unique identifier.\n * @alias Blockly.utils.idGenerator.getNextUniqueId\n */\nexport function getNextUniqueId(): string {\n  return 'blockly-' + (nextId++).toString(36);\n}\n\n/**\n * Generate a random unique ID.\n *\n * @see internal.genUid\n * @returns A globally unique ID string.\n * @alias Blockly.utils.idGenerator.genUid\n */\nexport function genUid(): string {\n  return internal.genUid();\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Helper methods for events that are fired as a result of\n * actions in Blockly's editor.\n *\n * @namespace Blockly.Events.utils\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.utils');\n\nimport type {Block} from '../block.js';\nimport * as common from '../common.js';\nimport * as registry from '../registry.js';\nimport * as idGenerator from '../utils/idgenerator.js';\nimport type {Workspace} from '../workspace.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\nimport type {Abstract} from './events_abstract.js';\nimport type {BlockChange} from './events_block_change.js';\nimport type {BlockCreate} from './events_block_create.js';\nimport type {BlockMove} from './events_block_move.js';\nimport type {CommentCreate} from './events_comment_create.js';\nimport type {CommentMove} from './events_comment_move.js';\nimport type {ViewportChange} from './events_viewport.js';\n\n\n/** Group ID for new events.  Grouped events are indivisible. */\nlet group = '';\n\n/** Sets whether the next event should be added to the undo stack. */\nlet recordUndo = true;\n\n/**\n * Sets whether events should be added to the undo stack.\n *\n * @param newValue True if events should be added to the undo stack.\n * @alias Blockly.Events.utils.setRecordUndo\n */\nexport function setRecordUndo(newValue: boolean) {\n  recordUndo = newValue;\n}\n\n/**\n * Returns whether or not events will be added to the undo stack.\n *\n * @returns True if events will be added to the undo stack.\n * @alias Blockly.Events.utils.getRecordUndo\n */\nexport function getRecordUndo(): boolean {\n  return recordUndo;\n}\n\n/** Allow change events to be created and fired. */\nlet disabled = 0;\n\n/**\n * Name of event that creates a block. Will be deprecated for BLOCK_CREATE.\n *\n * @alias Blockly.Events.utils.CREATE\n */\nexport const CREATE = 'create';\n\n/**\n * Name of event that creates a block.\n *\n * @alias Blockly.Events.utils.BLOCK_CREATE\n */\nexport const BLOCK_CREATE = CREATE;\n\n/**\n * Name of event that deletes a block. Will be deprecated for BLOCK_DELETE.\n *\n * @alias Blockly.Events.utils.DELETE\n */\nexport const DELETE = 'delete';\n\n/**\n * Name of event that deletes a block.\n *\n * @alias Blockly.Events.utils.BLOCK_DELETE\n */\nexport const BLOCK_DELETE = DELETE;\n\n/**\n * Name of event that changes a block. Will be deprecated for BLOCK_CHANGE.\n *\n * @alias Blockly.Events.utils.CHANGE\n */\nexport const CHANGE = 'change';\n\n/**\n * Name of event that changes a block.\n *\n * @alias Blockly.Events.utils.BLOCK_CHANGE\n */\nexport const BLOCK_CHANGE = CHANGE;\n\n/**\n * Name of event that moves a block. Will be deprecated for BLOCK_MOVE.\n *\n * @alias Blockly.Events.utils.MOVE\n */\nexport const MOVE = 'move';\n\n/**\n * Name of event that moves a block.\n *\n * @alias Blockly.Events.utils.BLOCK_MOVE\n */\nexport const BLOCK_MOVE = MOVE;\n\n/**\n * Name of event that creates a variable.\n *\n * @alias Blockly.Events.utils.VAR_CREATE\n */\nexport const VAR_CREATE = 'var_create';\n\n/**\n * Name of event that deletes a variable.\n *\n * @alias Blockly.Events.utils.VAR_DELETE\n */\nexport const VAR_DELETE = 'var_delete';\n\n/**\n * Name of event that renames a variable.\n *\n * @alias Blockly.Events.utils.VAR_RENAME\n */\nexport const VAR_RENAME = 'var_rename';\n\n/**\n * Name of generic event that records a UI change.\n *\n * @alias Blockly.Events.utils.UI\n */\nexport const UI = 'ui';\n\n/**\n * Name of event that record a block drags a block.\n *\n * @alias Blockly.Events.utils.BLOCK_DRAG\n */\nexport const BLOCK_DRAG = 'drag';\n\n/**\n * Name of event that records a change in selected element.\n *\n * @alias Blockly.Events.utils.SELECTED\n */\nexport const SELECTED = 'selected';\n\n/**\n * Name of event that records a click.\n *\n * @alias Blockly.Events.utils.CLICK\n */\nexport const CLICK = 'click';\n\n/**\n * Name of event that records a marker move.\n *\n * @alias Blockly.Events.utils.MARKER_MOVE\n */\nexport const MARKER_MOVE = 'marker_move';\n\n/**\n * Name of event that records a bubble open.\n *\n * @alias Blockly.Events.utils.BUBBLE_OPEN\n */\nexport const BUBBLE_OPEN = 'bubble_open';\n\n/**\n * Name of event that records a trashcan open.\n *\n * @alias Blockly.Events.utils.TRASHCAN_OPEN\n */\nexport const TRASHCAN_OPEN = 'trashcan_open';\n\n/**\n * Name of event that records a toolbox item select.\n *\n * @alias Blockly.Events.utils.TOOLBOX_ITEM_SELECT\n */\nexport const TOOLBOX_ITEM_SELECT = 'toolbox_item_select';\n\n/**\n * Name of event that records a theme change.\n *\n * @alias Blockly.Events.utils.THEME_CHANGE\n */\nexport const THEME_CHANGE = 'theme_change';\n\n/**\n * Name of event that records a viewport change.\n *\n * @alias Blockly.Events.utils.VIEWPORT_CHANGE\n */\nexport const VIEWPORT_CHANGE = 'viewport_change';\n\n/**\n * Name of event that creates a comment.\n *\n * @alias Blockly.Events.utils.COMMENT_CREATE\n */\nexport const COMMENT_CREATE = 'comment_create';\n\n/**\n * Name of event that deletes a comment.\n *\n * @alias Blockly.Events.utils.COMMENT_DELETE\n */\nexport const COMMENT_DELETE = 'comment_delete';\n\n/**\n * Name of event that changes a comment.\n *\n * @alias Blockly.Events.utils.COMMENT_CHANGE\n */\nexport const COMMENT_CHANGE = 'comment_change';\n\n/**\n * Name of event that moves a comment.\n *\n * @alias Blockly.Events.utils.COMMENT_MOVE\n */\nexport const COMMENT_MOVE = 'comment_move';\n\n/**\n * Name of event that records a workspace load.\n *\n * @alias Blockly.Events.utils.FINISHED_LOADING\n */\nexport const FINISHED_LOADING = 'finished_loading';\n\n/**\n * Type of events that cause objects to be bumped back into the visible\n * portion of the workspace.\n *\n * Not to be confused with bumping so that disconnected connections do not\n * appear connected.\n *\n * @alias Blockly.Events.utils.BumpEvent\n */\nexport type BumpEvent = BlockCreate|BlockMove|CommentCreate|CommentMove;\n\n/**\n * List of events that cause objects to be bumped back into the visible\n * portion of the workspace.\n *\n * Not to be confused with bumping so that disconnected connections do not\n * appear connected.\n *\n * @alias Blockly.Events.utils.BUMP_EVENTS\n */\nexport const BUMP_EVENTS: string[] =\n    [BLOCK_CREATE, BLOCK_MOVE, COMMENT_CREATE, COMMENT_MOVE];\n\n/** List of events queued for firing. */\nconst FIRE_QUEUE: Abstract[] = [];\n\n/**\n * Create a custom event and fire it.\n *\n * @param event Custom data for event.\n * @alias Blockly.Events.utils.fire\n */\nexport function fire(event: Abstract) {\n  TEST_ONLY.fireInternal(event);\n}\n\n/**\n * Private version of fireInternal for stubbing in tests.\n */\nfunction fireInternal(event: Abstract) {\n  if (!isEnabled()) {\n    return;\n  }\n  if (!FIRE_QUEUE.length) {\n    // First event added; schedule a firing of the event queue.\n    setTimeout(fireNow, 0);\n  }\n  FIRE_QUEUE.push(event);\n}\n\n\n/** Fire all queued events. */\nfunction fireNow() {\n  const queue = filter(FIRE_QUEUE, true);\n  FIRE_QUEUE.length = 0;\n  for (let i = 0, event; event = queue[i]; i++) {\n    if (!event.workspaceId) {\n      continue;\n    }\n    const eventWorkspace = common.getWorkspaceById(event.workspaceId);\n    if (eventWorkspace) {\n      eventWorkspace.fireChangeListener(event);\n    }\n  }\n}\n\n/**\n * Filter the queued events and merge duplicates.\n *\n * @param queueIn Array of events.\n * @param forward True if forward (redo), false if backward (undo).\n * @returns Array of filtered events.\n * @alias Blockly.Events.utils.filter\n */\nexport function filter(queueIn: Abstract[], forward: boolean): Abstract[] {\n  let queue = queueIn.slice();\n  // Shallow copy of queue.\n  if (!forward) {\n    // Undo is merged in reverse order.\n    queue.reverse();\n  }\n  const mergedQueue = [];\n  const hash = Object.create(null);\n  // Merge duplicates.\n  for (let i = 0, event; event = queue[i]; i++) {\n    if (!event.isNull()) {\n      // Treat all UI events as the same type in hash table.\n      const eventType = event.isUiEvent ? UI : event.type;\n      // TODO(#5927): Check whether `blockId` exists before accessing it.\n      const blockId = (event as AnyDuringMigration).blockId;\n      const key = [eventType, blockId, event.workspaceId].join(' ');\n\n      const lastEntry = hash[key];\n      const lastEvent = lastEntry ? lastEntry.event : null;\n      if (!lastEntry) {\n        // Each item in the hash table has the event and the index of that event\n        // in the input array.  This lets us make sure we only merge adjacent\n        // move events.\n        hash[key] = {event, index: i};\n        mergedQueue.push(event);\n      } else if (event.type === MOVE && lastEntry.index === i - 1) {\n        const moveEvent = event as BlockMove;\n        // Merge move events.\n        lastEvent.newParentId = moveEvent.newParentId;\n        lastEvent.newInputName = moveEvent.newInputName;\n        lastEvent.newCoordinate = moveEvent.newCoordinate;\n        lastEntry.index = i;\n      } else if (\n          event.type === CHANGE &&\n          (event as BlockChange).element === lastEvent.element &&\n          (event as BlockChange).name === lastEvent.name) {\n        const changeEvent = event as BlockChange;\n        // Merge change events.\n        lastEvent.newValue = changeEvent.newValue;\n      } else if (event.type === VIEWPORT_CHANGE) {\n        const viewportEvent = event as ViewportChange;\n        // Merge viewport change events.\n        lastEvent.viewTop = viewportEvent.viewTop;\n        lastEvent.viewLeft = viewportEvent.viewLeft;\n        lastEvent.scale = viewportEvent.scale;\n        lastEvent.oldScale = viewportEvent.oldScale;\n      } else if (event.type === CLICK && lastEvent.type === BUBBLE_OPEN) {\n        // Drop click events caused by opening/closing bubbles.\n      } else {\n        // Collision: newer events should merge into this event to maintain\n        // order.\n        hash[key] = {event, index: i};\n        mergedQueue.push(event);\n      }\n    }\n  }\n  // Filter out any events that have become null due to merging.\n  queue = mergedQueue.filter(function(e) {\n    return !e.isNull();\n  });\n  if (!forward) {\n    // Restore undo order.\n    queue.reverse();\n  }\n  // Move mutation events to the top of the queue.\n  // Intentionally skip first event.\n  for (let i = 1, event; event = queue[i]; i++) {\n    // AnyDuringMigration because:  Property 'element' does not exist on type\n    // 'Abstract'.\n    if (event.type === CHANGE &&\n        (event as AnyDuringMigration).element === 'mutation') {\n      queue.unshift(queue.splice(i, 1)[0]);\n    }\n  }\n  return queue;\n}\n\n/**\n * Modify pending undo events so that when they are fired they don't land\n * in the undo stack.  Called by Workspace.clearUndo.\n *\n * @alias Blockly.Events.utils.clearPendingUndo\n */\nexport function clearPendingUndo() {\n  for (let i = 0, event; event = FIRE_QUEUE[i]; i++) {\n    event.recordUndo = false;\n  }\n}\n\n/**\n * Stop sending events.  Every call to this function MUST also call enable.\n *\n * @alias Blockly.Events.utils.disable\n */\nexport function disable() {\n  disabled++;\n}\n\n/**\n * Start sending events.  Unless events were already disabled when the\n * corresponding call to disable was made.\n *\n * @alias Blockly.Events.utils.enable\n */\nexport function enable() {\n  disabled--;\n}\n\n/**\n * Returns whether events may be fired or not.\n *\n * @returns True if enabled.\n * @alias Blockly.Events.utils.isEnabled\n */\nexport function isEnabled(): boolean {\n  return disabled === 0;\n}\n\n/**\n * Current group.\n *\n * @returns ID string.\n * @alias Blockly.Events.utils.getGroup\n */\nexport function getGroup(): string {\n  return group;\n}\n\n/**\n * Start or stop a group.\n *\n * @param state True to start new group, false to end group.\n *   String to set group explicitly.\n * @alias Blockly.Events.utils.setGroup\n */\nexport function setGroup(state: boolean|string) {\n  TEST_ONLY.setGroupInternal(state);\n}\n\n/**\n * Private version of setGroup for stubbing in tests.\n */\nfunction setGroupInternal(state: boolean|string) {\n  if (typeof state === 'boolean') {\n    group = state ? idGenerator.genUid() : '';\n  } else {\n    group = state;\n  }\n}\n\n/**\n * Compute a list of the IDs of the specified block and all its descendants.\n *\n * @param block The root block.\n * @returns List of block IDs.\n * @alias Blockly.Events.utils.getDescendantIds\n * @internal\n */\nexport function getDescendantIds(block: Block): string[] {\n  const ids = [];\n  const descendants = block.getDescendants(false);\n  for (let i = 0, descendant; descendant = descendants[i]; i++) {\n    ids[i] = descendant.id;\n  }\n  return ids;\n}\n\n/**\n * Decode the JSON into an event.\n *\n * @param json JSON representation.\n * @param workspace Target workspace for event.\n * @returns The event represented by the JSON.\n * @throws {Error} if an event type is not found in the registry.\n * @alias Blockly.Events.utils.fromJson\n */\nexport function fromJson(\n    json: AnyDuringMigration, workspace: Workspace): Abstract {\n  const eventClass = get(json['type']);\n  if (!eventClass) {\n    throw Error('Unknown event type.');\n  }\n  const event = new eventClass();\n  event.fromJson(json);\n  event.workspaceId = workspace.id;\n  return event;\n}\n\n/**\n * Gets the class for a specific event type from the registry.\n *\n * @param eventType The type of the event to get.\n * @returns The event class with the given type.\n * @alias Blockly.Events.utils.get\n */\nexport function get(eventType: string):\n    (new (...p1: AnyDuringMigration[]) => Abstract) {\n  const event = registry.getClass(registry.Type.EVENT, eventType);\n  if (!event) {\n    throw new Error(`Event type ${eventType} not found in registry.`);\n  }\n  return event;\n}\n\n/**\n * Enable/disable a block depending on whether it is properly connected.\n * Use this on applications where all blocks should be connected to a top block.\n * Recommend setting the 'disable' option to 'false' in the config so that\n * users don't try to re-enable disabled orphan blocks.\n *\n * @param event Custom data for event.\n * @alias Blockly.Events.utils.disableOrphans\n */\nexport function disableOrphans(event: Abstract) {\n  if (event.type === MOVE || event.type === CREATE) {\n    const blockEvent = event as BlockMove | BlockCreate;\n    if (!blockEvent.workspaceId) {\n      return;\n    }\n    const eventWorkspace =\n        common.getWorkspaceById(blockEvent.workspaceId) as WorkspaceSvg;\n    let block = eventWorkspace.getBlockById(blockEvent.blockId);\n    if (block) {\n      // Changing blocks as part of this event shouldn't be undoable.\n      const initialUndoFlag = recordUndo;\n      try {\n        recordUndo = false;\n        const parent = block.getParent();\n        if (parent && parent.isEnabled()) {\n          const children = block.getDescendants(false);\n          for (let i = 0, child; child = children[i]; i++) {\n            child.setEnabled(true);\n          }\n        } else if (\n            (block.outputConnection || block.previousConnection) &&\n            !eventWorkspace.isDragging()) {\n          do {\n            block.setEnabled(false);\n            block = block.getNextBlock();\n          } while (block);\n        }\n      } finally {\n        recordUndo = initialUndoFlag;\n      }\n    }\n  }\n}\n\nexport const TEST_ONLY = {\n  FIRE_QUEUE,\n  fireNow,\n  fireInternal,\n  setGroupInternal,\n};\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Touch handling for Blockly.\n *\n * @namespace Blockly.Touch\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Touch');\n\nimport type {Gesture} from './gesture.js';\n\n\n/**\n * A mock event, created from either a mouse or touch event,\n * with no more than one entry in the changedTouches array.\n */\ninterface PseudoEvent {\n  type: string;\n  changedTouches: Touch[];\n  target: Element;\n  stopPropagation: () => void;\n  preventDefault: () => void;\n}\n\n/** Length in ms for a touch to become a long press. */\nconst LONGPRESS = 750;\n\n/**\n * Whether touch is enabled in the browser.\n * Copied from Closure's goog.events.BrowserFeature.TOUCH_ENABLED\n */\nexport const TOUCH_ENABLED = 'ontouchstart' in globalThis ||\n    !!(globalThis['document'] && document.documentElement &&\n       'ontouchstart' in\n           document.documentElement) ||  // IE10 uses non-standard touch events,\n    // so it has a different check.\n    !!(globalThis['navigator'] &&\n       (globalThis['navigator']['maxTouchPoints'] ||\n        (globalThis['navigator'] as any)['msMaxTouchPoints']));\n\n/** Which touch events are we currently paying attention to? */\nlet touchIdentifier_: string|null = null;\n\n/**\n * The TOUCH_MAP lookup dictionary specifies additional touch events to fire,\n * in conjunction with mouse events.\n *\n * @alias Blockly.Touch.TOUCH_MAP\n */\nexport const TOUCH_MAP: {[key: string]: string[]} = globalThis['PointerEvent'] ?\n    {\n      'mousedown': ['pointerdown'],\n      'mouseenter': ['pointerenter'],\n      'mouseleave': ['pointerleave'],\n      'mousemove': ['pointermove'],\n      'mouseout': ['pointerout'],\n      'mouseover': ['pointerover'],\n      'mouseup': ['pointerup', 'pointercancel'],\n      'touchend': ['pointerup'],\n      'touchcancel': ['pointercancel'],\n    } :\n    {\n      'mousedown': ['touchstart'],\n      'mousemove': ['touchmove'],\n      'mouseup': ['touchend', 'touchcancel'],\n    };\n\n/** PID of queued long-press task. */\nlet longPid_: AnyDuringMigration = 0;\n\n/**\n * Context menus on touch devices are activated using a long-press.\n * Unfortunately the contextmenu touch event is currently (2015) only supported\n * by Chrome.  This function is fired on any touchstart event, queues a task,\n * which after about a second opens the context menu.  The tasks is killed\n * if the touch event terminates early.\n *\n * @param e Touch start event.\n * @param gesture The gesture that triggered this longStart.\n * @alias Blockly.Touch.longStart\n * @internal\n */\nexport function longStart(e: Event, gesture: Gesture) {\n  longStop();\n  // Punt on multitouch events.\n  // AnyDuringMigration because:  Property 'changedTouches' does not exist on\n  // type 'Event'.\n  if ((e as AnyDuringMigration).changedTouches &&\n      (e as AnyDuringMigration).changedTouches.length !== 1) {\n    return;\n  }\n  longPid_ = setTimeout(function() {\n    // TODO(#6097): Make types accurate, possibly by refactoring touch handling.\n    // AnyDuringMigration because:  Property 'changedTouches' does not exist on\n    // type 'Event'.\n    const typelessEvent = e as AnyDuringMigration;\n    // Additional check to distinguish between touch events and pointer events\n    if (typelessEvent.changedTouches) {\n      // TouchEvent\n      typelessEvent.button = 2;  // Simulate a right button click.\n      // e was a touch event.  It needs to pretend to be a mouse event.\n      typelessEvent.clientX = typelessEvent.changedTouches[0].clientX;\n      typelessEvent.clientY = typelessEvent.changedTouches[0].clientY;\n    }\n\n    // Let the gesture route the right-click correctly.\n    if (gesture) {\n      gesture.handleRightClick(e);\n    }\n  }, LONGPRESS);\n}\n\n/**\n * Nope, that's not a long-press.  Either touchend or touchcancel was fired,\n * or a drag hath begun.  Kill the queued long-press task.\n *\n * @alias Blockly.Touch.longStop\n * @internal\n */\nexport function longStop() {\n  if (longPid_) {\n    clearTimeout(longPid_);\n    longPid_ = 0;\n  }\n}\n\n/**\n * Clear the touch identifier that tracks which touch stream to pay attention\n * to.  This ends the current drag/gesture and allows other pointers to be\n * captured.\n *\n * @alias Blockly.Touch.clearTouchIdentifier\n */\nexport function clearTouchIdentifier() {\n  touchIdentifier_ = null;\n}\n\n/**\n * Decide whether Blockly should handle or ignore this event.\n * Mouse and touch events require special checks because we only want to deal\n * with one touch stream at a time.  All other events should always be handled.\n *\n * @param e The event to check.\n * @returns True if this event should be passed through to the registered\n *     handler; false if it should be blocked.\n * @alias Blockly.Touch.shouldHandleEvent\n */\nexport function shouldHandleEvent(e: Event|PseudoEvent): boolean {\n  return !isMouseOrTouchEvent(e) || checkTouchIdentifier(e);\n}\n\n/**\n * Get the touch identifier from the given event.  If it was a mouse event, the\n * identifier is the string 'mouse'.\n *\n * @param e Mouse event or touch event.\n * @returns The touch identifier from the first changed touch, if defined.\n *     Otherwise 'mouse'.\n * @alias Blockly.Touch.getTouchIdentifierFromEvent\n */\nexport function getTouchIdentifierFromEvent(e: Event|PseudoEvent): string {\n  if (e instanceof MouseEvent) {\n    return 'mouse';\n  }\n\n  if (e instanceof PointerEvent) {\n    return String(e.pointerId);\n  }\n\n  /**\n   * TODO(#6097): Fix types. This is a catch-all for everything but mouse\n   * and pointer events.\n   */\n  const pseudoEvent = /** {!PseudoEvent} */ e;\n\n  // AnyDuringMigration because:  Property 'changedTouches' does not exist on\n  // type 'PseudoEvent | Event'. AnyDuringMigration because:  Property\n  // 'changedTouches' does not exist on type 'PseudoEvent | Event'.\n  // AnyDuringMigration because:  Property 'changedTouches' does not exist on\n  // type 'PseudoEvent | Event'. AnyDuringMigration because:  Property\n  // 'changedTouches' does not exist on type 'PseudoEvent | Event'.\n  // AnyDuringMigration because:  Property 'changedTouches' does not exist on\n  // type 'PseudoEvent | Event'.\n  return (pseudoEvent as AnyDuringMigration).changedTouches &&\n          (pseudoEvent as AnyDuringMigration).changedTouches[0] &&\n          (pseudoEvent as AnyDuringMigration).changedTouches[0].identifier !==\n              undefined &&\n          (pseudoEvent as AnyDuringMigration).changedTouches[0].identifier !==\n              null ?\n      String((pseudoEvent as AnyDuringMigration).changedTouches[0].identifier) :\n      'mouse';\n}\n\n/**\n * Check whether the touch identifier on the event matches the current saved\n * identifier.  If there is no identifier, that means it's a mouse event and\n * we'll use the identifier \"mouse\".  This means we won't deal well with\n * multiple mice being used at the same time.  That seems okay.\n * If the current identifier was unset, save the identifier from the\n * event.  This starts a drag/gesture, during which touch events with other\n * identifiers will be silently ignored.\n *\n * @param e Mouse event or touch event.\n * @returns Whether the identifier on the event matches the current saved\n *     identifier.\n * @alias Blockly.Touch.checkTouchIdentifier\n */\nexport function checkTouchIdentifier(e: Event|PseudoEvent): boolean {\n  const identifier = getTouchIdentifierFromEvent(e);\n\n  // if (touchIdentifier_) is insufficient because Android touch\n  // identifiers may be zero.\n  if (touchIdentifier_ !== undefined && touchIdentifier_ !== null) {\n    // We're already tracking some touch/mouse event.  Is this from the same\n    // source?\n    return touchIdentifier_ === identifier;\n  }\n  if (e.type === 'mousedown' || e.type === 'touchstart' ||\n      e.type === 'pointerdown') {\n    // No identifier set yet, and this is the start of a drag.  Set it and\n    // return.\n    touchIdentifier_ = identifier;\n    return true;\n  }\n  // There was no identifier yet, but this wasn't a start event so we're going\n  // to ignore it.  This probably means that another drag finished while this\n  // pointer was down.\n  return false;\n}\n\n/**\n * Set an event's clientX and clientY from its first changed touch.  Use this to\n * make a touch event work in a mouse event handler.\n *\n * @param e A touch event.\n * @alias Blockly.Touch.setClientFromTouch\n */\nexport function setClientFromTouch(e: Event|PseudoEvent) {\n  // AnyDuringMigration because:  Property 'changedTouches' does not exist on\n  // type 'PseudoEvent | Event'.\n  if (e.type.startsWith('touch') && (e as AnyDuringMigration).changedTouches) {\n    // Map the touch event's properties to the event.\n    // AnyDuringMigration because:  Property 'changedTouches' does not exist on\n    // type 'PseudoEvent | Event'.\n    const touchPoint = (e as AnyDuringMigration).changedTouches[0];\n    // AnyDuringMigration because:  Property 'clientX' does not exist on type\n    // 'PseudoEvent | Event'.\n    (e as AnyDuringMigration).clientX = touchPoint.clientX;\n    // AnyDuringMigration because:  Property 'clientY' does not exist on type\n    // 'PseudoEvent | Event'.\n    (e as AnyDuringMigration).clientY = touchPoint.clientY;\n  }\n}\n\n/**\n * Check whether a given event is a mouse, touch, or pointer event.\n *\n * @param e An event.\n * @returns True if it is a mouse, touch, or pointer event; false otherwise.\n * @alias Blockly.Touch.isMouseOrTouchEvent\n */\nexport function isMouseOrTouchEvent(e: Event|PseudoEvent): boolean {\n  return e.type.startsWith('touch') || e.type.startsWith('mouse') ||\n      e.type.startsWith('pointer');\n}\n\n/**\n * Check whether a given event is a touch event or a pointer event.\n *\n * @param e An event.\n * @returns True if it is a touch or pointer event; false otherwise.\n * @alias Blockly.Touch.isTouchEvent\n */\nexport function isTouchEvent(e: Event|PseudoEvent): boolean {\n  return e.type.startsWith('touch') || e.type.startsWith('pointer');\n}\n\n/**\n * Split an event into an array of events, one per changed touch or mouse\n * point.\n *\n * @param e A mouse event or a touch event with one or more changed touches.\n * @returns An array of events or pseudo events.\n *     Each pseudo-touch event will have exactly one changed touch and there\n * will be no real touch events.\n * @alias Blockly.Touch.splitEventByTouches\n */\nexport function splitEventByTouches(e: Event): Array<Event|PseudoEvent> {\n  const events = [];\n  // AnyDuringMigration because:  Property 'changedTouches' does not exist on\n  // type 'PseudoEvent | Event'.\n  if ((e as AnyDuringMigration).changedTouches) {\n    // AnyDuringMigration because:  Property 'changedTouches' does not exist on\n    // type 'PseudoEvent | Event'.\n    for (let i = 0; i < (e as AnyDuringMigration).changedTouches.length; i++) {\n      const newEvent = {\n        type: e.type,\n        // AnyDuringMigration because:  Property 'changedTouches' does not exist\n        // on type 'PseudoEvent | Event'.\n        changedTouches: [(e as AnyDuringMigration).changedTouches[i]],\n        target: e.target,\n        stopPropagation() {\n          e.stopPropagation();\n        },\n        preventDefault() {\n          e.preventDefault();\n        },\n      };\n      events[i] = newEvent;\n    }\n  } else {\n    events.push(e);\n  }\n  // AnyDuringMigration because:  Type '(Event | { type: string; changedTouches:\n  // Touch[]; target: EventTarget | null; stopPropagation(): void;\n  // preventDefault(): void; })[]' is not assignable to type '(PseudoEvent |\n  // Event)[]'.\n  return events as AnyDuringMigration;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Browser event handling.\n *\n * @namespace Blockly.browserEvents\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.browserEvents');\n\nimport * as Touch from './touch.js';\nimport * as userAgent from './utils/useragent.js';\n\n\n/**\n * Blockly opaque event data used to unbind events when using\n * `bind` and `conditionalBind`.\n *\n * @alias Blockly.browserEvents.Data\n */\nexport type Data = [EventTarget, string, (e: Event) => void][];\n\n/**\n * The multiplier for scroll wheel deltas using the line delta mode.\n * See https://developer.mozilla.org/en-US/docs/Web/API/WheelEvent/deltaMode\n * for more information on deltaMode.\n */\nconst LINE_MODE_MULTIPLIER = 40;\n\n/**\n * The multiplier for scroll wheel deltas using the page delta mode.\n * See https://developer.mozilla.org/en-US/docs/Web/API/WheelEvent/deltaMode\n * for more information on deltaMode.\n */\nconst PAGE_MODE_MULTIPLIER = 125;\n\n/**\n * Bind an event handler that can be ignored if it is not part of the active\n * touch stream.\n * Use this for events that either start or continue a multi-part gesture (e.g.\n * mousedown or mousemove, which may be part of a drag or click).\n *\n * @param node Node upon which to listen.\n * @param name Event name to listen to (e.g. 'mousedown').\n * @param thisObject The value of 'this' in the function.\n * @param func Function to call when event is triggered.\n * @param opt_noCaptureIdentifier True if triggering on this event should not\n *     block execution of other event handlers on this touch or other\n *     simultaneous touches.  False by default.\n * @param opt_noPreventDefault True if triggering on this event should prevent\n *     the default handler.  False by default.  If opt_noPreventDefault is\n *     provided, opt_noCaptureIdentifier must also be provided.\n * @returns Opaque data that can be passed to unbindEvent_.\n * @alias Blockly.browserEvents.conditionalBind\n */\nexport function conditionalBind(\n    node: EventTarget, name: string, thisObject: Object|null, func: Function,\n    opt_noCaptureIdentifier?: boolean, opt_noPreventDefault?: boolean): Data {\n  let handled = false;\n  /**\n   *\n   * @param e\n   */\n  function wrapFunc(e: Event) {\n    const captureIdentifier = !opt_noCaptureIdentifier;\n    // Handle each touch point separately.  If the event was a mouse event, this\n    // will hand back an array with one element, which we're fine handling.\n    const events = Touch.splitEventByTouches(e);\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      if (captureIdentifier && !Touch.shouldHandleEvent(event)) {\n        continue;\n      }\n      Touch.setClientFromTouch(event);\n      if (thisObject) {\n        func.call(thisObject, event);\n      } else {\n        func(event);\n      }\n      handled = true;\n    }\n  }\n\n  const bindData: Data = [];\n  if (globalThis['PointerEvent'] && name in Touch.TOUCH_MAP) {\n    for (let i = 0; i < Touch.TOUCH_MAP[name].length; i++) {\n      const type = Touch.TOUCH_MAP[name][i];\n      node.addEventListener(type, wrapFunc, false);\n      bindData.push([node, type, wrapFunc]);\n    }\n  } else {\n    node.addEventListener(name, wrapFunc, false);\n    bindData.push([node, name, wrapFunc]);\n\n    // Add equivalent touch event.\n    if (name in Touch.TOUCH_MAP) {\n      const touchWrapFunc = (e: Event) => {\n        wrapFunc(e);\n        // Calling preventDefault stops the browser from scrolling/zooming the\n        // page.\n        const preventDef = !opt_noPreventDefault;\n        if (handled && preventDef) {\n          e.preventDefault();\n        }\n      };\n      for (let i = 0; i < Touch.TOUCH_MAP[name].length; i++) {\n        const type = Touch.TOUCH_MAP[name][i];\n        node.addEventListener(type, touchWrapFunc, false);\n        bindData.push([node, type, touchWrapFunc]);\n      }\n    }\n  }\n  return bindData;\n}\n\n/**\n * Bind an event handler that should be called regardless of whether it is part\n * of the active touch stream.\n * Use this for events that are not part of a multi-part gesture (e.g.\n * mouseover for tooltips).\n *\n * @param node Node upon which to listen.\n * @param name Event name to listen to (e.g. 'mousedown').\n * @param thisObject The value of 'this' in the function.\n * @param func Function to call when event is triggered.\n * @returns Opaque data that can be passed to unbindEvent_.\n * @alias Blockly.browserEvents.bind\n */\nexport function bind(\n    node: EventTarget, name: string, thisObject: Object|null,\n    func: Function): Data {\n  /**\n   *\n   * @param e\n   */\n  function wrapFunc(e: Event) {\n    if (thisObject) {\n      func.call(thisObject, e);\n    } else {\n      func(e);\n    }\n  }\n\n  const bindData: Data = [];\n  if (globalThis['PointerEvent'] && name in Touch.TOUCH_MAP) {\n    for (let i = 0; i < Touch.TOUCH_MAP[name].length; i++) {\n      const type = Touch.TOUCH_MAP[name][i];\n      node.addEventListener(type, wrapFunc, false);\n      bindData.push([node, type, wrapFunc]);\n    }\n  } else {\n    node.addEventListener(name, wrapFunc, false);\n    bindData.push([node, name, wrapFunc]);\n\n    // Add equivalent touch event.\n    if (name in Touch.TOUCH_MAP) {\n      const touchWrapFunc = (e: Event) => {\n        // Punt on multitouch events.\n        if (e instanceof TouchEvent && e.changedTouches &&\n            e.changedTouches.length === 1) {\n          // Map the touch event's properties to the event.\n          const touchPoint = e.changedTouches[0];\n          // TODO (6311): We are trying to make a touch event look like a mouse\n          //   event, which is not allowed, because it requires adding more\n          //   properties to the event. How do we want to deal with this?\n          (e as AnyDuringMigration).clientX = touchPoint.clientX;\n          (e as AnyDuringMigration).clientY = touchPoint.clientY;\n        }\n        wrapFunc(e);\n\n        // Stop the browser from scrolling/zooming the page.\n        e.preventDefault();\n      };\n      for (let i = 0; i < Touch.TOUCH_MAP[name].length; i++) {\n        const type = Touch.TOUCH_MAP[name][i];\n        node.addEventListener(type, touchWrapFunc, false);\n        bindData.push([node, type, touchWrapFunc]);\n      }\n    }\n  }\n  return bindData;\n}\n\n/**\n * Unbind one or more events event from a function call.\n *\n * @param bindData Opaque data from bindEvent_.\n *     This list is emptied during the course of calling this function.\n * @returns The function call.\n * @alias Blockly.browserEvents.unbind\n */\nexport function unbind(bindData: Data): (e: Event) => void {\n  // Accessing an element of the last property of the array is unsafe if the\n  // bindData is an empty array. But that should never happen because developers\n  // should only pass Data from bind or conditionalBind.\n  const callback = bindData[bindData.length - 1][2];\n  while (bindData.length) {\n    const bindDatum = bindData.pop();\n    const node = bindDatum![0];\n    const name = bindDatum![1];\n    const func = bindDatum![2];\n    node.removeEventListener(name, func, false);\n  }\n  return callback;\n}\n\n/**\n * Returns true if this event is targeting a text input widget?\n *\n * @param e An event.\n * @returns True if text input.\n * @alias Blockly.browserEvents.isTargetInput\n */\nexport function isTargetInput(e: Event): boolean {\n  if (e.target instanceof HTMLElement) {\n    if (e.target.isContentEditable ||\n        e.target.getAttribute('data-is-text-input') === 'true') {\n      return true;\n    }\n\n    if (e.target instanceof HTMLInputElement) {\n      const target = e.target;\n      return target.type === 'text' || target.type === 'number' ||\n          target.type === 'email' || target.type === 'password' ||\n          target.type === 'search' || target.type === 'tel' ||\n          target.type === 'url';\n    }\n\n    if (e.target instanceof HTMLTextAreaElement) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Returns true this event is a right-click.\n *\n * @param e Mouse event.\n * @returns True if right-click.\n * @alias Blockly.browserEvents.isRightButton\n */\nexport function isRightButton(e: MouseEvent): boolean {\n  if (e.ctrlKey && userAgent.MAC) {\n    // Control-clicking on Mac OS X is treated as a right-click.\n    // WebKit on Mac OS X fails to change button to 2 (but Gecko does).\n    return true;\n  }\n  return e.button === 2;\n}\n\n/**\n * Returns the converted coordinates of the given mouse event.\n * The origin (0,0) is the top-left corner of the Blockly SVG.\n *\n * @param e Mouse event.\n * @param svg SVG element.\n * @param matrix Inverted screen CTM to use.\n * @returns Object with .x and .y properties.\n * @alias Blockly.browserEvents.mouseToSvg\n */\nexport function mouseToSvg(\n    e: MouseEvent, svg: SVGSVGElement, matrix: SVGMatrix|null): SVGPoint {\n  const svgPoint = svg.createSVGPoint();\n  svgPoint.x = e.clientX;\n  svgPoint.y = e.clientY;\n\n  if (!matrix) {\n    matrix = svg.getScreenCTM()!.inverse();\n  }\n  return svgPoint.matrixTransform(matrix);\n}\n\n/**\n * Returns the scroll delta of a mouse event in pixel units.\n *\n * @param e Mouse event.\n * @returns Scroll delta object with .x and .y properties.\n * @alias Blockly.browserEvents.getScrollDeltaPixels\n */\nexport function getScrollDeltaPixels(e: WheelEvent): {x: number, y: number} {\n  switch (e.deltaMode) {\n    case 0x00:  // Pixel mode.\n    default:\n      return {x: e.deltaX, y: e.deltaY};\n    case 0x01:  // Line mode.\n      return {\n        x: e.deltaX * LINE_MODE_MULTIPLIER,\n        y: e.deltaY * LINE_MODE_MULTIPLIER,\n      };\n    case 0x02:  // Page mode.\n      return {\n        x: e.deltaX * PAGE_MODE_MULTIPLIER,\n        y: e.deltaY * PAGE_MODE_MULTIPLIER,\n      };\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/** @namespace Blockly.utils.array */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.array');\n\n\n/**\n * Removes the first occurrence of a particular value from an array.\n *\n * @param arr Array from which to remove value.\n * @param value Value to remove.\n * @returns True if an element was removed.\n * @alias Blockly.array.removeElem\n * @internal\n */\nexport function removeElem<T>(arr: Array<T>, value: T): boolean {\n  const i = arr.indexOf(value);\n  if (i === -1) {\n    return false;\n  }\n  arr.splice(i, 1);\n  return true;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for DOM manipulation.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @namespace Blockly.utils.dom\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.dom');\n\nimport type {Svg} from './svg.js';\n\n\n/**\n * Required name space for SVG elements.\n *\n * @alias Blockly.utils.dom.SVG_NS\n */\nexport const SVG_NS = 'http://www.w3.org/2000/svg';\n\n/**\n * Required name space for HTML elements.\n *\n * @alias Blockly.utils.dom.HTML_NS\n */\nexport const HTML_NS = 'http://www.w3.org/1999/xhtml';\n\n/**\n * Required name space for XLINK elements.\n *\n * @alias Blockly.utils.dom.XLINK_NS\n */\nexport const XLINK_NS = 'http://www.w3.org/1999/xlink';\n\n/**\n * Node type constants.\n * https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType\n *\n * @alias Blockly.utils.dom.NodeType\n */\nexport enum NodeType {\n  ELEMENT_NODE = 1,\n  TEXT_NODE = 3,\n  COMMENT_NODE = 8,\n  DOCUMENT_POSITION_CONTAINED_BY = 16\n}\n\n/** Temporary cache of text widths. */\nlet cacheWidths: AnyDuringMigration = null;\n\n/** Number of current references to cache. */\nlet cacheReference = 0;\n\n/** A HTML canvas context used for computing text width. */\n// AnyDuringMigration because:  Type 'null' is not assignable to type\n// 'CanvasRenderingContext2D'.\nlet canvasContext: CanvasRenderingContext2D = null as AnyDuringMigration;\n\n/**\n * Helper method for creating SVG elements.\n *\n * @param name Element's tag name.\n * @param attrs Dictionary of attribute names and values.\n * @param opt_parent Optional parent on which to append the element.\n * @returns if name is a string or a more specific type if it a member of Svg.\n * @alias Blockly.utils.dom.createSvgElement\n */\nexport function createSvgElement<T extends SVGElement>(\n    name: string|Svg<T>, attrs: AnyDuringMigration,\n    opt_parent?: Element|null): T {\n  const e = document.createElementNS(SVG_NS, String(name)) as T;\n  for (const key in attrs) {\n    e.setAttribute(key, attrs[key]);\n  }\n  if (opt_parent) {\n    opt_parent.appendChild(e);\n  }\n  return e;\n}\n\n/**\n * Add a CSS class to a element.\n * Similar to Closure's goog.dom.classes.add, except it handles SVG elements.\n *\n * @param element DOM element to add class to.\n * @param className Name of class to add.\n * @returns True if class was added, false if already present.\n * @alias Blockly.utils.dom.addClass\n */\nexport function addClass(element: Element, className: string): boolean {\n  let classes = element.getAttribute('class') || '';\n  if ((' ' + classes + ' ').indexOf(' ' + className + ' ') !== -1) {\n    return false;\n  }\n  if (classes) {\n    classes += ' ';\n  }\n  element.setAttribute('class', classes + className);\n  return true;\n}\n\n/**\n * Removes multiple calsses from an element.\n *\n * @param element DOM element to remove classes from.\n * @param classNames A string of one or multiple class names for an element.\n * @alias Blockly.utils.dom.removeClasses\n */\nexport function removeClasses(element: Element, classNames: string) {\n  const classList = classNames.split(' ');\n  for (let i = 0; i < classList.length; i++) {\n    removeClass(element, classList[i]);\n  }\n}\n\n/**\n * Remove a CSS class from a element.\n * Similar to Closure's goog.dom.classes.remove, except it handles SVG elements.\n *\n * @param element DOM element to remove class from.\n * @param className Name of class to remove.\n * @returns True if class was removed, false if never present.\n * @alias Blockly.utils.dom.removeClass\n */\nexport function removeClass(element: Element, className: string): boolean {\n  const classes = element.getAttribute('class');\n  if ((' ' + classes + ' ').indexOf(' ' + className + ' ') === -1) {\n    return false;\n  }\n  const classList = classes!.split(/\\s+/);\n  for (let i = 0; i < classList.length; i++) {\n    if (!classList[i] || classList[i] === className) {\n      classList.splice(i, 1);\n      i--;\n    }\n  }\n  if (classList.length) {\n    element.setAttribute('class', classList.join(' '));\n  } else {\n    element.removeAttribute('class');\n  }\n  return true;\n}\n\n/**\n * Checks if an element has the specified CSS class.\n * Similar to Closure's goog.dom.classes.has, except it handles SVG elements.\n *\n * @param element DOM element to check.\n * @param className Name of class to check.\n * @returns True if class exists, false otherwise.\n * @alias Blockly.utils.dom.hasClass\n */\nexport function hasClass(element: Element, className: string): boolean {\n  const classes = element.getAttribute('class');\n  return (' ' + classes + ' ').indexOf(' ' + className + ' ') !== -1;\n}\n\n/**\n * Removes a node from its parent. No-op if not attached to a parent.\n *\n * @param node The node to remove.\n * @returns The node removed if removed; else, null.\n * @alias Blockly.utils.dom.removeNode\n */\n// Copied from Closure goog.dom.removeNode\nexport function removeNode(node: Node|null): Node|null {\n  return node && node.parentNode ? node.parentNode.removeChild(node) : null;\n}\n\n/**\n * Insert a node after a reference node.\n * Contrast with node.insertBefore function.\n *\n * @param newNode New element to insert.\n * @param refNode Existing element to precede new node.\n * @alias Blockly.utils.dom.insertAfter\n */\nexport function insertAfter(newNode: Element, refNode: Element) {\n  const siblingNode = refNode.nextSibling;\n  const parentNode = refNode.parentNode;\n  if (!parentNode) {\n    throw Error('Reference node has no parent.');\n  }\n  if (siblingNode) {\n    parentNode.insertBefore(newNode, siblingNode);\n  } else {\n    parentNode.appendChild(newNode);\n  }\n}\n\n/**\n * Whether a node contains another node.\n *\n * @param parent The node that should contain the other node.\n * @param descendant The node to test presence of.\n * @returns Whether the parent node contains the descendant node.\n * @alias Blockly.utils.dom.containsNode\n */\nexport function containsNode(parent: Node, descendant: Node): boolean {\n  return !!(\n      parent.compareDocumentPosition(descendant) &\n      NodeType.DOCUMENT_POSITION_CONTAINED_BY);\n}\n\n/**\n * Sets the CSS transform property on an element. This function sets the\n * non-vendor-prefixed and vendor-prefixed versions for backwards compatibility\n * with older browsers. See https://caniuse.com/#feat=transforms2d\n *\n * @param element Element to which the CSS transform will be applied.\n * @param transform The value of the CSS `transform` property.\n * @alias Blockly.utils.dom.setCssTransform\n */\nexport function setCssTransform(element: Element, transform: string) {\n  // AnyDuringMigration because:  Property 'style' does not exist on type\n  // 'Element'.\n  (element as AnyDuringMigration).style['transform'] = transform;\n  // AnyDuringMigration because:  Property 'style' does not exist on type\n  // 'Element'.\n  (element as AnyDuringMigration).style['-webkit-transform'] = transform;\n}\n\n/**\n * Start caching text widths. Every call to this function MUST also call\n * stopTextWidthCache. Caches must not survive between execution threads.\n *\n * @alias Blockly.utils.dom.startTextWidthCache\n */\nexport function startTextWidthCache() {\n  cacheReference++;\n  if (!cacheWidths) {\n    cacheWidths = Object.create(null);\n  }\n}\n\n/**\n * Stop caching field widths. Unless caching was already on when the\n * corresponding call to startTextWidthCache was made.\n *\n * @alias Blockly.utils.dom.stopTextWidthCache\n */\nexport function stopTextWidthCache() {\n  cacheReference--;\n  if (!cacheReference) {\n    cacheWidths = null;\n  }\n}\n\n/**\n * Gets the width of a text element, caching it in the process.\n *\n * @param textElement An SVG 'text' element.\n * @returns Width of element.\n * @alias Blockly.utils.dom.getTextWidth\n */\nexport function getTextWidth(textElement: SVGTextElement): number {\n  const key = textElement.textContent + '\\n' + textElement.className.baseVal;\n  let width;\n  // Return the cached width if it exists.\n  if (cacheWidths) {\n    width = cacheWidths[key];\n    if (width) {\n      return width;\n    }\n  }\n\n  // Attempt to compute fetch the width of the SVG text element.\n  try {\n    width = textElement.getComputedTextLength();\n  } catch (e) {\n    // In other cases where we fail to get the computed text. Instead, use an\n    // approximation and do not cache the result. At some later point in time\n    // when the block is inserted into the visible DOM, this method will be\n    // called again and, at that point in time, will not throw an exception.\n    return textElement.textContent!.length * 8;\n  }\n\n  // Cache the computed width and return.\n  if (cacheWidths) {\n    cacheWidths[key] = width;\n  }\n  return width;\n}\n\n/**\n * Gets the width of a text element using a faster method than `getTextWidth`.\n * This method requires that we know the text element's font family and size in\n * advance. Similar to `getTextWidth`, we cache the width we compute.\n *\n * @param textElement An SVG 'text' element.\n * @param fontSize The font size to use.\n * @param fontWeight The font weight to use.\n * @param fontFamily The font family to use.\n * @returns Width of element.\n * @alias Blockly.utils.dom.getFastTextWidth\n */\nexport function getFastTextWidth(\n    textElement: Element, fontSize: number, fontWeight: string,\n    fontFamily: string): number {\n  return getFastTextWidthWithSizeString(\n      textElement, fontSize + 'pt', fontWeight, fontFamily);\n}\n\n/**\n * Gets the width of a text element using a faster method than `getTextWidth`.\n * This method requires that we know the text element's font family and size in\n * advance. Similar to `getTextWidth`, we cache the width we compute.\n * This method is similar to `getFastTextWidth` but expects the font size\n * parameter to be a string.\n *\n * @param textElement An SVG 'text' element.\n * @param fontSize The font size to use.\n * @param fontWeight The font weight to use.\n * @param fontFamily The font family to use.\n * @returns Width of element.\n * @alias Blockly.utils.dom.getFastTextWidthWithSizeString\n */\nexport function getFastTextWidthWithSizeString(\n    textElement: Element, fontSize: string, fontWeight: string,\n    fontFamily: string): number {\n  const text = textElement.textContent;\n  // AnyDuringMigration because:  Property 'baseVal' does not exist on type\n  // 'string'.\n  const key =\n      text + '\\n' + (textElement.className as AnyDuringMigration).baseVal;\n  let width;\n\n  // Return the cached width if it exists.\n  if (cacheWidths) {\n    width = cacheWidths[key];\n    if (width) {\n      return width;\n    }\n  }\n\n  if (!canvasContext) {\n    // Inject the canvas element used for computing text widths.\n    const computeCanvas = (document.createElement('canvas'));\n    computeCanvas.className = 'blocklyComputeCanvas';\n    document.body.appendChild(computeCanvas);\n\n    // Initialize the HTML canvas context and set the font.\n    // The context font must match blocklyText's fontsize and font-family\n    // set in CSS.\n    canvasContext = computeCanvas.getContext('2d') as CanvasRenderingContext2D;\n  }\n  // Set the desired font size and family.\n  canvasContext.font = fontWeight + ' ' + fontSize + ' ' + fontFamily;\n\n  // Measure the text width using the helper canvas context.\n  // AnyDuringMigration because:  Argument of type 'string | null' is not\n  // assignable to parameter of type 'string'.\n  width = canvasContext.measureText(text as AnyDuringMigration).width;\n\n  // Cache the computed width and return.\n  if (cacheWidths) {\n    cacheWidths[key] = width;\n  }\n  return width;\n}\n\n/**\n * Measure a font's metrics. The height and baseline values.\n *\n * @param text Text to measure the font dimensions of.\n * @param fontSize The font size to use.\n * @param fontWeight The font weight to use.\n * @param fontFamily The font family to use.\n * @returns Font measurements.\n * @alias Blockly.utils.dom.measureFontMetrics\n */\nexport function measureFontMetrics(\n    text: string, fontSize: string, fontWeight: string,\n    fontFamily: string): {height: number, baseline: number} {\n  const span = (document.createElement('span'));\n  span.style.font = fontWeight + ' ' + fontSize + ' ' + fontFamily;\n  span.textContent = text;\n\n  const block = (document.createElement('div'));\n  block.style.width = '1px';\n  // AnyDuringMigration because:  Type 'number' is not assignable to type\n  // 'string'.\n  block.style.height = 0 as AnyDuringMigration;\n\n  const div = (document.createElement('div'));\n  div.setAttribute('style', 'position: fixed; top: 0; left: 0; display: flex;');\n  div.appendChild(span);\n  div.appendChild(block);\n\n  document.body.appendChild(div);\n  const result = {\n    height: 0,\n    baseline: 0,\n  };\n  try {\n    div.style.alignItems = 'baseline';\n    result.baseline = block.offsetTop - span.offsetTop;\n    div.style.alignItems = 'flex-end';\n    result.height = block.offsetTop - span.offsetTop;\n  } finally {\n    document.body.removeChild(div);\n  }\n  return result;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * XML element manipulation.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @namespace Blockly.utils.xml\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.xml');\n\n\n/**\n * Namespace for Blockly's XML.\n *\n * @alias Blockly.utils.xml.NAME_SPACE\n */\nexport const NAME_SPACE = 'https://developers.google.com/blockly/xml';\n\n/**\n * The Document object to use.  By default this is just document, but\n * the Node.js build of Blockly (see scripts/package/node/core.js)\n * calls setDocument to supply a Document implementation from the\n * jsdom package instead.\n */\nlet xmlDocument: Document = globalThis['document'];\n\n/**\n * Get the document object to use for XML serialization.\n *\n * @returns The document object.\n * @alias Blockly.utils.xml.getDocument\n */\nexport function getDocument(): Document {\n  return xmlDocument;\n}\n\n/**\n * Get the document object to use for XML serialization.\n *\n * @param document The document object to use.\n * @alias Blockly.utils.xml.setDocument\n */\nexport function setDocument(document: Document) {\n  xmlDocument = document;\n}\n\n/**\n * Create DOM element for XML.\n *\n * @param tagName Name of DOM element.\n * @returns New DOM element.\n * @alias Blockly.utils.xml.createElement\n */\nexport function createElement(tagName: string): Element {\n  return xmlDocument.createElementNS(NAME_SPACE, tagName);\n}\n\n/**\n * Create text element for XML.\n *\n * @param text Text content.\n * @returns New DOM text node.\n * @alias Blockly.utils.xml.createTextNode\n */\nexport function createTextNode(text: string): Text {\n  return xmlDocument.createTextNode(text);\n}\n\n/**\n * Converts an XML string into a DOM tree.\n *\n * @param text XML string.\n * @returns The DOM document.\n * @throws if XML doesn't parse.\n * @alias Blockly.utils.xml.textToDomDocument\n */\nexport function textToDomDocument(text: string): Document {\n  const oParser = new DOMParser();\n  return oParser.parseFromString(text, 'text/xml');\n}\n\n/**\n * Converts a DOM structure into plain text.\n * Currently the text format is fairly ugly: all one line with no whitespace.\n *\n * @param dom A tree of XML nodes.\n * @returns Text representation.\n * @alias Blockly.utils.xml.domToText\n */\nexport function domToText(dom: Node): string {\n  const oSerializer = new XMLSerializer();\n  return oSerializer.serializeToString(dom);\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Wrapper functions around JS functions for showing alert/confirmation dialogs.\n *\n * @namespace Blockly.dialog\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.dialog');\n\n\nlet alertImplementation = function(message: string, opt_callback?: () => void) {\n  window.alert(message);\n  if (opt_callback) {\n    opt_callback();\n  }\n};\n\nlet confirmImplementation = function(\n    message: string, callback: (result: boolean) => void) {\n  callback(window.confirm(message));\n};\n\nlet promptImplementation = function(\n    message: string, defaultValue: string,\n    callback: (result: string|null) => void) {\n  callback(window.prompt(message, defaultValue));\n};\n\n/**\n * Wrapper to window.alert() that app developers may override via setAlert to\n * provide alternatives to the modal browser window.\n *\n * @param message The message to display to the user.\n * @param opt_callback The callback when the alert is dismissed.\n * @alias Blockly.dialog.alert\n */\nexport function alert(message: string, opt_callback?: () => void) {\n  alertImplementation(message, opt_callback);\n}\n\n/**\n * Sets the function to be run when Blockly.dialog.alert() is called.\n *\n * @param alertFunction The function to be run.\n * @see Blockly.dialog.alert\n * @alias Blockly.dialog.setAlert\n */\nexport function setAlert(alertFunction: (p1: string, p2?: () => void) => void) {\n  alertImplementation = alertFunction;\n}\n\n/**\n * Wrapper to window.confirm() that app developers may override via setConfirm\n * to provide alternatives to the modal browser window.\n *\n * @param message The message to display to the user.\n * @param callback The callback for handling user response.\n * @alias Blockly.dialog.confirm\n */\nexport function confirm(message: string, callback: (p1: boolean) => void) {\n  TEST_ONLY.confirmInternal(message, callback);\n}\n\n/**\n * Private version of confirm for stubbing in tests.\n */\nfunction confirmInternal(message: string, callback: (p1: boolean) => void) {\n  confirmImplementation(message, callback);\n}\n\n\n/**\n * Sets the function to be run when Blockly.dialog.confirm() is called.\n *\n * @param confirmFunction The function to be run.\n * @see Blockly.dialog.confirm\n * @alias Blockly.dialog.setConfirm\n */\nexport function setConfirm(\n    confirmFunction: (p1: string, p2: (p1: boolean) => void) => void) {\n  confirmImplementation = confirmFunction;\n}\n\n/**\n * Wrapper to window.prompt() that app developers may override via setPrompt to\n * provide alternatives to the modal browser window. Built-in browser prompts\n * are often used for better text input experience on mobile device. We strongly\n * recommend testing mobile when overriding this.\n *\n * @param message The message to display to the user.\n * @param defaultValue The value to initialize the prompt with.\n * @param callback The callback for handling user response.\n * @alias Blockly.dialog.prompt\n */\nexport function prompt(\n    message: string, defaultValue: string,\n    callback: (p1: string|null) => void) {\n  promptImplementation(message, defaultValue, callback);\n}\n\n/**\n * Sets the function to be run when Blockly.dialog.prompt() is called.\n *\n * @param promptFunction The function to be run.\n * @see Blockly.dialog.prompt\n * @alias Blockly.dialog.setPrompt\n */\nexport function setPrompt(\n    promptFunction: (p1: string, p2: string, p3: (p1: string|null) => void) =>\n        void) {\n  promptImplementation = promptFunction;\n}\n\nexport const TEST_ONLY = {\n  confirmInternal,\n};\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility functions for handling variables.\n *\n * @namespace Blockly.Variables\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Variables');\n\nimport {Blocks} from './blocks.js';\nimport * as dialog from './dialog.js';\nimport {Msg} from './msg.js';\nimport * as utilsXml from './utils/xml.js';\nimport {VariableModel} from './variable_model.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as Xml from './xml.js';\n\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n * See also Blockly.Procedures.CATEGORY_NAME and\n * Blockly.VariablesDynamic.CATEGORY_NAME.\n *\n * @alias Blockly.Variables.CATEGORY_NAME\n */\nexport const CATEGORY_NAME = 'VARIABLE';\n\n/**\n * Find all user-created variables that are in use in the workspace.\n * For use by generators.\n * To get a list of all variables on a workspace, including unused variables,\n * call Workspace.getAllVariables.\n *\n * @param ws The workspace to search for variables.\n * @returns Array of variable models.\n * @alias Blockly.Variables.allUsedVarModels\n */\nexport function allUsedVarModels(ws: Workspace): VariableModel[] {\n  const blocks = ws.getAllBlocks(false);\n  const variables = new Set<VariableModel>();\n  // Iterate through every block and add each variable to the set.\n  for (let i = 0; i < blocks.length; i++) {\n    const blockVariables = blocks[i].getVarModels();\n    if (blockVariables) {\n      for (let j = 0; j < blockVariables.length; j++) {\n        const variable = blockVariables[j];\n        const id = variable.getId();\n        if (id) {\n          variables.add(variable);\n        }\n      }\n    }\n  }\n  // Convert the set into a list.\n  return Array.from(variables.values());\n}\n\n/**\n * Find all developer variables used by blocks in the workspace.\n * Developer variables are never shown to the user, but are declared as global\n * variables in the generated code.\n * To declare developer variables, define the getDeveloperVariables function on\n * your block and return a list of variable names.\n * For use by generators.\n *\n * @param workspace The workspace to search.\n * @returns A list of non-duplicated variable names.\n * @alias Blockly.Variables.allDeveloperVariables\n */\nexport function allDeveloperVariables(workspace: Workspace): string[] {\n  const blocks = workspace.getAllBlocks(false);\n  const variables = new Set<string>();\n  for (let i = 0, block; block = blocks[i]; i++) {\n    const getDeveloperVariables = block.getDeveloperVariables;\n    if (getDeveloperVariables) {\n      const devVars = getDeveloperVariables();\n      for (let j = 0; j < devVars.length; j++) {\n        variables.add(devVars[j]);\n      }\n    }\n  }\n  // Convert the set into a list.\n  return Array.from(variables.values());\n}\n\n/**\n * Construct the elements (blocks and button) required by the flyout for the\n * variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML elements.\n * @alias Blockly.Variables.flyoutCategory\n */\nexport function flyoutCategory(workspace: WorkspaceSvg): Element[] {\n  let xmlList = new Array<Element>();\n  const button = document.createElement('button');\n  button.setAttribute('text', '%{BKY_NEW_VARIABLE}');\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE');\n\n  workspace.registerButtonCallback('CREATE_VARIABLE', function(button) {\n    createVariableButtonHandler(button.getTargetWorkspace());\n  });\n\n  xmlList.push(button);\n\n  const blockList = flyoutCategoryBlocks(workspace);\n  xmlList = xmlList.concat(blockList);\n  return xmlList;\n}\n\n/**\n * Construct the blocks required by the flyout for the variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML block elements.\n * @alias Blockly.Variables.flyoutCategoryBlocks\n */\nexport function flyoutCategoryBlocks(workspace: Workspace): Element[] {\n  const variableModelList = workspace.getVariablesOfType('');\n\n  const xmlList = [];\n  if (variableModelList.length > 0) {\n    // New variables are added to the end of the variableModelList.\n    const mostRecentVariable = variableModelList[variableModelList.length - 1];\n    if (Blocks['variables_set']) {\n      const block = utilsXml.createElement('block');\n      block.setAttribute('type', 'variables_set');\n      block.setAttribute('gap', Blocks['math_change'] ? '8' : '24');\n      block.appendChild(generateVariableFieldDom(mostRecentVariable));\n      xmlList.push(block);\n    }\n    if (Blocks['math_change']) {\n      const block = utilsXml.createElement('block');\n      block.setAttribute('type', 'math_change');\n      block.setAttribute('gap', Blocks['variables_get'] ? '20' : '8');\n      block.appendChild(generateVariableFieldDom(mostRecentVariable));\n      const value = Xml.textToDom(\n          '<value name=\"DELTA\">' +\n          '<shadow type=\"math_number\">' +\n          '<field name=\"NUM\">1</field>' +\n          '</shadow>' +\n          '</value>');\n      block.appendChild(value);\n      xmlList.push(block);\n    }\n\n    if (Blocks['variables_get']) {\n      variableModelList.sort(VariableModel.compareByName);\n      for (let i = 0, variable; variable = variableModelList[i]; i++) {\n        const block = utilsXml.createElement('block');\n        block.setAttribute('type', 'variables_get');\n        block.setAttribute('gap', '8');\n        block.appendChild(generateVariableFieldDom(variable));\n        xmlList.push(block);\n      }\n    }\n  }\n  return xmlList;\n}\n\n/** @alias Blockly.Variables.VAR_LETTER_OPTIONS */\nexport const VAR_LETTER_OPTIONS = 'ijkmnopqrstuvwxyzabcdefgh';\n\n/**\n * Return a new variable name that is not yet being used. This will try to\n * generate single letter variable names in the range 'i' to 'z' to start with.\n * If no unique name is located it will try 'i' to 'z', 'a' to 'h',\n * then 'i2' to 'z2' etc.  Skip 'l'.\n *\n * @param workspace The workspace to be unique in.\n * @returns New variable name.\n * @alias Blockly.Variables.generateUniqueName\n */\nexport function generateUniqueName(workspace: Workspace): string {\n  return TEST_ONLY.generateUniqueNameInternal(workspace);\n}\n\n/**\n * Private version of generateUniqueName for stubbing in tests.\n */\nfunction generateUniqueNameInternal(workspace: Workspace): string {\n  return generateUniqueNameFromOptions(\n      VAR_LETTER_OPTIONS.charAt(0), workspace.getAllVariableNames());\n}\n\n/**\n * Returns a unique name that is not present in the usedNames array. This\n * will try to generate single letter names in the range a - z (skip l). It\n * will start with the character passed to startChar.\n *\n * @param startChar The character to start the search at.\n * @param usedNames A list of all of the used names.\n * @returns A unique name that is not present in the usedNames array.\n * @alias Blockly.Variables.generateUniqueNameFromOptions\n */\nexport function generateUniqueNameFromOptions(\n    startChar: string, usedNames: string[]): string {\n  if (!usedNames.length) {\n    return startChar;\n  }\n\n  const letters = VAR_LETTER_OPTIONS;\n  let suffix = '';\n  let letterIndex = letters.indexOf(startChar);\n  let potName = startChar;\n\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    let inUse = false;\n    for (let i = 0; i < usedNames.length; i++) {\n      if (usedNames[i].toLowerCase() === potName) {\n        inUse = true;\n        break;\n      }\n    }\n    if (!inUse) {\n      return potName;\n    }\n\n    letterIndex++;\n    if (letterIndex === letters.length) {\n      // Reached the end of the character sequence so back to 'i'.\n      letterIndex = 0;\n      suffix = `${Number(suffix) + 1}`;\n    }\n    potName = letters.charAt(letterIndex) + suffix;\n  }\n}\n\n/**\n * Handles \"Create Variable\" button in the default variables toolbox category.\n * It will prompt the user for a variable name, including re-prompts if a name\n * is already in use among the workspace's variables.\n *\n * Custom button handlers can delegate to this function, allowing variables\n * types and after-creation processing. More complex customization (e.g.,\n * prompting for variable type) is beyond the scope of this function.\n *\n * @param workspace The workspace on which to create the variable.\n * @param opt_callback A callback. It will be passed an acceptable new variable\n *     name, or null if change is to be aborted (cancel button), or undefined if\n *     an existing variable was chosen.\n * @param opt_type The type of the variable like 'int', 'string', or ''. This\n *     will default to '', which is a specific type.\n * @alias Blockly.Variables.createVariableButtonHandler\n */\nexport function createVariableButtonHandler(\n    workspace: Workspace, opt_callback?: (p1?: string|null) => void,\n    opt_type?: string) {\n  const type = opt_type || '';\n  // This function needs to be named so it can be called recursively.\n  function promptAndCheckWithAlert(defaultName: string) {\n    promptName(Msg['NEW_VARIABLE_TITLE'], defaultName, function(text) {\n      if (text) {\n        const existing = nameUsedWithAnyType(text, workspace);\n        if (existing) {\n          let msg;\n          if (existing.type === type) {\n            msg = Msg['VARIABLE_ALREADY_EXISTS'].replace('%1', existing.name);\n          } else {\n            msg = Msg['VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE'];\n            msg = msg.replace('%1', existing.name).replace('%2', existing.type);\n          }\n          dialog.alert(msg, function() {\n            promptAndCheckWithAlert(text);\n          });\n        } else {\n          // No conflict\n          workspace.createVariable(text, type);\n          if (opt_callback) {\n            opt_callback(text);\n          }\n        }\n      } else {\n        // User canceled prompt.\n        if (opt_callback) {\n          opt_callback(null);\n        }\n      }\n    });\n  }\n  promptAndCheckWithAlert('');\n}\n\n/**\n * Opens a prompt that allows the user to enter a new name for a variable.\n * Triggers a rename if the new name is valid. Or re-prompts if there is a\n * collision.\n *\n * @param workspace The workspace on which to rename the variable.\n * @param variable Variable to rename.\n * @param opt_callback A callback. It will be passed an acceptable new variable\n *     name, or null if change is to be aborted (cancel button), or undefined if\n *     an existing variable was chosen.\n * @alias Blockly.Variables.renameVariable\n */\nexport function renameVariable(\n    workspace: Workspace, variable: VariableModel,\n    opt_callback?: (p1?: string|null) => void) {\n  // This function needs to be named so it can be called recursively.\n  function promptAndCheckWithAlert(defaultName: string) {\n    const promptText =\n        Msg['RENAME_VARIABLE_TITLE'].replace('%1', variable.name);\n    promptName(promptText, defaultName, function(newName) {\n      if (newName) {\n        const existing =\n            nameUsedWithOtherType(newName, variable.type, workspace);\n        if (existing) {\n          const msg = Msg['VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE']\n                          .replace('%1', existing.name)\n                          .replace('%2', existing.type);\n          dialog.alert(msg, function() {\n            promptAndCheckWithAlert(newName);\n          });\n        } else {\n          workspace.renameVariableById(variable.getId(), newName);\n          if (opt_callback) {\n            opt_callback(newName);\n          }\n        }\n      } else {\n        // User canceled prompt.\n        if (opt_callback) {\n          opt_callback(null);\n        }\n      }\n    });\n  }\n  promptAndCheckWithAlert('');\n}\n\n/**\n * Prompt the user for a new variable name.\n *\n * @param promptText The string of the prompt.\n * @param defaultText The default value to show in the prompt's field.\n * @param callback A callback. It will be passed the new variable name, or null\n *     if the user picked something illegal.\n * @alias Blockly.Variables.promptName\n */\nexport function promptName(\n    promptText: string, defaultText: string,\n    callback: (p1: string|null) => void) {\n  dialog.prompt(promptText, defaultText, function(newVar) {\n    // Merge runs of whitespace.  Strip leading and trailing whitespace.\n    // Beyond this, all names are legal.\n    if (newVar) {\n      newVar = newVar.replace(/[\\s\\xa0]+/g, ' ').trim();\n      if (newVar === Msg['RENAME_VARIABLE'] || newVar === Msg['NEW_VARIABLE']) {\n        // Ok, not ALL names are legal...\n        newVar = null;\n      }\n    }\n    callback(newVar);\n  });\n}\n/**\n * Check whether there exists a variable with the given name but a different\n * type.\n *\n * @param name The name to search for.\n * @param type The type to exclude from the search.\n * @param workspace The workspace to search for the variable.\n * @returns The variable with the given name and a different type, or null if\n *     none was found.\n */\nfunction nameUsedWithOtherType(\n    name: string, type: string, workspace: Workspace): VariableModel|null {\n  const allVariables = workspace.getVariableMap().getAllVariables();\n\n  name = name.toLowerCase();\n  for (let i = 0, variable; variable = allVariables[i]; i++) {\n    if (variable.name.toLowerCase() === name && variable.type !== type) {\n      return variable;\n    }\n  }\n  return null;\n}\n\n/**\n * Check whether there exists a variable with the given name of any type.\n *\n * @param name The name to search for.\n * @param workspace The workspace to search for the variable.\n * @returns The variable with the given name, or null if none was found.\n * @alias Blockly.Variables.nameUsedWithAnyType\n */\nexport function nameUsedWithAnyType(\n    name: string, workspace: Workspace): VariableModel|null {\n  const allVariables = workspace.getVariableMap().getAllVariables();\n\n  name = name.toLowerCase();\n  for (let i = 0, variable; variable = allVariables[i]; i++) {\n    if (variable.name.toLowerCase() === name) {\n      return variable;\n    }\n  }\n  return null;\n}\n\n/**\n * Generate DOM objects representing a variable field.\n *\n * @param variableModel The variable model to represent.\n * @returns The generated DOM.\n * @alias Blockly.Variables.generateVariableFieldDom\n */\nexport function generateVariableFieldDom(variableModel: VariableModel):\n    Element {\n  /* Generates the following XML:\n   * <field name=\"VAR\" id=\"goKTKmYJ8DhVHpruv\" variabletype=\"int\">foo</field>\n   */\n  const field = utilsXml.createElement('field');\n  field.setAttribute('name', 'VAR');\n  field.setAttribute('id', variableModel.getId());\n  field.setAttribute('variabletype', variableModel.type);\n  const name = utilsXml.createTextNode(variableModel.name);\n  field.appendChild(name);\n  return field;\n}\n\n/**\n * Helper function to look up or create a variable on the given workspace.\n * If no variable exists, creates and returns it.\n *\n * @param workspace The workspace to search for the variable.  It may be a\n *     flyout workspace or main workspace.\n * @param id The ID to use to look up or create the variable, or null.\n * @param opt_name The string to use to look up or create the variable.\n * @param opt_type The type to use to look up or create the variable.\n * @returns The variable corresponding to the given ID or name + type\n *     combination.\n * @alias Blockly.Variables.getOrCreateVariablePackage\n */\nexport function getOrCreateVariablePackage(\n    workspace: Workspace, id: string|null, opt_name?: string,\n    opt_type?: string): VariableModel {\n  let variable = getVariable(workspace, id, opt_name, opt_type);\n  if (!variable) {\n    variable = createVariable(workspace, id, opt_name, opt_type);\n  }\n  return variable;\n}\n\n/**\n * Look up  a variable on the given workspace.\n * Always looks in the main workspace before looking in the flyout workspace.\n * Always prefers lookup by ID to lookup by name + type.\n *\n * @param workspace The workspace to search for the variable.  It may be a\n *     flyout workspace or main workspace.\n * @param id The ID to use to look up the variable, or null.\n * @param opt_name The string to use to look up the variable.\n *     Only used if lookup by ID fails.\n * @param opt_type The type to use to look up the variable.\n *     Only used if lookup by ID fails.\n * @returns The variable corresponding to the given ID or name + type\n *     combination, or null if not found.\n * @alias Blockly.Variables.getVariable\n */\nexport function getVariable(\n    workspace: Workspace, id: string|null, opt_name?: string,\n    opt_type?: string): VariableModel|null {\n  const potentialVariableMap = workspace.getPotentialVariableMap();\n  let variable = null;\n  // Try to just get the variable, by ID if possible.\n  if (id) {\n    // Look in the real variable map before checking the potential variable map.\n    variable = workspace.getVariableById(id);\n    if (!variable && potentialVariableMap) {\n      variable = potentialVariableMap.getVariableById(id);\n    }\n    if (variable) {\n      return variable;\n    }\n  }\n  // If there was no ID, or there was an ID but it didn't match any variables,\n  // look up by name and type.\n  if (opt_name) {\n    if (opt_type === undefined) {\n      throw Error('Tried to look up a variable by name without a type');\n    }\n    // Otherwise look up by name and type.\n    variable = workspace.getVariable(opt_name, opt_type);\n    if (!variable && potentialVariableMap) {\n      variable = potentialVariableMap.getVariable(opt_name, opt_type);\n    }\n  }\n  return variable;\n}\n\n/**\n * Helper function to create a variable on the given workspace.\n *\n * @param workspace The workspace in which to create the variable.  It may be a\n *     flyout workspace or main workspace.\n * @param id The ID to use to create the variable, or null.\n * @param opt_name The string to use to create the variable.\n * @param opt_type The type to use to create the variable.\n * @returns The variable corresponding to the given ID or name + type\n *     combination.\n */\nfunction createVariable(\n    workspace: Workspace, id: string|null, opt_name?: string,\n    opt_type?: string): VariableModel {\n  const potentialVariableMap = workspace.getPotentialVariableMap();\n  // Variables without names get uniquely named for this workspace.\n  if (!opt_name) {\n    const ws =\n        (workspace.isFlyout ? (workspace as WorkspaceSvg).targetWorkspace :\n                              workspace);\n    opt_name = generateUniqueName(ws!);\n  }\n\n  // Create a potential variable if in the flyout.\n  let variable = null;\n  if (potentialVariableMap) {\n    variable = potentialVariableMap.createVariable(opt_name, opt_type, id);\n  } else {\n    // In the main workspace, create a real variable.\n    variable = workspace.createVariable(opt_name, opt_type, id);\n  }\n  return variable;\n}\n\n/**\n * Helper function to get the list of variables that have been added to the\n * workspace after adding a new block, using the given list of variables that\n * were in the workspace before the new block was added.\n *\n * @param workspace The workspace to inspect.\n * @param originalVariables The array of variables that existed in the workspace\n *     before adding the new block.\n * @returns The new array of variables that were freshly added to the workspace\n *     after creating the new block, or [] if no new variables were added to the\n *     workspace.\n * @alias Blockly.Variables.getAddedVariables\n * @internal\n */\nexport function getAddedVariables(\n    workspace: Workspace, originalVariables: VariableModel[]): VariableModel[] {\n  const allCurrentVariables = workspace.getAllVariables();\n  const addedVariables = [];\n  if (originalVariables.length !== allCurrentVariables.length) {\n    for (let i = 0; i < allCurrentVariables.length; i++) {\n      const variable = allCurrentVariables[i];\n      // For any variable that is present in allCurrentVariables but not\n      // present in originalVariables, add the variable to addedVariables.\n      if (originalVariables.indexOf(variable) === -1) {\n        addedVariables.push(variable);\n      }\n    }\n  }\n  return addedVariables;\n}\n\nexport const TEST_ONLY = {\n  generateUniqueNameInternal,\n};\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Helper function for warning developers about deprecations.\n * This method is not specific to Blockly.\n *\n * @namespace Blockly.utils.deprecation\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.deprecation');\n\n\n/**\n * Warn developers that a function or property is deprecated.\n *\n * @param name The name of the function or property.\n * @param deprecationDate The date of deprecation. Prefer 'version n.0.0'\n *     format, and fall back to 'month yyyy' or 'quarter yyyy' format.\n * @param deletionDate The date of deletion. Prefer 'version n.0.0'\n *     format, and fall back to 'month yyyy' or 'quarter yyyy' format.\n * @param opt_use The name of a function or property to use instead, if any.\n * @alias Blockly.utils.deprecation.warn\n * @internal\n */\nexport function warn(\n    name: string, deprecationDate: string, deletionDate: string,\n    opt_use?: string) {\n  let msg = name + ' was deprecated in ' + deprecationDate +\n      ' and will be deleted in ' + deletionDate + '.';\n  if (opt_use) {\n    msg += '\\nUse ' + opt_use + ' instead.';\n  }\n  console.warn(msg);\n}\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Inject Blockly's CSS synchronously.\n *\n * @namespace Blockly.Css\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Css');\n\nimport * as deprecation from './utils/deprecation.js';\n\n\n/** Has CSS already been injected? */\nlet injected = false;\n\n/**\n * Add some CSS to the blob that will be injected later.  Allows optional\n * components such as fields and the toolbox to store separate CSS.\n *\n * @param cssContent Multiline CSS string or an array of single lines of CSS.\n * @alias Blockly.Css.register\n */\nexport function register(cssContent: string|string[]) {\n  if (injected) {\n    throw Error('CSS already injected');\n  }\n\n  if (Array.isArray(cssContent)) {\n    deprecation.warn(\n        'Registering CSS by passing an array of strings', 'September 2021',\n        'September 2022', 'css.register passing a multiline string');\n    content += '\\n' + cssContent.join('\\n');\n  } else {\n    // Add new cssContent in the global content.\n    content += '\\n' + cssContent;\n  }\n}\n\n/**\n * Inject the CSS into the DOM.  This is preferable over using a regular CSS\n * file since:\n * a) It loads synchronously and doesn't force a redraw later.\n * b) It speeds up loading by not blocking on a separate HTTP transfer.\n * c) The CSS content may be made dynamic depending on init options.\n *\n * @param hasCss If false, don't inject CSS (providing CSS becomes the\n *     document's responsibility).\n * @param pathToMedia Path from page to the Blockly media directory.\n * @alias Blockly.Css.inject\n */\nexport function inject(hasCss: boolean, pathToMedia: string) {\n  // Only inject the CSS once.\n  if (injected) {\n    return;\n  }\n  injected = true;\n  if (!hasCss) {\n    return;\n  }\n  // Strip off any trailing slash (either Unix or Windows).\n  const mediaPath = pathToMedia.replace(/[\\\\/]$/, '');\n  const cssContent = content.replace(/<<<PATH>>>/g, mediaPath);\n  // Cleanup the collected css content after injecting it to the DOM.\n  content = '';\n\n  // Inject CSS tag at start of head.\n  const cssNode = document.createElement('style');\n  cssNode.id = 'blockly-common-style';\n  const cssTextNode = document.createTextNode(cssContent);\n  cssNode.appendChild(cssTextNode);\n  document.head.insertBefore(cssNode, document.head.firstChild);\n}\n\n/**\n * The CSS content for Blockly.\n *\n * @alias Blockly.Css.content\n */\nlet content = `\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n}\n\n.blocklyNonSelectable {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyWsDragSurface {\n  display: none;\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\n/* Added as a separate rule with multiple classes to make it more specific\n   than a bootstrap rule that selects svg:root. See issue #1275 for context.\n*/\n.blocklyWsDragSurface.blocklyOverflowVisible {\n  overflow: visible;\n}\n\n.blocklyBlockDragSurface {\n  display: none;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 50;  /* Display below toolbox, but above everything else. */\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  // @todo: spec for maximum height.\n  overflow: auto;\n  overflow-x: hidden;\n  position: relative;\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n}\n\n.blocklyDropDownButton {\n  display: inline-block;\n  float: left;\n  padding: 0;\n  margin: 4px;\n  border-radius: 4px;\n  outline: none;\n  border: 1px solid;\n  transition: box-shadow .1s;\n  cursor: pointer;\n}\n\n.blocklyArrowTop {\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyArrowBottom {\n  border-bottom: 1px solid;\n  border-right: 1px solid;\n  border-bottom-right-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyResizeSE {\n  cursor: se-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeSW {\n  cursor: sw-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeLine {\n  stroke: #515A5A;\n  stroke-width: 1;\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  /* backup for browsers (e.g. IE11) that don't support grab */\n  cursor: url(\"<<<PATH>>>/handopen.cur\"), auto;\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n  /* backup for browsers (e.g. IE11) that don't support grabbing */\n.blocklyDragging {\n  /* backup for browsers (e.g. IE11) that don't support grabbing */\n  cursor: url(\"<<<PATH>>>/handclosed.cur\"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  /* backup for browsers (e.g. IE11) that don't support grabbing */\n  cursor: url(\"<<<PATH>>>/handclosed.cur\"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Change the cursor on the whole drag surface in case the mouse gets\n   ahead of block during a drag. This way the cursor is still a closed hand.\n  */\n.blocklyBlockDragSurface .blocklyDraggable {\n  /* backup for browsers (e.g. IE11) that don't support grabbing */\n  cursor: url(\"<<<PATH>>>/handclosed.cur\"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url(\"<<<PATH>>>/handdelete.cur\"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabled>.blocklyPath {\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyMultilineText {\n  font-family: monospace;\n}\n\n.blocklyNonEditableText>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don't allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text,\n.blocklyBlockDragSurface text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyHidden {\n  display: none;\n}\n\n.blocklyFieldDropdown:not(.blocklyHidden) {\n  display: block;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Edge and IE introduce a close icon when the input value is longer than a\n   certain length. This affects our sizing calculations of the text input.\n   Hiding the close icon to avoid that. */\n.blocklyHtmlInput::-ms-clear {\n  display: none;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px \"Helvetica Neue\", Helvetica, sans-serif;\n  outline: none;\n  position: relative;  /* Compatibility with gapi, reset from goog-menu */\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n`;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utilities for element styles.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @namespace Blockly.utils.style\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.style');\n\nimport * as deprecation from './deprecation.js';\nimport {Coordinate} from './coordinate.js';\nimport {Rect} from './rect.js';\nimport {Size} from './size.js';\n\n\n/**\n * Gets the height and width of an element.\n * Similar to Closure's goog.style.getSize\n *\n * @param element Element to get size of.\n * @returns Object with width/height properties.\n * @alias Blockly.utils.style.getSize\n */\nexport function getSize(element: Element): Size {\n  return TEST_ONLY.getSizeInternal(element);\n}\n\n/**\n * Private version of getSize for stubbing in tests.\n */\nfunction getSizeInternal(element: Element): Size {\n  if (getComputedStyle(element, 'display') !== 'none') {\n    return getSizeWithDisplay(element);\n  }\n\n  // Evaluate size with a temporary element.\n  // AnyDuringMigration because:  Property 'style' does not exist on type\n  // 'Element'.\n  const style = (element as AnyDuringMigration).style;\n  const originalDisplay = style.display;\n  const originalVisibility = style.visibility;\n  const originalPosition = style.position;\n\n  style.visibility = 'hidden';\n  style.position = 'absolute';\n  style.display = 'inline';\n\n  const offsetWidth = (element as HTMLElement).offsetWidth;\n  const offsetHeight = (element as HTMLElement).offsetHeight;\n\n  style.display = originalDisplay;\n  style.position = originalPosition;\n  style.visibility = originalVisibility;\n\n  return new Size(offsetWidth, offsetHeight);\n}\n\n/**\n * Gets the height and width of an element when the display is not none.\n *\n * @param element Element to get size of.\n * @returns Object with width/height properties.\n */\nfunction getSizeWithDisplay(element: Element): Size {\n  const offsetWidth = (element as HTMLElement).offsetWidth;\n  const offsetHeight = (element as HTMLElement).offsetHeight;\n  return new Size(offsetWidth, offsetHeight);\n}\n\n/**\n * Retrieves a computed style value of a node. It returns empty string\n * if the property requested is an SVG one and it has not been\n * explicitly set (firefox and webkit).\n *\n * Copied from Closure's goog.style.getComputedStyle\n *\n * @param element Element to get style of.\n * @param property Property to get (camel-case).\n * @returns Style value.\n * @alias Blockly.utils.style.getComputedStyle\n */\nexport function getComputedStyle(element: Element, property: string): string {\n  const styles = window.getComputedStyle(element);\n  // element.style[..] is undefined for browser specific styles\n  // as 'filter'.\n  return (styles as AnyDuringMigration)[property] ||\n      styles.getPropertyValue(property);\n}\n\n/**\n * Gets the cascaded style value of a node, or null if the value cannot be\n * computed (only Internet Explorer can do this).\n *\n * Copied from Closure's goog.style.getCascadedStyle\n *\n * @param element Element to get style of.\n * @param style Property to get (camel-case).\n * @returns Style value.\n * @alias Blockly.utils.style.getCascadedStyle\n */\nexport function getCascadedStyle(element: Element, style: string): string {\n  deprecation.warn(\n      'Blockly.utils.style.getCascadedStyle', 'version 9.0.0',\n      'version 10.0.0');\n  // AnyDuringMigration because:  Property 'currentStyle' does not exist on type\n  // 'Element'. AnyDuringMigration because:  Property 'currentStyle' does not\n  // exist on type 'Element'.\n  return (element as AnyDuringMigration).currentStyle ?\n      (element as AnyDuringMigration).currentStyle[style] :\n      '' as string;\n}\n\n/**\n * Returns a Coordinate object relative to the top-left of the HTML document.\n * Similar to Closure's goog.style.getPageOffset\n *\n * @param el Element to get the page offset for.\n * @returns The page offset.\n * @alias Blockly.utils.style.getPageOffset\n */\nexport function getPageOffset(el: Element): Coordinate {\n  const pos = new Coordinate(0, 0);\n  const box = el.getBoundingClientRect();\n  const documentElement = document.documentElement;\n  // Must add the scroll coordinates in to get the absolute page offset\n  // of element since getBoundingClientRect returns relative coordinates to\n  // the viewport.\n  const scrollCoord = new Coordinate(\n      window.pageXOffset || documentElement.scrollLeft,\n      window.pageYOffset || documentElement.scrollTop);\n  pos.x = box.left + scrollCoord.x;\n  pos.y = box.top + scrollCoord.y;\n\n  return pos;\n}\n\n/**\n * Calculates the viewport coordinates relative to the document.\n * Similar to Closure's goog.style.getViewportPageOffset\n *\n * @returns The page offset of the viewport.\n * @alias Blockly.utils.style.getViewportPageOffset\n */\nexport function getViewportPageOffset(): Coordinate {\n  const body = document.body;\n  const documentElement = document.documentElement;\n  const scrollLeft = body.scrollLeft || documentElement.scrollLeft;\n  const scrollTop = body.scrollTop || documentElement.scrollTop;\n  return new Coordinate(scrollLeft, scrollTop);\n}\n\n/**\n * Gets the computed border widths (on all sides) in pixels\n * Copied from Closure's goog.style.getBorderBox\n *\n * @param element  The element to get the border widths for.\n * @returns The computed border widths.\n * @alias Blockly.utils.style.getBorderBox\n */\nexport function getBorderBox(element: Element): Rect {\n  const left = parseFloat(getComputedStyle(element, 'borderLeftWidth'));\n  const right = parseFloat(getComputedStyle(element, 'borderRightWidth'));\n  const top = parseFloat(getComputedStyle(element, 'borderTopWidth'));\n  const bottom = parseFloat(getComputedStyle(element, 'borderBottomWidth'));\n\n  return new Rect(top, bottom, left, right);\n}\n\n/**\n * Changes the scroll position of `container` with the minimum amount so\n * that the content and the borders of the given `element` become visible.\n * If the element is bigger than the container, its top left corner will be\n * aligned as close to the container's top left corner as possible.\n * Copied from Closure's goog.style.scrollIntoContainerView\n *\n * @param element The element to make visible.\n * @param container The container to scroll. If not set, then the document\n *     scroll element will be used.\n * @param opt_center Whether to center the element in the container.\n *     Defaults to false.\n * @alias Blockly.utils.style.scrollIntoContainerView\n */\nexport function scrollIntoContainerView(\n    element: Element, container: Element, opt_center?: boolean) {\n  const offset = getContainerOffsetToScrollInto(element, container, opt_center);\n  container.scrollLeft = offset.x;\n  container.scrollTop = offset.y;\n}\n\n/**\n * Calculate the scroll position of `container` with the minimum amount so\n * that the content and the borders of the given `element` become visible.\n * If the element is bigger than the container, its top left corner will be\n * aligned as close to the container's top left corner as possible.\n * Copied from Closure's goog.style.getContainerOffsetToScrollInto\n *\n * @param element The element to make visible.\n * @param container The container to scroll. If not set, then the document\n *     scroll element will be used.\n * @param opt_center Whether to center the element in the container.\n *     Defaults to false.\n * @returns The new scroll position of the container.\n * @alias Blockly.utils.style.getContainerOffsetToScrollInto\n */\nexport function getContainerOffsetToScrollInto(\n    element: Element, container: Element, opt_center?: boolean): Coordinate {\n  // Absolute position of the element's border's top left corner.\n  const elementPos = getPageOffset(element);\n  // Absolute position of the container's border's top left corner.\n  const containerPos = getPageOffset(container);\n  const containerBorder = getBorderBox(container);\n  // Relative pos. of the element's border box to the container's content box.\n  const relX = elementPos.x - containerPos.x - containerBorder.left;\n  const relY = elementPos.y - containerPos.y - containerBorder.top;\n  // How much the element can move in the container, i.e. the difference between\n  // the element's bottom-right-most and top-left-most position where it's\n  // fully visible.\n  const elementSize = getSizeWithDisplay(element);\n  const spaceX = container.clientWidth - elementSize.width;\n  const spaceY = container.clientHeight - elementSize.height;\n  let scrollLeft = container.scrollLeft;\n  let scrollTop = container.scrollTop;\n  if (opt_center) {\n    // All browsers round non-integer scroll positions down.\n    scrollLeft += relX - spaceX / 2;\n    scrollTop += relY - spaceY / 2;\n  } else {\n    // This formula was designed to give the correct scroll values in the\n    // following cases:\n    // - element is higher than container (spaceY < 0) => scroll down by relY\n    // - element is not higher that container (spaceY >= 0):\n    //   - it is above container (relY < 0) => scroll up by abs(relY)\n    //   - it is below container (relY > spaceY) => scroll down by relY - spaceY\n    //   - it is in the container => don't scroll\n    scrollLeft += Math.min(relX, Math.max(relX - spaceX, 0));\n    scrollTop += Math.min(relY, Math.max(relY - spaceY, 0));\n  }\n  return new Coordinate(scrollLeft, scrollTop);\n}\n\nexport const TEST_ONLY = {\n  getSizeInternal,\n};\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods realted to figuring out positions of SVG elements.\n *\n * @namespace Blockly.utils.svgMath\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.svgMath');\n\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\nimport {Coordinate} from './coordinate.js';\nimport * as deprecation from './deprecation.js';\nimport {Rect} from './rect.js';\nimport {Size} from './size.js';\nimport * as style from './style.js';\n\n\n/**\n * Static regex to pull the x,y values out of an SVG translate() directive.\n * Note that Firefox and IE (9,10) return 'translate(12)' instead of\n * 'translate(12, 0)'.\n * Note that IE (9,10) returns 'translate(16 8)' instead of 'translate(16, 8)'.\n * Note that IE has been reported to return scientific notation (0.123456e-42).\n */\nconst XY_REGEX = /translate\\(\\s*([-+\\d.e]+)([ ,]\\s*([-+\\d.e]+)\\s*)?/;\n\n/**\n * Static regex to pull the x,y values out of a translate() or translate3d()\n * style property.\n * Accounts for same exceptions as XY_REGEX.\n */\nconst XY_STYLE_REGEX =\n    /transform:\\s*translate(?:3d)?\\(\\s*([-+\\d.e]+)\\s*px([ ,]\\s*([-+\\d.e]+)\\s*px)?/;\n\n/**\n * Return the coordinates of the top-left corner of this element relative to\n * its parent.  Only for SVG elements and children (e.g. rect, g, path).\n *\n * @param element SVG element to find the coordinates of.\n * @returns Object with .x and .y properties.\n * @alias Blockly.utils.svgMath.getRelativeXY\n */\nexport function getRelativeXY(element: Element): Coordinate {\n  const xy = new Coordinate(0, 0);\n  // First, check for x and y attributes.\n  // Checking for the existence of x/y properties is faster than getAttribute.\n  // However, x/y contains an SVGAnimatedLength object, so rely on getAttribute\n  // to get the number.\n  const x = (element as any).x && element.getAttribute('x');\n  const y = (element as any).y && element.getAttribute('y');\n  if (x) {\n    xy.x = parseInt(x, 10);\n  }\n  if (y) {\n    xy.y = parseInt(y, 10);\n  }\n  // Second, check for transform=\"translate(...)\" attribute.\n  const transform = element.getAttribute('transform');\n  const r = transform && transform.match(XY_REGEX);\n  if (r) {\n    xy.x += Number(r[1]);\n    if (r[3]) {\n      xy.y += Number(r[3]);\n    }\n  }\n\n  // Then check for style = transform: translate(...) or translate3d(...)\n  const style = element.getAttribute('style');\n  if (style && style.indexOf('translate') > -1) {\n    const styleComponents = style.match(XY_STYLE_REGEX);\n    if (styleComponents) {\n      xy.x += Number(styleComponents[1]);\n      if (styleComponents[3]) {\n        xy.y += Number(styleComponents[3]);\n      }\n    }\n  }\n  return xy;\n}\n\n/**\n * Return the coordinates of the top-left corner of this element relative to\n * the div Blockly was injected into.\n *\n * @param element SVG element to find the coordinates of. If this is not a child\n *     of the div Blockly was injected into, the behaviour is undefined.\n * @returns Object with .x and .y properties.\n * @alias Blockly.utils.svgMath.getInjectionDivXY\n */\nexport function getInjectionDivXY(element: Element): Coordinate {\n  let x = 0;\n  let y = 0;\n  while (element) {\n    const xy = getRelativeXY(element);\n    x = x + xy.x;\n    y = y + xy.y;\n    const classes = element.getAttribute('class') || '';\n    if ((' ' + classes + ' ').indexOf(' injectionDiv ') !== -1) {\n      break;\n    }\n    element = element.parentNode as Element;\n  }\n  return new Coordinate(x, y);\n}\n\n/**\n * Check if 3D transforms are supported by adding an element\n * and attempting to set the property.\n *\n * @returns True if 3D transforms are supported.\n * @alias Blockly.utils.svgMath.is3dSupported\n */\nexport function is3dSupported(): boolean {\n  // All browsers support translate3d in 2022.\n  deprecation.warn(\n      'Blockly.utils.svgMath.is3dSupported', 'version 9.0.0', 'version 10.0.0');\n  return true;\n}\n\n/**\n * Get the position of the current viewport in window coordinates.  This takes\n * scroll into account.\n *\n * @returns An object containing window width, height, and scroll position in\n *     window coordinates.\n * @alias Blockly.utils.svgMath.getViewportBBox\n * @internal\n */\nexport function getViewportBBox(): Rect {\n  // Pixels, in window coordinates.\n  const scrollOffset = style.getViewportPageOffset();\n  return new Rect(\n      scrollOffset.y, document.documentElement.clientHeight + scrollOffset.y,\n      scrollOffset.x, document.documentElement.clientWidth + scrollOffset.x);\n}\n\n/**\n * Gets the document scroll distance as a coordinate object.\n * Copied from Closure's goog.dom.getDocumentScroll.\n *\n * @returns Object with values 'x' and 'y'.\n * @alias Blockly.utils.svgMath.getDocumentScroll\n */\nexport function getDocumentScroll(): Coordinate {\n  const el = document.documentElement;\n  const win = window;\n  return new Coordinate(\n      win.pageXOffset || el.scrollLeft, win.pageYOffset || el.scrollTop);\n}\n\n/**\n * Converts screen coordinates to workspace coordinates.\n *\n * @param ws The workspace to find the coordinates on.\n * @param screenCoordinates The screen coordinates to be converted to workspace\n *     coordinates\n * @returns The workspace coordinates.\n * @alias Blockly.utils.svgMath.screenToWsCoordinates\n */\nexport function screenToWsCoordinates(\n    ws: WorkspaceSvg, screenCoordinates: Coordinate): Coordinate {\n  const screenX = screenCoordinates.x;\n  const screenY = screenCoordinates.y;\n\n  const injectionDiv = ws.getInjectionDiv();\n  // Bounding rect coordinates are in client coordinates, meaning that they\n  // are in pixels relative to the upper left corner of the visible browser\n  // window.  These coordinates change when you scroll the browser window.\n  const boundingRect = injectionDiv.getBoundingClientRect();\n\n  // The client coordinates offset by the injection div's upper left corner.\n  const clientOffsetPixels =\n      new Coordinate(screenX - boundingRect.left, screenY - boundingRect.top);\n\n  // The offset in pixels between the main workspace's origin and the upper\n  // left corner of the injection div.\n  const mainOffsetPixels = ws.getOriginOffsetInPixels();\n\n  // The position of the new comment in pixels relative to the origin of the\n  // main workspace.\n  const finalOffsetPixels =\n      Coordinate.difference(clientOffsetPixels, mainOffsetPixels);\n  // The position in main workspace coordinates.\n  const finalOffsetMainWs = finalOffsetPixels.scale(1 / ws.scale);\n  return finalOffsetMainWs;\n}\n\n/**\n * Returns the dimensions of the specified SVG image.\n *\n * @param svg SVG image.\n * @returns Contains width and height properties.\n * @deprecated Use workspace.getCachedParentSvgSize. (2021 March 5)\n * @alias Blockly.utils.svgMath.svgSize\n */\nexport function svgSize(svg: SVGElement): Size {\n  // When removing this function, remove svg.cachedWidth_ and svg.cachedHeight_\n  // from setCachedParentSvgSize.\n  // The deprecated name is `Blockly.svgSize` because this function used to be\n  // declared in Blockly.js.\n  deprecation.warn(\n      'Blockly.svgSize', 'March 2021', 'March 2022',\n      'workspace.getCachedParentSvgSize');\n  svg = svg as AnyDuringMigration;\n  return new Size(\n      Number(svg.getAttribute('data-cached-width')),\n      Number(svg.getAttribute('data-cached-height')));\n}\n\nexport const TEST_ONLY = {\n  XY_REGEX,\n  XY_STYLE_REGEX,\n};\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * XML reader and writer.\n *\n * @namespace Blockly.Xml\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Xml');\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport type {Connection} from './connection.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Field} from './field.js';\nimport {inputTypes} from './input_types.js';\nimport * as dom from './utils/dom.js';\nimport {Size} from './utils/size.js';\nimport * as utilsXml from './utils/xml.js';\nimport type {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\nimport {WorkspaceComment} from './workspace_comment.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Encode a block tree as XML.\n *\n * @param workspace The workspace containing blocks.\n * @param opt_noId True if the encoder should skip the block IDs.\n * @returns XML DOM element.\n * @alias Blockly.Xml.workspaceToDom\n */\nexport function workspaceToDom(\n    workspace: Workspace, opt_noId?: boolean): Element {\n  const treeXml = utilsXml.createElement('xml');\n  const variablesElement =\n      variablesToDom(Variables.allUsedVarModels(workspace));\n  if (variablesElement.hasChildNodes()) {\n    treeXml.appendChild(variablesElement);\n  }\n  const comments = workspace.getTopComments(true);\n  for (let i = 0; i < comments.length; i++) {\n    const comment = comments[i];\n    treeXml.appendChild(comment.toXmlWithXY(opt_noId));\n  }\n  const blocks = workspace.getTopBlocks(true);\n  for (let i = 0; i < blocks.length; i++) {\n    const block = blocks[i];\n    treeXml.appendChild(blockToDomWithXY(block, opt_noId));\n  }\n  return treeXml;\n}\n\n/**\n * Encode a list of variables as XML.\n *\n * @param variableList List of all variable models.\n * @returns Tree of XML elements.\n * @alias Blockly.Xml.variablesToDom\n */\nexport function variablesToDom(variableList: VariableModel[]): Element {\n  const variables = utilsXml.createElement('variables');\n  for (let i = 0; i < variableList.length; i++) {\n    const variable = variableList[i];\n    const element = utilsXml.createElement('variable');\n    element.appendChild(utilsXml.createTextNode(variable.name));\n    if (variable.type) {\n      element.setAttribute('type', variable.type);\n    }\n    element.id = variable.getId();\n    variables.appendChild(element);\n  }\n  return variables;\n}\n\n/**\n * Encode a block subtree as XML with XY coordinates.\n *\n * @param block The root block to encode.\n * @param opt_noId True if the encoder should skip the block ID.\n * @returns Tree of XML elements or an empty document fragment if the block was\n *     an insertion marker.\n * @alias Blockly.Xml.blockToDomWithXY\n */\nexport function blockToDomWithXY(block: Block, opt_noId?: boolean): Element|\n    DocumentFragment {\n  if (block.isInsertionMarker()) {  // Skip over insertion markers.\n    block = block.getChildren(false)[0];\n    if (!block) {\n      // Disappears when appended.\n      return new DocumentFragment();\n    }\n  }\n\n  let width = 0;  // Not used in LTR.\n  if (block.workspace.RTL) {\n    width = block.workspace.getWidth();\n  }\n\n  const element = blockToDom(block, opt_noId);\n  const xy = block.getRelativeToSurfaceXY();\n  // AnyDuringMigration because:  Property 'setAttribute' does not exist on type\n  // 'Element | DocumentFragment'.\n  (element as AnyDuringMigration)\n      .setAttribute('x', Math.round(block.workspace.RTL ? width - xy.x : xy.x));\n  // AnyDuringMigration because:  Property 'setAttribute' does not exist on type\n  // 'Element | DocumentFragment'.\n  (element as AnyDuringMigration).setAttribute('y', Math.round(xy.y));\n  return element;\n}\n\n/**\n * Encode a field as XML.\n *\n * @param field The field to encode.\n * @returns XML element, or null if the field did not need to be serialized.\n */\nfunction fieldToDom(field: Field): Element|null {\n  if (field.isSerializable()) {\n    const container = utilsXml.createElement('field');\n    container.setAttribute('name', field.name || '');\n    return field.toXml(container);\n  }\n  return null;\n}\n\n/**\n * Encode all of a block's fields as XML and attach them to the given tree of\n * XML elements.\n *\n * @param block A block with fields to be encoded.\n * @param element The XML element to which the field DOM should be attached.\n */\nfunction allFieldsToDom(block: Block, element: Element) {\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    for (let j = 0; j < input.fieldRow.length; j++) {\n      const field = input.fieldRow[j];\n      const fieldDom = fieldToDom(field);\n      if (fieldDom) {\n        element.appendChild(fieldDom);\n      }\n    }\n  }\n}\n\n/**\n * Encode a block subtree as XML.\n *\n * @param block The root block to encode.\n * @param opt_noId True if the encoder should skip the block ID.\n * @returns Tree of XML elements or an empty document fragment if the block was\n *     an insertion marker.\n * @alias Blockly.Xml.blockToDom\n */\nexport function blockToDom(block: Block, opt_noId?: boolean): Element|\n    DocumentFragment {\n  // Skip over insertion markers.\n  if (block.isInsertionMarker()) {\n    const child = block.getChildren(false)[0];\n    if (child) {\n      return blockToDom(child);\n    } else {\n      // Disappears when appended.\n      return new DocumentFragment();\n    }\n  }\n\n  const element = utilsXml.createElement(block.isShadow() ? 'shadow' : 'block');\n  element.setAttribute('type', block.type);\n  if (!opt_noId) {\n    // It's important to use setAttribute here otherwise IE11 won't serialize\n    // the block's ID when domToText is called.\n    element.setAttribute('id', block.id);\n  }\n  if (block.mutationToDom) {\n    // Custom data for an advanced block.\n    const mutation = block.mutationToDom();\n    if (mutation && (mutation.hasChildNodes() || mutation.hasAttributes())) {\n      element.appendChild(mutation);\n    }\n  }\n\n  allFieldsToDom(block, element);\n\n  const commentText = block.getCommentText();\n  if (commentText) {\n    const size = block.commentModel.size;\n    const pinned = block.commentModel.pinned;\n\n    const commentElement = utilsXml.createElement('comment');\n    commentElement.appendChild(utilsXml.createTextNode(commentText));\n    // AnyDuringMigration because:  Argument of type 'boolean' is not assignable\n    // to parameter of type 'string'.\n    commentElement.setAttribute('pinned', pinned as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    commentElement.setAttribute('h', size.height as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    commentElement.setAttribute('w', size.width as AnyDuringMigration);\n\n    element.appendChild(commentElement);\n  }\n\n  if (block.data) {\n    const dataElement = utilsXml.createElement('data');\n    dataElement.appendChild(utilsXml.createTextNode(block.data));\n    element.appendChild(dataElement);\n  }\n\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    let container: Element;\n    let empty = true;\n    if (input.type === inputTypes.DUMMY) {\n      continue;\n    } else {\n      const childBlock = input.connection!.targetBlock();\n      if (input.type === inputTypes.VALUE) {\n        container = utilsXml.createElement('value');\n      } else if (input.type === inputTypes.STATEMENT) {\n        container = utilsXml.createElement('statement');\n      }\n      const childShadow = input.connection!.getShadowDom();\n      if (childShadow && (!childBlock || !childBlock.isShadow())) {\n        container!.appendChild(cloneShadow(childShadow, opt_noId));\n      }\n      if (childBlock) {\n        const childElem = blockToDom(childBlock, opt_noId);\n        if (childElem.nodeType === dom.NodeType.ELEMENT_NODE) {\n          container!.appendChild(childElem);\n          empty = false;\n        }\n      }\n    }\n    container!.setAttribute('name', input.name);\n    if (!empty) {\n      element.appendChild(container!);\n    }\n  }\n  if (block.inputsInline !== undefined &&\n      block.inputsInline !== block.inputsInlineDefault) {\n    element.setAttribute('inline', block.inputsInline.toString());\n  }\n  if (block.isCollapsed()) {\n    element.setAttribute('collapsed', 'true');\n  }\n  if (!block.isEnabled()) {\n    element.setAttribute('disabled', 'true');\n  }\n  if (!block.isDeletable() && !block.isShadow()) {\n    element.setAttribute('deletable', 'false');\n  }\n  if (!block.isMovable() && !block.isShadow()) {\n    element.setAttribute('movable', 'false');\n  }\n  if (!block.isEditable()) {\n    element.setAttribute('editable', 'false');\n  }\n\n  const nextBlock = block.getNextBlock();\n  let container: Element;\n  if (nextBlock) {\n    const nextElem = blockToDom(nextBlock, opt_noId);\n    if (nextElem.nodeType === dom.NodeType.ELEMENT_NODE) {\n      container = utilsXml.createElement('next');\n      container.appendChild(nextElem);\n      element.appendChild(container);\n    }\n  }\n  const nextShadow =\n      block.nextConnection && block.nextConnection.getShadowDom();\n  if (nextShadow && (!nextBlock || !nextBlock.isShadow())) {\n    container!.appendChild(cloneShadow(nextShadow, opt_noId));\n  }\n\n  return element;\n}\n\n/**\n * Deeply clone the shadow's DOM so that changes don't back-wash to the block.\n *\n * @param shadow A tree of XML elements.\n * @param opt_noId True if the encoder should skip the block ID.\n * @returns A tree of XML elements.\n */\nfunction cloneShadow(shadow: Element, opt_noId?: boolean): Element {\n  shadow = shadow.cloneNode(true) as Element;\n  // Walk the tree looking for whitespace.  Don't prune whitespace in a tag.\n  let node: Node|null = shadow;\n  let textNode;\n  while (node) {\n    if (opt_noId && node.nodeName === 'shadow') {\n      // Strip off IDs from shadow blocks.  There should never be a 'block' as\n      // a child of a 'shadow', so no need to check that.\n      (node as Element).removeAttribute('id');\n    }\n    if (node.firstChild) {\n      node = node.firstChild;\n    } else {\n      while (node && !node.nextSibling) {\n        textNode = node;\n        node = node.parentNode;\n        if (textNode.nodeType === dom.NodeType.TEXT_NODE &&\n            (textNode as Text).data.trim() === '' &&\n            node?.firstChild !== textNode) {\n          // Prune whitespace after a tag.\n          dom.removeNode(textNode);\n        }\n      }\n      if (node) {\n        textNode = node;\n        node = node.nextSibling;\n        if (textNode.nodeType === dom.NodeType.TEXT_NODE &&\n            (textNode as Text).data.trim() === '') {\n          // Prune whitespace before a tag.\n          dom.removeNode(textNode);\n        }\n      }\n    }\n  }\n  return shadow;\n}\n\n/**\n * Converts a DOM structure into plain text.\n * Currently the text format is fairly ugly: all one line with no whitespace,\n * unless the DOM itself has whitespace built-in.\n *\n * @param dom A tree of XML nodes.\n * @returns Text representation.\n * @alias Blockly.Xml.domToText\n */\nexport function domToText(dom: Node): string {\n  const text = utilsXml.domToText(dom);\n  // Unpack self-closing tags.  These tags fail when embedded in HTML.\n  // <block name=\"foo\"/> -> <block name=\"foo\"></block>\n  return text.replace(/<(\\w+)([^<]*)\\/>/g, '<$1$2></$1>');\n}\n\n/**\n * Converts a DOM structure into properly indented text.\n *\n * @param dom A tree of XML elements.\n * @returns Text representation.\n * @alias Blockly.Xml.domToPrettyText\n */\nexport function domToPrettyText(dom: Node): string {\n  // This function is not guaranteed to be correct for all XML.\n  // But it handles the XML that Blockly generates.\n  const blob = domToText(dom);\n  // Place every open and close tag on its own line.\n  const lines = blob.split('<');\n  // Indent every line.\n  let indent = '';\n  for (let i = 1; i < lines.length; i++) {\n    const line = lines[i];\n    if (line[0] === '/') {\n      indent = indent.substring(2);\n    }\n    lines[i] = indent + '<' + line;\n    if (line[0] !== '/' && line.slice(-2) !== '/>') {\n      indent += '  ';\n    }\n  }\n  // Pull simple tags back together.\n  // E.g. <foo></foo>\n  let text = lines.join('\\n');\n  text = text.replace(/(<(\\w+)\\b[^>]*>[^\\n]*)\\n *<\\/\\2>/g, '$1</$2>');\n  // Trim leading blank line.\n  return text.replace(/^\\n/, '');\n}\n\n/**\n * Converts an XML string into a DOM structure.\n *\n * @param text An XML string.\n * @returns A DOM object representing the singular child of the document\n *     element.\n * @throws if the text doesn't parse.\n * @alias Blockly.Xml.textToDom\n */\nexport function textToDom(text: string): Element {\n  const doc = utilsXml.textToDomDocument(text);\n  if (!doc || !doc.documentElement ||\n      doc.getElementsByTagName('parsererror').length) {\n    throw Error('textToDom was unable to parse: ' + text);\n  }\n  return doc.documentElement;\n}\n\n/**\n * Clear the given workspace then decode an XML DOM and\n * create blocks on the workspace.\n *\n * @param xml XML DOM.\n * @param workspace The workspace.\n * @returns An array containing new block IDs.\n * @alias Blockly.Xml.clearWorkspaceAndLoadFromXml\n */\nexport function clearWorkspaceAndLoadFromXml(\n    xml: Element, workspace: WorkspaceSvg): string[] {\n  workspace.setResizesEnabled(false);\n  workspace.clear();\n  // AnyDuringMigration because:  Argument of type 'WorkspaceSvg' is not\n  // assignable to parameter of type 'Workspace'.\n  const blockIds = domToWorkspace(xml, workspace as AnyDuringMigration);\n  workspace.setResizesEnabled(true);\n  return blockIds;\n}\n\n/**\n * Decode an XML DOM and create blocks on the workspace.\n *\n * @param xml XML DOM.\n * @param workspace The workspace.\n * @returns An array containing new block IDs.\n * @suppress {strictModuleDepCheck} Suppress module check while workspace\n * comments are not bundled in.\n * @alias Blockly.Xml.domToWorkspace\n */\nexport function domToWorkspace(xml: Element, workspace: Workspace): string[] {\n  let width = 0;  // Not used in LTR.\n  if (workspace.RTL) {\n    width = workspace.getWidth();\n  }\n  const newBlockIds = [];  // A list of block IDs added by this call.\n  dom.startTextWidthCache();\n  const existingGroup = eventUtils.getGroup();\n  if (!existingGroup) {\n    eventUtils.setGroup(true);\n  }\n\n  // Disable workspace resizes as an optimization.\n  // Assume it is rendered so we can check.\n  if ((workspace as WorkspaceSvg).setResizesEnabled) {\n    (workspace as WorkspaceSvg).setResizesEnabled(false);\n  }\n  let variablesFirst = true;\n  try {\n    for (let i = 0, xmlChild; xmlChild = xml.childNodes[i]; i++) {\n      const name = xmlChild.nodeName.toLowerCase();\n      const xmlChildElement = xmlChild as Element;\n      if (name === 'block' ||\n          name === 'shadow' && !eventUtils.getRecordUndo()) {\n        // Allow top-level shadow blocks if recordUndo is disabled since\n        // that means an undo is in progress.  Such a block is expected\n        // to be moved to a nested destination in the next operation.\n        const block = domToBlock(xmlChildElement, workspace);\n        newBlockIds.push(block.id);\n        // AnyDuringMigration because:  Argument of type 'string | null' is not\n        // assignable to parameter of type 'string'.\n        const blockX = xmlChildElement.hasAttribute('x') ?\n            parseInt(\n                xmlChildElement.getAttribute('x') as AnyDuringMigration, 10) :\n            10;\n        // AnyDuringMigration because:  Argument of type 'string | null' is not\n        // assignable to parameter of type 'string'.\n        const blockY = xmlChildElement.hasAttribute('y') ?\n            parseInt(\n                xmlChildElement.getAttribute('y') as AnyDuringMigration, 10) :\n            10;\n        if (!isNaN(blockX) && !isNaN(blockY)) {\n          block.moveBy(workspace.RTL ? width - blockX : blockX, blockY);\n        }\n        variablesFirst = false;\n      } else if (name === 'shadow') {\n        throw TypeError('Shadow block cannot be a top-level block.');\n      } else if (name === 'comment') {\n        if (workspace.rendered) {\n          WorkspaceCommentSvg.fromXmlRendered(\n              xmlChildElement, workspace as WorkspaceSvg, width);\n        } else {\n          WorkspaceComment.fromXml(xmlChildElement, workspace);\n        }\n      } else if (name === 'variables') {\n        if (variablesFirst) {\n          domToVariables(xmlChildElement, workspace);\n        } else {\n          throw Error(\n              '\\'variables\\' tag must exist once before block and ' +\n              'shadow tag elements in the workspace XML, but it was found in ' +\n              'another location.');\n        }\n        variablesFirst = false;\n      }\n    }\n  } finally {\n    if (!existingGroup) {\n      eventUtils.setGroup(false);\n    }\n    dom.stopTextWidthCache();\n  }\n  // Re-enable workspace resizing.\n  if ((workspace as WorkspaceSvg).setResizesEnabled) {\n    (workspace as WorkspaceSvg).setResizesEnabled(true);\n  }\n  eventUtils.fire(new (eventUtils.get(eventUtils.FINISHED_LOADING))(workspace));\n  return newBlockIds;\n}\n\n/**\n * Decode an XML DOM and create blocks on the workspace. Position the new\n * blocks immediately below prior blocks, aligned by their starting edge.\n *\n * @param xml The XML DOM.\n * @param workspace The workspace to add to.\n * @returns An array containing new block IDs.\n * @alias Blockly.Xml.appendDomToWorkspace\n */\nexport function appendDomToWorkspace(\n    xml: Element, workspace: WorkspaceSvg): string[] {\n  // First check if we have a WorkspaceSvg, otherwise the blocks have no shape\n  // and the position does not matter.\n  // Assume it is rendered so we can check.\n  if (!(workspace as WorkspaceSvg).getBlocksBoundingBox) {\n    return domToWorkspace(xml, workspace);\n  }\n\n  const bbox = (workspace as WorkspaceSvg).getBlocksBoundingBox();\n  // Load the new blocks into the workspace and get the IDs of the new blocks.\n  const newBlockIds = domToWorkspace(xml, workspace);\n  if (bbox && bbox.top !== bbox.bottom) {  // Check if any previous block.\n    let offsetY = 0;  // Offset to add to y of the new block.\n    let offsetX = 0;\n    const farY = bbox.bottom;                             // Bottom position.\n    const topX = workspace.RTL ? bbox.right : bbox.left;  // X of bounding box.\n    // Check position of the new blocks.\n    let newLeftX = Infinity;    // X of top left corner.\n    let newRightX = -Infinity;  // X of top right corner.\n    let newY = Infinity;        // Y of top corner.\n    const ySeparation = 10;\n    for (let i = 0; i < newBlockIds.length; i++) {\n      const blockXY =\n          workspace.getBlockById(newBlockIds[i])!.getRelativeToSurfaceXY();\n      if (blockXY.y < newY) {\n        newY = blockXY.y;\n      }\n      if (blockXY.x < newLeftX) {  // if we left align also on x\n        newLeftX = blockXY.x;\n      }\n      if (blockXY.x > newRightX) {  // if we right align also on x\n        newRightX = blockXY.x;\n      }\n    }\n    offsetY = farY - newY + ySeparation;\n    offsetX = workspace.RTL ? topX - newRightX : topX - newLeftX;\n    for (let i = 0; i < newBlockIds.length; i++) {\n      const block = workspace.getBlockById(newBlockIds[i]);\n      block!.moveBy(offsetX, offsetY);\n    }\n  }\n  return newBlockIds;\n}\n\n/**\n * Decode an XML block tag and create a block (and possibly sub blocks) on the\n * workspace.\n *\n * @param xmlBlock XML block element.\n * @param workspace The workspace.\n * @returns The root block created.\n * @alias Blockly.Xml.domToBlock\n */\nexport function domToBlock(xmlBlock: Element, workspace: Workspace): Block {\n  // Create top-level block.\n  eventUtils.disable();\n  const variablesBeforeCreation = workspace.getAllVariables();\n  let topBlock;\n  try {\n    topBlock = domToBlockHeadless(xmlBlock, workspace);\n    // Generate list of all blocks.\n    if (workspace.rendered) {\n      const topBlockSvg = topBlock as BlockSvg;\n      const blocks = topBlock.getDescendants(false);\n      topBlockSvg.setConnectionTracking(false);\n      // Render each block.\n      for (let i = blocks.length - 1; i >= 0; i--) {\n        (blocks[i] as BlockSvg).initSvg();\n      }\n      for (let i = blocks.length - 1; i >= 0; i--) {\n        (blocks[i] as BlockSvg).render(false);\n      }\n      // Populating the connection database may be deferred until after the\n      // blocks have rendered.\n      setTimeout(function() {\n        if (!topBlockSvg.disposed) {\n          topBlockSvg.setConnectionTracking(true);\n        }\n      }, 1);\n      topBlockSvg.updateDisabled();\n      // Allow the scrollbars to resize and move based on the new contents.\n      // TODO(@picklesrus): #387. Remove when domToBlock avoids resizing.\n      (workspace as WorkspaceSvg).resizeContents();\n    } else {\n      const blocks = topBlock.getDescendants(false);\n      for (let i = blocks.length - 1; i >= 0; i--) {\n        blocks[i].initModel();\n      }\n    }\n  } finally {\n    eventUtils.enable();\n  }\n  if (eventUtils.isEnabled()) {\n    // AnyDuringMigration because:  Property 'get' does not exist on type\n    // '(name: string) => void'.\n    const newVariables =\n        Variables.getAddedVariables(workspace, variablesBeforeCreation);\n    // Fire a VarCreate event for each (if any) new variable created.\n    for (let i = 0; i < newVariables.length; i++) {\n      const thisVariable = newVariables[i];\n      eventUtils.fire(\n          new (eventUtils.get(eventUtils.VAR_CREATE))(thisVariable));\n    }\n    // Block events come after var events, in case they refer to newly created\n    // variables.\n    eventUtils.fire(new (eventUtils.get(eventUtils.CREATE))(topBlock));\n  }\n  return topBlock;\n}\n\n/**\n * Decode an XML list of variables and add the variables to the workspace.\n *\n * @param xmlVariables List of XML variable elements.\n * @param workspace The workspace to which the variable should be added.\n * @alias Blockly.Xml.domToVariables\n */\nexport function domToVariables(xmlVariables: Element, workspace: Workspace) {\n  for (let i = 0; i < xmlVariables.children.length; i++) {\n    const xmlChild = xmlVariables.children[i];\n    const type = xmlChild.getAttribute('type');\n    const id = xmlChild.getAttribute('id');\n    const name = xmlChild.textContent;\n\n    // AnyDuringMigration because:  Argument of type 'string | null' is not\n    // assignable to parameter of type 'string'.\n    workspace.createVariable(name as AnyDuringMigration, type, id);\n  }\n}\n\n/** A mapping of nodeName to node for child nodes of xmlBlock. */\ninterface childNodeTagMap {\n  mutation: Element[];\n  comment: Element[];\n  data: Element[];\n  field: Element[];\n  input: Element[];\n  next: Element[];\n}\n\n/**\n * Creates a mapping of childNodes for each supported XML tag for the provided\n * xmlBlock. Logs a warning for any encountered unsupported tags.\n *\n * @param xmlBlock XML block element.\n * @returns The childNode map from nodeName to node.\n */\nfunction mapSupportedXmlTags(xmlBlock: Element): childNodeTagMap {\n  const childNodeMap = {\n    mutation: new Array<Element>(),\n    comment: new Array<Element>(),\n    data: new Array<Element>(),\n    field: new Array<Element>(),\n    input: new Array<Element>(),\n    next: new Array<Element>(),\n  };\n  for (let i = 0; i < xmlBlock.children.length; i++) {\n    const xmlChild = xmlBlock.children[i];\n    if (xmlChild.nodeType === dom.NodeType.TEXT_NODE) {\n      // Ignore any text at the <block> level.  It's all whitespace anyway.\n      continue;\n    }\n    switch (xmlChild.nodeName.toLowerCase()) {\n      case 'mutation':\n        childNodeMap.mutation.push(xmlChild);\n        break;\n      case 'comment':\n        childNodeMap.comment.push(xmlChild);\n        break;\n      case 'data':\n        childNodeMap.data.push(xmlChild);\n        break;\n      case 'title':\n      // Titles were renamed to field in December 2013.\n      // Fall through.\n      case 'field':\n        childNodeMap.field.push(xmlChild);\n        break;\n      case 'value':\n      case 'statement':\n        childNodeMap.input.push(xmlChild);\n        break;\n      case 'next':\n        childNodeMap.next.push(xmlChild);\n        break;\n      default:\n        // Unknown tag; ignore.  Same principle as HTML parsers.\n        console.warn('Ignoring unknown tag: ' + xmlChild.nodeName);\n    }\n  }\n  return childNodeMap;\n}\n\n/**\n * Applies mutation tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n * @returns True if mutation may have added some elements that need\n *     initialization (requiring initSvg call).\n */\nfunction applyMutationTagNodes(xmlChildren: Element[], block: Block): boolean {\n  let shouldCallInitSvg = false;\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    // Custom data for an advanced block.\n    if (block.domToMutation) {\n      block.domToMutation(xmlChild);\n      if ((block as BlockSvg).initSvg) {\n        // Mutation may have added some elements that need initializing.\n        shouldCallInitSvg = true;\n      }\n    }\n  }\n  return shouldCallInitSvg;\n}\n\n/**\n * Applies comment tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n */\nfunction applyCommentTagNodes(xmlChildren: Element[], block: Block) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const text = xmlChild.textContent;\n    const pinned = xmlChild.getAttribute('pinned') === 'true';\n    // AnyDuringMigration because:  Argument of type 'string | null' is not\n    // assignable to parameter of type 'string'.\n    const width =\n        parseInt(xmlChild.getAttribute('w') as AnyDuringMigration, 10);\n    // AnyDuringMigration because:  Argument of type 'string | null' is not\n    // assignable to parameter of type 'string'.\n    const height =\n        parseInt(xmlChild.getAttribute('h') as AnyDuringMigration, 10);\n\n    block.setCommentText(text);\n    block.commentModel.pinned = pinned;\n    if (!isNaN(width) && !isNaN(height)) {\n      block.commentModel.size = new Size(width, height);\n    }\n\n    if (pinned && (block as BlockSvg).getCommentIcon && !block.isInFlyout) {\n      const blockSvg = block as BlockSvg;\n      setTimeout(function() {\n        blockSvg.getCommentIcon()!.setVisible(true);\n      }, 1);\n    }\n  }\n}\n\n/**\n * Applies data tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n */\nfunction applyDataTagNodes(xmlChildren: Element[], block: Block) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    block.data = xmlChild.textContent;\n  }\n}\n\n/**\n * Applies field tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n */\nfunction applyFieldTagNodes(xmlChildren: Element[], block: Block) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const nodeName = xmlChild.getAttribute('name');\n    // AnyDuringMigration because:  Argument of type 'string | null' is not\n    // assignable to parameter of type 'string'.\n    domToField(block, nodeName as AnyDuringMigration, xmlChild);\n  }\n}\n\n/**\n * Finds any enclosed blocks or shadows within this XML node.\n *\n * @param xmlNode The XML node to extract child block info from.\n * @returns Any found child block.\n */\nfunction findChildBlocks(xmlNode: Element):\n    {childBlockElement: Element|null, childShadowElement: Element|null} {\n  const childBlockInfo = {childBlockElement: null, childShadowElement: null};\n  for (let i = 0; i < xmlNode.childNodes.length; i++) {\n    const xmlChild = xmlNode.childNodes[i];\n    if (xmlChild.nodeType === dom.NodeType.ELEMENT_NODE) {\n      if (xmlChild.nodeName.toLowerCase() === 'block') {\n        // AnyDuringMigration because:  Type 'Element' is not assignable to type\n        // 'null'.\n        childBlockInfo.childBlockElement =\n            xmlChild as Element as AnyDuringMigration;\n      } else if (xmlChild.nodeName.toLowerCase() === 'shadow') {\n        // AnyDuringMigration because:  Type 'Element' is not assignable to type\n        // 'null'.\n        childBlockInfo.childShadowElement =\n            xmlChild as Element as AnyDuringMigration;\n      }\n    }\n  }\n  return childBlockInfo;\n}\n/**\n * Applies input child nodes (value or statement) to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param workspace The workspace containing the given block.\n * @param block The block to apply the child nodes on.\n * @param prototypeName The prototype name of the block.\n */\nfunction applyInputTagNodes(\n    xmlChildren: Element[], workspace: Workspace, block: Block,\n    prototypeName: string) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const nodeName = xmlChild.getAttribute('name');\n    // AnyDuringMigration because:  Argument of type 'string | null' is not\n    // assignable to parameter of type 'string'.\n    const input = block.getInput(nodeName as AnyDuringMigration);\n    if (!input) {\n      console.warn(\n          'Ignoring non-existent input ' + nodeName + ' in block ' +\n          prototypeName);\n      break;\n    }\n    const childBlockInfo = findChildBlocks(xmlChild);\n    if (childBlockInfo.childBlockElement) {\n      if (!input.connection) {\n        throw TypeError('Input connection does not exist.');\n      }\n      domToBlockHeadless(\n          childBlockInfo.childBlockElement, workspace, input.connection, false);\n    }\n    // Set shadow after so we don't create a shadow we delete immediately.\n    if (childBlockInfo.childShadowElement) {\n      input.connection?.setShadowDom(childBlockInfo.childShadowElement);\n    }\n  }\n}\n\n/**\n * Applies next child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param workspace The workspace containing the given block.\n * @param block The block to apply the child nodes on.\n */\nfunction applyNextTagNodes(\n    xmlChildren: Element[], workspace: Workspace, block: Block) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const childBlockInfo = findChildBlocks(xmlChild);\n    if (childBlockInfo.childBlockElement) {\n      if (!block.nextConnection) {\n        throw TypeError('Next statement does not exist.');\n      }\n      // If there is more than one XML 'next' tag.\n      if (block.nextConnection.isConnected()) {\n        throw TypeError('Next statement is already connected.');\n      }\n      // Create child block.\n      domToBlockHeadless(\n          childBlockInfo.childBlockElement, workspace, block.nextConnection,\n          true);\n    }\n    // Set shadow after so we don't create a shadow we delete immediately.\n    if (childBlockInfo.childShadowElement && block.nextConnection) {\n      block.nextConnection.setShadowDom(childBlockInfo.childShadowElement);\n    }\n  }\n}\n\n/**\n * Decode an XML block tag and create a block (and possibly sub blocks) on the\n * workspace.\n *\n * @param xmlBlock XML block element.\n * @param workspace The workspace.\n * @param parentConnection The parent connection to to connect this block to\n *     after instantiating.\n * @param connectedToParentNext Whether the provided parent connection is a next\n *     connection, rather than output or statement.\n * @returns The root block created.\n */\nfunction domToBlockHeadless(\n    xmlBlock: Element, workspace: Workspace, parentConnection?: Connection,\n    connectedToParentNext?: boolean): Block {\n  let block = null;\n  const prototypeName = xmlBlock.getAttribute('type');\n  if (!prototypeName) {\n    throw TypeError('Block type unspecified: ' + xmlBlock.outerHTML);\n  }\n  const id = xmlBlock.getAttribute('id');\n  // AnyDuringMigration because:  Argument of type 'string | null' is not\n  // assignable to parameter of type 'string | undefined'.\n  block = workspace.newBlock(prototypeName, id as AnyDuringMigration);\n\n  // Preprocess childNodes so tags can be processed in a consistent order.\n  const xmlChildNameMap = mapSupportedXmlTags(xmlBlock);\n\n  const shouldCallInitSvg =\n      applyMutationTagNodes(xmlChildNameMap.mutation, block);\n  applyCommentTagNodes(xmlChildNameMap.comment, block);\n  applyDataTagNodes(xmlChildNameMap.data, block);\n\n  // Connect parent after processing mutation and before setting fields.\n  if (parentConnection) {\n    if (connectedToParentNext) {\n      if (block.previousConnection) {\n        parentConnection.connect(block.previousConnection);\n      } else {\n        throw TypeError('Next block does not have previous statement.');\n      }\n    } else {\n      if (block.outputConnection) {\n        parentConnection.connect(block.outputConnection);\n      } else if (block.previousConnection) {\n        parentConnection.connect(block.previousConnection);\n      } else {\n        throw TypeError(\n            'Child block does not have output or previous statement.');\n      }\n    }\n  }\n\n  applyFieldTagNodes(xmlChildNameMap.field, block);\n  applyInputTagNodes(xmlChildNameMap.input, workspace, block, prototypeName);\n  applyNextTagNodes(xmlChildNameMap.next, workspace, block);\n\n  if (shouldCallInitSvg) {\n    // This shouldn't even be called here\n    // (ref: https://github.com/google/blockly/pull/4296#issuecomment-884226021\n    // But the XML serializer/deserializer is iceboxed so I'm not going to fix\n    // it.\n    (block as BlockSvg).initSvg();\n  }\n\n  const inline = xmlBlock.getAttribute('inline');\n  if (inline) {\n    block.setInputsInline(inline === 'true');\n  }\n  const disabled = xmlBlock.getAttribute('disabled');\n  if (disabled) {\n    block.setEnabled(disabled !== 'true' && disabled !== 'disabled');\n  }\n  const deletable = xmlBlock.getAttribute('deletable');\n  if (deletable) {\n    block.setDeletable(deletable === 'true');\n  }\n  const movable = xmlBlock.getAttribute('movable');\n  if (movable) {\n    block.setMovable(movable === 'true');\n  }\n  const editable = xmlBlock.getAttribute('editable');\n  if (editable) {\n    block.setEditable(editable === 'true');\n  }\n  const collapsed = xmlBlock.getAttribute('collapsed');\n  if (collapsed) {\n    block.setCollapsed(collapsed === 'true');\n  }\n  if (xmlBlock.nodeName.toLowerCase() === 'shadow') {\n    // Ensure all children are also shadows.\n    const children = block.getChildren(false);\n    for (let i = 0; i < children.length; i++) {\n      const child = children[i];\n      if (!child.isShadow()) {\n        throw TypeError('Shadow block not allowed non-shadow child.');\n      }\n    }\n    // Ensure this block doesn't have any variable inputs.\n    if (block.getVarModels().length) {\n      throw TypeError('Shadow blocks cannot have variable references.');\n    }\n    block.setShadow(true);\n  }\n  return block;\n}\n\n/**\n * Decode an XML field tag and set the value of that field on the given block.\n *\n * @param block The block that is currently being deserialized.\n * @param fieldName The name of the field on the block.\n * @param xml The field tag to decode.\n */\nfunction domToField(block: Block, fieldName: string, xml: Element) {\n  const field = block.getField(fieldName);\n  if (!field) {\n    console.warn(\n        'Ignoring non-existent field ' + fieldName + ' in block ' + block.type);\n    return;\n  }\n  field.fromXml(xml);\n}\n\n/**\n * Remove any 'next' block (statements in a stack).\n *\n * @param xmlBlock XML block element or an empty DocumentFragment if the block\n *     was an insertion marker.\n * @alias Blockly.Xml.deleteNext\n */\nexport function deleteNext(xmlBlock: Element|DocumentFragment) {\n  for (let i = 0; i < xmlBlock.childNodes.length; i++) {\n    const child = xmlBlock.childNodes[i];\n    if (child.nodeName.toLowerCase() === 'next') {\n      xmlBlock.removeChild(child);\n      break;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Contains functions registering serializers (eg blocks, variables, plugins,\n * etc).\n *\n * @namespace Blockly.serialization.registry\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.serialization.registry');\n\n// eslint-disable-next-line no-unused-vars\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport * as registry from '../registry.js';\n\n\n/**\n * Registers the given serializer so that it can be used for serialization and\n * deserialization.\n *\n * @param name The name of the serializer to register.\n * @param serializer The serializer to register.\n * @alias Blockly.serialization.registry.register\n */\nexport function register(name: string, serializer: ISerializer) {\n  registry.register(registry.Type.SERIALIZER, name, serializer);\n}\n\n/**\n * Unregisters the serializer associated with the given name.\n *\n * @param name The name of the serializer to unregister.\n * @alias Blockly.serialization.registry.unregister\n */\nexport function unregister(name: string) {\n  registry.unregister(registry.Type.SERIALIZER, name);\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Handles serializing blocks to plain JavaScript objects only containing state.\n *\n * @namespace Blockly.serialization.blocks\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.serialization.blocks');\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport type {Connection} from '../connection.js';\nimport * as eventUtils from '../events/utils.js';\nimport {inputTypes} from '../input_types.js';\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport {Size} from '../utils/size.js';\nimport type {Workspace} from '../workspace.js';\nimport * as Xml from '../xml.js';\n\nimport {BadConnectionCheck, MissingBlockType, MissingConnection, RealChildOfShadow} from './exceptions.js';\nimport * as priorities from './priorities.js';\nimport * as serializationRegistry from './registry.js';\n\n\n// TODO(#5160): Remove this once lint is fixed.\n/* eslint-disable no-use-before-define */\n\n/**\n * Represents the state of a connection.\n *\n * @alias Blockly.serialization.blocks.ConnectionState\n */\nexport interface ConnectionState {\n  shadow: State|undefined;\n  block: State|undefined;\n}\n\n/**\n * Represents the state of a given block.\n *\n * @alias Blockly.serialization.blocks.State\n */\nexport interface State {\n  type: string;\n  id?: string;\n  x?: number;\n  y?: number;\n  collapsed?: boolean;\n  enabled?: boolean;\n  inline?: boolean;\n  data?: string;\n  extraState?: AnyDuringMigration;\n  icons?: {[key: string]: AnyDuringMigration};\n  fields?: {[key: string]: AnyDuringMigration};\n  inputs?: {[key: string]: ConnectionState};\n  next?: ConnectionState;\n}\n\n/**\n * Returns the state of the given block as a plain JavaScript object.\n *\n * @param block The block to serialize.\n * @param param1 addCoordinates: If true, the coordinates of the block are added\n *     to the serialized state. False by default. addinputBlocks: If true,\n *     children of the block which are connected to inputs will be serialized.\n *     True by default. addNextBlocks: If true, children of the block which are\n *     connected to the block's next connection (if it exists) will be\n *     serialized. True by default. doFullSerialization: If true, fields that\n *     normally just save a reference to some external state (eg variables) will\n *     instead serialize all of the info about that state. This supports\n *     deserializing the block into a workspace where that state doesn't yet\n *     exist. True by default.\n * @returns The serialized state of the block, or null if the block could not be\n *     serialied (eg it was an insertion marker).\n * @alias Blockly.serialization.blocks.save\n */\nexport function save(block: Block, {\n  addCoordinates = false,\n  addInputBlocks = true,\n  addNextBlocks = true,\n  doFullSerialization = true,\n}: {\n  addCoordinates?: boolean,\n  addInputBlocks?: boolean,\n  addNextBlocks?: boolean,\n  doFullSerialization?: boolean\n} = {}): State|null {\n  if (block.isInsertionMarker()) {\n    return null;\n  }\n\n  const state = {\n    'type': block.type,\n    'id': block.id,\n  };\n\n  if (addCoordinates) {\n    // AnyDuringMigration because:  Argument of type '{ type: string; id:\n    // string; }' is not assignable to parameter of type 'State'.\n    saveCoords(block, state as AnyDuringMigration);\n  }\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveAttributes(block, state as AnyDuringMigration);\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveExtraState(block, state as AnyDuringMigration);\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveIcons(block, state as AnyDuringMigration);\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveFields(block, state as AnyDuringMigration, doFullSerialization);\n  if (addInputBlocks) {\n    // AnyDuringMigration because:  Argument of type '{ type: string; id:\n    // string; }' is not assignable to parameter of type 'State'.\n    saveInputBlocks(block, state as AnyDuringMigration, doFullSerialization);\n  }\n  if (addNextBlocks) {\n    // AnyDuringMigration because:  Argument of type '{ type: string; id:\n    // string; }' is not assignable to parameter of type 'State'.\n    saveNextBlocks(block, state as AnyDuringMigration, doFullSerialization);\n  }\n\n  // AnyDuringMigration because:  Type '{ type: string; id: string; }' is not\n  // assignable to type 'State'.\n  return state as AnyDuringMigration;\n}\n\n/**\n * Adds attributes to the given state object based on the state of the block.\n * Eg collapsed, disabled, inline, etc.\n *\n * @param block The block to base the attributes on.\n * @param state The state object to append to.\n */\nfunction saveAttributes(block: Block, state: State) {\n  if (block.isCollapsed()) {\n    state['collapsed'] = true;\n  }\n  if (!block.isEnabled()) {\n    state['enabled'] = false;\n  }\n  if (block.inputsInline !== undefined &&\n      block.inputsInline !== block.inputsInlineDefault) {\n    state['inline'] = block.inputsInline;\n  }\n  // Data is a nullable string, so we don't need to worry about falsy values.\n  if (block.data) {\n    state['data'] = block.data;\n  }\n}\n\n/**\n * Adds the coordinates of the given block to the given state object.\n *\n * @param block The block to base the coordinates on.\n * @param state The state object to append to.\n */\nfunction saveCoords(block: Block, state: State) {\n  const workspace = block.workspace;\n  const xy = block.getRelativeToSurfaceXY();\n  state['x'] = Math.round(workspace.RTL ? workspace.getWidth() - xy.x : xy.x);\n  state['y'] = Math.round(xy.y);\n}\n/**\n * Adds any extra state the block may provide to the given state object.\n *\n * @param block The block to serialize the extra state of.\n * @param state The state object to append to.\n */\nfunction saveExtraState(block: Block, state: State) {\n  if (block.saveExtraState) {\n    const extraState = block.saveExtraState();\n    if (extraState !== null) {\n      state['extraState'] = extraState;\n    }\n  } else if (block.mutationToDom) {\n    const extraState = block.mutationToDom();\n    if (extraState !== null) {\n      state['extraState'] =\n          Xml.domToText(extraState)\n              .replace(\n                  ' xmlns=\"https://developers.google.com/blockly/xml\"', '');\n    }\n  }\n}\n\n/**\n * Adds the state of all of the icons on the block to the given state object.\n *\n * @param block The block to serialize the icon state of.\n * @param state The state object to append to.\n */\nfunction saveIcons(block: Block, state: State) {\n  // TODO(#2105): Remove this logic and put it in the icon.\n  if (block.getCommentText()) {\n    state['icons'] = {\n      'comment': {\n        'text': block.getCommentText(),\n        'pinned': block.commentModel.pinned,\n        'height': Math.round(block.commentModel.size.height),\n        'width': Math.round(block.commentModel.size.width),\n      },\n    };\n  }\n}\n\n/**\n * Adds the state of all of the fields on the block to the given state object.\n *\n * @param block The block to serialize the field state of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to serialize the full state of the\n *     field (rather than possibly saving a reference to some state).\n */\nfunction saveFields(block: Block, state: State, doFullSerialization: boolean) {\n  const fields = Object.create(null);\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    for (let j = 0; j < input.fieldRow.length; j++) {\n      const field = input.fieldRow[j];\n      if (field.isSerializable()) {\n        fields[field.name!] = field.saveState(doFullSerialization);\n      }\n    }\n  }\n  if (Object.keys(fields).length) {\n    state['fields'] = fields;\n  }\n}\n\n/**\n * Adds the state of all of the child blocks of the given block (which are\n * connected to inputs) to the given state object.\n *\n * @param block The block to serialize the input blocks of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to do full serialization.\n */\nfunction saveInputBlocks(\n    block: Block, state: State, doFullSerialization: boolean) {\n  const inputs = Object.create(null);\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    if (input.type === inputTypes.DUMMY) {\n      continue;\n    }\n    const connectionState =\n        saveConnection(input.connection as Connection, doFullSerialization);\n    if (connectionState) {\n      inputs[input.name] = connectionState;\n    }\n  }\n\n  if (Object.keys(inputs).length) {\n    state['inputs'] = inputs;\n  }\n}\n\n/**\n * Adds the state of all of the next blocks of the given block to the given\n * state object.\n *\n * @param block The block to serialize the next blocks of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to do full serialization.\n */\nfunction saveNextBlocks(\n    block: Block, state: State, doFullSerialization: boolean) {\n  if (!block.nextConnection) {\n    return;\n  }\n  const connectionState =\n      saveConnection(block.nextConnection, doFullSerialization);\n  if (connectionState) {\n    state['next'] = connectionState;\n  }\n}\n\n/**\n * Returns the state of the given connection (ie the state of any connected\n * shadow or real blocks).\n *\n * @param connection The connection to serialize the connected blocks of.\n * @returns An object containing the state of any connected shadow block, or any\n *     connected real block.\n * @param doFullSerialization Whether or not to do full serialization.\n */\nfunction saveConnection(connection: Connection, doFullSerialization: boolean):\n    ConnectionState|null {\n  const shadow = connection.getShadowState(true);\n  const child = connection.targetBlock();\n  if (!shadow && !child) {\n    return null;\n  }\n  const state = Object.create(null);\n  if (shadow) {\n    state['shadow'] = shadow;\n  }\n  if (child && !child.isShadow()) {\n    state['block'] = save(child, {doFullSerialization});\n  }\n  return state;\n}\n\n/**\n * Loads the block represented by the given state into the given workspace.\n *\n * @param state The state of a block to deserialize into the workspace.\n * @param workspace The workspace to add the block to.\n * @param param1 recordUndo: If true, events triggered by this function will be\n *     undo-able by the user. False by default.\n * @returns The block that was just loaded.\n * @alias Blockly.serialization.blocks.append\n */\nexport function append(\n    state: State, workspace: Workspace,\n    {recordUndo = false}: {recordUndo?: boolean} = {}): Block {\n  return appendInternal(state, workspace, {recordUndo});\n}\n\n/**\n * Loads the block represented by the given state into the given workspace.\n * This is defined internally so that the extra parameters don't clutter our\n * external API.\n * But it is exported so that other places within Blockly can call it directly\n * with the extra parameters.\n *\n * @param state The state of a block to deserialize into the workspace.\n * @param workspace The workspace to add the block to.\n * @param param1 parentConnection: If provided, the system will attempt to\n *     connect the block to this connection after it is created. Undefined by\n *     default. isShadow: If true, the block will be set to a shadow block after\n *     it is created. False by default. recordUndo: If true, events triggered by\n *     this function will be undo-able by the user. False by default.\n * @returns The block that was just appended.\n * @alias Blockly.serialization.blocks.appendInternal\n * @internal\n */\nexport function appendInternal(\n    state: State, workspace: Workspace,\n    {parentConnection = undefined, isShadow = false, recordUndo = false}: {\n      parentConnection?: Connection,\n      isShadow?: boolean,\n      recordUndo?: boolean\n    } = {}): Block {\n  const prevRecordUndo = eventUtils.getRecordUndo();\n  eventUtils.setRecordUndo(recordUndo);\n  const existingGroup = eventUtils.getGroup();\n  if (!existingGroup) {\n    eventUtils.setGroup(true);\n  }\n  eventUtils.disable();\n\n  const block = appendPrivate(state, workspace, {parentConnection, isShadow});\n\n  eventUtils.enable();\n  eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(block));\n  eventUtils.setGroup(existingGroup);\n  eventUtils.setRecordUndo(prevRecordUndo);\n\n  // Adding connections to the connection db is expensive. This defers that\n  // operation to decrease load time.\n  if (workspace.rendered) {\n    const blockSvg = block as BlockSvg;\n    setTimeout(() => {\n      if (!blockSvg.disposed) {\n        blockSvg.setConnectionTracking(true);\n      }\n    }, 1);\n  }\n\n  return block;\n}\n\n/**\n * Loads the block represented by the given state into the given workspace.\n * This is defined privately so that it can be called recursively without firing\n * eroneous events. Events (and other things we only want to occur on the top\n * block) are handled by appendInternal.\n *\n * @param state The state of a block to deserialize into the workspace.\n * @param workspace The workspace to add the block to.\n * @param param1 parentConnection: If provided, the system will attempt to\n *     connect the block to this connection after it is created. Undefined by\n *     default. isShadow: The block will be set to a shadow block after it is\n *     created. False by default.\n * @returns The block that was just appended.\n */\nfunction appendPrivate(\n    state: State, workspace: Workspace,\n    {parentConnection = undefined, isShadow = false}:\n        {parentConnection?: Connection, isShadow?: boolean} = {}): Block {\n  if (!state['type']) {\n    throw new MissingBlockType(state);\n  }\n\n  const block = workspace.newBlock(state['type'], state['id']);\n  block.setShadow(isShadow);\n  loadCoords(block, state);\n  loadAttributes(block, state);\n  loadExtraState(block, state);\n  tryToConnectParent(parentConnection, block, state);\n  loadIcons(block, state);\n  loadFields(block, state);\n  loadInputBlocks(block, state);\n  loadNextBlocks(block, state);\n  initBlock(block, workspace.rendered);\n\n  return block;\n}\n\n/**\n * Applies any coordinate information available on the state object to the\n * block.\n *\n * @param block The block to set the position of.\n * @param state The state object to reference.\n */\nfunction loadCoords(block: Block, state: State) {\n  let x = state['x'] === undefined ? 0 : state['x'];\n  const y = state['y'] === undefined ? 0 : state['y'];\n\n  const workspace = block.workspace;\n  x = workspace.RTL ? workspace.getWidth() - x : x;\n\n  block.moveBy(x, y);\n}\n\n/**\n * Applies any attribute information available on the state object to the block.\n *\n * @param block The block to set the attributes of.\n * @param state The state object to reference.\n */\nfunction loadAttributes(block: Block, state: State) {\n  if (state['collapsed']) {\n    block.setCollapsed(true);\n  }\n  if (state['enabled'] === false) {\n    block.setEnabled(false);\n  }\n  if (state['inline'] !== undefined) {\n    block.setInputsInline(state['inline']);\n  }\n  if (state['data'] !== undefined) {\n    block.data = state['data'];\n  }\n}\n\n/**\n * Applies any extra state information available on the state object to the\n * block.\n *\n * @param block The block to set the extra state of.\n * @param state The state object to reference.\n */\nfunction loadExtraState(block: Block, state: State) {\n  if (!state['extraState']) {\n    return;\n  }\n  if (block.loadExtraState) {\n    block.loadExtraState(state['extraState']);\n  } else if (block.domToMutation) {\n    block.domToMutation(Xml.textToDom(state['extraState']));\n  }\n}\n\n/**\n * Attempts to connect the block to the parent connection, if it exists.\n *\n * @param parentConnection The parent connection to try to connect the block to.\n * @param child The block to try to connect to the parent.\n * @param state The state which defines the given block\n */\nfunction tryToConnectParent(\n    parentConnection: Connection|undefined, child: Block, state: State) {\n  if (!parentConnection) {\n    return;\n  }\n\n  if (parentConnection.getSourceBlock().isShadow() && !child.isShadow()) {\n    throw new RealChildOfShadow(state);\n  }\n\n  let connected = false;\n  let childConnection;\n  if (parentConnection.type === inputTypes.VALUE) {\n    childConnection = child.outputConnection;\n    if (!childConnection) {\n      throw new MissingConnection('output', child, state);\n    }\n    connected = parentConnection.connect(childConnection);\n  } else {  // Statement type.\n    childConnection = child.previousConnection;\n    if (!childConnection) {\n      throw new MissingConnection('previous', child, state);\n    }\n    connected = parentConnection.connect(childConnection);\n  }\n\n  if (!connected) {\n    const checker = child.workspace.connectionChecker;\n    throw new BadConnectionCheck(\n        checker.getErrorMessage(\n            checker.canConnectWithReason(\n                childConnection, parentConnection, false),\n            childConnection, parentConnection),\n        parentConnection.type === inputTypes.VALUE ? 'output connection' :\n                                                     'previous connection',\n        child, state);\n  }\n}\n\n/**\n * Applies icon state to the icons on the block, based on the given state\n * object.\n *\n * @param block The block to set the icon state of.\n * @param state The state object to reference.\n */\nfunction loadIcons(block: Block, state: State) {\n  if (!state['icons']) {\n    return;\n  }\n  // TODO(#2105): Remove this logic and put it in the icon.\n  const comment = state['icons']['comment'];\n  if (comment) {\n    block.setCommentText(comment['text']);\n    // Load if saved. (Cleaned unnecessary attributes when in the trashcan.)\n    if ('pinned' in comment) {\n      block.commentModel.pinned = comment['pinned'];\n    }\n    if ('width' in comment && 'height' in comment) {\n      block.commentModel.size = new Size(comment['width'], comment['height']);\n    }\n    if (comment['pinned'] && block.rendered && !block.isInFlyout) {\n      // Give the block a chance to be positioned and rendered before showing.\n      const blockSvg = block as BlockSvg;\n      setTimeout(() => blockSvg.getCommentIcon()!.setVisible(true), 1);\n    }\n  }\n}\n\n/**\n * Applies any field information available on the state object to the block.\n *\n * @param block The block to set the field state of.\n * @param state The state object to reference.\n */\nfunction loadFields(block: Block, state: State) {\n  if (!state['fields']) {\n    return;\n  }\n  const keys = Object.keys(state['fields']);\n  for (let i = 0; i < keys.length; i++) {\n    const fieldName = keys[i];\n    const fieldState = state['fields'][fieldName];\n    const field = block.getField(fieldName);\n    if (!field) {\n      console.warn(\n          `Ignoring non-existant field ${fieldName} in block ${block.type}`);\n      continue;\n    }\n    field.loadState(fieldState);\n  }\n}\n\n/**\n * Creates any child blocks (attached to inputs) defined by the given state\n * and attaches them to the given block.\n *\n * @param block The block to attach input blocks to.\n * @param state The state object to reference.\n */\nfunction loadInputBlocks(block: Block, state: State) {\n  if (!state['inputs']) {\n    return;\n  }\n  const keys = Object.keys(state['inputs']);\n  for (let i = 0; i < keys.length; i++) {\n    const inputName = keys[i];\n    const input = block.getInput(inputName);\n    if (!input || !input.connection) {\n      throw new MissingConnection(inputName, block, state);\n    }\n    loadConnection(input.connection, state['inputs'][inputName]);\n  }\n}\n\n/**\n * Creates any next blocks defined by the given state and attaches them to the\n * given block.\n *\n * @param block The block to attach next blocks to.\n * @param state The state object to reference.\n */\nfunction loadNextBlocks(block: Block, state: State) {\n  if (!state['next']) {\n    return;\n  }\n  if (!block.nextConnection) {\n    throw new MissingConnection('next', block, state);\n  }\n  loadConnection(block.nextConnection, state['next']);\n}\n/**\n * Applies the state defined by connectionState to the given connection, ie\n * assigns shadows and attaches child blocks.\n *\n * @param connection The connection to deserialize the connected blocks of.\n * @param connectionState The object containing the state of any connected\n *     shadow block, or any connected real block.\n */\nfunction loadConnection(\n    connection: Connection, connectionState: ConnectionState) {\n  if (connectionState['shadow']) {\n    connection.setShadowState(connectionState['shadow']);\n  }\n  if (connectionState['block']) {\n    appendPrivate(\n        connectionState['block'], connection.getSourceBlock().workspace,\n        {parentConnection: connection});\n  }\n}\n\n// TODO(#5146): Remove this from the serialization system.\n/**\n * Initializes the give block, eg init the model, inits the svg, renders, etc.\n *\n * @param block The block to initialize.\n * @param rendered Whether the block is a rendered or headless block.\n */\nfunction initBlock(block: Block, rendered: boolean) {\n  if (rendered) {\n    const blockSvg = block as BlockSvg;\n    // Adding connections to the connection db is expensive. This defers that\n    // operation to decrease load time.\n    blockSvg.setConnectionTracking(false);\n\n    blockSvg.initSvg();\n    blockSvg.render(false);\n    // fixes #6076 JSO deserialization doesn't\n    // set .iconXY_ property so here it will be set\n    const icons = blockSvg.getIcons();\n    for (let i = 0; i < icons.length; i++) {\n      icons[i].computeIconLocation();\n    }\n  } else {\n    block.initModel();\n  }\n}\n\n// Alias to disambiguate saving within the serializer.\nconst saveBlock = save;\n\n/**\n * Serializer for saving and loading block state.\n *\n * @alias Blockly.serialization.blocks.BlockSerializer\n */\nclass BlockSerializer implements ISerializer {\n  priority: number;\n\n  /* eslint-disable-next-line require-jsdoc */\n  constructor() {\n    /** The priority for deserializing blocks. */\n    this.priority = priorities.BLOCKS;\n  }\n\n  /**\n   * Serializes the blocks of the given workspace.\n   *\n   * @param workspace The workspace to save the blocks of.\n   * @returns The state of the workspace's blocks, or null if there are no\n   *     blocks.\n   */\n  save(workspace: Workspace): {languageVersion: number, blocks: State[]}|null {\n    const blockStates = [];\n    for (const block of workspace.getTopBlocks(false)) {\n      const state =\n          saveBlock(block, {addCoordinates: true, doFullSerialization: false});\n      if (state) {\n        blockStates.push(state);\n      }\n    }\n    if (blockStates.length) {\n      return {\n        'languageVersion': 0,  // Currently unused.\n        'blocks': blockStates,\n      };\n    }\n    return null;\n  }\n\n  /**\n   * Deserializes the blocks defined by the given state into the given\n   * workspace.\n   *\n   * @param state The state of the blocks to deserialize.\n   * @param workspace The workspace to deserialize into.\n   */\n  load(\n      state: {languageVersion: number, blocks: State[]}, workspace: Workspace) {\n    const blockStates = state['blocks'];\n    for (const state of blockStates) {\n      append(state, workspace, {recordUndo: eventUtils.getRecordUndo()});\n    }\n  }\n\n  /**\n   * Disposes of any blocks that exist on the workspace.\n   *\n   * @param workspace The workspace to clear the blocks of.\n   */\n  clear(workspace: Workspace) {\n    // Cannot use workspace.clear() because that also removes variables.\n    for (const block of workspace.getTopBlocks(false)) {\n      block.dispose(false);\n    }\n  }\n}\n\nserializationRegistry.register('blocks', new BlockSerializer());\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Components for creating connections between blocks.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Connection');\n\nimport type {Block} from './block.js';\nimport {ConnectionType} from './connection_type.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Input} from './input.js';\nimport type {IASTNodeLocationWithBlock} from './interfaces/i_ast_node_location_with_block.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport * as blocks from './serialization/blocks.js';\nimport * as Xml from './xml.js';\n\n\n/**\n * Class for a connection between blocks.\n *\n * @alias Blockly.Connection\n */\nexport class Connection implements IASTNodeLocationWithBlock {\n  /** Constants for checking whether two connections are compatible. */\n  static CAN_CONNECT = 0;\n  static REASON_SELF_CONNECTION = 1;\n  static REASON_WRONG_TYPE = 2;\n  static REASON_TARGET_NULL = 3;\n  static REASON_CHECKS_FAILED = 4;\n  static REASON_DIFFERENT_WORKSPACES = 5;\n  static REASON_SHADOW_PARENT = 6;\n  static REASON_DRAG_CHECKS_FAILED = 7;\n  static REASON_PREVIOUS_AND_OUTPUT = 8;\n\n  protected sourceBlock_: Block;\n\n  /** Connection this connection connects to.  Null if not connected. */\n  targetConnection: Connection|null = null;\n\n  /**\n   * Has this connection been disposed of?\n   *\n   * @internal\n   */\n  disposed = false;\n\n  /** List of compatible value types.  Null if all types are compatible. */\n  private check_: string[]|null = null;\n\n  /** DOM representation of a shadow block, or null if none. */\n  private shadowDom_: Element|null = null;\n\n  /**\n   * Horizontal location of this connection.\n   *\n   * @internal\n   */\n  x = 0;\n\n  /**\n   * Vertical location of this connection.\n   *\n   * @internal\n   */\n  y = 0;\n\n  private shadowState_: blocks.State|null = null;\n\n  /**\n   * @param source The block establishing this connection.\n   * @param type The type of the connection.\n   */\n  constructor(source: Block, public type: number) {\n    this.sourceBlock_ = source;\n  }\n\n  /**\n   * Connect two connections together.  This is the connection on the superior\n   * block.\n   *\n   * @param childConnection Connection on inferior block.\n   */\n  protected connect_(childConnection: Connection) {\n    const INPUT = ConnectionType.INPUT_VALUE;\n    const parentBlock = this.getSourceBlock();\n    const childBlock = childConnection.getSourceBlock();\n\n    // Make sure the childConnection is available.\n    if (childConnection.isConnected()) {\n      childConnection.disconnect();\n    }\n\n    // Make sure the parentConnection is available.\n    let orphan;\n    if (this.isConnected()) {\n      const shadowState = this.stashShadowState_();\n      const target = this.targetBlock();\n      if (target!.isShadow()) {\n        target!.dispose(false);\n      } else {\n        this.disconnect();\n        orphan = target;\n      }\n      this.applyShadowState_(shadowState);\n    }\n\n    // Connect the new connection to the parent.\n    let event;\n    if (eventUtils.isEnabled()) {\n      event =\n          new (eventUtils.get(eventUtils.BLOCK_MOVE))(childBlock) as BlockMove;\n    }\n    connectReciprocally(this, childConnection);\n    childBlock.setParent(parentBlock);\n    if (event) {\n      event.recordNew();\n      eventUtils.fire(event);\n    }\n\n    // Deal with the orphan if it exists.\n    if (orphan) {\n      const orphanConnection = this.type === INPUT ? orphan.outputConnection :\n                                                     orphan.previousConnection;\n      const connection = Connection.getConnectionForOrphanedConnection(\n          childBlock, (orphanConnection));\n      if (connection) {\n        orphanConnection.connect(connection);\n      } else {\n        orphanConnection.onFailedConnect(this);\n      }\n    }\n  }\n\n  /**\n   * Dispose of this connection and deal with connected blocks.\n   *\n   * @internal\n   */\n  dispose() {\n    // isConnected returns true for shadows and non-shadows.\n    if (this.isConnected()) {\n      // Destroy the attached shadow block & its children (if it exists).\n      this.setShadowStateInternal_();\n\n      const targetBlock = this.targetBlock();\n      if (targetBlock) {\n        // Disconnect the attached normal block.\n        targetBlock.unplug();\n      }\n    }\n\n    this.disposed = true;\n  }\n\n  /**\n   * Get the source block for this connection.\n   *\n   * @returns The source block.\n   */\n  getSourceBlock(): Block {\n    return this.sourceBlock_;\n  }\n\n  /**\n   * Does the connection belong to a superior block (higher in the source\n   * stack)?\n   *\n   * @returns True if connection faces down or right.\n   */\n  isSuperior(): boolean {\n    return this.type === ConnectionType.INPUT_VALUE ||\n        this.type === ConnectionType.NEXT_STATEMENT;\n  }\n\n  /**\n   * Is the connection connected?\n   *\n   * @returns True if connection is connected to another connection.\n   */\n  isConnected(): boolean {\n    return !!this.targetConnection;\n  }\n\n  /**\n   * Get the workspace's connection type checker object.\n   *\n   * @returns The connection type checker for the source block's workspace.\n   * @internal\n   */\n  getConnectionChecker(): IConnectionChecker {\n    return this.sourceBlock_.workspace.connectionChecker;\n  }\n\n  /**\n   * Called when an attempted connection fails. NOP by default (i.e. for\n   * headless workspaces).\n   *\n   * @param _otherConnection Connection that this connection failed to connect\n   *     to.\n   * @internal\n   */\n  onFailedConnect(_otherConnection: Connection) {}\n  // NOP\n\n  /**\n   * Connect this connection to another connection.\n   *\n   * @param otherConnection Connection to connect to.\n   * @returns Whether the the blocks are now connected or not.\n   */\n  connect(otherConnection: Connection): boolean {\n    if (this.targetConnection === otherConnection) {\n      // Already connected together.  NOP.\n      return true;\n    }\n\n    const checker = this.getConnectionChecker();\n    if (checker.canConnect(this, otherConnection, false)) {\n      const eventGroup = eventUtils.getGroup();\n      if (!eventGroup) {\n        eventUtils.setGroup(true);\n      }\n      // Determine which block is superior (higher in the source stack).\n      if (this.isSuperior()) {\n        // Superior block.\n        this.connect_(otherConnection);\n      } else {\n        // Inferior block.\n        otherConnection.connect_(this);\n      }\n      if (!eventGroup) {\n        eventUtils.setGroup(false);\n      }\n    }\n\n    return this.isConnected();\n  }\n\n  /** Disconnect this connection. */\n  disconnect() {\n    const otherConnection = this.targetConnection;\n    if (!otherConnection) {\n      throw Error('Source connection not connected.');\n    }\n    if (otherConnection.targetConnection !== this) {\n      throw Error('Target connection not connected to source connection.');\n    }\n    let parentBlock;\n    let childBlock;\n    let parentConnection;\n    if (this.isSuperior()) {\n      // Superior block.\n      parentBlock = this.sourceBlock_;\n      childBlock = otherConnection.getSourceBlock();\n      /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n      parentConnection = this;\n    } else {\n      // Inferior block.\n      parentBlock = otherConnection.getSourceBlock();\n      childBlock = this.sourceBlock_;\n      parentConnection = otherConnection;\n    }\n\n    const eventGroup = eventUtils.getGroup();\n    if (!eventGroup) {\n      eventUtils.setGroup(true);\n    }\n    this.disconnectInternal_(parentBlock, childBlock);\n    if (!childBlock.isShadow()) {\n      // If we were disconnecting a shadow, no need to spawn a new one.\n      parentConnection.respawnShadow_();\n    }\n    if (!eventGroup) {\n      eventUtils.setGroup(false);\n    }\n  }\n\n  /**\n   * Disconnect two blocks that are connected by this connection.\n   *\n   * @param parentBlock The superior block.\n   * @param childBlock The inferior block.\n   */\n  protected disconnectInternal_(parentBlock: Block, childBlock: Block) {\n    let event;\n    if (eventUtils.isEnabled()) {\n      event =\n          new (eventUtils.get(eventUtils.BLOCK_MOVE))(childBlock) as BlockMove;\n    }\n    const otherConnection = this.targetConnection;\n    if (otherConnection) {\n      otherConnection.targetConnection = null;\n    }\n    this.targetConnection = null;\n    childBlock.setParent(null);\n    if (event) {\n      event.recordNew();\n      eventUtils.fire(event);\n    }\n  }\n\n  /**\n   * Respawn the shadow block if there was one connected to the this connection.\n   */\n  protected respawnShadow_() {\n    // Have to keep respawnShadow_ for backwards compatibility.\n    this.createShadowBlock_(true);\n  }\n\n  /**\n   * Returns the block that this connection connects to.\n   *\n   * @returns The connected block or null if none is connected.\n   */\n  targetBlock(): Block|null {\n    if (this.isConnected()) {\n      return this.targetConnection?.getSourceBlock() ?? null;\n    }\n    return null;\n  }\n\n  /**\n   * Function to be called when this connection's compatible types have changed.\n   */\n  protected onCheckChanged_() {\n    // The new value type may not be compatible with the existing connection.\n    if (this.isConnected() &&\n        (!this.targetConnection ||\n         !this.getConnectionChecker().canConnect(\n             this, this.targetConnection, false))) {\n      const child = this.isSuperior() ? this.targetBlock() : this.sourceBlock_;\n      child!.unplug();\n    }\n  }\n\n  /**\n   * Change a connection's compatibility.\n   *\n   * @param check Compatible value type or list of value types. Null if all\n   *     types are compatible.\n   * @returns The connection being modified (to allow chaining).\n   */\n  setCheck(check: string|string[]|null): Connection {\n    if (check) {\n      if (!Array.isArray(check)) {\n        check = [check];\n      }\n      this.check_ = check;\n      this.onCheckChanged_();\n    } else {\n      this.check_ = null;\n    }\n    return this;\n  }\n\n  /**\n   * Get a connection's compatibility.\n   *\n   * @returns List of compatible value types.\n   *     Null if all types are compatible.\n   */\n  getCheck(): string[]|null {\n    return this.check_;\n  }\n\n  /**\n   * Changes the connection's shadow block.\n   *\n   * @param shadowDom DOM representation of a block or null.\n   */\n  setShadowDom(shadowDom: Element|null) {\n    this.setShadowStateInternal_({shadowDom});\n  }\n\n  /**\n   * Returns the xml representation of the connection's shadow block.\n   *\n   * @param returnCurrent If true, and the shadow block is currently attached to\n   *     this connection, this serializes the state of that block and returns it\n   *     (so that field values are correct). Otherwise the saved shadowDom is\n   *     just returned.\n   * @returns Shadow DOM representation of a block or null.\n   */\n  getShadowDom(returnCurrent?: boolean): Element|null {\n    return returnCurrent && this.targetBlock()!.isShadow() ?\n        Xml.blockToDom((this.targetBlock() as Block)) as Element :\n        this.shadowDom_;\n  }\n\n  /**\n   * Changes the connection's shadow block.\n   *\n   * @param shadowState An state represetation of the block or null.\n   */\n  setShadowState(shadowState: blocks.State|null) {\n    this.setShadowStateInternal_({shadowState});\n  }\n\n  /**\n   * Returns the serialized object representation of the connection's shadow\n   * block.\n   *\n   * @param returnCurrent If true, and the shadow block is currently attached to\n   *     this connection, this serializes the state of that block and returns it\n   *     (so that field values are correct). Otherwise the saved state is just\n   *     returned.\n   * @returns Serialized object representation of the block, or null.\n   */\n  getShadowState(returnCurrent?: boolean): blocks.State|null {\n    if (returnCurrent && this.targetBlock() && this.targetBlock()!.isShadow()) {\n      return blocks.save(this.targetBlock() as Block);\n    }\n    return this.shadowState_;\n  }\n\n  /**\n   * Find all nearby compatible connections to this connection.\n   * Type checking does not apply, since this function is used for bumping.\n   *\n   * Headless configurations (the default) do not have neighboring connection,\n   * and always return an empty list (the default).\n   * {@link RenderedConnection#neighbours} overrides this behavior with a list\n   * computed from the rendered positioning.\n   *\n   * @param _maxLimit The maximum radius to another connection.\n   * @returns List of connections.\n   * @internal\n   */\n  neighbours(_maxLimit: number): Connection[] {\n    return [];\n  }\n\n  /**\n   * Get the parent input of a connection.\n   *\n   * @returns The input that the connection belongs to or null if no parent\n   *     exists.\n   * @internal\n   */\n  getParentInput(): Input|null {\n    let parentInput = null;\n    const inputs = this.sourceBlock_.inputList;\n    for (let i = 0; i < inputs.length; i++) {\n      if (inputs[i].connection === this) {\n        parentInput = inputs[i];\n        break;\n      }\n    }\n    return parentInput;\n  }\n\n  /**\n   * This method returns a string describing this Connection in developer terms\n   * (English only). Intended to on be used in console logs and errors.\n   *\n   * @returns The description.\n   */\n  toString(): string {\n    const block = this.sourceBlock_;\n    if (!block) {\n      return 'Orphan Connection';\n    }\n    let msg;\n    if (block.outputConnection === this) {\n      msg = 'Output Connection of ';\n    } else if (block.previousConnection === this) {\n      msg = 'Previous Connection of ';\n    } else if (block.nextConnection === this) {\n      msg = 'Next Connection of ';\n    } else {\n      let parentInput = null;\n      for (let i = 0, input; input = block.inputList[i]; i++) {\n        if (input.connection === this) {\n          parentInput = input;\n          break;\n        }\n      }\n      if (parentInput) {\n        msg = 'Input \"' + parentInput.name + '\" connection on ';\n      } else {\n        console.warn('Connection not actually connected to sourceBlock_');\n        return 'Orphan Connection';\n      }\n    }\n    return msg + block.toDevString();\n  }\n\n  /**\n   * Returns the state of the shadowDom_ and shadowState_ properties, then\n   * temporarily sets those properties to null so no shadow respawns.\n   *\n   * @returns The state of both the shadowDom_ and shadowState_ properties.\n   */\n  private stashShadowState_():\n      {shadowDom: Element|null, shadowState: blocks.State|null} {\n    const shadowDom = this.getShadowDom(true);\n    const shadowState = this.getShadowState(true);\n    // Set to null so it doesn't respawn.\n    this.shadowDom_ = null;\n    this.shadowState_ = null;\n    return {shadowDom, shadowState};\n  }\n\n  /**\n   * Reapplies the stashed state of the shadowDom_ and shadowState_ properties.\n   *\n   * @param param0 The state to reapply to the shadowDom_ and shadowState_\n   *     properties.\n   */\n  private applyShadowState_({shadowDom, shadowState}: {\n    shadowDom: Element|null,\n    shadowState: blocks.State|null\n  }) {\n    this.shadowDom_ = shadowDom;\n    this.shadowState_ = shadowState;\n  }\n\n  /**\n   * Sets the state of the shadow of this connection.\n   *\n   * @param param0 The state to set the shadow of this connection to.\n   */\n  private setShadowStateInternal_({shadowDom = null, shadowState = null}: {\n    shadowDom?: Element|null,\n    shadowState?: blocks.State|null\n  } = {}) {\n    // One or both of these should always be null.\n    // If neither is null, the shadowState will get priority.\n    this.shadowDom_ = shadowDom;\n    this.shadowState_ = shadowState;\n\n    const target = this.targetBlock();\n    if (!target) {\n      this.respawnShadow_();\n      if (this.targetBlock() && this.targetBlock()!.isShadow()) {\n        this.serializeShadow_(this.targetBlock());\n      }\n    } else if (target.isShadow()) {\n      target.dispose(false);\n      this.respawnShadow_();\n      if (this.targetBlock() && this.targetBlock()!.isShadow()) {\n        this.serializeShadow_(this.targetBlock());\n      }\n    } else {\n      const shadow = this.createShadowBlock_(false);\n      this.serializeShadow_(shadow);\n      if (shadow) {\n        shadow.dispose(false);\n      }\n    }\n  }\n\n  /**\n   * Creates a shadow block based on the current shadowState_ or shadowDom_.\n   * shadowState_ gets priority.\n   *\n   * @param attemptToConnect Whether to try to connect the shadow block to this\n   *     connection or not.\n   * @returns The shadow block that was created, or null if both the\n   *     shadowState_ and shadowDom_ are null.\n   */\n  private createShadowBlock_(attemptToConnect: boolean): Block|null {\n    const parentBlock = this.getSourceBlock();\n    const shadowState = this.getShadowState();\n    const shadowDom = this.getShadowDom();\n    if (parentBlock.disposed || !shadowState && !shadowDom) {\n      return null;\n    }\n\n    let blockShadow;\n    if (shadowState) {\n      blockShadow = blocks.appendInternal(shadowState, parentBlock.workspace, {\n        parentConnection: attemptToConnect ? this : undefined,\n        isShadow: true,\n        recordUndo: false,\n      });\n      return blockShadow;\n    }\n\n    if (shadowDom) {\n      blockShadow = Xml.domToBlock(shadowDom, parentBlock.workspace);\n      if (attemptToConnect) {\n        if (this.type === ConnectionType.INPUT_VALUE) {\n          if (!blockShadow.outputConnection) {\n            throw new Error('Shadow block is missing an output connection');\n          }\n          if (!this.connect(blockShadow.outputConnection)) {\n            throw new Error('Could not connect shadow block to connection');\n          }\n        } else if (this.type === ConnectionType.NEXT_STATEMENT) {\n          if (!blockShadow.previousConnection) {\n            throw new Error('Shadow block is missing previous connection');\n          }\n          if (!this.connect(blockShadow.previousConnection)) {\n            throw new Error('Could not connect shadow block to connection');\n          }\n        } else {\n          throw new Error(\n              'Cannot connect a shadow block to a previous/output connection');\n        }\n      }\n      return blockShadow;\n    }\n    return null;\n  }\n\n  /**\n   * Saves the given shadow block to both the shadowDom_ and shadowState_\n   * properties, in their respective serialized forms.\n   *\n   * @param shadow The shadow to serialize, or null.\n   */\n  private serializeShadow_(shadow: Block|null) {\n    if (!shadow) {\n      return;\n    }\n    this.shadowDom_ = Xml.blockToDom(shadow) as Element;\n    this.shadowState_ = blocks.save(shadow);\n  }\n\n  /**\n   * Returns the connection (starting at the startBlock) which will accept\n   * the given connection. This includes compatible connection types and\n   * connection checks.\n   *\n   * @param startBlock The block on which to start the search.\n   * @param orphanConnection The connection that is looking for a home.\n   * @returns The suitable connection point on the chain of blocks, or null.\n   */\n  static getConnectionForOrphanedConnection(\n      startBlock: Block, orphanConnection: Connection): Connection|null {\n    if (orphanConnection.type === ConnectionType.OUTPUT_VALUE) {\n      return getConnectionForOrphanedOutput(\n          startBlock, orphanConnection.getSourceBlock());\n    }\n    // Otherwise we're dealing with a stack.\n    const connection = startBlock.lastConnectionInStack(true);\n    const checker = orphanConnection.getConnectionChecker();\n    if (connection && checker.canConnect(orphanConnection, connection, false)) {\n      return connection;\n    }\n    return null;\n  }\n}\n\n/**\n * Update two connections to target each other.\n *\n * @param first The first connection to update.\n * @param second The second connection to update.\n */\nfunction connectReciprocally(first: Connection, second: Connection) {\n  if (!first || !second) {\n    throw Error('Cannot connect null connections.');\n  }\n  first.targetConnection = second;\n  second.targetConnection = first;\n}\n/**\n * Returns the single connection on the block that will accept the orphaned\n * block, if one can be found. If the block has multiple compatible connections\n * (even if they are filled) this returns null. If the block has no compatible\n * connections, this returns null.\n *\n * @param block The superior block.\n * @param orphanBlock The inferior block.\n * @returns The suitable connection point on 'block', or null.\n */\nfunction getSingleConnection(block: Block, orphanBlock: Block): Connection|\n    null {\n  let foundConnection = null;\n  const output = orphanBlock.outputConnection;\n  const typeChecker = output.getConnectionChecker();\n\n  for (let i = 0, input; input = block.inputList[i]; i++) {\n    const connection = input.connection;\n    if (connection && typeChecker.canConnect(output, connection, false)) {\n      if (foundConnection) {\n        return null;  // More than one connection.\n      }\n      foundConnection = connection;\n    }\n  }\n  return foundConnection;\n}\n\n/**\n * Walks down a row a blocks, at each stage checking if there are any\n * connections that will accept the orphaned block.  If at any point there\n * are zero or multiple eligible connections, returns null.  Otherwise\n * returns the only input on the last block in the chain.\n * Terminates early for shadow blocks.\n *\n * @param startBlock The block on which to start the search.\n * @param orphanBlock The block that is looking for a home.\n * @returns The suitable connection point on the chain of blocks, or null.\n */\nfunction getConnectionForOrphanedOutput(\n    startBlock: Block, orphanBlock: Block): Connection|null {\n  let newBlock: Block|null = startBlock;\n  let connection;\n  while (connection = getSingleConnection(newBlock, orphanBlock)) {\n    newBlock = connection.targetBlock();\n    if (!newBlock || newBlock.isShadow()) {\n      return connection;\n    }\n  }\n  return null;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for math.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @namespace Blockly.utils.math\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.math');\n\n\n/**\n * Converts degrees to radians.\n * Copied from Closure's goog.math.toRadians.\n *\n * @param angleDegrees Angle in degrees.\n * @returns Angle in radians.\n * @alias Blockly.utils.math.toRadians\n */\nexport function toRadians(angleDegrees: number): number {\n  return angleDegrees * Math.PI / 180;\n}\n\n/**\n * Converts radians to degrees.\n * Copied from Closure's goog.math.toDegrees.\n *\n * @param angleRadians Angle in radians.\n * @returns Angle in degrees.\n * @alias Blockly.utils.math.toDegrees\n */\nexport function toDegrees(angleRadians: number): number {\n  return angleRadians * 180 / Math.PI;\n}\n\n/**\n * Clamp the provided number between the lower bound and the upper bound.\n *\n * @param lowerBound The desired lower bound.\n * @param number The number to clamp.\n * @param upperBound The desired upper bound.\n * @returns The clamped number.\n * @alias Blockly.utils.math.clamp\n */\nexport function clamp(\n    lowerBound: number, number: number, upperBound: number): number {\n  if (upperBound < lowerBound) {\n    const temp = upperBound;\n    upperBound = lowerBound;\n    lowerBound = temp;\n  }\n  return Math.max(lowerBound, Math.min(number, upperBound));\n}\n","/**\n * @license\n * Copyright 2016 Massachusetts Institute of Technology\n * All rights reserved.\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A div that floats on top of the workspace, for drop-down menus.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.dropDownDiv');\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as common from './common.js';\nimport type {Field} from './field.js';\nimport * as dom from './utils/dom.js';\nimport * as math from './utils/math.js';\nimport {Rect} from './utils/rect.js';\nimport type {Size} from './utils/size.js';\nimport * as style from './utils/style.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Arrow size in px. Should match the value in CSS\n * (need to position pre-render).\n */\nexport const ARROW_SIZE = 16;\n\n/**\n * Drop-down border size in px. Should match the value in CSS (need to position\n * the arrow).\n */\nexport const BORDER_SIZE = 1;\n\n/**\n * Amount the arrow must be kept away from the edges of the main drop-down div,\n * in px.\n */\nexport const ARROW_HORIZONTAL_PADDING = 12;\n\n/** Amount drop-downs should be padded away from the source, in px. */\nexport const PADDING_Y = 16;\n\n/** Length of animations in seconds. */\nexport const ANIMATION_TIME = 0.25;\n\n/**\n * Timer for animation out, to be cleared if we need to immediately hide\n * without disrupting new shows.\n */\nlet animateOutTimer: ReturnType<typeof setTimeout>|null = null;\n\n/** Callback for when the drop-down is hidden. */\nlet onHide: Function|null = null;\n\n/** A class name representing the current owner's workspace renderer. */\nlet renderedClassName = '';\n\n/** A class name representing the current owner's workspace theme. */\nlet themeClassName = '';\n\n/** The content element. */\nlet div: HTMLDivElement;\n\n/** The content element. */\nlet content: HTMLDivElement;\n\n/** The arrow element. */\nlet arrow: HTMLDivElement;\n\n/**\n * Drop-downs will appear within the bounds of this element if possible.\n * Set in setBoundsElement.\n */\nlet boundsElement: Element|null = null;\n\n/** The object currently using the drop-down. */\nlet owner: Field|null = null;\n\n/** Whether the dropdown was positioned to a field or the source block. */\nlet positionToField: boolean|null = null;\n\n/**\n * Dropdown bounds info object used to encapsulate sizing information about a\n * bounding element (bounding box and width/height).\n */\nexport interface BoundsInfo {\n  top: number;\n  left: number;\n  bottom: number;\n  right: number;\n  width: number;\n  height: number;\n}\n\n/** Dropdown position metrics. */\nexport interface PositionMetrics {\n  initialX: number;\n  initialY: number;\n  finalX: number;\n  finalY: number;\n  arrowX: number|null;\n  arrowY: number|null;\n  arrowAtTop: boolean|null;\n  arrowVisible: boolean;\n}\n\n/**\n * Create and insert the DOM element for this div.\n *\n * @internal\n */\nexport function createDom() {\n  if (div) {\n    return;  // Already created.\n  }\n  div = document.createElement('div');\n  div.className = 'blocklyDropDownDiv';\n  const parentDiv = common.getParentContainer() || document.body;\n  parentDiv.appendChild(div);\n\n  content = document.createElement('div');\n  content.className = 'blocklyDropDownContent';\n  div.appendChild(content);\n\n  arrow = document.createElement('div');\n  arrow.className = 'blocklyDropDownArrow';\n  div.appendChild(arrow);\n\n  div.style.opacity = '0';\n  // Transition animation for transform: translate() and opacity.\n  div.style.transition = 'transform ' + ANIMATION_TIME + 's, ' +\n      'opacity ' + ANIMATION_TIME + 's';\n\n  // Handle focusin/out events to add a visual indicator when\n  // a child is focused or blurred.\n  div.addEventListener('focusin', function() {\n    dom.addClass(div, 'blocklyFocused');\n  });\n  div.addEventListener('focusout', function() {\n    dom.removeClass(div, 'blocklyFocused');\n  });\n}\n\n/**\n * Set an element to maintain bounds within. Drop-downs will appear\n * within the box of this element if possible.\n *\n * @param boundsElem Element to bind drop-down to.\n */\nexport function setBoundsElement(boundsElem: Element|null) {\n  boundsElement = boundsElem;\n}\n\n/**\n * Provide the div for inserting content into the drop-down.\n *\n * @returns Div to populate with content.\n */\nexport function getContentDiv(): Element {\n  return content;\n}\n\n/** Clear the content of the drop-down. */\nexport function clearContent() {\n  content.textContent = '';\n  content.style.width = '';\n}\n\n/**\n * Set the colour for the drop-down.\n *\n * @param backgroundColour Any CSS colour for the background.\n * @param borderColour Any CSS colour for the border.\n */\nexport function setColour(backgroundColour: string, borderColour: string) {\n  div.style.backgroundColor = backgroundColour;\n  div.style.borderColor = borderColour;\n}\n\n/**\n * Shortcut to show and place the drop-down with positioning determined\n * by a particular block. The primary position will be below the block,\n * and the secondary position above the block. Drop-down will be\n * constrained to the block's workspace.\n *\n * @param field The field showing the drop-down.\n * @param block Block to position the drop-down around.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @param opt_secondaryYOffset Optional Y offset for above-block positioning.\n * @returns True if the menu rendered below block; false if above.\n */\nexport function showPositionedByBlock(\n    field: Field, block: BlockSvg, opt_onHide?: Function,\n    opt_secondaryYOffset?: number): boolean {\n  return showPositionedByRect(\n      getScaledBboxOfBlock(block), field, opt_onHide, opt_secondaryYOffset);\n}\n\n/**\n * Shortcut to show and place the drop-down with positioning determined\n * by a particular field. The primary position will be below the field,\n * and the secondary position above the field. Drop-down will be\n * constrained to the block's workspace.\n *\n * @param field The field to position the dropdown against.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @param opt_secondaryYOffset Optional Y offset for above-block positioning.\n * @returns True if the menu rendered below block; false if above.\n */\nexport function showPositionedByField(\n    field: Field, opt_onHide?: Function,\n    opt_secondaryYOffset?: number): boolean {\n  positionToField = true;\n  return showPositionedByRect(\n      getScaledBboxOfField(field), field, opt_onHide, opt_secondaryYOffset);\n}\n/**\n * Get the scaled bounding box of a block.\n *\n * @param block The block.\n * @returns The scaled bounding box of the block.\n */\nfunction getScaledBboxOfBlock(block: BlockSvg): Rect {\n  const blockSvg = block.getSvgRoot();\n  const scale = block.workspace.scale;\n  const scaledHeight = block.height * scale;\n  const scaledWidth = block.width * scale;\n  const xy = style.getPageOffset(blockSvg);\n  return new Rect(xy.y, xy.y + scaledHeight, xy.x, xy.x + scaledWidth);\n}\n\n/**\n * Get the scaled bounding box of a field.\n *\n * @param field The field.\n * @returns The scaled bounding box of the field.\n */\nfunction getScaledBboxOfField(field: Field): Rect {\n  const bBox = field.getScaledBBox();\n  return new Rect(bBox.top, bBox.bottom, bBox.left, bBox.right);\n}\n\n/**\n * Helper method to show and place the drop-down with positioning determined\n * by a scaled bounding box.  The primary position will be below the rect,\n * and the secondary position above the rect. Drop-down will be constrained to\n * the block's workspace.\n *\n * @param bBox The scaled bounding box.\n * @param field The field to position the dropdown against.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @param opt_secondaryYOffset Optional Y offset for above-block positioning.\n * @returns True if the menu rendered below block; false if above.\n */\nfunction showPositionedByRect(\n    bBox: Rect, field: Field, opt_onHide?: Function,\n    opt_secondaryYOffset?: number): boolean {\n  // If we can fit it, render below the block.\n  const primaryX = bBox.left + (bBox.right - bBox.left) / 2;\n  const primaryY = bBox.bottom;\n  // If we can't fit it, render above the entire parent block.\n  const secondaryX = primaryX;\n  let secondaryY = bBox.top;\n  if (opt_secondaryYOffset) {\n    secondaryY += opt_secondaryYOffset;\n  }\n  const sourceBlock = field.getSourceBlock() as BlockSvg;\n  // Set bounds to main workspace; show the drop-down.\n  let workspace = sourceBlock.workspace;\n  while (workspace.options.parentWorkspace) {\n    workspace = workspace.options.parentWorkspace;\n  }\n  setBoundsElement(workspace.getParentSvg().parentNode as Element | null);\n  return show(\n      field, sourceBlock.RTL, primaryX, primaryY, secondaryX, secondaryY,\n      opt_onHide);\n}\n\n/**\n * Show and place the drop-down.\n * The drop-down is placed with an absolute \"origin point\" (x, y) - i.e.,\n * the arrow will point at this origin and box will positioned below or above\n * it.  If we can maintain the container bounds at the primary point, the arrow\n * will point there, and the container will be positioned below it.\n * If we can't maintain the container bounds at the primary point, fall-back to\n * the secondary point and position above.\n *\n * @param newOwner The object showing the drop-down\n * @param rtl Right-to-left (true) or left-to-right (false).\n * @param primaryX Desired origin point x, in absolute px.\n * @param primaryY Desired origin point y, in absolute px.\n * @param secondaryX Secondary/alternative origin point x, in absolute px.\n * @param secondaryY Secondary/alternative origin point y, in absolute px.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @returns True if the menu rendered at the primary origin point.\n * @internal\n */\nexport function show(\n    newOwner: Field, rtl: boolean, primaryX: number, primaryY: number,\n    secondaryX: number, secondaryY: number, opt_onHide?: Function): boolean {\n  owner = newOwner;\n  onHide = opt_onHide || null;\n  // Set direction.\n  div.style.direction = rtl ? 'rtl' : 'ltr';\n\n  const mainWorkspace = common.getMainWorkspace() as WorkspaceSvg;\n  renderedClassName = mainWorkspace.getRenderer().getClassName();\n  themeClassName = mainWorkspace.getTheme().getClassName();\n  dom.addClass(div, renderedClassName);\n  dom.addClass(div, themeClassName);\n\n  // When we change `translate` multiple times in close succession,\n  // Chrome may choose to wait and apply them all at once.\n  // Since we want the translation to initial X, Y to be immediate,\n  // and the translation to final X, Y to be animated,\n  // we saw problems where both would be applied after animation was turned on,\n  // making the dropdown appear to fly in from (0, 0).\n  // Using both `left`, `top` for the initial translation and then `translate`\n  // for the animated transition to final X, Y is a workaround.\n  return positionInternal(primaryX, primaryY, secondaryX, secondaryY);\n}\n\nconst internal = {\n  /**\n   * Get sizing info about the bounding element.\n   *\n   * @returns An object containing size information about the bounding element\n   *     (bounding box and width/height).\n   */\n  getBoundsInfo: function(): BoundsInfo {\n    const boundPosition = style.getPageOffset(boundsElement as Element);\n    const boundSize = style.getSize(boundsElement as Element);\n\n    return {\n      left: boundPosition.x,\n      right: boundPosition.x + boundSize.width,\n      top: boundPosition.y,\n      bottom: boundPosition.y + boundSize.height,\n      width: boundSize.width,\n      height: boundSize.height,\n    };\n  },\n\n  /**\n   * Helper to position the drop-down and the arrow, maintaining bounds.\n   * See explanation of origin points in show.\n   *\n   * @param primaryX Desired origin point x, in absolute px.\n   * @param primaryY Desired origin point y, in absolute px.\n   * @param secondaryX Secondary/alternative origin point x, in absolute px.\n   * @param secondaryY Secondary/alternative origin point y, in absolute px.\n   * @returns Various final metrics, including rendered positions for drop-down\n   *     and arrow.\n   */\n  getPositionMetrics: function(\n      primaryX: number, primaryY: number, secondaryX: number,\n      secondaryY: number): PositionMetrics {\n    const boundsInfo = internal.getBoundsInfo();\n    const divSize = style.getSize(div as Element);\n\n    // Can we fit in-bounds below the target?\n    if (primaryY + divSize.height < boundsInfo.bottom) {\n      return getPositionBelowMetrics(primaryX, primaryY, boundsInfo, divSize);\n    }\n    // Can we fit in-bounds above the target?\n    if (secondaryY - divSize.height > boundsInfo.top) {\n      return getPositionAboveMetrics(\n          secondaryX, secondaryY, boundsInfo, divSize);\n    }\n    // Can we fit outside the workspace bounds (but inside the window)\n    // below?\n    if (primaryY + divSize.height < document.documentElement.clientHeight) {\n      return getPositionBelowMetrics(primaryX, primaryY, boundsInfo, divSize);\n    }\n    // Can we fit outside the workspace bounds (but inside the window)\n    // above?\n    if (secondaryY - divSize.height > document.documentElement.clientTop) {\n      return getPositionAboveMetrics(\n          secondaryX, secondaryY, boundsInfo, divSize);\n    }\n\n    // Last resort, render at top of page.\n    return getPositionTopOfPageMetrics(primaryX, boundsInfo, divSize);\n  },\n};\n\n/**\n * Get the metrics for positioning the div below the source.\n *\n * @param primaryX Desired origin point x, in absolute px.\n * @param primaryY Desired origin point y, in absolute px.\n * @param boundsInfo An object containing size information about the bounding\n *     element (bounding box and width/height).\n * @param divSize An object containing information about the size of the\n *     DropDownDiv (width & height).\n * @returns Various final metrics, including rendered positions for drop-down\n *     and arrow.\n */\nfunction getPositionBelowMetrics(\n    primaryX: number, primaryY: number, boundsInfo: BoundsInfo,\n    divSize: Size): PositionMetrics {\n  const xCoords =\n      getPositionX(primaryX, boundsInfo.left, boundsInfo.right, divSize.width);\n\n  const arrowY = -(ARROW_SIZE / 2 + BORDER_SIZE);\n  const finalY = primaryY + PADDING_Y;\n\n  return {\n    initialX: xCoords.divX,\n    initialY: primaryY,\n    finalX: xCoords.divX,  // X position remains constant during animation.\n    finalY,\n    arrowX: xCoords.arrowX,\n    arrowY,\n    arrowAtTop: true,\n    arrowVisible: true,\n  };\n}\n\n/**\n * Get the metrics for positioning the div above the source.\n *\n * @param secondaryX Secondary/alternative origin point x, in absolute px.\n * @param secondaryY Secondary/alternative origin point y, in absolute px.\n * @param boundsInfo An object containing size information about the bounding\n *     element (bounding box and width/height).\n * @param divSize An object containing information about the size of the\n *     DropDownDiv (width & height).\n * @returns Various final metrics, including rendered positions for drop-down\n *     and arrow.\n */\nfunction getPositionAboveMetrics(\n    secondaryX: number, secondaryY: number, boundsInfo: BoundsInfo,\n    divSize: Size): PositionMetrics {\n  const xCoords = getPositionX(\n      secondaryX, boundsInfo.left, boundsInfo.right, divSize.width);\n\n  const arrowY = divSize.height - BORDER_SIZE * 2 - ARROW_SIZE / 2;\n  const finalY = secondaryY - divSize.height - PADDING_Y;\n  const initialY = secondaryY - divSize.height;  // No padding on Y.\n\n  return {\n    initialX: xCoords.divX,\n    initialY,\n    finalX: xCoords.divX,  // X position remains constant during animation.\n    finalY,\n    arrowX: xCoords.arrowX,\n    arrowY,\n    arrowAtTop: false,\n    arrowVisible: true,\n  };\n}\n\n/**\n * Get the metrics for positioning the div at the top of the page.\n *\n * @param sourceX Desired origin point x, in absolute px.\n * @param boundsInfo An object containing size information about the bounding\n *     element (bounding box and width/height).\n * @param divSize An object containing information about the size of the\n *     DropDownDiv (width & height).\n * @returns Various final metrics, including rendered positions for drop-down\n *     and arrow.\n */\nfunction getPositionTopOfPageMetrics(\n    sourceX: number, boundsInfo: BoundsInfo, divSize: Size): PositionMetrics {\n  const xCoords =\n      getPositionX(sourceX, boundsInfo.left, boundsInfo.right, divSize.width);\n\n  // No need to provide arrow-specific information because it won't be visible.\n  return {\n    initialX: xCoords.divX,\n    initialY: 0,\n    finalX: xCoords.divX,  // X position remains constant during animation.\n    finalY: 0,             // Y position remains constant during animation.\n    arrowAtTop: null,\n    arrowX: null,\n    arrowY: null,\n    arrowVisible: false,\n  };\n}\n\n/**\n * Get the x positions for the left side of the DropDownDiv and the arrow,\n * accounting for the bounds of the workspace.\n *\n * @param sourceX Desired origin point x, in absolute px.\n * @param boundsLeft The left edge of the bounding element, in absolute px.\n * @param boundsRight The right edge of the bounding element, in absolute px.\n * @param divWidth The width of the div in px.\n * @returns An object containing metrics for the x positions of the left side of\n *     the DropDownDiv and the arrow.\n * @internal\n */\nexport function getPositionX(\n    sourceX: number, boundsLeft: number, boundsRight: number,\n    divWidth: number): {divX: number, arrowX: number} {\n  let divX = sourceX;\n  // Offset the topLeft coord so that the dropdowndiv is centered.\n  divX -= divWidth / 2;\n  // Fit the dropdowndiv within the bounds of the workspace.\n  divX = math.clamp(boundsLeft, divX, boundsRight - divWidth);\n\n  let arrowX = sourceX;\n  // Offset the arrow coord so that the arrow is centered.\n  arrowX -= ARROW_SIZE / 2;\n  // Convert the arrow position to be relative to the top left of the div.\n  let relativeArrowX = arrowX - divX;\n  const horizPadding = ARROW_HORIZONTAL_PADDING;\n  // Clamp the arrow position so that it stays attached to the dropdowndiv.\n  relativeArrowX = math.clamp(\n      horizPadding, relativeArrowX, divWidth - horizPadding - ARROW_SIZE);\n\n  return {arrowX: relativeArrowX, divX};\n}\n\n/**\n * Is the container visible?\n *\n * @returns True if visible.\n */\nexport function isVisible(): boolean {\n  return !!owner;\n}\n\n/**\n * Hide the menu only if it is owned by the provided object.\n *\n * @param divOwner Object which must be owning the drop-down to hide.\n * @param opt_withoutAnimation True if we should hide the dropdown without\n *     animating.\n * @returns True if hidden.\n */\nexport function hideIfOwner(\n    divOwner: Field, opt_withoutAnimation?: boolean): boolean {\n  if (owner === divOwner) {\n    if (opt_withoutAnimation) {\n      hideWithoutAnimation();\n    } else {\n      hide();\n    }\n    return true;\n  }\n  return false;\n}\n\n/** Hide the menu, triggering animation. */\nexport function hide() {\n  // Start the animation by setting the translation and fading out.\n  // Reset to (initialX, initialY) - i.e., no translation.\n  div.style.transform = 'translate(0, 0)';\n  div.style.opacity = '0';\n  // Finish animation - reset all values to default.\n  animateOutTimer = setTimeout(function() {\n    hideWithoutAnimation();\n  }, ANIMATION_TIME * 1000);\n  if (onHide) {\n    onHide();\n    onHide = null;\n  }\n}\n\n/** Hide the menu, without animation. */\nexport function hideWithoutAnimation() {\n  if (!isVisible()) {\n    return;\n  }\n  if (animateOutTimer) {\n    clearTimeout(animateOutTimer);\n  }\n\n  // Reset style properties in case this gets called directly\n  // instead of hide() - see discussion on #2551.\n  div.style.transform = '';\n  div.style.left = '';\n  div.style.top = '';\n  div.style.opacity = '0';\n  div.style.display = 'none';\n  div.style.backgroundColor = '';\n  div.style.borderColor = '';\n\n  if (onHide) {\n    onHide();\n    onHide = null;\n  }\n  clearContent();\n  owner = null;\n\n  if (renderedClassName) {\n    dom.removeClass(div, renderedClassName);\n    renderedClassName = '';\n  }\n  if (themeClassName) {\n    dom.removeClass(div, themeClassName);\n    themeClassName = '';\n  }\n  (common.getMainWorkspace() as WorkspaceSvg).markFocused();\n}\n\n/**\n * Set the dropdown div's position.\n *\n * @param primaryX Desired origin point x, in absolute px.\n * @param primaryY Desired origin point y, in absolute px.\n * @param secondaryX Secondary/alternative origin point x, in absolute px.\n * @param secondaryY Secondary/alternative origin point y, in absolute px.\n * @returns True if the menu rendered at the primary origin point.\n */\nfunction positionInternal(\n    primaryX: number, primaryY: number, secondaryX: number,\n    secondaryY: number): boolean {\n  const metrics =\n      internal.getPositionMetrics(primaryX, primaryY, secondaryX, secondaryY);\n\n  // Update arrow CSS.\n  if (metrics.arrowVisible) {\n    arrow.style.display = '';\n    arrow.style.transform = 'translate(' + metrics.arrowX + 'px,' +\n        metrics.arrowY + 'px) rotate(45deg)';\n    arrow.setAttribute(\n        'class',\n        metrics.arrowAtTop ? 'blocklyDropDownArrow blocklyArrowTop' :\n                             'blocklyDropDownArrow blocklyArrowBottom');\n  } else {\n    arrow.style.display = 'none';\n  }\n\n  const initialX = Math.floor(metrics.initialX);\n  const initialY = Math.floor(metrics.initialY);\n  const finalX = Math.floor(metrics.finalX);\n  const finalY = Math.floor(metrics.finalY);\n\n  // First apply initial translation.\n  div.style.left = initialX + 'px';\n  div.style.top = initialY + 'px';\n\n  // Show the div.\n  div.style.display = 'block';\n  div.style.opacity = '1';\n  // Add final translate, animated through `transition`.\n  // Coordinates are relative to (initialX, initialY),\n  // where the drop-down is absolutely positioned.\n  const dx = finalX - initialX;\n  const dy = finalY - initialY;\n  div.style.transform = 'translate(' + dx + 'px,' + dy + 'px)';\n\n  return !!metrics.arrowAtTop;\n}\n\n/**\n * Repositions the dropdownDiv on window resize. If it doesn't know how to\n * calculate the new position, it will just hide it instead.\n *\n * @internal\n */\nexport function repositionForWindowResize() {\n  // This condition mainly catches the dropdown div when it is being used as a\n  // dropdown.  It is important not to close it in this case because on Android,\n  // when a field is focused, the soft keyboard opens triggering a window resize\n  // event and we want the dropdown div to stick around so users can type into\n  // it.\n  if (owner) {\n    const block = owner.getSourceBlock() as BlockSvg;\n    const bBox = positionToField ? getScaledBboxOfField(owner) :\n                                   getScaledBboxOfBlock(block);\n    // If we can fit it, render below the block.\n    const primaryX = bBox.left + (bBox.right - bBox.left) / 2;\n    const primaryY = bBox.bottom;\n    // If we can't fit it, render above the entire parent block.\n    const secondaryX = primaryX;\n    const secondaryY = bBox.top;\n    positionInternal(primaryX, primaryY, secondaryX, secondaryY);\n  } else {\n    hide();\n  }\n}\n\nexport const TEST_ONLY = internal;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for string manipulation.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @namespace Blockly.utils.string\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.string');\n\nimport * as deprecation from './deprecation.js';\n\n\n/**\n * Fast prefix-checker.\n * Copied from Closure's goog.string.startsWith.\n *\n * @param str The string to check.\n * @param prefix A string to look for at the start of `str`.\n * @returns True if `str` begins with `prefix`.\n * @alias Blockly.utils.string.startsWith\n * @deprecated April 2022. Use built-in string.startsWith.\n */\nexport function startsWith(str: string, prefix: string): boolean {\n  deprecation.warn(\n      'Blockly.utils.string.startsWith()', 'April 2022', 'April 2023',\n      'Use built-in string.startsWith');\n  return str.startsWith(prefix);\n}\n\n/**\n * Given an array of strings, return the length of the shortest one.\n *\n * @param array Array of strings.\n * @returns Length of shortest string.\n * @alias Blockly.utils.string.shortestStringLength\n */\nexport function shortestStringLength(array: string[]): number {\n  if (!array.length) {\n    return 0;\n  }\n  return array\n      .reduce(function(a, b) {\n        return a.length < b.length ? a : b;\n      })\n      .length;\n}\n\n/**\n * Given an array of strings, return the length of the common prefix.\n * Words may not be split.  Any space after a word is included in the length.\n *\n * @param array Array of strings.\n * @param opt_shortest Length of shortest string.\n * @returns Length of common prefix.\n * @alias Blockly.utils.string.commonWordPrefix\n */\nexport function commonWordPrefix(\n    array: string[], opt_shortest?: number): number {\n  if (!array.length) {\n    return 0;\n  } else if (array.length === 1) {\n    return array[0].length;\n  }\n  let wordPrefix = 0;\n  const max = opt_shortest || shortestStringLength(array);\n  let len;\n  for (len = 0; len < max; len++) {\n    const letter = array[0][len];\n    for (let i = 1; i < array.length; i++) {\n      if (letter !== array[i][len]) {\n        return wordPrefix;\n      }\n    }\n    if (letter === ' ') {\n      wordPrefix = len + 1;\n    }\n  }\n  for (let i = 1; i < array.length; i++) {\n    const letter = array[i][len];\n    if (letter && letter !== ' ') {\n      return wordPrefix;\n    }\n  }\n  return max;\n}\n\n/**\n * Given an array of strings, return the length of the common suffix.\n * Words may not be split.  Any space after a word is included in the length.\n *\n * @param array Array of strings.\n * @param opt_shortest Length of shortest string.\n * @returns Length of common suffix.\n * @alias Blockly.utils.string.commonWordSuffix\n */\nexport function commonWordSuffix(\n    array: string[], opt_shortest?: number): number {\n  if (!array.length) {\n    return 0;\n  } else if (array.length === 1) {\n    return array[0].length;\n  }\n  let wordPrefix = 0;\n  const max = opt_shortest || shortestStringLength(array);\n  let len;\n  for (len = 0; len < max; len++) {\n    const letter = array[0].substr(-len - 1, 1);\n    for (let i = 1; i < array.length; i++) {\n      if (letter !== array[i].substr(-len - 1, 1)) {\n        return wordPrefix;\n      }\n    }\n    if (letter === ' ') {\n      wordPrefix = len + 1;\n    }\n  }\n  for (let i = 1; i < array.length; i++) {\n    const letter = array[i].charAt(array[i].length - len - 1);\n    if (letter && letter !== ' ') {\n      return wordPrefix;\n    }\n  }\n  return max;\n}\n\n/**\n * Wrap text to the specified width.\n *\n * @param text Text to wrap.\n * @param limit Width to wrap each line.\n * @returns Wrapped text.\n * @alias Blockly.utils.string.wrap\n */\nexport function wrap(text: string, limit: number): string {\n  const lines = text.split('\\n');\n  for (let i = 0; i < lines.length; i++) {\n    lines[i] = wrapLine(lines[i], limit);\n  }\n  return lines.join('\\n');\n}\n\n/**\n * Wrap single line of text to the specified width.\n *\n * @param text Text to wrap.\n * @param limit Width to wrap each line.\n * @returns Wrapped text.\n */\nfunction wrapLine(text: string, limit: number): string {\n  if (text.length <= limit) {\n    // Short text, no need to wrap.\n    return text;\n  }\n  // Split the text into words.\n  const words = text.trim().split(/\\s+/);\n  // Set limit to be the length of the largest word.\n  for (let i = 0; i < words.length; i++) {\n    if (words[i].length > limit) {\n      limit = words[i].length;\n    }\n  }\n\n  let lastScore;\n  let score = -Infinity;\n  let lastText;\n  let lineCount = 1;\n  do {\n    lastScore = score;\n    lastText = text;\n    // Create a list of booleans representing if a space (false) or\n    // a break (true) appears after each word.\n    let wordBreaks = [];\n    // Seed the list with evenly spaced linebreaks.\n    const steps = words.length / lineCount;\n    let insertedBreaks = 1;\n    for (let i = 0; i < words.length - 1; i++) {\n      if (insertedBreaks < (i + 1.5) / steps) {\n        insertedBreaks++;\n        wordBreaks[i] = true;\n      } else {\n        wordBreaks[i] = false;\n      }\n    }\n    wordBreaks = wrapMutate(words, wordBreaks, limit);\n    score = wrapScore(words, wordBreaks, limit);\n    text = wrapToText(words, wordBreaks);\n    lineCount++;\n  } while (score > lastScore);\n  return lastText;\n}\n\n/**\n * Compute a score for how good the wrapping is.\n *\n * @param words Array of each word.\n * @param wordBreaks Array of line breaks.\n * @param limit Width to wrap each line.\n * @returns Larger the better.\n */\nfunction wrapScore(\n    words: string[], wordBreaks: boolean[], limit: number): number {\n  // If this function becomes a performance liability, add caching.\n  // Compute the length of each line.\n  const lineLengths = [0];\n  const linePunctuation = [];\n  for (let i = 0; i < words.length; i++) {\n    lineLengths[lineLengths.length - 1] += words[i].length;\n    if (wordBreaks[i] === true) {\n      lineLengths.push(0);\n      linePunctuation.push(words[i].charAt(words[i].length - 1));\n    } else if (wordBreaks[i] === false) {\n      lineLengths[lineLengths.length - 1]++;\n    }\n  }\n  const maxLength = Math.max(...lineLengths);\n\n  let score = 0;\n  for (let i = 0; i < lineLengths.length; i++) {\n    // Optimize for width.\n    // -2 points per char over limit (scaled to the power of 1.5).\n    score -= Math.pow(Math.abs(limit - lineLengths[i]), 1.5) * 2;\n    // Optimize for even lines.\n    // -1 point per char smaller than max (scaled to the power of 1.5).\n    score -= Math.pow(maxLength - lineLengths[i], 1.5);\n    // Optimize for structure.\n    // Add score to line endings after punctuation.\n    if ('.?!'.indexOf(linePunctuation[i]) !== -1) {\n      score += limit / 3;\n    } else if (',;)]}'.indexOf(linePunctuation[i]) !== -1) {\n      score += limit / 4;\n    }\n  }\n  // All else being equal, the last line should not be longer than the\n  // previous line.  For example, this looks wrong:\n  // aaa bbb\n  // ccc ddd eee\n  if (lineLengths.length > 1 &&\n      lineLengths[lineLengths.length - 1] <=\n          lineLengths[lineLengths.length - 2]) {\n    score += 0.5;\n  }\n  return score;\n}\n/**\n * Mutate the array of line break locations until an optimal solution is found.\n * No line breaks are added or deleted, they are simply moved around.\n *\n * @param words Array of each word.\n * @param wordBreaks Array of line breaks.\n * @param limit Width to wrap each line.\n * @returns New array of optimal line breaks.\n */\nfunction wrapMutate(\n    words: string[], wordBreaks: boolean[], limit: number): boolean[] {\n  let bestScore = wrapScore(words, wordBreaks, limit);\n  let bestBreaks;\n  // Try shifting every line break forward or backward.\n  for (let i = 0; i < wordBreaks.length - 1; i++) {\n    if (wordBreaks[i] === wordBreaks[i + 1]) {\n      continue;\n    }\n    const mutatedWordBreaks = (new Array<boolean>()).concat(wordBreaks);\n    mutatedWordBreaks[i] = !mutatedWordBreaks[i];\n    mutatedWordBreaks[i + 1] = !mutatedWordBreaks[i + 1];\n    const mutatedScore = wrapScore(words, mutatedWordBreaks, limit);\n    if (mutatedScore > bestScore) {\n      bestScore = mutatedScore;\n      bestBreaks = mutatedWordBreaks;\n    }\n  }\n  if (bestBreaks) {\n    // Found an improvement.  See if it may be improved further.\n    return wrapMutate(words, bestBreaks, limit);\n  }\n  // No improvements found.  Done.\n  return wordBreaks;\n}\n\n/**\n * Reassemble the array of words into text, with the specified line breaks.\n *\n * @param words Array of each word.\n * @param wordBreaks Array of line breaks.\n * @returns Plain text.\n */\nfunction wrapToText(words: string[], wordBreaks: boolean[]): string {\n  const text = [];\n  for (let i = 0; i < words.length; i++) {\n    text.push(words[i]);\n    if (wordBreaks[i] !== undefined) {\n      text.push(wordBreaks[i] ? '\\n' : ' ');\n    }\n  }\n  return text.join('');\n}\n\n/**\n * Is the given string a number (includes negative and decimals).\n *\n * @param str Input string.\n * @returns True if number, false otherwise.\n * @alias Blockly.utils.string.isNumber\n */\nexport function isNumber(str: string): boolean {\n  return /^\\s*-?\\d+(\\.\\d+)?\\s*$/.test(str);\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Library to create tooltips for Blockly.\n * First, call createDom() after onload.\n * Second, set the 'tooltip' property on any SVG element that needs a tooltip.\n * If the tooltip is a string, or a function that returns a string, that message\n * will be displayed. If the tooltip is an SVG element, then that object's\n * tooltip will be used. Third, call bindMouseEvents(e) passing the SVG element.\n *\n * @namespace Blockly.Tooltip\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Tooltip');\n\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\nimport * as blocklyString from './utils/string.js';\n\n\n/**\n * A type which can define a tooltip.\n * Either a string, an object containing a tooltip property, or a function which\n * returns either a string, or another arbitrarily nested function which\n * eventually unwinds to a string.\n *\n * @alias Blockly.Tooltip.TipInfo\n */\nexport type TipInfo =\n    string|{tooltip: AnyDuringMigration}|(() => TipInfo|string|Function);\n\n/**\n * A function that renders custom tooltip UI.\n * 1st parameter: the div element to render content into.\n * 2nd parameter: the element being moused over (i.e., the element for which the\n * tooltip should be shown).\n *\n * @alias Blockly.Tooltip.CustomTooltip\n */\nexport type CustomTooltip = (p1: Element, p2: Element) => AnyDuringMigration;\n\n/**\n * An optional function that renders custom tooltips into the provided DIV. If\n * this is defined, the function will be called instead of rendering the default\n * tooltip UI.\n */\nlet customTooltip: CustomTooltip|undefined = undefined;\n\n/**\n * Sets a custom function that will be called if present instead of the default\n * tooltip UI.\n *\n * @param customFn A custom tooltip used to render an alternate tooltip UI.\n * @alias Blockly.Tooltip.setCustomTooltip\n */\nexport function setCustomTooltip(customFn: CustomTooltip) {\n  customTooltip = customFn;\n}\n\n/**\n * Gets the custom tooltip function.\n *\n * @returns The custom tooltip function, if defined.\n */\nexport function getCustomTooltip(): CustomTooltip|undefined {\n  return customTooltip;\n}\n\n/** Is a tooltip currently showing? */\nlet visible = false;\n\n/**\n * Returns whether or not a tooltip is showing\n *\n * @returns True if a tooltip is showing\n * @alias Blockly.Tooltip.isVisible\n */\nexport function isVisible(): boolean {\n  return visible;\n}\n\n/** Is someone else blocking the tooltip from being shown? */\nlet blocked = false;\n\n/**\n * Maximum width (in characters) of a tooltip.\n *\n * @alias Blockly.Tooltip.LIMIT\n */\nexport const LIMIT = 50;\n\n/** PID of suspended thread to clear tooltip on mouse out. */\nlet mouseOutPid: AnyDuringMigration = 0;\n\n/** PID of suspended thread to show the tooltip. */\nlet showPid: AnyDuringMigration = 0;\n\n/**\n * Last observed X location of the mouse pointer (freezes when tooltip appears).\n */\nlet lastX = 0;\n\n/**\n * Last observed Y location of the mouse pointer (freezes when tooltip appears).\n */\nlet lastY = 0;\n\n/** Current element being pointed at. */\nlet element: AnyDuringMigration = null;\n\n/**\n * Once a tooltip has opened for an element, that element is 'poisoned' and\n * cannot respawn a tooltip until the pointer moves over a different element.\n */\nlet poisonedElement: AnyDuringMigration = null;\n\n/**\n * Horizontal offset between mouse cursor and tooltip.\n *\n * @alias Blockly.Tooltip.OFFSET_X\n */\nexport const OFFSET_X = 0;\n\n/**\n * Vertical offset between mouse cursor and tooltip.\n *\n * @alias Blockly.Tooltip.OFFSET_Y\n */\nexport const OFFSET_Y = 10;\n\n/**\n * Radius mouse can move before killing tooltip.\n *\n * @alias Blockly.Tooltip.RADIUS_OK\n */\nexport const RADIUS_OK = 10;\n\n/**\n * Delay before tooltip appears.\n *\n * @alias Blockly.Tooltip.HOVER_MS\n */\nexport const HOVER_MS = 750;\n\n/**\n * Horizontal padding between tooltip and screen edge.\n *\n * @alias Blockly.Tooltip.MARGINS\n */\nexport const MARGINS = 5;\n\n/** The HTML container.  Set once by createDom. */\nlet containerDiv: HTMLDivElement|null = null;\n\n/**\n * Returns the HTML tooltip container.\n *\n * @returns The HTML tooltip container.\n * @alias Blockly.Tooltip.getDiv\n */\nexport function getDiv(): HTMLDivElement|null {\n  return containerDiv;\n}\n\n/**\n * Returns the tooltip text for the given element.\n *\n * @param object The object to get the tooltip text of.\n * @returns The tooltip text of the element.\n * @alias Blockly.Tooltip.getTooltipOfObject\n */\nexport function getTooltipOfObject(object: AnyDuringMigration|null): string {\n  const obj = getTargetObject(object);\n  if (obj) {\n    let tooltip = obj.tooltip;\n    while (typeof tooltip === 'function') {\n      tooltip = tooltip();\n    }\n    if (typeof tooltip !== 'string') {\n      throw Error('Tooltip function must return a string.');\n    }\n    return tooltip;\n  }\n  return '';\n}\n\n/**\n * Returns the target object that the given object is targeting for its\n * tooltip. Could be the object itself.\n *\n * @param obj The object are trying to find the target tooltip object of.\n * @returns The target tooltip object.\n */\nfunction getTargetObject(obj: object|null): {tooltip: AnyDuringMigration}|null {\n  while (obj && (obj as any).tooltip) {\n    if (typeof (obj as any).tooltip === 'string' ||\n        typeof (obj as any).tooltip === 'function') {\n      return obj as {tooltip: string | (() => string)};\n    }\n    obj = (obj as any).tooltip;\n  }\n  return null;\n}\n\n/**\n * Create the tooltip div and inject it onto the page.\n *\n * @alias Blockly.Tooltip.createDom\n */\nexport function createDom() {\n  if (containerDiv) {\n    return;  // Already created.\n  }\n  // Create an HTML container for popup overlays (e.g. editor widgets).\n  containerDiv = document.createElement('div');\n  containerDiv.className = 'blocklyTooltipDiv';\n  const container = common.getParentContainer() || document.body;\n  container.appendChild(containerDiv);\n}\n\n/**\n * Binds the required mouse events onto an SVG element.\n *\n * @param element SVG element onto which tooltip is to be bound.\n * @alias Blockly.Tooltip.bindMouseEvents\n */\nexport function bindMouseEvents(element: Element) {\n  // TODO (#6097): Don't stash wrapper info on the DOM.\n  (element as AnyDuringMigration).mouseOverWrapper_ =\n      browserEvents.bind(element, 'mouseover', null, onMouseOver);\n  (element as AnyDuringMigration).mouseOutWrapper_ =\n      browserEvents.bind(element, 'mouseout', null, onMouseOut);\n\n  // Don't use bindEvent_ for mousemove since that would create a\n  // corresponding touch handler, even though this only makes sense in the\n  // context of a mouseover/mouseout.\n  element.addEventListener('mousemove', onMouseMove, false);\n}\n\n/**\n * Unbinds tooltip mouse events from the SVG element.\n *\n * @param element SVG element onto which tooltip is bound.\n * @alias Blockly.Tooltip.unbindMouseEvents\n */\nexport function unbindMouseEvents(element: Element) {\n  if (!element) {\n    return;\n  }\n  // TODO (#6097): Don't stash wrapper info on the DOM.\n  browserEvents.unbind((element as AnyDuringMigration).mouseOverWrapper_);\n  browserEvents.unbind((element as AnyDuringMigration).mouseOutWrapper_);\n  element.removeEventListener('mousemove', onMouseMove);\n}\n\n/**\n * Hide the tooltip if the mouse is over a different object.\n * Initialize the tooltip to potentially appear for this object.\n *\n * @param e Mouse event.\n */\nfunction onMouseOver(e: Event) {\n  if (blocked) {\n    // Someone doesn't want us to show tooltips.\n    return;\n  }\n  // If the tooltip is an object, treat it as a pointer to the next object in\n  // the chain to look at.  Terminate when a string or function is found.\n  const newElement = getTargetObject(e.currentTarget);\n  if (element !== newElement) {\n    hide();\n    poisonedElement = null;\n    element = newElement;\n  }\n  // Forget about any immediately preceding mouseOut event.\n  clearTimeout(mouseOutPid);\n}\n\n/**\n * Hide the tooltip if the mouse leaves the object and enters the workspace.\n *\n * @param _e Mouse event.\n */\nfunction onMouseOut(_e: Event) {\n  if (blocked) {\n    // Someone doesn't want us to show tooltips.\n    return;\n  }\n  // Moving from one element to another (overlapping or with no gap) generates\n  // a mouseOut followed instantly by a mouseOver.  Fork off the mouseOut\n  // event and kill it if a mouseOver is received immediately.\n  // This way the task only fully executes if mousing into the void.\n  mouseOutPid = setTimeout(function() {\n    element = null;\n    poisonedElement = null;\n    hide();\n  }, 1);\n  clearTimeout(showPid);\n}\n\n/**\n * When hovering over an element, schedule a tooltip to be shown.  If a tooltip\n * is already visible, hide it if the mouse strays out of a certain radius.\n *\n * @param e Mouse event.\n */\nfunction onMouseMove(e: Event) {\n  if (!element || !(element as AnyDuringMigration).tooltip) {\n    // No tooltip here to show.\n    return;\n  } else if (blocked) {\n    // Someone doesn't want us to show tooltips.  We are probably handling a\n    // user gesture, such as a click or drag.\n    return;\n  }\n  if (visible) {\n    // Compute the distance between the mouse position when the tooltip was\n    // shown and the current mouse position.  Pythagorean theorem.\n    // AnyDuringMigration because:  Property 'pageX' does not exist on type\n    // 'Event'.\n    const dx = lastX - (e as AnyDuringMigration).pageX;\n    // AnyDuringMigration because:  Property 'pageY' does not exist on type\n    // 'Event'.\n    const dy = lastY - (e as AnyDuringMigration).pageY;\n    if (Math.sqrt(dx * dx + dy * dy) > RADIUS_OK) {\n      hide();\n    }\n  } else if (poisonedElement !== element) {\n    // The mouse moved, clear any previously scheduled tooltip.\n    clearTimeout(showPid);\n    // Maybe this time the mouse will stay put.  Schedule showing of tooltip.\n    // AnyDuringMigration because:  Property 'pageX' does not exist on type\n    // 'Event'.\n    lastX = (e as AnyDuringMigration).pageX;\n    // AnyDuringMigration because:  Property 'pageY' does not exist on type\n    // 'Event'.\n    lastY = (e as AnyDuringMigration).pageY;\n    showPid = setTimeout(show, HOVER_MS);\n  }\n}\n\n/**\n * Dispose of the tooltip.\n *\n * @alias Blockly.Tooltip.dispose\n * @internal\n */\nexport function dispose() {\n  element = null;\n  poisonedElement = null;\n  hide();\n}\n\n/**\n * Hide the tooltip.\n *\n * @alias Blockly.Tooltip.hide\n */\nexport function hide() {\n  if (visible) {\n    visible = false;\n    if (containerDiv) {\n      containerDiv.style.display = 'none';\n    }\n  }\n  if (showPid) {\n    clearTimeout(showPid);\n  }\n}\n\n/**\n * Hide any in-progress tooltips and block showing new tooltips until the next\n * call to unblock().\n *\n * @alias Blockly.Tooltip.block\n * @internal\n */\nexport function block() {\n  hide();\n  blocked = true;\n}\n\n/**\n * Unblock tooltips: allow them to be scheduled and shown according to their own\n * logic.\n *\n * @alias Blockly.Tooltip.unblock\n * @internal\n */\nexport function unblock() {\n  blocked = false;\n}\n\n/** Renders the tooltip content into the tooltip div. */\nfunction renderContent() {\n  if (!containerDiv || !element) {\n    // This shouldn't happen, but if it does, we can't render.\n    return;\n  }\n  if (typeof customTooltip === 'function') {\n    customTooltip(containerDiv, element);\n  } else {\n    renderDefaultContent();\n  }\n}\n\n/** Renders the default tooltip UI. */\nfunction renderDefaultContent() {\n  let tip = getTooltipOfObject(element);\n  tip = blocklyString.wrap(tip, LIMIT);\n  // Create new text, line by line.\n  const lines = tip.split('\\n');\n  for (let i = 0; i < lines.length; i++) {\n    const div = (document.createElement('div'));\n    div.appendChild(document.createTextNode(lines[i]));\n    containerDiv!.appendChild(div);\n  }\n}\n\n/**\n * Gets the coordinates for the tooltip div, taking into account the edges of\n * the screen to prevent showing the tooltip offscreen.\n *\n * @param rtl True if the tooltip should be in right-to-left layout.\n * @returns Coordinates at which the tooltip div should be placed.\n */\nfunction getPosition(rtl: boolean): {x: number, y: number} {\n  // Position the tooltip just below the cursor.\n  const windowWidth = document.documentElement.clientWidth;\n  const windowHeight = document.documentElement.clientHeight;\n\n  let anchorX = lastX;\n  if (rtl) {\n    anchorX -= OFFSET_X + containerDiv!.offsetWidth;\n  } else {\n    anchorX += OFFSET_X;\n  }\n\n  let anchorY = lastY + OFFSET_Y;\n  if (anchorY + containerDiv!.offsetHeight > windowHeight + window.scrollY) {\n    // Falling off the bottom of the screen; shift the tooltip up.\n    anchorY -= containerDiv!.offsetHeight + 2 * OFFSET_Y;\n  }\n\n  if (rtl) {\n    // Prevent falling off left edge in RTL mode.\n    anchorX = Math.max(MARGINS - window.scrollX, anchorX);\n  } else {\n    if (anchorX + containerDiv!.offsetWidth >\n        windowWidth + window.scrollX - 2 * MARGINS) {\n      // Falling off the right edge of the screen;\n      // clamp the tooltip on the edge.\n      anchorX = windowWidth - containerDiv!.offsetWidth - 2 * MARGINS;\n    }\n  }\n\n  return {x: anchorX, y: anchorY};\n}\n\n/** Create the tooltip and show it. */\nfunction show() {\n  if (blocked) {\n    // Someone doesn't want us to show tooltips.\n    return;\n  }\n  poisonedElement = element;\n  if (!containerDiv) {\n    return;\n  }\n  // Erase all existing text.\n  containerDiv.textContent = '';\n\n  // Add new content.\n  renderContent();\n\n  // Display the tooltip.\n  const rtl = (element as any).RTL;\n  containerDiv.style.direction = rtl ? 'rtl' : 'ltr';\n  containerDiv.style.display = 'block';\n  visible = true;\n\n  const {x, y} = getPosition(rtl);\n  containerDiv.style.left = x + 'px';\n  containerDiv.style.top = y + 'px';\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for colour manipulation.\n *\n * @namespace Blockly.utils.colour\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.colour');\n\n\n/**\n * The richness of block colours, regardless of the hue.\n * Must be in the range of 0 (inclusive) to 1 (exclusive).\n *\n * @alias Blockly.utils.colour.hsvSaturation\n */\nlet hsvSaturation = 0.45;\n\n/**\n * Get the richness of block colours, regardless of the hue.\n *\n * @alias Blockly.utils.colour.getHsvSaturation\n * @returns The current richness.\n * @internal\n */\nexport function getHsvSaturation(): number {\n  return hsvSaturation;\n}\n\n/**\n * Set the richness of block colours, regardless of the hue.\n *\n * @param newSaturation The new richness, in the range of  0 (inclusive) to 1\n *     (exclusive)\n * @alias Blockly.utils.colour.setHsvSaturation\n * @internal\n */\nexport function setHsvSaturation(newSaturation: number) {\n  hsvSaturation = newSaturation;\n}\n\n/**\n * The intensity of block colours, regardless of the hue.\n * Must be in the range of 0 (inclusive) to 1 (exclusive).\n *\n * @alias Blockly.utils.colour.hsvValue\n */\nlet hsvValue = 0.65;\n\n/**\n * Get the intensity of block colours, regardless of the hue.\n *\n * @alias Blockly.utils.colour.getHsvValue\n * @returns The current intensity.\n * @internal\n */\nexport function getHsvValue(): number {\n  return hsvValue;\n}\n\n/**\n * Set the intensity of block colours, regardless of the hue.\n *\n * @param newValue The new intensity, in the range of  0 (inclusive) to 1\n *     (exclusive)\n * @alias Blockly.utils.colour.setHsvValue\n * @internal\n */\nexport function setHsvValue(newValue: number) {\n  hsvValue = newValue;\n}\n\n/**\n * Parses a colour from a string.\n * .parse('red') = '#ff0000'\n * .parse('#f00') = '#ff0000'\n * .parse('#ff0000') = '#ff0000'\n * .parse('0xff0000') = '#ff0000'\n * .parse('rgb(255, 0, 0)') = '#ff0000'\n *\n * @param str Colour in some CSS format.\n * @returns A string containing a hex representation of the colour, or null if\n *     can't be parsed.\n * @alias Blockly.utils.colour.parse\n */\nexport function parse(str: string|number): string|null {\n  str = String(str).toLowerCase().trim();\n  let hex = names[str];\n  if (hex) {\n    // e.g. 'red'\n    return hex;\n  }\n  hex = str.substring(0, 2) === '0x' ? '#' + str.substring(2) : str;\n  hex = hex[0] === '#' ? hex : '#' + hex;\n  if (/^#[0-9a-f]{6}$/.test(hex)) {\n    // e.g. '#00ff88'\n    return hex;\n  }\n  if (/^#[0-9a-f]{3}$/.test(hex)) {\n    // e.g. '#0f8'\n    return ['#', hex[1], hex[1], hex[2], hex[2], hex[3], hex[3]].join('');\n  }\n  const rgb = str.match(/^(?:rgb)?\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/);\n  if (rgb) {\n    // e.g. 'rgb(0, 128, 255)'\n    const r = Number(rgb[1]);\n    const g = Number(rgb[2]);\n    const b = Number(rgb[3]);\n    if (r >= 0 && r < 256 && g >= 0 && g < 256 && b >= 0 && b < 256) {\n      return rgbToHex(r, g, b);\n    }\n  }\n  return null;\n}\n\n/**\n * Converts a colour from RGB to hex representation.\n *\n * @param r Amount of red, int between 0 and 255.\n * @param g Amount of green, int between 0 and 255.\n * @param b Amount of blue, int between 0 and 255.\n * @returns Hex representation of the colour.\n * @alias Blockly.utils.colour.rgbToHex\n */\nexport function rgbToHex(r: number, g: number, b: number): string {\n  const rgb = r << 16 | g << 8 | b;\n  if (r < 0x10) {\n    return '#' + (0x1000000 | rgb).toString(16).substr(1);\n  }\n  return '#' + rgb.toString(16);\n}\n\n/**\n * Converts a colour to RGB.\n *\n * @param colour String representing colour in any colour format ('#ff0000',\n *     'red', '0xff000', etc).\n * @returns RGB representation of the colour.\n * @alias Blockly.utils.colour.hexToRgb\n */\nexport function hexToRgb(colour: string): number[] {\n  const hex = parse(colour);\n  if (!hex) {\n    return [0, 0, 0];\n  }\n\n  const rgb = parseInt(hex.substr(1), 16);\n  const r = rgb >> 16;\n  const g = rgb >> 8 & 255;\n  const b = rgb & 255;\n\n  return [r, g, b];\n}\n\n/**\n * Converts an HSV triplet to hex representation.\n *\n * @param h Hue value in [0, 360].\n * @param s Saturation value in [0, 1].\n * @param v Brightness in [0, 255].\n * @returns Hex representation of the colour.\n * @alias Blockly.utils.colour.hsvToHex\n */\nexport function hsvToHex(h: number, s: number, v: number): string {\n  let red = 0;\n  let green = 0;\n  let blue = 0;\n  if (s === 0) {\n    red = v;\n    green = v;\n    blue = v;\n  } else {\n    const sextant = Math.floor(h / 60);\n    const remainder = h / 60 - sextant;\n    const val1 = v * (1 - s);\n    const val2 = v * (1 - s * remainder);\n    const val3 = v * (1 - s * (1 - remainder));\n    switch (sextant) {\n      case 1:\n        red = val2;\n        green = v;\n        blue = val1;\n        break;\n      case 2:\n        red = val1;\n        green = v;\n        blue = val3;\n        break;\n      case 3:\n        red = val1;\n        green = val2;\n        blue = v;\n        break;\n      case 4:\n        red = val3;\n        green = val1;\n        blue = v;\n        break;\n      case 5:\n        red = v;\n        green = val1;\n        blue = val2;\n        break;\n      case 6:\n      case 0:\n        red = v;\n        green = val3;\n        blue = val1;\n        break;\n    }\n  }\n  return rgbToHex(Math.floor(red), Math.floor(green), Math.floor(blue));\n}\n\n/**\n * Blend two colours together, using the specified factor to indicate the\n * weight given to the first colour.\n *\n * @param colour1 First colour.\n * @param colour2 Second colour.\n * @param factor The weight to be given to colour1 over colour2.\n *     Values should be in the range [0, 1].\n * @returns Combined colour represented in hex.\n * @alias Blockly.utils.colour.blend\n */\nexport function blend(colour1: string, colour2: string, factor: number): string|\n    null {\n  const hex1 = parse(colour1);\n  if (!hex1) {\n    return null;\n  }\n  const hex2 = parse(colour2);\n  if (!hex2) {\n    return null;\n  }\n  const rgb1 = hexToRgb(hex1);\n  const rgb2 = hexToRgb(hex2);\n  const r = Math.round(rgb2[0] + factor * (rgb1[0] - rgb2[0]));\n  const g = Math.round(rgb2[1] + factor * (rgb1[1] - rgb2[1]));\n  const b = Math.round(rgb2[2] + factor * (rgb1[2] - rgb2[2]));\n  return rgbToHex(r, g, b);\n}\n\n/**\n * A map that contains the 16 basic colour keywords as defined by W3C:\n * https://www.w3.org/TR/2018/REC-css-color-3-20180619/#html4\n * The keys of this map are the lowercase \"readable\" names of the colours,\n * while the values are the \"hex\" values.\n *\n * @alias Blockly.utils.colour.names\n */\nexport const names: {[key: string]: string} = {\n  'aqua': '#00ffff',\n  'black': '#000000',\n  'blue': '#0000ff',\n  'fuchsia': '#ff00ff',\n  'gray': '#808080',\n  'green': '#008000',\n  'lime': '#00ff00',\n  'maroon': '#800000',\n  'navy': '#000080',\n  'olive': '#808000',\n  'purple': '#800080',\n  'red': '#ff0000',\n  'silver': '#c0c0c0',\n  'teal': '#008080',\n  'white': '#ffffff',\n  'yellow': '#ffff00',\n};\n\n/**\n * Convert a hue (HSV model) into an RGB hex triplet.\n *\n * @param hue Hue on a colour wheel (0-360).\n * @returns RGB code, e.g. '#5ba65b'.\n * @alias Blockly.utils.colour.hueToHex\n */\nexport function hueToHex(hue: number): string {\n  return hsvToHex(hue, hsvSaturation, hsvValue * 255);\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @namespace Blockly.utils.parsing\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.parsing');\n\nimport {Msg} from '../msg.js';\n\nimport * as colourUtils from './colour.js';\n\n\n/**\n * Internal implementation of the message reference and interpolation token\n * parsing used by tokenizeInterpolation() and replaceMessageReferences().\n *\n * @param message Text which might contain string table references and\n *     interpolation tokens.\n * @param parseInterpolationTokens Option to parse numeric\n *     interpolation tokens (%1, %2, ...) when true.\n * @returns Array of strings and numbers.\n */\nfunction tokenizeInterpolationInternal(\n    message: string, parseInterpolationTokens: boolean): (string|number)[] {\n  const tokens = [];\n  const chars = message.split('');\n  chars.push(  // End marker.\n      '');\n  // Parse the message with a finite state machine.\n  // 0 - Base case.\n  // 1 - % found.\n  // 2 - Digit found.\n  // 3 - Message ref found.\n  let state = 0;\n  const buffer = new Array<string>();\n  let number = null;\n  for (let i = 0; i < chars.length; i++) {\n    const c = chars[i];\n    if (state === 0) {  // Start escape.\n      if (c === '%') {\n        const text = buffer.join('');\n        if (text) {\n          tokens.push(text);\n        }\n        buffer.length = 0;\n        state = 1;\n      } else {\n        buffer.push(c);  // Regular char.\n      }\n    } else if (state === 1) {\n      if (c === '%') {\n        buffer.push(c);  // Escaped %: %%\n        state = 0;\n      } else if (parseInterpolationTokens && '0' <= c && c <= '9') {\n        state = 2;\n        number = c;\n        const text = buffer.join('');\n        if (text) {\n          tokens.push(text);\n        }\n        buffer.length = 0;\n      } else if (c === '{') {\n        state = 3;\n      } else {\n        buffer.push('%', c);  // Not recognized. Return as literal.\n        state = 0;\n      }\n    } else if (state === 2) {\n      if ('0' <= c && c <= '9') {\n        number += c;  // Multi-digit number.\n      } else {\n        tokens.push(parseInt(number ?? '', 10));\n        i--;  // Parse this char again.\n        state = 0;\n      }\n    } else if (state === 3) {  // String table reference\n      if (c === '') {\n        // Premature end before closing '}'\n        buffer.splice(0, 0, '%{');  // Re-insert leading delimiter\n        i--;                        // Parse this char again.\n        state = 0;                  // and parse as string literal.\n      } else if (c !== '}') {\n        buffer.push(c);\n      } else {\n        const rawKey = buffer.join('');\n        if (/[A-Z]\\w*/i.test(rawKey)) {  // Strict matching\n          // Found a valid string key. Attempt case insensitive match.\n          const keyUpper = rawKey.toUpperCase();\n\n          // BKY_ is the prefix used to namespace the strings used in\n          // Blockly core files and the predefined blocks in ../blocks/.\n          // These strings are defined in ../msgs/ files.\n          const bklyKey =\n              keyUpper.startsWith('BKY_') ? keyUpper.substring(4) : null;\n          if (bklyKey && bklyKey in Msg) {\n            const rawValue = Msg[bklyKey];\n            if (typeof rawValue === 'string') {\n              // Attempt to dereference substrings, too, appending to the\n              // end.\n              Array.prototype.push.apply(\n                  tokens,\n                  tokenizeInterpolationInternal(\n                      rawValue, parseInterpolationTokens));\n            } else if (parseInterpolationTokens) {\n              // When parsing interpolation tokens, numbers are special\n              // placeholders (%1, %2, etc). Make sure all other values are\n              // strings.\n              tokens.push(String(rawValue));\n            } else {\n              tokens.push(rawValue);\n            }\n          } else {\n            // No entry found in the string table. Pass reference as string.\n            tokens.push('%{' + rawKey + '}');\n          }\n          buffer.length = 0;  // Clear the array\n          state = 0;\n        } else {\n          tokens.push('%{' + rawKey + '}');\n          buffer.length = 0;\n          state = 0;  // and parse as string literal.\n        }\n      }\n    }\n  }\n  let text = buffer.join('');\n  if (text) {\n    tokens.push(text);\n  }\n\n  // Merge adjacent text tokens into a single string.\n  const mergedTokens = [];\n  buffer.length = 0;\n  for (let i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] === 'string') {\n      buffer.push(tokens[i] as string);\n    } else {\n      text = buffer.join('');\n      if (text) {\n        mergedTokens.push(text);\n      }\n      buffer.length = 0;\n      mergedTokens.push(tokens[i]);\n    }\n  }\n  text = buffer.join('');\n  if (text) {\n    mergedTokens.push(text);\n  }\n  buffer.length = 0;\n\n  return mergedTokens;\n}\n\n/**\n * Parse a string with any number of interpolation tokens (%1, %2, ...).\n * It will also replace string table references (e.g., %{bky_my_msg} and\n * %{BKY_MY_MSG} will both be replaced with the value in\n * Msg['MY_MSG']). Percentage sign characters '%' may be self-escaped\n * (e.g., '%%').\n *\n * @param message Text which might contain string table references and\n *     interpolation tokens.\n * @returns Array of strings and numbers.\n * @alias Blockly.utils.parsing.tokenizeInterpolation\n */\nexport function tokenizeInterpolation(message: string): (string|number)[] {\n  return tokenizeInterpolationInternal(message, true);\n}\n\n/**\n * Replaces string table references in a message, if the message is a string.\n * For example, \"%{bky_my_msg}\" and \"%{BKY_MY_MSG}\" will both be replaced with\n * the value in Msg['MY_MSG'].\n *\n * @param message Message, which may be a string that contains\n *     string table references.\n * @returns String with message references replaced.\n * @alias Blockly.utils.parsing.replaceMessageReferences\n */\nexport function replaceMessageReferences(message: string|any): string {\n  if (typeof message !== 'string') {\n    return message;\n  }\n  const interpolatedResult = tokenizeInterpolationInternal(message, false);\n  // When parseInterpolationTokens === false, interpolatedResult should be at\n  // most length 1.\n  return interpolatedResult.length ? String(interpolatedResult[0]) : '';\n}\n\n/**\n * Validates that any %{MSG_KEY} references in the message refer to keys of\n * the Msg string table.\n *\n * @param message Text which might contain string table references.\n * @returns True if all message references have matching values.\n *     Otherwise, false.\n * @alias Blockly.utils.parsing.checkMessageReferences\n */\nexport function checkMessageReferences(message: string): boolean {\n  let validSoFar = true;\n\n  const msgTable = Msg;\n  // TODO (#1169): Implement support for other string tables,\n  // prefixes other than BKY_.\n  const m = message.match(/%{BKY_[A-Z]\\w*}/ig);\n  if (m) {\n    for (let i = 0; i < m.length; i++) {\n      const msgKey = m[i].toUpperCase();\n      if (msgTable[msgKey.slice(6, -1)] === undefined) {\n        console.warn('No message string for ' + m[i] + ' in ' + message);\n        validSoFar = false;  // Continue to report other errors.\n      }\n    }\n  }\n\n  return validSoFar;\n}\n\n/**\n * Parse a block colour from a number or string, as provided in a block\n * definition.\n *\n * @param colour HSV hue value (0 to 360), #RRGGBB string,\n *     or a message reference string pointing to one of those two values.\n * @returns An object containing the colour as\n *     a #RRGGBB string, and the hue if the input was an HSV hue value.\n * @throws {Error} If the colour cannot be parsed.\n * @alias Blockly.utils.parsing.parseBlockColour\n */\nexport function parseBlockColour(colour: number|\n                                 string): {hue: number|null, hex: string} {\n  const dereferenced =\n      typeof colour === 'string' ? replaceMessageReferences(colour) : colour;\n\n  const hue = Number(dereferenced);\n  if (!isNaN(hue) && 0 <= hue && hue <= 360) {\n    return {\n      hue: hue,\n      hex: colourUtils.hsvToHex(\n          hue, colourUtils.getHsvSaturation(), colourUtils.getHsvValue() * 255),\n    };\n  } else {\n    const hex = colourUtils.parse(dereferenced);\n    if (hex) {\n      // Only store hue if colour is set as a hue.\n      return {hue: null, hex: hex};\n    } else {\n      let errorMsg = 'Invalid colour: \"' + dereferenced + '\"';\n      if (colour !== dereferenced) {\n        errorMsg += ' (from \"' + colour + '\")';\n      }\n      throw Error(errorMsg);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A div that floats on top of Blockly.  This singleton contains\n *     temporary HTML UI widgets that the user is currently interacting with.\n *     E.g. text input areas, colour pickers, context menus.\n *\n * @namespace Blockly.WidgetDiv\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.WidgetDiv');\n\nimport * as common from './common.js';\nimport * as dom from './utils/dom.js';\nimport type {Rect} from './utils/rect.js';\nimport type {Size} from './utils/size.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/** The object currently using this container. */\nlet owner: unknown = null;\n\n/** Optional cleanup function set by whichever object uses the widget. */\nlet dispose: (() => void)|null = null;\n\n/** A class name representing the current owner's workspace renderer. */\nlet rendererClassName = '';\n\n/** A class name representing the current owner's workspace theme. */\nlet themeClassName = '';\n\n/** The HTML container for popup overlays (e.g. editor widgets). */\nlet containerDiv: HTMLDivElement|null;\n\n/**\n * Returns the HTML container for editor widgets.\n *\n * @returns The editor widget container.\n * @alias Blockly.WidgetDiv.getDiv\n */\nexport function getDiv(): HTMLDivElement|null {\n  return containerDiv;\n}\n\n/**\n * Allows unit tests to reset the div. Do not use outside of tests.\n *\n * @param newDiv The new value for the DIV field.\n * @alias Blockly.WidgetDiv.testOnly_setDiv\n * @internal\n */\nexport function testOnly_setDiv(newDiv: HTMLDivElement|null) {\n  containerDiv = newDiv;\n}\n\n/**\n * Create the widget div and inject it onto the page.\n *\n * @alias Blockly.WidgetDiv.createDom\n */\nexport function createDom() {\n  if (containerDiv) {\n    return;  // Already created.\n  }\n\n  containerDiv = document.createElement('div') as HTMLDivElement;\n  containerDiv.className = 'blocklyWidgetDiv';\n  const container = common.getParentContainer() || document.body;\n  container.appendChild(containerDiv);\n}\n\n/**\n * Initialize and display the widget div.  Close the old one if needed.\n *\n * @param newOwner The object that will be using this container.\n * @param rtl Right-to-left (true) or left-to-right (false).\n * @param newDispose Optional cleanup function to be run when the widget is\n *     closed.\n * @alias Blockly.WidgetDiv.show\n */\nexport function show(newOwner: unknown, rtl: boolean, newDispose: () => void) {\n  hide();\n  owner = newOwner;\n  dispose = newDispose;\n  const div = containerDiv;\n  if (!div) return;\n  div.style.direction = rtl ? 'rtl' : 'ltr';\n  div.style.display = 'block';\n  const mainWorkspace = common.getMainWorkspace() as WorkspaceSvg;\n  rendererClassName = mainWorkspace.getRenderer().getClassName();\n  themeClassName = mainWorkspace.getTheme().getClassName();\n  dom.addClass(div, rendererClassName);\n  dom.addClass(div, themeClassName);\n}\n\n/**\n * Destroy the widget and hide the div.\n *\n * @alias Blockly.WidgetDiv.hide\n */\nexport function hide() {\n  if (!isVisible()) {\n    return;\n  }\n  owner = null;\n\n  const div = containerDiv;\n  if (!div) return;\n  div.style.display = 'none';\n  div.style.left = '';\n  div.style.top = '';\n  dispose && dispose();\n  dispose = null;\n  div.textContent = '';\n\n  if (rendererClassName) {\n    dom.removeClass(div, rendererClassName);\n    rendererClassName = '';\n  }\n  if (themeClassName) {\n    dom.removeClass(div, themeClassName);\n    themeClassName = '';\n  }\n  (common.getMainWorkspace() as WorkspaceSvg).markFocused();\n}\n\n/**\n * Is the container visible?\n *\n * @returns True if visible.\n * @alias Blockly.WidgetDiv.isVisible\n */\nexport function isVisible(): boolean {\n  return !!owner;\n}\n\n/**\n * Destroy the widget and hide the div if it is being used by the specified\n * object.\n *\n * @param oldOwner The object that was using this container.\n * @alias Blockly.WidgetDiv.hideIfOwner\n */\nexport function hideIfOwner(oldOwner: unknown) {\n  if (owner === oldOwner) {\n    hide();\n  }\n}\n/**\n * Set the widget div's position and height.  This function does nothing clever:\n * it will not ensure that your widget div ends up in the visible window.\n *\n * @param x Horizontal location (window coordinates, not body).\n * @param y Vertical location (window coordinates, not body).\n * @param height The height of the widget div (pixels).\n */\nfunction positionInternal(x: number, y: number, height: number) {\n  containerDiv!.style.left = x + 'px';\n  containerDiv!.style.top = y + 'px';\n  containerDiv!.style.height = height + 'px';\n}\n\n/**\n * Position the widget div based on an anchor rectangle.\n * The widget should be placed adjacent to but not overlapping the anchor\n * rectangle.  The preferred position is directly below and aligned to the left\n * (LTR) or right (RTL) side of the anchor.\n *\n * @param viewportBBox The bounding rectangle of the current viewport, in window\n *     coordinates.\n * @param anchorBBox The bounding rectangle of the anchor, in window\n *     coordinates.\n * @param widgetSize The size of the widget that is inside the widget div, in\n *     window coordinates.\n * @param rtl Whether the workspace is in RTL mode.  This determines horizontal\n *     alignment.\n * @alias Blockly.WidgetDiv.positionWithAnchor\n * @internal\n */\nexport function positionWithAnchor(\n    viewportBBox: Rect, anchorBBox: Rect, widgetSize: Size, rtl: boolean) {\n  const y = calculateY(viewportBBox, anchorBBox, widgetSize);\n  const x = calculateX(viewportBBox, anchorBBox, widgetSize, rtl);\n\n  if (y < 0) {\n    positionInternal(x, 0, widgetSize.height + y);\n  } else {\n    positionInternal(x, y, widgetSize.height);\n  }\n}\n\n/**\n * Calculate an x position (in window coordinates) such that the widget will not\n * be offscreen on the right or left.\n *\n * @param viewportBBox The bounding rectangle of the current viewport, in window\n *     coordinates.\n * @param anchorBBox The bounding rectangle of the anchor, in window\n *     coordinates.\n * @param widgetSize The dimensions of the widget inside the widget div.\n * @param rtl Whether the Blockly workspace is in RTL mode.\n * @returns A valid x-coordinate for the top left corner of the widget div, in\n *     window coordinates.\n */\nfunction calculateX(\n    viewportBBox: Rect, anchorBBox: Rect, widgetSize: Size,\n    rtl: boolean): number {\n  if (rtl) {\n    // Try to align the right side of the field and the right side of widget.\n    const widgetLeft = anchorBBox.right - widgetSize.width;\n    // Don't go offscreen left.\n    const x = Math.max(widgetLeft, viewportBBox.left);\n    // But really don't go offscreen right:\n    return Math.min(x, viewportBBox.right - widgetSize.width);\n  } else {\n    // Try to align the left side of the field and the left side of widget.\n    // Don't go offscreen right.\n    const x = Math.min(anchorBBox.left, viewportBBox.right - widgetSize.width);\n    // But left is more important, because that's where the text is.\n    return Math.max(x, viewportBBox.left);\n  }\n}\n\n/**\n * Calculate a y position (in window coordinates) such that the widget will not\n * be offscreen on the top or bottom.\n *\n * @param viewportBBox The bounding rectangle of the current viewport, in window\n *     coordinates.\n * @param anchorBBox The bounding rectangle of the anchor, in window\n *     coordinates.\n * @param widgetSize The dimensions of the widget inside the widget div.\n * @returns A valid y-coordinate for the top left corner of the widget div, in\n *     window coordinates.\n */\nfunction calculateY(\n    viewportBBox: Rect, anchorBBox: Rect, widgetSize: Size): number {\n  // Flip the widget vertically if off the bottom.\n  // The widget could go off the top of the window, but it would also go off\n  // the bottom.  The window is just too small.\n  if (anchorBBox.bottom + widgetSize.height >= viewportBBox.bottom) {\n    // The bottom of the widget is at the top of the field.\n    return anchorBBox.top - widgetSize.height;\n  } else {\n    // The top of the widget is at the bottom of the field.\n    return anchorBBox.bottom;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Fields can be created based on a JSON definition. This file\n *    contains methods for registering those JSON definitions, and building the\n *    fields based on JSON.\n *\n * @namespace Blockly.fieldRegistry\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.fieldRegistry');\n\nimport type {Field} from './field.js';\nimport type {IRegistrableField} from './interfaces/i_registrable_field.js';\nimport * as registry from './registry.js';\n\n\n/**\n * Registers a field type.\n * fieldRegistry.fromJson uses this registry to\n * find the appropriate field type.\n *\n * @param type The field type name as used in the JSON definition.\n * @param fieldClass The field class containing a fromJson function that can\n *     construct an instance of the field.\n * @throws {Error} if the type name is empty, the field is already registered,\n *     or the fieldClass is not an object containing a fromJson function.\n * @alias Blockly.fieldRegistry.register\n */\nexport function register(type: string, fieldClass: IRegistrableField) {\n  registry.register(registry.Type.FIELD, type, fieldClass);\n}\n\n/**\n * Unregisters the field registered with the given type.\n *\n * @param type The field type name as used in the JSON definition.\n * @alias Blockly.fieldRegistry.unregister\n */\nexport function unregister(type: string) {\n  registry.unregister(registry.Type.FIELD, type);\n}\n\n/**\n * Construct a Field from a JSON arg object.\n * Finds the appropriate registered field by the type name as registered using\n * fieldRegistry.register.\n *\n * @param options A JSON object with a type and options specific to the field\n *     type.\n * @returns The new field instance or null if a field wasn't found with the\n *     given type name\n * @alias Blockly.fieldRegistry.fromJson\n * @internal\n */\nexport function fromJson(options: AnyDuringMigration): Field|null {\n  return TEST_ONLY.fromJsonInternal(options);\n}\n\n/**\n * Private version of fromJson for stubbing in tests.\n *\n * @param options\n */\nfunction fromJsonInternal(options: AnyDuringMigration): Field|null {\n  const fieldObject =\n      registry.getObject(registry.Type.FIELD, options['type']) as\n          IRegistrableField |\n      null;\n  if (!fieldObject) {\n    console.warn(\n        'Blockly could not create a field of type ' + options['type'] +\n        '. The field is probably not being registered. This could be because' +\n        ' the file is not loaded, the field does not register itself (Issue' +\n        ' #1584), or the registration is not being reached.');\n    return null;\n  }\n  return fieldObject.fromJson(options);\n}\n\nexport const TEST_ONLY = {\n  fromJsonInternal,\n};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * ARIA-related constants and utilities.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @namespace Blockly.utils.aria\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.aria');\n\n\n/** ARIA states/properties prefix. */\nconst ARIA_PREFIX = 'aria-';\n\n/** ARIA role attribute. */\nconst ROLE_ATTRIBUTE = 'role';\n\n/**\n * ARIA role values.\n * Copied from Closure's goog.a11y.aria.Role\n *\n * @alias Blockly.utils.aria.Role\n */\nexport enum Role {\n  // ARIA role for an interactive control of tabular data.\n  GRID = 'grid',\n\n  // ARIA role for a cell in a grid.\n  GRIDCELL = 'gridcell',\n  // ARIA role for a group of related elements like tree item siblings.\n  GROUP = 'group',\n\n  // ARIA role for a listbox.\n  LISTBOX = 'listbox',\n\n  // ARIA role for a popup menu.\n  MENU = 'menu',\n\n  // ARIA role for menu item elements.\n  MENUITEM = 'menuitem',\n  // ARIA role for a checkbox box element inside a menu.\n  MENUITEMCHECKBOX = 'menuitemcheckbox',\n  // ARIA role for option items that are  children of combobox, listbox, menu,\n  // radiogroup, or tree elements.\n  OPTION = 'option',\n  // ARIA role for ignorable cosmetic elements with no semantic significance.\n  PRESENTATION = 'presentation',\n\n  // ARIA role for a row of cells in a grid.\n  ROW = 'row',\n  // ARIA role for a tree.\n  TREE = 'tree',\n\n  // ARIA role for a tree item that sometimes may be expanded or collapsed.\n  TREEITEM = 'treeitem'\n}\n\n/**\n * ARIA states and properties.\n * Copied from Closure's goog.a11y.aria.State\n *\n * @alias Blockly.utils.aria.State\n */\nexport enum State {\n  // ARIA property for setting the currently active descendant of an element,\n  // for example the selected item in a list box. Value: ID of an element.\n  ACTIVEDESCENDANT = 'activedescendant',\n  // ARIA property defines the total number of columns in a table, grid, or\n  // treegrid.\n  // Value: integer.\n  COLCOUNT = 'colcount',\n  // ARIA state for a disabled item. Value: one of {true, false}.\n  DISABLED = 'disabled',\n\n  // ARIA state for setting whether the element like a tree node is expanded.\n  // Value: one of {true, false, undefined}.\n  EXPANDED = 'expanded',\n\n  // ARIA state indicating that the entered value does not conform. Value:\n  // one of {false, true, 'grammar', 'spelling'}\n  INVALID = 'invalid',\n\n  // ARIA property that provides a label to override any other text, value, or\n  // contents used to describe this element. Value: string.\n  LABEL = 'label',\n  // ARIA property for setting the element which labels another element.\n  // Value: space-separated IDs of elements.\n  LABELLEDBY = 'labelledby',\n\n  // ARIA property for setting the level of an element in the hierarchy.\n  // Value: integer.\n  LEVEL = 'level',\n  // ARIA property indicating if the element is horizontal or vertical.\n  // Value: one of {'vertical', 'horizontal'}.\n  ORIENTATION = 'orientation',\n\n  // ARIA property that defines an element's number of position in a list.\n  // Value: integer.\n  POSINSET = 'posinset',\n\n  // ARIA property defines the total number of rows in a table, grid, or\n  // treegrid.\n  // Value: integer.\n  ROWCOUNT = 'rowcount',\n\n  // ARIA state for setting the currently selected item in the list.\n  // Value: one of {true, false, undefined}.\n  SELECTED = 'selected',\n  // ARIA property defining the number of items in a list. Value: integer.\n  SETSIZE = 'setsize',\n\n  // ARIA property for slider maximum value. Value: number.\n  VALUEMAX = 'valuemax',\n\n  // ARIA property for slider minimum value. Value: number.\n  VALUEMIN = 'valuemin'\n}\n\n/**\n * Sets the role of an element.\n *\n * Similar to Closure's goog.a11y.aria\n *\n * @param element DOM node to set role of.\n * @param roleName Role name.\n * @alias Blockly.utils.aria.setRole\n */\nexport function setRole(element: Element, roleName: Role) {\n  element.setAttribute(ROLE_ATTRIBUTE, roleName);\n}\n\n/**\n * Sets the state or property of an element.\n * Copied from Closure's goog.a11y.aria\n *\n * @param element DOM node where we set state.\n * @param stateName State attribute being set.\n *     Automatically adds prefix 'aria-' to the state name if the attribute is\n * not an extra attribute.\n * @param value Value for the state attribute.\n * @alias Blockly.utils.aria.setState\n */\nexport function setState(\n    element: Element, stateName: State, value: string|boolean|number|string[]) {\n  if (Array.isArray(value)) {\n    value = value.join(' ');\n  }\n  const attrStateName = ARIA_PREFIX + stateName;\n  element.setAttribute(attrStateName, `${value}`);\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Dropdown input field.  Used for editable titles and variables.\n * In the interests of a consistent UI, the toolbox shares some functions and\n * properties with the context menu.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldDropdown');\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {FieldConfig, Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {Menu} from './menu.js';\nimport {MenuItem} from './menuitem.js';\nimport * as aria from './utils/aria.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport type {Sentinel} from './utils/sentinel.js';\nimport * as utilsString from './utils/string.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\n\n\n/**\n * Class for an editable dropdown field.\n *\n * @alias Blockly.FieldDropdown\n */\nexport class FieldDropdown extends Field {\n  /** Horizontal distance that a checkmark overhangs the dropdown. */\n  static CHECKMARK_OVERHANG = 25;\n\n  /**\n   * Maximum height of the dropdown menu, as a percentage of the viewport\n   * height.\n   */\n  static MAX_MENU_HEIGHT_VH = 0.45;\n  static ARROW_CHAR: AnyDuringMigration;\n\n  /** A reference to the currently selected menu item. */\n  private selectedMenuItem_: MenuItem|null = null;\n\n  /** The dropdown menu. */\n  protected menu_: Menu|null = null;\n\n  /**\n   * SVG image element if currently selected option is an image, or null.\n   */\n  private imageElement_: SVGImageElement|null = null;\n\n  /** Tspan based arrow element. */\n  private arrow_: SVGTSpanElement|null = null;\n\n  /** SVG based arrow element. */\n  private svgArrow_: SVGElement|null = null;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /** Mouse cursor style when over the hotspot that initiates the editor. */\n  override CURSOR = 'default';\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  protected menuGenerator_!: AnyDuringMigration[][]|\n      ((this: FieldDropdown) => AnyDuringMigration[][]);\n\n  /** A cache of the most recently generated options. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'string[][]'.\n  private generatedOptions_: string[][] = null as AnyDuringMigration;\n\n  /**\n   * The prefix field label, of common words set after options are trimmed.\n   *\n   * @internal\n   */\n  override prefixField: string|null = null;\n\n  /**\n   * The suffix field label, of common words set after options are trimmed.\n   *\n   * @internal\n   */\n  override suffixField: string|null = null;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  private selectedOption_!: Array<string|ImageProperties>;\n  override clickTarget_: AnyDuringMigration;\n\n  /**\n   * @param menuGenerator A non-empty array of options for a dropdown list, or a\n   *     function which generates these options. Also accepts Field.SKIP_SETUP\n   *     if you wish to skip setup (only used by subclasses that want to handle\n   *     configuration and setting the field value after their own constructors\n   *     have run).\n   * @param opt_validator A function that is called to validate changes to the\n   *     field's value. Takes in a language-neutral dropdown option & returns a\n   *     validated language-neutral dropdown option, or null to abort the\n   *     change.\n   * @param opt_config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/dropdown#creation}\n   * for a list of properties this parameter supports.\n   * @throws {TypeError} If `menuGenerator` options are incorrectly structured.\n   */\n  constructor(\n      menuGenerator: AnyDuringMigration[][]|Function|Sentinel,\n      opt_validator?: Function, opt_config?: FieldConfig) {\n    super(Field.SKIP_SETUP);\n\n    // If we pass SKIP_SETUP, don't do *anything* with the menu generator.\n    if (menuGenerator === Field.SKIP_SETUP) {\n      return;\n    }\n\n    if (Array.isArray(menuGenerator)) {\n      validateOptions(menuGenerator);\n    }\n\n    /**\n     * An array of options for a dropdown list,\n     * or a function which generates these options.\n     */\n    this.menuGenerator_ = menuGenerator as AnyDuringMigration[][] |\n        ((this: FieldDropdown) => AnyDuringMigration[][]);\n\n    this.trimOptions_();\n\n    /**\n     * The currently selected option. The field is initialized with the\n     * first option selected.\n     */\n    this.selectedOption_ = this.getOptions(false)[0];\n\n    if (opt_config) {\n      this.configure_(opt_config);\n    }\n    this.setValue(this.selectedOption_[1]);\n    if (opt_validator) {\n      this.setValidator(opt_validator);\n    }\n  }\n\n  /**\n   * Sets the field's value based on the given XML element. Should only be\n   * called by Blockly.Xml.\n   *\n   * @param fieldElement The element containing info about the field's state.\n   * @internal\n   */\n  override fromXml(fieldElement: Element) {\n    if (this.isOptionListDynamic()) {\n      this.getOptions(false);\n    }\n    this.setValue(fieldElement.textContent);\n  }\n\n  /**\n   * Sets the field's value based on the given state.\n   *\n   * @param state The state to apply to the dropdown field.\n   * @internal\n   */\n  override loadState(state: AnyDuringMigration) {\n    if (this.loadLegacyState(FieldDropdown, state)) {\n      return;\n    }\n    if (this.isOptionListDynamic()) {\n      this.getOptions(false);\n    }\n    this.setValue(state);\n  }\n\n  /**\n   * Create the block UI for this dropdown.\n   *\n   * @internal\n   */\n  override initView() {\n    if (this.shouldAddBorderRect_()) {\n      this.createBorderRect_();\n    } else {\n      this.clickTarget_ = (this.sourceBlock_ as BlockSvg).getSvgRoot();\n    }\n    this.createTextElement_();\n\n    this.imageElement_ = dom.createSvgElement(Svg.IMAGE, {}, this.fieldGroup_);\n\n    if (this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW) {\n      this.createSVGArrow_();\n    } else {\n      this.createTextArrow_();\n    }\n\n    if (this.borderRect_) {\n      dom.addClass(this.borderRect_, 'blocklyDropdownRect');\n    }\n  }\n\n  /**\n   * Whether or not the dropdown should add a border rect.\n   *\n   * @returns True if the dropdown field should add a border rect.\n   */\n  protected shouldAddBorderRect_(): boolean {\n    return !this.getConstants()!.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW ||\n        this.getConstants()!.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW &&\n        !this.sourceBlock_.isShadow();\n  }\n\n  /** Create a tspan based arrow. */\n  protected createTextArrow_() {\n    this.arrow_ = dom.createSvgElement(Svg.TSPAN, {}, this.textElement_);\n    this.arrow_!.appendChild(document.createTextNode(\n        this.sourceBlock_.RTL ? FieldDropdown.ARROW_CHAR + ' ' :\n                                ' ' + FieldDropdown.ARROW_CHAR));\n    if (this.sourceBlock_.RTL) {\n      // AnyDuringMigration because:  Argument of type 'SVGTSpanElement | null'\n      // is not assignable to parameter of type 'Node'.\n      this.textElement_.insertBefore(\n          this.arrow_ as AnyDuringMigration, this.textContent_);\n    } else {\n      // AnyDuringMigration because:  Argument of type 'SVGTSpanElement | null'\n      // is not assignable to parameter of type 'Node'.\n      this.textElement_.appendChild(this.arrow_ as AnyDuringMigration);\n    }\n  }\n\n  /** Create an SVG based arrow. */\n  protected createSVGArrow_() {\n    this.svgArrow_ = dom.createSvgElement(\n        Svg.IMAGE, {\n          'height': this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE + 'px',\n          'width': this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE + 'px',\n        },\n        this.fieldGroup_);\n    this.svgArrow_!.setAttributeNS(\n        dom.XLINK_NS, 'xlink:href',\n        this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_DATAURI);\n  }\n\n  /**\n   * Create a dropdown menu under the text.\n   *\n   * @param opt_e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   */\n  protected override showEditor_(opt_e?: Event) {\n    this.dropdownCreate_();\n    // AnyDuringMigration because:  Property 'clientX' does not exist on type\n    // 'Event'.\n    if (opt_e && typeof (opt_e as AnyDuringMigration).clientX === 'number') {\n      // AnyDuringMigration because:  Property 'clientY' does not exist on type\n      // 'Event'. AnyDuringMigration because:  Property 'clientX' does not exist\n      // on type 'Event'.\n      this.menu_!.openingCoords = new Coordinate(\n          (opt_e as AnyDuringMigration).clientX,\n          (opt_e as AnyDuringMigration).clientY);\n    } else {\n      this.menu_!.openingCoords = null;\n    }\n\n    // Remove any pre-existing elements in the dropdown.\n    dropDownDiv.clearContent();\n    // Element gets created in render.\n    this.menu_!.render(dropDownDiv.getContentDiv());\n    const menuElement = this.menu_!.getElement() as Element;\n    dom.addClass(menuElement, 'blocklyDropdownMenu');\n\n    if (this.getConstants()!.FIELD_DROPDOWN_COLOURED_DIV) {\n      const primaryColour = this.sourceBlock_.isShadow() ?\n          this.sourceBlock_.getParent()!.getColour() :\n          this.sourceBlock_.getColour();\n      const borderColour = this.sourceBlock_.isShadow() ?\n          (this.sourceBlock_.getParent() as BlockSvg).style.colourTertiary :\n          (this.sourceBlock_ as BlockSvg).style.colourTertiary;\n      dropDownDiv.setColour(primaryColour, borderColour);\n    }\n\n    dropDownDiv.showPositionedByField(this, this.dropdownDispose_.bind(this));\n\n    // Focusing needs to be handled after the menu is rendered and positioned.\n    // Otherwise it will cause a page scroll to get the misplaced menu in\n    // view. See issue #1329.\n    this.menu_!.focus();\n\n    if (this.selectedMenuItem_) {\n      this.menu_!.setHighlighted(this.selectedMenuItem_);\n    }\n\n    this.applyColour();\n  }\n\n  /** Create the dropdown editor. */\n  private dropdownCreate_() {\n    const menu = new Menu();\n    menu.setRole(aria.Role.LISTBOX);\n    this.menu_ = menu;\n\n    const options = this.getOptions(false);\n    this.selectedMenuItem_ = null;\n    for (let i = 0; i < options.length; i++) {\n      let content = options[i][0];  // Human-readable text or image.\n      const value = options[i][1];  // Language-neutral value.\n      if (typeof content === 'object') {\n        // An image, not text.\n        const image = new Image(content['width'], content['height']);\n        image.src = content['src'];\n        image.alt = content['alt'] || '';\n        content = image;\n      }\n      const menuItem = new MenuItem(content, value);\n      menuItem.setRole(aria.Role.OPTION);\n      menuItem.setRightToLeft(this.sourceBlock_.RTL);\n      menuItem.setCheckable(true);\n      menu.addChild(menuItem);\n      menuItem.setChecked(value === this.value_);\n      if (value === this.value_) {\n        this.selectedMenuItem_ = menuItem;\n      }\n      menuItem.onAction(this.handleMenuActionEvent_, this);\n    }\n  }\n\n  /**\n   * Disposes of events and DOM-references belonging to the dropdown editor.\n   */\n  private dropdownDispose_() {\n    if (this.menu_) {\n      this.menu_.dispose();\n    }\n    this.menu_ = null;\n    this.selectedMenuItem_ = null;\n    this.applyColour();\n  }\n\n  /**\n   * Handle an action in the dropdown menu.\n   *\n   * @param menuItem The MenuItem selected within menu.\n   */\n  private handleMenuActionEvent_(menuItem: MenuItem) {\n    dropDownDiv.hideIfOwner(this, true);\n    this.onItemSelected_(this.menu_ as Menu, menuItem);\n  }\n\n  /**\n   * Handle the selection of an item in the dropdown menu.\n   *\n   * @param menu The Menu component clicked.\n   * @param menuItem The MenuItem selected within menu.\n   */\n  protected onItemSelected_(menu: Menu, menuItem: MenuItem) {\n    this.setValue(menuItem.getValue());\n  }\n\n  /**\n   * Factor out common words in statically defined options.\n   * Create prefix and/or suffix labels.\n   */\n  private trimOptions_() {\n    const options = this.menuGenerator_;\n    if (!Array.isArray(options)) {\n      return;\n    }\n    let hasImages = false;\n\n    // Localize label text and image alt text.\n    for (let i = 0; i < options.length; i++) {\n      const label = options[i][0];\n      if (typeof label === 'string') {\n        options[i][0] = parsing.replaceMessageReferences(label);\n      } else {\n        if (label.alt !== null) {\n          options[i][0].alt = parsing.replaceMessageReferences(label.alt);\n        }\n        hasImages = true;\n      }\n    }\n    if (hasImages || options.length < 2) {\n      return;  // Do nothing if too few items or at least one label is an image.\n    }\n    const strings = [];\n    for (let i = 0; i < options.length; i++) {\n      strings.push(options[i][0]);\n    }\n    const shortest = utilsString.shortestStringLength(strings);\n    const prefixLength = utilsString.commonWordPrefix(strings, shortest);\n    const suffixLength = utilsString.commonWordSuffix(strings, shortest);\n    if (!prefixLength && !suffixLength) {\n      return;\n    }\n    if (shortest <= prefixLength + suffixLength) {\n      // One or more strings will entirely vanish if we proceed.  Abort.\n      return;\n    }\n    if (prefixLength) {\n      this.prefixField = strings[0].substring(0, prefixLength - 1);\n    }\n    if (suffixLength) {\n      this.suffixField = strings[0].substr(1 - suffixLength);\n    }\n\n    this.menuGenerator_ =\n        FieldDropdown.applyTrim_(options, prefixLength, suffixLength);\n  }\n\n  /**\n   * @returns True if the option list is generated by a function.\n   *     Otherwise false.\n   */\n  isOptionListDynamic(): boolean {\n    return typeof this.menuGenerator_ === 'function';\n  }\n\n  /**\n   * Return a list of the options for this dropdown.\n   *\n   * @param opt_useCache For dynamic options, whether or not to use the cached\n   *     options or to re-generate them.\n   * @returns A non-empty array of option tuples:\n   *     (human-readable text or image, language-neutral name).\n   * @throws {TypeError} If generated options are incorrectly structured.\n   */\n  getOptions(opt_useCache?: boolean): AnyDuringMigration[][] {\n    if (this.isOptionListDynamic()) {\n      if (!this.generatedOptions_ || !opt_useCache) {\n        // AnyDuringMigration because:  Property 'call' does not exist on type\n        // 'any[][] | ((this: FieldDropdown) => any[][])'.\n        this.generatedOptions_ =\n            (this.menuGenerator_ as AnyDuringMigration).call(this);\n        validateOptions(this.generatedOptions_);\n      }\n      return this.generatedOptions_;\n    }\n    return this.menuGenerator_ as string[][];\n  }\n\n  /**\n   * Ensure that the input value is a valid language-neutral option.\n   *\n   * @param opt_newValue The input value.\n   * @returns A valid language-neutral option, or null if invalid.\n   */\n  protected override doClassValidation_(opt_newValue?: AnyDuringMigration):\n      string|null {\n    let isValueValid = false;\n    const options = this.getOptions(true);\n    for (let i = 0, option; option = options[i]; i++) {\n      // Options are tuples of human-readable text and language-neutral values.\n      if (option[1] === opt_newValue) {\n        isValueValid = true;\n        break;\n      }\n    }\n    if (!isValueValid) {\n      if (this.sourceBlock_) {\n        console.warn(\n            'Cannot set the dropdown\\'s value to an unavailable option.' +\n            ' Block type: ' + this.sourceBlock_.type +\n            ', Field name: ' + this.name + ', Value: ' + opt_newValue);\n      }\n      return null;\n    }\n    return opt_newValue as string;\n  }\n\n  /**\n   * Update the value of this dropdown field.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is one of the valid dropdown options.\n   */\n  protected override doValueUpdate_(newValue: AnyDuringMigration) {\n    super.doValueUpdate_(newValue);\n    const options = this.getOptions(true);\n    for (let i = 0, option; option = options[i]; i++) {\n      if (option[1] === this.value_) {\n        this.selectedOption_ = option;\n      }\n    }\n  }\n\n  /**\n   * Updates the dropdown arrow to match the colour/style of the block.\n   *\n   * @internal\n   */\n  override applyColour() {\n    const style = (this.sourceBlock_ as BlockSvg).style;\n    if (this.borderRect_) {\n      this.borderRect_.setAttribute('stroke', style.colourTertiary);\n      if (this.menu_) {\n        this.borderRect_.setAttribute('fill', style.colourTertiary);\n      } else {\n        this.borderRect_.setAttribute('fill', 'transparent');\n      }\n    }\n    // Update arrow's colour.\n    if (this.sourceBlock_ && this.arrow_) {\n      if (this.sourceBlock_.isShadow()) {\n        this.arrow_.style.fill = style.colourSecondary;\n      } else {\n        this.arrow_.style.fill = style.colourPrimary;\n      }\n    }\n  }\n\n  /** Draws the border with the correct width. */\n  protected override render_() {\n    // Hide both elements.\n    this.textContent_.nodeValue = '';\n    this.imageElement_!.style.display = 'none';\n\n    // Show correct element.\n    const option = this.selectedOption_ && this.selectedOption_[0];\n    if (option && typeof option === 'object') {\n      this.renderSelectedImage_((option));\n    } else {\n      this.renderSelectedText_();\n    }\n\n    this.positionBorderRect_();\n  }\n\n  /**\n   * Renders the selected option, which must be an image.\n   *\n   * @param imageJson Selected option that must be an image.\n   */\n  private renderSelectedImage_(imageJson: ImageProperties) {\n    this.imageElement_!.style.display = '';\n    this.imageElement_!.setAttributeNS(\n        dom.XLINK_NS, 'xlink:href', imageJson.src);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.imageElement_!.setAttribute(\n        'height', imageJson.height as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.imageElement_!.setAttribute(\n        'width', imageJson.width as AnyDuringMigration);\n\n    const imageHeight = Number(imageJson.height);\n    const imageWidth = Number(imageJson.width);\n\n    // Height and width include the border rect.\n    const hasBorder = !!this.borderRect_;\n    const height = Math.max(\n        hasBorder ? this.getConstants()!.FIELD_DROPDOWN_BORDER_RECT_HEIGHT : 0,\n        imageHeight + IMAGE_Y_PADDING);\n    const xPadding =\n        hasBorder ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING : 0;\n    let arrowWidth = 0;\n    if (this.svgArrow_) {\n      arrowWidth = this.positionSVGArrow_(\n          imageWidth + xPadding,\n          height / 2 - this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE / 2);\n    } else {\n      arrowWidth = dom.getFastTextWidth(\n          this.arrow_ as SVGTSpanElement,\n          this.getConstants()!.FIELD_TEXT_FONTSIZE,\n          this.getConstants()!.FIELD_TEXT_FONTWEIGHT,\n          this.getConstants()!.FIELD_TEXT_FONTFAMILY);\n    }\n    this.size_.width = imageWidth + arrowWidth + xPadding * 2;\n    this.size_.height = height;\n\n    let arrowX = 0;\n    if (this.sourceBlock_.RTL) {\n      const imageX = xPadding + arrowWidth;\n      this.imageElement_!.setAttribute('x', imageX.toString());\n    } else {\n      arrowX = imageWidth + arrowWidth;\n      this.textElement_.setAttribute('text-anchor', 'end');\n      this.imageElement_!.setAttribute('x', xPadding.toString());\n    }\n    this.imageElement_!.setAttribute(\n        'y', (height / 2 - imageHeight / 2).toString());\n\n    this.positionTextElement_(arrowX + xPadding, imageWidth + arrowWidth);\n  }\n\n  /** Renders the selected option, which must be text. */\n  private renderSelectedText_() {\n    // Retrieves the selected option to display through getText_.\n    this.textContent_.nodeValue = this.getDisplayText_();\n    dom.addClass(this.textElement_ as Element, 'blocklyDropdownText');\n    this.textElement_.setAttribute('text-anchor', 'start');\n\n    // Height and width include the border rect.\n    const hasBorder = !!this.borderRect_;\n    const height = Math.max(\n        hasBorder ? this.getConstants()!.FIELD_DROPDOWN_BORDER_RECT_HEIGHT : 0,\n        this.getConstants()!.FIELD_TEXT_HEIGHT);\n    const textWidth = dom.getFastTextWidth(\n        this.textElement_, this.getConstants()!.FIELD_TEXT_FONTSIZE,\n        this.getConstants()!.FIELD_TEXT_FONTWEIGHT,\n        this.getConstants()!.FIELD_TEXT_FONTFAMILY);\n    const xPadding =\n        hasBorder ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING : 0;\n    let arrowWidth = 0;\n    if (this.svgArrow_) {\n      arrowWidth = this.positionSVGArrow_(\n          textWidth + xPadding,\n          height / 2 - this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE / 2);\n    }\n    this.size_.width = textWidth + arrowWidth + xPadding * 2;\n    this.size_.height = height;\n\n    this.positionTextElement_(xPadding, textWidth);\n  }\n\n  /**\n   * Position a drop-down arrow at the appropriate location at render-time.\n   *\n   * @param x X position the arrow is being rendered at, in px.\n   * @param y Y position the arrow is being rendered at, in px.\n   * @returns Amount of space the arrow is taking up, in px.\n   */\n  private positionSVGArrow_(x: number, y: number): number {\n    if (!this.svgArrow_) {\n      return 0;\n    }\n    const hasBorder = !!this.borderRect_;\n    const xPadding =\n        hasBorder ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING : 0;\n    const textPadding = this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_PADDING;\n    const svgArrowSize = this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE;\n    const arrowX = this.sourceBlock_.RTL ? xPadding : x + textPadding;\n    this.svgArrow_.setAttribute(\n        'transform', 'translate(' + arrowX + ',' + y + ')');\n    return svgArrowSize + textPadding;\n  }\n\n  /**\n   * Use the `getText_` developer hook to override the field's text\n   * representation.  Get the selected option text. If the selected option is an\n   * image we return the image alt text.\n   *\n   * @returns Selected option text.\n   */\n  protected override getText_(): string|null {\n    if (!this.selectedOption_) {\n      return null;\n    }\n    const option = this.selectedOption_[0];\n    if (typeof option === 'object') {\n      return option['alt'];\n    }\n    return option;\n  }\n\n  /**\n   * Construct a FieldDropdown from a JSON arg object.\n   *\n   * @param options A JSON object with options (options).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldDropdownFromJsonConfig): FieldDropdown {\n    if (!options.options) {\n      throw new Error(\n          'options are required for the dropdown field. The ' +\n          'options property must be assigned an array of ' +\n          '[humanReadableValue, languageNeutralValue] tuples.');\n    }\n    // `this` might be a subclass of FieldDropdown if that class doesn't\n    // override the static fromJson method.\n    return new this(options.options, undefined, options);\n  }\n\n  /**\n   * Use the calculated prefix and suffix lengths to trim all of the options in\n   * the given array.\n   *\n   * @param options Array of option tuples:\n   *     (human-readable text or image, language-neutral name).\n   * @param prefixLength The length of the common prefix.\n   * @param suffixLength The length of the common suffix\n   * @returns A new array with all of the option text trimmed.\n   */\n  static applyTrim_(\n      options: AnyDuringMigration[][], prefixLength: number,\n      suffixLength: number): AnyDuringMigration[][] {\n    const newOptions = [];\n    // Remove the prefix and suffix from the options.\n    for (let i = 0; i < options.length; i++) {\n      let text = options[i][0];\n      const value = options[i][1];\n      text = text.substring(prefixLength, text.length - suffixLength);\n      newOptions[i] = [text, value];\n    }\n    return newOptions;\n  }\n}\n\n/**\n * Definition of a human-readable image dropdown option.\n */\nexport interface ImageProperties {\n  src: string;\n  alt: string;\n  width: number;\n  height: number;\n}\n\n/**\n * An individual option in the dropdown menu. The first element is the human-\n * readable value (text or image), and the second element is the language-\n * neutral value.\n */\nexport type MenuOption = [string | ImageProperties, string];\n\n/**\n * fromJson config for the dropdown field.\n */\nexport interface FieldDropdownFromJsonConfig extends FieldConfig {\n  options?: MenuOption[];\n}\n\n/**\n * The y offset from the top of the field to the top of the image, if an image\n * is selected.\n */\nconst IMAGE_Y_OFFSET = 5;\n\n/** The total vertical padding above and below an image. */\nconst IMAGE_Y_PADDING: number = IMAGE_Y_OFFSET * 2;\n\n/** Android can't (in 2014) display \"\", so use \"\" instead. */\nFieldDropdown.ARROW_CHAR = userAgent.ANDROID ? '\\u25BC' : '\\u25BE';\n\n/**\n * Validates the data structure to be processed as an options list.\n *\n * @param options The proposed dropdown options.\n * @throws {TypeError} If proposed options are incorrectly structured.\n */\nfunction validateOptions(options: AnyDuringMigration) {\n  if (!Array.isArray(options)) {\n    throw TypeError('FieldDropdown options must be an array.');\n  }\n  if (!options.length) {\n    throw TypeError('FieldDropdown options must not be an empty array.');\n  }\n  let foundError = false;\n  for (let i = 0; i < options.length; i++) {\n    const tuple = options[i];\n    if (!Array.isArray(tuple)) {\n      foundError = true;\n      console.error(\n          'Invalid option[' + i + ']: Each FieldDropdown option must be an ' +\n              'array. Found: ',\n          tuple);\n    } else if (typeof tuple[1] !== 'string') {\n      foundError = true;\n      console.error(\n          'Invalid option[' + i + ']: Each FieldDropdown option id must be ' +\n              'a string. Found ' + tuple[1] + ' in: ',\n          tuple);\n    } else if (\n        tuple[0] && typeof tuple[0] !== 'string' &&\n        typeof tuple[0].src !== 'string') {\n      foundError = true;\n      console.error(\n          'Invalid option[' + i + ']: Each FieldDropdown option must have a ' +\n              'string label or image description. Found' + tuple[0] + ' in: ',\n          tuple);\n    }\n  }\n  if (foundError) {\n    throw TypeError('Found invalid FieldDropdown options.');\n  }\n}\n\nfieldRegistry.register('field_dropdown', FieldDropdown);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for objects.\n *\n * @namespace Blockly.utils.object\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.object');\n\nimport * as deprecation from './deprecation.js';\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * @param childCtor Child class.\n * @param parentCtor Parent class.\n * @suppress {strictMissingProperties} superClass_ is not defined on Function.\n * @alias Blockly.utils.object.inherits\n */\nexport function inherits(childCtor: Function, parentCtor: Function) {\n  deprecation.warn(\n      'Blockly.utils.object.inherits', 'version 9.0.0', 'version 10.0.0');\n  // Set a .superClass_ property so that methods can call parent methods\n  // without hard-coding the parent class name.\n  // Could be replaced by ES6's super().\n  // AnyDuringMigration because:  Property 'superClass_' does not exist on type\n  // 'Function'.\n  (childCtor as AnyDuringMigration).superClass_ = parentCtor.prototype;\n\n  // Link the child class to the parent class so that static methods inherit.\n  Object.setPrototypeOf(childCtor, parentCtor);\n\n  // Replace the child constructor's prototype object with an instance\n  // of the parent class.\n  childCtor.prototype = Object.create(parentCtor.prototype);\n  childCtor.prototype.constructor = childCtor;\n}\n// Alternatively, one could use this instead:\n// Object.setPrototypeOf(childCtor.prototype, parentCtor.prototype);\n\n/**\n * Copies all the members of a source object to a target object.\n *\n * @param target Target.\n * @param source Source.\n * @alias Blockly.utils.object.mixin\n */\nexport function mixin(target: AnyDuringMigration, source: AnyDuringMigration) {\n  deprecation.warn(\n      'Blockly.utils.object.mixin', 'May 2022', 'May 2023', 'Object.assign');\n  for (const x in source) {\n    target[x] = source[x];\n  }\n}\n\n/**\n * Complete a deep merge of all members of a source object with a target object.\n *\n * @param target Target.\n * @param source Source.\n * @returns The resulting object.\n * @alias Blockly.utils.object.deepMerge\n */\nexport function deepMerge(\n    target: AnyDuringMigration,\n    source: AnyDuringMigration): AnyDuringMigration {\n  for (const x in source) {\n    if (source[x] !== null && typeof source[x] === 'object') {\n      target[x] = deepMerge(target[x] || Object.create(null), source[x]);\n    } else {\n      target[x] = source[x];\n    }\n  }\n  return target;\n}\n\n/**\n * Returns an array of a given object's own enumerable property values.\n *\n * @param obj Object containing values.\n * @returns Array of values.\n * @alias Blockly.utils.object.values\n */\nexport function values(obj: AnyDuringMigration): AnyDuringMigration[] {\n  deprecation.warn(\n      'Blockly.utils.object.values', 'version 9.0.0', 'version 10.0.0',\n      'Object.values');\n  return Object.values(obj);\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility functions for the toolbox and flyout.\n *\n * @namespace Blockly.utils.toolbox\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.toolbox');\n\nimport type {ConnectionState} from '../serialization/blocks.js';\nimport type {CssConfig as CategoryCssConfig} from '../toolbox/category.js';\nimport type {CssConfig as SeparatorCssConfig} from '../toolbox/separator.js';\nimport * as Xml from '../xml.js';\n\n\n/**\n * The information needed to create a block in the toolbox.\n * Note that disabled has a different type for backwards compatibility.\n *\n * @alias Blockly.utils.toolbox.BlockInfo\n */\nexport interface BlockInfo {\n  kind: string;\n  blockxml?: string|Node;\n  type?: string;\n  gap?: string|number;\n  disabled?: string|boolean;\n  enabled?: boolean;\n  id?: string;\n  x?: number;\n  y?: number;\n  collapsed?: boolean;\n  inline?: boolean;\n  data?: string;\n  extraState?: AnyDuringMigration;\n  icons?: {[key: string]: AnyDuringMigration};\n  fields?: {[key: string]: AnyDuringMigration};\n  inputs?: {[key: string]: ConnectionState};\n  next?: ConnectionState;\n}\n\n/**\n * The information needed to create a separator in the toolbox.\n *\n * @alias Blockly.utils.toolbox.SeparatorInfo\n */\nexport interface SeparatorInfo {\n  kind: string;\n  id: string|undefined;\n  gap: number|undefined;\n  cssconfig: SeparatorCssConfig|undefined;\n}\n\n/**\n * The information needed to create a button in the toolbox.\n *\n * @alias Blockly.utils.toolbox.ButtonInfo\n */\nexport interface ButtonInfo {\n  kind: string;\n  text: string;\n  callbackkey: string;\n}\n\n/**\n * The information needed to create a label in the toolbox.\n *\n * @alias Blockly.utils.toolbox.LabelInfo\n */\nexport interface LabelInfo {\n  kind: string;\n  text: string;\n  id: string|undefined;\n}\n\n/**\n * The information needed to create either a button or a label in the flyout.\n *\n * @alias Blockly.utils.toolbox.ButtonOrLabelInfo\n */\nexport type ButtonOrLabelInfo = ButtonInfo|LabelInfo;\n\n/**\n * The information needed to create a category in the toolbox.\n *\n * @alias Blockly.utils.toolbox.StaticCategoryInfo\n */\nexport interface StaticCategoryInfo {\n  kind: string;\n  name: string;\n  contents: ToolboxItemInfo[];\n  id: string|undefined;\n  categorystyle: string|undefined;\n  colour: string|undefined;\n  cssconfig: CategoryCssConfig|undefined;\n  hidden: string|undefined;\n}\n\n/**\n * The information needed to create a custom category.\n *\n * @alias Blockly.utils.toolbox.DynamicCategoryInfo\n */\nexport interface DynamicCategoryInfo {\n  kind: string;\n  custom: string;\n  id: string|undefined;\n  categorystyle: string|undefined;\n  colour: string|undefined;\n  cssconfig: CategoryCssConfig|undefined;\n  hidden: string|undefined;\n}\n\n/**\n * The information needed to create either a dynamic or static category.\n *\n * @alias Blockly.utils.toolbox.CategoryInfo\n */\nexport type CategoryInfo = StaticCategoryInfo|DynamicCategoryInfo;\n\n/**\n * Any information that can be used to create an item in the toolbox.\n *\n * @alias Blockly.utils.toolbox.ToolboxItemInfo\n */\nexport type ToolboxItemInfo = FlyoutItemInfo|StaticCategoryInfo;\n\n/**\n * All the different types that can be displayed in a flyout.\n *\n * @alias Blockly.utils.toolbox.FlyoutItemInfo\n */\nexport type FlyoutItemInfo =\n    BlockInfo|SeparatorInfo|ButtonInfo|LabelInfo|DynamicCategoryInfo;\n\n/**\n * The JSON definition of a toolbox.\n *\n * @alias Blockly.utils.toolbox.ToolboxInfo\n */\nexport interface ToolboxInfo {\n  kind?: string;\n  contents: ToolboxItemInfo[];\n}\n\n/**\n * An array holding flyout items.\n *\n * @alias Blockly.utils.toolbox.FlyoutItemInfoArray\n */\nexport type FlyoutItemInfoArray = FlyoutItemInfo[];\n\n/**\n * All of the different types that can create a toolbox.\n *\n * @alias Blockly.utils.toolbox.ToolboxDefinition\n */\nexport type ToolboxDefinition = Node|ToolboxInfo|string;\n\n/**\n * All of the different types that can be used to show items in a flyout.\n *\n * @alias Blockly.utils.toolbox.FlyoutDefinition\n */\nexport type FlyoutDefinition = FlyoutItemInfoArray|NodeList|ToolboxInfo|Node[];\n\n/**\n * The name used to identify a toolbox that has category like items.\n * This only needs to be used if a toolbox wants to be treated like a category\n * toolbox but does not actually contain any toolbox items with the kind\n * 'category'.\n */\nconst CATEGORY_TOOLBOX_KIND = 'categoryToolbox';\n\n/**\n * The name used to identify a toolbox that has no categories and is displayed\n * as a simple flyout displaying blocks, buttons, or labels.\n */\nconst FLYOUT_TOOLBOX_KIND = 'flyoutToolbox';\n\n/**\n * Position of the toolbox and/or flyout relative to the workspace.\n *\n * @alias Blockly.utils.toolbox.Position\n */\nexport enum Position {\n  TOP,\n  BOTTOM,\n  LEFT,\n  RIGHT\n}\n\n/**\n * Converts the toolbox definition into toolbox JSON.\n *\n * @param toolboxDef The definition of the toolbox in one of its many forms.\n * @returns Object holding information for creating a toolbox.\n * @alias Blockly.utils.toolbox.convertToolboxDefToJson\n * @internal\n */\nexport function convertToolboxDefToJson(toolboxDef: ToolboxDefinition|\n                                        null): ToolboxInfo|null {\n  if (!toolboxDef) {\n    return null;\n  }\n\n  if (toolboxDef instanceof Element || typeof toolboxDef === 'string') {\n    toolboxDef = parseToolboxTree(toolboxDef);\n    // AnyDuringMigration because:  Argument of type 'Node | null' is not\n    // assignable to parameter of type 'Node'.\n    toolboxDef = convertToToolboxJson(toolboxDef as AnyDuringMigration);\n  }\n\n  const toolboxJson = toolboxDef as ToolboxInfo;\n  validateToolbox(toolboxJson);\n  return toolboxJson;\n}\n\n/**\n * Validates the toolbox JSON fields have been set correctly.\n *\n * @param toolboxJson Object holding information for creating a toolbox.\n * @throws {Error} if the toolbox is not the correct format.\n */\nfunction validateToolbox(toolboxJson: ToolboxInfo) {\n  const toolboxKind = toolboxJson['kind'];\n  const toolboxContents = toolboxJson['contents'];\n\n  if (toolboxKind) {\n    if (toolboxKind !== FLYOUT_TOOLBOX_KIND &&\n        toolboxKind !== CATEGORY_TOOLBOX_KIND) {\n      throw Error(\n          'Invalid toolbox kind ' + toolboxKind + '.' +\n          ' Please supply either ' + FLYOUT_TOOLBOX_KIND + ' or ' +\n          CATEGORY_TOOLBOX_KIND);\n    }\n  }\n  if (!toolboxContents) {\n    throw Error('Toolbox must have a contents attribute.');\n  }\n}\n\n/**\n * Converts the flyout definition into a list of flyout items.\n *\n * @param flyoutDef The definition of the flyout in one of its many forms.\n * @returns A list of flyout items.\n * @alias Blockly.utils.toolbox.convertFlyoutDefToJsonArray\n * @internal\n */\nexport function convertFlyoutDefToJsonArray(flyoutDef: FlyoutDefinition|\n                                            null): FlyoutItemInfoArray {\n  if (!flyoutDef) {\n    return [];\n  }\n\n  if ((flyoutDef as AnyDuringMigration)['contents']) {\n    return (flyoutDef as AnyDuringMigration)['contents'];\n  }\n  // If it is already in the correct format return the flyoutDef.\n  // AnyDuringMigration because:  Property 'nodeType' does not exist on type\n  // 'Node | FlyoutItemInfo'.\n  if (Array.isArray(flyoutDef) && flyoutDef.length > 0 &&\n      !((flyoutDef[0]) as AnyDuringMigration).nodeType) {\n    // AnyDuringMigration because:  Type 'FlyoutItemInfoArray | Node[]' is not\n    // assignable to type 'FlyoutItemInfoArray'.\n    return flyoutDef as AnyDuringMigration;\n  }\n\n  // AnyDuringMigration because:  Type 'ToolboxItemInfo[] | FlyoutItemInfoArray'\n  // is not assignable to type 'FlyoutItemInfoArray'.\n  return xmlToJsonArray(flyoutDef as Node[] | NodeList) as AnyDuringMigration;\n}\n\n/**\n * Whether or not the toolbox definition has categories.\n *\n * @param toolboxJson Object holding information for creating a toolbox.\n * @returns True if the toolbox has categories.\n * @alias Blockly.utils.toolbox.hasCategories\n * @internal\n */\nexport function hasCategories(toolboxJson: ToolboxInfo|null): boolean {\n  return TEST_ONLY.hasCategoriesInternal(toolboxJson);\n}\n\n/**\n * Private version of hasCategories for stubbing in tests.\n */\nfunction hasCategoriesInternal(toolboxJson: ToolboxInfo|null): boolean {\n  if (!toolboxJson) {\n    return false;\n  }\n\n  const toolboxKind = toolboxJson['kind'];\n  if (toolboxKind) {\n    return toolboxKind === CATEGORY_TOOLBOX_KIND;\n  }\n\n  const categories = toolboxJson['contents'].filter(function(item) {\n    return item['kind'].toUpperCase() === 'CATEGORY';\n  });\n  return !!categories.length;\n}\n\n/**\n * Whether or not the category is collapsible.\n *\n * @param categoryInfo Object holing information for creating a category.\n * @returns True if the category has subcategories.\n * @alias Blockly.utils.toolbox.isCategoryCollapsible\n * @internal\n */\nexport function isCategoryCollapsible(categoryInfo: CategoryInfo): boolean {\n  if (!categoryInfo || !(categoryInfo as AnyDuringMigration)['contents']) {\n    return false;\n  }\n\n  const categories =\n      (categoryInfo as AnyDuringMigration)['contents'].filter(function(\n          item: AnyDuringMigration) {\n        return item['kind'].toUpperCase() === 'CATEGORY';\n      });\n  return !!categories.length;\n}\n\n/**\n * Parses the provided toolbox definition into a consistent format.\n *\n * @param toolboxDef The definition of the toolbox in one of its many forms.\n * @returns Object holding information for creating a toolbox.\n */\nfunction convertToToolboxJson(toolboxDef: Node): ToolboxInfo {\n  const contents = xmlToJsonArray(toolboxDef as Node | Node[]);\n  const toolboxJson = {'contents': contents};\n  if (toolboxDef instanceof Node) {\n    addAttributes(toolboxDef, toolboxJson);\n  }\n  return toolboxJson;\n}\n\n/**\n * Converts the xml for a toolbox to JSON.\n *\n * @param toolboxDef The definition of the toolbox in one of its many forms.\n * @returns A list of objects in the toolbox.\n */\nfunction xmlToJsonArray(toolboxDef: Node|Node[]|NodeList): FlyoutItemInfoArray|\n    ToolboxItemInfo[] {\n  const arr = [];\n  // If it is a node it will have children.\n  // AnyDuringMigration because:  Property 'childNodes' does not exist on type\n  // 'Node | NodeList | Node[]'.\n  let childNodes = (toolboxDef as AnyDuringMigration).childNodes;\n  if (!childNodes) {\n    // Otherwise the toolboxDef is an array or collection.\n    childNodes = toolboxDef;\n  }\n  for (let i = 0, child; child = childNodes[i]; i++) {\n    if (!child.tagName) {\n      continue;\n    }\n    const obj = {};\n    const tagName = child.tagName.toUpperCase();\n    (obj as AnyDuringMigration)['kind'] = tagName;\n\n    // Store the XML for a block.\n    if (tagName === 'BLOCK') {\n      (obj as AnyDuringMigration)['blockxml'] = child;\n    } else if (child.childNodes && child.childNodes.length > 0) {\n      // Get the contents of a category\n      (obj as AnyDuringMigration)['contents'] = xmlToJsonArray(child);\n    }\n\n    // Add XML attributes to object\n    addAttributes(child, obj);\n    arr.push(obj);\n  }\n  // AnyDuringMigration because:  Type '{}[]' is not assignable to type\n  // 'ToolboxItemInfo[] | FlyoutItemInfoArray'.\n  return arr as AnyDuringMigration;\n}\n\n/**\n * Adds the attributes on the node to the given object.\n *\n * @param node The node to copy the attributes from.\n * @param obj The object to copy the attributes to.\n */\nfunction addAttributes(node: Node, obj: AnyDuringMigration) {\n  // AnyDuringMigration because:  Property 'attributes' does not exist on type\n  // 'Node'.\n  for (let j = 0; j < (node as AnyDuringMigration).attributes.length; j++) {\n    // AnyDuringMigration because:  Property 'attributes' does not exist on type\n    // 'Node'.\n    const attr = (node as AnyDuringMigration).attributes[j];\n    if (attr.nodeName.indexOf('css-') > -1) {\n      obj['cssconfig'] = obj['cssconfig'] || {};\n      obj['cssconfig'][attr.nodeName.replace('css-', '')] = attr.value;\n    } else {\n      obj[attr.nodeName] = attr.value;\n    }\n  }\n}\n\n/**\n * Parse the provided toolbox tree into a consistent DOM format.\n *\n * @param toolboxDef DOM tree of blocks, or text representation of same.\n * @returns DOM tree of blocks, or null.\n * @alias Blockly.utils.toolbox.parseToolboxTree\n */\nexport function parseToolboxTree(toolboxDef: Element|null|string): Element|\n    null {\n  if (toolboxDef) {\n    if (typeof toolboxDef !== 'string' && !(toolboxDef instanceof Element)) {\n      toolboxDef = null;\n    }\n    if (typeof toolboxDef === 'string') {\n      toolboxDef = Xml.textToDom(toolboxDef);\n      if (toolboxDef.nodeName.toLowerCase() !== 'xml') {\n        throw TypeError('Toolbox should be an <xml> document.');\n      }\n    }\n  } else {\n    toolboxDef = null;\n  }\n  return toolboxDef;\n}\n\nexport const TEST_ONLY = {\n  hasCategoriesInternal,\n};\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Extensions are functions that help initialize blocks, usually\n *      adding dynamic behavior such as onchange handlers and mutators. These\n *      are applied using Block.applyExtension(), or the JSON \"extensions\"\n *      array attribute.\n *\n * @namespace Blockly.Extensions\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Extensions');\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport {FieldDropdown} from './field_dropdown.js';\nimport {Mutator} from './mutator.js';\nimport * as parsing from './utils/parsing.js';\n\n\n/** The set of all registered extensions, keyed by extension name/id. */\nconst allExtensions = Object.create(null);\nexport const TEST_ONLY = {allExtensions};\n\n/**\n * Registers a new extension function. Extensions are functions that help\n * initialize blocks, usually adding dynamic behavior such as onchange\n * handlers and mutators. These are applied using Block.applyExtension(), or\n * the JSON \"extensions\" array attribute.\n *\n * @param name The name of this extension.\n * @param initFn The function to initialize an extended block.\n * @throws {Error} if the extension name is empty, the extension is already\n *     registered, or extensionFn is not a function.\n * @alias Blockly.Extensions.register\n */\nexport function register(name: string, initFn: Function) {\n  if (typeof name !== 'string' || name.trim() === '') {\n    throw Error('Error: Invalid extension name \"' + name + '\"');\n  }\n  if (allExtensions[name]) {\n    throw Error('Error: Extension \"' + name + '\" is already registered.');\n  }\n  if (typeof initFn !== 'function') {\n    throw Error('Error: Extension \"' + name + '\" must be a function');\n  }\n  allExtensions[name] = initFn;\n}\n\n/**\n * Registers a new extension function that adds all key/value of mixinObj.\n *\n * @param name The name of this extension.\n * @param mixinObj The values to mix in.\n * @throws {Error} if the extension name is empty or the extension is already\n *     registered.\n * @alias Blockly.Extensions.registerMixin\n */\nexport function registerMixin(name: string, mixinObj: AnyDuringMigration) {\n  if (!mixinObj || typeof mixinObj !== 'object') {\n    throw Error('Error: Mixin \"' + name + '\" must be a object');\n  }\n  register(name, function(this: Block) {\n    this.mixin(mixinObj);\n  });\n}\n\n/**\n * Registers a new extension function that adds a mutator to the block.\n * At register time this performs some basic sanity checks on the mutator.\n * The wrapper may also add a mutator dialog to the block, if both compose and\n * decompose are defined on the mixin.\n *\n * @param name The name of this mutator extension.\n * @param mixinObj The values to mix in.\n * @param opt_helperFn An optional function to apply after mixing in the object.\n * @param opt_blockList A list of blocks to appear in the flyout of the mutator\n *     dialog.\n * @throws {Error} if the mutation is invalid or can't be applied to the block.\n * @alias Blockly.Extensions.registerMutator\n */\nexport function registerMutator(\n    name: string, mixinObj: AnyDuringMigration,\n    opt_helperFn?: () => AnyDuringMigration, opt_blockList?: string[]) {\n  const errorPrefix = 'Error when registering mutator \"' + name + '\": ';\n\n  checkHasMutatorProperties(errorPrefix, mixinObj);\n  const hasMutatorDialog = checkMutatorDialog(mixinObj, errorPrefix);\n\n  if (opt_helperFn && typeof opt_helperFn !== 'function') {\n    throw Error(errorPrefix + 'Extension \"' + name + '\" is not a function');\n  }\n\n  // Sanity checks passed.\n  register(name, function(this: Block) {\n    if (hasMutatorDialog) {\n      this.setMutator(new Mutator(this as BlockSvg, opt_blockList || []));\n    }\n    // Mixin the object.\n    this.mixin(mixinObj);\n\n    if (opt_helperFn) {\n      opt_helperFn.apply(this);\n    }\n  });\n}\n\n/**\n * Unregisters the extension registered with the given name.\n *\n * @param name The name of the extension to unregister.\n * @alias Blockly.Extensions.unregister\n */\nexport function unregister(name: string) {\n  if (isRegistered(name)) {\n    delete allExtensions[name];\n  } else {\n    console.warn(\n        'No extension mapping for name \"' + name + '\" found to unregister');\n  }\n}\n\n/**\n * Returns whether an extension is registered with the given name.\n *\n * @param name The name of the extension to check for.\n * @returns True if the extension is registered.  False if it is not registered.\n * @alias Blockly.Extensions.isRegistered\n */\nexport function isRegistered(name: string): boolean {\n  return !!allExtensions[name];\n}\n\n/**\n * Applies an extension method to a block. This should only be called during\n * block construction.\n *\n * @param name The name of the extension.\n * @param block The block to apply the named extension to.\n * @param isMutator True if this extension defines a mutator.\n * @throws {Error} if the extension is not found.\n * @alias Blockly.Extensions.apply\n */\nexport function apply(name: string, block: Block, isMutator: boolean) {\n  const extensionFn = allExtensions[name];\n  if (typeof extensionFn !== 'function') {\n    throw Error('Error: Extension \"' + name + '\" not found.');\n  }\n  let mutatorProperties;\n  if (isMutator) {\n    // Fail early if the block already has mutation properties.\n    checkNoMutatorProperties(name, block);\n  } else {\n    // Record the old properties so we can make sure they don't change after\n    // applying the extension.\n    mutatorProperties = getMutatorProperties(block);\n  }\n  extensionFn.apply(block);\n\n  if (isMutator) {\n    const errorPrefix = 'Error after applying mutator \"' + name + '\": ';\n    checkHasMutatorProperties(errorPrefix, block);\n  } else {\n    if (!mutatorPropertiesMatch(\n            mutatorProperties as AnyDuringMigration[], block)) {\n      throw Error(\n          'Error when applying extension \"' + name + '\": ' +\n          'mutation properties changed when applying a non-mutator extension.');\n    }\n  }\n}\n\n/**\n * Check that the given block does not have any of the four mutator properties\n * defined on it.  This function should be called before applying a mutator\n * extension to a block, to make sure we are not overwriting properties.\n *\n * @param mutationName The name of the mutation to reference in error messages.\n * @param block The block to check.\n * @throws {Error} if any of the properties already exist on the block.\n */\nfunction checkNoMutatorProperties(mutationName: string, block: Block) {\n  const properties = getMutatorProperties(block);\n  if (properties.length) {\n    throw Error(\n        'Error: tried to apply mutation \"' + mutationName +\n        '\" to a block that already has mutator functions.' +\n        '  Block id: ' + block.id);\n  }\n}\n\n/**\n * Checks if the given object has both the 'mutationToDom' and 'domToMutation'\n * functions.\n *\n * @param object The object to check.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} if the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkXmlHooks(\n    object: AnyDuringMigration, errorPrefix: string): boolean {\n  return checkHasFunctionPair(\n      object.mutationToDom, object.domToMutation,\n      errorPrefix + ' mutationToDom/domToMutation');\n}\n/**\n * Checks if the given object has both the 'saveExtraState' and 'loadExtraState'\n * functions.\n *\n * @param object The object to check.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} if the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkJsonHooks(\n    object: AnyDuringMigration, errorPrefix: string): boolean {\n  return checkHasFunctionPair(\n      object.saveExtraState, object.loadExtraState,\n      errorPrefix + ' saveExtraState/loadExtraState');\n}\n\n/**\n * Checks if the given object has both the 'compose' and 'decompose' functions.\n *\n * @param object The object to check.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} if the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkMutatorDialog(\n    object: AnyDuringMigration, errorPrefix: string): boolean {\n  return checkHasFunctionPair(\n      object.compose, object.decompose, errorPrefix + ' compose/decompose');\n}\n\n/**\n * Checks that both or neither of the given functions exist and that they are\n * indeed functions.\n *\n * @param func1 The first function in the pair.\n * @param func2 The second function in the pair.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} If the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkHasFunctionPair(\n    func1: AnyDuringMigration, func2: AnyDuringMigration,\n    errorPrefix: string): boolean {\n  if (func1 && func2) {\n    if (typeof func1 !== 'function' || typeof func2 !== 'function') {\n      throw Error(errorPrefix + ' must be a function');\n    }\n    return true;\n  } else if (!func1 && !func2) {\n    return false;\n  }\n  throw Error(errorPrefix + 'Must have both or neither functions');\n}\n\n/**\n * Checks that the given object required mutator properties.\n *\n * @param errorPrefix The string to prepend to any error message.\n * @param object The object to inspect.\n */\nfunction checkHasMutatorProperties(\n    errorPrefix: string, object: AnyDuringMigration) {\n  const hasXmlHooks = checkXmlHooks(object, errorPrefix);\n  const hasJsonHooks = checkJsonHooks(object, errorPrefix);\n  if (!hasXmlHooks && !hasJsonHooks) {\n    throw Error(\n        errorPrefix +\n        'Mutations must contain either XML hooks, or JSON hooks, or both');\n  }\n  // A block with a mutator isn't required to have a mutation dialog, but\n  // it should still have both or neither of compose and decompose.\n  checkMutatorDialog(object, errorPrefix);\n}\n\n/**\n * Get a list of values of mutator properties on the given block.\n *\n * @param block The block to inspect.\n * @returns A list with all of the defined properties, which should be\n *     functions, but may be anything other than undefined.\n */\nfunction getMutatorProperties(block: Block): AnyDuringMigration[] {\n  const result = [];\n  // List each function explicitly by reference to allow for renaming\n  // during compilation.\n  if (block.domToMutation !== undefined) {\n    result.push(block.domToMutation);\n  }\n  if (block.mutationToDom !== undefined) {\n    result.push(block.mutationToDom);\n  }\n  if (block.saveExtraState !== undefined) {\n    result.push(block.saveExtraState);\n  }\n  if (block.loadExtraState !== undefined) {\n    result.push(block.loadExtraState);\n  }\n  if (block.compose !== undefined) {\n    result.push(block.compose);\n  }\n  if (block.decompose !== undefined) {\n    result.push(block.decompose);\n  }\n  return result;\n}\n\n/**\n * Check that the current mutator properties match a list of old mutator\n * properties.  This should be called after applying a non-mutator extension,\n * to verify that the extension didn't change properties it shouldn't.\n *\n * @param oldProperties The old values to compare to.\n * @param block The block to inspect for new values.\n * @returns True if the property lists match.\n */\nfunction mutatorPropertiesMatch(\n    oldProperties: AnyDuringMigration[], block: Block): boolean {\n  const newProperties = getMutatorProperties(block);\n  if (newProperties.length !== oldProperties.length) {\n    return false;\n  }\n  for (let i = 0; i < newProperties.length; i++) {\n    if (oldProperties[i] !== newProperties[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Calls a function after the page has loaded, possibly immediately.\n *\n * @param fn Function to run.\n * @throws Error Will throw if no global document can be found (e.g., Node.js).\n * @internal\n */\nexport function runAfterPageLoad(fn: () => void) {\n  if (typeof document !== 'object') {\n    throw Error('runAfterPageLoad() requires browser document.');\n  }\n  if (document.readyState === 'complete') {\n    fn();  // Page has already loaded. Call immediately.\n  } else {\n    // Poll readyState.\n    const readyStateCheckInterval = setInterval(function() {\n      if (document.readyState === 'complete') {\n        clearInterval(readyStateCheckInterval);\n        fn();\n      }\n    }, 10);\n  }\n}\n\n/**\n * Builds an extension function that will map a dropdown value to a tooltip\n * string.\n *\n * This method includes multiple checks to ensure tooltips, dropdown options,\n * and message references are aligned. This aims to catch errors as early as\n * possible, without requiring developers to manually test tooltips under each\n * option. After the page is loaded, each tooltip text string will be checked\n * for matching message keys in the internationalized string table. Deferring\n * this until the page is loaded decouples loading dependencies. Later, upon\n * loading the first block of any given type, the extension will validate every\n * dropdown option has a matching tooltip in the lookupTable.  Errors are\n * reported as warnings in the console, and are never fatal.\n *\n * @param dropdownName The name of the field whose value is the key to the\n *     lookup table.\n * @param lookupTable The table of field values to tooltip text.\n * @returns The extension function.\n * @alias Blockly.Extensions.buildTooltipForDropdown\n */\nexport function buildTooltipForDropdown(\n    dropdownName: string, lookupTable: {[key: string]: string}): Function {\n  // List of block types already validated, to minimize duplicate warnings.\n  const blockTypesChecked: AnyDuringMigration[] = [];\n\n  // Check the tooltip string messages for invalid references.\n  // Wait for load, in case Blockly.Msg is not yet populated.\n  // runAfterPageLoad() does not run in a Node.js environment due to lack\n  // of document object, in which case skip the validation.\n  if (typeof document === 'object') {  // Relies on document.readyState\n    runAfterPageLoad(function() {\n      for (const key in lookupTable) {\n        // Will print warnings if reference is missing.\n        parsing.checkMessageReferences(lookupTable[key]);\n      }\n    });\n  }\n\n  /** The actual extension. */\n  function extensionFn(this: Block) {\n    if (this.type && blockTypesChecked.indexOf(this.type) === -1) {\n      checkDropdownOptionsInTable(this, dropdownName, lookupTable);\n      blockTypesChecked.push(this.type);\n    }\n\n    this.setTooltip(function(this: Block) {\n      const value = String(this.getFieldValue(dropdownName));\n      let tooltip = lookupTable[value];\n      if (tooltip === null) {\n        if (blockTypesChecked.indexOf(this.type) === -1) {\n          // Warn for missing values on generated tooltips.\n          let warning = 'No tooltip mapping for value ' + value + ' of field ' +\n              dropdownName;\n          if (this.type !== null) {\n            warning += ' of block type ' + this.type;\n          }\n          console.warn(warning + '.');\n        }\n      } else {\n        tooltip = parsing.replaceMessageReferences(tooltip);\n      }\n      return tooltip;\n    }.bind(this));\n  }\n  return extensionFn;\n}\n\n/**\n * Checks all options keys are present in the provided string lookup table.\n * Emits console warnings when they are not.\n *\n * @param block The block containing the dropdown\n * @param dropdownName The name of the dropdown\n * @param lookupTable The string lookup table\n */\nfunction checkDropdownOptionsInTable(\n    block: Block, dropdownName: string, lookupTable: {[key: string]: string}) {\n  // Validate all dropdown options have values.\n  const dropdown = block.getField(dropdownName);\n  if (dropdown instanceof FieldDropdown && !dropdown.isOptionListDynamic()) {\n    const options = dropdown.getOptions();\n    for (let i = 0; i < options.length; i++) {\n      const optionKey = options[i][1];  // label, then value\n      if (lookupTable[optionKey] === null) {\n        console.warn(\n            'No tooltip mapping for value ' + optionKey + ' of field ' +\n            dropdownName + ' of block type ' + block.type);\n      }\n    }\n  }\n}\n\n/**\n * Builds an extension function that will install a dynamic tooltip. The\n * tooltip message should include the string '%1' and that string will be\n * replaced with the text of the named field.\n *\n * @param msgTemplate The template form to of the message text, with %1\n *     placeholder.\n * @param fieldName The field with the replacement text.\n * @returns The extension function.\n * @alias Blockly.Extensions.buildTooltipWithFieldText\n */\nexport function buildTooltipWithFieldText(\n    msgTemplate: string, fieldName: string): Function {\n  // Check the tooltip string messages for invalid references.\n  // Wait for load, in case Blockly.Msg is not yet populated.\n  // runAfterPageLoad() does not run in a Node.js environment due to lack\n  // of document object, in which case skip the validation.\n  if (typeof document === 'object') {  // Relies on document.readyState\n    runAfterPageLoad(function() {\n      // Will print warnings if reference is missing.\n      parsing.checkMessageReferences(msgTemplate);\n    });\n  }\n\n  /** The actual extension. */\n  function extensionFn(this: Block) {\n    this.setTooltip(function(this: Block) {\n      const field = this.getField(fieldName);\n      return parsing.replaceMessageReferences(msgTemplate)\n          .replace('%1', field ? field.getText() : '');\n    }.bind(this));\n  }\n  return extensionFn;\n}\n\n/**\n * Configures the tooltip to mimic the parent block when connected. Otherwise,\n * uses the tooltip text at the time this extension is initialized. This takes\n * advantage of the fact that all other values from JSON are initialized before\n * extensions.\n */\nfunction extensionParentTooltip(this: Block) {\n  const tooltipWhenNotConnected = this.tooltip;\n  this.setTooltip(function(this: Block) {\n    const parent = this.getParent();\n    return parent && parent.getInputsInline() && parent.tooltip ||\n        tooltipWhenNotConnected;\n  }.bind(this));\n}\nregister('parent_tooltip_when_inline', extensionParentTooltip);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing an AST node.\n * Used to traverse the Blockly AST.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ASTNode');\n\nimport type {Block} from '../block.js';\nimport type {Connection} from '../connection.js';\nimport {ConnectionType} from '../connection_type.js';\nimport type {Field} from '../field.js';\nimport type {Input} from '../input.js';\nimport type {IASTNodeLocation} from '../interfaces/i_ast_node_location.js';\nimport type {IASTNodeLocationWithBlock} from '../interfaces/i_ast_node_location_with_block.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport type {Workspace} from '../workspace.js';\n\n\n/**\n * Class for an AST node.\n * It is recommended that you use one of the createNode methods instead of\n * creating a node directly.\n *\n * @alias Blockly.ASTNode\n */\nexport class ASTNode {\n  /**\n   * True to navigate to all fields. False to only navigate to clickable fields.\n   */\n  static NAVIGATE_ALL_FIELDS = false;\n\n  /**\n   * The default y offset to use when moving the cursor from a stack to the\n   * workspace.\n   */\n  private static readonly DEFAULT_OFFSET_Y: number = -20;\n  private readonly type_: string;\n  private readonly isConnection_: boolean;\n  private readonly location_: IASTNodeLocation;\n\n  /** The coordinate on the workspace. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'Coordinate'.\n  private wsCoordinate_: Coordinate = null as AnyDuringMigration;\n\n  /**\n   * @param type The type of the location.\n   *     Must be in ASTNode.types.\n   * @param location The position in the AST.\n   * @param opt_params Optional dictionary of options.\n   * @alias Blockly.ASTNode\n   */\n  constructor(type: string, location: IASTNodeLocation, opt_params?: Params) {\n    if (!location) {\n      throw Error('Cannot create a node without a location.');\n    }\n\n    /**\n     * The type of the location.\n     * One of ASTNode.types\n     */\n    this.type_ = type;\n\n    /** Whether the location points to a connection. */\n    this.isConnection_ = ASTNode.isConnectionType_(type);\n\n    /** The location of the AST node. */\n    this.location_ = location;\n\n    this.processParams_(opt_params || null);\n  }\n\n  /**\n   * Parse the optional parameters.\n   *\n   * @param params The user specified parameters.\n   */\n  private processParams_(params: Params|null) {\n    if (!params) {\n      return;\n    }\n    if (params.wsCoordinate) {\n      this.wsCoordinate_ = params.wsCoordinate;\n    }\n  }\n\n  /**\n   * Gets the value pointed to by this node.\n   * It is the callers responsibility to check the node type to figure out what\n   * type of object they get back from this.\n   *\n   * @returns The current field, connection, workspace, or block the cursor is\n   *     on.\n   */\n  getLocation(): IASTNodeLocation {\n    return this.location_;\n  }\n\n  /**\n   * The type of the current location.\n   * One of ASTNode.types\n   *\n   * @returns The type of the location.\n   */\n  getType(): string {\n    return this.type_;\n  }\n\n  /**\n   * The coordinate on the workspace.\n   *\n   * @returns The workspace coordinate or null if the location is not a\n   *     workspace.\n   */\n  getWsCoordinate(): Coordinate {\n    return this.wsCoordinate_;\n  }\n\n  /**\n   * Whether the node points to a connection.\n   *\n   * @returns [description]\n   * @internal\n   */\n  isConnection(): boolean {\n    return this.isConnection_;\n  }\n\n  /**\n   * Given an input find the next editable field or an input with a non null\n   * connection in the same block. The current location must be an input\n   * connection.\n   *\n   * @returns The AST node holding the next field or connection or null if there\n   *     is no editable field or input connection after the given input.\n   */\n  private findNextForInput_(): ASTNode|null {\n    const location = this.location_ as Connection;\n    const parentInput = location.getParentInput();\n    const block = parentInput!.getSourceBlock();\n    // AnyDuringMigration because:  Argument of type 'Input | null' is not\n    // assignable to parameter of type 'Input'.\n    const curIdx = block!.inputList.indexOf(parentInput as AnyDuringMigration);\n    for (let i = curIdx + 1; i < block!.inputList.length; i++) {\n      const input = block!.inputList[i];\n      const fieldRow = input.fieldRow;\n      for (let j = 0; j < fieldRow.length; j++) {\n        const field = fieldRow[j];\n        if (field.isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(field);\n        }\n      }\n      if (input.connection) {\n        return ASTNode.createInputNode(input);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Given a field find the next editable field or an input with a non null\n   * connection in the same block. The current location must be a field.\n   *\n   * @returns The AST node pointing to the next field or connection or null if\n   *     there is no editable field or input connection after the given input.\n   */\n  private findNextForField_(): ASTNode|null {\n    const location = this.location_ as Field;\n    const input = location.getParentInput();\n    const block = location.getSourceBlock();\n    const curIdx = block.inputList.indexOf((input));\n    let fieldIdx = input.fieldRow.indexOf(location) + 1;\n    for (let i = curIdx; i < block.inputList.length; i++) {\n      const newInput = block.inputList[i];\n      const fieldRow = newInput.fieldRow;\n      while (fieldIdx < fieldRow.length) {\n        if (fieldRow[fieldIdx].isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(fieldRow[fieldIdx]);\n        }\n        fieldIdx++;\n      }\n      fieldIdx = 0;\n      if (newInput.connection) {\n        return ASTNode.createInputNode(newInput);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Given an input find the previous editable field or an input with a non null\n   * connection in the same block. The current location must be an input\n   * connection.\n   *\n   * @returns The AST node holding the previous field or connection.\n   */\n  private findPrevForInput_(): ASTNode|null {\n    const location = this.location_ as Connection;\n    const parentInput = location.getParentInput();\n    const block = parentInput!.getSourceBlock();\n    // AnyDuringMigration because:  Argument of type 'Input | null' is not\n    // assignable to parameter of type 'Input'.\n    const curIdx = block!.inputList.indexOf(parentInput as AnyDuringMigration);\n    for (let i = curIdx; i >= 0; i--) {\n      const input = block!.inputList[i];\n      if (input.connection && input !== parentInput) {\n        return ASTNode.createInputNode(input);\n      }\n      const fieldRow = input.fieldRow;\n      for (let j = fieldRow.length - 1; j >= 0; j--) {\n        const field = fieldRow[j];\n        if (field.isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(field);\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Given a field find the previous editable field or an input with a non null\n   * connection in the same block. The current location must be a field.\n   *\n   * @returns The AST node holding the previous input or field.\n   */\n  private findPrevForField_(): ASTNode|null {\n    const location = this.location_ as Field;\n    const parentInput = location.getParentInput();\n    const block = location.getSourceBlock();\n    const curIdx = block.inputList.indexOf((parentInput));\n    let fieldIdx = parentInput.fieldRow.indexOf(location) - 1;\n    for (let i = curIdx; i >= 0; i--) {\n      const input = block.inputList[i];\n      if (input.connection && input !== parentInput) {\n        return ASTNode.createInputNode(input);\n      }\n      const fieldRow = input.fieldRow;\n      while (fieldIdx > -1) {\n        if (fieldRow[fieldIdx].isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(fieldRow[fieldIdx]);\n        }\n        fieldIdx--;\n      }\n      // Reset the fieldIdx to the length of the field row of the previous\n      // input.\n      if (i - 1 >= 0) {\n        fieldIdx = block.inputList[i - 1].fieldRow.length - 1;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Navigate between stacks of blocks on the workspace.\n   *\n   * @param forward True to go forward. False to go backwards.\n   * @returns The first block of the next stack or null if there are no blocks\n   *     on the workspace.\n   */\n  private navigateBetweenStacks_(forward: boolean): ASTNode|null {\n    let curLocation = this.getLocation();\n    // TODO(#6097): Use instanceof checks to exit early for values of\n    // curLocation that don't make sense.\n    if ((curLocation as IASTNodeLocationWithBlock).getSourceBlock) {\n      curLocation = (curLocation as IASTNodeLocationWithBlock).getSourceBlock();\n    }\n    // TODO(#6097): Use instanceof checks to exit early for values of\n    // curLocation that don't make sense.\n    const curLocationAsBlock = curLocation as Block;\n    if (!curLocationAsBlock || curLocationAsBlock.disposed) {\n      return null;\n    }\n    const curRoot = curLocationAsBlock.getRootBlock();\n    const topBlocks = curRoot.workspace.getTopBlocks(true);\n    for (let i = 0; i < topBlocks.length; i++) {\n      const topBlock = topBlocks[i];\n      if (curRoot.id === topBlock.id) {\n        const offset = forward ? 1 : -1;\n        const resultIndex = i + offset;\n        if (resultIndex === -1 || resultIndex === topBlocks.length) {\n          return null;\n        }\n        return ASTNode.createStackNode(topBlocks[resultIndex]);\n      }\n    }\n    throw Error(\n        'Couldn\\'t find ' + (forward ? 'next' : 'previous') + ' stack?!');\n  }\n\n  /**\n   * Finds the top most AST node for a given block.\n   * This is either the previous connection, output connection or block\n   * depending on what kind of connections the block has.\n   *\n   * @param block The block that we want to find the top connection on.\n   * @returns The AST node containing the top connection.\n   */\n  private findTopASTNodeForBlock_(block: Block): ASTNode|null {\n    const topConnection = getParentConnection(block);\n    if (topConnection) {\n      return ASTNode.createConnectionNode(topConnection);\n    } else {\n      return ASTNode.createBlockNode(block);\n    }\n  }\n\n  /**\n   * Get the AST node pointing to the input that the block is nested under or if\n   * the block is not nested then get the stack AST node.\n   *\n   * @param block The source block of the current location.\n   * @returns The AST node pointing to the input connection or the top block of\n   *     the stack this block is in.\n   */\n  private getOutAstNodeForBlock_(block: Block): ASTNode|null {\n    if (!block) {\n      return null;\n    }\n    // If the block doesn't have a previous connection then it is the top of the\n    // substack.\n    const topBlock = block.getTopStackBlock();\n    const topConnection = getParentConnection(topBlock);\n    // If the top connection has a parentInput, create an AST node pointing to\n    // that input.\n    if (topConnection && topConnection.targetConnection &&\n        topConnection.targetConnection.getParentInput()) {\n      // AnyDuringMigration because:  Argument of type 'Input | null' is not\n      // assignable to parameter of type 'Input'.\n      return ASTNode.createInputNode(\n          topConnection.targetConnection.getParentInput() as\n          AnyDuringMigration);\n    } else {\n      // Go to stack level if you are not underneath an input.\n      return ASTNode.createStackNode(topBlock);\n    }\n  }\n\n  /**\n   * Find the first editable field or input with a connection on a given block.\n   *\n   * @param block The source block of the current location.\n   * @returns An AST node pointing to the first field or input.\n   * Null if there are no editable fields or inputs with connections on the\n   * block.\n   */\n  private findFirstFieldOrInput_(block: Block): ASTNode|null {\n    const inputs = block.inputList;\n    for (let i = 0; i < inputs.length; i++) {\n      const input = inputs[i];\n      const fieldRow = input.fieldRow;\n      for (let j = 0; j < fieldRow.length; j++) {\n        const field = fieldRow[j];\n        if (field.isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(field);\n        }\n      }\n      if (input.connection) {\n        return ASTNode.createInputNode(input);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Finds the source block of the location of this node.\n   *\n   * @returns The source block of the location, or null if the node is of type\n   *     workspace.\n   */\n  getSourceBlock(): Block|null {\n    if (this.getType() === ASTNode.types.BLOCK) {\n      return this.getLocation() as Block;\n    } else if (this.getType() === ASTNode.types.STACK) {\n      return this.getLocation() as Block;\n    } else if (this.getType() === ASTNode.types.WORKSPACE) {\n      return null;\n    } else {\n      return (this.getLocation() as IASTNodeLocationWithBlock).getSourceBlock();\n    }\n  }\n\n  /**\n   * Find the element to the right of the current element in the AST.\n   *\n   * @returns An AST node that wraps the next field, connection, block, or\n   *     workspace. Or null if there is no node to the right.\n   */\n  next(): ASTNode|null {\n    switch (this.type_) {\n      case ASTNode.types.STACK:\n        return this.navigateBetweenStacks_(true);\n\n      case ASTNode.types.OUTPUT: {\n        const connection = this.location_ as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.FIELD:\n        return this.findNextForField_();\n\n      case ASTNode.types.INPUT:\n        return this.findNextForInput_();\n\n      case ASTNode.types.BLOCK: {\n        const block = this.location_ as Block;\n        const nextConnection = block.nextConnection;\n        return ASTNode.createConnectionNode(nextConnection);\n      }\n      case ASTNode.types.PREVIOUS: {\n        const connection = this.location_ as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.NEXT: {\n        const connection = this.location_ as Connection;\n        const targetConnection = connection.targetConnection;\n        return ASTNode.createConnectionNode(targetConnection!);\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Find the element one level below and all the way to the left of the current\n   * location.\n   *\n   * @returns An AST node that wraps the next field, connection, workspace, or\n   *     block. Or null if there is nothing below this node.\n   */\n  in(): ASTNode|null {\n    switch (this.type_) {\n      case ASTNode.types.WORKSPACE: {\n        const workspace = this.location_ as Workspace;\n        const topBlocks = workspace.getTopBlocks(true);\n        if (topBlocks.length > 0) {\n          return ASTNode.createStackNode(topBlocks[0]);\n        }\n        break;\n      }\n      case ASTNode.types.STACK: {\n        const block = this.location_ as Block;\n        return this.findTopASTNodeForBlock_(block);\n      }\n      case ASTNode.types.BLOCK: {\n        const block = this.location_ as Block;\n        return this.findFirstFieldOrInput_(block);\n      }\n      case ASTNode.types.INPUT: {\n        const connection = this.location_ as Connection;\n        const targetConnection = connection.targetConnection;\n        return ASTNode.createConnectionNode(targetConnection!);\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Find the element to the left of the current element in the AST.\n   *\n   * @returns An AST node that wraps the previous field, connection, workspace\n   *     or block. Or null if no node exists to the left. null.\n   */\n  prev(): ASTNode|null {\n    switch (this.type_) {\n      case ASTNode.types.STACK:\n        return this.navigateBetweenStacks_(false);\n\n      case ASTNode.types.OUTPUT:\n        return null;\n\n      case ASTNode.types.FIELD:\n        return this.findPrevForField_();\n\n      case ASTNode.types.INPUT:\n        return this.findPrevForInput_();\n\n      case ASTNode.types.BLOCK: {\n        const block = this.location_ as Block;\n        const topConnection = getParentConnection(block);\n        return ASTNode.createConnectionNode(topConnection);\n      }\n      case ASTNode.types.PREVIOUS: {\n        const connection = this.location_ as Connection;\n        const targetConnection = connection.targetConnection;\n        if (targetConnection && !targetConnection.getParentInput()) {\n          return ASTNode.createConnectionNode(targetConnection);\n        }\n        break;\n      }\n      case ASTNode.types.NEXT: {\n        const connection = this.location_ as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Find the next element that is one position above and all the way to the\n   * left of the current location.\n   *\n   * @returns An AST node that wraps the next field, connection, workspace or\n   *     block. Or null if we are at the workspace level.\n   */\n  out(): ASTNode|null {\n    switch (this.type_) {\n      case ASTNode.types.STACK: {\n        const block = this.location_ as Block;\n        const blockPos = block.getRelativeToSurfaceXY();\n        // TODO: Make sure this is in the bounds of the workspace.\n        const wsCoordinate =\n            new Coordinate(blockPos.x, blockPos.y + ASTNode.DEFAULT_OFFSET_Y);\n        return ASTNode.createWorkspaceNode(block.workspace, wsCoordinate);\n      }\n      case ASTNode.types.OUTPUT: {\n        const connection = this.location_ as Connection;\n        const target = connection.targetConnection;\n        if (target) {\n          return ASTNode.createConnectionNode(target);\n        }\n        return ASTNode.createStackNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.FIELD: {\n        const field = this.location_ as Field;\n        return ASTNode.createBlockNode(field.getSourceBlock());\n      }\n      case ASTNode.types.INPUT: {\n        const connection = this.location_ as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.BLOCK: {\n        const block = this.location_ as Block;\n        return this.getOutAstNodeForBlock_(block);\n      }\n      case ASTNode.types.PREVIOUS: {\n        const connection = this.location_ as Connection;\n        return this.getOutAstNodeForBlock_(connection.getSourceBlock());\n      }\n      case ASTNode.types.NEXT: {\n        const connection = this.location_ as Connection;\n        return this.getOutAstNodeForBlock_(connection.getSourceBlock());\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Whether an AST node of the given type points to a connection.\n   *\n   * @param type The type to check.  One of ASTNode.types.\n   * @returns True if a node of the given type points to a connection.\n   */\n  private static isConnectionType_(type: string): boolean {\n    switch (type) {\n      case ASTNode.types.PREVIOUS:\n      case ASTNode.types.NEXT:\n      case ASTNode.types.INPUT:\n      case ASTNode.types.OUTPUT:\n        return true;\n    }\n    return false;\n  }\n\n  /**\n   * Create an AST node pointing to a field.\n   *\n   * @param field The location of the AST node.\n   * @returns An AST node pointing to a field.\n   */\n  static createFieldNode(field: Field): ASTNode|null {\n    if (!field) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.FIELD, field);\n  }\n\n  /**\n   * Creates an AST node pointing to a connection. If the connection has a\n   * parent input then create an AST node of type input that will hold the\n   * connection.\n   *\n   * @param connection This is the connection the node will point to.\n   * @returns An AST node pointing to a connection.\n   */\n  static createConnectionNode(connection: Connection): ASTNode|null {\n    if (!connection) {\n      return null;\n    }\n    const type = connection.type;\n    if (type === ConnectionType.INPUT_VALUE) {\n      // AnyDuringMigration because:  Argument of type 'Input | null' is not\n      // assignable to parameter of type 'Input'.\n      return ASTNode.createInputNode(\n          connection.getParentInput() as AnyDuringMigration);\n    } else if (\n        type === ConnectionType.NEXT_STATEMENT && connection.getParentInput()) {\n      // AnyDuringMigration because:  Argument of type 'Input | null' is not\n      // assignable to parameter of type 'Input'.\n      return ASTNode.createInputNode(\n          connection.getParentInput() as AnyDuringMigration);\n    } else if (type === ConnectionType.NEXT_STATEMENT) {\n      return new ASTNode(ASTNode.types.NEXT, connection);\n    } else if (type === ConnectionType.OUTPUT_VALUE) {\n      return new ASTNode(ASTNode.types.OUTPUT, connection);\n    } else if (type === ConnectionType.PREVIOUS_STATEMENT) {\n      return new ASTNode(ASTNode.types.PREVIOUS, connection);\n    }\n    return null;\n  }\n\n  /**\n   * Creates an AST node pointing to an input. Stores the input connection as\n   * the location.\n   *\n   * @param input The input used to create an AST node.\n   * @returns An AST node pointing to a input.\n   */\n  static createInputNode(input: Input): ASTNode|null {\n    if (!input || !input.connection) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.INPUT, input.connection);\n  }\n\n  /**\n   * Creates an AST node pointing to a block.\n   *\n   * @param block The block used to create an AST node.\n   * @returns An AST node pointing to a block.\n   */\n  static createBlockNode(block: Block): ASTNode|null {\n    if (!block) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.BLOCK, block);\n  }\n\n  /**\n   * Create an AST node of type stack. A stack, represented by its top block, is\n   *     the set of all blocks connected to a top block, including the top\n   * block.\n   *\n   * @param topBlock A top block has no parent and can be found in the list\n   *     returned by workspace.getTopBlocks().\n   * @returns An AST node of type stack that points to the top block on the\n   *     stack.\n   */\n  static createStackNode(topBlock: Block): ASTNode|null {\n    if (!topBlock) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.STACK, topBlock);\n  }\n\n  /**\n   * Creates an AST node pointing to a workspace.\n   *\n   * @param workspace The workspace that we are on.\n   * @param wsCoordinate The position on the workspace for this node.\n   * @returns An AST node pointing to a workspace and a position on the\n   *     workspace.\n   */\n  static createWorkspaceNode(\n      workspace: Workspace|null, wsCoordinate: Coordinate|null): ASTNode|null {\n    if (!wsCoordinate || !workspace) {\n      return null;\n    }\n    const params = {wsCoordinate};\n    return new ASTNode(ASTNode.types.WORKSPACE, workspace, params);\n  }\n\n  /**\n   * Creates an AST node for the top position on a block.\n   * This is either an output connection, previous connection, or block.\n   *\n   * @param block The block to find the top most AST node on.\n   * @returns The AST node holding the top most position on the block.\n   */\n  static createTopNode(block: Block): ASTNode|null {\n    let astNode;\n    const topConnection = getParentConnection(block);\n    if (topConnection) {\n      astNode = ASTNode.createConnectionNode(topConnection);\n    } else {\n      astNode = ASTNode.createBlockNode(block);\n    }\n    return astNode;\n  }\n}\n\nexport namespace ASTNode {\n  export interface Params {\n    wsCoordinate: Coordinate;\n  }\n\n  export enum types {\n    FIELD = 'field',\n    BLOCK = 'block',\n    INPUT = 'input',\n    OUTPUT = 'output',\n    NEXT = 'next',\n    PREVIOUS = 'previous',\n    STACK = 'stack',\n    WORKSPACE = 'workspace',\n  }\n}\n\nexport type Params = ASTNode.Params;\n// No need to export ASTNode.types from the module at this time because (1) it\n// wasn't automatically converted by the automatic migration script, (2) the\n// name doesn't follow the styleguide.\n\n\n/**\n * Gets the parent connection on a block.\n * This is either an output connection, previous connection or undefined.\n * If both connections exist return the one that is actually connected\n * to another block.\n *\n * @param block The block to find the parent connection on.\n * @returns The connection connecting to the parent of the block.\n */\nfunction getParentConnection(block: Block): Connection {\n  let topConnection = block.outputConnection;\n  if (!topConnection ||\n      block.previousConnection && block.previousConnection.isConnected()) {\n    topConnection = block.previousConnection;\n  }\n  return topConnection;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods animating a block on connection and disconnection.\n *\n * @namespace Blockly.blockAnimations\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockAnimations');\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\n\n\n/** A bounding box for a cloned block. */\ninterface CloneRect {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\n/** PID of disconnect UI animation.  There can only be one at a time. */\nlet disconnectPid: ReturnType<typeof setTimeout>|null = null;\n\n/** SVG group of wobbling block.  There can only be one at a time. */\nlet disconnectGroup: SVGElement|null = null;\n\n\n/**\n * Play some UI effects (sound, animation) when disposing of a block.\n *\n * @param block The block being disposed of.\n * @alias Blockly.blockAnimations.disposeUiEffect\n * @internal\n */\nexport function disposeUiEffect(block: BlockSvg) {\n  const workspace = block.workspace;\n  const svgGroup = block.getSvgRoot();\n  workspace.getAudioManager().play('delete');\n\n  const xy = workspace.getSvgXY(svgGroup);\n  // Deeply clone the current block.\n  const clone: SVGGElement = svgGroup.cloneNode(true) as SVGGElement;\n  clone.setAttribute('transform', 'translate(' + xy.x + ',' + xy.y + ')');\n  workspace.getParentSvg().appendChild(clone);\n  const cloneRect =\n      {'x': xy.x, 'y': xy.y, 'width': block.width, 'height': block.height};\n  disposeUiStep(clone, cloneRect, workspace.RTL, new Date(), workspace.scale);\n}\n/**\n * Animate a cloned block and eventually dispose of it.\n * This is a class method, not an instance method since the original block has\n * been destroyed and is no longer accessible.\n *\n * @param clone SVG element to animate and dispose of.\n * @param rect Starting rect of the clone.\n * @param rtl True if RTL, false if LTR.\n * @param start Date of animation's start.\n * @param workspaceScale Scale of workspace.\n */\nfunction disposeUiStep(\n    clone: Element, rect: CloneRect, rtl: boolean, start: Date,\n    workspaceScale: number) {\n  const ms = new Date().getTime() - start.getTime();\n  const percent = ms / 150;\n  if (percent > 1) {\n    dom.removeNode(clone);\n  } else {\n    const x =\n        rect.x + (rtl ? -1 : 1) * rect.width * workspaceScale / 2 * percent;\n    const y = rect.y + rect.height * workspaceScale * percent;\n    const scale = (1 - percent) * workspaceScale;\n    clone.setAttribute(\n        'transform',\n        'translate(' + x + ',' + y + ')' +\n            ' scale(' + scale + ')');\n    setTimeout(disposeUiStep, 10, clone, rect, rtl, start, workspaceScale);\n  }\n}\n\n/**\n * Play some UI effects (sound, ripple) after a connection has been established.\n *\n * @param block The block being connected.\n * @alias Blockly.blockAnimations.connectionUiEffect\n * @internal\n */\nexport function connectionUiEffect(block: BlockSvg) {\n  const workspace = block.workspace;\n  const scale = workspace.scale;\n  workspace.getAudioManager().play('click');\n  if (scale < 1) {\n    return;  // Too small to care about visual effects.\n  }\n  // Determine the absolute coordinates of the inferior block.\n  const xy = workspace.getSvgXY(block.getSvgRoot());\n  // Offset the coordinates based on the two connection types, fix scale.\n  if (block.outputConnection) {\n    xy.x += (block.RTL ? 3 : -3) * scale;\n    xy.y += 13 * scale;\n  } else if (block.previousConnection) {\n    xy.x += (block.RTL ? -23 : 23) * scale;\n    xy.y += 3 * scale;\n  }\n  const ripple = dom.createSvgElement(\n      Svg.CIRCLE, {\n        'cx': xy.x,\n        'cy': xy.y,\n        'r': 0,\n        'fill': 'none',\n        'stroke': '#888',\n        'stroke-width': 10,\n      },\n      workspace.getParentSvg());\n  // Start the animation.\n  connectionUiStep(ripple, new Date(), scale);\n}\n\n/**\n * Expand a ripple around a connection.\n *\n * @param ripple Element to animate.\n * @param start Date of animation's start.\n * @param scale Scale of workspace.\n */\nfunction connectionUiStep(ripple: SVGElement, start: Date, scale: number) {\n  const ms = new Date().getTime() - start.getTime();\n  const percent = ms / 150;\n  if (percent > 1) {\n    dom.removeNode(ripple);\n  } else {\n    ripple.setAttribute('r', (percent * 25 * scale).toString());\n    ripple.style.opacity = (1 - percent).toString();\n    disconnectPid = setTimeout(connectionUiStep, 10, ripple, start, scale);\n  }\n}\n\n/**\n * Play some UI effects (sound, animation) when disconnecting a block.\n *\n * @param block The block being disconnected.\n * @alias Blockly.blockAnimations.disconnectUiEffect\n * @internal\n */\nexport function disconnectUiEffect(block: BlockSvg) {\n  disconnectUiStop();\n  block.workspace.getAudioManager().play('disconnect');\n  if (block.workspace.scale < 1) {\n    return;  // Too small to care about visual effects.\n  }\n  // Horizontal distance for bottom of block to wiggle.\n  const DISPLACEMENT = 10;\n  // Scale magnitude of skew to height of block.\n  const height = block.getHeightWidth().height;\n  let magnitude = Math.atan(DISPLACEMENT / height) / Math.PI * 180;\n  if (!block.RTL) {\n    magnitude *= -1;\n  }\n  // Start the animation.\n  disconnectGroup = block.getSvgRoot();\n  disconnectUiStep(disconnectGroup, magnitude, new Date());\n}\n\n/**\n * Animate a brief wiggle of a disconnected block.\n *\n * @param group SVG element to animate.\n * @param magnitude Maximum degrees skew (reversed for RTL).\n * @param start Date of animation's start.\n */\nfunction disconnectUiStep(group: SVGElement, magnitude: number, start: Date) {\n  const DURATION = 200;  // Milliseconds.\n  const WIGGLES = 3;     // Half oscillations.\n\n  const ms = new Date().getTime() - start.getTime();\n  const percent = ms / DURATION;\n\n  let skew = '';\n  if (percent <= 1) {\n    const val = Math.round(\n        Math.sin(percent * Math.PI * WIGGLES) * (1 - percent) * magnitude);\n    skew = `skewX(${val})`;\n    disconnectPid = setTimeout(disconnectUiStep, 10, group, magnitude, start);\n  }\n  group.setAttribute('transform', skew);\n}\n\n/**\n * Stop the disconnect UI animation immediately.\n *\n * @alias Blockly.blockAnimations.disconnectUiStop\n * @internal\n */\nexport function disconnectUiStop() {\n  if (disconnectGroup) {\n    if (disconnectPid) {\n      clearTimeout(disconnectPid);\n    }\n    disconnectGroup.setAttribute('transform', '');\n    disconnectGroup = null;\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Blockly's internal clipboard for managing copy-paste.\n *\n * @namespace Blockly.clipboard\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.clipboard');\n\nimport type {CopyData, ICopyable} from './interfaces/i_copyable.js';\n\n\n/** Metadata about the object that is currently on the clipboard. */\nlet copyData: CopyData|null = null;\n\n/**\n * Copy a block or workspace comment onto the local clipboard.\n *\n * @param toCopy Block or Workspace Comment to be copied.\n * @alias Blockly.clipboard.copy\n * @internal\n */\nexport function copy(toCopy: ICopyable) {\n  TEST_ONLY.copyInternal(toCopy);\n}\n\n/**\n * Private version of copy for stubbing in tests.\n */\nfunction copyInternal(toCopy: ICopyable) {\n  copyData = toCopy.toCopyData();\n}\n\n/**\n * Paste a block or workspace comment on to the main workspace.\n *\n * @returns The pasted thing if the paste was successful, null otherwise.\n * @alias Blockly.clipboard.paste\n * @internal\n */\nexport function paste(): ICopyable|null {\n  if (!copyData) {\n    return null;\n  }\n  // Pasting always pastes to the main workspace, even if the copy\n  // started in a flyout workspace.\n  let workspace = copyData.source;\n  if (workspace.isFlyout) {\n    workspace = workspace.targetWorkspace!;\n  }\n  if (copyData.typeCounts &&\n      workspace.isCapacityAvailable(copyData.typeCounts)) {\n    return workspace.paste(copyData.saveInfo);\n  }\n  return null;\n}\n\n/**\n * Duplicate this block and its children, or a workspace comment.\n *\n * @param toDuplicate Block or Workspace Comment to be duplicated.\n * @returns The block or workspace comment that was duplicated, or null if the\n *     duplication failed.\n * @alias Blockly.clipboard.duplicate\n * @internal\n */\nexport function duplicate(toDuplicate: ICopyable): ICopyable|null {\n  return TEST_ONLY.duplicateInternal(toDuplicate);\n}\n\n/**\n * Private version of duplicate for stubbing in tests.\n */\nfunction duplicateInternal(toDuplicate: ICopyable): ICopyable|null {\n  const oldCopyData = copyData;\n  copy(toDuplicate);\n  const pastedThing =\n      toDuplicate.toCopyData()?.source?.paste(copyData!.saveInfo) ?? null;\n  copyData = oldCopyData;\n  return pastedThing;\n}\n\nexport const TEST_ONLY = {\n  duplicateInternal,\n  copyInternal,\n};\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Functionality for the right-click context menus.\n *\n * @namespace Blockly.ContextMenu\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ContextMenu');\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as clipboard from './clipboard.js';\nimport {config} from './config.js';\nimport type {ContextMenuOption, LegacyContextMenuOption} from './contextmenu_registry.js';\nimport * as eventUtils from './events/utils.js';\nimport {Menu} from './menu.js';\nimport {MenuItem} from './menuitem.js';\nimport {Msg} from './msg.js';\nimport * as aria from './utils/aria.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport * as svgMath from './utils/svg_math.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as Xml from './xml.js';\n\n\n/**\n * Which block is the context menu attached to?\n */\nlet currentBlock: Block|null = null;\n\nconst dummyOwner = {};\n\n/**\n * Gets the block the context menu is currently attached to.\n *\n * @returns The block the context menu is attached to.\n * @alias Blockly.ContextMenu.getCurrentBlock\n */\nexport function getCurrentBlock(): Block|null {\n  return currentBlock;\n}\n\n/**\n * Sets the block the context menu is currently attached to.\n *\n * @param block The block the context menu is attached to.\n * @alias Blockly.ContextMenu.setCurrentBlock\n */\nexport function setCurrentBlock(block: Block|null) {\n  currentBlock = block;\n}\n\n/**\n * Menu object.\n */\nlet menu_: Menu|null = null;\n\n/**\n * Construct the menu based on the list of options and show the menu.\n *\n * @param e Mouse event.\n * @param options Array of menu options.\n * @param rtl True if RTL, false if LTR.\n * @alias Blockly.ContextMenu.show\n */\nexport function show(\n    e: Event, options: (ContextMenuOption|LegacyContextMenuOption)[],\n    rtl: boolean) {\n  WidgetDiv.show(dummyOwner, rtl, dispose);\n  if (!options.length) {\n    hide();\n    return;\n  }\n  const menu = populate_(options, rtl);\n  menu_ = menu;\n\n  position_(menu, e, rtl);\n  // 1ms delay is required for focusing on context menus because some other\n  // mouse event is still waiting in the queue and clears focus.\n  setTimeout(function() {\n    menu.focus();\n  }, 1);\n  currentBlock = null;  // May be set by Blockly.Block.\n}\n\n/**\n * Create the context menu object and populate it with the given options.\n *\n * @param options Array of menu options.\n * @param rtl True if RTL, false if LTR.\n * @returns The menu that will be shown on right click.\n */\nfunction populate_(\n    options: (ContextMenuOption|LegacyContextMenuOption)[],\n    rtl: boolean): Menu {\n  /* Here's what one option object looks like:\n      {text: 'Make It So',\n       enabled: true,\n       callback: Blockly.MakeItSo}\n    */\n  const menu = new Menu();\n  menu.setRole(aria.Role.MENU);\n  for (let i = 0; i < options.length; i++) {\n    const option = options[i];\n    const menuItem = new MenuItem(option.text);\n    menuItem.setRightToLeft(rtl);\n    menuItem.setRole(aria.Role.MENUITEM);\n    menu.addChild(menuItem);\n    menuItem.setEnabled(option.enabled);\n    if (option.enabled) {\n      const actionHandler = function() {\n        hide();\n        // If .scope does not exist on the option, then the callback will not\n        // be expecting a scope parameter, so there should be no problems. Just\n        // assume it is a ContextMenuOption and we'll pass undefined if it's\n        // not.\n        option.callback((option as ContextMenuOption).scope);\n      };\n      menuItem.onAction(actionHandler, {});\n    }\n  }\n  return menu;\n}\n\n/**\n * Add the menu to the page and position it correctly.\n *\n * @param menu The menu to add and position.\n * @param e Mouse event for the right click that is making the context\n *     menu appear.\n * @param rtl True if RTL, false if LTR.\n */\nfunction position_(menu: Menu, e: Event, rtl: boolean) {\n  // Record windowSize and scrollOffset before adding menu.\n  const viewportBBox = svgMath.getViewportBBox();\n  const mouseEvent = e as MouseEvent;\n  // This one is just a point, but we'll pretend that it's a rect so we can use\n  // some helper functions.\n  const anchorBBox = new Rect(\n      mouseEvent.clientY + viewportBBox.top,\n      mouseEvent.clientY + viewportBBox.top,\n      mouseEvent.clientX + viewportBBox.left,\n      mouseEvent.clientX + viewportBBox.left);\n\n  createWidget_(menu);\n  const menuSize = menu.getSize();\n\n  if (rtl) {\n    anchorBBox.left += menuSize.width;\n    anchorBBox.right += menuSize.width;\n    viewportBBox.left += menuSize.width;\n    viewportBBox.right += menuSize.width;\n  }\n\n  WidgetDiv.positionWithAnchor(viewportBBox, anchorBBox, menuSize, rtl);\n  // Calling menuDom.focus() has to wait until after the menu has been placed\n  // correctly.  Otherwise it will cause a page scroll to get the misplaced menu\n  // in view.  See issue #1329.\n  menu.focus();\n}\n\n/**\n * Create and render the menu widget inside Blockly's widget div.\n *\n * @param menu The menu to add to the widget div.\n */\nfunction createWidget_(menu: Menu) {\n  const div = WidgetDiv.getDiv();\n  if (!div) {\n    throw Error('Attempting to create a context menu when widget div is null');\n  }\n  menu.render(div);\n  const menuDom = menu.getElement();\n  dom.addClass((menuDom as Element), 'blocklyContextMenu');\n  // Prevent system context menu when right-clicking a Blockly context menu.\n  browserEvents.conditionalBind(\n      (menuDom as EventTarget), 'contextmenu', null, haltPropagation);\n  // Focus only after the initial render to avoid issue #1329.\n  menu.focus();\n}\n/**\n * Halts the propagation of the event without doing anything else.\n *\n * @param e An event.\n */\nfunction haltPropagation(e: Event) {\n  // This event has been handled.  No need to bubble up to the document.\n  e.preventDefault();\n  e.stopPropagation();\n}\n\n/**\n * Hide the context menu.\n *\n * @alias Blockly.ContextMenu.hide\n */\nexport function hide() {\n  WidgetDiv.hideIfOwner(dummyOwner);\n  currentBlock = null;\n}\n\n/**\n * Dispose of the menu.\n *\n * @alias Blockly.ContextMenu.dispose\n */\nexport function dispose() {\n  if (menu_) {\n    menu_.dispose();\n    menu_ = null;\n  }\n}\n\n/**\n * Create a callback function that creates and configures a block,\n *   then places the new block next to the original.\n *\n * @param block Original block.\n * @param xml XML representation of new block.\n * @returns Function that creates a block.\n * @alias Blockly.ContextMenu.callbackFactory\n */\nexport function callbackFactory(block: Block, xml: Element): Function {\n  return () => {\n    eventUtils.disable();\n    let newBlock;\n    try {\n      newBlock = Xml.domToBlock(xml, block.workspace!) as BlockSvg;\n      // Move the new block next to the old block.\n      const xy = block.getRelativeToSurfaceXY();\n      if (block.RTL) {\n        xy.x -= config.snapRadius;\n      } else {\n        xy.x += config.snapRadius;\n      }\n      xy.y += config.snapRadius * 2;\n      newBlock.moveBy(xy.x, xy.y);\n    } finally {\n      eventUtils.enable();\n    }\n    if (eventUtils.isEnabled() && !newBlock.isShadow()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(newBlock));\n    }\n    newBlock.select();\n  };\n}\n\n// Helper functions for creating context menu options.\n\n/**\n * Make a context menu option for deleting the current workspace comment.\n *\n * @param comment The workspace comment where the\n *     right-click originated.\n * @returns A menu option,\n *     containing text, enabled, and a callback.\n * @alias Blockly.ContextMenu.commentDeleteOption\n * @internal\n */\nexport function commentDeleteOption(comment: WorkspaceCommentSvg):\n    LegacyContextMenuOption {\n  const deleteOption = {\n    text: Msg['REMOVE_COMMENT'],\n    enabled: true,\n    callback: function() {\n      eventUtils.setGroup(true);\n      comment.dispose();\n      eventUtils.setGroup(false);\n    },\n  };\n  return deleteOption;\n}\n\n/**\n * Make a context menu option for duplicating the current workspace comment.\n *\n * @param comment The workspace comment where the\n *     right-click originated.\n * @returns A menu option,\n *     containing text, enabled, and a callback.\n * @alias Blockly.ContextMenu.commentDuplicateOption\n * @internal\n */\nexport function commentDuplicateOption(comment: WorkspaceCommentSvg):\n    LegacyContextMenuOption {\n  const duplicateOption = {\n    text: Msg['DUPLICATE_COMMENT'],\n    enabled: true,\n    callback: function() {\n      clipboard.duplicate(comment);\n    },\n  };\n  return duplicateOption;\n}\n\n/**\n * Make a context menu option for adding a comment on the workspace.\n *\n * @param ws The workspace where the right-click\n *     originated.\n * @param e The right-click mouse event.\n * @returns A menu option, containing text, enabled, and a callback.\n * @suppress {strictModuleDepCheck,checkTypes} Suppress checks while workspace\n *     comments are not bundled in.\n * @alias Blockly.ContextMenu.workspaceCommentOption\n * @internal\n */\nexport function workspaceCommentOption(\n    ws: WorkspaceSvg, e: Event): ContextMenuOption {\n  /**\n   * Helper function to create and position a comment correctly based on the\n   * location of the mouse event.\n   */\n  function addWsComment() {\n    const comment = new WorkspaceCommentSvg(\n        ws, Msg['WORKSPACE_COMMENT_DEFAULT_TEXT'],\n        WorkspaceCommentSvg.DEFAULT_SIZE, WorkspaceCommentSvg.DEFAULT_SIZE);\n\n    const injectionDiv = ws.getInjectionDiv();\n    // Bounding rect coordinates are in client coordinates, meaning that they\n    // are in pixels relative to the upper left corner of the visible browser\n    // window.  These coordinates change when you scroll the browser window.\n    const boundingRect = injectionDiv.getBoundingClientRect();\n\n    // The client coordinates offset by the injection div's upper left corner.\n    const mouseEvent = e as MouseEvent;\n    const clientOffsetPixels = new Coordinate(\n        mouseEvent.clientX - boundingRect.left,\n        mouseEvent.clientY - boundingRect.top);\n\n    // The offset in pixels between the main workspace's origin and the upper\n    // left corner of the injection div.\n    const mainOffsetPixels = ws.getOriginOffsetInPixels();\n\n    // The position of the new comment in pixels relative to the origin of the\n    // main workspace.\n    const finalOffset =\n        Coordinate.difference(clientOffsetPixels, mainOffsetPixels);\n    // The position of the new comment in main workspace coordinates.\n    finalOffset.scale(1 / ws.scale);\n\n    const commentX = finalOffset.x;\n    const commentY = finalOffset.y;\n    comment.moveBy(commentX, commentY);\n    if (ws.rendered) {\n      comment.initSvg();\n      comment.render();\n      comment.select();\n    }\n  }\n\n  const wsCommentOption = {\n    enabled: true,\n  } as ContextMenuOption;\n  wsCommentOption.text = Msg['ADD_COMMENT'];\n  wsCommentOption.callback = function() {\n    addWsComment();\n  };\n  return wsCommentOption;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for creating parts of SVG path strings.  See\n *\n * @namespace Blockly.utils.svgPaths\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.svgPaths');\n\n\n/**\n * Create a string representing the given x, y pair.  It does not matter whether\n * the coordinate is relative or absolute.  The result has leading\n * and trailing spaces, and separates the x and y coordinates with a comma but\n * no space.\n *\n * @param x The x coordinate.\n * @param y The y coordinate.\n * @returns A string of the format ' x,y '\n * @alias Blockly.utils.svgPaths.point\n */\nexport function point(x: number, y: number): string {\n  return ' ' + x + ',' + y + ' ';\n}\n\n/**\n * Draw a cubic or quadratic curve.  See\n * developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d#Cubic_B%C3%A9zier_Curve\n * These coordinates are unitless and hence in the user coordinate system.\n *\n * @param command The command to use.\n *     Should be one of: c, C, s, S, q, Q.\n * @param points  An array containing all of the points to pass to the curve\n *     command, in order.  The points are represented as strings of the format '\n *     x, y '.\n * @returns A string defining one or more Bezier curves.  See the MDN\n *     documentation for exact format.\n * @alias Blockly.utils.svgPaths.curve\n */\nexport function curve(command: string, points: string[]): string {\n  return ' ' + command + points.join('');\n}\n\n/**\n * Move the cursor to the given position without drawing a line.\n * The coordinates are absolute.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param x The absolute x coordinate.\n * @param y The absolute y coordinate.\n * @returns A string of the format ' M x,y '\n * @alias Blockly.utils.svgPaths.moveTo\n */\nexport function moveTo(x: number, y: number): string {\n  return ' M ' + x + ',' + y + ' ';\n}\n\n/**\n * Move the cursor to the given position without drawing a line.\n * Coordinates are relative.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param dx The relative x coordinate.\n * @param dy The relative y coordinate.\n * @returns A string of the format ' m dx,dy '\n * @alias Blockly.utils.svgPaths.moveBy\n */\nexport function moveBy(dx: number, dy: number): string {\n  return ' m ' + dx + ',' + dy + ' ';\n}\n\n/**\n * Draw a line from the current point to the end point, which is the current\n * point shifted by dx along the x-axis and dy along the y-axis.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param dx The relative x coordinate.\n * @param dy The relative y coordinate.\n * @returns A string of the format ' l dx,dy '\n * @alias Blockly.utils.svgPaths.lineTo\n */\nexport function lineTo(dx: number, dy: number): string {\n  return ' l ' + dx + ',' + dy + ' ';\n}\n\n/**\n * Draw multiple lines connecting all of the given points in order.  This is\n * equivalent to a series of 'l' commands.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param points An array containing all of the points to draw lines to, in\n *     order.  The points are represented as strings of the format ' dx,dy '.\n * @returns A string of the format ' l (dx,dy)+ '\n * @alias Blockly.utils.svgPaths.line\n */\nexport function line(points: string[]): string {\n  return ' l' + points.join('');\n}\n\n/**\n * Draw a horizontal or vertical line.\n * The first argument specifies the direction and whether the given position is\n * relative or absolute.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d#LineTo_path_commands\n *\n * @param command The command to prepend to the coordinate.  This should be one\n *     of: V, v, H, h.\n * @param val The coordinate to pass to the command.  It may be absolute or\n *     relative.\n * @returns A string of the format ' command val '\n * @alias Blockly.utils.svgPaths.lineOnAxis\n */\nexport function lineOnAxis(command: string, val: number): string {\n  return ' ' + command + ' ' + val + ' ';\n}\n\n/**\n * Draw an elliptical arc curve.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d#Elliptical_Arc_Curve\n *\n * @param command The command string.  Either 'a' or 'A'.\n * @param flags The flag string.  See the MDN documentation for a description\n *     and examples.\n * @param radius The radius of the arc to draw.\n * @param point The point to move the cursor to after drawing the arc, specified\n *     either in absolute or relative coordinates depending on the command.\n * @returns A string of the format 'command radius radius flags point'\n * @alias Blockly.utils.svgPaths.arc\n */\nexport function arc(\n    command: string, flags: string, radius: number, point: string): string {\n  return command + ' ' + radius + ' ' + radius + ' ' + flags + point;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility functions for positioning UI elements.\n *\n * @namespace Blockly.uiPosition\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.uiPosition');\n\nimport type {UiMetrics} from './metrics_manager.js';\nimport {Scrollbar} from './scrollbar.js';\nimport {Rect} from './utils/rect.js';\nimport type {Size} from './utils/size.js';\nimport * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Enum for vertical positioning.\n *\n * @alias Blockly.uiPosition.verticalPosition\n * @internal\n */\nexport enum verticalPosition {\n  TOP,\n  BOTTOM\n}\n\n/**\n * Enum for horizontal positioning.\n *\n * @alias Blockly.uiPosition.horizontalPosition\n * @internal\n */\nexport enum horizontalPosition {\n  LEFT,\n  RIGHT\n}\n\n/**\n * An object defining a horizontal and vertical positioning.\n *\n * @alias Blockly.uiPosition.Position\n * @internal\n */\nexport interface Position {\n  horizontal: horizontalPosition;\n  vertical: verticalPosition;\n}\n\n/**\n * Enum for bump rules to use for dealing with collisions.\n *\n * @alias Blockly.uiPosition.bumpDirection\n * @internal\n */\nexport enum bumpDirection {\n  UP,\n  DOWN\n}\n\n/**\n * Returns a rectangle representing reasonable position for where to place a UI\n * element of the specified size given the restraints and locations of the\n * scrollbars. This method does not take into account any already placed UI\n * elements.\n *\n * @param position The starting horizontal and vertical position.\n * @param size the size of the UI element to get a start position for.\n * @param horizontalPadding The horizontal padding to use.\n * @param verticalPadding The vertical padding to use.\n * @param metrics The workspace UI metrics.\n * @param workspace The workspace.\n * @returns The suggested start position.\n * @alias Blockly.uiPosition.getStartPositionRect\n * @internal\n */\nexport function getStartPositionRect(\n    position: Position, size: Size, horizontalPadding: number,\n    verticalPadding: number, metrics: UiMetrics,\n    workspace: WorkspaceSvg): Rect {\n  // Horizontal positioning.\n  let left = 0;\n  const hasVerticalScrollbar =\n      workspace.scrollbar && workspace.scrollbar.canScrollVertically();\n  if (position.horizontal === horizontalPosition.LEFT) {\n    left = metrics.absoluteMetrics.left + horizontalPadding;\n    if (hasVerticalScrollbar && workspace.RTL) {\n      left += Scrollbar.scrollbarThickness;\n    }\n  } else {  // position.horizontal === horizontalPosition.RIGHT\n    left = metrics.absoluteMetrics.left + metrics.viewMetrics.width -\n        size.width - horizontalPadding;\n    if (hasVerticalScrollbar && !workspace.RTL) {\n      left -= Scrollbar.scrollbarThickness;\n    }\n  }\n  // Vertical positioning.\n  let top = 0;\n  if (position.vertical === verticalPosition.TOP) {\n    top = metrics.absoluteMetrics.top + verticalPadding;\n  } else {  // position.vertical === verticalPosition.BOTTOM\n    top = metrics.absoluteMetrics.top + metrics.viewMetrics.height -\n        size.height - verticalPadding;\n    if (workspace.scrollbar && workspace.scrollbar.canScrollHorizontally()) {\n      // The scrollbars are always positioned on the bottom if they exist.\n      top -= Scrollbar.scrollbarThickness;\n    }\n  }\n  return new Rect(top, top + size.height, left, left + size.width);\n}\n\n/**\n * Returns a corner position that is on the opposite side of the workspace from\n * the toolbox.\n * If in horizontal orientation, defaults to the bottom corner. If in vertical\n * orientation, defaults to the right corner.\n *\n * @param workspace The workspace.\n * @param metrics The workspace metrics.\n * @returns The suggested corner position.\n * @alias Blockly.uiPosition.getCornerOppositeToolbox\n * @internal\n */\nexport function getCornerOppositeToolbox(\n    workspace: WorkspaceSvg, metrics: UiMetrics): Position {\n  const leftCorner =\n      metrics.toolboxMetrics.position !== toolbox.Position.LEFT &&\n      (!workspace.horizontalLayout || workspace.RTL);\n  const topCorner = metrics.toolboxMetrics.position === toolbox.Position.BOTTOM;\n  const hPosition =\n      leftCorner ? horizontalPosition.LEFT : horizontalPosition.RIGHT;\n  const vPosition = topCorner ? verticalPosition.TOP : verticalPosition.BOTTOM;\n  return {horizontal: hPosition, vertical: vPosition};\n}\n\n/**\n * Returns a position Rect based on a starting position that is bumped\n * so that it doesn't intersect with any of the provided savedPositions. This\n * method does not check that the bumped position is still within bounds.\n *\n * @param startRect The starting position to use.\n * @param margin The margin to use between elements when bumping.\n * @param bumpDir The direction to bump if there is a collision with an existing\n *     UI element.\n * @param savedPositions List of rectangles that represent the positions of UI\n *     elements already placed.\n * @returns The suggested position rectangle.\n * @alias Blockly.uiPosition.bumpPositionRect\n * @internal\n */\nexport function bumpPositionRect(\n    startRect: Rect, margin: number, bumpDir: bumpDirection,\n    savedPositions: Rect[]): Rect {\n  let top = startRect.top;\n  const left = startRect.left;\n  const width = startRect.right - startRect.left;\n  const height = startRect.bottom - startRect.top;\n\n  // Check for collision and bump if needed.\n  let boundingRect = startRect;\n  for (let i = 0; i < savedPositions.length; i++) {\n    const otherEl = savedPositions[i];\n    if (boundingRect.intersects(otherEl)) {\n      if (bumpDir === bumpDirection.UP) {\n        top = otherEl.top - height - margin;\n      } else {  // bumpDir === bumpDirection.DOWN\n        top = otherEl.bottom + margin;\n      }\n      // Recheck other savedPositions\n      boundingRect = new Rect(top, top + height, left, left + width);\n      i = -1;\n    }\n  }\n  return boundingRect;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Registers default keyboard shortcuts.\n *\n * @namespace Blockly.ShortcutItems\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ShortcutItems');\n\nimport {BlockSvg} from './block_svg.js';\nimport * as clipboard from './clipboard.js';\nimport * as common from './common.js';\nimport {Gesture} from './gesture.js';\nimport type {ICopyable} from './interfaces/i_copyable.js';\nimport {KeyboardShortcut, ShortcutRegistry} from './shortcut_registry.js';\nimport {KeyCodes} from './utils/keycodes.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Object holding the names of the default shortcut items.\n *\n * @alias Blockly.ShortcutItems.names\n */\nexport enum names {\n  ESCAPE = 'escape',\n  DELETE = 'delete',\n  COPY = 'copy',\n  CUT = 'cut',\n  PASTE = 'paste',\n  UNDO = 'undo',\n  REDO = 'redo'\n}\n\n/**\n * Keyboard shortcut to hide chaff on escape.\n *\n * @alias Blockly.ShortcutItems.registerEscape\n */\nexport function registerEscape() {\n  const escapeAction: KeyboardShortcut = {\n    name: names.ESCAPE,\n    preconditionFn(workspace) {\n      return !workspace.options.readOnly;\n    },\n    callback(workspace) {\n      // AnyDuringMigration because:  Property 'hideChaff' does not exist on\n      // type 'Workspace'.\n      (workspace as AnyDuringMigration).hideChaff();\n      return true;\n    },\n    keyCodes: [KeyCodes.ESC],\n  };\n  ShortcutRegistry.registry.register(escapeAction);\n}\n\n/**\n * Keyboard shortcut to delete a block on delete or backspace\n *\n * @alias Blockly.ShortcutItems.registerDelete\n */\nexport function registerDelete() {\n  const deleteShortcut: KeyboardShortcut = {\n    name: names.DELETE,\n    preconditionFn(workspace) {\n      const selected = common.getSelected();\n      return !workspace.options.readOnly && selected != null &&\n          selected.isDeletable();\n    },\n    callback(workspace, e) {\n      // Delete or backspace.\n      // Stop the browser from going back to the previous page.\n      // Do this first to prevent an error in the delete code from resulting in\n      // data loss.\n      e.preventDefault();\n      // Don't delete while dragging.  Jeez.\n      if (Gesture.inProgress()) {\n        return false;\n      }\n      (common.getSelected() as BlockSvg).checkAndDelete();\n      return true;\n    },\n    keyCodes: [KeyCodes.DELETE, KeyCodes.BACKSPACE],\n  };\n  ShortcutRegistry.registry.register(deleteShortcut);\n}\n\n/**\n * Keyboard shortcut to copy a block on ctrl+c, cmd+c, or alt+c.\n *\n * @alias Blockly.ShortcutItems.registerCopy\n */\nexport function registerCopy() {\n  const ctrlC = ShortcutRegistry.registry.createSerializedKey(\n      KeyCodes.C, [KeyCodes.CTRL]);\n  const altC =\n      ShortcutRegistry.registry.createSerializedKey(KeyCodes.C, [KeyCodes.ALT]);\n  const metaC = ShortcutRegistry.registry.createSerializedKey(\n      KeyCodes.C, [KeyCodes.META]);\n\n  const copyShortcut: KeyboardShortcut = {\n    name: names.COPY,\n    preconditionFn(workspace) {\n      const selected = common.getSelected();\n      return !workspace.options.readOnly && !Gesture.inProgress() &&\n          selected != null && selected.isDeletable() && selected.isMovable();\n    },\n    callback(workspace, e) {\n      // Prevent the default copy behavior, which may beep or otherwise indicate\n      // an error due to the lack of a selection.\n      e.preventDefault();\n      // AnyDuringMigration because:  Property 'hideChaff' does not exist on\n      // type 'Workspace'.\n      (workspace as AnyDuringMigration).hideChaff();\n      clipboard.copy(common.getSelected() as ICopyable);\n      return true;\n    },\n    keyCodes: [ctrlC, altC, metaC],\n  };\n  ShortcutRegistry.registry.register(copyShortcut);\n}\n\n/**\n * Keyboard shortcut to copy and delete a block on ctrl+x, cmd+x, or alt+x.\n *\n * @alias Blockly.ShortcutItems.registerCut\n */\nexport function registerCut() {\n  const ctrlX = ShortcutRegistry.registry.createSerializedKey(\n      KeyCodes.X, [KeyCodes.CTRL]);\n  const altX =\n      ShortcutRegistry.registry.createSerializedKey(KeyCodes.X, [KeyCodes.ALT]);\n  const metaX = ShortcutRegistry.registry.createSerializedKey(\n      KeyCodes.X, [KeyCodes.META]);\n\n  const cutShortcut: KeyboardShortcut = {\n    name: names.CUT,\n    preconditionFn(workspace) {\n      const selected = common.getSelected();\n      return !workspace.options.readOnly && !Gesture.inProgress() &&\n          selected != null && selected instanceof BlockSvg &&\n          selected.isDeletable() && selected.isMovable() &&\n          !selected.workspace!.isFlyout;\n    },\n    callback() {\n      const selected = common.getSelected();\n      if (!selected) {\n        // Shouldn't happen but appeases the type system\n        return false;\n      }\n      clipboard.copy(selected);\n      (selected as BlockSvg).checkAndDelete();\n      return true;\n    },\n    keyCodes: [ctrlX, altX, metaX],\n  };\n\n  ShortcutRegistry.registry.register(cutShortcut);\n}\n\n/**\n * Keyboard shortcut to paste a block on ctrl+v, cmd+v, or alt+v.\n *\n * @alias Blockly.ShortcutItems.registerPaste\n */\nexport function registerPaste() {\n  const ctrlV = ShortcutRegistry.registry.createSerializedKey(\n      KeyCodes.V, [KeyCodes.CTRL]);\n  const altV =\n      ShortcutRegistry.registry.createSerializedKey(KeyCodes.V, [KeyCodes.ALT]);\n  const metaV = ShortcutRegistry.registry.createSerializedKey(\n      KeyCodes.V, [KeyCodes.META]);\n\n  const pasteShortcut: KeyboardShortcut = {\n    name: names.PASTE,\n    preconditionFn(workspace) {\n      return !workspace.options.readOnly && !Gesture.inProgress();\n    },\n    callback() {\n      return !!(clipboard.paste());\n    },\n    keyCodes: [ctrlV, altV, metaV],\n  };\n\n  ShortcutRegistry.registry.register(pasteShortcut);\n}\n\n/**\n * Keyboard shortcut to undo the previous action on ctrl+z, cmd+z, or alt+z.\n *\n * @alias Blockly.ShortcutItems.registerUndo\n */\nexport function registerUndo() {\n  const ctrlZ = ShortcutRegistry.registry.createSerializedKey(\n      KeyCodes.Z, [KeyCodes.CTRL]);\n  const altZ =\n      ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [KeyCodes.ALT]);\n  const metaZ = ShortcutRegistry.registry.createSerializedKey(\n      KeyCodes.Z, [KeyCodes.META]);\n\n  const undoShortcut: KeyboardShortcut = {\n    name: names.UNDO,\n    preconditionFn(workspace) {\n      return !workspace.options.readOnly && !Gesture.inProgress();\n    },\n    callback(workspace) {\n      // 'z' for undo 'Z' is for redo.\n      (workspace as WorkspaceSvg).hideChaff();\n      workspace.undo(false);\n      return true;\n    },\n    keyCodes: [ctrlZ, altZ, metaZ],\n  };\n  ShortcutRegistry.registry.register(undoShortcut);\n}\n\n/**\n * Keyboard shortcut to redo the previous action on ctrl+shift+z, cmd+shift+z,\n * or alt+shift+z.\n *\n * @alias Blockly.ShortcutItems.registerRedo\n */\nexport function registerRedo() {\n  const ctrlShiftZ = ShortcutRegistry.registry.createSerializedKey(\n      KeyCodes.Z, [KeyCodes.SHIFT, KeyCodes.CTRL]);\n  const altShiftZ = ShortcutRegistry.registry.createSerializedKey(\n      KeyCodes.Z, [KeyCodes.SHIFT, KeyCodes.ALT]);\n  const metaShiftZ = ShortcutRegistry.registry.createSerializedKey(\n      KeyCodes.Z, [KeyCodes.SHIFT, KeyCodes.META]);\n  // Ctrl-y is redo in Windows.  Command-y is never valid on Macs.\n  const ctrlY = ShortcutRegistry.registry.createSerializedKey(\n      KeyCodes.Y, [KeyCodes.CTRL]);\n\n  const redoShortcut: KeyboardShortcut = {\n    name: names.REDO,\n    preconditionFn(workspace) {\n      return !Gesture.inProgress() && !workspace.options.readOnly;\n    },\n    callback(workspace) {\n      // 'z' for undo 'Z' is for redo.\n      (workspace as WorkspaceSvg).hideChaff();\n      workspace.undo(true);\n      return true;\n    },\n    keyCodes: [ctrlShiftZ, altShiftZ, metaShiftZ, ctrlY],\n  };\n  ShortcutRegistry.registry.register(redoShortcut);\n}\n\n/**\n * Registers all default keyboard shortcut item. This should be called once per\n * instance of KeyboardShortcutRegistry.\n *\n * @alias Blockly.ShortcutItems.registerDefaultShortcuts\n * @internal\n */\nexport function registerDefaultShortcuts() {\n  registerEscape();\n  registerDelete();\n  registerCopy();\n  registerCut();\n  registerPaste();\n  registerUndo();\n  registerRedo();\n}\n\nregisterDefaultShortcuts();\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility functions for handling procedures.\n *\n * @namespace Blockly.Procedures\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Procedures');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport {Blocks} from './blocks.js';\nimport * as common from './common.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BubbleOpen} from './events/events_bubble_open.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Field} from './field.js';\nimport {Msg} from './msg.js';\nimport {Names} from './names.js';\nimport * as utilsXml from './utils/xml.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as Xml from './xml.js';\n\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * procedure blocks.\n * See also Blockly.Variables.CATEGORY_NAME and\n * Blockly.VariablesDynamic.CATEGORY_NAME.\n *\n * @alias Blockly.Procedures.CATEGORY_NAME\n */\nexport const CATEGORY_NAME = 'PROCEDURE';\n\n/**\n * The default argument for a procedures_mutatorarg block.\n *\n * @alias Blockly.Procedures.DEFAULT_ARG\n */\nexport const DEFAULT_ARG = 'x';\n\nexport type ProcedureTuple = [string, string[], boolean];\n\n/**\n * Procedure block type.\n *\n * @alias Blockly.Procedures.ProcedureBlock\n */\nexport interface ProcedureBlock {\n  getProcedureCall: () => string;\n  renameProcedure: (p1: string, p2: string) => void;\n  getProcedureDef: () => ProcedureTuple;\n}\n\n/**\n * Find all user-created procedure definitions in a workspace.\n *\n * @param root Root workspace.\n * @returns Pair of arrays, the first contains procedures without return\n *     variables, the second with. Each procedure is defined by a three-element\n *     list of name, parameter list, and return value boolean.\n * @alias Blockly.Procedures.allProcedures\n */\nexport function allProcedures(root: Workspace):\n    [ProcedureTuple[], ProcedureTuple[]] {\n  const proceduresNoReturn =\n      root.getBlocksByType('procedures_defnoreturn', false)\n          .map(function(block) {\n            return (block as unknown as ProcedureBlock).getProcedureDef();\n          });\n  const proceduresReturn =\n      root.getBlocksByType('procedures_defreturn', false).map(function(block) {\n        return (block as unknown as ProcedureBlock).getProcedureDef();\n      });\n  proceduresNoReturn.sort(procTupleComparator);\n  proceduresReturn.sort(procTupleComparator);\n  return [proceduresNoReturn, proceduresReturn];\n}\n\n/**\n * Comparison function for case-insensitive sorting of the first element of\n * a tuple.\n *\n * @param ta First tuple.\n * @param tb Second tuple.\n * @returns -1, 0, or 1 to signify greater than, equality, or less than.\n */\nfunction procTupleComparator(ta: ProcedureTuple, tb: ProcedureTuple): number {\n  return ta[0].localeCompare(tb[0], undefined, {sensitivity: 'base'});\n}\n\n/**\n * Ensure two identically-named procedures don't exist.\n * Take the proposed procedure name, and return a legal name i.e. one that\n * is not empty and doesn't collide with other procedures.\n *\n * @param name Proposed procedure name.\n * @param block Block to disambiguate.\n * @returns Non-colliding name.\n * @alias Blockly.Procedures.findLegalName\n */\nexport function findLegalName(name: string, block: Block): string {\n  if (block.isInFlyout) {\n    // Flyouts can have multiple procedures called 'do something'.\n    return name;\n  }\n  name = name || Msg['UNNAMED_KEY'] || 'unnamed';\n  while (!isLegalName(name, block.workspace, block)) {\n    // Collision with another procedure.\n    const r = name.match(/^(.*?)(\\d+)$/);\n    if (!r) {\n      name += '2';\n    } else {\n      name = r[1] + (parseInt(r[2], 10) + 1);\n    }\n  }\n  return name;\n}\n/**\n * Does this procedure have a legal name?  Illegal names include names of\n * procedures already defined.\n *\n * @param name The questionable name.\n * @param workspace The workspace to scan for collisions.\n * @param opt_exclude Optional block to exclude from comparisons (one doesn't\n *     want to collide with oneself).\n * @returns True if the name is legal.\n */\nfunction isLegalName(\n    name: string, workspace: Workspace, opt_exclude?: Block): boolean {\n  return !isNameUsed(name, workspace, opt_exclude);\n}\n\n/**\n * Return if the given name is already a procedure name.\n *\n * @param name The questionable name.\n * @param workspace The workspace to scan for collisions.\n * @param opt_exclude Optional block to exclude from comparisons (one doesn't\n *     want to collide with oneself).\n * @returns True if the name is used, otherwise return false.\n * @alias Blockly.Procedures.isNameUsed\n */\nexport function isNameUsed(\n    name: string, workspace: Workspace, opt_exclude?: Block): boolean {\n  const blocks = workspace.getAllBlocks(false);\n  // Iterate through every block and check the name.\n  for (let i = 0; i < blocks.length; i++) {\n    if (blocks[i] === opt_exclude) {\n      continue;\n    }\n    // Assume it is a procedure block so we can check.\n    const procedureBlock = blocks[i] as unknown as ProcedureBlock;\n    if (procedureBlock.getProcedureDef) {\n      const procName = procedureBlock.getProcedureDef();\n      if (Names.equals(procName[0], name)) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\n/**\n * Rename a procedure.  Called by the editable field.\n *\n * @param name The proposed new name.\n * @returns The accepted name.\n * @alias Blockly.Procedures.rename\n */\nexport function rename(this: Field, name: string): string {\n  // Strip leading and trailing whitespace.  Beyond this, all names are legal.\n  name = name.trim();\n\n  const legalName = findLegalName(name, (this.getSourceBlock()));\n  const oldName = this.getValue();\n  if (oldName !== name && oldName !== legalName) {\n    // Rename any callers.\n    const blocks = this.getSourceBlock().workspace.getAllBlocks(false);\n    for (let i = 0; i < blocks.length; i++) {\n      // Assume it is a procedure so we can check.\n      const procedureBlock = blocks[i] as unknown as ProcedureBlock;\n      if (procedureBlock.renameProcedure) {\n        procedureBlock.renameProcedure(oldName as string, legalName);\n      }\n    }\n  }\n  return legalName;\n}\n\n/**\n * Construct the blocks required by the flyout for the procedure category.\n *\n * @param workspace The workspace containing procedures.\n * @returns Array of XML block elements.\n * @alias Blockly.Procedures.flyoutCategory\n */\nexport function flyoutCategory(workspace: WorkspaceSvg): Element[] {\n  const xmlList = [];\n  if (Blocks['procedures_defnoreturn']) {\n    // <block type=\"procedures_defnoreturn\" gap=\"16\">\n    //     <field name=\"NAME\">do something</field>\n    // </block>\n    const block = utilsXml.createElement('block');\n    block.setAttribute('type', 'procedures_defnoreturn');\n    block.setAttribute('gap', '16');\n    const nameField = utilsXml.createElement('field');\n    nameField.setAttribute('name', 'NAME');\n    nameField.appendChild(\n        utilsXml.createTextNode(Msg['PROCEDURES_DEFNORETURN_PROCEDURE']));\n    block.appendChild(nameField);\n    xmlList.push(block);\n  }\n  if (Blocks['procedures_defreturn']) {\n    // <block type=\"procedures_defreturn\" gap=\"16\">\n    //     <field name=\"NAME\">do something</field>\n    // </block>\n    const block = utilsXml.createElement('block');\n    block.setAttribute('type', 'procedures_defreturn');\n    block.setAttribute('gap', '16');\n    const nameField = utilsXml.createElement('field');\n    nameField.setAttribute('name', 'NAME');\n    nameField.appendChild(\n        utilsXml.createTextNode(Msg['PROCEDURES_DEFRETURN_PROCEDURE']));\n    block.appendChild(nameField);\n    xmlList.push(block);\n  }\n  if (Blocks['procedures_ifreturn']) {\n    // <block type=\"procedures_ifreturn\" gap=\"16\"></block>\n    const block = utilsXml.createElement('block');\n    block.setAttribute('type', 'procedures_ifreturn');\n    block.setAttribute('gap', '16');\n    xmlList.push(block);\n  }\n  if (xmlList.length) {\n    // Add slightly larger gap between system blocks and user calls.\n    xmlList[xmlList.length - 1].setAttribute('gap', '24');\n  }\n\n  /**\n   * Add items to xmlList for each listed procedure.\n   *\n   * @param procedureList A list of procedures, each of which is defined by a\n   *     three-element list of name, parameter list, and return value boolean.\n   * @param templateName The type of the block to generate.\n   */\n  function populateProcedures(\n      procedureList: ProcedureTuple[], templateName: string) {\n    for (let i = 0; i < procedureList.length; i++) {\n      const name = procedureList[i][0];\n      const args = procedureList[i][1];\n      // <block type=\"procedures_callnoreturn\" gap=\"16\">\n      //   <mutation name=\"do something\">\n      //     <arg name=\"x\"></arg>\n      //   </mutation>\n      // </block>\n      const block = utilsXml.createElement('block');\n      block.setAttribute('type', templateName);\n      block.setAttribute('gap', '16');\n      const mutation = utilsXml.createElement('mutation');\n      mutation.setAttribute('name', name);\n      block.appendChild(mutation);\n      for (let j = 0; j < args.length; j++) {\n        const arg = utilsXml.createElement('arg');\n        arg.setAttribute('name', args[j]);\n        mutation.appendChild(arg);\n      }\n      xmlList.push(block);\n    }\n  }\n\n  const tuple = allProcedures(workspace);\n  populateProcedures(tuple[0], 'procedures_callnoreturn');\n  populateProcedures(tuple[1], 'procedures_callreturn');\n  return xmlList;\n}\n\n/**\n * Updates the procedure mutator's flyout so that the arg block is not a\n * duplicate of another arg.\n *\n * @param workspace The procedure mutator's workspace. This workspace's flyout\n *     is what is being updated.\n */\nfunction updateMutatorFlyout(workspace: WorkspaceSvg) {\n  const usedNames = [];\n  const blocks = workspace.getBlocksByType('procedures_mutatorarg', false);\n  for (let i = 0, block; block = blocks[i]; i++) {\n    usedNames.push(block.getFieldValue('NAME'));\n  }\n\n  const xmlElement = utilsXml.createElement('xml');\n  const argBlock = utilsXml.createElement('block');\n  argBlock.setAttribute('type', 'procedures_mutatorarg');\n  const nameField = utilsXml.createElement('field');\n  nameField.setAttribute('name', 'NAME');\n  const argValue =\n      Variables.generateUniqueNameFromOptions(DEFAULT_ARG, usedNames);\n  const fieldContent = utilsXml.createTextNode(argValue);\n\n  nameField.appendChild(fieldContent);\n  argBlock.appendChild(nameField);\n  xmlElement.appendChild(argBlock);\n\n  workspace.updateToolbox(xmlElement);\n}\n\n/**\n * Listens for when a procedure mutator is opened. Then it triggers a flyout\n * update and adds a mutator change listener to the mutator workspace.\n *\n * @param e The event that triggered this listener.\n * @alias Blockly.Procedures.mutatorOpenListener\n * @internal\n */\nexport function mutatorOpenListener(e: Abstract) {\n  if (e.type !== eventUtils.BUBBLE_OPEN) {\n    return;\n  }\n  const bubbleEvent = e as BubbleOpen;\n  if (!(bubbleEvent.bubbleType === 'mutator' && bubbleEvent.isOpen) ||\n      !bubbleEvent.blockId) {\n    return;\n  }\n  const workspaceId = (bubbleEvent.workspaceId);\n  const block = common.getWorkspaceById(workspaceId)!.getBlockById(\n                    bubbleEvent.blockId) as BlockSvg;\n  const type = block.type;\n  if (type !== 'procedures_defnoreturn' && type !== 'procedures_defreturn') {\n    return;\n  }\n  const workspace = block.mutator!.getWorkspace() as WorkspaceSvg;\n  updateMutatorFlyout(workspace);\n  workspace.addChangeListener(mutatorChangeListener);\n}\n/**\n * Listens for changes in a procedure mutator and triggers flyout updates when\n * necessary.\n *\n * @param e The event that triggered this listener.\n */\nfunction mutatorChangeListener(e: Abstract) {\n  if (e.type !== eventUtils.BLOCK_CREATE &&\n      e.type !== eventUtils.BLOCK_DELETE &&\n      e.type !== eventUtils.BLOCK_CHANGE) {\n    return;\n  }\n  const workspaceId = e.workspaceId as string;\n  const workspace = common.getWorkspaceById(workspaceId) as WorkspaceSvg;\n  updateMutatorFlyout(workspace);\n}\n\n/**\n * Find all the callers of a named procedure.\n *\n * @param name Name of procedure.\n * @param workspace The workspace to find callers in.\n * @returns Array of caller blocks.\n * @alias Blockly.Procedures.getCallers\n */\nexport function getCallers(name: string, workspace: Workspace): Block[] {\n  const callers = [];\n  const blocks = workspace.getAllBlocks(false);\n  // Iterate through every block and check the name.\n  for (let i = 0; i < blocks.length; i++) {\n    // Assume it is a procedure block so we can check.\n    const procedureBlock = blocks[i] as unknown as ProcedureBlock;\n    if (procedureBlock.getProcedureCall) {\n      const procName = procedureBlock.getProcedureCall();\n      // Procedure name may be null if the block is only half-built.\n      if (procName && Names.equals(procName, name)) {\n        callers.push(blocks[i]);\n      }\n    }\n  }\n  return callers;\n}\n\n/**\n * When a procedure definition changes its parameters, find and edit all its\n * callers.\n *\n * @param defBlock Procedure definition block.\n * @alias Blockly.Procedures.mutateCallers\n */\nexport function mutateCallers(defBlock: Block) {\n  const oldRecordUndo = eventUtils.getRecordUndo();\n  const procedureBlock = defBlock as unknown as ProcedureBlock;\n  const name = procedureBlock.getProcedureDef()[0];\n  const xmlElement = defBlock.mutationToDom!(true);\n  const callers = getCallers(name, defBlock.workspace);\n  for (let i = 0, caller; caller = callers[i]; i++) {\n    const oldMutationDom = caller.mutationToDom!();\n    const oldMutation = oldMutationDom && Xml.domToText(oldMutationDom);\n    if (caller.domToMutation) {\n      caller.domToMutation(xmlElement);\n    }\n    const newMutationDom = caller.mutationToDom!();\n    const newMutation = newMutationDom && Xml.domToText(newMutationDom);\n    if (oldMutation !== newMutation) {\n      // Fire a mutation on every caller block.  But don't record this as an\n      // undo action since it is deterministically tied to the procedure's\n      // definition mutation.\n      eventUtils.setRecordUndo(false);\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          caller, 'mutation', null, oldMutation, newMutation));\n      eventUtils.setRecordUndo(oldRecordUndo);\n    }\n  }\n}\n\n/**\n * Find the definition block for the named procedure.\n *\n * @param name Name of procedure.\n * @param workspace The workspace to search.\n * @returns The procedure definition block, or null not found.\n * @alias Blockly.Procedures.getDefinition\n */\nexport function getDefinition(name: string, workspace: Workspace): Block|null {\n  // Do not assume procedure is a top block. Some languages allow nested\n  // procedures. Also do not assume it is one of the built-in blocks. Only\n  // rely on getProcedureDef.\n  const blocks = workspace.getAllBlocks(false);\n  for (let i = 0; i < blocks.length; i++) {\n    // Assume it is a procedure block so we can check.\n    const procedureBlock = blocks[i] as unknown as ProcedureBlock;\n    if (procedureBlock.getProcedureDef) {\n      const tuple = procedureBlock.getProcedureDef();\n      if (tuple && Names.equals(tuple[0], name)) {\n        return blocks[i];  // Can't use procedureBlock var due to type check.\n      }\n    }\n  }\n  return null;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Block rendering debugging functionality.\n *\n * @namespace Blockly.blockRendering.debug\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.debug');\n\nimport * as deprecation from '../../utils/deprecation.js';\n\n\n/** Whether or not the debugger is turned on. */\nlet useDebugger = false;\n/**\n * Returns whether the debugger is turned on.\n *\n * @returns Whether the debugger is turned on.\n * @alias Blockly.blockRendering.debug.isDebuggerEnabled\n * @internal\n */\nexport function isDebuggerEnabled(): boolean {\n  return useDebugger;\n}\n\n/**\n * Turn on the blocks debugger.\n *\n * @alias Blockly.blockRendering.debug.startDebugger\n * @deprecated March 2022. Use the rendering debugger in @blockly/dev-tools.\n * See https://www.npmjs.com/package/@blockly/dev-tools for more information.\n * @internal\n */\nexport function startDebugger() {\n  deprecation.warn(\n      'Blockly.blockRendering.debug.startDebugger()', 'February 2022',\n      'September 2022',\n      'the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)');\n  useDebugger = true;\n}\n\n/**\n * Turn off the blocks debugger.\n *\n * @alias Blockly.blockRendering.debug.stopDebugger\n * @deprecated March 2022. Use the rendering debugger in @blockly/dev-tools.\n * See https://www.npmjs.com/package/@blockly/dev-tools for more information.\n * @internal\n */\nexport function stopDebugger() {\n  deprecation.warn(\n      'Blockly.blockRendering.debug.stopDebugger()', 'February 2022',\n      'September 2022',\n      'the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)');\n  useDebugger = false;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Namespace for block rendering functionality.\n *\n * @namespace Blockly.blockRendering\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering');\n\nimport * as registry from '../../registry.js';\nimport type {Theme} from '../../theme.js';\nimport * as deprecation from '../../utils/deprecation.js';\nimport {Measurable} from '../measurables/base.js';\nimport {BottomRow} from '../measurables/bottom_row.js';\nimport {Connection} from '../measurables/connection.js';\nimport {ExternalValueInput} from '../measurables/external_value_input.js';\nimport {Field} from '../measurables/field.js';\nimport {Hat} from '../measurables/hat.js';\nimport {Icon} from '../measurables/icon.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport {InlineInput} from '../measurables/inline_input.js';\nimport {InputConnection} from '../measurables/input_connection.js';\nimport {InputRow} from '../measurables/input_row.js';\nimport {JaggedEdge} from '../measurables/jagged_edge.js';\nimport {NextConnection} from '../measurables/next_connection.js';\nimport {OutputConnection} from '../measurables/output_connection.js';\nimport {PreviousConnection} from '../measurables/previous_connection.js';\nimport {RoundCorner} from '../measurables/round_corner.js';\nimport {Row} from '../measurables/row.js';\nimport {SpacerRow} from '../measurables/spacer_row.js';\nimport {SquareCorner} from '../measurables/square_corner.js';\nimport {StatementInput} from '../measurables/statement_input.js';\nimport {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport {ConstantProvider} from './constants.js';\nimport * as debug from './debug.js';\nimport {Debug} from './debugger.js';\nimport {Drawer} from './drawer.js';\nimport type {IPathObject} from './i_path_object.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {PathObject} from './path_object.js';\nimport {Renderer} from './renderer.js';\n\n\n/**\n * Returns whether the debugger is turned on.\n *\n * @returns Whether the debugger is turned on.\n * @alias Blockly.blockRendering.isDebuggerEnabled\n * @deprecated\n * @internal\n */\nexport function isDebuggerEnabled(): boolean {\n  deprecation.warn(\n      'Blockly.blockRendering.isDebuggerEnabled()', 'September 2021',\n      'September 2022',\n      'the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)');\n  return debug.isDebuggerEnabled();\n}\n\n/**\n * Registers a new renderer.\n *\n * @param name The name of the renderer.\n * @param rendererClass The new renderer class to register.\n * @throws {Error} if a renderer with the same name has already been registered.\n */\nexport function register(name: string, rendererClass: Function) {\n  registry.register(registry.Type.RENDERER, name, rendererClass);\n}\n\n/**\n * Unregisters the renderer registered with the given name.\n *\n * @param name The name of the renderer.\n * @alias Blockly.blockRendering.unregister\n */\nexport function unregister(name: string) {\n  registry.unregister(registry.Type.RENDERER, name);\n}\n\n/**\n * Turn on the blocks debugger.\n *\n * @alias Blockly.blockRendering.startDebugger\n * @deprecated\n * @internal\n */\nexport function startDebugger() {\n  deprecation.warn(\n      'Blockly.blockRendering.startDebugger()', 'September 2021',\n      'September 2022',\n      'the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)');\n  debug.startDebugger();\n}\n\n/**\n * Turn off the blocks debugger.\n *\n * @alias Blockly.blockRendering.stopDebugger\n * @deprecated\n * @internal\n */\nexport function stopDebugger() {\n  deprecation.warn(\n      'Blockly.blockRendering.stopDebugger()', 'September 2021',\n      'September 2022',\n      'the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)');\n  debug.stopDebugger();\n}\n\n/**\n * Initialize anything needed for rendering (constants, etc).\n *\n * @param name Name of the renderer to initialize.\n * @param theme The workspace theme object.\n * @param opt_rendererOverrides Rendering constant overrides.\n * @returns The new instance of a renderer.\n *     Already initialized.\n * @alias Blockly.blockRendering.init\n * @internal\n */\nexport function init(\n    name: string, theme: Theme,\n    opt_rendererOverrides?: {[rendererConstant: string]: any}): Renderer {\n  const rendererClass = registry.getClass(registry.Type.RENDERER, name);\n  const renderer = new rendererClass!(name);\n  renderer.init(theme, opt_rendererOverrides);\n  return renderer;\n}\nexport {BottomRow};\nexport {Connection};\nexport {ConstantProvider};\nexport {Debug};\nexport {Drawer};\nexport {ExternalValueInput};\nexport {Field};\nexport {Hat};\nexport {Icon};\nexport {InRowSpacer};\nexport {InlineInput};\nexport {InputConnection};\nexport {InputRow};\nexport {IPathObject};\nexport {JaggedEdge};\nexport {MarkerSvg};\nexport {Measurable};\nexport {NextConnection};\nexport {OutputConnection};\nexport {PathObject};\nexport {PreviousConnection};\nexport {Renderer};\nexport {RenderInfo};\nexport {RoundCorner};\nexport {Row};\nexport {SpacerRow};\nexport {SquareCorner};\nexport {StatementInput};\nexport {TopRow};\nexport {Types};\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods.\n *\n * @namespace Blockly.utils\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils');\n\nimport type {Block} from './block.js';\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\nimport * as extensions from './extensions.js';\nimport * as aria from './utils/aria.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as colour from './utils/colour.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as deprecation from './utils/deprecation.js';\nimport * as dom from './utils/dom.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport {KeyCodes} from './utils/keycodes.js';\nimport * as math from './utils/math.js';\nimport type {Metrics} from './utils/metrics.js';\nimport * as object from './utils/object.js';\nimport * as parsing from './utils/parsing.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport * as stringUtils from './utils/string.js';\nimport * as style from './utils/style.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport * as svgPaths from './utils/svg_paths.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as xml from './utils/xml.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\nexport {\n  aria,\n  arrayUtils as array,\n  browserEvents,\n  colour,\n  Coordinate,\n  deprecation,\n  dom,\n  extensions,\n  idGenerator,\n  KeyCodes,\n  math,\n  Metrics,\n  object,\n  parsing,\n  Rect,\n  Size,\n  stringUtils as string,\n  style,\n  Svg,\n  svgMath,\n  svgPaths,\n  toolbox,\n  userAgent,\n  xml,\n};\n\n/**\n * Halts the propagation of the event without doing anything else.\n *\n * @param e An event.\n * @deprecated\n * @alias Blockly.utils.noEvent\n */\nexport function noEvent(e: Event) {\n  deprecation.warn('Blockly.utils.noEvent', 'September 2021', 'September 2022');\n  // This event has been handled.  No need to bubble up to the document.\n  e.preventDefault();\n  e.stopPropagation();\n}\n\n/**\n * Returns true if this event is targeting a text input widget?\n *\n * @param e An event.\n * @returns True if text input.\n * @deprecated Use Blockly.browserEvents.isTargetInput instead.\n * @alias Blockly.utils.isTargetInput\n */\nexport function isTargetInput(e: Event): boolean {\n  deprecation.warn(\n      'Blockly.utils.isTargetInput', 'September 2021', 'September 2022',\n      'Blockly.browserEvents.isTargetInput');\n  return browserEvents.isTargetInput(e);\n}\n\n/**\n * Return the coordinates of the top-left corner of this element relative to\n * its parent.  Only for SVG elements and children (e.g. rect, g, path).\n *\n * @param element SVG element to find the coordinates of.\n * @returns Object with .x and .y properties.\n * @deprecated\n * @alias Blockly.utils.getRelativeXY\n */\nexport function getRelativeXY(element: Element): Coordinate {\n  deprecation.warn(\n      'Blockly.utils.getRelativeXY', 'December 2021', 'December 2022',\n      'Blockly.utils.svgMath.getRelativeXY');\n  return svgMath.getRelativeXY(element);\n}\n\n/**\n * Return the coordinates of the top-left corner of this element relative to\n * the div Blockly was injected into.\n *\n * @param element SVG element to find the coordinates of. If this is not a child\n *     of the div Blockly was injected into, the behaviour is undefined.\n * @returns Object with .x and .y properties.\n * @deprecated\n * @alias Blockly.utils.getInjectionDivXY_\n */\nfunction getInjectionDivXY(element: Element): Coordinate {\n  deprecation.warn(\n      'Blockly.utils.getInjectionDivXY_', 'December 2021', 'December 2022',\n      'Blockly.utils.svgMath.getInjectionDivXY');\n  return svgMath.getInjectionDivXY(element);\n}\nexport const getInjectionDivXY_ = getInjectionDivXY;\n\n/**\n * Returns true this event is a right-click.\n *\n * @param e Mouse event.\n * @returns True if right-click.\n * @deprecated Use Blockly.browserEvents.isRightButton instead.\n * @alias Blockly.utils.isRightButton\n */\nexport function isRightButton(e: Event): boolean {\n  deprecation.warn(\n      'Blockly.utils.isRightButton', 'September 2021', 'September 2022',\n      'Blockly.browserEvents.isRightButton');\n  return browserEvents.isRightButton(e as MouseEvent);\n}\n\n/**\n * Returns the converted coordinates of the given mouse event.\n * The origin (0,0) is the top-left corner of the Blockly SVG.\n *\n * @param e Mouse event.\n * @param svg SVG element.\n * @param matrix Inverted screen CTM to use.\n * @returns Object with .x and .y properties.\n * @deprecated Use Blockly.browserEvents.mouseToSvg instead;\n * @alias Blockly.utils.mouseToSvg\n */\nexport function mouseToSvg(\n    e: Event, svg: SVGSVGElement, matrix: SVGMatrix|null): SVGPoint {\n  deprecation.warn(\n      'Blockly.utils.mouseToSvg', 'September 2021', 'September 2022',\n      'Blockly.browserEvents.mouseToSvg');\n  return browserEvents.mouseToSvg(e as MouseEvent, svg, matrix);\n}\n\n/**\n * Returns the scroll delta of a mouse event in pixel units.\n *\n * @param e Mouse event.\n * @returns Scroll delta object with .x and .y properties.\n * @deprecated Use Blockly.browserEvents.getScrollDeltaPixels instead.\n * @alias Blockly.utils.getScrollDeltaPixels\n */\nexport function getScrollDeltaPixels(e: WheelEvent): {x: number, y: number} {\n  deprecation.warn(\n      'Blockly.utils.getScrollDeltaPixels', 'September 2021', 'September 2022',\n      'Blockly.browserEvents.getScrollDeltaPixels');\n  return browserEvents.getScrollDeltaPixels(e);\n}\n\n/**\n * Parse a string with any number of interpolation tokens (%1, %2, ...).\n * It will also replace string table references (e.g., %{bky_my_msg} and\n * %{BKY_MY_MSG} will both be replaced with the value in\n * Msg['MY_MSG']). Percentage sign characters '%' may be self-escaped\n * (e.g., '%%').\n *\n * @param message Text which might contain string table references and\n *     interpolation tokens.\n * @returns Array of strings and numbers.\n * @deprecated\n * @alias Blockly.utils.tokenizeInterpolation\n */\nexport function tokenizeInterpolation(message: string): Array<string|number> {\n  deprecation.warn(\n      'Blockly.utils.tokenizeInterpolation', 'December 2021', 'December 2022',\n      'Blockly.utils.parsing.tokenizeInterpolation');\n  return parsing.tokenizeInterpolation(message);\n}\n\n/**\n * Replaces string table references in a message, if the message is a string.\n * For example, \"%{bky_my_msg}\" and \"%{BKY_MY_MSG}\" will both be replaced with\n * the value in Msg['MY_MSG'].\n *\n * @param message Message, which may be a string that contains string table\n *     references.\n * @returns String with message references replaced.\n * @deprecated\n * @alias Blockly.utils.replaceMessageReferences\n */\nexport function replaceMessageReferences(message: string|any): string {\n  deprecation.warn(\n      'Blockly.utils.replaceMessageReferences', 'December 2021',\n      'December 2022', 'Blockly.utils.parsing.replaceMessageReferences');\n  return parsing.replaceMessageReferences(message);\n}\n\n/**\n * Validates that any %{MSG_KEY} references in the message refer to keys of\n * the Msg string table.\n *\n * @param message Text which might contain string table references.\n * @returns True if all message references have matching values.\n *     Otherwise, false.\n * @deprecated\n * @alias Blockly.utils.checkMessageReferences\n */\nexport function checkMessageReferences(message: string): boolean {\n  deprecation.warn(\n      'Blockly.utils.checkMessageReferences', 'December 2021', 'December 2022',\n      'Blockly.utils.parsing.checkMessageReferences');\n  return parsing.checkMessageReferences(message);\n}\n\n/**\n * Generate a unique ID.\n *\n * @returns A globally unique ID string.\n * @deprecated Use Blockly.utils.idGenerator.genUid instead.\n * @alias Blockly.utils.genUid\n */\nexport function genUid(): string {\n  deprecation.warn(\n      'Blockly.utils.genUid', 'September 2021', 'September 2022',\n      'Blockly.utils.idGenerator.genUid');\n  return idGenerator.genUid();\n}\n\n/**\n * Check if 3D transforms are supported by adding an element\n * and attempting to set the property.\n *\n * @returns True if 3D transforms are supported.\n * @deprecated\n * @alias Blockly.utils.is3dSupported\n */\nexport function is3dSupported(): boolean {\n  deprecation.warn(\n      'Blockly.utils.is3dSupported', 'December 2021', 'December 2022',\n      'Blockly.utils.svgMath.is3dSupported');\n  return svgMath.is3dSupported();\n}\n\n/**\n * Get the position of the current viewport in window coordinates.  This takes\n * scroll into account.\n *\n * @returns An object containing window width, height, and scroll position in\n *     window coordinates.\n * @alias Blockly.utils.getViewportBBox\n * @deprecated\n * @internal\n */\nexport function getViewportBBox(): Rect {\n  deprecation.warn(\n      'Blockly.utils.getViewportBBox', 'December 2021', 'December 2022',\n      'Blockly.utils.svgMath.getViewportBBox');\n  return svgMath.getViewportBBox();\n}\n\n/**\n * Removes the first occurrence of a particular value from an array.\n *\n * @param arr Array from which to remove value.\n * @param value Value to remove.\n * @returns True if an element was removed.\n * @alias Blockly.utils.arrayRemove\n * @deprecated\n * @internal\n */\nexport function arrayRemove<T>(arr: Array<T>, value: T): boolean {\n  deprecation.warn(\n      'Blockly.utils.arrayRemove', 'December 2021', 'December 2022');\n  return arrayUtils.removeElem(arr, value);\n}\n\n/**\n * Gets the document scroll distance as a coordinate object.\n * Copied from Closure's goog.dom.getDocumentScroll.\n *\n * @returns Object with values 'x' and 'y'.\n * @deprecated\n * @alias Blockly.utils.getDocumentScroll\n */\nexport function getDocumentScroll(): Coordinate {\n  deprecation.warn(\n      'Blockly.utils.getDocumentScroll', 'December 2021', 'December 2022',\n      'Blockly.utils.svgMath.getDocumentScroll');\n  return svgMath.getDocumentScroll();\n}\n\n/**\n * Get a map of all the block's descendants mapping their type to the number of\n *    children with that type.\n *\n * @param block The block to map.\n * @param opt_stripFollowing Optionally ignore all following statements (blocks\n *     that are not inside a value or statement input of the block).\n * @returns Map of types to type counts for descendants of the bock.\n * @deprecated\n * @alias Blockly.utils.getBlockTypeCounts\n */\nexport function getBlockTypeCounts(\n    block: Block, opt_stripFollowing?: boolean): {[key: string]: number} {\n  deprecation.warn(\n      'Blockly.utils.getBlockTypeCounts', 'December 2021', 'December 2022',\n      'Blockly.common.getBlockTypeCounts');\n  return common.getBlockTypeCounts(block, opt_stripFollowing);\n}\n\n/**\n * Converts screen coordinates to workspace coordinates.\n *\n * @param ws The workspace to find the coordinates on.\n * @param screenCoordinates The screen coordinates to be converted to workspace\n *     coordinates\n * @deprecated\n * @returns The workspace coordinates.\n */\nexport function screenToWsCoordinates(\n    ws: WorkspaceSvg, screenCoordinates: Coordinate): Coordinate {\n  deprecation.warn(\n      'Blockly.utils.screenToWsCoordinates', 'December 2021', 'December 2022',\n      'Blockly.utils.svgMath.screenToWsCoordinates');\n  return svgMath.screenToWsCoordinates(ws, screenCoordinates);\n}\n\n/**\n * Parse a block colour from a number or string, as provided in a block\n * definition.\n *\n * @param colour HSV hue value (0 to 360), #RRGGBB string, or a message\n *     reference string pointing to one of those two values.\n * @returns An object containing the colour as a #RRGGBB string, and the hue if\n *     the input was an HSV hue value.\n * @throws {Error} If the colour cannot be parsed.\n * @deprecated\n * @alias Blockly.utils.parseBlockColour\n */\nexport function parseBlockColour(colour: number|\n                                 string): {hue: number|null, hex: string} {\n  deprecation.warn(\n      'Blockly.utils.parseBlockColour', 'December 2021', 'December 2022',\n      'Blockly.utils.parsing.parseBlockColour');\n  return parsing.parseBlockColour(colour);\n}\n\n/**\n * Calls a function after the page has loaded, possibly immediately.\n *\n * @param fn Function to run.\n * @throws Error Will throw if no global document can be found (e.g., Node.js).\n * @deprecated\n * @alias Blockly.utils.runAfterPageLoad\n */\nexport function runAfterPageLoad(fn: () => void) {\n  deprecation.warn(\n      'Blockly.utils.runAfterPageLoad', 'December 2021', 'December 2022');\n  extensions.runAfterPageLoad(fn);\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility functions for handling typed variables.\n *\n * @namespace Blockly.VariablesDynamic\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.VariablesDynamic');\n\nimport {Blocks} from './blocks.js';\nimport {Msg} from './msg.js';\nimport * as xml from './utils/xml.js';\nimport {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport type {FlyoutButton} from './flyout_button.js';\n\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n * See also Blockly.Variables.CATEGORY_NAME and\n * Blockly.Procedures.CATEGORY_NAME.\n *\n * @alias Blockly.VariablesDynamic.CATEGORY_NAME\n */\nexport const CATEGORY_NAME = 'VARIABLE_DYNAMIC';\n\n/**\n * Click handler for a button that creates String variables.\n *\n * @param button\n */\nfunction stringButtonClickHandler(button: FlyoutButton) {\n  Variables.createVariableButtonHandler(\n      button.getTargetWorkspace(), undefined, 'String');\n}\n// eslint-disable-next-line camelcase\nexport const onCreateVariableButtonClick_String = stringButtonClickHandler;\n\n/**\n * Click handler for a button that creates Number variables.\n *\n * @param button\n */\nfunction numberButtonClickHandler(button: FlyoutButton) {\n  Variables.createVariableButtonHandler(\n      button.getTargetWorkspace(), undefined, 'Number');\n}\n// eslint-disable-next-line camelcase\nexport const onCreateVariableButtonClick_Number = numberButtonClickHandler;\n\n/**\n * Click handler for a button that creates Colour variables.\n *\n * @param button\n */\nfunction colourButtonClickHandler(button: FlyoutButton) {\n  Variables.createVariableButtonHandler(\n      button.getTargetWorkspace(), undefined, 'Colour');\n}\n// eslint-disable-next-line camelcase\nexport const onCreateVariableButtonClick_Colour = colourButtonClickHandler;\n\n/**\n * Construct the elements (blocks and button) required by the flyout for the\n * variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML elements.\n * @alias Blockly.VariablesDynamic.flyoutCategory\n */\nexport function flyoutCategory(workspace: WorkspaceSvg): Element[] {\n  let xmlList = new Array<Element>();\n  let button = document.createElement('button');\n  button.setAttribute('text', Msg['NEW_STRING_VARIABLE']);\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE_STRING');\n  xmlList.push(button);\n  button = document.createElement('button');\n  button.setAttribute('text', Msg['NEW_NUMBER_VARIABLE']);\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE_NUMBER');\n  xmlList.push(button);\n  button = document.createElement('button');\n  button.setAttribute('text', Msg['NEW_COLOUR_VARIABLE']);\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE_COLOUR');\n  xmlList.push(button);\n\n  workspace.registerButtonCallback(\n      'CREATE_VARIABLE_STRING', stringButtonClickHandler);\n  workspace.registerButtonCallback(\n      'CREATE_VARIABLE_NUMBER', numberButtonClickHandler);\n  workspace.registerButtonCallback(\n      'CREATE_VARIABLE_COLOUR', colourButtonClickHandler);\n\n  const blockList = flyoutCategoryBlocks(workspace);\n  xmlList = xmlList.concat(blockList);\n  return xmlList;\n}\n\n/**\n * Construct the blocks required by the flyout for the variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML block elements.\n * @alias Blockly.VariablesDynamic.flyoutCategoryBlocks\n */\nexport function flyoutCategoryBlocks(workspace: Workspace): Element[] {\n  const variableModelList = workspace.getAllVariables();\n\n  const xmlList = [];\n  if (variableModelList.length > 0) {\n    if (Blocks['variables_set_dynamic']) {\n      const firstVariable = variableModelList[variableModelList.length - 1];\n      const block = xml.createElement('block');\n      block.setAttribute('type', 'variables_set_dynamic');\n      block.setAttribute('gap', '24');\n      block.appendChild(Variables.generateVariableFieldDom(firstVariable));\n      xmlList.push(block);\n    }\n    if (Blocks['variables_get_dynamic']) {\n      variableModelList.sort(VariableModel.compareByName);\n      for (let i = 0, variable; variable = variableModelList[i]; i++) {\n        const block = xml.createElement('block');\n        block.setAttribute('type', 'variables_get_dynamic');\n        block.setAttribute('gap', '8');\n        block.appendChild(Variables.generateVariableFieldDom(variable));\n        xmlList.push(block);\n      }\n    }\n  }\n  return xmlList;\n}\n","/**\n * @license\n * Copyright 2014 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a workspace rendered as SVG.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.WorkspaceSvg');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_create.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_theme_change.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_viewport.js';\n\nimport type {Block} from './block.js';\nimport type {BlockDragSurfaceSvg} from './block_drag_surface.js';\nimport type {BlockSvg} from './block_svg.js';\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {config} from './config.js';\nimport {ConnectionDB} from './connection_db.js';\nimport * as ContextMenu from './contextmenu.js';\nimport {ContextMenuRegistry} from './contextmenu_registry.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport type {FlyoutButton} from './flyout_button.js';\nimport {Gesture} from './gesture.js';\nimport {Grid} from './grid.js';\nimport type {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport type {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport type {ICopyable} from './interfaces/i_copyable.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport type {IToolbox} from './interfaces/i_toolbox.js';\nimport type {Cursor} from './keyboard_nav/cursor.js';\nimport type {Marker} from './keyboard_nav/marker.js';\nimport {MarkerManager} from './marker_manager.js';\nimport {Options} from './options.js';\nimport * as Procedures from './procedures.js';\nimport * as registry from './registry.js';\nimport * as blockRendering from './renderers/common/block_rendering.js';\nimport type {Renderer} from './renderers/common/renderer.js';\nimport type {ScrollbarPair} from './scrollbar_pair.js';\nimport * as blocks from './serialization/blocks.js';\nimport type {Theme} from './theme.js';\nimport {Classic} from './theme/classic.js';\nimport {ThemeManager} from './theme_manager.js';\nimport * as Tooltip from './tooltip.js';\nimport {TouchGesture} from './touch_gesture.js';\nimport type {Trashcan} from './trashcan.js';\nimport * as utils from './utils.js';\nimport * as arrayUtils from './utils/array.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as userAgent from './utils/useragent.js';\nimport type {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport * as VariablesDynamic from './variables_dynamic.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport {Workspace} from './workspace.js';\nimport {WorkspaceAudio} from './workspace_audio.js';\nimport {WorkspaceComment} from './workspace_comment.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport type {WorkspaceDragSurfaceSvg} from './workspace_drag_surface_svg.js';\nimport * as Xml from './xml.js';\nimport {ZoomControls} from './zoom_controls.js';\nimport {ContextMenuOption} from './contextmenu_registry.js';\n\n\n/** Margin around the top/bottom/left/right after a zoomToFit call. */\nconst ZOOM_TO_FIT_MARGIN = 20;\n\n/**\n * Class for a workspace.  This is an onscreen area with optional trashcan,\n * scrollbars, bubbles, and dragging.\n *\n * @alias Blockly.WorkspaceSvg\n */\nexport class WorkspaceSvg extends Workspace implements IASTNodeLocationSvg {\n  /**\n   * A wrapper function called when a resize event occurs.\n   * You can pass the result to `eventHandling.unbind`.\n   */\n  private resizeHandlerWrapper_: browserEvents.Data|null = null;\n\n  /**\n   * The render status of an SVG workspace.\n   * Returns `false` for headless workspaces and true for instances of\n   * `WorkspaceSvg`.\n   */\n  override rendered = true;\n\n  /**\n   * Whether the workspace is visible.  False if the workspace has been hidden\n   * by calling `setVisible(false)`.\n   */\n  private isVisible_ = true;\n\n  /**\n   * Whether this workspace has resizes enabled.\n   * Disable during batch operations for a performance improvement.\n   */\n  private resizesEnabled_ = true;\n\n  /**\n   * Current horizontal scrolling offset in pixel units, relative to the\n   * workspace origin.\n   *\n   * It is useful to think about a view, and a canvas moving beneath that\n   * view. As the canvas moves right, this value becomes more positive, and\n   * the view is now \"seeing\" the left side of the canvas. As the canvas moves\n   * left, this value becomes more negative, and the view is now \"seeing\" the\n   * right side of the canvas.\n   *\n   * The confusing thing about this value is that it does not, and must not\n   * include the absoluteLeft offset. This is because it is used to calculate\n   * the viewLeft value.\n   *\n   * The viewLeft is relative to the workspace origin (although in pixel\n   * units). The workspace origin is the top-left corner of the workspace (at\n   * least when it is enabled). It is shifted from the top-left of the\n   * blocklyDiv so as not to be beneath the toolbox.\n   *\n   * When the workspace is enabled the viewLeft and workspace origin are at\n   * the same X location. As the canvas slides towards the right beneath the\n   * view this value (scrollX) becomes more positive, and the viewLeft becomes\n   * more negative relative to the workspace origin (imagine the workspace\n   * origin as a dot on the canvas sliding to the right as the canvas moves).\n   *\n   * So if the scrollX were to include the absoluteLeft this would in a way\n   * \"unshift\" the workspace origin. This means that the viewLeft would be\n   * representing the left edge of the blocklyDiv, rather than the left edge\n   * of the workspace.\n   */\n  scrollX = 0;\n\n  /**\n   * Current vertical scrolling offset in pixel units, relative to the\n   * workspace origin.\n   *\n   * It is useful to think about a view, and a canvas moving beneath that\n   * view. As the canvas moves down, this value becomes more positive, and the\n   * view is now \"seeing\" the upper part of the canvas. As the canvas moves\n   * up, this value becomes more negative, and the view is \"seeing\" the lower\n   * part of the canvas.\n   *\n   * This confusing thing about this value is that it does not, and must not\n   * include the absoluteTop offset. This is because it is used to calculate\n   * the viewTop value.\n   *\n   * The viewTop is relative to the workspace origin (although in pixel\n   * units). The workspace origin is the top-left corner of the workspace (at\n   * least when it is enabled). It is shifted from the top-left of the\n   * blocklyDiv so as not to be beneath the toolbox.\n   *\n   * When the workspace is enabled the viewTop and workspace origin are at the\n   * same Y location. As the canvas slides towards the bottom this value\n   * (scrollY) becomes more positive, and the viewTop becomes more negative\n   * relative to the workspace origin (image in the workspace origin as a dot\n   * on the canvas sliding downwards as the canvas moves).\n   *\n   * So if the scrollY were to include the absoluteTop this would in a way\n   * \"unshift\" the workspace origin. This means that the viewTop would be\n   * representing the top edge of the blocklyDiv, rather than the top edge of\n   * the workspace.\n   */\n  scrollY = 0;\n\n  /** Horizontal scroll value when scrolling started in pixel units. */\n  startScrollX = 0;\n\n  /** Vertical scroll value when scrolling started in pixel units. */\n  startScrollY = 0;\n\n  /** Distance from mouse to object being dragged. */\n  private dragDeltaXY_: Coordinate|null = null;\n\n  /** Current scale. */\n  scale = 1;\n\n  /** Cached scale value. Used to detect changes in viewport. */\n  private oldScale_ = 1;\n\n  /** Cached viewport top value. Used to detect changes in viewport. */\n  private oldTop_ = 0;\n\n  /** Cached viewport left value. Used to detect changes in viewport. */\n  private oldLeft_ = 0;\n\n  /** The workspace's trashcan (if any). */\n  trashcan: Trashcan|null = null;\n\n  /** This workspace's scrollbars, if they exist. */\n  scrollbar: ScrollbarPair|null = null;\n\n  /**\n   * Fixed flyout providing blocks which may be dragged into this workspace.\n   */\n  private flyout_: IFlyout|null = null;\n\n  /**\n   * Category-based toolbox providing blocks which may be dragged into this\n   * workspace.\n   */\n  private toolbox_: IToolbox|null = null;\n\n  /**\n   * The current gesture in progress on this workspace, if any.\n   *\n   * @internal\n   */\n  currentGesture_: TouchGesture|null = null;\n\n  /** This workspace's surface for dragging blocks, if it exists. */\n  private readonly blockDragSurface_: BlockDragSurfaceSvg|null = null;\n\n  /** This workspace's drag surface, if it exists. */\n  private readonly workspaceDragSurface_: WorkspaceDragSurfaceSvg|null = null;\n\n  /**\n   * Whether to move workspace to the drag surface when it is dragged.\n   * True if it should move, false if it should be translated directly.\n   */\n  private readonly useWorkspaceDragSurface_;\n\n  /**\n   * Whether the drag surface is actively in use. When true, calls to\n   * translate will translate the drag surface instead of the translating the\n   * workspace directly.\n   * This is set to true in setupDragSurface and to false in resetDragSurface.\n   */\n  private isDragSurfaceActive_ = false;\n\n  /**\n   * The first parent div with 'injectionDiv' in the name, or null if not set.\n   * Access this with getInjectionDiv.\n   */\n  private injectionDiv_: Element|null = null;\n\n  /**\n   * Last known position of the page scroll.\n   * This is used to determine whether we have recalculated screen coordinate\n   * stuff since the page scrolled.\n   */\n  private lastRecordedPageScroll_: Coordinate|null = null;\n\n  /**\n   * Developers may define this function to add custom menu options to the\n   * workspace's context menu or edit the workspace-created set of menu\n   * options.\n   *\n   * @param options List of menu options to add to.\n   * @param e The right-click event that triggered the context menu.\n   */\n  configureContextMenu:\n      ((menuOptions: ContextMenuOption[], e: Event) => void)|null = null;\n\n  /**\n   * In a flyout, the target workspace where blocks should be placed after a\n   * drag. Otherwise null.\n   *\n   * @internal\n   */\n  targetWorkspace: WorkspaceSvg|null = null;\n\n  /** Inverted screen CTM, for use in mouseToSvg. */\n  private inverseScreenCTM_: SVGMatrix|null = null;\n\n  /** Inverted screen CTM is dirty, recalculate it. */\n  private inverseScreenCTMDirty_ = true;\n  private metricsManager_: IMetricsManager;\n  /** @internal */\n  getMetrics: () => Metrics;\n  /** @internal */\n  setMetrics: (p1: {x?: number, y?: number}) => void;\n  private readonly componentManager_: ComponentManager;\n\n  /**\n   * List of currently highlighted blocks.  Block highlighting is often used\n   * to visually mark blocks currently being executed.\n   */\n  private readonly highlightedBlocks_: BlockSvg[] = [];\n  private audioManager_: WorkspaceAudio;\n  private grid_: Grid|null;\n  private markerManager_: MarkerManager;\n\n  /**\n   * Map from function names to callbacks, for deciding what to do when a\n   * custom toolbox category is opened.\n   */\n  private toolboxCategoryCallbacks =\n      new Map<string, (p1: WorkspaceSvg) => toolbox.FlyoutDefinition>();\n\n  /**\n   * Map from function names to callbacks, for deciding what to do when a\n   * button is clicked.\n   */\n  private flyoutButtonCallbacks = new Map<string, (p1: FlyoutButton) => void>();\n  protected themeManager_: ThemeManager;\n  private readonly renderer_: Renderer;\n\n  /** Cached parent SVG. */\n  private cachedParentSvg_: SVGElement|null = null;\n\n  /** True if keyboard accessibility mode is on, false otherwise. */\n  keyboardAccessibilityMode = false;\n\n  /** The list of top-level bounded elements on the workspace. */\n  private topBoundedElements_: IBoundedElement[] = [];\n\n  /** The recorded drag targets. */\n  private dragTargetAreas_: Array<{component: IDragTarget, clientRect: Rect}> =\n      [];\n  private readonly cachedParentSvgSize_: Size;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgGroup_!: SVGElement;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgBackground_!: SVGElement;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgBlockCanvas_!: SVGElement;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgBubbleCanvas_!: SVGElement;\n  zoomControls_: ZoomControls|null = null;\n\n  /**\n   * @param options Dictionary of options.\n   * @param opt_blockDragSurface Drag surface for blocks.\n   * @param opt_wsDragSurface Drag surface for the workspace.\n   */\n  constructor(\n      options: Options, opt_blockDragSurface?: BlockDragSurfaceSvg,\n      opt_wsDragSurface?: WorkspaceDragSurfaceSvg) {\n    super(options);\n\n    const MetricsManagerClass = registry.getClassFromOptions(\n        registry.Type.METRICS_MANAGER, options, true);\n    /** Object in charge of calculating metrics for the workspace. */\n    this.metricsManager_ = new MetricsManagerClass!(this);\n\n    /** Method to get all the metrics that have to do with a workspace. */\n    this.getMetrics = options.getMetrics ||\n        this.metricsManager_.getMetrics.bind(this.metricsManager_);\n\n    /** Translates the workspace. */\n    this.setMetrics =\n        options.setMetrics || WorkspaceSvg.setTopLevelWorkspaceMetrics_;\n\n    this.componentManager_ = new ComponentManager();\n\n    this.connectionDBList = ConnectionDB.init(this.connectionChecker);\n\n    if (opt_blockDragSurface) {\n      this.blockDragSurface_ = opt_blockDragSurface;\n    }\n\n    if (opt_wsDragSurface) {\n      this.workspaceDragSurface_ = opt_wsDragSurface;\n    }\n\n    this.useWorkspaceDragSurface_ = !!this.workspaceDragSurface_;\n\n    /**\n     * Object in charge of loading, storing, and playing audio for a workspace.\n     */\n    this.audioManager_ =\n        new WorkspaceAudio((options.parentWorkspace as WorkspaceSvg));\n\n    /** This workspace's grid object or null. */\n    this.grid_ = this.options.gridPattern ?\n        new Grid(this.options.gridPattern, options.gridOptions) :\n        null;\n\n    /** Manager in charge of markers and cursors. */\n    this.markerManager_ = new MarkerManager(this);\n\n    if (Variables && Variables.flyoutCategory) {\n      this.registerToolboxCategoryCallback(\n          Variables.CATEGORY_NAME, Variables.flyoutCategory);\n    }\n\n    if (VariablesDynamic && VariablesDynamic.flyoutCategory) {\n      this.registerToolboxCategoryCallback(\n          VariablesDynamic.CATEGORY_NAME, VariablesDynamic.flyoutCategory);\n    }\n\n    if (Procedures && Procedures.flyoutCategory) {\n      this.registerToolboxCategoryCallback(\n          Procedures.CATEGORY_NAME, Procedures.flyoutCategory);\n      this.addChangeListener(Procedures.mutatorOpenListener);\n    }\n\n    /** Object in charge of storing and updating the workspace theme. */\n    this.themeManager_ = this.options.parentWorkspace ?\n        this.options.parentWorkspace.getThemeManager() :\n        new ThemeManager(this, this.options.theme || Classic);\n    this.themeManager_.subscribeWorkspace(this);\n\n    /** The block renderer used for rendering blocks on this workspace. */\n    this.renderer_ = blockRendering.init(\n        this.options.renderer || 'geras', this.getTheme(),\n        this.options.rendererOverrides ?? undefined);\n\n    /**\n     * The cached size of the parent svg element.\n     * Used to compute svg metrics.\n     */\n    this.cachedParentSvgSize_ = new Size(0, 0);\n  }\n\n  /**\n   * Get the marker manager for this workspace.\n   *\n   * @returns The marker manager.\n   */\n  getMarkerManager(): MarkerManager {\n    return this.markerManager_;\n  }\n\n  /**\n   * Gets the metrics manager for this workspace.\n   *\n   * @returns The metrics manager.\n   */\n  getMetricsManager(): IMetricsManager {\n    return this.metricsManager_;\n  }\n\n  /**\n   * Sets the metrics manager for the workspace.\n   *\n   * @param metricsManager The metrics manager.\n   * @internal\n   */\n  setMetricsManager(metricsManager: IMetricsManager) {\n    this.metricsManager_ = metricsManager;\n    this.getMetrics =\n        this.metricsManager_.getMetrics.bind(this.metricsManager_);\n  }\n\n  /**\n   * Gets the component manager for this workspace.\n   *\n   * @returns The component manager.\n   */\n  getComponentManager(): ComponentManager {\n    return this.componentManager_;\n  }\n\n  /**\n   * Add the cursor SVG to this workspaces SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    this.markerManager_.setCursorSvg(cursorSvg);\n  }\n\n  /**\n   * Add the marker SVG to this workspaces SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    this.markerManager_.setMarkerSvg(markerSvg);\n  }\n\n  /**\n   * Get the marker with the given ID.\n   *\n   * @param id The ID of the marker.\n   * @returns The marker with the given ID or null if no marker with the given\n   *     ID exists.\n   * @internal\n   */\n  getMarker(id: string): Marker|null {\n    if (this.markerManager_) {\n      return this.markerManager_.getMarker(id);\n    }\n    return null;\n  }\n\n  /**\n   * The cursor for this workspace.\n   *\n   * @returns The cursor for the workspace.\n   */\n  getCursor(): Cursor|null {\n    if (this.markerManager_) {\n      return this.markerManager_.getCursor();\n    }\n    return null;\n  }\n\n  /**\n   * Get the block renderer attached to this workspace.\n   *\n   * @returns The renderer attached to this workspace.\n   */\n  getRenderer(): Renderer {\n    return this.renderer_;\n  }\n\n  /**\n   * Get the theme manager for this workspace.\n   *\n   * @returns The theme manager for this workspace.\n   * @internal\n   */\n  getThemeManager(): ThemeManager {\n    return this.themeManager_;\n  }\n\n  /**\n   * Get the workspace theme object.\n   *\n   * @returns The workspace theme object.\n   */\n  getTheme(): Theme {\n    return this.themeManager_.getTheme();\n  }\n\n  /**\n   * Set the workspace theme object.\n   * If no theme is passed, default to the `Classic` theme.\n   *\n   * @param theme The workspace theme object.\n   */\n  setTheme(theme: Theme) {\n    if (!theme) {\n      theme = Classic as Theme;\n    }\n    this.themeManager_.setTheme(theme);\n  }\n\n  /**\n   * Refresh all blocks on the workspace after a theme update.\n   */\n  refreshTheme() {\n    if (this.svgGroup_) {\n      this.renderer_.refreshDom(this.svgGroup_, this.getTheme());\n    }\n\n    // Update all blocks in workspace that have a style name.\n    this.updateBlockStyles_(this.getAllBlocks(false).filter(function(block) {\n      return !!block.getStyleName();\n    }));\n\n    // Update current toolbox selection.\n    this.refreshToolboxSelection();\n    if (this.toolbox_) {\n      this.toolbox_.refreshTheme();\n    }\n\n    // Re-render if workspace is visible\n    if (this.isVisible()) {\n      this.setVisible(true);\n    }\n\n    const event = new (eventUtils.get(eventUtils.THEME_CHANGE))(\n        this.getTheme().name, this.id);\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Updates all the blocks with new style.\n   *\n   * @param blocks List of blocks to update the style on.\n   */\n  private updateBlockStyles_(blocks: Block[]) {\n    for (let i = 0, block; block = blocks[i]; i++) {\n      const blockStyleName = block.getStyleName();\n      if (blockStyleName) {\n        const blockSvg = block as BlockSvg;\n        blockSvg.setStyle(blockStyleName);\n        if (blockSvg.mutator) {\n          blockSvg.mutator.updateBlockStyle();\n        }\n      }\n    }\n  }\n\n  /**\n   * Getter for the inverted screen CTM.\n   *\n   * @returns The matrix to use in mouseToSvg\n   */\n  getInverseScreenCTM(): SVGMatrix|null {\n    // Defer getting the screen CTM until we actually need it, this should\n    // avoid forced reflows from any calls to updateInverseScreenCTM.\n    if (this.inverseScreenCTMDirty_) {\n      const ctm = this.getParentSvg().getScreenCTM();\n      if (ctm) {\n        this.inverseScreenCTM_ = (ctm).inverse();\n        this.inverseScreenCTMDirty_ = false;\n      }\n    }\n\n    return this.inverseScreenCTM_;\n  }\n\n  /** Mark the inverse screen CTM as dirty. */\n  updateInverseScreenCTM() {\n    this.inverseScreenCTMDirty_ = true;\n  }\n\n  /**\n   * Getter for isVisible\n   *\n   * @returns Whether the workspace is visible.\n   *     False if the workspace has been hidden by calling `setVisible(false)`.\n   */\n  isVisible(): boolean {\n    return this.isVisible_;\n  }\n\n  /**\n   * Return the absolute coordinates of the top-left corner of this element,\n   * scales that after canvas SVG element, if it's a descendant.\n   * The origin (0,0) is the top-left corner of the Blockly SVG.\n   *\n   * @param element SVG element to find the coordinates of.\n   * @returns Object with .x and .y properties.\n   * @internal\n   */\n  getSvgXY(element: SVGElement): Coordinate {\n    let x = 0;\n    let y = 0;\n    let scale = 1;\n    if (dom.containsNode(this.getCanvas(), element) ||\n        dom.containsNode(this.getBubbleCanvas(), element)) {\n      // Before the SVG canvas, scale the coordinates.\n      scale = this.scale;\n    }\n    do {\n      // Loop through this block and every parent.\n      const xy = svgMath.getRelativeXY(element);\n      if (element === this.getCanvas() || element === this.getBubbleCanvas()) {\n        // After the SVG canvas, don't scale the coordinates.\n        scale = 1;\n      }\n      x += xy.x * scale;\n      y += xy.y * scale;\n      element = element.parentNode as SVGElement;\n    } while (element && element !== this.getParentSvg());\n    return new Coordinate(x, y);\n  }\n\n  /**\n   * Gets the size of the workspace's parent SVG element.\n   *\n   * @returns The cached width and height of the workspace's parent SVG element.\n   * @internal\n   */\n  getCachedParentSvgSize(): Size {\n    const size = this.cachedParentSvgSize_;\n    return new Size(size.width, size.height);\n  }\n\n  /**\n   * Return the position of the workspace origin relative to the injection div\n   * origin in pixels.\n   * The workspace origin is where a block would render at position (0, 0).\n   * It is not the upper left corner of the workspace SVG.\n   *\n   * @returns Offset in pixels.\n   * @internal\n   */\n  getOriginOffsetInPixels(): Coordinate {\n    return svgMath.getInjectionDivXY(this.getCanvas());\n  }\n\n  /**\n   * Return the injection div that is a parent of this workspace.\n   * Walks the DOM the first time it's called, then returns a cached value.\n   * Note: We assume this is only called after the workspace has been injected\n   * into the DOM.\n   *\n   * @returns The first parent div with 'injectionDiv' in the name.\n   * @internal\n   */\n  getInjectionDiv(): Element {\n    // NB: it would be better to pass this in at createDom, but is more likely\n    // to break existing uses of Blockly.\n    if (!this.injectionDiv_) {\n      let element: Element = this.svgGroup_;\n      while (element) {\n        const classes = element.getAttribute('class') || '';\n        if ((' ' + classes + ' ').indexOf(' injectionDiv ') !== -1) {\n          this.injectionDiv_ = element;\n          break;\n        }\n        element = element.parentNode as Element;\n      }\n    }\n    return this.injectionDiv_!;\n  }\n\n  /**\n   * Get the SVG block canvas for the workspace.\n   *\n   * @returns The SVG group for the workspace.\n   * @internal\n   */\n  getBlockCanvas(): SVGElement|null {\n    return this.svgBlockCanvas_;\n  }\n\n  /**\n   * Save resize handler data so we can delete it later in dispose.\n   *\n   * @param handler Data that can be passed to eventHandling.unbind.\n   */\n  setResizeHandlerWrapper(handler: browserEvents.Data) {\n    this.resizeHandlerWrapper_ = handler;\n  }\n\n  /**\n   * Create the workspace DOM elements.\n   *\n   * @param opt_backgroundClass Either 'blocklyMainBackground' or\n   *     'blocklyMutatorBackground'.\n   * @returns The workspace's SVG group.\n   */\n  createDom(opt_backgroundClass?: string): Element {\n    /**\n     * <g class=\"blocklyWorkspace\">\n     *   <rect class=\"blocklyMainBackground\" height=\"100%\" width=\"100%\"></rect>\n     *   [Trashcan and/or flyout may go here]\n     *   <g class=\"blocklyBlockCanvas\"></g>\n     *   <g class=\"blocklyBubbleCanvas\"></g>\n     * </g>\n     */\n    this.svgGroup_ = dom.createSvgElement(Svg.G, {'class': 'blocklyWorkspace'});\n\n    // Note that a <g> alone does not receive mouse events--it must have a\n    // valid target inside it.  If no background class is specified, as in the\n    // flyout, the workspace will not receive mouse events.\n    if (opt_backgroundClass) {\n      this.svgBackground_ = dom.createSvgElement(\n          Svg.RECT,\n          {'height': '100%', 'width': '100%', 'class': opt_backgroundClass},\n          this.svgGroup_);\n\n      if (opt_backgroundClass === 'blocklyMainBackground' && this.grid_) {\n        this.svgBackground_.style.fill =\n            'url(#' + this.grid_.getPatternId() + ')';\n      } else {\n        this.themeManager_.subscribe(\n            this.svgBackground_, 'workspaceBackgroundColour', 'fill');\n      }\n    }\n    this.svgBlockCanvas_ = dom.createSvgElement(\n        Svg.G, {'class': 'blocklyBlockCanvas'}, this.svgGroup_);\n    this.svgBubbleCanvas_ = dom.createSvgElement(\n        Svg.G, {'class': 'blocklyBubbleCanvas'}, this.svgGroup_);\n\n    if (!this.isFlyout) {\n      browserEvents.conditionalBind(\n          this.svgGroup_, 'mousedown', this, this.onMouseDown_, false, true);\n      // This no-op works around https://bugs.webkit.org/show_bug.cgi?id=226683,\n      // which otherwise prevents zoom/scroll events from being observed in\n      // Safari. Once that bug is fixed it should be removed.\n      document.body.addEventListener('wheel', function() {});\n      browserEvents.conditionalBind(\n          this.svgGroup_, 'wheel', this, this.onMouseWheel_);\n    }\n\n    // Determine if there needs to be a category tree, or a simple list of\n    // blocks.  This cannot be changed later, since the UI is very different.\n    if (this.options.hasCategories) {\n      const ToolboxClass = registry.getClassFromOptions(\n          registry.Type.TOOLBOX, this.options, true);\n      this.toolbox_ = new ToolboxClass!(this);\n    }\n    if (this.grid_) {\n      this.grid_.update(this.scale);\n    }\n    this.recordDragTargets();\n    const CursorClass =\n        registry.getClassFromOptions(registry.Type.CURSOR, this.options);\n\n    CursorClass && this.markerManager_.setCursor(new CursorClass());\n\n    this.renderer_.createDom(this.svgGroup_, this.getTheme());\n    return this.svgGroup_;\n  }\n\n  /**\n   * Dispose of this workspace.\n   * Unlink from all DOM elements to prevent memory leaks.\n   *\n   * @suppress {checkTypes}\n   */\n  override dispose() {\n    // Stop rerendering.\n    this.rendered = false;\n    if (this.currentGesture_) {\n      this.currentGesture_.cancel();\n    }\n    if (this.svgGroup_) {\n      dom.removeNode(this.svgGroup_);\n    }\n    if (this.toolbox_) {\n      this.toolbox_.dispose();\n      this.toolbox_ = null;\n    }\n    if (this.flyout_) {\n      this.flyout_.dispose();\n      this.flyout_ = null;\n    }\n    if (this.trashcan) {\n      this.trashcan.dispose();\n      this.trashcan = null;\n    }\n    if (this.scrollbar) {\n      this.scrollbar.dispose();\n      this.scrollbar = null;\n    }\n    if (this.zoomControls_) {\n      this.zoomControls_.dispose();\n    }\n\n    if (this.audioManager_) {\n      this.audioManager_.dispose();\n    }\n\n    if (this.grid_) {\n      this.grid_ = null;\n    }\n\n    this.renderer_.dispose();\n\n    if (this.markerManager_) {\n      this.markerManager_.dispose();\n    }\n\n    super.dispose();\n\n    // Dispose of theme manager after all blocks and mutators are disposed of.\n    if (this.themeManager_) {\n      this.themeManager_.unsubscribeWorkspace(this);\n      this.themeManager_.unsubscribe(this.svgBackground_);\n      if (!this.options.parentWorkspace) {\n        this.themeManager_.dispose();\n      }\n    }\n\n    this.connectionDBList.length = 0;\n\n    this.toolboxCategoryCallbacks.clear();\n    this.flyoutButtonCallbacks.clear();\n\n    if (!this.options.parentWorkspace) {\n      // Top-most workspace.  Dispose of the div that the\n      // SVG is injected into (i.e. injectionDiv).\n      const parentSvg = this.getParentSvg();\n      if (parentSvg && parentSvg.parentNode) {\n        dom.removeNode(parentSvg.parentNode);\n      }\n    }\n    if (this.resizeHandlerWrapper_) {\n      browserEvents.unbind(this.resizeHandlerWrapper_);\n      this.resizeHandlerWrapper_ = null;\n    }\n  }\n\n  /**\n   * Add a trashcan.\n   *\n   * @internal\n   */\n  addTrashcan() {\n    this.trashcan = WorkspaceSvg.newTrashcan(this);\n    const svgTrashcan = this.trashcan.createDom();\n    this.svgGroup_.insertBefore(svgTrashcan, this.svgBlockCanvas_);\n  }\n\n  /**\n   * @param _workspace\n   * @internal\n   */\n  static newTrashcan(_workspace: WorkspaceSvg): Trashcan {\n    throw new Error(\n        'The implementation of newTrashcan should be ' +\n        'monkey-patched in by blockly.ts');\n  }\n\n  /**\n   * Add zoom controls.\n   *\n   * @internal\n   */\n  addZoomControls() {\n    this.zoomControls_ = new ZoomControls(this);\n    const svgZoomControls = this.zoomControls_.createDom();\n    this.svgGroup_.appendChild(svgZoomControls);\n  }\n\n  /**\n   * Add a flyout element in an element with the given tag name.\n   *\n   * @param tagName What type of tag the flyout belongs in.\n   * @returns The element containing the flyout DOM.\n   * @internal\n   */\n  addFlyout(tagName: string|Svg<SVGSVGElement>|Svg<SVGGElement>): Element {\n    const workspaceOptions = new Options(({\n      'parentWorkspace': this,\n      'rtl': this.RTL,\n      'oneBasedIndex': this.options.oneBasedIndex,\n      'horizontalLayout': this.horizontalLayout,\n      'renderer': this.options.renderer,\n      'rendererOverrides': this.options.rendererOverrides,\n      'move': {\n        'scrollbars': true,\n      },\n    } as BlocklyOptions));\n    workspaceOptions.toolboxPosition = this.options.toolboxPosition;\n    if (this.horizontalLayout) {\n      const HorizontalFlyout = registry.getClassFromOptions(\n          registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX, this.options, true);\n      this.flyout_ = new HorizontalFlyout!(workspaceOptions);\n    } else {\n      const VerticalFlyout = registry.getClassFromOptions(\n          registry.Type.FLYOUTS_VERTICAL_TOOLBOX, this.options, true);\n      this.flyout_ = new VerticalFlyout!(workspaceOptions);\n    }\n    this.flyout_.autoClose = false;\n    this.flyout_.getWorkspace().setVisible(true);\n\n    // Return the element so that callers can place it in their desired\n    // spot in the DOM.  For example, mutator flyouts do not go in the same\n    // place as main workspace flyouts.\n    return this.flyout_.createDom(tagName);\n  }\n\n  /**\n   * Getter for the flyout associated with this workspace.  This flyout may be\n   * owned by either the toolbox or the workspace, depending on toolbox\n   * configuration.  It will be null if there is no flyout.\n   *\n   * @param opt_own Whether to only return the workspace's own flyout.\n   * @returns The flyout on this workspace.\n   * @internal\n   */\n  getFlyout(opt_own?: boolean): IFlyout|null {\n    if (this.flyout_ || opt_own) {\n      return this.flyout_;\n    }\n    if (this.toolbox_) {\n      return this.toolbox_.getFlyout();\n    }\n    return null;\n  }\n\n  /**\n   * Getter for the toolbox associated with this workspace, if one exists.\n   *\n   * @returns The toolbox on this workspace.\n   * @internal\n   */\n  getToolbox(): IToolbox|null {\n    return this.toolbox_;\n  }\n\n  /**\n   * Update items that use screen coordinate calculations\n   * because something has changed (e.g. scroll position, window size).\n   */\n  private updateScreenCalculations_() {\n    this.updateInverseScreenCTM();\n    this.recordDragTargets();\n  }\n\n  /**\n   * If enabled, resize the parts of the workspace that change when the\n   * workspace contents (e.g. block positions) change.  This will also scroll\n   * the workspace contents if needed.\n   *\n   * @internal\n   */\n  resizeContents() {\n    if (!this.resizesEnabled_ || !this.rendered) {\n      return;\n    }\n    if (this.scrollbar) {\n      this.scrollbar.resize();\n    }\n    this.updateInverseScreenCTM();\n  }\n\n  /**\n   * Resize and reposition all of the workspace chrome (toolbox,\n   * trash, scrollbars etc.)\n   * This should be called when something changes that\n   * requires recalculating dimensions and positions of the\n   * trash, zoom, toolbox, etc. (e.g. window resize).\n   */\n  resize() {\n    if (this.toolbox_) {\n      this.toolbox_.position();\n    }\n    if (this.flyout_) {\n      this.flyout_.position();\n    }\n\n    const positionables = this.componentManager_.getComponents(\n        ComponentManager.Capability.POSITIONABLE, true);\n    const metrics = this.getMetricsManager().getUiMetrics();\n    const savedPositions = [];\n    for (let i = 0, positionable; positionable = positionables[i]; i++) {\n      positionable.position(metrics, savedPositions);\n      const boundingRect = positionable.getBoundingRectangle();\n      if (boundingRect) {\n        savedPositions.push(boundingRect);\n      }\n    }\n\n    if (this.scrollbar) {\n      this.scrollbar.resize();\n    }\n    this.updateScreenCalculations_();\n  }\n\n  /**\n   * Resizes and repositions workspace chrome if the page has a new\n   * scroll position.\n   *\n   * @internal\n   */\n  updateScreenCalculationsIfScrolled() {\n    /* eslint-disable indent */\n    const currScroll = svgMath.getDocumentScroll();\n    if (!Coordinate.equals(this.lastRecordedPageScroll_, currScroll)) {\n      this.lastRecordedPageScroll_ = currScroll;\n      this.updateScreenCalculations_();\n    }\n  }\n  /* eslint-enable indent */\n\n  /**\n   * Get the SVG element that forms the drawing surface.\n   *\n   * @returns SVG group element.\n   */\n  getCanvas(): SVGGElement {\n    return this.svgBlockCanvas_ as SVGGElement;\n  }\n\n  /**\n   * Caches the width and height of the workspace's parent SVG element for use\n   * with getSvgMetrics.\n   *\n   * @param width The width of the parent SVG element.\n   * @param height The height of the parent SVG element\n   * @internal\n   */\n  setCachedParentSvgSize(width: number|null, height: number|null) {\n    const svg = this.getParentSvg();\n    if (width != null) {\n      this.cachedParentSvgSize_.width = width;\n      // This is set to support the public (but deprecated) Blockly.svgSize\n      // method.\n      svg.setAttribute('data-cached-width', width.toString());\n    }\n    if (height != null) {\n      this.cachedParentSvgSize_.height = height;\n      // This is set to support the public (but deprecated) Blockly.svgSize\n      // method.\n      svg.setAttribute('data-cached-height', height.toString());\n    }\n  }\n\n  /**\n   * Get the SVG element that forms the bubble surface.\n   *\n   * @returns SVG group element.\n   */\n  getBubbleCanvas(): SVGGElement {\n    return this.svgBubbleCanvas_ as SVGGElement;\n  }\n\n  /**\n   * Get the SVG element that contains this workspace.\n   * Note: We assume this is only called after the workspace has been injected\n   * into the DOM.\n   *\n   * @returns SVG element.\n   */\n  getParentSvg(): SVGSVGElement {\n    if (!this.cachedParentSvg_) {\n      let element = this.svgGroup_;\n      while (element) {\n        if (element.tagName === 'svg') {\n          this.cachedParentSvg_ = element;\n          break;\n        }\n        element = element.parentNode as SVGSVGElement;\n      }\n    }\n    return this.cachedParentSvg_ as SVGSVGElement;\n  }\n\n  /**\n   * Fires a viewport event if events are enabled and there is a change in\n   * viewport values.\n   *\n   * @internal\n   */\n  maybeFireViewportChangeEvent() {\n    if (!eventUtils.isEnabled()) {\n      return;\n    }\n    const scale = this.scale;\n    const top = -this.scrollY;\n    const left = -this.scrollX;\n    if (scale === this.oldScale_ && Math.abs(top - this.oldTop_) < 1 &&\n        Math.abs(left - this.oldLeft_) < 1) {\n      // Ignore sub-pixel changes in top and left. Due to #4192 there are a lot\n      // of negligible changes in viewport top/left.\n      return;\n    }\n    const event = new (eventUtils.get(eventUtils.VIEWPORT_CHANGE))(\n        top, left, scale, this.id, this.oldScale_);\n    this.oldScale_ = scale;\n    this.oldTop_ = top;\n    this.oldLeft_ = left;\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Translate this workspace to new coordinates.\n   *\n   * @param x Horizontal translation, in pixel units relative to the top left of\n   *     the Blockly div.\n   * @param y Vertical translation, in pixel units relative to the top left of\n   *     the Blockly div.\n   */\n  translate(x: number, y: number) {\n    if (this.useWorkspaceDragSurface_ && this.isDragSurfaceActive_) {\n      this.workspaceDragSurface_?.translateSurface(x, y);\n    } else {\n      const translation = 'translate(' + x + ',' + y + ') ' +\n          'scale(' + this.scale + ')';\n      this.svgBlockCanvas_.setAttribute('transform', translation);\n      this.svgBubbleCanvas_.setAttribute('transform', translation);\n    }\n    // Now update the block drag surface if we're using one.\n    if (this.blockDragSurface_) {\n      this.blockDragSurface_.translateAndScaleGroup(x, y, this.scale);\n    }\n    // And update the grid if we're using one.\n    if (this.grid_) {\n      this.grid_.moveTo(x, y);\n    }\n\n    this.maybeFireViewportChangeEvent();\n  }\n\n  /**\n   * Called at the end of a workspace drag to take the contents\n   * out of the drag surface and put them back into the workspace SVG.\n   * Does nothing if the workspace drag surface is not enabled.\n   *\n   * @internal\n   */\n  resetDragSurface() {\n    // Don't do anything if we aren't using a drag surface.\n    if (!this.useWorkspaceDragSurface_) {\n      return;\n    }\n\n    this.isDragSurfaceActive_ = false;\n\n    const trans = this.workspaceDragSurface_!.getSurfaceTranslation();\n    this.workspaceDragSurface_!.clearAndHide(this.svgGroup_);\n    const translation = 'translate(' + trans.x + ',' + trans.y + ') ' +\n        'scale(' + this.scale + ')';\n    this.svgBlockCanvas_.setAttribute('transform', translation);\n    this.svgBubbleCanvas_.setAttribute('transform', translation);\n  }\n\n  /**\n   * Called at the beginning of a workspace drag to move contents of\n   * the workspace to the drag surface.\n   * Does nothing if the drag surface is not enabled.\n   *\n   * @internal\n   */\n  setupDragSurface() {\n    // Don't do anything if we aren't using a drag surface.\n    if (!this.useWorkspaceDragSurface_) {\n      return;\n    }\n\n    // This can happen if the user starts a drag, mouses up outside of the\n    // document where the mouseup listener is registered (e.g. outside of an\n    // iframe) and then moves the mouse back in the workspace.  On mobile and\n    // ff, we get the mouseup outside the frame. On chrome and safari desktop we\n    // do not.\n    if (this.isDragSurfaceActive_) {\n      return;\n    }\n\n    this.isDragSurfaceActive_ = true;\n\n    // Figure out where we want to put the canvas back.  The order\n    // in the is important because things are layered.\n    const previousElement = this.svgBlockCanvas_.previousSibling as Element;\n    const width =\n        parseInt(this.getParentSvg().getAttribute('width') ?? '0', 10);\n    const height =\n        parseInt(this.getParentSvg().getAttribute('height') ?? '0', 10);\n    const coord = svgMath.getRelativeXY(this.getCanvas());\n    this.workspaceDragSurface_!.setContentsAndShow(\n        this.getCanvas(), this.getBubbleCanvas(), previousElement, width,\n        height, this.scale);\n    this.workspaceDragSurface_!.translateSurface(coord.x, coord.y);\n  }\n\n  /**\n   * Gets the drag surface blocks are moved to when a drag is started.\n   *\n   * @returns This workspace's block drag surface, if one is in use.\n   * @internal\n   */\n  getBlockDragSurface(): BlockDragSurfaceSvg|null {\n    return this.blockDragSurface_;\n  }\n\n  /**\n   * Returns the horizontal offset of the workspace.\n   * Intended for LTR/RTL compatibility in XML.\n   *\n   * @returns Width.\n   */\n  override getWidth(): number {\n    const metrics = this.getMetrics();\n    return metrics ? metrics.viewWidth / this.scale : 0;\n  }\n\n  /**\n   * Toggles the visibility of the workspace.\n   * Currently only intended for main workspace.\n   *\n   * @param isVisible True if workspace should be visible.\n   */\n  setVisible(isVisible: boolean) {\n    this.isVisible_ = isVisible;\n    if (!this.svgGroup_) {\n      return;\n    }\n\n    // Tell the scrollbar whether its container is visible so it can\n    // tell when to hide itself.\n    if (this.scrollbar) {\n      this.scrollbar.setContainerVisible(isVisible);\n    }\n\n    // Tell the flyout whether its container is visible so it can\n    // tell when to hide itself.\n    if (this.getFlyout()) {\n      this.getFlyout()!.setContainerVisible(isVisible);\n    }\n\n    this.getParentSvg().style.display = isVisible ? 'block' : 'none';\n    if (this.toolbox_) {\n      // Currently does not support toolboxes in mutators.\n      this.toolbox_.setVisible(isVisible);\n    }\n    if (isVisible) {\n      const blocks = this.getAllBlocks(false);\n      // Tell each block on the workspace to mark its fields as dirty.\n      for (let i = blocks.length - 1; i >= 0; i--) {\n        blocks[i].markDirty();\n      }\n\n      this.render();\n      if (this.toolbox_) {\n        this.toolbox_.position();\n      }\n    } else {\n      this.hideChaff(true);\n    }\n  }\n\n  /** Render all blocks in workspace. */\n  render() {\n    // Generate list of all blocks.\n    const blocks = this.getAllBlocks(false);\n    // Render each block.\n    for (let i = blocks.length - 1; i >= 0; i--) {\n      blocks[i].render(false);\n    }\n\n    if (this.currentGesture_) {\n      const imList = this.currentGesture_.getInsertionMarkers();\n      for (let i = 0; i < imList.length; i++) {\n        imList[i].render(false);\n      }\n    }\n\n    this.markerManager_.updateMarkers();\n  }\n\n  /**\n   * Highlight or unhighlight a block in the workspace.  Block highlighting is\n   * often used to visually mark blocks currently being executed.\n   *\n   * @param id ID of block to highlight/unhighlight, or null for no block (used\n   *     to unhighlight all blocks).\n   * @param opt_state If undefined, highlight specified block and automatically\n   *     unhighlight all others.  If true or false, manually\n   *     highlight/unhighlight the specified block.\n   */\n  highlightBlock(id: string|null, opt_state?: boolean) {\n    if (opt_state === undefined) {\n      // Unhighlight all blocks.\n      for (let i = 0, block; block = this.highlightedBlocks_[i]; i++) {\n        block.setHighlighted(false);\n      }\n      this.highlightedBlocks_.length = 0;\n    }\n    // Highlight/unhighlight the specified block.\n    const block = id ? this.getBlockById(id) : null;\n    if (block) {\n      const state = opt_state === undefined || opt_state;\n      // Using Set here would be great, but at the cost of IE10 support.\n      if (!state) {\n        arrayUtils.removeElem(this.highlightedBlocks_, block);\n      } else if (this.highlightedBlocks_.indexOf(block) === -1) {\n        this.highlightedBlocks_.push(block);\n      }\n      block.setHighlighted(state);\n    }\n  }\n\n  /**\n   * Pastes the provided block or workspace comment onto the workspace.\n   * Does not check whether there is remaining capacity for the object, that\n   * should be done before calling this method.\n   *\n   * @param state The representation of the thing to paste.\n   * @returns The pasted thing, or null if the paste was not successful.\n   */\n  paste(state: AnyDuringMigration|Element|DocumentFragment): ICopyable|null {\n    if (!this.rendered || !state['type'] && !state['tagName']) {\n      return null;\n    }\n    if (this.currentGesture_) {  // Dragging while pasting?  No.\n      this.currentGesture_.cancel();\n    }\n\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n\n    let pastedThing;\n    // Checks if this is JSON. JSON has a type property, while elements don't.\n    if (state['type']) {\n      pastedThing = this.pasteBlock_(null, state as blocks.State);\n    } else {\n      const xmlBlock = state as Element;\n      if (xmlBlock.tagName.toLowerCase() === 'comment') {\n        pastedThing = this.pasteWorkspaceComment_(xmlBlock);\n      } else {\n        pastedThing = this.pasteBlock_(xmlBlock, null);\n      }\n    }\n\n    eventUtils.setGroup(existingGroup);\n    return pastedThing;\n  }\n\n  /**\n   * Paste the provided block onto the workspace.\n   *\n   * @param xmlBlock XML block element.\n   * @param jsonBlock JSON block representation.\n   * @returns The pasted block.\n   */\n  private pasteBlock_(xmlBlock: Element|null, jsonBlock: blocks.State|null):\n      BlockSvg {\n    eventUtils.disable();\n    let block: BlockSvg;\n    try {\n      let blockX = 0;\n      let blockY = 0;\n      if (xmlBlock) {\n        block = Xml.domToBlock(xmlBlock, this) as BlockSvg;\n        blockX = parseInt(xmlBlock.getAttribute('x') ?? '0', 10);\n        if (this.RTL) {\n          blockX = -blockX;\n        }\n        blockY = parseInt(xmlBlock.getAttribute('y') ?? '0', 10);\n      } else if (jsonBlock) {\n        block = blocks.append(jsonBlock, this) as BlockSvg;\n        blockX = jsonBlock['x'] || 10;\n        if (this.RTL) {\n          blockX = this.getWidth() - blockX;\n        }\n        blockY = jsonBlock['y'] || 10;\n      }\n\n      // Move the duplicate to original position.\n      if (!isNaN(blockX) && !isNaN(blockY)) {\n        // Offset block until not clobbering another block and not in connection\n        // distance with neighbouring blocks.\n        let collide;\n        do {\n          collide = false;\n          const allBlocks = this.getAllBlocks(false);\n          for (let i = 0, otherBlock; otherBlock = allBlocks[i]; i++) {\n            const otherXY = otherBlock.getRelativeToSurfaceXY();\n            if (Math.abs(blockX - otherXY.x) <= 1 &&\n                Math.abs(blockY - otherXY.y) <= 1) {\n              collide = true;\n              break;\n            }\n          }\n          if (!collide) {\n            // Check for blocks in snap range to any of its connections.\n            const connections = block!.getConnections_(false);\n            for (let i = 0, connection; connection = connections[i]; i++) {\n              const neighbour =\n                  (connection)\n                      .closest(\n                          config.snapRadius, new Coordinate(blockX, blockY));\n              if (neighbour.connection) {\n                collide = true;\n                break;\n              }\n            }\n          }\n          if (collide) {\n            if (this.RTL) {\n              blockX -= config.snapRadius;\n            } else {\n              blockX += config.snapRadius;\n            }\n            blockY += config.snapRadius * 2;\n          }\n        } while (collide);\n        block!.moveTo(new Coordinate(blockX, blockY));\n      }\n    } finally {\n      eventUtils.enable();\n    }\n    if (eventUtils.isEnabled() && !block!.isShadow()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(block!));\n    }\n    block!.select();\n    return block!;\n  }\n\n  /**\n   * Paste the provided comment onto the workspace.\n   *\n   * @param xmlComment XML workspace comment element.\n   * @returns The pasted workspace comment.\n   * @suppress {checkTypes} Suppress checks while workspace comments are not\n   * bundled in.\n   */\n  private pasteWorkspaceComment_(xmlComment: Element): WorkspaceCommentSvg {\n    eventUtils.disable();\n    let comment: WorkspaceCommentSvg;\n    try {\n      comment = WorkspaceCommentSvg.fromXmlRendered(xmlComment, this);\n      // Move the duplicate to original position.\n      let commentX = parseInt(xmlComment.getAttribute('x') ?? '0', 10);\n      let commentY = parseInt(xmlComment.getAttribute('y') ?? '0', 10);\n      if (!isNaN(commentX) && !isNaN(commentY)) {\n        if (this.RTL) {\n          commentX = -commentX;\n        }\n        // Offset workspace comment.\n        // TODO (#1719): Properly offset comment such that it's not interfering\n        // with any blocks.\n        commentX += 50;\n        commentY += 50;\n        comment.moveBy(commentX, commentY);\n      }\n    } finally {\n      eventUtils.enable();\n    }\n    if (eventUtils.isEnabled()) {\n      WorkspaceComment.fireCreateEvent(comment);\n    }\n    comment.select();\n    return comment;\n  }\n\n  /**\n   * Refresh the toolbox unless there's a drag in progress.\n   *\n   * @internal\n   */\n  refreshToolboxSelection() {\n    const ws = this.isFlyout ? this.targetWorkspace : this;\n    if (ws && !ws.currentGesture_ && ws.toolbox_ && ws.toolbox_.getFlyout()) {\n      ws.toolbox_.refreshSelection();\n    }\n  }\n\n  /**\n   * Rename a variable by updating its name in the variable map.  Update the\n   *     flyout to show the renamed variable immediately.\n   *\n   * @param id ID of the variable to rename.\n   * @param newName New variable name.\n   */\n  override renameVariableById(id: string, newName: string) {\n    super.renameVariableById(id, newName);\n    this.refreshToolboxSelection();\n  }\n\n  /**\n   * Delete a variable by the passed in ID.   Update the flyout to show\n   *     immediately that the variable is deleted.\n   *\n   * @param id ID of variable to delete.\n   */\n  override deleteVariableById(id: string) {\n    super.deleteVariableById(id);\n    this.refreshToolboxSelection();\n  }\n\n  /**\n   * Create a new variable with the given name.  Update the flyout to show the\n   *     new variable immediately.\n   *\n   * @param name The new variable's name.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   * @returns The newly created variable.\n   */\n  override createVariable(\n      name: string, opt_type?: string|null,\n      opt_id?: string|null): VariableModel {\n    const newVar = super.createVariable(name, opt_type, opt_id);\n    this.refreshToolboxSelection();\n    return newVar;\n  }\n\n  /**\n   * Make a list of all the delete areas for this workspace.\n   *\n   * @deprecated Use workspace.recordDragTargets. (2021 June)\n   */\n  recordDeleteAreas() {\n    utils.deprecation.warn(\n        'WorkspaceSvg.prototype.recordDeleteAreas', 'June 2021', 'June 2022',\n        'WorkspaceSvg.prototype.recordDragTargets');\n    this.recordDragTargets();\n  }\n\n  /** Make a list of all the delete areas for this workspace. */\n  recordDragTargets() {\n    const dragTargets = this.componentManager_.getComponents(\n        ComponentManager.Capability.DRAG_TARGET, true);\n\n    this.dragTargetAreas_ = [];\n    for (let i = 0, targetArea; targetArea = dragTargets[i]; i++) {\n      const rect = targetArea.getClientRect();\n      if (rect) {\n        this.dragTargetAreas_.push({\n          component: targetArea,\n          clientRect: rect,\n        });\n      }\n    }\n  }\n  /* eslint-disable jsdoc/require-returns-check */\n  /* eslint-disable @typescript-eslint/no-unused-vars */\n  /**\n   * Obtain a newly created block.\n   *\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   * @returns The created block.\n   */\n  override newBlock(prototypeName: string, opt_id?: string): BlockSvg {\n    throw new Error(\n        'The implementation of newBlock should be ' +\n        'monkey-patched in by blockly.ts');\n  }\n  /* eslint-enable */\n\n  /**\n   * Returns the drag target the mouse event is over.\n   *\n   * @param e Mouse move event.\n   * @returns Null if not over a drag target, or the drag target the event is\n   *     over.\n   */\n  getDragTarget(e: Event): IDragTarget|null {\n    for (let i = 0, targetArea; targetArea = this.dragTargetAreas_[i]; i++) {\n      if (targetArea.clientRect.contains(\n              (e as AnyDuringMigration).clientX,\n              (e as AnyDuringMigration).clientY)) {\n        return targetArea.component;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Handle a mouse-down on SVG drawing surface.\n   *\n   * @param e Mouse down event.\n   */\n  private onMouseDown_(e: MouseEvent) {\n    const gesture = this.getGesture(e);\n    if (gesture) {\n      gesture.handleWsStart(e, this);\n    }\n  }\n\n  /**\n   * Start tracking a drag of an object on this workspace.\n   *\n   * @param e Mouse down event.\n   * @param xy Starting location of object.\n   */\n  startDrag(e: MouseEvent, xy: Coordinate) {\n    // Record the starting offset between the bubble's location and the mouse.\n    const point = browserEvents.mouseToSvg(\n        e, this.getParentSvg(), this.getInverseScreenCTM());\n    // Fix scale of mouse event.\n    point.x /= this.scale;\n    point.y /= this.scale;\n    this.dragDeltaXY_ = Coordinate.difference(xy, point);\n  }\n\n  /**\n   * Track a drag of an object on this workspace.\n   *\n   * @param e Mouse move event.\n   * @returns New location of object.\n   */\n  moveDrag(e: MouseEvent): Coordinate {\n    const point = browserEvents.mouseToSvg(\n        e, this.getParentSvg(), this.getInverseScreenCTM());\n    // Fix scale of mouse event.\n    point.x /= this.scale;\n    point.y /= this.scale;\n    return Coordinate.sum((this.dragDeltaXY_!), point);\n  }\n\n  /**\n   * Is the user currently dragging a block or scrolling the flyout/workspace?\n   *\n   * @returns True if currently dragging or scrolling.\n   */\n  isDragging(): boolean {\n    return this.currentGesture_ !== null && this.currentGesture_.isDragging();\n  }\n\n  /**\n   * Is this workspace draggable?\n   *\n   * @returns True if this workspace may be dragged.\n   */\n  isDraggable(): boolean {\n    return this.options.moveOptions && this.options.moveOptions.drag;\n  }\n\n  /**\n   * Is this workspace movable?\n   *\n   * This means the user can reposition the X Y coordinates of the workspace\n   * through input. This can be through scrollbars, scroll wheel, dragging, or\n   * through zooming with the scroll wheel or pinch (since the zoom is centered\n   * on the mouse position). This does not include zooming with the zoom\n   * controls since the X Y coordinates are decided programmatically.\n   *\n   * @returns True if the workspace is movable, false otherwise.\n   */\n  isMovable(): boolean {\n    return this.options.moveOptions && !!this.options.moveOptions.scrollbars ||\n        this.options.moveOptions && this.options.moveOptions.wheel ||\n        this.options.moveOptions && this.options.moveOptions.drag ||\n        this.options.zoomOptions && this.options.zoomOptions.wheel ||\n        this.options.zoomOptions && this.options.zoomOptions.pinch;\n  }\n\n  /**\n   * Is this workspace movable horizontally?\n   *\n   * @returns True if the workspace is movable horizontally, false otherwise.\n   */\n  isMovableHorizontally(): boolean {\n    const hasScrollbars = !!this.scrollbar;\n    return this.isMovable() &&\n        (!hasScrollbars ||\n         hasScrollbars && this.scrollbar!.canScrollHorizontally());\n  }\n\n  /**\n   * Is this workspace movable vertically?\n   *\n   * @returns True if the workspace is movable vertically, false otherwise.\n   */\n  isMovableVertically(): boolean {\n    const hasScrollbars = !!this.scrollbar;\n    return this.isMovable() &&\n        (!hasScrollbars ||\n         hasScrollbars && this.scrollbar!.canScrollVertically());\n  }\n\n  /**\n   * Handle a mouse-wheel on SVG drawing surface.\n   *\n   * @param e Mouse wheel event.\n   */\n  private onMouseWheel_(e: WheelEvent) {\n    // Don't scroll or zoom anything if drag is in progress.\n    if (Gesture.inProgress()) {\n      e.preventDefault();\n      e.stopPropagation();\n      return;\n    }\n    const canWheelZoom =\n        this.options.zoomOptions && this.options.zoomOptions.wheel;\n    const canWheelMove =\n        this.options.moveOptions && this.options.moveOptions.wheel;\n    if (!canWheelZoom && !canWheelMove) {\n      return;\n    }\n\n    const scrollDelta = browserEvents.getScrollDeltaPixels(e);\n\n    // Zoom should also be enabled by the command key on Mac devices,\n    // but not super on Unix.\n    let commandKey;\n    if (userAgent.MAC) {\n      commandKey = e.metaKey;\n    }\n\n    if (canWheelZoom && (e.ctrlKey || commandKey || !canWheelMove)) {\n      // Zoom.\n      // The vertical scroll distance that corresponds to a click of a zoom\n      // button.\n      const PIXELS_PER_ZOOM_STEP = 50;\n      const delta = -scrollDelta.y / PIXELS_PER_ZOOM_STEP;\n      const position = browserEvents.mouseToSvg(\n          e, this.getParentSvg(), this.getInverseScreenCTM());\n      this.zoom(position.x, position.y, delta);\n    } else {\n      // Scroll.\n      let x = this.scrollX - scrollDelta.x;\n      let y = this.scrollY - scrollDelta.y;\n\n      if (e.shiftKey && !scrollDelta.x) {\n        // Scroll horizontally (based on vertical scroll delta).\n        // This is needed as for some browser/system combinations which do not\n        // set deltaX.\n        x = this.scrollX - scrollDelta.y;\n        y = this.scrollY;  // Don't scroll vertically.\n      }\n      this.scroll(x, y);\n    }\n    e.preventDefault();\n  }\n\n  /**\n   * Calculate the bounding box for the blocks on the workspace.\n   * Coordinate system: workspace coordinates.\n   *\n   * @returns Contains the position and size of the bounding box containing the\n   *     blocks on the workspace.\n   */\n  getBlocksBoundingBox(): Rect {\n    const topElements = this.getTopBoundedElements();\n    // There are no blocks, return empty rectangle.\n    if (!topElements.length) {\n      return new Rect(0, 0, 0, 0);\n    }\n\n    // Initialize boundary using the first block.\n    const boundary = topElements[0].getBoundingRectangle();\n\n    // Start at 1 since the 0th block was used for initialization.\n    for (let i = 1; i < topElements.length; i++) {\n      const topElement = topElements[i];\n      if ((topElement as any).isInsertionMarker &&\n          (topElement as any).isInsertionMarker()) {\n        continue;\n      }\n      const blockBoundary = topElement.getBoundingRectangle();\n      if (blockBoundary.top < boundary.top) {\n        boundary.top = blockBoundary.top;\n      }\n      if (blockBoundary.bottom > boundary.bottom) {\n        boundary.bottom = blockBoundary.bottom;\n      }\n      if (blockBoundary.left < boundary.left) {\n        boundary.left = blockBoundary.left;\n      }\n      if (blockBoundary.right > boundary.right) {\n        boundary.right = blockBoundary.right;\n      }\n    }\n    return boundary;\n  }\n\n  /** Clean up the workspace by ordering all the blocks in a column. */\n  cleanUp() {\n    this.setResizesEnabled(false);\n    eventUtils.setGroup(true);\n    const topBlocks = this.getTopBlocks(true);\n    let cursorY = 0;\n    for (let i = 0, block; block = topBlocks[i]; i++) {\n      if (!block.isMovable()) {\n        continue;\n      }\n      const xy = block.getRelativeToSurfaceXY();\n      block.moveBy(-xy.x, cursorY - xy.y);\n      block.snapToGrid();\n      cursorY = block.getRelativeToSurfaceXY().y +\n          block.getHeightWidth().height +\n          this.renderer_.getConstants().MIN_BLOCK_HEIGHT;\n    }\n    eventUtils.setGroup(false);\n    this.setResizesEnabled(true);\n  }\n\n  /**\n   * Show the context menu for the workspace.\n   *\n   * @param e Mouse event.\n   * @internal\n   */\n  showContextMenu(e: Event) {\n    if (this.options.readOnly || this.isFlyout) {\n      return;\n    }\n    const menuOptions = ContextMenuRegistry.registry.getContextMenuOptions(\n        ContextMenuRegistry.ScopeType.WORKSPACE, {workspace: this});\n\n    // Allow the developer to add or modify menuOptions.\n    if (this.configureContextMenu) {\n      this.configureContextMenu(menuOptions, e);\n    }\n\n    ContextMenu.show(e, menuOptions, this.RTL);\n  }\n\n  /**\n   * Modify the block tree on the existing toolbox.\n   *\n   * @param toolboxDef DOM tree of toolbox contents, string of toolbox contents,\n   *     or JSON representing toolbox definition.\n   */\n  updateToolbox(toolboxDef: toolbox.ToolboxDefinition|null) {\n    const parsedToolboxDef = toolbox.convertToolboxDefToJson(toolboxDef);\n\n    if (!parsedToolboxDef) {\n      if (this.options.languageTree) {\n        throw Error('Can\\'t nullify an existing toolbox.');\n      }\n      return;  // No change (null to null).\n    }\n    if (!this.options.languageTree) {\n      throw Error('Existing toolbox is null.  Can\\'t create new toolbox.');\n    }\n\n    if (toolbox.hasCategories(parsedToolboxDef)) {\n      if (!this.toolbox_) {\n        throw Error('Existing toolbox has no categories.  Can\\'t change mode.');\n      }\n      this.options.languageTree = parsedToolboxDef;\n      this.toolbox_.render(parsedToolboxDef);\n    } else {\n      if (!this.flyout_) {\n        throw Error('Existing toolbox has categories.  Can\\'t change mode.');\n      }\n      this.options.languageTree = parsedToolboxDef;\n      this.flyout_.show(parsedToolboxDef);\n    }\n  }\n\n  /** Mark this workspace as the currently focused main workspace. */\n  markFocused() {\n    if (this.options.parentWorkspace) {\n      this.options.parentWorkspace.markFocused();\n    } else {\n      common.setMainWorkspace(this);\n      // We call e.preventDefault in many event handlers which means we\n      // need to explicitly grab focus (e.g from a textarea) because\n      // the browser will not do it for us.  How to do this is browser\n      // dependent.\n      this.setBrowserFocus();\n    }\n  }\n\n  /** Set the workspace to have focus in the browser. */\n  private setBrowserFocus() {\n    // Blur whatever was focused since explicitly grabbing focus below does not\n    // work in Edge.\n    // In IE, SVGs can't be blurred or focused. Check to make sure the current\n    // focus can be blurred before doing so.\n    // See https://github.com/google/blockly/issues/4440\n    if (document.activeElement &&\n        document.activeElement instanceof HTMLElement) {\n      document.activeElement.blur();\n    }\n    try {\n      // Focus the workspace SVG - this is for Chrome and Firefox.\n      this.getParentSvg().focus({preventScroll: true});\n    } catch (e) {\n      // IE and Edge do not support focus on SVG elements. When that fails\n      // above, get the injectionDiv (the workspace's parent) and focus that\n      // instead.  This doesn't work in Chrome.\n      try {\n        // In IE11, use setActive (which is IE only) so the page doesn't scroll\n        // to the workspace gaining focus.\n        (this.getParentSvg().parentElement as any).setActive();\n      } catch (e) {\n        // setActive support was discontinued in Edge so when that fails, call\n        // focus instead.\n        this.getParentSvg().parentElement!.focus({preventScroll: true});\n      }\n    }\n  }\n\n  /**\n   * Zooms the workspace in or out relative to/centered on the given (x, y)\n   * coordinate.\n   *\n   * @param x X coordinate of center, in pixel units relative to the top-left\n   *     corner of the parentSVG.\n   * @param y Y coordinate of center, in pixel units relative to the top-left\n   *     corner of the parentSVG.\n   * @param amount Amount of zooming. The formula for the new scale is newScale\n   *     = currentScale * (scaleSpeed^amount). scaleSpeed is set in the\n   *     workspace options. Negative amount values zoom out, and positive amount\n   *     values zoom in.\n   */\n  zoom(x: number, y: number, amount: number) {\n    // Scale factor.\n    const speed = this.options.zoomOptions.scaleSpeed;\n    let scaleChange = Math.pow(speed, amount);\n    const newScale = this.scale * scaleChange;\n    if (this.scale === newScale) {\n      return;  // No change in zoom.\n    }\n\n    // Clamp scale within valid range.\n    if (newScale > this.options.zoomOptions.maxScale) {\n      scaleChange = this.options.zoomOptions.maxScale / this.scale;\n    } else if (newScale < this.options.zoomOptions.minScale) {\n      scaleChange = this.options.zoomOptions.minScale / this.scale;\n    }\n\n    // Transform the x/y coordinates from the parentSVG's space into the\n    // canvas' space, so that they are in workspace units relative to the top\n    // left of the visible portion of the workspace.\n    let matrix = this.getCanvas().getCTM();\n    let center = (this.getParentSvg()).createSVGPoint();\n    center.x = x;\n    center.y = y;\n    center = center.matrixTransform(matrix!.inverse());\n    x = center.x;\n    y = center.y;\n\n    // Find the new scrollX/scrollY so that the center remains in the same\n    // position (relative to the center) after we zoom.\n    // newScale and matrix.a should be identical (within a rounding error).\n    matrix = matrix!.translate(x * (1 - scaleChange), y * (1 - scaleChange))\n                 .scale(scaleChange);\n    // scrollX and scrollY are in pixels.\n    // The scrollX and scrollY still need to have absoluteLeft and absoluteTop\n    // subtracted from them, but we'll leave that for setScale so that they're\n    // correctly updated for the new flyout size if we have a simple toolbox.\n    this.scrollX = matrix.e;\n    this.scrollY = matrix.f;\n    this.setScale(newScale);\n  }\n\n  /**\n   * Zooming the blocks centered in the center of view with zooming in or out.\n   *\n   * @param type Type of zooming (-1 zooming out and 1 zooming in).\n   */\n  zoomCenter(type: number) {\n    const metrics = this.getMetrics();\n    let x;\n    let y;\n    if (this.flyout_) {\n      // If you want blocks in the center of the view (visible portion of the\n      // workspace) to stay centered when the size of the view decreases (i.e.\n      // when the size of the flyout increases) you need the center of the\n      // *blockly div* to stay in the same pixel-position.\n      // Note: This only works because of how scrollCenter positions blocks.\n      x = metrics.svgWidth ? metrics.svgWidth / 2 : 0;\n      y = metrics.svgHeight ? metrics.svgHeight / 2 : 0;\n    } else {\n      x = metrics.viewWidth / 2 + metrics.absoluteLeft;\n      y = metrics.viewHeight / 2 + metrics.absoluteTop;\n    }\n    this.zoom(x, y, type);\n  }\n\n  /** Zoom the blocks to fit in the workspace if possible. */\n  zoomToFit() {\n    if (!this.isMovable()) {\n      console.warn(\n          'Tried to move a non-movable workspace. This could result' +\n          ' in blocks becoming inaccessible.');\n      return;\n    }\n\n    const metrics = this.getMetrics();\n    let workspaceWidth = metrics.viewWidth;\n    let workspaceHeight = metrics.viewHeight;\n    const blocksBox = this.getBlocksBoundingBox();\n    const doubleMargin = ZOOM_TO_FIT_MARGIN * 2;\n    let blocksWidth = blocksBox.right - blocksBox.left + doubleMargin;\n    let blocksHeight = blocksBox.bottom - blocksBox.top + doubleMargin;\n    if (!blocksWidth) {\n      return;  // Prevents zooming to infinity.\n    }\n    if (this.flyout_) {\n      // We have to add the flyout size to both the workspace size and the\n      // block size because the blocks we want to resize include the blocks in\n      // the flyout, and the area we want to fit them includes the portion of\n      // the workspace that is behind the flyout.\n      if (this.horizontalLayout) {\n        workspaceHeight += this.flyout_.getHeight();\n        // Convert from pixels to workspace coordinates.\n        blocksHeight += this.flyout_.getHeight() / this.scale;\n      } else {\n        workspaceWidth += this.flyout_.getWidth();\n        // Convert from pixels to workspace coordinates.\n        blocksWidth += this.flyout_.getWidth() / this.scale;\n      }\n    }\n\n    // Scale Units: (pixels / workspaceUnit)\n    const ratioX = workspaceWidth / blocksWidth;\n    const ratioY = workspaceHeight / blocksHeight;\n    eventUtils.disable();\n    try {\n      this.setScale(Math.min(ratioX, ratioY));\n      this.scrollCenter();\n    } finally {\n      eventUtils.enable();\n    }\n    this.maybeFireViewportChangeEvent();\n  }\n\n  /**\n   * Add a transition class to the block and bubble canvas, to animate any\n   * transform changes.\n   *\n   * @internal\n   */\n  beginCanvasTransition() {\n    dom.addClass((this.svgBlockCanvas_), 'blocklyCanvasTransitioning');\n    dom.addClass((this.svgBubbleCanvas_), 'blocklyCanvasTransitioning');\n  }\n\n  /**\n   * Remove transition class from the block and bubble canvas.\n   *\n   * @internal\n   */\n  endCanvasTransition() {\n    dom.removeClass((this.svgBlockCanvas_), 'blocklyCanvasTransitioning');\n    dom.removeClass((this.svgBubbleCanvas_), 'blocklyCanvasTransitioning');\n  }\n\n  /** Center the workspace. */\n  scrollCenter() {\n    if (!this.isMovable()) {\n      console.warn(\n          'Tried to move a non-movable workspace. This could result' +\n          ' in blocks becoming inaccessible.');\n      return;\n    }\n\n    const metrics = this.getMetrics();\n    let x = (metrics.scrollWidth - metrics.viewWidth) / 2;\n    let y = (metrics.scrollHeight - metrics.viewHeight) / 2;\n\n    // Convert from workspace directions to canvas directions.\n    x = -x - metrics.scrollLeft;\n    y = -y - metrics.scrollTop;\n    this.scroll(x, y);\n  }\n\n  /**\n   * Scroll the workspace to center on the given block. If the block has other\n   * blocks stacked below it, the workspace will be centered on the stack.\n   *\n   * @param id ID of block center on.\n   */\n  centerOnBlock(id: string|null) {\n    if (!this.isMovable()) {\n      console.warn(\n          'Tried to move a non-movable workspace. This could result' +\n          ' in blocks becoming inaccessible.');\n      return;\n    }\n\n    const block = id ? this.getBlockById(id) : null;\n    if (!block) {\n      return;\n    }\n\n    // XY is in workspace coordinates.\n    const xy = block.getRelativeToSurfaceXY();\n    // Height/width is in workspace units.\n    const heightWidth = block.getHeightWidth();\n\n    // Find the enter of the block in workspace units.\n    const blockCenterY = xy.y + heightWidth.height / 2;\n\n    // In RTL the block's position is the top right of the block, not top left.\n    const multiplier = this.RTL ? -1 : 1;\n    const blockCenterX = xy.x + multiplier * heightWidth.width / 2;\n\n    // Workspace scale, used to convert from workspace coordinates to pixels.\n    const scale = this.scale;\n\n    // Center of block in pixels, relative to workspace origin (center 0,0).\n    // Scrolling to here would put the block in the top-left corner of the\n    // visible workspace.\n    const pixelX = blockCenterX * scale;\n    const pixelY = blockCenterY * scale;\n\n    const metrics = this.getMetrics();\n\n    // viewHeight and viewWidth are in pixels.\n    const halfViewWidth = metrics.viewWidth / 2;\n    const halfViewHeight = metrics.viewHeight / 2;\n\n    // Put the block in the center of the visible workspace instead.\n    const scrollToCenterX = pixelX - halfViewWidth;\n    const scrollToCenterY = pixelY - halfViewHeight;\n\n    // Convert from workspace directions to canvas directions.\n    const x = -scrollToCenterX;\n    const y = -scrollToCenterY;\n\n    this.scroll(x, y);\n  }\n\n  /**\n   * Set the workspace's zoom factor.\n   *\n   * @param newScale Zoom factor. Units: (pixels / workspaceUnit).\n   */\n  setScale(newScale: number) {\n    if (this.options.zoomOptions.maxScale &&\n        newScale > this.options.zoomOptions.maxScale) {\n      newScale = this.options.zoomOptions.maxScale;\n    } else if (\n        this.options.zoomOptions.minScale &&\n        newScale < this.options.zoomOptions.minScale) {\n      newScale = this.options.zoomOptions.minScale;\n    }\n    this.scale = newScale;\n\n    this.hideChaff(false);\n    // Get the flyout, if any, whether our own or owned by the toolbox.\n    const flyout = this.getFlyout(false);\n    if (flyout && flyout.isVisible()) {\n      flyout.reflow();\n      this.recordDragTargets();\n    }\n    if (this.grid_) {\n      this.grid_.update(this.scale);\n    }\n\n    // We call scroll instead of scrollbar.resize() so that we can center the\n    // zoom correctly without scrollbars, but scroll does not resize the\n    // scrollbars so we have to call resizeView/resizeContent as well.\n    const metrics = this.getMetrics();\n\n    this.scrollX -= metrics.absoluteLeft;\n    this.scrollY -= metrics.absoluteTop;\n    // The scroll values and the view values are additive inverses of\n    // each other, so when we subtract from one we have to add to the other.\n    metrics.viewLeft += metrics.absoluteLeft;\n    metrics.viewTop += metrics.absoluteTop;\n\n    this.scroll(this.scrollX, this.scrollY);\n    if (this.scrollbar) {\n      if (this.flyout_) {\n        this.scrollbar.resizeView(metrics);\n      } else {\n        this.scrollbar.resizeContent(metrics);\n      }\n    }\n  }\n\n  /**\n   * Get the workspace's zoom factor.  If the workspace has a parent, we call\n   * into the parent to get the workspace scale.\n   *\n   * @returns The workspace zoom factor. Units: (pixels / workspaceUnit).\n   */\n  getScale(): number {\n    if (this.options.parentWorkspace) {\n      return this.options.parentWorkspace.getScale();\n    }\n    return this.scale;\n  }\n\n  /**\n   * Scroll the workspace to a specified offset (in pixels), keeping in the\n   * workspace bounds. See comment on workspaceSvg.scrollX for more detail on\n   * the meaning of these values.\n   *\n   * @param x Target X to scroll to.\n   * @param y Target Y to scroll to.\n   * @internal\n   */\n  scroll(x: number, y: number) {\n    this.hideChaff(/* opt_onlyClosePopups= */\n                   true);\n\n    // Keep scrolling within the bounds of the content.\n    const metrics = this.getMetrics();\n    // Canvas coordinates (aka scroll coordinates) have inverse directionality\n    // to workspace coordinates so we have to inverse them.\n    x = Math.min(x, -metrics.scrollLeft);\n    y = Math.min(y, -metrics.scrollTop);\n    const maxXDisplacement =\n        Math.max(0, metrics.scrollWidth - metrics.viewWidth);\n    const maxXScroll = metrics.scrollLeft + maxXDisplacement;\n    const maxYDisplacement =\n        Math.max(0, metrics.scrollHeight - metrics.viewHeight);\n    const maxYScroll = metrics.scrollTop + maxYDisplacement;\n    x = Math.max(x, -maxXScroll);\n    y = Math.max(y, -maxYScroll);\n    this.scrollX = x;\n    this.scrollY = y;\n\n    if (this.scrollbar) {\n      // The content position (displacement from the content's top-left to the\n      // origin) plus the scroll position (displacement from the view's top-left\n      // to the origin) gives us the distance from the view's top-left to the\n      // content's top-left. Then we negate this so we get the displacement from\n      // the content's top-left to the view's top-left, matching the\n      // directionality of the scrollbars.\n      this.scrollbar.set(\n          -(x + metrics.scrollLeft), -(y + metrics.scrollTop), false);\n    }\n    // We have to shift the translation so that when the canvas is at 0, 0 the\n    // workspace origin is not underneath the toolbox.\n    x += metrics.absoluteLeft;\n    y += metrics.absoluteTop;\n    this.translate(x, y);\n  }\n\n  /**\n   * Find the block on this workspace with the specified ID.\n   *\n   * @param id ID of block to find.\n   * @returns The sought after block, or null if not found.\n   */\n  override getBlockById(id: string): BlockSvg|null {\n    return super.getBlockById(id) as BlockSvg;\n  }\n\n  /**\n   * Find all blocks in workspace.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  override getAllBlocks(ordered: boolean): BlockSvg[] {\n    return super.getAllBlocks(ordered) as BlockSvg[];\n  }\n\n  /**\n   * Finds the top-level blocks and returns them.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns The top-level block objects.\n   */\n  override getTopBlocks(ordered: boolean): BlockSvg[] {\n    return super.getTopBlocks(ordered) as BlockSvg[];\n  }\n\n  /**\n   * Adds a block to the list of top blocks.\n   *\n   * @param block Block to add.\n   */\n  override addTopBlock(block: Block) {\n    this.addTopBoundedElement(block as BlockSvg);\n    super.addTopBlock(block);\n  }\n\n  /**\n   * Removes a block from the list of top blocks.\n   *\n   * @param block Block to remove.\n   */\n  override removeTopBlock(block: Block) {\n    this.removeTopBoundedElement(block as BlockSvg);\n    super.removeTopBlock(block);\n  }\n\n  /**\n   * Adds a comment to the list of top comments.\n   *\n   * @param comment comment to add.\n   */\n  override addTopComment(comment: WorkspaceComment) {\n    this.addTopBoundedElement(comment as WorkspaceCommentSvg);\n    super.addTopComment(comment);\n  }\n\n  /**\n   * Removes a comment from the list of top comments.\n   *\n   * @param comment comment to remove.\n   */\n  override removeTopComment(comment: WorkspaceComment) {\n    this.removeTopBoundedElement(comment as WorkspaceCommentSvg);\n    super.removeTopComment(comment);\n  }\n\n  /**\n   * Adds a bounded element to the list of top bounded elements.\n   *\n   * @param element Bounded element to add.\n   */\n  addTopBoundedElement(element: IBoundedElement) {\n    this.topBoundedElements_.push(element);\n  }\n\n  /**\n   * Removes a bounded element from the list of top bounded elements.\n   *\n   * @param element Bounded element to remove.\n   */\n  removeTopBoundedElement(element: IBoundedElement) {\n    arrayUtils.removeElem(this.topBoundedElements_, element);\n  }\n\n  /**\n   * Finds the top-level bounded elements and returns them.\n   *\n   * @returns The top-level bounded elements.\n   */\n  getTopBoundedElements(): IBoundedElement[] {\n    return (new Array<IBoundedElement>()).concat(this.topBoundedElements_);\n  }\n\n  /**\n   * Update whether this workspace has resizes enabled.\n   * If enabled, workspace will resize when appropriate.\n   * If disabled, workspace will not resize until re-enabled.\n   * Use to avoid resizing during a batch operation, for performance.\n   *\n   * @param enabled Whether resizes should be enabled.\n   */\n  setResizesEnabled(enabled: boolean) {\n    const reenabled = !this.resizesEnabled_ && enabled;\n    this.resizesEnabled_ = enabled;\n    if (reenabled) {\n      // Newly enabled.  Trigger a resize.\n      this.resizeContents();\n    }\n  }\n\n  /**\n   * Dispose of all blocks in workspace, with an optimization to prevent\n   * resizes.\n   */\n  override clear() {\n    this.setResizesEnabled(false);\n    super.clear();\n    this.topBoundedElements_ = [];\n    this.setResizesEnabled(true);\n  }\n\n  /**\n   * Register a callback function associated with a given key, for clicks on\n   * buttons and labels in the flyout.\n   * For instance, a button specified by the XML\n   * <button text=\"create variable\" callbackKey=\"CREATE_VARIABLE\"></button>\n   * should be matched by a call to\n   * registerButtonCallback(\"CREATE_VARIABLE\", yourCallbackFunction).\n   *\n   * @param key The name to use to look up this function.\n   * @param func The function to call when the given button is clicked.\n   */\n  registerButtonCallback(key: string, func: (p1: FlyoutButton) => void) {\n    if (typeof func !== 'function') {\n      throw TypeError('Button callbacks must be functions.');\n    }\n    this.flyoutButtonCallbacks.set(key, func);\n  }\n\n  /**\n   * Get the callback function associated with a given key, for clicks on\n   * buttons and labels in the flyout.\n   *\n   * @param key The name to use to look up the function.\n   * @returns The function corresponding to the given key for this workspace;\n   *     null if no callback is registered.\n   */\n  getButtonCallback(key: string): ((p1: FlyoutButton) => void)|null {\n    return this.flyoutButtonCallbacks.get(key) ?? null;\n  }\n\n  /**\n   * Remove a callback for a click on a button in the flyout.\n   *\n   * @param key The name associated with the callback function.\n   */\n  removeButtonCallback(key: string) {\n    this.flyoutButtonCallbacks.delete(key);\n  }\n\n  /**\n   * Register a callback function associated with a given key, for populating\n   * custom toolbox categories in this workspace.  See the variable and\n   * procedure categories as an example.\n   *\n   * @param key The name to use to look up this function.\n   * @param func The function to call when the given toolbox category is opened.\n   */\n  registerToolboxCategoryCallback(\n      key: string, func: (p1: WorkspaceSvg) => toolbox.FlyoutDefinition) {\n    if (typeof func !== 'function') {\n      throw TypeError('Toolbox category callbacks must be functions.');\n    }\n    this.toolboxCategoryCallbacks.set(key, func);\n  }\n\n  /**\n   * Get the callback function associated with a given key, for populating\n   * custom toolbox categories in this workspace.\n   *\n   * @param key The name to use to look up the function.\n   * @returns The function corresponding to the given key for this workspace, or\n   *     null if no function is registered.\n   */\n  getToolboxCategoryCallback(key: string):\n      ((p1: WorkspaceSvg) => toolbox.FlyoutDefinition)|null {\n    return this.toolboxCategoryCallbacks.get(key) || null;\n  }\n\n  /**\n   * Remove a callback for a click on a custom category's name in the toolbox.\n   *\n   * @param key The name associated with the callback function.\n   */\n  removeToolboxCategoryCallback(key: string) {\n    this.toolboxCategoryCallbacks.delete(key);\n  }\n\n  /**\n   * Look up the gesture that is tracking this touch stream on this workspace.\n   * May create a new gesture.\n   *\n   * @param e Mouse event or touch event.\n   * @returns The gesture that is tracking this touch stream, or null if no\n   *     valid gesture exists.\n   * @internal\n   */\n  getGesture(e: Event): TouchGesture|null {\n    const isStart = e.type === 'mousedown' || e.type === 'touchstart' ||\n        e.type === 'pointerdown';\n\n    const gesture = this.currentGesture_;\n    if (gesture) {\n      if (isStart && gesture.hasStarted()) {\n        console.warn('Tried to start the same gesture twice.');\n        // That's funny.  We must have missed a mouse up.\n        // Cancel it, rather than try to retrieve all of the state we need.\n        gesture.cancel();\n        return null;\n      }\n      return gesture;\n    }\n\n    // No gesture existed on this workspace, but this looks like the start of a\n    // new gesture.\n    if (isStart) {\n      this.currentGesture_ = new TouchGesture(e, this);\n      return this.currentGesture_;\n    }\n    // No gesture existed and this event couldn't be the start of a new gesture.\n    return null;\n  }\n\n  /**\n   * Clear the reference to the current gesture.\n   *\n   * @internal\n   */\n  clearGesture() {\n    this.currentGesture_ = null;\n  }\n\n  /**\n   * Cancel the current gesture, if one exists.\n   *\n   * @internal\n   */\n  cancelCurrentGesture() {\n    if (this.currentGesture_) {\n      this.currentGesture_.cancel();\n    }\n  }\n\n  /**\n   * Get the audio manager for this workspace.\n   *\n   * @returns The audio manager for this workspace.\n   */\n  getAudioManager(): WorkspaceAudio {\n    return this.audioManager_;\n  }\n\n  /**\n   * Get the grid object for this workspace, or null if there is none.\n   *\n   * @returns The grid object for this workspace.\n   * @internal\n   */\n  getGrid(): Grid|null {\n    return this.grid_;\n  }\n\n  /**\n   * Close tooltips, context menus, dropdown selections, etc.\n   *\n   * @param opt_onlyClosePopups Whether only popups should be closed.\n   */\n  hideChaff(opt_onlyClosePopups?: boolean) {\n    Tooltip.hide();\n    WidgetDiv.hide();\n    dropDownDiv.hideWithoutAnimation();\n\n    const onlyClosePopups = !!opt_onlyClosePopups;\n    const autoHideables = this.getComponentManager().getComponents(\n        ComponentManager.Capability.AUTOHIDEABLE, true);\n    autoHideables.forEach(\n        (autoHideable) => autoHideable.autoHide(onlyClosePopups));\n  }\n\n  /**\n   * Sets the X/Y translations of a top level workspace.\n   *\n   * @param xyRatio Contains an x and/or y property which is a float between 0\n   *     and 1 specifying the degree of scrolling.\n   */\n  private static setTopLevelWorkspaceMetrics_(\n      this: WorkspaceSvg, xyRatio: {x?: number, y?: number}) {\n    const metrics = this.getMetrics();\n\n    if (typeof xyRatio.x === 'number') {\n      this.scrollX =\n          -(metrics.scrollLeft +\n            (metrics.scrollWidth - metrics.viewWidth) * xyRatio.x);\n    }\n    if (typeof xyRatio.y === 'number') {\n      this.scrollY =\n          -(metrics.scrollTop +\n            (metrics.scrollHeight - metrics.viewHeight) * xyRatio.y);\n    }\n    // We have to shift the translation so that when the canvas is at 0, 0 the\n    // workspace origin is not underneath the toolbox.\n    const x = this.scrollX + metrics.absoluteLeft;\n    const y = this.scrollY + metrics.absoluteTop;\n    // We could call scroll here, but that has extra checks we don't need to do.\n    this.translate(x, y);\n  }\n}\n\n/**\n * Size the workspace when the contents change.  This also updates\n * scrollbars accordingly.\n *\n * @param workspace The workspace to resize.\n * @alias Blockly.WorkspaceSvg.resizeSvgContents\n * @internal\n */\nexport function resizeSvgContents(workspace: WorkspaceSvg) {\n  workspace.resizeContents();\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Contains top-level functions for serializing workspaces to plain JavaScript\n * objects.\n *\n * @namespace Blockly.serialization.workspaces\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.serialization.workspaces');\n\nimport * as eventUtils from '../events/utils.js';\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport * as registry from '../registry.js';\nimport * as dom from '../utils/dom.js';\n// eslint-disable-next-line no-unused-vars\nimport type {Workspace} from '../workspace.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\n\n\n/**\n * Returns the state of the workspace as a plain JavaScript object.\n *\n * @param workspace The workspace to serialize.\n * @returns The serialized state of the workspace.\n * @alias Blockly.serialization.workspaces.save\n */\nexport function save(workspace: Workspace):\n    {[key: string]: AnyDuringMigration} {\n  const state = Object.create(null);\n  const serializerMap = registry.getAllItems(registry.Type.SERIALIZER, true);\n  for (const key in serializerMap) {\n    const save = (serializerMap[key] as ISerializer)?.save(workspace);\n    if (save) {\n      state[key] = save;\n    }\n  }\n  return state;\n}\n\n/**\n * Loads the variable represented by the given state into the given workspace.\n *\n * @param state The state of the workspace to deserialize into the workspace.\n * @param workspace The workspace to add the new state to.\n * @param param1 recordUndo: If true, events triggered by this function will be\n *     undo-able by the user. False by default.\n * @alias Blockly.serialization.workspaces.load\n */\nexport function load(\n    state: {[key: string]: AnyDuringMigration}, workspace: Workspace,\n    {recordUndo = false}: {recordUndo?: boolean} = {}) {\n  const serializerMap = registry.getAllItems(registry.Type.SERIALIZER, true);\n  if (!serializerMap) {\n    return;\n  }\n\n  const deserializers = Object.entries(serializerMap)\n                            .sort(\n                                (a, b) => (b[1] as ISerializer)!.priority -\n                                    (a[1] as ISerializer)!.priority);\n\n  const prevRecordUndo = eventUtils.getRecordUndo();\n  eventUtils.setRecordUndo(recordUndo);\n  const existingGroup = eventUtils.getGroup();\n  if (!existingGroup) {\n    eventUtils.setGroup(true);\n  }\n\n  dom.startTextWidthCache();\n  if (workspace instanceof WorkspaceSvg) {\n    workspace.setResizesEnabled(false);\n  }\n\n  // We want to trigger clearing in reverse priority order so plugins don't end\n  // up missing dependencies.\n  for (const [, deserializer] of deserializers.reverse()) {\n    (deserializer as ISerializer)?.clear(workspace);\n  }\n\n  // reverse() is destructive, so we have to re-reverse to correct the order.\n  for (let [name, deserializer] of deserializers.reverse()) {\n    name = name;\n    const pluginState = state[name];\n    if (pluginState) {\n      (deserializer as ISerializer)?.load(state[name], workspace);\n    }\n  }\n\n  if (workspace instanceof WorkspaceSvg) {\n    workspace.setResizesEnabled(true);\n  }\n  dom.stopTextWidthCache();\n\n  eventUtils.fire(new (eventUtils.get(eventUtils.FINISHED_LOADING))(workspace));\n\n  eventUtils.setGroup(existingGroup);\n  eventUtils.setRecordUndo(prevRecordUndo);\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utilities for bumping objects back into worksapce bounds.\n *\n * @namespace Blockly.bumpObjects\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.bumpObjects');\n\nimport type {BlockSvg} from './block_svg.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BlockCreate} from './events/events_block_create.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport type {CommentCreate} from './events/events_comment_create.js';\nimport type {CommentMove} from './events/events_comment_move.js';\nimport type {ViewportChange} from './events/events_viewport.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport type {ContainerRegion} from './metrics_manager.js';\nimport * as mathUtils from './utils/math.js';\nimport type {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Bumps the given object that has passed out of bounds.\n *\n * @param workspace The workspace containing the object.\n * @param scrollMetrics Scroll metrics\n *    in workspace coordinates.\n * @param object The object to bump.\n * @returns True if block was bumped.\n * @alias Blockly.bumpObjects.bumpIntoBounds\n */\nfunction bumpObjectIntoBounds(\n    workspace: WorkspaceSvg, scrollMetrics: ContainerRegion,\n    object: IBoundedElement): boolean {\n  // Compute new top/left position for object.\n  const objectMetrics = object.getBoundingRectangle();\n  const height = objectMetrics.bottom - objectMetrics.top;\n  const width = objectMetrics.right - objectMetrics.left;\n\n  const topClamp = scrollMetrics.top;\n  const scrollMetricsBottom = scrollMetrics.top + scrollMetrics.height;\n  const bottomClamp = scrollMetricsBottom - height;\n  // If the object is taller than the workspace we want to\n  // top-align the block\n  const newYPosition =\n      mathUtils.clamp(topClamp, objectMetrics.top, bottomClamp);\n  const deltaY = newYPosition - objectMetrics.top;\n\n  // Note: Even in RTL mode the \"anchor\" of the object is the\n  // top-left corner of the object.\n  let leftClamp = scrollMetrics.left;\n  const scrollMetricsRight = scrollMetrics.left + scrollMetrics.width;\n  let rightClamp = scrollMetricsRight - width;\n  if (workspace.RTL) {\n    // If the object is wider than the workspace and we're in RTL\n    // mode we want to right-align the block, which means setting\n    // the left clamp to match.\n    leftClamp = Math.min(rightClamp, leftClamp);\n  } else {\n    // If the object is wider than the workspace and we're in LTR\n    // mode we want to left-align the block, which means setting\n    // the right clamp to match.\n    rightClamp = Math.max(leftClamp, rightClamp);\n  }\n  const newXPosition =\n      mathUtils.clamp(leftClamp, objectMetrics.left, rightClamp);\n  const deltaX = newXPosition - objectMetrics.left;\n\n  if (deltaX || deltaY) {\n    object.moveBy(deltaX, deltaY);\n    return true;\n  }\n  return false;\n}\nexport const bumpIntoBounds = bumpObjectIntoBounds;\n\n/**\n * Creates a handler for bumping objects when they cross fixed bounds.\n *\n * @param workspace The workspace to handle.\n * @returns The event handler.\n * @alias Blockly.bumpObjects.bumpIntoBoundsHandler\n */\nexport function bumpIntoBoundsHandler(workspace: WorkspaceSvg):\n    (p1: Abstract) => void {\n  return (e) => {\n    const metricsManager = workspace.getMetricsManager();\n    if (!metricsManager.hasFixedEdges() || workspace.isDragging()) {\n      return;\n    }\n\n    if (eventUtils.BUMP_EVENTS.indexOf(e.type ?? '') !== -1) {\n      const scrollMetricsInWsCoords = metricsManager.getScrollMetrics(true);\n\n      // Triggered by move/create event\n      const object =\n          extractObjectFromEvent(workspace, e as eventUtils.BumpEvent);\n      if (!object) {\n        return;\n      }\n      // Handle undo.\n      const oldGroup = eventUtils.getGroup();\n      eventUtils.setGroup(e.group);\n\n      const wasBumped = bumpObjectIntoBounds(\n          workspace, scrollMetricsInWsCoords, (object as IBoundedElement));\n\n      if (wasBumped && !e.group) {\n        console.warn(\n            'Moved object in bounds but there was no' +\n            ' event group. This may break undo.');\n      }\n      if (oldGroup !== null) {\n        eventUtils.setGroup(oldGroup);\n      }\n    } else if (e.type === eventUtils.VIEWPORT_CHANGE) {\n      const viewportEvent = (e as ViewportChange);\n      if (viewportEvent.scale && viewportEvent.oldScale &&\n          viewportEvent.scale > viewportEvent.oldScale) {\n        bumpTopObjectsIntoBounds(workspace);\n      }\n    }\n  };\n}\n\n/**\n * Extracts the object from the given event.\n *\n * @param workspace The workspace the event originated\n *    from.\n * @param e An event containing an object.\n * @returns The extracted\n *    object.\n */\nfunction extractObjectFromEvent(\n    workspace: WorkspaceSvg, e: eventUtils.BumpEvent): BlockSvg|null|\n    WorkspaceCommentSvg {\n  let object = null;\n  switch (e.type) {\n    case eventUtils.BLOCK_CREATE:\n    case eventUtils.BLOCK_MOVE:\n      object = workspace.getBlockById((e as BlockCreate | BlockMove).blockId);\n      if (object) {\n        object = object.getRootBlock();\n      }\n      break;\n    case eventUtils.COMMENT_CREATE:\n    case eventUtils.COMMENT_MOVE:\n      object = workspace.getCommentById(\n                   (e as CommentCreate | CommentMove).commentId) as\n              WorkspaceCommentSvg |\n          null;\n      break;\n  }\n  return object;\n}\n\n/**\n * Bumps the top objects in the given workspace into bounds.\n *\n * @param workspace The workspace.\n * @alias Blockly.bumpObjects.bumpTopObjectsIntoBounds\n */\nexport function bumpTopObjectsIntoBounds(workspace: WorkspaceSvg) {\n  const metricsManager = workspace.getMetricsManager();\n  if (!metricsManager.hasFixedEdges() || workspace.isDragging()) {\n    return;\n  }\n\n  const scrollMetricsInWsCoords = metricsManager.getScrollMetrics(true);\n  const topBlocks = workspace.getTopBoundedElements();\n  for (let i = 0, block; block = topBlocks[i]; i++) {\n    bumpObjectIntoBounds(workspace, scrollMetricsInWsCoords, block);\n  }\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Functions for injecting Blockly into a web page.\n *\n * @namespace Blockly.inject\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.inject');\n\nimport {BlockDragSurfaceSvg} from './block_drag_surface.js';\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as browserEvents from './browser_events.js';\nimport * as bumpObjects from './bump_objects.js';\nimport * as common from './common.js';\nimport * as Css from './css.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {Grid} from './grid.js';\nimport {Msg} from './msg.js';\nimport {Options} from './options.js';\nimport {ScrollbarPair} from './scrollbar_pair.js';\nimport {ShortcutRegistry} from './shortcut_registry.js';\nimport * as Tooltip from './tooltip.js';\nimport * as Touch from './touch.js';\nimport * as aria from './utils/aria.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport {WorkspaceDragSurfaceSvg} from './workspace_drag_surface_svg.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Inject a Blockly editor into the specified container element (usually a div).\n *\n * @param container Containing element, or its ID, or a CSS selector.\n * @param opt_options Optional dictionary of options.\n * @returns Newly created main workspace.\n * @alias Blockly.inject\n */\nexport function inject(\n    container: Element|string, opt_options?: BlocklyOptions): WorkspaceSvg {\n  if (typeof container === 'string') {\n    // AnyDuringMigration because:  Type 'Element | null' is not assignable to\n    // type 'string | Element'.\n    container = (document.getElementById(container) ||\n                 document.querySelector(container)) as AnyDuringMigration;\n  }\n  // Verify that the container is in document.\n  // AnyDuringMigration because:  Argument of type 'string | Element' is not\n  // assignable to parameter of type 'Node'.\n  if (!container ||\n      !dom.containsNode(document, container as AnyDuringMigration)) {\n    throw Error('Error: container is not in current document.');\n  }\n  const options = new Options(opt_options || {} as BlocklyOptions);\n  const subContainer = (document.createElement('div'));\n  subContainer.className = 'injectionDiv';\n  subContainer.tabIndex = 0;\n  aria.setState(subContainer, aria.State.LABEL, Msg['WORKSPACE_ARIA_LABEL']);\n\n  // AnyDuringMigration because:  Property 'appendChild' does not exist on type\n  // 'string | Element'.\n  (container as AnyDuringMigration).appendChild(subContainer);\n  const svg = createDom(subContainer, options);\n\n  // Create surfaces for dragging things. These are optimizations\n  // so that the browser does not repaint during the drag.\n  const blockDragSurface = new BlockDragSurfaceSvg(subContainer);\n\n  const workspaceDragSurface = new WorkspaceDragSurfaceSvg(subContainer);\n\n  const workspace =\n      createMainWorkspace(svg, options, blockDragSurface, workspaceDragSurface);\n\n  init(workspace);\n\n  // Keep focus on the first workspace so entering keyboard navigation looks\n  // correct.\n  // AnyDuringMigration because:  Argument of type 'WorkspaceSvg' is not\n  // assignable to parameter of type 'Workspace'.\n  common.setMainWorkspace(workspace as AnyDuringMigration);\n\n  common.svgResize(workspace);\n\n  subContainer.addEventListener('focusin', function() {\n    // AnyDuringMigration because:  Argument of type 'WorkspaceSvg' is not\n    // assignable to parameter of type 'Workspace'.\n    common.setMainWorkspace(workspace as AnyDuringMigration);\n  });\n\n  return workspace;\n}\n\n/**\n * Create the SVG image.\n *\n * @param container Containing element.\n * @param options Dictionary of options.\n * @returns Newly created SVG image.\n */\nfunction createDom(container: Element, options: Options): Element {\n  // Sadly browsers (Chrome vs Firefox) are currently inconsistent in laying\n  // out content in RTL mode.  Therefore Blockly forces the use of LTR,\n  // then manually positions content in RTL as needed.\n  container.setAttribute('dir', 'LTR');\n\n  // Load CSS.\n  Css.inject(options.hasCss, options.pathToMedia);\n\n  // Build the SVG DOM.\n  /*\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlns:html=\"http://www.w3.org/1999/xhtml\"\n      xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n      version=\"1.1\"\n      class=\"blocklySvg\">\n      ...\n    </svg>\n    */\n  const svg = dom.createSvgElement(\n      Svg.SVG, {\n        'xmlns': dom.SVG_NS,\n        'xmlns:html': dom.HTML_NS,\n        'xmlns:xlink': dom.XLINK_NS,\n        'version': '1.1',\n        'class': 'blocklySvg',\n        'tabindex': '0',\n      },\n      container);\n  /*\n    <defs>\n      ... filters go here ...\n    </defs>\n    */\n  const defs = dom.createSvgElement(Svg.DEFS, {}, svg);\n  // Each filter/pattern needs a unique ID for the case of multiple Blockly\n  // instances on a page.  Browser behaviour becomes undefined otherwise.\n  // https://neil.fraser.name/news/2015/11/01/\n  const rnd = String(Math.random()).substring(2);\n\n  options.gridPattern = Grid.createDom(rnd, options.gridOptions, defs);\n  return svg;\n}\n\n/**\n * Create a main workspace and add it to the SVG.\n *\n * @param svg SVG element with pattern defined.\n * @param options Dictionary of options.\n * @param blockDragSurface Drag surface SVG for the blocks.\n * @param workspaceDragSurface Drag surface SVG for the workspace.\n * @returns Newly created main workspace.\n */\nfunction createMainWorkspace(\n    svg: Element, options: Options, blockDragSurface: BlockDragSurfaceSvg,\n    workspaceDragSurface: WorkspaceDragSurfaceSvg): WorkspaceSvg {\n  options.parentWorkspace = null;\n  const mainWorkspace =\n      new WorkspaceSvg(options, blockDragSurface, workspaceDragSurface);\n  const wsOptions = mainWorkspace.options;\n  mainWorkspace.scale = wsOptions.zoomOptions.startScale;\n  svg.appendChild(mainWorkspace.createDom('blocklyMainBackground'));\n\n  // Set the theme name and renderer name onto the injection div.\n  dom.addClass(\n      mainWorkspace.getInjectionDiv(),\n      mainWorkspace.getRenderer().getClassName());\n  dom.addClass(\n      mainWorkspace.getInjectionDiv(), mainWorkspace.getTheme().getClassName());\n\n  if (!wsOptions.hasCategories && wsOptions.languageTree) {\n    // Add flyout as an <svg> that is a sibling of the workspace SVG.\n    const flyout = mainWorkspace.addFlyout(Svg.SVG);\n    dom.insertAfter(flyout, svg);\n  }\n  if (wsOptions.hasTrashcan) {\n    mainWorkspace.addTrashcan();\n  }\n  if (wsOptions.zoomOptions && wsOptions.zoomOptions.controls) {\n    mainWorkspace.addZoomControls();\n  }\n  // Register the workspace svg as a UI component.\n  mainWorkspace.getThemeManager().subscribe(\n      svg, 'workspaceBackgroundColour', 'background-color');\n\n  // A null translation will also apply the correct initial scale.\n  mainWorkspace.translate(0, 0);\n\n  mainWorkspace.addChangeListener(\n      bumpObjects.bumpIntoBoundsHandler(mainWorkspace));\n\n  // The SVG is now fully assembled.\n  common.svgResize(mainWorkspace);\n  WidgetDiv.createDom();\n  dropDownDiv.createDom();\n  Tooltip.createDom();\n  return mainWorkspace;\n}\n\n/**\n * Initialize Blockly with various handlers.\n *\n * @param mainWorkspace Newly created main workspace.\n */\nfunction init(mainWorkspace: WorkspaceSvg) {\n  const options = mainWorkspace.options;\n  const svg = mainWorkspace.getParentSvg();\n\n  // Suppress the browser's context menu.\n  browserEvents.conditionalBind(\n      svg.parentNode as Element, 'contextmenu', null,\n      function(e: AnyDuringMigration) {\n        if (!browserEvents.isTargetInput(e)) {\n          e.preventDefault();\n        }\n      });\n\n  const workspaceResizeHandler =\n      browserEvents.conditionalBind(window, 'resize', null, function() {\n        mainWorkspace.hideChaff(true);\n        common.svgResize(mainWorkspace);\n        bumpObjects.bumpTopObjectsIntoBounds(mainWorkspace);\n      });\n  mainWorkspace.setResizeHandlerWrapper(workspaceResizeHandler);\n\n  bindDocumentEvents();\n\n  if (options.languageTree) {\n    const toolbox = mainWorkspace.getToolbox();\n    const flyout = mainWorkspace.getFlyout(true);\n    if (toolbox) {\n      toolbox.init();\n    } else if (flyout) {\n      // Build a fixed flyout with the root blocks.\n      flyout.init(mainWorkspace);\n      flyout.show(options.languageTree);\n      if (typeof flyout.scrollToStart === 'function') {\n        flyout.scrollToStart();\n      }\n    }\n  }\n\n  if (options.hasTrashcan) {\n    mainWorkspace.trashcan!.init();\n  }\n  if (options.zoomOptions && options.zoomOptions.controls) {\n    mainWorkspace.zoomControls_!.init();\n  }\n\n  if (options.moveOptions && options.moveOptions.scrollbars) {\n    const horizontalScroll = options.moveOptions.scrollbars === true ||\n        !!options.moveOptions.scrollbars.horizontal;\n    const verticalScroll = options.moveOptions.scrollbars === true ||\n        !!options.moveOptions.scrollbars.vertical;\n    mainWorkspace.scrollbar = new ScrollbarPair(\n        mainWorkspace, horizontalScroll, verticalScroll,\n        'blocklyMainWorkspaceScrollbar');\n    mainWorkspace.scrollbar.resize();\n  } else {\n    mainWorkspace.setMetrics({x: 0.5, y: 0.5});\n  }\n\n  // Load the sounds.\n  if (options.hasSounds) {\n    loadSounds(options.pathToMedia, mainWorkspace);\n  }\n}\n\n/**\n * Handle a key-down on SVG drawing surface. Does nothing if the main workspace\n * is not visible.\n *\n * @param e Key down event.\n */\n// TODO (https://github.com/google/blockly/issues/1998) handle cases where there\n// are multiple workspaces and non-main workspaces are able to accept input.\nfunction onKeyDown(e: KeyboardEvent) {\n  const mainWorkspace = common.getMainWorkspace() as WorkspaceSvg;\n  if (!mainWorkspace) {\n    return;\n  }\n\n  if (browserEvents.isTargetInput(e) ||\n      mainWorkspace.rendered && !mainWorkspace.isVisible()) {\n    // When focused on an HTML text input widget, don't trap any keys.\n    // Ignore keypresses on rendered workspaces that have been explicitly\n    // hidden.\n    return;\n  }\n  ShortcutRegistry.registry.onKeyDown(mainWorkspace, e);\n}\n\n/**\n * Whether event handlers have been bound. Document event handlers will only\n * be bound once, even if Blockly is destroyed and reinjected.\n */\nlet documentEventsBound = false;\n\n/**\n * Bind document events, but only once.  Destroying and reinjecting Blockly\n * should not bind again.\n * Bind events for scrolling the workspace.\n * Most of these events should be bound to the SVG's surface.\n * However, 'mouseup' has to be on the whole document so that a block dragged\n * out of bounds and released will know that it has been released.\n * Also, 'keydown' has to be on the whole document since the browser doesn't\n * understand a concept of focus on the SVG image.\n */\nfunction bindDocumentEvents() {\n  if (!documentEventsBound) {\n    browserEvents.conditionalBind(document, 'scroll', null, function() {\n      const workspaces = common.getAllWorkspaces();\n      for (let i = 0, workspace; workspace = workspaces[i]; i++) {\n        if (workspace instanceof WorkspaceSvg) {\n          workspace.updateInverseScreenCTM();\n        }\n      }\n    });\n    browserEvents.conditionalBind(document, 'keydown', null, onKeyDown);\n    // longStop needs to run to stop the context menu from showing up.  It\n    // should run regardless of what other touch event handlers have run.\n    browserEvents.bind(document, 'touchend', null, Touch.longStop);\n    browserEvents.bind(document, 'touchcancel', null, Touch.longStop);\n    // Some iPad versions don't fire resize after portrait to landscape change.\n    if (userAgent.IPAD) {\n      browserEvents.conditionalBind(\n          window, 'orientationchange', document, function() {\n            // TODO (#397): Fix for multiple Blockly workspaces.\n            common.svgResize(common.getMainWorkspace() as WorkspaceSvg);\n          });\n    }\n  }\n  documentEventsBound = true;\n}\n\n/**\n * Load sounds for the given workspace.\n *\n * @param pathToMedia The path to the media directory.\n * @param workspace The workspace to load sounds for.\n */\nfunction loadSounds(pathToMedia: string, workspace: WorkspaceSvg) {\n  const audioMgr = workspace.getAudioManager();\n  audioMgr.load(\n      [\n        pathToMedia + 'click.mp3',\n        pathToMedia + 'click.wav',\n        pathToMedia + 'click.ogg',\n      ],\n      'click');\n  audioMgr.load(\n      [\n        pathToMedia + 'disconnect.wav',\n        pathToMedia + 'disconnect.mp3',\n        pathToMedia + 'disconnect.ogg',\n      ],\n      'disconnect');\n  audioMgr.load(\n      [\n        pathToMedia + 'delete.mp3',\n        pathToMedia + 'delete.ogg',\n        pathToMedia + 'delete.wav',\n      ],\n      'delete');\n\n  // Bind temporary hooks that preload the sounds.\n  const soundBinds: AnyDuringMigration[] = [];\n  /**\n   *\n   */\n  function unbindSounds() {\n    while (soundBinds.length) {\n      browserEvents.unbind(soundBinds.pop());\n    }\n    audioMgr.preload();\n  }\n\n  // These are bound on mouse/touch events with\n  // Blockly.browserEvents.conditionalBind, so they restrict the touch\n  // identifier that will be recognized.  But this is really something that\n  // happens on a click, not a drag, so that's not necessary.\n\n  // Android ignores any sound not loaded as a result of a user action.\n  soundBinds.push(browserEvents.conditionalBind(\n      document, 'mousemove', null, unbindSounds, true));\n  soundBinds.push(browserEvents.conditionalBind(\n      document, 'touchstart', null, unbindSounds, true));\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Registers default context menu items.\n *\n * @namespace Blockly.ContextMenuItems\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ContextMenuItems');\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as clipboard from './clipboard.js';\nimport {ContextMenuRegistry, RegistryItem, Scope} from './contextmenu_registry.js';\nimport * as dialog from './dialog.js';\nimport * as Events from './events/events.js';\nimport * as eventUtils from './events/utils.js';\nimport {inputTypes} from './input_types.js';\nimport {Msg} from './msg.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Option to undo previous action.\n *\n * @alias Blockly.ContextMenuItems.registerUndo\n */\nexport function registerUndo() {\n  const undoOption: RegistryItem = {\n    displayText() {\n      return Msg['UNDO'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.getUndoStack().length > 0) {\n        return 'enabled';\n      }\n      return 'disabled';\n    },\n    callback(scope: Scope) {\n      scope.workspace!.undo(false);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'undoWorkspace',\n    weight: 1,\n  };\n  ContextMenuRegistry.registry.register(undoOption);\n}\n\n/**\n * Option to redo previous action.\n *\n * @alias Blockly.ContextMenuItems.registerRedo\n */\nexport function registerRedo() {\n  const redoOption: RegistryItem = {\n    displayText() {\n      return Msg['REDO'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.getRedoStack().length > 0) {\n        return 'enabled';\n      }\n      return 'disabled';\n    },\n    callback(scope: Scope) {\n      scope.workspace!.undo(true);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'redoWorkspace',\n    weight: 2,\n  };\n  ContextMenuRegistry.registry.register(redoOption);\n}\n\n/**\n * Option to clean up blocks.\n *\n * @alias Blockly.ContextMenuItems.registerCleanup\n */\nexport function registerCleanup() {\n  const cleanOption: RegistryItem = {\n    displayText() {\n      return Msg['CLEAN_UP'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.isMovable()) {\n        if (scope.workspace!.getTopBlocks(false).length > 1) {\n          return 'enabled';\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.workspace!.cleanUp();\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'cleanWorkspace',\n    weight: 3,\n  };\n  ContextMenuRegistry.registry.register(cleanOption);\n}\n/**\n * Creates a callback to collapse or expand top blocks.\n *\n * @param shouldCollapse Whether a block should collapse.\n * @param topBlocks Top blocks in the workspace.\n */\nfunction toggleOption_(shouldCollapse: boolean, topBlocks: BlockSvg[]) {\n  const DELAY = 10;\n  let ms = 0;\n  let timeoutCounter = 0;\n  function timeoutFn(block: BlockSvg) {\n    timeoutCounter--;\n    block.setCollapsed(shouldCollapse);\n    if (timeoutCounter === 0) {\n      Events.setGroup(false);\n    }\n  }\n  Events.setGroup(true);\n  for (let i = 0; i < topBlocks.length; i++) {\n    let block: BlockSvg|null = topBlocks[i];\n    while (block) {\n      timeoutCounter++;\n      setTimeout(timeoutFn.bind(null, block), ms);\n      block = block.getNextBlock();\n      ms += DELAY;\n    }\n  }\n}\n\n/**\n * Option to collapse all blocks.\n *\n * @alias Blockly.ContextMenuItems.registerCollapse\n */\nexport function registerCollapse() {\n  const collapseOption: RegistryItem = {\n    displayText() {\n      return Msg['COLLAPSE_ALL'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.options.collapse) {\n        const topBlocks = scope.workspace!.getTopBlocks(false);\n        for (let i = 0; i < topBlocks.length; i++) {\n          let block: BlockSvg|null = topBlocks[i];\n          while (block) {\n            if (!block.isCollapsed()) {\n              return 'enabled';\n            }\n            block = block.getNextBlock();\n          }\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      toggleOption_(true, scope.workspace!.getTopBlocks(true));\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'collapseWorkspace',\n    weight: 4,\n  };\n  ContextMenuRegistry.registry.register(collapseOption);\n}\n\n/**\n * Option to expand all blocks.\n *\n * @alias Blockly.ContextMenuItems.registerExpand\n */\nexport function registerExpand() {\n  const expandOption: RegistryItem = {\n    displayText() {\n      return Msg['EXPAND_ALL'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.options.collapse) {\n        const topBlocks = scope.workspace!.getTopBlocks(false);\n        for (let i = 0; i < topBlocks.length; i++) {\n          let block: BlockSvg|null = topBlocks[i];\n          while (block) {\n            if (block.isCollapsed()) {\n              return 'enabled';\n            }\n            block = block.getNextBlock();\n          }\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      toggleOption_(false, scope.workspace!.getTopBlocks(true));\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'expandWorkspace',\n    weight: 5,\n  };\n  ContextMenuRegistry.registry.register(expandOption);\n}\n/**\n * Adds a block and its children to a list of deletable blocks.\n *\n * @param block to delete.\n * @param deleteList list of blocks that can be deleted.\n *     This will be modified in place with the given block and its descendants.\n */\nfunction addDeletableBlocks_(block: BlockSvg, deleteList: BlockSvg[]) {\n  if (block.isDeletable()) {\n    Array.prototype.push.apply(deleteList, block.getDescendants(false));\n  } else {\n    const children = block.getChildren(false);\n    for (let i = 0; i < children.length; i++) {\n      addDeletableBlocks_(children[i], deleteList);\n    }\n  }\n}\n\n/**\n * Constructs a list of blocks that can be deleted in the given workspace.\n *\n * @param workspace to delete all blocks from.\n * @returns list of blocks to delete.\n */\nfunction getDeletableBlocks_(workspace: WorkspaceSvg): BlockSvg[] {\n  const deleteList: BlockSvg[] = [];\n  const topBlocks = workspace.getTopBlocks(true);\n  for (let i = 0; i < topBlocks.length; i++) {\n    addDeletableBlocks_(topBlocks[i], deleteList);\n  }\n  return deleteList;\n}\n\n/**\n * Deletes the given blocks. Used to delete all blocks in the workspace.\n *\n * @param deleteList list of blocks to delete.\n * @param eventGroup event group ID with which all delete events should be\n *     associated.\n */\nfunction deleteNext_(deleteList: BlockSvg[], eventGroup: string) {\n  const DELAY = 10;\n  eventUtils.setGroup(eventGroup);\n  const block = deleteList.shift();\n  if (block) {\n    if (!block.disposed) {\n      block.dispose(false, true);\n      setTimeout(deleteNext_, DELAY, deleteList, eventGroup);\n    } else {\n      deleteNext_(deleteList, eventGroup);\n    }\n  }\n  eventUtils.setGroup(false);\n}\n\n/**\n * Option to delete all blocks.\n *\n * @alias Blockly.ContextMenuItems.registerDeleteAll\n */\nexport function registerDeleteAll() {\n  const deleteOption: RegistryItem = {\n    displayText(scope: Scope) {\n      if (!scope.workspace) {\n        return '';\n      }\n      const deletableBlocksLength = getDeletableBlocks_(scope.workspace).length;\n      if (deletableBlocksLength === 1) {\n        return Msg['DELETE_BLOCK'];\n      } else {\n        return Msg['DELETE_X_BLOCKS'].replace(\n            '%1', String(deletableBlocksLength));\n      }\n    },\n    preconditionFn(scope: Scope) {\n      if (!scope.workspace) {\n        return 'disabled';\n      }\n      const deletableBlocksLength = getDeletableBlocks_(scope.workspace).length;\n      return deletableBlocksLength > 0 ? 'enabled' : 'disabled';\n    },\n    callback(scope: Scope) {\n      if (!scope.workspace) {\n        return;\n      }\n      scope.workspace.cancelCurrentGesture();\n      const deletableBlocks = getDeletableBlocks_(scope.workspace);\n      const eventGroup = idGenerator.genUid();\n      if (deletableBlocks.length < 2) {\n        deleteNext_(deletableBlocks, eventGroup);\n      } else {\n        dialog.confirm(\n            Msg['DELETE_ALL_BLOCKS'].replace(\n                '%1', String(deletableBlocks.length)),\n            function(ok) {\n              if (ok) {\n                deleteNext_(deletableBlocks, eventGroup);\n              }\n            });\n      }\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'workspaceDelete',\n    weight: 6,\n  };\n  ContextMenuRegistry.registry.register(deleteOption);\n}\n/** Registers all workspace-scoped context menu items. */\nfunction registerWorkspaceOptions_() {\n  registerUndo();\n  registerRedo();\n  registerCleanup();\n  registerCollapse();\n  registerExpand();\n  registerDeleteAll();\n}\n\n/**\n * Option to duplicate a block.\n *\n * @alias Blockly.ContextMenuItems.registerDuplicate\n */\nexport function registerDuplicate() {\n  const duplicateOption: RegistryItem = {\n    displayText() {\n      return Msg['DUPLICATE_BLOCK'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (!block!.isInFlyout && block!.isDeletable() && block!.isMovable()) {\n        if (block!.isDuplicatable()) {\n          return 'enabled';\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      if (scope.block) {\n        clipboard.duplicate(scope.block);\n      }\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockDuplicate',\n    weight: 1,\n  };\n  ContextMenuRegistry.registry.register(duplicateOption);\n}\n\n/**\n * Option to add or remove block-level comment.\n *\n * @alias Blockly.ContextMenuItems.registerComment\n */\nexport function registerComment() {\n  const commentOption: RegistryItem = {\n    displayText(scope: Scope) {\n      if (scope.block!.getCommentIcon()) {\n        // If there's already a comment,  option is to remove.\n        return Msg['REMOVE_COMMENT'];\n      }\n      // If there's no comment yet, option is to add.\n      return Msg['ADD_COMMENT'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (!block!.isInFlyout && block!.workspace.options.comments &&\n          !block!.isCollapsed() && block!.isEditable()) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      const block = scope.block;\n      if (block!.getCommentIcon()) {\n        block!.setCommentText(null);\n      } else {\n        block!.setCommentText('');\n      }\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockComment',\n    weight: 2,\n  };\n  ContextMenuRegistry.registry.register(commentOption);\n}\n\n/**\n * Option to inline variables.\n *\n * @alias Blockly.ContextMenuItems.registerInline\n */\nexport function registerInline() {\n  const inlineOption: RegistryItem = {\n    displayText(scope: Scope) {\n      return scope.block!.getInputsInline() ? Msg['EXTERNAL_INPUTS'] :\n                                              Msg['INLINE_INPUTS'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (!block!.isInFlyout && block!.isMovable() && !block!.isCollapsed()) {\n        for (let i = 1; i < block!.inputList.length; i++) {\n          // Only display this option if there are two value or dummy inputs\n          // next to each other.\n          if (block!.inputList[i - 1].type !== inputTypes.STATEMENT &&\n              block!.inputList[i].type !== inputTypes.STATEMENT) {\n            return 'enabled';\n          }\n        }\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.block!.setInputsInline(!scope.block!.getInputsInline());\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockInline',\n    weight: 3,\n  };\n  ContextMenuRegistry.registry.register(inlineOption);\n}\n\n/**\n * Option to collapse or expand a block.\n *\n * @alias Blockly.ContextMenuItems.registerCollapseExpandBlock\n */\nexport function registerCollapseExpandBlock() {\n  const collapseExpandOption: RegistryItem = {\n    displayText(scope: Scope) {\n      return scope.block!.isCollapsed() ? Msg['EXPAND_BLOCK'] :\n                                          Msg['COLLAPSE_BLOCK'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (!block!.isInFlyout && block!.isMovable() &&\n          block!.workspace.options.collapse) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.block!.setCollapsed(!scope.block!.isCollapsed());\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockCollapseExpand',\n    weight: 4,\n  };\n  ContextMenuRegistry.registry.register(collapseExpandOption);\n}\n\n/**\n * Option to disable or enable a block.\n *\n * @alias Blockly.ContextMenuItems.registerDisable\n */\nexport function registerDisable() {\n  const disableOption: RegistryItem = {\n    displayText(scope: Scope) {\n      return scope.block!.isEnabled() ? Msg['DISABLE_BLOCK'] :\n                                        Msg['ENABLE_BLOCK'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (!block!.isInFlyout && block!.workspace.options.disable &&\n          block!.isEditable()) {\n        if (block!.getInheritedDisabled()) {\n          return 'disabled';\n        }\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      const block = scope.block;\n      const group = eventUtils.getGroup();\n      if (!group) {\n        eventUtils.setGroup(true);\n      }\n      block!.setEnabled(!block!.isEnabled());\n      if (!group) {\n        eventUtils.setGroup(false);\n      }\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockDisable',\n    weight: 5,\n  };\n  ContextMenuRegistry.registry.register(disableOption);\n}\n\n/**\n * Option to delete a block.\n *\n * @alias Blockly.ContextMenuItems.registerDelete\n */\nexport function registerDelete() {\n  const deleteOption: RegistryItem = {\n    displayText(scope: Scope) {\n      const block = scope.block;\n      // Count the number of blocks that are nested in this block.\n      let descendantCount = block!.getDescendants(false).length;\n      const nextBlock = block!.getNextBlock();\n      if (nextBlock) {\n        // Blocks in the current stack would survive this block's deletion.\n        descendantCount -= nextBlock.getDescendants(false).length;\n      }\n      return descendantCount === 1 ?\n          Msg['DELETE_BLOCK'] :\n          Msg['DELETE_X_BLOCKS'].replace('%1', String(descendantCount));\n    },\n    preconditionFn(scope: Scope) {\n      if (!scope.block!.isInFlyout && scope.block!.isDeletable()) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      if (scope.block) {\n        scope.block.checkAndDelete();\n      }\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockDelete',\n    weight: 6,\n  };\n  ContextMenuRegistry.registry.register(deleteOption);\n}\n\n/**\n * Option to open help for a block.\n *\n * @alias Blockly.ContextMenuItems.registerHelp\n */\nexport function registerHelp() {\n  const helpOption: RegistryItem = {\n    displayText() {\n      return Msg['HELP'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      const url = typeof block!.helpUrl === 'function' ? block!.helpUrl() :\n                                                         block!.helpUrl;\n      if (url) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.block!.showHelp();\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockHelp',\n    weight: 7,\n  };\n  ContextMenuRegistry.registry.register(helpOption);\n}\n\n/** Registers all block-scoped context menu items. */\nfunction registerBlockOptions_() {\n  registerDuplicate();\n  registerComment();\n  registerInline();\n  registerCollapseExpandBlock();\n  registerDisable();\n  registerDelete();\n  registerHelp();\n}\n\n/**\n * Registers all default context menu items. This should be called once per\n * instance of ContextMenuRegistry.\n *\n * @alias Blockly.ContextMenuItems.registerDefaultOptions\n * @internal\n */\nexport function registerDefaultOptions() {\n  registerWorkspaceOptions_();\n  registerBlockOptions_();\n}\n\nregisterDefaultOptions();\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for dragging a block visually.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.BlockDragger');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_drag.js';\n\nimport * as blockAnimation from './block_animations.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as bumpObjects from './bump_objects.js';\nimport * as common from './common.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Icon} from './icon.js';\nimport {InsertionMarkerManager} from './insertion_marker_manager.js';\nimport type {IBlockDragger} from './interfaces/i_block_dragger.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport * as registry from './registry.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Class for a block dragger.  It moves blocks around the workspace when they\n * are being dragged by a mouse or touch.\n *\n * @alias Blockly.BlockDragger\n */\nexport class BlockDragger implements IBlockDragger {\n  /** The top block in the stack that is being dragged. */\n  protected draggingBlock_: BlockSvg;\n  protected draggedConnectionManager_: InsertionMarkerManager;\n\n  /** The workspace on which the block is being dragged. */\n  protected workspace_: WorkspaceSvg;\n\n  /** Which drag area the mouse pointer is over, if any. */\n  private dragTarget_: IDragTarget|null = null;\n\n  /** Whether the block would be deleted if dropped immediately. */\n  protected wouldDeleteBlock_ = false;\n  protected startXY_: Coordinate;\n  protected dragIconData_: IconPositionData[];\n\n  /**\n   * @param block The block to drag.\n   * @param workspace The workspace to drag on.\n   */\n  constructor(block: BlockSvg, workspace: WorkspaceSvg) {\n    this.draggingBlock_ = block;\n\n    /** Object that keeps track of connections on dragged blocks. */\n    this.draggedConnectionManager_ =\n        new InsertionMarkerManager(this.draggingBlock_);\n\n    this.workspace_ = workspace;\n\n    /**\n     * The location of the top left corner of the dragging block at the\n     * beginning of the drag in workspace coordinates.\n     */\n    this.startXY_ = this.draggingBlock_.getRelativeToSurfaceXY();\n\n    /**\n     * A list of all of the icons (comment, warning, and mutator) that are\n     * on this block and its descendants.  Moving an icon moves the bubble that\n     * extends from it if that bubble is open.\n     */\n    this.dragIconData_ = initIconData(block);\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @internal\n   */\n  dispose() {\n    this.dragIconData_.length = 0;\n\n    if (this.draggedConnectionManager_) {\n      this.draggedConnectionManager_.dispose();\n    }\n  }\n\n  /**\n   * Start dragging a block.  This includes moving it to the drag surface.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   * @param healStack Whether or not to heal the stack after disconnecting.\n   */\n  startDrag(currentDragDeltaXY: Coordinate, healStack: boolean) {\n    if (!eventUtils.getGroup()) {\n      eventUtils.setGroup(true);\n    }\n    this.fireDragStartEvent_();\n\n    // Mutators don't have the same type of z-ordering as the normal workspace\n    // during a drag.  They have to rely on the order of the blocks in the SVG.\n    // For performance reasons that usually happens at the end of a drag,\n    // but do it at the beginning for mutators.\n    if (this.workspace_.isMutator) {\n      this.draggingBlock_.bringToFront();\n    }\n\n    // During a drag there may be a lot of rerenders, but not field changes.\n    // Turn the cache on so we don't do spurious remeasures during the drag.\n    dom.startTextWidthCache();\n    this.workspace_.setResizesEnabled(false);\n    blockAnimation.disconnectUiStop();\n\n    if (this.shouldDisconnect_(healStack)) {\n      this.disconnectBlock_(healStack, currentDragDeltaXY);\n    }\n    this.draggingBlock_.setDragging(true);\n    // For future consideration: we may be able to put moveToDragSurface inside\n    // the block dragger, which would also let the block not track the block\n    // drag surface.\n    this.draggingBlock_.moveToDragSurface();\n  }\n\n  /**\n   * Whether or not we should disconnect the block when a drag is started.\n   *\n   * @param healStack Whether or not to heal the stack after disconnecting.\n   * @returns True to disconnect the block, false otherwise.\n   */\n  protected shouldDisconnect_(healStack: boolean): boolean {\n    return !!(\n        this.draggingBlock_.getParent() ||\n        healStack && this.draggingBlock_.nextConnection &&\n            this.draggingBlock_.nextConnection.targetBlock());\n  }\n\n  /**\n   * Disconnects the block and moves it to a new location.\n   *\n   * @param healStack Whether or not to heal the stack after disconnecting.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   */\n  protected disconnectBlock_(\n      healStack: boolean, currentDragDeltaXY: Coordinate) {\n    this.draggingBlock_.unplug(healStack);\n    const delta = this.pixelsToWorkspaceUnits_(currentDragDeltaXY);\n    const newLoc = Coordinate.sum(this.startXY_, delta);\n\n    this.draggingBlock_.translate(newLoc.x, newLoc.y);\n    blockAnimation.disconnectUiEffect(this.draggingBlock_);\n    this.draggedConnectionManager_.updateAvailableConnections();\n  }\n\n  /** Fire a UI event at the start of a block drag. */\n  protected fireDragStartEvent_() {\n    const event = new (eventUtils.get(eventUtils.BLOCK_DRAG))(\n        this.draggingBlock_, true, this.draggingBlock_.getDescendants(false));\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Execute a step of block dragging, based on the given event.  Update the\n   * display accordingly.\n   *\n   * @param e The most recent move event.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   */\n  drag(e: Event, currentDragDeltaXY: Coordinate) {\n    const delta = this.pixelsToWorkspaceUnits_(currentDragDeltaXY);\n    const newLoc = Coordinate.sum(this.startXY_, delta);\n    this.draggingBlock_.moveDuringDrag(newLoc);\n    this.dragIcons_(delta);\n\n    const oldDragTarget = this.dragTarget_;\n    this.dragTarget_ = this.workspace_.getDragTarget(e);\n\n    this.draggedConnectionManager_.update(delta, this.dragTarget_);\n    const oldWouldDeleteBlock = this.wouldDeleteBlock_;\n    this.wouldDeleteBlock_ = this.draggedConnectionManager_.wouldDeleteBlock();\n    if (oldWouldDeleteBlock !== this.wouldDeleteBlock_) {\n      // Prevent unnecessary add/remove class calls.\n      this.updateCursorDuringBlockDrag_();\n    }\n\n    // Call drag enter/exit/over after wouldDeleteBlock is called in\n    // InsertionMarkerManager.update.\n    if (this.dragTarget_ !== oldDragTarget) {\n      oldDragTarget && oldDragTarget.onDragExit(this.draggingBlock_);\n      this.dragTarget_ && this.dragTarget_.onDragEnter(this.draggingBlock_);\n    }\n    this.dragTarget_ && this.dragTarget_.onDragOver(this.draggingBlock_);\n  }\n\n  /**\n   * Finish a block drag and put the block back on the workspace.\n   *\n   * @param e The mouseup/touchend event.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   */\n  endDrag(e: Event, currentDragDeltaXY: Coordinate) {\n    // Make sure internal state is fresh.\n    this.drag(e, currentDragDeltaXY);\n    this.dragIconData_ = [];\n    this.fireDragEndEvent_();\n\n    dom.stopTextWidthCache();\n\n    blockAnimation.disconnectUiStop();\n\n    const preventMove = !!this.dragTarget_ &&\n        this.dragTarget_.shouldPreventMove(this.draggingBlock_);\n    let newLoc: Coordinate;\n    let delta: Coordinate|null = null;\n    if (preventMove) {\n      newLoc = this.startXY_;\n    } else {\n      const newValues = this.getNewLocationAfterDrag_(currentDragDeltaXY);\n      delta = newValues.delta;\n      newLoc = newValues.newLocation;\n    }\n    this.draggingBlock_.moveOffDragSurface(newLoc);\n\n    if (this.dragTarget_) {\n      this.dragTarget_.onDrop(this.draggingBlock_);\n    }\n\n    const deleted = this.maybeDeleteBlock_();\n    if (!deleted) {\n      // These are expensive and don't need to be done if we're deleting.\n      this.draggingBlock_.setDragging(false);\n      if (delta) {  // !preventMove\n        this.updateBlockAfterMove_(delta);\n      } else {\n        // Blocks dragged directly from a flyout may need to be bumped into\n        // bounds.\n        bumpObjects.bumpIntoBounds(\n            this.draggingBlock_.workspace,\n            this.workspace_.getMetricsManager().getScrollMetrics(true),\n            this.draggingBlock_);\n      }\n    }\n    this.workspace_.setResizesEnabled(true);\n\n    eventUtils.setGroup(false);\n  }\n\n  /**\n   * Calculates the drag delta and new location values after a block is dragged.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the start of\n   *     the drag, in pixel units.\n   * @returns New location after drag. delta is in workspace units. newLocation\n   *     is the new coordinate where the block should end up.\n   */\n  protected getNewLocationAfterDrag_(currentDragDeltaXY: Coordinate):\n      {delta: Coordinate, newLocation: Coordinate} {\n    const delta = this.pixelsToWorkspaceUnits_(currentDragDeltaXY);\n    const newLocation = Coordinate.sum(this.startXY_, delta);\n    return {\n      delta,\n      newLocation,\n    };\n  }\n\n  /**\n   * May delete the dragging block, if allowed. If `this.wouldDeleteBlock_` is\n   * not true, the block will not be deleted. This should be called at the end\n   * of a block drag.\n   *\n   * @returns True if the block was deleted.\n   */\n  protected maybeDeleteBlock_(): boolean {\n    if (this.wouldDeleteBlock_) {\n      // Fire a move event, so we know where to go back to for an undo.\n      this.fireMoveEvent_();\n      this.draggingBlock_.dispose(false, true);\n      common.draggingConnections.length = 0;\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Updates the necessary information to place a block at a certain location.\n   *\n   * @param delta The change in location from where the block started the drag\n   *     to where it ended the drag.\n   */\n  protected updateBlockAfterMove_(delta: Coordinate) {\n    this.draggingBlock_.moveConnections(delta.x, delta.y);\n    this.fireMoveEvent_();\n    if (this.draggedConnectionManager_.wouldConnectBlock()) {\n      // Applying connections also rerenders the relevant blocks.\n      this.draggedConnectionManager_.applyConnections();\n    } else {\n      this.draggingBlock_.render();\n    }\n    this.draggingBlock_.scheduleSnapAndBump();\n  }\n\n  /** Fire a UI event at the end of a block drag. */\n  protected fireDragEndEvent_() {\n    const event = new (eventUtils.get(eventUtils.BLOCK_DRAG))(\n        this.draggingBlock_, false, this.draggingBlock_.getDescendants(false));\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Adds or removes the style of the cursor for the toolbox.\n   * This is what changes the cursor to display an x when a deletable block is\n   * held over the toolbox.\n   *\n   * @param isEnd True if we are at the end of a drag, false otherwise.\n   */\n  protected updateToolboxStyle_(isEnd: boolean) {\n    const toolbox = this.workspace_.getToolbox();\n\n    if (toolbox) {\n      const style = this.draggingBlock_.isDeletable() ? 'blocklyToolboxDelete' :\n                                                        'blocklyToolboxGrab';\n\n      // AnyDuringMigration because:  Property 'removeStyle' does not exist on\n      // type 'IToolbox'.\n      if (isEnd &&\n          typeof (toolbox as AnyDuringMigration).removeStyle === 'function') {\n        // AnyDuringMigration because:  Property 'removeStyle' does not exist on\n        // type 'IToolbox'.\n        (toolbox as AnyDuringMigration).removeStyle(style);\n        // AnyDuringMigration because:  Property 'addStyle' does not exist on\n        // type 'IToolbox'.\n      } else if (\n          !isEnd &&\n          typeof (toolbox as AnyDuringMigration).addStyle === 'function') {\n        // AnyDuringMigration because:  Property 'addStyle' does not exist on\n        // type 'IToolbox'.\n        (toolbox as AnyDuringMigration).addStyle(style);\n      }\n    }\n  }\n\n  /** Fire a move event at the end of a block drag. */\n  protected fireMoveEvent_() {\n    const event = new (eventUtils.get(eventUtils.BLOCK_MOVE))(\n                      this.draggingBlock_) as BlockMove;\n    event.oldCoordinate = this.startXY_;\n    event.recordNew();\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Update the cursor (and possibly the trash can lid) to reflect whether the\n   * dragging block would be deleted if released immediately.\n   */\n  protected updateCursorDuringBlockDrag_() {\n    this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_);\n  }\n\n  /**\n   * Convert a coordinate object from pixels to workspace units, including a\n   * correction for mutator workspaces.\n   * This function does not consider differing origins.  It simply scales the\n   * input's x and y values.\n   *\n   * @param pixelCoord A coordinate with x and y values in CSS pixel units.\n   * @returns The input coordinate divided by the workspace scale.\n   */\n  protected pixelsToWorkspaceUnits_(pixelCoord: Coordinate): Coordinate {\n    const result = new Coordinate(\n        pixelCoord.x / this.workspace_.scale,\n        pixelCoord.y / this.workspace_.scale);\n    if (this.workspace_.isMutator) {\n      // If we're in a mutator, its scale is always 1, purely because of some\n      // oddities in our rendering optimizations.  The actual scale is the same\n      // as the scale on the parent workspace. Fix that for dragging.\n      const mainScale = this.workspace_.options.parentWorkspace!.scale;\n      result.scale(1 / mainScale);\n    }\n    return result;\n  }\n\n  /**\n   * Move all of the icons connected to this drag.\n   *\n   * @param dxy How far to move the icons from their original positions, in\n   *     workspace units.\n   */\n  protected dragIcons_(dxy: Coordinate) {\n    // Moving icons moves their associated bubbles.\n    for (let i = 0; i < this.dragIconData_.length; i++) {\n      const data = this.dragIconData_[i];\n      data.icon.setIconLocation(Coordinate.sum(data.location, dxy));\n    }\n  }\n\n  /**\n   * Get a list of the insertion markers that currently exist.  Drags have 0, 1,\n   * or 2 insertion markers.\n   *\n   * @returns A possibly empty list of insertion marker blocks.\n   */\n  getInsertionMarkers(): BlockSvg[] {\n    // No insertion markers with the old style of dragged connection managers.\n    if (this.draggedConnectionManager_ &&\n        this.draggedConnectionManager_.getInsertionMarkers) {\n      return this.draggedConnectionManager_.getInsertionMarkers();\n    }\n    return [];\n  }\n}\n\n/** Data about the position of a given icon. */\nexport interface IconPositionData {\n  location: Coordinate;\n  icon: Icon;\n}\n\n/**\n * Make a list of all of the icons (comment, warning, and mutator) that are\n * on this block and its descendants.  Moving an icon moves the bubble that\n * extends from it if that bubble is open.\n *\n * @param block The root block that is being dragged.\n * @returns The list of all icons and their locations.\n */\nfunction initIconData(block: BlockSvg): IconPositionData[] {\n  // Build a list of icons that need to be moved and where they started.\n  const dragIconData = [];\n  const descendants = (block.getDescendants(false));\n\n  for (let i = 0, descendant; descendant = descendants[i]; i++) {\n    const icons = descendant.getIcons();\n    for (let j = 0; j < icons.length; j++) {\n      const data = {\n        // Coordinate with x and y properties (workspace\n        // coordinates).\n        location: icons[j].getIconLocation(),  // Blockly.Icon\n        icon: icons[j],\n      };\n      dragIconData.push(data);\n    }\n  }\n  // AnyDuringMigration because:  Type '{ location: Coordinate | null; icon:\n  // Icon; }[]' is not assignable to type 'IconPositionData[]'.\n  return dragIconData as AnyDuringMigration;\n}\n\nregistry.register(registry.Type.BLOCK_DRAGGER, registry.DEFAULT, BlockDragger);\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The top level namespace used to access the Blockly library.\n *\n * @namespace Blockly\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_create.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/workspace_events.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_ui.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_ui_base.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_create.js';\n\nimport {Block} from './block.js';\nimport * as blockAnimations from './block_animations.js';\nimport {BlockDragSurfaceSvg} from './block_drag_surface.js';\nimport {BlockDragger} from './block_dragger.js';\nimport {BlockSvg} from './block_svg.js';\nimport {BlocklyOptions} from './blockly_options.js';\nimport {Blocks} from './blocks.js';\nimport * as browserEvents from './browser_events.js';\nimport {Bubble} from './bubble.js';\nimport {BubbleDragger} from './bubble_dragger.js';\nimport * as bumpObjects from './bump_objects.js';\nimport * as clipboard from './clipboard.js';\nimport {Comment} from './comment.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {config} from './config.js';\nimport {Connection} from './connection.js';\nimport {ConnectionChecker} from './connection_checker.js';\nimport {ConnectionDB} from './connection_db.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as ContextMenu from './contextmenu.js';\nimport * as ContextMenuItems from './contextmenu_items.js';\nimport {ContextMenuRegistry} from './contextmenu_registry.js';\nimport * as Css from './css.js';\nimport {DeleteArea} from './delete_area.js';\nimport * as dialog from './dialog.js';\nimport {DragTarget} from './drag_target.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as Events from './events/events.js';\nimport * as Extensions from './extensions.js';\nimport {Field} from './field.js';\nimport {FieldAngle} from './field_angle.js';\nimport {FieldCheckbox} from './field_checkbox.js';\nimport {FieldColour} from './field_colour.js';\nimport {FieldDropdown} from './field_dropdown.js';\nimport {FieldImage} from './field_image.js';\nimport {FieldLabel} from './field_label.js';\nimport {FieldLabelSerializable} from './field_label_serializable.js';\nimport {FieldMultilineInput} from './field_multilineinput.js';\nimport {FieldNumber} from './field_number.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {FieldTextInput} from './field_textinput.js';\nimport {FieldVariable} from './field_variable.js';\nimport {Flyout} from './flyout_base.js';\nimport {FlyoutButton} from './flyout_button.js';\nimport {HorizontalFlyout} from './flyout_horizontal.js';\nimport {FlyoutMetricsManager} from './flyout_metrics_manager.js';\nimport {VerticalFlyout} from './flyout_vertical.js';\nimport {Generator} from './generator.js';\nimport {Gesture} from './gesture.js';\nimport {Grid} from './grid.js';\nimport {Icon} from './icon.js';\nimport {inject} from './inject.js';\nimport {Align, Input} from './input.js';\nimport {inputTypes} from './input_types.js';\nimport {InsertionMarkerManager} from './insertion_marker_manager.js';\nimport {IASTNodeLocation} from './interfaces/i_ast_node_location.js';\nimport {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport {IASTNodeLocationWithBlock} from './interfaces/i_ast_node_location_with_block.js';\nimport {IAutoHideable} from './interfaces/i_autohideable.js';\nimport {IBlockDragger} from './interfaces/i_block_dragger.js';\nimport {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport {IBubble} from './interfaces/i_bubble.js';\nimport {ICollapsibleToolboxItem} from './interfaces/i_collapsible_toolbox_item.js';\nimport {IComponent} from './interfaces/i_component.js';\nimport {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport {IContextMenu} from './interfaces/i_contextmenu.js';\nimport {ICopyable} from './interfaces/i_copyable.js';\nimport {IDeletable} from './interfaces/i_deletable.js';\nimport {IDeleteArea} from './interfaces/i_delete_area.js';\nimport {IDragTarget} from './interfaces/i_drag_target.js';\nimport {IDraggable} from './interfaces/i_draggable.js';\nimport {IFlyout} from './interfaces/i_flyout.js';\nimport {IKeyboardAccessible} from './interfaces/i_keyboard_accessible.js';\nimport {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport {IMovable} from './interfaces/i_movable.js';\nimport {IPositionable} from './interfaces/i_positionable.js';\nimport {IRegistrable} from './interfaces/i_registrable.js';\nimport {IRegistrableField} from './interfaces/i_registrable_field.js';\nimport {ISelectable} from './interfaces/i_selectable.js';\nimport {ISelectableToolboxItem} from './interfaces/i_selectable_toolbox_item.js';\nimport {ISerializer as SerializerInterface} from './interfaces/i_serializer.js';\nimport {IStyleable} from './interfaces/i_styleable.js';\nimport {IToolbox} from './interfaces/i_toolbox.js';\nimport {IToolboxItem} from './interfaces/i_toolbox_item.js';\nimport * as internalConstants from './internal_constants.js';\nimport {ASTNode} from './keyboard_nav/ast_node.js';\nimport {BasicCursor} from './keyboard_nav/basic_cursor.js';\nimport {Cursor} from './keyboard_nav/cursor.js';\nimport {Marker} from './keyboard_nav/marker.js';\nimport {TabNavigateCursor} from './keyboard_nav/tab_navigate_cursor.js';\nimport {MarkerManager} from './marker_manager.js';\nimport {Menu} from './menu.js';\nimport {MenuItem} from './menuitem.js';\nimport {MetricsManager} from './metrics_manager.js';\nimport {Msg} from './msg.js';\nimport {Mutator} from './mutator.js';\nimport {Names} from './names.js';\nimport {Options} from './options.js';\nimport * as uiPosition from './positionable_helpers.js';\nimport * as Procedures from './procedures.js';\nimport * as registry from './registry.js';\nimport {RenderedConnection} from './rendered_connection.js';\nimport * as blockRendering from './renderers/common/block_rendering.js';\nimport * as constants from './constants.js';\nimport * as geras from './renderers/geras/geras.js';\nimport * as minimalist from './renderers/minimalist/minimalist.js';\nimport * as thrasos from './renderers/thrasos/thrasos.js';\nimport * as zelos from './renderers/zelos/zelos.js';\nimport {Scrollbar} from './scrollbar.js';\nimport {ScrollbarPair} from './scrollbar_pair.js';\nimport * as serializationBlocks from './serialization/blocks.js';\nimport * as serializationExceptions from './serialization/exceptions.js';\nimport * as serializationPriorities from './serialization/priorities.js';\nimport * as serializationRegistry from './serialization/registry.js';\nimport * as serializationVariables from './serialization/variables.js';\nimport * as serializationWorkspaces from './serialization/workspaces.js';\nimport * as ShortcutItems from './shortcut_items.js';\nimport {ShortcutRegistry} from './shortcut_registry.js';\nimport {Theme} from './theme.js';\nimport * as Themes from './theme/themes.js';\nimport {ThemeManager} from './theme_manager.js';\nimport {ToolboxCategory} from './toolbox/category.js';\nimport {CollapsibleToolboxCategory} from './toolbox/collapsible_category.js';\nimport {ToolboxSeparator} from './toolbox/separator.js';\nimport {Toolbox} from './toolbox/toolbox.js';\nimport {ToolboxItem} from './toolbox/toolbox_item.js';\nimport * as Tooltip from './tooltip.js';\nimport * as Touch from './touch.js';\nimport {TouchGesture} from './touch_gesture.js';\nimport {Trashcan} from './trashcan.js';\nimport * as utils from './utils.js';\nimport * as colour from './utils/colour.js';\nimport * as deprecation from './utils/deprecation.js';\nimport * as svgMath from './utils/svg_math.js';\nimport * as toolbox from './utils/toolbox.js';\nimport {VariableMap} from './variable_map.js';\nimport {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport * as VariablesDynamic from './variables_dynamic.js';\nimport {Warning} from './warning.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport {Workspace} from './workspace.js';\nimport {WorkspaceAudio} from './workspace_audio.js';\nimport {WorkspaceComment} from './workspace_comment.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport {WorkspaceDragSurfaceSvg} from './workspace_drag_surface_svg.js';\nimport {WorkspaceDragger} from './workspace_dragger.js';\nimport {resizeSvgContents as realResizeSvgContents, WorkspaceSvg} from './workspace_svg.js';\nimport * as Xml from './xml.js';\nimport {ZoomControls} from './zoom_controls.js';\n\n\n/**\n * Blockly core version.\n * This constant is overridden by the build script (npm run build) to the value\n * of the version in package.json. This is done by the Closure Compiler in the\n * buildCompressed gulp task.\n * For local builds, you can pass --define='Blockly.VERSION=X.Y.Z' to the\n * compiler to override this constant.\n *\n * @define {string}\n * @alias Blockly.VERSION\n */\nexport const VERSION = 'uncompiled';\n\n/*\n * Top-level functions and properties on the Blockly namespace.\n * These are used only in external code. Do not reference these\n * from internal code as importing from this file can cause circular\n * dependencies. Do not add new functions here. There is probably a better\n * namespace to put new functions on.\n */\n\n/*\n * Aliases for input alignments used in block defintions.\n */\n\n/**\n * @see Blockly.Input.Align.LEFT\n * @alias Blockly.ALIGN_LEFT\n */\nexport const ALIGN_LEFT = Align.LEFT;\n\n/**\n * @see Blockly.Input.Align.CENTRE\n * @alias Blockly.ALIGN_CENTRE\n */\nexport const ALIGN_CENTRE = Align.CENTRE;\n\n/**\n * @see Blockly.Input.Align.RIGHT\n * @alias Blockly.ALIGN_RIGHT\n */\nexport const ALIGN_RIGHT = Align.RIGHT;\n/*\n * Aliases for constants used for connection and input types.\n */\n\n/**\n * @see ConnectionType.INPUT_VALUE\n * @alias Blockly.INPUT_VALUE\n */\nexport const INPUT_VALUE = ConnectionType.INPUT_VALUE;\n\n/**\n * @see ConnectionType.OUTPUT_VALUE\n * @alias Blockly.OUTPUT_VALUE\n */\nexport const OUTPUT_VALUE = ConnectionType.OUTPUT_VALUE;\n\n/**\n * @see ConnectionType.NEXT_STATEMENT\n * @alias Blockly.NEXT_STATEMENT\n */\nexport const NEXT_STATEMENT = ConnectionType.NEXT_STATEMENT;\n\n/**\n * @see ConnectionType.PREVIOUS_STATEMENT\n * @alias Blockly.PREVIOUS_STATEMENT\n */\nexport const PREVIOUS_STATEMENT = ConnectionType.PREVIOUS_STATEMENT;\n\n/**\n * @see inputTypes.DUMMY_INPUT\n * @alias Blockly.DUMMY_INPUT\n */\nexport const DUMMY_INPUT = inputTypes.DUMMY;\n\n/** Aliases for toolbox positions. */\n\n/**\n * @see toolbox.Position.TOP\n * @alias Blockly.TOOLBOX_AT_TOP\n */\nexport const TOOLBOX_AT_TOP = toolbox.Position.TOP;\n\n/**\n * @see toolbox.Position.BOTTOM\n * @alias Blockly.TOOLBOX_AT_BOTTOM\n */\nexport const TOOLBOX_AT_BOTTOM = toolbox.Position.BOTTOM;\n\n/**\n * @see toolbox.Position.LEFT\n * @alias Blockly.TOOLBOX_AT_LEFT\n */\nexport const TOOLBOX_AT_LEFT = toolbox.Position.LEFT;\n\n/**\n * @see toolbox.Position.RIGHT\n * @alias Blockly.TOOLBOX_AT_RIGHT\n */\nexport const TOOLBOX_AT_RIGHT = toolbox.Position.RIGHT;\n\n/*\n * Other aliased functions.\n */\n\n/**\n * Size the SVG image to completely fill its container. Call this when the view\n * actually changes sizes (e.g. on a window resize/device orientation change).\n * See workspace.resizeContents to resize the workspace when the contents\n * change (e.g. when a block is added or removed).\n * Record the height/width of the SVG image.\n *\n * @param workspace Any workspace in the SVG.\n * @see Blockly.common.svgResize\n * @alias Blockly.svgResize\n */\nexport const svgResize = common.svgResize;\n\n/**\n * Close tooltips, context menus, dropdown selections, etc.\n *\n * @param opt_onlyClosePopups Whether only popups should be closed.\n * @see Blockly.WorkspaceSvg.hideChaff\n * @alias Blockly.hideChaff\n */\nexport function hideChaff(opt_onlyClosePopups?: boolean) {\n  (common.getMainWorkspace() as WorkspaceSvg).hideChaff(opt_onlyClosePopups);\n}\n\n/**\n * Returns the main workspace.  Returns the last used main workspace (based on\n * focus).  Try not to use this function, particularly if there are multiple\n * Blockly instances on a page.\n *\n * @see Blockly.common.getMainWorkspace\n * @alias Blockly.getMainWorkspace\n */\nexport const getMainWorkspace = common.getMainWorkspace;\n\n/**\n * Returns the currently selected copyable object.\n *\n * @alias Blockly.common.getSelected\n */\nexport const getSelected = common.getSelected;\n\n/**\n * Define blocks from an array of JSON block definitions, as might be generated\n * by the Blockly Developer Tools.\n *\n * @param jsonArray An array of JSON block definitions.\n * @see Blockly.common.defineBlocksWithJsonArray\n * @alias Blockly.defineBlocksWithJsonArray\n */\nexport const defineBlocksWithJsonArray = common.defineBlocksWithJsonArray;\n\n/**\n * Set the parent container.  This is the container element that the WidgetDiv,\n * dropDownDiv, and Tooltip are rendered into the first time `Blockly.inject`\n * is called.\n * This method is a NOP if called after the first `Blockly.inject`.\n *\n * @param container The container element.\n * @see Blockly.common.setParentContainer\n * @alias Blockly.setParentContainer\n */\nexport const setParentContainer = common.setParentContainer;\n\n/**\n * Returns the dimensions of the specified SVG image.\n *\n * @param svg SVG image.\n * @returns Contains width and height properties.\n * @deprecated Use workspace.setCachedParentSvgSize. (2021 March 5)\n * @see Blockly.WorkspaceSvg.setCachedParentSvgSize\n * @alias Blockly.svgSize\n */\nexport const svgSize = svgMath.svgSize;\n\n/**\n * Size the workspace when the contents change.  This also updates\n * scrollbars accordingly.\n *\n * @param workspace The workspace to resize.\n * @deprecated Use workspace.resizeContents. (2021 December)\n * @see Blockly.WorkspaceSvg.resizeContents\n * @alias Blockly.resizeSvgContents\n */\nfunction resizeSvgContentsLocal(workspace: WorkspaceSvg) {\n  deprecation.warn(\n      'Blockly.resizeSvgContents', 'December 2021', 'December 2022',\n      'Blockly.WorkspaceSvg.resizeSvgContents');\n  realResizeSvgContents(workspace);\n}\nexport const resizeSvgContents = resizeSvgContentsLocal;\n\n/**\n * Copy a block or workspace comment onto the local clipboard.\n *\n * @param toCopy Block or Workspace Comment to be copied.\n * @deprecated Use Blockly.clipboard.copy(). (2021 December)\n * @see Blockly.clipboard.copy\n * @alias Blockly.copy\n */\nexport function copy(toCopy: ICopyable) {\n  deprecation.warn(\n      'Blockly.copy', 'December 2021', 'December 2022',\n      'Blockly.clipboard.copy');\n  clipboard.copy(toCopy);\n}\n\n/**\n * Paste a block or workspace comment on to the main workspace.\n *\n * @returns True if the paste was successful, false otherwise.\n * @deprecated Use Blockly.clipboard.paste(). (2021 December)\n * @see Blockly.clipboard.paste\n * @alias Blockly.paste\n */\nexport function paste(): boolean {\n  deprecation.warn(\n      'Blockly.paste', 'December 2021', 'December 2022',\n      'Blockly.clipboard.paste');\n  return !!clipboard.paste();\n}\n\n/**\n * Duplicate this block and its children, or a workspace comment.\n *\n * @param toDuplicate Block or Workspace Comment to be copied.\n * @deprecated Use Blockly.clipboard.duplicate(). (2021 December)\n * @see Blockly.clipboard.duplicate\n * @alias Blockly.duplicate\n */\nexport function duplicate(toDuplicate: ICopyable) {\n  deprecation.warn(\n      'Blockly.duplicate', 'December 2021', 'December 2022',\n      'Blockly.clipboard.duplicate');\n  clipboard.duplicate(toDuplicate);\n}\n\n/**\n * Is the given string a number (includes negative and decimals).\n *\n * @param str Input string.\n * @returns True if number, false otherwise.\n * @deprecated Use Blockly.utils.string.isNumber(str). (2021 December)\n * @see Blockly.utils.string.isNumber\n * @alias Blockly.isNumber\n */\nexport function isNumber(str: string): boolean {\n  deprecation.warn(\n      'Blockly.isNumber', 'December 2021', 'December 2022',\n      'Blockly.utils.string.isNumber');\n  return utils.string.isNumber(str);\n}\n\n/**\n * Convert a hue (HSV model) into an RGB hex triplet.\n *\n * @param hue Hue on a colour wheel (0-360).\n * @returns RGB code, e.g. '#5ba65b'.\n * @deprecated Use Blockly.utils.colour.hueToHex(). (2021 December)\n * @see Blockly.utils.colour.hueToHex\n * @alias Blockly.hueToHex\n */\nexport function hueToHex(hue: number): string {\n  deprecation.warn(\n      'Blockly.hueToHex', 'December 2021', 'December 2022',\n      'Blockly.utils.colour.hueToHex');\n  return colour.hueToHex(hue);\n}\n\n/**\n * Bind an event handler that should be called regardless of whether it is part\n * of the active touch stream.\n * Use this for events that are not part of a multi-part gesture (e.g.\n * mouseover for tooltips).\n *\n * @param node Node upon which to listen.\n * @param name Event name to listen to (e.g. 'mousedown').\n * @param thisObject The value of 'this' in the function.\n * @param func Function to call when event is triggered.\n * @returns Opaque data that can be passed to unbindEvent_.\n * @deprecated Use Blockly.browserEvents.bind(). (December 2021)\n * @see Blockly.browserEvents.bind\n * @alias Blockly.bindEvent_\n */\nexport function bindEvent_(\n    node: EventTarget, name: string, thisObject: Object|null,\n    func: Function): browserEvents.Data {\n  deprecation.warn(\n      'Blockly.bindEvent_', 'December 2021', 'December 2022',\n      'Blockly.browserEvents.bind');\n  return browserEvents.bind(node, name, thisObject, func);\n}\n\n/**\n * Unbind one or more events event from a function call.\n *\n * @param bindData Opaque data from bindEvent_.\n *     This list is emptied during the course of calling this function.\n * @returns The function call.\n * @deprecated Use Blockly.browserEvents.unbind(). (December 2021)\n * @see browserEvents.unbind\n * @alias Blockly.unbindEvent_\n */\nexport function unbindEvent_(bindData: browserEvents.Data): Function {\n  deprecation.warn(\n      'Blockly.unbindEvent_', 'December 2021', 'December 2022',\n      'Blockly.browserEvents.unbind');\n  return browserEvents.unbind(bindData);\n}\n\n/**\n * Bind an event handler that can be ignored if it is not part of the active\n * touch stream.\n * Use this for events that either start or continue a multi-part gesture (e.g.\n * mousedown or mousemove, which may be part of a drag or click).\n *\n * @param node Node upon which to listen.\n * @param name Event name to listen to (e.g. 'mousedown').\n * @param thisObject The value of 'this' in the function.\n * @param func Function to call when event is triggered.\n * @param opt_noCaptureIdentifier True if triggering on this event should not\n *     block execution of other event handlers on this touch or other\n *     simultaneous touches.  False by default.\n * @param opt_noPreventDefault True if triggering on this event should prevent\n *     the default handler.  False by default.  If opt_noPreventDefault is\n *     provided, opt_noCaptureIdentifier must also be provided.\n * @returns Opaque data that can be passed to unbindEvent_.\n * @deprecated Use Blockly.browserEvents.conditionalBind(). (December 2021)\n * @see browserEvents.conditionalBind\n * @alias Blockly.bindEventWithChecks_\n */\nexport function bindEventWithChecks_(\n    node: EventTarget, name: string, thisObject: Object|null, func: Function,\n    opt_noCaptureIdentifier?: boolean,\n    opt_noPreventDefault?: boolean): browserEvents.Data {\n  deprecation.warn(\n      'Blockly.bindEventWithChecks_', 'December 2021', 'December 2022',\n      'Blockly.browserEvents.conditionalBind');\n  return browserEvents.conditionalBind(\n      node, name, thisObject, func, opt_noCaptureIdentifier,\n      opt_noPreventDefault);\n}\n\n// Aliases to allow external code to access these values for legacy reasons.\nexport const COLLAPSE_CHARS = internalConstants.COLLAPSE_CHARS;\nexport const DRAG_STACK = internalConstants.DRAG_STACK;\nexport const OPPOSITE_TYPE = internalConstants.OPPOSITE_TYPE;\nexport const RENAME_VARIABLE_ID = internalConstants.RENAME_VARIABLE_ID;\nexport const DELETE_VARIABLE_ID = internalConstants.DELETE_VARIABLE_ID;\nexport const COLLAPSED_INPUT_NAME = constants.COLLAPSED_INPUT_NAME;\nexport const COLLAPSED_FIELD_NAME = constants.COLLAPSED_FIELD_NAME;\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n *\n * @alias Blockly.VARIABLE_CATEGORY_NAME\n */\nexport const VARIABLE_CATEGORY_NAME: string = Variables.CATEGORY_NAME;\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n *\n * @alias Blockly.VARIABLE_DYNAMIC_CATEGORY_NAME\n */\nexport const VARIABLE_DYNAMIC_CATEGORY_NAME: string =\n    VariablesDynamic.CATEGORY_NAME;\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * procedure blocks.\n *\n * @alias Blockly.PROCEDURE_CATEGORY_NAME\n */\nexport const PROCEDURE_CATEGORY_NAME: string = Procedures.CATEGORY_NAME;\n\n// Context for why we need to monkey-patch in these functions (internal):\n//   https://docs.google.com/document/d/1MbO0LEA-pAyx1ErGLJnyUqTLrcYTo-5zga9qplnxeXo/edit?usp=sharing&resourcekey=0-5h_32-i-dHwHjf_9KYEVKg\n\n// clang-format off\nWorkspace.prototype.newBlock =\n    function(prototypeName: string, opt_id?: string): Block {\n      return new Block(this, prototypeName, opt_id);\n    };\n\nWorkspaceSvg.prototype.newBlock =\n    function(prototypeName: string, opt_id?: string): BlockSvg {\n      return new BlockSvg(this, prototypeName, opt_id);\n    };\n\nWorkspaceSvg.newTrashcan = function(workspace: WorkspaceSvg): Trashcan {\n  return new Trashcan(workspace);\n};\n\nWorkspaceCommentSvg.prototype.showContextMenu =\n    function(this: WorkspaceCommentSvg, e: Event) {\n      if (this.workspace.options.readOnly) {\n        return;\n      }\n      const menuOptions = [];\n    \n      if (this.isDeletable() && this.isMovable()) {\n        menuOptions.push(ContextMenu.commentDuplicateOption(this));\n        menuOptions.push(ContextMenu.commentDeleteOption(this));\n      }\n    \n      ContextMenu.show(e, menuOptions, this.RTL);\n    };\n\nMutator.prototype.newWorkspaceSvg =\n    function(options: Options): WorkspaceSvg {\n      return new WorkspaceSvg(options);\n    };\n\nNames.prototype.populateProcedures =\n    function(this: Names, workspace: Workspace) {\n      const procedures = Procedures.allProcedures(workspace);\n      // Flatten the return vs no-return procedure lists.\n      const flattenedProcedures: AnyDuringMigration[][] =\n          procedures[0].concat(procedures[1]);\n      for (let i = 0; i < flattenedProcedures.length; i++) {\n        this.getName(flattenedProcedures[i][0], Names.NameType.PROCEDURE);\n      }\n    };\n// clang-format on\n\n\n// Re-export submodules that no longer declareLegacyNamespace.\nexport {browserEvents};\nexport {ContextMenu};\nexport {ContextMenuItems};\nexport {Css};\nexport {Events};\nexport {Extensions};\nexport {Procedures};\nexport {ShortcutItems};\nexport {Themes};\nexport {Tooltip};\nexport {Touch};\nexport {Variables};\nexport {VariablesDynamic};\nexport {WidgetDiv};\nexport {Xml};\nexport {blockAnimations};\nexport {blockRendering};\nexport {bumpObjects};\nexport {clipboard};\nexport {common};\nexport {constants};\nexport {dialog};\nexport {fieldRegistry};\nexport {geras};\nexport {minimalist};\nexport {registry};\nexport {thrasos};\nexport {uiPosition};\nexport {utils};\nexport {zelos};\nexport {ASTNode};\nexport {BasicCursor};\nexport {Block};\nexport {BlocklyOptions};\nexport {BlockDragger};\nexport {BlockDragSurfaceSvg};\nexport {BlockSvg};\nexport {Blocks};\nexport {Bubble};\nexport {BubbleDragger};\nexport {CollapsibleToolboxCategory};\nexport {Comment};\nexport {ComponentManager};\nexport {Connection};\nexport {ConnectionType};\nexport {ConnectionChecker};\nexport {ConnectionDB};\nexport {ContextMenuRegistry};\nexport {Cursor};\nexport {DeleteArea};\nexport {DragTarget};\nexport const DropDownDiv = dropDownDiv;\nexport {Field};\nexport {FieldAngle};\nexport {FieldCheckbox};\nexport {FieldColour};\nexport {FieldDropdown};\nexport {FieldImage};\nexport {FieldLabel};\nexport {FieldLabelSerializable};\nexport {FieldMultilineInput};\nexport {FieldNumber};\nexport {FieldTextInput};\nexport {FieldVariable};\nexport {Flyout};\nexport {FlyoutButton};\nexport {FlyoutMetricsManager};\nexport {Generator};\nexport {Gesture};\nexport {Grid};\nexport {HorizontalFlyout};\nexport {IASTNodeLocation};\nexport {IASTNodeLocationSvg};\nexport {IASTNodeLocationWithBlock};\nexport {IAutoHideable};\nexport {IBlockDragger};\nexport {IBoundedElement};\nexport {IBubble};\nexport {ICollapsibleToolboxItem};\nexport {IComponent};\nexport {IConnectionChecker};\nexport {IContextMenu};\nexport {Icon};\nexport {ICopyable};\nexport {IDeletable};\nexport {IDeleteArea};\nexport {IDragTarget};\nexport {IDraggable};\nexport {IFlyout};\nexport {IKeyboardAccessible};\nexport {IMetricsManager};\nexport {IMovable};\nexport {Input};\nexport {InsertionMarkerManager};\nexport {IPositionable};\nexport {IRegistrable};\nexport {IRegistrableField};\nexport {ISelectable};\nexport {ISelectableToolboxItem};\nexport {IStyleable};\nexport {IToolbox};\nexport {IToolboxItem};\nexport {Marker};\nexport {MarkerManager};\nexport {Menu};\nexport {MenuItem};\nexport {MetricsManager};\nexport {Mutator};\nexport {Msg};\nexport {Names};\nexport {Options};\nexport {RenderedConnection};\nexport {Scrollbar};\nexport {ScrollbarPair};\nexport {ShortcutRegistry};\nexport {TabNavigateCursor};\nexport {Theme};\nexport {ThemeManager};\nexport {Toolbox};\nexport {ToolboxCategory};\nexport {ToolboxItem};\nexport {ToolboxSeparator};\nexport {TouchGesture};\nexport {Trashcan};\nexport {VariableMap};\nexport {VariableModel};\nexport {VerticalFlyout};\nexport {Warning};\nexport {Workspace};\nexport {WorkspaceAudio};\nexport {WorkspaceComment};\nexport {WorkspaceCommentSvg};\nexport {WorkspaceDragSurfaceSvg};\nexport {WorkspaceDragger};\nexport {WorkspaceSvg};\nexport {ZoomControls};\nexport {config};\n/** @deprecated Use Blockly.ConnectionType instead. */\nexport const connectionTypes = ConnectionType;\nexport {inject};\nexport {inputTypes};\nexport namespace serialization {\n  export const blocks = serializationBlocks;\n  export const exceptions = serializationExceptions;\n  export const priorities = serializationPriorities;\n  export const registry = serializationRegistry;\n  export const variables = serializationVariables;\n  export const workspaces = serializationWorkspaces;\n  export type ISerializer = SerializerInterface;\n}\n",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"// Copyright 2018 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview ES6 module that exports symbols from base.js so that ES6\n * modules do not need to use globals and so that is clear if a project is using\n * Closure's base.js file. It is also a subset of properties in base.js, meaning\n * it should be clearer what should not be used in ES6 modules\n * (goog.module/provide are not exported here, for example). Though that is not\n * to say that everything in this file should be used in an ES6 module; some\n * depreciated functions are exported to make migration easier (e.g.\n * goog.scope).\n *\n * Note that this does not load Closure's base.js file, it is still up to the\n * programmer to include it. Nor does the fact that this is an ES6 module mean\n * that projects no longer require deps.js files for debug loading - they do.\n * Closure will need to load your ES6 modules for you if you have any Closure\n * file (goog.provide/goog.module) dependencies, as they need to be available\n * before the ES6 module evaluates.\n *\n * Also note that this file has special compiler handling! It is okay to export\n * anything from this file, but the name also needs to exist on the global goog.\n * This special compiler pass enforces that you always import this file as\n * `import * as goog`, as many tools use regex based parsing to find\n * goog.require calls.\n */\n\nexport const global = globalThis;\n// export const require = goog.require;\n// export const define = goog.define;\n// export const DEBUG = goog.DEBUG;\n// export const LOCALE = goog.LOCALE;\n// export const TRUSTED_SITE = goog.TRUSTED_SITE;\n// export const DISALLOW_TEST_ONLY_CODE = goog.DISALLOW_TEST_ONLY_CODE;\n// export const getGoogModule = goog.module.get;\n// export const setTestOnly = goog.setTestOnly;\n// export const forwardDeclare = goog.forwardDeclare;\n// export const getObjectByName = goog.getObjectByName;\n// export const basePath = goog.basePath;\n// export const addSingletonGetter = goog.addSingletonGetter;\n// export const typeOf = goog.typeOf;\n// export const isArrayLike = goog.isArrayLike;\n// export const isDateLike = goog.isDateLike;\n// export const isObject = goog.isObject;\n// export const getUid = goog.getUid;\n// export const hasUid = goog.hasUid;\n// export const removeUid = goog.removeUid;\n// export const now = Date.now;\n// export const globalEval = goog.globalEval;\n// export const getCssName = goog.getCssName;\n// export const setCssNameMapping = goog.setCssNameMapping;\n// export const getMsg = goog.getMsg;\n// export const getMsgWithFallback = goog.getMsgWithFallback;\n// export const exportSymbol = goog.exportSymbol;\n// export const exportProperty = goog.exportProperty;\n// export const abstractMethod = goog.abstractMethod;\n// export const cloneObject = goog.cloneObject;\n// export const bind = goog.bind;\n// export const partial = goog.partial;\n// export const inherits = goog.inherits;\n// export const scope = goog.scope;\n// export const defineClass = goog.defineClass;\nexport const declareModuleId = function(namespace) {\n  if (window.goog && window.goog.declareModuleId) {\n    window.goog.declareModuleId.call(this, namespace);\n  }\n};\n\n\n// Export select properties of module. Do not export the function itself or\n// goog.module.declareLegacyNamespace.\n// export const module = {\n//   get: goog.module.get,\n// };\n\n// Omissions include:\n// goog.ENABLE_DEBUG_LOADER - define only used in base.\n// goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING - define only used in base.\n// goog.provide - ES6 modules do not provide anything.\n// goog.module - ES6 modules cannot be goog.modules.\n// goog.module.declareLegacyNamespace - ES6 modules cannot declare namespaces.\n// goog.addDependency - meant to only be used by dependency files.\n// goog.DEPENDENCIES_ENABLED - constant only used in base.\n// goog.TRANSPILE - define only used in base.\n// goog.TRANSPILER - define only used in base.\n// goog.loadModule - should not be called by any ES6 module; exists for\n//   generated bundles.\n// goog.LOAD_MODULE_USING_EVAL - define only used in base.\n// goog.SEAL_MODULE_EXPORTS - define only used in base.\n// goog.DebugLoader - used rarely, only outside of compiled code.\n// goog.Transpiler - used rarely, only outside of compiled code.\n","/**\n * @license\n * Copyright The Closure Library Authors.\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview A minimal implementation of base.js.\n *\n * This file is used in place of base.js (Closure library bootstrap\n * code) when building Blockly using the Closure Compiler.  Refer to\n * base.js for more information about items defined here.\n *\n * @provideGoog\n */\n\n/** @define {boolean} Overridden to true by the compiler. */\nvar COMPILED = false;\n\n/** @const */\nvar goog = goog || {};\n\n/**\n * Reference to the global object.  This is provided as 'root' by the\n * UMD wrapper, but prefer globalThis if it is defined.\n * \n * https://www.ecma-international.org/ecma-262/9.0/index.html#sec-global-object\n *\n * @const\n * @type {!Global}\n * @suppress {undefinedVars}\n */\ngoog.global = globalThis || root;\n\n/** @type {Object<string, (string|number|boolean)>|undefined} */\ngoog.global.CLOSURE_DEFINES;\n\n/**\n * Defines a named value.\n * When compiled the default can be overridden using the compiler options or the\n * value set in the CLOSURE_DEFINES object. Returns the defined value so that it\n * can be used safely in modules. Note that the value type MUST be either\n * boolean, number, or string.\n *\n * @param {string} name\n * @param {T} defaultValue\n * @return {T}\n * @template T\n */\ngoog.define = function(name, defaultValue) {\n  return defaultValue;\n};\n\n/** @define {boolean} */\ngoog.DEBUG = goog.define('goog.DEBUG', false);\n\n/** @define {boolean} */\ngoog.DISALLOW_TEST_ONLY_CODE =\n    goog.define('goog.DISALLOW_TEST_ONLY_CODE', COMPILED && !goog.DEBUG);\n\n/**\n * @param {string} name\n */\ngoog.provide = function(name) {};\n\n/**\n * @param {string} name\n * @return {void}\n */\ngoog.module = function(name) {};\n\n/**\n * @param {string} name\n * @return {?}\n * @suppress {missingProvide}\n */\ngoog.module.get = function(name) {};\n\n/** @suppress {missingProvide} */\ngoog.module.declareLegacyNamespace = function() {};\n\n/**\n * Marks that the current file should only be used for testing, and never for\n * live code in production.\n *\n * In the case of unit tests, the message may optionally be an exact namespace\n * for the test (e.g. 'goog.stringTest'). The linter will then ignore the extra\n * provide (if not explicitly defined in the code).\n *\n * @param {string=} opt_message Optional message to add to the error that's\n *     raised when used in production code.\n */\ngoog.setTestOnly = function(opt_message) {\n  if (goog.DISALLOW_TEST_ONLY_CODE) {\n    opt_message = opt_message || '';\n    throw new Error(\n        'Importing test-only code into non-debug environment' +\n        (opt_message ? ': ' + opt_message : '.'));\n  }\n};\n\n/**\n * @param {string} namespace\n * @return {?}\n */\ngoog.require = function(namespace) {};\n\n/**\n * @param {string} namespace\n * @return {?}\n */\ngoog.requireType = function(namespace) {};\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A mapping of block type names to block prototype objects.\n *\n * @namespace Blockly.blocks\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blocks');\n\n\n/**\n * A block definition.  For now this very lose, but it can potentially\n * be refined e.g. by replacing this typedef with a class definition.\n */\nexport type BlockDefinition = AnyDuringMigration;\n\n/**\n * A mapping of block type names to block prototype objects.\n *\n * @alias Blockly.blocks.Blocks\n */\nexport const Blocks: {[key: string]: BlockDefinition} = Object.create(null);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Abstract class for events fired as a result of actions in\n * Blockly's editor.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.Abstract');\n\nimport * as common from '../common.js';\nimport type {Workspace} from '../workspace.js';\n\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Abstract class for an event.\n *\n * @alias Blockly.Events.Abstract\n */\nexport abstract class Abstract {\n  /** Whether or not the event is blank (to be populated by fromJson). */\n  isBlank: boolean|null = null;\n\n  /** The workspace identifier for this event. */\n  workspaceId?: string = undefined;\n  group: string;\n  recordUndo: boolean;\n\n  /** Whether or not the event is a UI event. */\n  isUiEvent = false;\n\n  /** Type of this event. */\n  type?: string = undefined;\n\n  /** @alias Blockly.Events.Abstract */\n  constructor() {\n    /**\n     * The event group id for the group this event belongs to. Groups define\n     * events that should be treated as an single action from the user's\n     * perspective, and should be undone together.\n     */\n    this.group = eventUtils.getGroup();\n\n    /** Sets whether the event should be added to the undo stack. */\n    this.recordUndo = eventUtils.getRecordUndo();\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  toJson(): AnyDuringMigration {\n    const json = {'type': this.type};\n    if (this.group) {\n      (json as AnyDuringMigration)['group'] = this.group;\n    }\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  fromJson(json: AnyDuringMigration) {\n    this.isBlank = false;\n    this.group = json['group'];\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns True if null, false if something changed.\n   */\n  isNull(): boolean {\n    return false;\n  }\n\n  /**\n   * Run an event.\n   *\n   * @param _forward True if run forward, false if run backward (undo).\n   */\n  run(_forward: boolean) {}\n  // Defined by subclasses.\n\n  /**\n   * Get workspace the event belongs to.\n   *\n   * @returns The workspace the event belongs to.\n   * @throws {Error} if workspace is null.\n   * @internal\n   */\n  getEventWorkspace_(): Workspace {\n    let workspace;\n    if (this.workspaceId) {\n      workspace = common.getWorkspaceById(this.workspaceId);\n    }\n    if (!workspace) {\n      throw Error(\n          'Workspace is null. Event must have been generated from real' +\n          ' Blockly events.');\n    }\n    return workspace;\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Base class for events fired as a result of UI actions in\n * Blockly's editor.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.UiBase');\n\nimport {Abstract as AbstractEvent} from './events_abstract.js';\n\n\n/**\n * Base class for a UI event.\n * UI events are events that don't need to be sent over the wire for multi-user\n * editing to work (e.g. scrolling the workspace, zooming, opening toolbox\n * categories).\n * UI events do not undo or redo.\n *\n * @alias Blockly.Events.UiBase\n */\nexport class UiBase extends AbstractEvent {\n  override isBlank: boolean;\n  override workspaceId: string;\n\n  // UI events do not undo or redo.\n  override recordUndo = false;\n\n  /** Whether or not the event is a UI event. */\n  override isUiEvent = true;\n\n  /**\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   */\n  constructor(opt_workspaceId?: string) {\n    super();\n\n    /** Whether or not the event is blank (to be populated by fromJson). */\n    this.isBlank = typeof opt_workspaceId === 'undefined';\n\n    /** The workspace identifier for this event. */\n    this.workspaceId = opt_workspaceId ? opt_workspaceId : '';\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of trashcan flyout open and close.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.TrashcanOpen');\n\nimport * as registry from '../registry.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a trashcan open event.\n *\n * @alias Blockly.Events.TrashcanOpen\n */\nexport class TrashcanOpen extends UiBase {\n  isOpen?: boolean;\n  override type: string;\n\n  /**\n   * @param opt_isOpen Whether the trashcan flyout is opening (false if\n   *     opening). Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   */\n  constructor(opt_isOpen?: boolean, opt_workspaceId?: string) {\n    super(opt_workspaceId);\n\n    /** Whether the trashcan flyout is opening (false if closing). */\n    this.isOpen = opt_isOpen;\n\n    /** Type of this event. */\n    this.type = eventUtils.TRASHCAN_OPEN;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['isOpen'] = this.isOpen;\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.isOpen = json['isOpen'];\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.TRASHCAN_OPEN, TrashcanOpen);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Useragent detection.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @namespace Blockly.utils.userAgent\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.userAgent');\n\n\n/** The raw useragent string. */\nlet rawUserAgent: string;\n\nlet isJavaFx: boolean;\n\nlet isWebKit: boolean;\n\nlet isGecko: boolean;\n\nlet isAndroid: boolean;\n\nlet isIPad: boolean;\n\nlet isIPhone: boolean;\n\nlet isMac: boolean;\n\nlet isTablet: boolean;\n\nlet isMobile: boolean;\n\n(function(raw) {\nrawUserAgent = raw;\nconst rawUpper = rawUserAgent.toUpperCase();\n/**\n * Case-insensitive test of whether name is in the useragent string.\n *\n * @param name Name to test.\n * @returns True if name is present.\n */\nfunction has(name: string): boolean {\n  return rawUpper.indexOf(name.toUpperCase()) !== -1;\n}\n\n// Browsers.  Logic from:\n// https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/browser.js\n// Useragent for JavaFX:\n// Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.44\n//     (KHTML, like Gecko) JavaFX/8.0 Safari/537.44\nisJavaFx = has('JavaFX');\n\n// Engines.  Logic from:\n// https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/engine.js\nisWebKit = has('WebKit');\nisGecko = has('Gecko') && !isWebKit;\n\n// Platforms.  Logic from:\n// https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/platform.js\n// and\n// https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/extra.js\nisAndroid = has('Android');\nconst maxTouchPoints =\n    globalThis['navigator'] && globalThis['navigator']['maxTouchPoints'];\nisIPad = has('iPad') || has('Macintosh') && maxTouchPoints > 0;\nisIPhone = has('iPhone') && !isIPad;\nisMac = has('Macintosh');\n\n// Devices.  Logic from:\n// https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/device.js\nisTablet = isIPad || isAndroid && !has('Mobile') || has('Silk');\nisMobile = !isTablet && (isIPhone || isAndroid);\n})(globalThis['navigator'] && globalThis['navigator']['userAgent'] || '');\n\n/** @alias Blockly.utils.userAgent.raw */\nexport const raw: string = rawUserAgent;\n\n/** @alias Blockly.utils.userAgent.JavaFx */\nexport const JavaFx: boolean = isJavaFx;\n\n/** @alias Blockly.utils.userAgent.GECKO */\nexport const GECKO: boolean = isGecko;\n\n/** @alias Blockly.utils.userAgent.ANDROID */\nexport const ANDROID: boolean = isAndroid;\n\n/** @alias Blockly.utils.userAgent.IPAD */\nexport const IPAD: boolean = isIPad;\n\n/** @alias Blockly.utils.userAgent.IPHONE */\nexport const IPHONE: boolean = isIPhone;\n\n/** @alias Blockly.utils.userAgent.MAC */\nexport const MAC: boolean = isMac;\n\n/** @alias Blockly.utils.userAgent.MOBILE */\nexport const MOBILE: boolean = isMobile;\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Manager for all items registered with the workspace.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ComponentManager');\n\nimport type {IAutoHideable} from './interfaces/i_autohideable.js';\nimport type {IComponent} from './interfaces/i_component.js';\nimport type {IDeleteArea} from './interfaces/i_delete_area.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {IPositionable} from './interfaces/i_positionable.js';\nimport * as arrayUtils from './utils/array.js';\n\n\nclass Capability<_T> {\n  static POSITIONABLE = new Capability<IPositionable>('positionable');\n  static DRAG_TARGET = new Capability<IDragTarget>('drag_target');\n  static DELETE_AREA = new Capability<IDeleteArea>('delete_area');\n  static AUTOHIDEABLE = new Capability<IAutoHideable>('autohideable');\n  private readonly name_: string;\n  /** @param name The name of the component capability. */\n  constructor(name: string) {\n    this.name_ = name;\n  }\n\n  /**\n   * Returns the name of the capability.\n   *\n   * @returns The name.\n   */\n  toString(): string {\n    return this.name_;\n  }\n}\n\n/**\n * Manager for all items registered with the workspace.\n *\n * @alias Blockly.ComponentManager\n */\nexport class ComponentManager {\n  static Capability = Capability;\n\n  /**\n   * A map of the components registered with the workspace, mapped to id.\n   */\n  private readonly componentData = new Map<string, ComponentDatum>();\n\n  /** A map of capabilities to component IDs. */\n  private readonly capabilityToComponentIds = new Map<string, string[]>();\n\n  /**\n   * Adds a component.\n   *\n   * @param componentInfo The data for the component to register.\n   * @param opt_allowOverrides True to prevent an error when overriding an\n   *     already registered item.\n   */\n  addComponent(componentInfo: ComponentDatum, opt_allowOverrides?: boolean) {\n    // Don't throw an error if opt_allowOverrides is true.\n    const id = componentInfo.component.id;\n    if (!opt_allowOverrides && this.componentData.has(id)) {\n      throw Error(\n          'Plugin \"' + id + '\" with capabilities \"' +\n          this.componentData.get(id)?.capabilities + '\" already added.');\n    }\n    this.componentData.set(id, componentInfo);\n    const stringCapabilities = [];\n    for (let i = 0; i < componentInfo.capabilities.length; i++) {\n      const capability = String(componentInfo.capabilities[i]).toLowerCase();\n      stringCapabilities.push(capability);\n      if (!this.capabilityToComponentIds.has(capability)) {\n        this.capabilityToComponentIds.set(capability, [id]);\n      } else {\n        this.capabilityToComponentIds.get(capability)?.push(id);\n      }\n    }\n    this.componentData.get(id)!.capabilities = stringCapabilities;\n  }\n\n  /**\n   * Removes a component.\n   *\n   * @param id The ID of the component to remove.\n   */\n  removeComponent(id: string) {\n    const componentInfo = this.componentData.get(id);\n    if (!componentInfo) {\n      return;\n    }\n    for (let i = 0; i < componentInfo.capabilities.length; i++) {\n      const capability = String(componentInfo.capabilities[i]).toLowerCase();\n      arrayUtils.removeElem(this.capabilityToComponentIds.get(capability)!, id);\n    }\n    this.componentData.delete(id);\n  }\n\n  /**\n   * Adds a capability to a existing registered component.\n   *\n   * @param id The ID of the component to add the capability to.\n   * @param capability The capability to add.\n   */\n  addCapability<T>(id: string, capability: string|Capability<T>) {\n    if (!this.getComponent(id)) {\n      throw Error(\n          'Cannot add capability, \"' + capability + '\". Plugin \"' + id +\n          '\" has not been added to the ComponentManager');\n    }\n    if (this.hasCapability(id, capability)) {\n      console.warn(\n          'Plugin \"' + id + 'already has capability \"' + capability + '\"');\n      return;\n    }\n    capability = String(capability).toLowerCase();\n    this.componentData.get(id)?.capabilities.push(capability);\n    this.capabilityToComponentIds.get(capability)?.push(id);\n  }\n\n  /**\n   * Removes a capability from an existing registered component.\n   *\n   * @param id The ID of the component to remove the capability from.\n   * @param capability The capability to remove.\n   */\n  removeCapability<T>(id: string, capability: string|Capability<T>) {\n    if (!this.getComponent(id)) {\n      throw Error(\n          'Cannot remove capability, \"' + capability + '\". Plugin \"' + id +\n          '\" has not been added to the ComponentManager');\n    }\n    if (!this.hasCapability(id, capability)) {\n      console.warn(\n          'Plugin \"' + id + 'doesn\\'t have capability \"' + capability +\n          '\" to remove');\n      return;\n    }\n    capability = String(capability).toLowerCase();\n    arrayUtils.removeElem(this.componentData.get(id)!.capabilities, capability);\n    arrayUtils.removeElem(this.capabilityToComponentIds.get(capability)!, id);\n  }\n\n  /**\n   * Returns whether the component with this id has the specified capability.\n   *\n   * @param id The ID of the component to check.\n   * @param capability The capability to check for.\n   * @returns Whether the component has the capability.\n   */\n  hasCapability<T>(id: string, capability: string|Capability<T>): boolean {\n    capability = String(capability).toLowerCase();\n    return this.componentData.has(id) &&\n        this.componentData.get(id)!.capabilities.indexOf(capability) !== -1;\n  }\n\n  /**\n   * Gets the component with the given ID.\n   *\n   * @param id The ID of the component to get.\n   * @returns The component with the given name or undefined if not found.\n   */\n  getComponent(id: string): IComponent|undefined {\n    return this.componentData.get(id)?.component;\n  }\n\n  /**\n   * Gets all the components with the specified capability.\n   *\n   * @param capability The capability of the component.\n   * @param sorted Whether to return list ordered by weights.\n   * @returns The components that match the specified capability.\n   */\n  getComponents<T extends IComponent>(\n      capability: string|Capability<T>, sorted: boolean): T[] {\n    capability = String(capability).toLowerCase();\n    const componentIds = this.capabilityToComponentIds.get(capability);\n    if (!componentIds) {\n      return [];\n    }\n    const components: T[] = [];\n    if (sorted) {\n      const componentDataList: ComponentDatum[] = [];\n      componentIds.forEach((id) => {\n        componentDataList.push(this.componentData.get(id)!);\n      });\n      componentDataList.sort(function(a, b) {\n        return a.weight - b.weight;\n      });\n      componentDataList.forEach(function(componentDatum) {\n        components.push(componentDatum.component as T);\n      });\n    } else {\n      componentIds.forEach((id) => {\n        components.push(this.componentData.get(id)!.component as T);\n      });\n    }\n    return components;\n  }\n}\n\nexport namespace ComponentManager {\n  /** An object storing component information. */\n  export interface ComponentDatum {\n    component: IComponent;\n    capabilities: Array<string|Capability<IComponent>>;\n    weight: number;\n  }\n}\n\nexport type ComponentDatum = ComponentManager.ComponentDatum;\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of element select action.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.Selected');\n\nimport * as registry from '../registry.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a selected event.\n *\n * @alias Blockly.Events.Selected\n */\nexport class Selected extends UiBase {\n  oldElementId?: string|null;\n  newElementId?: string|null;\n  override type: string;\n\n  /**\n   * @param opt_oldElementId The ID of the previously selected element. Null if\n   *     no element last selected. Undefined for a blank event.\n   * @param opt_newElementId The ID of the selected element. Null if no element\n   *     currently selected (deselect). Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Null if no element previously selected. Undefined for a blank event.\n   */\n  constructor(\n      opt_oldElementId?: string|null, opt_newElementId?: string|null,\n      opt_workspaceId?: string) {\n    super(opt_workspaceId);\n\n    /** The id of the last selected element. */\n    this.oldElementId = opt_oldElementId;\n\n    /** The id of the selected element. */\n    this.newElementId = opt_newElementId;\n\n    /** Type of this event. */\n    this.type = eventUtils.SELECTED;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['oldElementId'] = this.oldElementId;\n    json['newElementId'] = this.newElementId;\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.oldElementId = json['oldElementId'];\n    this.newElementId = json['newElementId'];\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.SELECTED, Selected);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An enum for the possible types of inputs.\n *\n * @namespace Blockly.inputTypes\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.inputTypes');\n\nimport {ConnectionType} from './connection_type.js';\n\n\n/**\n * Enum for the type of a connection or input.\n *\n * @alias Blockly.inputTypes\n */\nexport enum inputTypes {\n  // A right-facing value input.  E.g. 'set item to' or 'return'.\n  VALUE = ConnectionType.INPUT_VALUE,\n  // A down-facing block stack.  E.g. 'if-do' or 'else'.\n  STATEMENT = ConnectionType.NEXT_STATEMENT,\n  // A dummy input.  Used to add field(s) with no input.\n  DUMMY = 5\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for size calculation.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.Size');\n\n\n/**\n * Class for representing sizes consisting of a width and height.\n *\n * @alias Blockly.utils.Size\n */\nexport class Size {\n  /**\n   * @param width Width.\n   * @param height Height.\n   */\n  constructor(public width: number, public height: number) {}\n\n  /**\n   * Compares sizes for equality.\n   *\n   * @param a A Size.\n   * @param b A Size.\n   * @returns True iff the sizes have equal widths and equal heights, or if both\n   *     are null.\n   */\n  static equals(a: Size|null, b: Size|null): boolean {\n    if (a === b) {\n      return true;\n    }\n    if (!a || !b) {\n      return false;\n    }\n    return a.width === b.width && a.height === b.height;\n  }\n}\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Empty name space for the Message singleton.\n *\n * @namespace Blockly.Msg\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Msg');\n\n\n/** A dictionary of localised messages. */\nexport const Msg: {[key: string]: string} = Object.create(null);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Abstract class for a variable event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.VarBase');\n\nimport type {VariableModel} from '../variable_model.js';\n\nimport {Abstract as AbstractEvent} from './events_abstract.js';\n\n\n/**\n * Abstract class for a variable event.\n *\n * @alias Blockly.Events.VarBase\n */\nexport class VarBase extends AbstractEvent {\n  override isBlank: AnyDuringMigration;\n  varId: string;\n  override workspaceId: string;\n\n  /**\n   * @param opt_variable The variable this event corresponds to.  Undefined for\n   *     a blank event.\n   */\n  constructor(opt_variable?: VariableModel) {\n    super();\n    this.isBlank = typeof opt_variable === 'undefined';\n\n    /** The variable id for the variable this event pertains to. */\n    this.varId = this.isBlank ? '' : opt_variable!.getId();\n\n    /** The workspace identifier for this event. */\n    this.workspaceId = this.isBlank ? '' : opt_variable!.workspace.id;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['varId'] = this.varId;\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.varId = json['varId'];\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a variable creation event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.VarCreate');\n\nimport * as registry from '../registry.js';\nimport type {VariableModel} from '../variable_model.js';\n\nimport {VarBase} from './events_var_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a variable creation event.\n *\n * @alias Blockly.Events.VarCreate\n */\nexport class VarCreate extends VarBase {\n  override type: string;\n\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  varType!: string;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  varName!: string;\n\n  /**\n   * @param opt_variable The created variable. Undefined for a blank event.\n   */\n  constructor(opt_variable?: VariableModel) {\n    super(opt_variable);\n\n    /** Type of this event. */\n    this.type = eventUtils.VAR_CREATE;\n\n    if (!opt_variable) {\n      return;  // Blank event to be populated by fromJson.\n    }\n    this.varType = opt_variable.type;\n    this.varName = opt_variable.name;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['varType'] = this.varType;\n    json['varName'] = this.varName;\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.varType = json['varType'];\n    this.varName = json['varName'];\n  }\n\n  /**\n   * Run a variable creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (forward) {\n      workspace.createVariable(this.varName, this.varType, this.varId);\n    } else {\n      workspace.deleteVariableById(this.varId);\n    }\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.VAR_CREATE, VarCreate);\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Components for the variable model.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.VariableModel');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_create.js';\n\nimport * as eventUtils from './events/utils.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport type {Workspace} from './workspace.js';\n\n\n/**\n * Class for a variable model.\n * Holds information for the variable including name, ID, and type.\n *\n * @see {Blockly.FieldVariable}\n * @alias Blockly.VariableModel\n */\nexport class VariableModel {\n  type: string;\n  private readonly id_: string;\n\n  /**\n   * @param workspace The variable's workspace.\n   * @param name The name of the variable.  This is the user-visible name (e.g.\n   *     'my var' or ''), not the generated name.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   */\n  constructor(\n      public workspace: Workspace, public name: string, opt_type?: string,\n      opt_id?: string) {\n    /**\n     * The type of the variable, such as 'int' or 'sound_effect'. This may be\n     * used to build a list of variables of a specific type. By default this is\n     * the empty string '', which is a specific type.\n     *\n     * @see {Blockly.FieldVariable}\n     */\n    this.type = opt_type || '';\n\n    /**\n     * A unique ID for the variable. This should be defined at creation and\n     * not change, even if the name changes. In most cases this should be a\n     * UUID.\n     */\n    this.id_ = opt_id || idGenerator.genUid();\n\n    eventUtils.fire(new (eventUtils.get(eventUtils.VAR_CREATE))(this));\n  }\n\n  /** @returns The ID for the variable. */\n  getId(): string {\n    return this.id_;\n  }\n\n  /**\n   * A custom compare function for the VariableModel objects.\n   *\n   * @param var1 First variable to compare.\n   * @param var2 Second variable to compare.\n   * @returns -1 if name of var1 is less than name of var2, 0 if equal, and 1 if\n   *     greater.\n   * @internal\n   */\n  static compareByName(var1: VariableModel, var2: VariableModel): number {\n    return var1.name.localeCompare(var2.name, undefined, {sensitivity: 'base'});\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for coordinate manipulation.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.Coordinate');\n\n\n/**\n * Class for representing coordinates and positions.\n *\n * @alias Blockly.utils.Coordinate\n */\nexport class Coordinate {\n  /**\n   * @param x Left.\n   * @param y Top.\n   */\n  constructor(public x: number, public y: number) {}\n\n  /**\n   * Creates a new copy of this coordinate.\n   *\n   * @returns A copy of this coordinate.\n   */\n  clone(): Coordinate {\n    return new Coordinate(this.x, this.y);\n  }\n\n  /**\n   * Scales this coordinate by the given scale factor.\n   *\n   * @param s The scale factor to use for both x and y dimensions.\n   * @returns This coordinate after scaling.\n   */\n  scale(s: number): Coordinate {\n    this.x *= s;\n    this.y *= s;\n    return this;\n  }\n\n  /**\n   * Translates this coordinate by the given offsets.\n   * respectively.\n   *\n   * @param tx The value to translate x by.\n   * @param ty The value to translate y by.\n   * @returns This coordinate after translating.\n   */\n  translate(tx: number, ty: number): Coordinate {\n    this.x += tx;\n    this.y += ty;\n    return this;\n  }\n\n  /**\n   * Compares coordinates for equality.\n   *\n   * @param a A Coordinate.\n   * @param b A Coordinate.\n   * @returns True iff the coordinates are equal, or if both are null.\n   */\n  static equals(a: Coordinate|null, b: Coordinate|null): boolean {\n    if (a === b) {\n      return true;\n    }\n    if (!a || !b) {\n      return false;\n    }\n    return a.x === b.x && a.y === b.y;\n  }\n\n  /**\n   * Returns the distance between two coordinates.\n   *\n   * @param a A Coordinate.\n   * @param b A Coordinate.\n   * @returns The distance between `a` and `b`.\n   */\n  static distance(a: Coordinate, b: Coordinate): number {\n    const dx = a.x - b.x;\n    const dy = a.y - b.y;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n\n  /**\n   * Returns the magnitude of a coordinate.\n   *\n   * @param a A Coordinate.\n   * @returns The distance between the origin and `a`.\n   */\n  static magnitude(a: Coordinate): number {\n    return Math.sqrt(a.x * a.x + a.y * a.y);\n  }\n\n  /**\n   * Returns the difference between two coordinates as a new\n   * Coordinate.\n   *\n   * @param a An x/y coordinate.\n   * @param b An x/y coordinate.\n   * @returns A Coordinate representing the difference between `a` and `b`.\n   */\n  static difference(a: Coordinate|SVGPoint, b: Coordinate|SVGPoint):\n      Coordinate {\n    return new Coordinate(a.x - b.x, a.y - b.y);\n  }\n\n  /**\n   * Returns the sum of two coordinates as a new Coordinate.\n   *\n   * @param a An x/y coordinate.\n   * @param b An x/y coordinate.\n   * @returns A Coordinate representing the sum of the two coordinates.\n   */\n  static sum(a: Coordinate|SVGPoint, b: Coordinate|SVGPoint): Coordinate {\n    return new Coordinate(a.x + b.x, a.y + b.y);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a code comment on the workspace.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.WorkspaceComment');\n\nimport type {CommentMove} from './events/events_comment_move.js';\nimport * as eventUtils from './events/utils.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport * as xml from './utils/xml.js';\nimport type {Workspace} from './workspace.js';\n\n\n/**\n * Class for a workspace comment.\n *\n * @alias Blockly.WorkspaceComment\n */\nexport class WorkspaceComment {\n  id: string;\n  protected xy_: Coordinate;\n  protected height_: number;\n  protected width_: number;\n  protected RTL: boolean;\n\n  private deletable_ = true;\n\n  private movable_ = true;\n\n  private editable_ = true;\n  protected content_: string;\n\n  /** Whether this comment has been disposed. */\n  protected disposed_ = false;\n  /** @internal */\n  isComment = true;\n\n  /**\n   * @param workspace The block's workspace.\n   * @param content The content of this workspace comment.\n   * @param height Height of the comment.\n   * @param width Width of the comment.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   */\n  constructor(\n      public workspace: Workspace, content: string, height: number,\n      width: number, opt_id?: string) {\n    this.id = opt_id && !workspace.getCommentById(opt_id) ?\n        opt_id :\n        idGenerator.genUid();\n\n    workspace.addTopComment(this);\n\n    /**\n     * The comment's position in workspace units.  (0, 0) is at the workspace's\n     * origin; scale does not change this value.\n     */\n    this.xy_ = new Coordinate(0, 0);\n\n    /**\n     * The comment's height in workspace units.  Scale does not change this\n     * value.\n     */\n    this.height_ = height;\n\n    /**\n     * The comment's width in workspace units.  Scale does not change this\n     * value.\n     */\n    this.width_ = width;\n\n    this.RTL = workspace.RTL;\n\n    this.content_ = content;\n\n    WorkspaceComment.fireCreateEvent(this);\n  }\n\n  /**\n   * Dispose of this comment.\n   *\n   * @internal\n   */\n  dispose() {\n    if (this.disposed_) {\n      return;\n    }\n\n    if (eventUtils.isEnabled()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.COMMENT_DELETE))(this));\n    }\n    // Remove from the list of top comments and the comment database.\n    this.workspace.removeTopComment(this);\n    this.disposed_ = true;\n  }\n\n  // Height, width, x, and y are all stored on even non-rendered comments, to\n  // preserve state if you pass the contents through a headless workspace.\n\n  /**\n   * Get comment height.\n   *\n   * @returns Comment height.\n   * @internal\n   */\n  getHeight(): number {\n    return this.height_;\n  }\n\n  /**\n   * Set comment height.\n   *\n   * @param height Comment height.\n   * @internal\n   */\n  setHeight(height: number) {\n    this.height_ = height;\n  }\n\n  /**\n   * Get comment width.\n   *\n   * @returns Comment width.\n   * @internal\n   */\n  getWidth(): number {\n    return this.width_;\n  }\n\n  /**\n   * Set comment width.\n   *\n   * @param width comment width.\n   * @internal\n   */\n  setWidth(width: number) {\n    this.width_ = width;\n  }\n\n  /**\n   * Get stored location.\n   *\n   * @returns The comment's stored location.\n   *   This is not valid if the comment is currently being dragged.\n   * @internal\n   */\n  getXY(): Coordinate {\n    return new Coordinate(this.xy_.x, this.xy_.y);\n  }\n\n  /**\n   * Move a comment by a relative offset.\n   *\n   * @param dx Horizontal offset, in workspace units.\n   * @param dy Vertical offset, in workspace units.\n   * @internal\n   */\n  moveBy(dx: number, dy: number) {\n    const event =\n        new (eventUtils.get(eventUtils.COMMENT_MOVE))(this) as CommentMove;\n    this.xy_.translate(dx, dy);\n    event.recordNew();\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Get whether this comment is deletable or not.\n   *\n   * @returns True if deletable.\n   * @internal\n   */\n  isDeletable(): boolean {\n    return this.deletable_ &&\n        !(this.workspace && this.workspace.options.readOnly);\n  }\n\n  /**\n   * Set whether this comment is deletable or not.\n   *\n   * @param deletable True if deletable.\n   * @internal\n   */\n  setDeletable(deletable: boolean) {\n    this.deletable_ = deletable;\n  }\n\n  /**\n   * Get whether this comment is movable or not.\n   *\n   * @returns True if movable.\n   * @internal\n   */\n  isMovable(): boolean {\n    return this.movable_ &&\n        !(this.workspace && this.workspace.options.readOnly);\n  }\n\n  /**\n   * Set whether this comment is movable or not.\n   *\n   * @param movable True if movable.\n   * @internal\n   */\n  setMovable(movable: boolean) {\n    this.movable_ = movable;\n  }\n\n  /**\n   * Get whether this comment is editable or not.\n   *\n   * @returns True if editable.\n   */\n  isEditable(): boolean {\n    return this.editable_ &&\n        !(this.workspace && this.workspace.options.readOnly);\n  }\n\n  /**\n   * Set whether this comment is editable or not.\n   *\n   * @param editable True if editable.\n   */\n  setEditable(editable: boolean) {\n    this.editable_ = editable;\n  }\n\n  /**\n   * Returns this comment's text.\n   *\n   * @returns Comment text.\n   * @internal\n   */\n  getContent(): string {\n    return this.content_;\n  }\n\n  /**\n   * Set this comment's content.\n   *\n   * @param content Comment content.\n   * @internal\n   */\n  setContent(content: string) {\n    if (this.content_ !== content) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.COMMENT_CHANGE))(\n          this, this.content_, content));\n      this.content_ = content;\n    }\n  }\n\n  /**\n   * Encode a comment subtree as XML with XY coordinates.\n   *\n   * @param opt_noId True if the encoder should skip the comment ID.\n   * @returns Tree of XML elements.\n   * @internal\n   */\n  toXmlWithXY(opt_noId?: boolean): Element {\n    const element = this.toXml(opt_noId);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    element.setAttribute('x', Math.round(this.xy_.x) as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    element.setAttribute('y', Math.round(this.xy_.y) as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    element.setAttribute('h', this.height_ as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    element.setAttribute('w', this.width_ as AnyDuringMigration);\n    return element;\n  }\n\n  /**\n   * Encode a comment subtree as XML, but don't serialize the XY coordinates.\n   * This method avoids some expensive metrics-related calls that are made in\n   * toXmlWithXY().\n   *\n   * @param opt_noId True if the encoder should skip the comment ID.\n   * @returns Tree of XML elements.\n   * @internal\n   */\n  toXml(opt_noId?: boolean): Element {\n    const commentElement = xml.createElement('comment');\n    if (!opt_noId) {\n      commentElement.id = this.id;\n    }\n    commentElement.textContent = this.getContent();\n    return commentElement;\n  }\n\n  /**\n   * Fire a create event for the given workspace comment, if comments are\n   * enabled.\n   *\n   * @param comment The comment that was just created.\n   * @internal\n   */\n  static fireCreateEvent(comment: WorkspaceComment) {\n    if (eventUtils.isEnabled()) {\n      const existingGroup = eventUtils.getGroup();\n      if (!existingGroup) {\n        eventUtils.setGroup(true);\n      }\n      try {\n        eventUtils.fire(\n            new (eventUtils.get(eventUtils.COMMENT_CREATE))(comment));\n      } finally {\n        if (!existingGroup) {\n          eventUtils.setGroup(false);\n        }\n      }\n    }\n  }\n\n  /**\n   * Decode an XML comment tag and create a comment on the workspace.\n   *\n   * @param xmlComment XML comment element.\n   * @param workspace The workspace.\n   * @returns The created workspace comment.\n   * @internal\n   */\n  static fromXml(xmlComment: Element, workspace: Workspace): WorkspaceComment {\n    const info = WorkspaceComment.parseAttributes(xmlComment);\n\n    const comment =\n        new WorkspaceComment(workspace, info.content, info.h, info.w, info.id);\n\n    // AnyDuringMigration because:  Argument of type 'string | null' is not\n    // assignable to parameter of type 'string'.\n    const commentX =\n        parseInt(xmlComment.getAttribute('x') as AnyDuringMigration, 10);\n    // AnyDuringMigration because:  Argument of type 'string | null' is not\n    // assignable to parameter of type 'string'.\n    const commentY =\n        parseInt(xmlComment.getAttribute('y') as AnyDuringMigration, 10);\n    if (!isNaN(commentX) && !isNaN(commentY)) {\n      comment.moveBy(commentX, commentY);\n    }\n\n    WorkspaceComment.fireCreateEvent(comment);\n    return comment;\n  }\n\n  /**\n   * Decode an XML comment tag and return the results in an object.\n   *\n   * @param xml XML comment element.\n   * @returns An object containing the id, size, position, and comment string.\n   * @internal\n   */\n  static parseAttributes(xml: Element): {\n    id: string,\n    w: number,\n    h: number,\n    x: number,\n    y: number,\n    content: string\n  } {\n    const xmlH = xml.getAttribute('h');\n    const xmlW = xml.getAttribute('w');\n\n    return {\n      // @type {string}\n      // AnyDuringMigration because:  Type 'string | null' is not assignable to\n      // type 'string'.\n      id: xml.getAttribute('id') as\n          AnyDuringMigration,  // The height of the comment in workspace units,\n      // or 100 if not specified.\n      // @type {number}\n      h: xmlH ? parseInt(xmlH, 10) :\n                100,  // The width of the comment in workspace units, or 100 if\n      // not specified.\n      // @type {number}\n      w: xmlW ? parseInt(xmlW, 10) :\n                100,  // The x position of the comment in workspace coordinates,\n      // or NaN if not\n      // specified in the XML.\n      // @type {number}\n      // AnyDuringMigration because:  Argument of type 'string | null' is not\n      // assignable to parameter of type 'string'.\n      x: parseInt(\n          xml.getAttribute('x') as AnyDuringMigration,\n          10),  // The y position of the comment in workspace coordinates, or\n      // NaN if not\n      // specified in the XML.\n      // @type {number}\n      // AnyDuringMigration because:  Argument of type 'string | null' is not\n      // assignable to parameter of type 'string'.\n      y: parseInt(\n          xml.getAttribute('y') as AnyDuringMigration, 10),  // @type {string}\n      // AnyDuringMigration because:  Type 'string | null' is not assignable to\n      // type 'string'.\n      content: xml.textContent as AnyDuringMigration,\n    };\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for rectangle manipulation.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.Rect');\n\n\n/**\n * Class for representing rectangular regions.\n *\n * @alias Blockly.utils.Rect\n */\nexport class Rect {\n  /**\n   * @param top Top.\n   * @param bottom Bottom.\n   * @param left Left.\n   * @param right Right.\n   */\n  constructor(\n      public top: number, public bottom: number, public left: number,\n      public right: number) {}\n\n  /**\n   * Tests whether this rectangle contains a x/y coordinate.\n   *\n   * @param x The x coordinate to test for containment.\n   * @param y The y coordinate to test for containment.\n   * @returns Whether this rectangle contains given coordinate.\n   */\n  contains(x: number, y: number): boolean {\n    return x >= this.left && x <= this.right && y >= this.top &&\n        y <= this.bottom;\n  }\n\n  /**\n   * Tests whether this rectangle intersects the provided rectangle.\n   * Assumes that the coordinate system increases going down and left.\n   *\n   * @param other The other rectangle to check for intersection with.\n   * @returns Whether this rectangle intersects the provided rectangle.\n   */\n  intersects(other: Rect): boolean {\n    return !(\n        this.left > other.right || this.right < other.left ||\n        this.top > other.bottom || this.bottom < other.top);\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Defines the Svg class. Its constants enumerate\n * all SVG tag names used by Blockly.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.Svg');\n\n\n/**\n * A name with the type of the SVG element stored in the generic.\n *\n * @alias Blockly.utils.Svg\n */\nexport class Svg<_T> {\n  /** @internal */\n  static ANIMATE = new Svg<SVGAnimateElement>('animate');\n  /** @internal */\n  static CIRCLE = new Svg<SVGCircleElement>('circle');\n  /** @internal */\n  static CLIPPATH = new Svg<SVGClipPathElement>('clipPath');\n  /** @internal */\n  static DEFS = new Svg<SVGDefsElement>('defs');\n  /** @internal */\n  static FECOMPOSITE = new Svg<SVGFECompositeElement>('feComposite');\n  /** @internal */\n  static FECOMPONENTTRANSFER =\n      new Svg<SVGFEComponentTransferElement>('feComponentTransfer');\n  /** @internal */\n  static FEFLOOD = new Svg<SVGFEFloodElement>('feFlood');\n  /** @internal */\n  static FEFUNCA = new Svg<SVGFEFuncAElement>('feFuncA');\n  /** @internal */\n  static FEGAUSSIANBLUR = new Svg<SVGFEGaussianBlurElement>('feGaussianBlur');\n  /** @internal */\n  static FEPOINTLIGHT = new Svg<SVGFEPointLightElement>('fePointLight');\n  /** @internal */\n  static FESPECULARLIGHTING =\n      new Svg<SVGFESpecularLightingElement>('feSpecularLighting');\n  /** @internal */\n  static FILTER = new Svg<SVGFilterElement>('filter');\n  /** @internal */\n  static FOREIGNOBJECT = new Svg<SVGForeignObjectElement>('foreignObject');\n  /** @internal */\n  static G = new Svg<SVGGElement>('g');\n  /** @internal */\n  static IMAGE = new Svg<SVGImageElement>('image');\n  /** @internal */\n  static LINE = new Svg<SVGLineElement>('line');\n  /** @internal */\n  static PATH = new Svg<SVGPathElement>('path');\n  /** @internal */\n  static PATTERN = new Svg<SVGPatternElement>('pattern');\n  /** @internal */\n  static POLYGON = new Svg<SVGPolygonElement>('polygon');\n  /** @internal */\n  static RECT = new Svg<SVGRectElement>('rect');\n  /** @internal */\n  static SVG = new Svg<SVGSVGElement>('svg');\n  /** @internal */\n  static TEXT = new Svg<SVGTextElement>('text');\n  /** @internal */\n  static TSPAN = new Svg<SVGTSpanElement>('tspan');\n\n  /**\n   * @param tagName The SVG element tag name.\n   * @internal\n   */\n  constructor(private readonly tagName: string) {}\n\n  /**\n   * Returns the SVG element tag name.\n   *\n   * @returns The name.\n   */\n  toString(): string {\n    return this.tagName;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a code comment on a rendered workspace.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.WorkspaceCommentSvg');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_selected.js';\n\nimport type {BlockDragSurfaceSvg} from './block_drag_surface.js';\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\n// import * as ContextMenu from './contextmenu.js';\nimport * as Css from './css.js';\nimport type {CommentMove} from './events/events_comment_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport type {IBubble} from './interfaces/i_bubble.js';\nimport type {CopyData, ICopyable} from './interfaces/i_copyable.js';\nimport * as Touch from './touch.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport {WorkspaceComment} from './workspace_comment.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/** Size of the resize icon. */\nconst RESIZE_SIZE = 8;\n\n/** Radius of the border around the comment. */\nconst BORDER_RADIUS = 3;\n\n/** Offset from the foreignobject edge to the textarea edge. */\nconst TEXTAREA_OFFSET = 2;\n\n/**\n * Class for a workspace comment's SVG representation.\n *\n * @alias Blockly.WorkspaceCommentSvg\n */\nexport class WorkspaceCommentSvg extends WorkspaceComment implements\n    IBoundedElement, IBubble, ICopyable {\n  /**\n   * The width and height to use to size a workspace comment when it is first\n   * added, before it has been edited by the user.\n   *\n   * @internal\n   */\n  static DEFAULT_SIZE = 100;\n\n  /** Offset from the top to make room for a top bar. */\n  private static readonly TOP_OFFSET = 10;\n  override workspace: WorkspaceSvg;\n\n  /** Mouse up event data. */\n  private onMouseUpWrapper_: browserEvents.Data|null = null;\n\n  /** Mouse move event data. */\n  private onMouseMoveWrapper_: browserEvents.Data|null = null;\n\n  /** Whether event handlers have been initialized. */\n  private eventsInit_ = false;\n  private textarea_: HTMLTextAreaElement|null = null;\n\n  private svgRectTarget_: SVGRectElement|null = null;\n\n  private svgHandleTarget_: SVGRectElement|null = null;\n\n  private foreignObject_: SVGForeignObjectElement|null = null;\n\n  private resizeGroup_: SVGGElement|null = null;\n\n  private deleteGroup_: SVGGElement|null = null;\n\n  private deleteIconBorder_: SVGCircleElement|null = null;\n\n  private focused_ = false;\n  private autoLayout_ = false;\n  // Create core elements for the block.\n  private readonly svgGroup_: SVGElement;\n  svgRect_: AnyDuringMigration;\n\n  /** Whether the comment is rendered onscreen and is a part of the DOM. */\n  private rendered_ = false;\n  private readonly useDragSurface_: boolean;\n\n  /**\n   * @param workspace The block's workspace.\n   * @param content The content of this workspace comment.\n   * @param height Height of the comment.\n   * @param width Width of the comment.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   */\n  constructor(\n      workspace: WorkspaceSvg, content: string, height: number, width: number,\n      opt_id?: string) {\n    super(workspace, content, height, width, opt_id);\n    this.svgGroup_ = dom.createSvgElement(Svg.G, {'class': 'blocklyComment'});\n    (this.svgGroup_ as AnyDuringMigration).translate_ = '';\n    this.workspace = workspace;\n\n    this.svgRect_ = dom.createSvgElement(Svg.RECT, {\n      'class': 'blocklyCommentRect',\n      'x': 0,\n      'y': 0,\n      'rx': BORDER_RADIUS,\n      'ry': BORDER_RADIUS,\n    });\n    this.svgGroup_.appendChild(this.svgRect_);\n\n    /**\n     * Whether to move the comment to the drag surface when it is dragged.\n     * True if it should move, false if it should be translated directly.\n     */\n    this.useDragSurface_ = !!workspace.getBlockDragSurface();\n\n    this.render();\n  }\n\n  /**\n   * Dispose of this comment.\n   *\n   * @internal\n   */\n  override dispose() {\n    if (this.disposed_) {\n      return;\n    }\n    // If this comment is being dragged, unlink the mouse events.\n    if (common.getSelected() === this) {\n      this.unselect();\n      this.workspace.cancelCurrentGesture();\n    }\n\n    if (eventUtils.isEnabled()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.COMMENT_DELETE))(this));\n    }\n\n    dom.removeNode(this.svgGroup_);\n    // Dispose of any rendered components\n    this.disposeInternal_();\n\n    eventUtils.disable();\n    super.dispose();\n    eventUtils.enable();\n  }\n\n  /**\n   * Create and initialize the SVG representation of a workspace comment.\n   * May be called more than once.\n   *\n   * @param opt_noSelect Text inside text area will be selected if false\n   * @internal\n   */\n  initSvg(opt_noSelect?: boolean) {\n    if (!this.workspace.rendered) {\n      throw TypeError('Workspace is headless.');\n    }\n    if (!this.workspace.options.readOnly && !this.eventsInit_) {\n      browserEvents.conditionalBind(\n          this.svgRectTarget_ as SVGRectElement, 'mousedown', this,\n          this.pathMouseDown_);\n      browserEvents.conditionalBind(\n          this.svgHandleTarget_ as SVGRectElement, 'mousedown', this,\n          this.pathMouseDown_);\n    }\n    this.eventsInit_ = true;\n\n    this.updateMovable();\n    if (!this.getSvgRoot().parentNode) {\n      this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot());\n    }\n\n    if (!opt_noSelect && this.textarea_) {\n      this.textarea_.select();\n    }\n  }\n\n  /**\n   * Handle a mouse-down on an SVG comment.\n   *\n   * @param e Mouse down event or touch start event.\n   */\n  private pathMouseDown_(e: Event) {\n    const gesture = this.workspace.getGesture(e);\n    if (gesture) {\n      gesture.handleBubbleStart(e, this);\n    }\n  }\n\n  /**\n   * Show the context menu for this workspace comment.\n   *\n   * @param e Mouse event.\n   * @internal\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  showContextMenu(e: Event) {\n    throw new Error(\n        'The implementation of showContextMenu should be ' +\n        'monkey-patched in by blockly.ts');\n  }\n\n  /**\n   * Select this comment.  Highlight it visually.\n   *\n   * @internal\n   */\n  select() {\n    if (common.getSelected() === this) {\n      return;\n    }\n    let oldId = null;\n    if (common.getSelected()) {\n      oldId = common.getSelected()!.id;\n      // Unselect any previously selected block.\n      eventUtils.disable();\n      try {\n        common.getSelected()!.unselect();\n      } finally {\n        eventUtils.enable();\n      }\n    }\n    const event = new (eventUtils.get(eventUtils.SELECTED))(\n        oldId, this.id, this.workspace.id);\n    eventUtils.fire(event);\n    common.setSelected(this);\n    this.addSelect();\n  }\n\n  /**\n   * Unselect this comment.  Remove its highlighting.\n   *\n   * @internal\n   */\n  unselect() {\n    if (common.getSelected() !== this) {\n      return;\n    }\n    const event = new (eventUtils.get(eventUtils.SELECTED))(\n        this.id, null, this.workspace.id);\n    eventUtils.fire(event);\n    common.setSelected(null);\n    this.removeSelect();\n    this.blurFocus();\n  }\n\n  /**\n   * Select this comment.  Highlight it visually.\n   *\n   * @internal\n   */\n  addSelect() {\n    dom.addClass(this.svgGroup_ as Element, 'blocklySelected');\n    this.setFocus();\n  }\n\n  /**\n   * Unselect this comment.  Remove its highlighting.\n   *\n   * @internal\n   */\n  removeSelect() {\n    dom.removeClass(this.svgGroup_ as Element, 'blocklySelected');\n    this.blurFocus();\n  }\n\n  /**\n   * Focus this comment.  Highlight it visually.\n   *\n   * @internal\n   */\n  addFocus() {\n    dom.addClass(this.svgGroup_ as Element, 'blocklyFocused');\n  }\n\n  /**\n   * Unfocus this comment.  Remove its highlighting.\n   *\n   * @internal\n   */\n  removeFocus() {\n    dom.removeClass(this.svgGroup_ as Element, 'blocklyFocused');\n  }\n\n  /**\n   * Return the coordinates of the top-left corner of this comment relative to\n   * the drawing surface's origin (0,0), in workspace units.\n   * If the comment is on the workspace, (0, 0) is the origin of the workspace\n   * coordinate system.\n   * This does not change with workspace scale.\n   *\n   * @returns Object with .x and .y properties in workspace coordinates.\n   * @internal\n   */\n  getRelativeToSurfaceXY(): Coordinate {\n    let x = 0;\n    let y = 0;\n\n    const dragSurfaceGroup = this.useDragSurface_ ?\n        this.workspace.getBlockDragSurface()!.getGroup() :\n        null;\n\n    let element = this.getSvgRoot();\n    if (element) {\n      do {\n        // Loop through this comment and every parent.\n        const xy = svgMath.getRelativeXY(element as Element);\n        x += xy.x;\n        y += xy.y;\n        // If this element is the current element on the drag surface, include\n        // the translation of the drag surface itself.\n        if (this.useDragSurface_ &&\n            this.workspace.getBlockDragSurface()!.getCurrentBlock() ===\n                element) {\n          const surfaceTranslation =\n              this.workspace.getBlockDragSurface()!.getSurfaceTranslation();\n          x += surfaceTranslation.x;\n          y += surfaceTranslation.y;\n        }\n        // AnyDuringMigration because:  Type 'ParentNode | null' is not\n        // assignable to type 'SVGElement'.\n        element = element.parentNode as AnyDuringMigration;\n      } while (element && element !== this.workspace.getBubbleCanvas() &&\n               element !== dragSurfaceGroup);\n    }\n    this.xy_ = new Coordinate(x, y);\n    return this.xy_;\n  }\n\n  /**\n   * Move a comment by a relative offset.\n   *\n   * @param dx Horizontal offset, in workspace units.\n   * @param dy Vertical offset, in workspace units.\n   * @internal\n   */\n  override moveBy(dx: number, dy: number) {\n    const event =\n        new (eventUtils.get(eventUtils.COMMENT_MOVE))(this) as CommentMove;\n    // TODO: Do I need to look up the relative to surface XY position here?\n    const xy = this.getRelativeToSurfaceXY();\n    this.translate(xy.x + dx, xy.y + dy);\n    this.xy_ = new Coordinate(xy.x + dx, xy.y + dy);\n    event.recordNew();\n    eventUtils.fire(event);\n    this.workspace.resizeContents();\n  }\n\n  /**\n   * Transforms a comment by setting the translation on the transform attribute\n   * of the block's SVG.\n   *\n   * @param x The x coordinate of the translation in workspace units.\n   * @param y The y coordinate of the translation in workspace units.\n   * @internal\n   */\n  translate(x: number, y: number) {\n    this.xy_ = new Coordinate(x, y);\n    this.getSvgRoot().setAttribute(\n        'transform', 'translate(' + x + ',' + y + ')');\n  }\n\n  /**\n   * Move this comment to its workspace's drag surface, accounting for\n   * positioning.  Generally should be called at the same time as\n   * setDragging(true).  Does nothing if useDragSurface_ is false.\n   *\n   * @internal\n   */\n  moveToDragSurface() {\n    if (!this.useDragSurface_) {\n      return;\n    }\n    // The translation for drag surface blocks,\n    // is equal to the current relative-to-surface position,\n    // to keep the position in sync as it move on/off the surface.\n    // This is in workspace coordinates.\n    const xy = this.getRelativeToSurfaceXY();\n    this.clearTransformAttributes_();\n    this.workspace.getBlockDragSurface()!.translateSurface(xy.x, xy.y);\n    // Execute the move on the top-level SVG component\n    this.workspace.getBlockDragSurface()!.setBlocksAndShow(this.getSvgRoot());\n  }\n\n  /**\n   * Move this comment during a drag, taking into account whether we are using a\n   * drag surface to translate blocks.\n   *\n   * @param dragSurface The surface that carries rendered items during a drag,\n   *     or null if no drag surface is in use.\n   * @param newLoc The location to translate to, in workspace coordinates.\n   * @internal\n   */\n  moveDuringDrag(dragSurface: BlockDragSurfaceSvg, newLoc: Coordinate) {\n    if (dragSurface) {\n      dragSurface.translateSurface(newLoc.x, newLoc.y);\n    } else {\n      (this.svgGroup_ as AnyDuringMigration).translate_ =\n          'translate(' + newLoc.x + ',' + newLoc.y + ')';\n      (this.svgGroup_ as AnyDuringMigration)\n          .setAttribute(\n              'transform',\n              (this.svgGroup_ as AnyDuringMigration).translate_ +\n                  (this.svgGroup_ as AnyDuringMigration).skew_);\n    }\n  }\n\n  /**\n   * Move the bubble group to the specified location in workspace coordinates.\n   *\n   * @param x The x position to move to.\n   * @param y The y position to move to.\n   * @internal\n   */\n  moveTo(x: number, y: number) {\n    this.translate(x, y);\n  }\n\n  /**\n   * Clear the comment of transform=\"...\" attributes.\n   * Used when the comment is switching from 3d to 2d transform or vice versa.\n   */\n  private clearTransformAttributes_() {\n    this.getSvgRoot().removeAttribute('transform');\n  }\n\n  /**\n   * Returns the coordinates of a bounding box describing the dimensions of this\n   * comment.\n   * Coordinate system: workspace coordinates.\n   *\n   * @returns Object with coordinates of the bounding box.\n   * @internal\n   */\n  getBoundingRectangle(): Rect {\n    const blockXY = this.getRelativeToSurfaceXY();\n    const commentBounds = this.getHeightWidth();\n    const top = blockXY.y;\n    const bottom = blockXY.y + commentBounds.height;\n    let left;\n    let right;\n    if (this.RTL) {\n      left = blockXY.x - commentBounds.width;\n      // Add the width of the tab/puzzle piece knob to the x coordinate\n      // since X is the corner of the rectangle, not the whole puzzle piece.\n      right = blockXY.x;\n    } else {\n      // Subtract the width of the tab/puzzle piece knob to the x coordinate\n      // since X is the corner of the rectangle, not the whole puzzle piece.\n      left = blockXY.x;\n      right = blockXY.x + commentBounds.width;\n    }\n    return new Rect(top, bottom, left, right);\n  }\n\n  /**\n   * Add or remove the UI indicating if this comment is movable or not.\n   *\n   * @internal\n   */\n  updateMovable() {\n    if (this.isMovable()) {\n      dom.addClass(this.svgGroup_ as Element, 'blocklyDraggable');\n    } else {\n      dom.removeClass(this.svgGroup_ as Element, 'blocklyDraggable');\n    }\n  }\n\n  /**\n   * Set whether this comment is movable or not.\n   *\n   * @param movable True if movable.\n   * @internal\n   */\n  override setMovable(movable: boolean) {\n    super.setMovable(movable);\n    this.updateMovable();\n  }\n\n  /**\n   * Set whether this comment is editable or not.\n   *\n   * @param editable True if editable.\n   */\n  override setEditable(editable: boolean) {\n    super.setEditable(editable);\n    if (this.textarea_) {\n      this.textarea_.readOnly = !editable;\n    }\n  }\n\n  /**\n   * Recursively adds or removes the dragging class to this node and its\n   * children.\n   *\n   * @param adding True if adding, false if removing.\n   * @internal\n   */\n  setDragging(adding: boolean) {\n    if (adding) {\n      const group = this.getSvgRoot();\n      (group as AnyDuringMigration).translate_ = '';\n      (group as AnyDuringMigration).skew_ = '';\n      dom.addClass(this.svgGroup_ as Element, 'blocklyDragging');\n    } else {\n      dom.removeClass(this.svgGroup_ as Element, 'blocklyDragging');\n    }\n  }\n\n  /**\n   * Return the root node of the SVG or null if none exists.\n   *\n   * @returns The root SVG node (probably a group).\n   * @internal\n   */\n  getSvgRoot(): SVGElement {\n    return this.svgGroup_;\n  }\n\n  /**\n   * Returns this comment's text.\n   *\n   * @returns Comment text.\n   * @internal\n   */\n  override getContent(): string {\n    return this.textarea_ ? this.textarea_.value : this.content_;\n  }\n\n  /**\n   * Set this comment's content.\n   *\n   * @param content Comment content.\n   * @internal\n   */\n  override setContent(content: string) {\n    super.setContent(content);\n    if (this.textarea_) {\n      this.textarea_.value = content;\n    }\n  }\n\n  /**\n   * Update the cursor over this comment by adding or removing a class.\n   *\n   * @param enable True if the delete cursor should be shown, false otherwise.\n   * @internal\n   */\n  setDeleteStyle(enable: boolean) {\n    if (enable) {\n      dom.addClass(this.svgGroup_ as Element, 'blocklyDraggingDelete');\n    } else {\n      dom.removeClass(this.svgGroup_ as Element, 'blocklyDraggingDelete');\n    }\n  }\n\n  /**\n   * Set whether auto-layout of this bubble is enabled.  The first time a bubble\n   * is shown it positions itself to not cover any blocks.  Once a user has\n   * dragged it to reposition, it renders where the user put it.\n   *\n   * @param _enable True if auto-layout should be enabled, false otherwise.\n   * @internal\n   */\n  setAutoLayout(_enable: boolean) {}\n  // NOP for compatibility with the bubble dragger.\n\n  /**\n   * Encode a comment subtree as XML with XY coordinates.\n   *\n   * @param opt_noId True if the encoder should skip the comment ID.\n   * @returns Tree of XML elements.\n   * @internal\n   */\n  override toXmlWithXY(opt_noId?: boolean): Element {\n    let width = 0;  // Not used in LTR.\n    if (this.workspace.RTL) {\n      // Here be performance dragons: This calls getMetrics().\n      width = this.workspace.getWidth();\n    }\n    const element = this.toXml(opt_noId);\n    const xy = this.getRelativeToSurfaceXY();\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    element.setAttribute(\n        'x',\n        Math.round(this.workspace.RTL ? width - xy.x : xy.x) as\n            AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    element.setAttribute('y', Math.round(xy.y) as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    element.setAttribute('h', this.getHeight() as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    element.setAttribute('w', this.getWidth() as AnyDuringMigration);\n    return element;\n  }\n\n  /**\n   * Encode a comment for copying.\n   *\n   * @returns Copy metadata.\n   * @internal\n   */\n  toCopyData(): CopyData {\n    return {\n      saveInfo: this.toXmlWithXY(),\n      source: this.workspace,\n      typeCounts: null,\n    };\n  }\n\n  /**\n   * Returns a bounding box describing the dimensions of this comment.\n   *\n   * @returns Object with height and width properties in workspace units.\n   * @internal\n   */\n  getHeightWidth(): {height: number, width: number} {\n    return {width: this.getWidth(), height: this.getHeight()};\n  }\n\n  /**\n   * Renders the workspace comment.\n   *\n   * @internal\n   */\n  render() {\n    if (this.rendered_) {\n      return;\n    }\n\n    const size = this.getHeightWidth();\n\n    // Add text area\n    this.createEditor_();\n    // AnyDuringMigration because:  Argument of type 'SVGForeignObjectElement |\n    // null' is not assignable to parameter of type 'Node'.\n    this.svgGroup_.appendChild(this.foreignObject_ as AnyDuringMigration);\n\n    this.svgHandleTarget_ = dom.createSvgElement(\n        Svg.RECT, {'class': 'blocklyCommentHandleTarget', 'x': 0, 'y': 0});\n    // AnyDuringMigration because:  Argument of type 'SVGRectElement | null' is\n    // not assignable to parameter of type 'Node'.\n    this.svgGroup_.appendChild(this.svgHandleTarget_ as AnyDuringMigration);\n    this.svgRectTarget_ = dom.createSvgElement(Svg.RECT, {\n      'class': 'blocklyCommentTarget',\n      'x': 0,\n      'y': 0,\n      'rx': BORDER_RADIUS,\n      'ry': BORDER_RADIUS,\n    });\n    // AnyDuringMigration because:  Argument of type 'SVGRectElement | null' is\n    // not assignable to parameter of type 'Node'.\n    this.svgGroup_.appendChild(this.svgRectTarget_ as AnyDuringMigration);\n\n    // Add the resize icon\n    this.addResizeDom_();\n    if (this.isDeletable()) {\n      // Add the delete icon\n      this.addDeleteDom_();\n    }\n\n    this.setSize_(size.width, size.height);\n\n    // Set the content\n    this.textarea_!.value = this.content_;\n\n    this.rendered_ = true;\n\n    if (this.resizeGroup_) {\n      browserEvents.conditionalBind(\n          (this.resizeGroup_), 'mousedown', this, this.resizeMouseDown_);\n    }\n\n    if (this.isDeletable()) {\n      browserEvents.conditionalBind(\n          this.deleteGroup_ as SVGGElement, 'mousedown', this,\n          this.deleteMouseDown_);\n      browserEvents.conditionalBind(\n          this.deleteGroup_ as SVGGElement, 'mouseout', this,\n          this.deleteMouseOut_);\n      browserEvents.conditionalBind(\n          this.deleteGroup_ as SVGGElement, 'mouseup', this,\n          this.deleteMouseUp_);\n    }\n  }\n\n  /**\n   * Create the text area for the comment.\n   *\n   * @returns The top-level node of the editor.\n   */\n  private createEditor_(): Element {\n    /* Create the editor.  Here's the markup that will be generated:\n          <foreignObject class=\"blocklyCommentForeignObject\" x=\"0\" y=\"10\"\n          width=\"164\" height=\"164\"> <body xmlns=\"http://www.w3.org/1999/xhtml\"\n          class=\"blocklyMinimalBody\"> <textarea\n       xmlns=\"http://www.w3.org/1999/xhtml\" class=\"blocklyCommentTextarea\"\n                  style=\"height: 164px; width: 164px;\"></textarea>\n            </body>\n          </foreignObject>\n        */\n    this.foreignObject_ = dom.createSvgElement(Svg.FOREIGNOBJECT, {\n      'x': 0,\n      'y': WorkspaceCommentSvg.TOP_OFFSET,\n      'class': 'blocklyCommentForeignObject',\n    });\n    const body = document.createElementNS(dom.HTML_NS, 'body');\n    body.setAttribute('xmlns', dom.HTML_NS);\n    body.className = 'blocklyMinimalBody';\n    const textarea = document.createElementNS(dom.HTML_NS, 'textarea') as\n        HTMLTextAreaElement;\n    textarea.className = 'blocklyCommentTextarea';\n    textarea.setAttribute('dir', this.RTL ? 'RTL' : 'LTR');\n    textarea.readOnly = !this.isEditable();\n    body.appendChild(textarea);\n    this.textarea_ = textarea;\n    this.foreignObject_!.appendChild(body);\n    // Don't zoom with mousewheel.\n    browserEvents.conditionalBind(\n        textarea, 'wheel', this, function(e: AnyDuringMigration) {\n          e.stopPropagation();\n        });\n    browserEvents.conditionalBind(\n        textarea, 'change', this,\n        function(this: WorkspaceCommentSvg, _e: Event) {\n          this.setContent(textarea.value);\n        });\n    // AnyDuringMigration because:  Type 'SVGForeignObjectElement | null' is not\n    // assignable to type 'Element'.\n    return this.foreignObject_ as AnyDuringMigration;\n  }\n\n  /** Add the resize icon to the DOM */\n  private addResizeDom_() {\n    this.resizeGroup_ = dom.createSvgElement(\n        Svg.G, {'class': this.RTL ? 'blocklyResizeSW' : 'blocklyResizeSE'},\n        this.svgGroup_);\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'Element | undefined'.\n    dom.createSvgElement(\n        Svg.POLYGON,\n        {'points': '0,x x,x x,0'.replace(/x/g, RESIZE_SIZE.toString())},\n        this.resizeGroup_ as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'Element | undefined'.\n    dom.createSvgElement(\n        Svg.LINE, {\n          'class': 'blocklyResizeLine',\n          'x1': RESIZE_SIZE / 3,\n          'y1': RESIZE_SIZE - 1,\n          'x2': RESIZE_SIZE - 1,\n          'y2': RESIZE_SIZE / 3,\n        },\n        this.resizeGroup_ as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'Element | undefined'.\n    dom.createSvgElement(\n        Svg.LINE, {\n          'class': 'blocklyResizeLine',\n          'x1': RESIZE_SIZE * 2 / 3,\n          'y1': RESIZE_SIZE - 1,\n          'x2': RESIZE_SIZE - 1,\n          'y2': RESIZE_SIZE * 2 / 3,\n        },\n        this.resizeGroup_ as AnyDuringMigration);\n  }\n\n  /** Add the delete icon to the DOM */\n  private addDeleteDom_() {\n    this.deleteGroup_ = dom.createSvgElement(\n        Svg.G, {'class': 'blocklyCommentDeleteIcon'}, this.svgGroup_);\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'Element | undefined'.\n    this.deleteIconBorder_ = dom.createSvgElement(\n        Svg.CIRCLE,\n        {'class': 'blocklyDeleteIconShape', 'r': '7', 'cx': '7.5', 'cy': '7.5'},\n        this.deleteGroup_ as AnyDuringMigration);\n    // x icon.\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'Element | undefined'.\n    dom.createSvgElement(\n        Svg.LINE, {\n          'x1': '5',\n          'y1': '10',\n          'x2': '10',\n          'y2': '5',\n          'stroke': '#fff',\n          'stroke-width': '2',\n        },\n        this.deleteGroup_ as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'Element | undefined'.\n    dom.createSvgElement(\n        Svg.LINE, {\n          'x1': '5',\n          'y1': '5',\n          'x2': '10',\n          'y2': '10',\n          'stroke': '#fff',\n          'stroke-width': '2',\n        },\n        this.deleteGroup_ as AnyDuringMigration);\n  }\n\n  /**\n   * Handle a mouse-down on comment's resize corner.\n   *\n   * @param e Mouse down event.\n   */\n  private resizeMouseDown_(e: MouseEvent) {\n    this.unbindDragEvents_();\n    if (browserEvents.isRightButton(e)) {\n      // No right-click.\n      e.stopPropagation();\n      return;\n    }\n    // Left-click (or middle click)\n    this.workspace.startDrag(\n        e,\n        new Coordinate(\n            this.workspace.RTL ? -this.width_ : this.width_, this.height_));\n\n    this.onMouseUpWrapper_ = browserEvents.conditionalBind(\n        document, 'mouseup', this, this.resizeMouseUp_);\n    this.onMouseMoveWrapper_ = browserEvents.conditionalBind(\n        document, 'mousemove', this, this.resizeMouseMove_);\n    this.workspace.hideChaff();\n    // This event has been handled.  No need to bubble up to the document.\n    e.stopPropagation();\n  }\n\n  /**\n   * Handle a mouse-down on comment's delete icon.\n   *\n   * @param e Mouse down event.\n   */\n  private deleteMouseDown_(e: Event) {\n    // Highlight the delete icon.\n    dom.addClass(\n        this.deleteIconBorder_ as Element, 'blocklyDeleteIconHighlighted');\n    // This event has been handled.  No need to bubble up to the document.\n    e.stopPropagation();\n  }\n\n  /**\n   * Handle a mouse-out on comment's delete icon.\n   *\n   * @param _e Mouse out event.\n   */\n  private deleteMouseOut_(_e: Event) {\n    // Restore highlight on the delete icon.\n    dom.removeClass(\n        this.deleteIconBorder_ as Element, 'blocklyDeleteIconHighlighted');\n  }\n\n  /**\n   * Handle a mouse-up on comment's delete icon.\n   *\n   * @param e Mouse up event.\n   */\n  private deleteMouseUp_(e: Event) {\n    // Delete this comment.\n    this.dispose();\n    // This event has been handled.  No need to bubble up to the document.\n    e.stopPropagation();\n  }\n\n  /** Stop binding to the global mouseup and mousemove events. */\n  private unbindDragEvents_() {\n    if (this.onMouseUpWrapper_) {\n      browserEvents.unbind(this.onMouseUpWrapper_);\n      this.onMouseUpWrapper_ = null;\n    }\n    if (this.onMouseMoveWrapper_) {\n      browserEvents.unbind(this.onMouseMoveWrapper_);\n      this.onMouseMoveWrapper_ = null;\n    }\n  }\n\n  /**\n   * Handle a mouse-up event while dragging a comment's border or resize handle.\n   *\n   * @param _e Mouse up event.\n   */\n  private resizeMouseUp_(_e: Event) {\n    Touch.clearTouchIdentifier();\n    this.unbindDragEvents_();\n  }\n\n  /**\n   * Resize this comment to follow the mouse.\n   *\n   * @param e Mouse move event.\n   */\n  private resizeMouseMove_(e: MouseEvent) {\n    this.autoLayout_ = false;\n    const newXY = this.workspace.moveDrag(e);\n    this.setSize_(this.RTL ? -newXY.x : newXY.x, newXY.y);\n  }\n\n  /**\n   * Callback function triggered when the comment has resized.\n   * Resize the text area accordingly.\n   */\n  private resizeComment_() {\n    const size = this.getHeightWidth();\n    const topOffset = WorkspaceCommentSvg.TOP_OFFSET;\n    const textOffset = TEXTAREA_OFFSET * 2;\n\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.foreignObject_!.setAttribute(\n        'width', size.width as AnyDuringMigration);\n    this.foreignObject_!.setAttribute(\n        'height', (size.height - topOffset).toString());\n    if (this.RTL) {\n      this.foreignObject_!.setAttribute('x', (-size.width).toString());\n    }\n    this.textarea_!.style.width = size.width - textOffset + 'px';\n    this.textarea_!.style.height = size.height - textOffset - topOffset + 'px';\n  }\n\n  /**\n   * Set size\n   *\n   * @param width width of the container\n   * @param height height of the container\n   */\n  private setSize_(width: number, height: number) {\n    // Minimum size of a comment.\n    width = Math.max(width, 45);\n    height = Math.max(height, 20 + WorkspaceCommentSvg.TOP_OFFSET);\n    this.width_ = width;\n    this.height_ = height;\n    this.svgRect_.setAttribute('width', width);\n    this.svgRect_.setAttribute('height', height);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.svgRectTarget_!.setAttribute('width', width as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.svgRectTarget_!.setAttribute('height', height as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.svgHandleTarget_!.setAttribute('width', width as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.svgHandleTarget_!.setAttribute(\n        'height', WorkspaceCommentSvg.TOP_OFFSET as AnyDuringMigration);\n    if (this.RTL) {\n      this.svgRect_.setAttribute('transform', 'scale(-1 1)');\n      this.svgRectTarget_!.setAttribute('transform', 'scale(-1 1)');\n    }\n\n    if (this.resizeGroup_) {\n      if (this.RTL) {\n        // Mirror the resize group.\n        this.resizeGroup_.setAttribute(\n            'transform',\n            'translate(' + (-width + RESIZE_SIZE) + ',' +\n                (height - RESIZE_SIZE) + ') scale(-1 1)');\n        this.deleteGroup_!.setAttribute(\n            'transform',\n            'translate(' + (-width + RESIZE_SIZE) + ',' + -RESIZE_SIZE +\n                ') scale(-1 1)');\n      } else {\n        this.resizeGroup_.setAttribute(\n            'transform',\n            'translate(' + (width - RESIZE_SIZE) + ',' +\n                (height - RESIZE_SIZE) + ')');\n        this.deleteGroup_!.setAttribute(\n            'transform',\n            'translate(' + (width - RESIZE_SIZE) + ',' + -RESIZE_SIZE + ')');\n      }\n    }\n\n    // Allow the contents to resize.\n    this.resizeComment_();\n  }\n\n  /** Dispose of any rendered comment components. */\n  private disposeInternal_() {\n    this.textarea_ = null;\n    this.foreignObject_ = null;\n    this.svgRectTarget_ = null;\n    this.svgHandleTarget_ = null;\n    this.disposed_ = true;\n  }\n\n  /**\n   * Set the focus on the text area.\n   *\n   * @internal\n   */\n  setFocus() {\n    this.focused_ = true;\n    // Defer CSS changes.\n    setTimeout(() => {\n      if (this.disposed_) {\n        return;\n      }\n      this.textarea_!.focus();\n      this.addFocus();\n      dom.addClass(\n          this.svgRectTarget_ as SVGRectElement, 'blocklyCommentTargetFocused');\n      dom.addClass(\n          this.svgHandleTarget_ as SVGRectElement,\n          'blocklyCommentHandleTargetFocused');\n    }, 0);\n  }\n\n  /**\n   * Remove focus from the text area.\n   *\n   * @internal\n   */\n  blurFocus() {\n    this.focused_ = false;\n    // Defer CSS changes.\n    setTimeout(() => {\n      if (this.disposed_) {\n        return;\n      }\n\n      this.textarea_!.blur();\n      this.removeFocus();\n      dom.removeClass(\n          this.svgRectTarget_ as SVGRectElement, 'blocklyCommentTargetFocused');\n      dom.removeClass(\n          this.svgHandleTarget_ as SVGRectElement,\n          'blocklyCommentHandleTargetFocused');\n    }, 0);\n  }\n\n  /**\n   * Decode an XML comment tag and create a rendered comment on the workspace.\n   *\n   * @param xmlComment XML comment element.\n   * @param workspace The workspace.\n   * @param opt_wsWidth The width of the workspace, which is used to position\n   *     comments correctly in RTL.\n   * @returns The created workspace comment.\n   * @internal\n   */\n  static fromXmlRendered(\n      xmlComment: Element, workspace: WorkspaceSvg,\n      opt_wsWidth?: number): WorkspaceCommentSvg {\n    eventUtils.disable();\n    let comment;\n    try {\n      const info = WorkspaceComment.parseAttributes(xmlComment);\n\n      comment = new WorkspaceCommentSvg(\n          workspace, info.content, info.h, info.w, info.id);\n      if (workspace.rendered) {\n        comment.initSvg(true);\n        comment.render();\n      }\n      // Position the comment correctly, taking into account the width of a\n      // rendered RTL workspace.\n      if (!isNaN(info.x) && !isNaN(info.y)) {\n        if (workspace.RTL) {\n          const wsWidth = opt_wsWidth || workspace.getWidth();\n          comment.moveBy(wsWidth - info.x, info.y);\n        } else {\n          comment.moveBy(info.x, info.y);\n        }\n      }\n    } finally {\n      eventUtils.enable();\n    }\n\n    WorkspaceComment.fireCreateEvent((comment));\n    return comment;\n  }\n}\n\n/** CSS for workspace comment.  See css.js for use. */\nCss.register(`\n.blocklyCommentForeignObject {\n  position: relative;\n  z-index: 0;\n}\n\n.blocklyCommentRect {\n  fill: #E7DE8E;\n  stroke: #bcA903;\n  stroke-width: 1px;\n}\n\n.blocklyCommentTarget {\n  fill: transparent;\n  stroke: #bcA903;\n}\n\n.blocklyCommentTargetFocused {\n  fill: none;\n}\n\n.blocklyCommentHandleTarget {\n  fill: none;\n}\n\n.blocklyCommentHandleTargetFocused {\n  fill: transparent;\n}\n\n.blocklyFocused>.blocklyCommentRect {\n  fill: #B9B272;\n  stroke: #B9B272;\n}\n\n.blocklySelected>.blocklyCommentTarget {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCommentDeleteIcon {\n  cursor: pointer;\n  fill: #000;\n  display: none;\n}\n\n.blocklySelected > .blocklyCommentDeleteIcon {\n  display: block;\n}\n\n.blocklyDeleteIconShape {\n  fill: #000;\n  stroke: #000;\n  stroke-width: 1px;\n}\n\n.blocklyDeleteIconShape.blocklyDeleteIconHighlighted {\n  stroke: #fc3;\n}\n`);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Base class for all types of block events.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.BlockBase');\n\nimport type {Block} from '../block.js';\n\nimport {Abstract as AbstractEvent} from './events_abstract.js';\n\n\n/**\n * Abstract class for a block event.\n *\n * @alias Blockly.Events.BlockBase\n */\nexport class BlockBase extends AbstractEvent {\n  override isBlank: AnyDuringMigration;\n  blockId: string;\n  override workspaceId: string;\n\n  /**\n   * @param opt_block The block this event corresponds to.\n   *     Undefined for a blank event.\n   */\n  constructor(opt_block?: Block) {\n    super();\n    this.isBlank = typeof opt_block === 'undefined';\n\n    /** The block ID for the block this event pertains to */\n    this.blockId = this.isBlank ? '' : opt_block!.id;\n\n    /** The workspace identifier for this event. */\n    this.workspaceId = this.isBlank ? '' : opt_block!.workspace.id;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['blockId'] = this.blockId;\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.blockId = json['blockId'];\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block change event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.BlockChange');\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport * as registry from '../registry.js';\nimport * as Xml from '../xml.js';\n\nimport {BlockBase} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a block change event.\n *\n * @alias Blockly.Events.BlockChange\n */\nexport class BlockChange extends BlockBase {\n  override type: string;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  element!: string;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  name!: string|null;\n  oldValue: AnyDuringMigration;\n  newValue: AnyDuringMigration;\n\n  /**\n   * @param opt_block The changed block.  Undefined for a blank event.\n   * @param opt_element One of 'field', 'comment', 'disabled', etc.\n   * @param opt_name Name of input or field affected, or null.\n   * @param opt_oldValue Previous value of element.\n   * @param opt_newValue New value of element.\n   */\n  constructor(\n      opt_block?: Block, opt_element?: string, opt_name?: string|null,\n      opt_oldValue?: AnyDuringMigration, opt_newValue?: AnyDuringMigration) {\n    super(opt_block);\n\n    /** Type of this event. */\n    this.type = eventUtils.BLOCK_CHANGE;\n\n    if (!opt_block) {\n      return;  // Blank event to be populated by fromJson.\n    }\n    this.element = typeof opt_element === 'undefined' ? '' : opt_element;\n    this.name = typeof opt_name === 'undefined' ? '' : opt_name;\n    this.oldValue = typeof opt_oldValue === 'undefined' ? '' : opt_oldValue;\n    this.newValue = typeof opt_newValue === 'undefined' ? '' : opt_newValue;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['element'] = this.element;\n    if (this.name) {\n      json['name'] = this.name;\n    }\n    json['oldValue'] = this.oldValue;\n    json['newValue'] = this.newValue;\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.element = json['element'];\n    this.name = json['name'];\n    this.oldValue = json['oldValue'];\n    this.newValue = json['newValue'];\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return this.oldValue === this.newValue;\n  }\n\n  /**\n   * Run a change event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    const block = workspace.getBlockById(this.blockId);\n    if (!block) {\n      console.warn('Can\\'t change non-existent block: ' + this.blockId);\n      return;\n    }\n    // Assume the block is rendered so that then we can check.\n    const blockSvg = block as BlockSvg;\n    if (blockSvg.mutator) {\n      // Close the mutator (if open) since we don't want to update it.\n      blockSvg.mutator.setVisible(false);\n    }\n    const value = forward ? this.newValue : this.oldValue;\n    switch (this.element) {\n      case 'field': {\n        const field = block.getField(this.name!);\n        if (field) {\n          field.setValue(value);\n        } else {\n          console.warn('Can\\'t set non-existent field: ' + this.name);\n        }\n        break;\n      }\n      case 'comment':\n        block.setCommentText(value as string || null);\n        break;\n      case 'collapsed':\n        block.setCollapsed(!!value);\n        break;\n      case 'disabled':\n        block.setEnabled(!value);\n        break;\n      case 'inline':\n        block.setInputsInline(!!value);\n        break;\n      case 'mutation': {\n        const oldState = BlockChange.getExtraBlockState_(block as BlockSvg);\n        if (block.loadExtraState) {\n          block.loadExtraState(JSON.parse(value as string || '{}'));\n        } else if (block.domToMutation) {\n          block.domToMutation(Xml.textToDom(value as string || '<mutation/>'));\n        }\n        eventUtils.fire(\n            new BlockChange(block, 'mutation', null, oldState, value));\n        break;\n      }\n      default:\n        console.warn('Unknown change type: ' + this.element);\n    }\n  }\n\n  // TODO (#5397): Encapsulate this in the BlocklyMutationChange event when\n  //    refactoring change events.\n  /**\n   * Returns the extra state of the given block (either as XML or a JSO,\n   * depending on the block's definition).\n   *\n   * @param block The block to get the extra state of.\n   * @returns A stringified version of the extra state of the given block.\n   * @internal\n   */\n  static getExtraBlockState_(block: BlockSvg): string {\n    if (block.saveExtraState) {\n      const state = block.saveExtraState();\n      return state ? JSON.stringify(state) : '';\n    } else if (block.mutationToDom) {\n      const state = block.mutationToDom();\n      return state ? Xml.domToText(state) : '';\n    }\n    return '';\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.CHANGE, BlockChange);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Contains custom errors thrown by the serialization system.\n *\n * @namespace Blockly.serialization.exceptions\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.serialization.exceptions');\n\nimport type {Block} from '../block.js';\nimport type {State} from './blocks.js';\n\n\n/** @alias Blockly.serialization.exceptions.DeserializationError */\nexport class DeserializationError extends Error {}\n\n/**\n * Represents an error where the serialized state is expected to provide a\n * block type, but it is not provided.\n *\n * @alias Blockly.serialization.exceptions.MissingBlockType\n */\nexport class MissingBlockType extends DeserializationError {\n  /**\n   * @param state The state object which is missing the block type.\n   * @internal\n   */\n  constructor(public state: State) {\n    super(`Expected to find a 'type' property, defining the block type`);\n  }\n}\n\n/**\n * Represents an error where deserialization encountered a block that did\n * not have a connection that was defined in the serialized state.\n *\n * @alias Blockly.serialization.exceptions.MissingConnection\n */\nexport class MissingConnection extends DeserializationError {\n  /**\n   * @param connection The name of the connection that is missing. E.g.\n   *     'IF0', or 'next'.\n   * @param block The block missing the connection.\n   * @param state The state object containing the bad connection.\n   * @internal\n   */\n  constructor(connection: string, public block: Block, public state: State) {\n    super(`The block ${block.toDevString()} is missing a(n) ${connection}\nconnection`);\n  }\n}\n\n/**\n * Represents an error where deserialization tried to connect two connections\n * that were not compatible.\n *\n * @alias Blockly.serialization.exceptions.BadConnectionCheck\n */\nexport class BadConnectionCheck extends DeserializationError {\n  /**\n   * @param reason The reason the connections were not compatible.\n   * @param childConnection The name of the incompatible child connection. E.g.\n   *     'output' or 'previous'.\n   * @param childBlock The child block that could not connect to its parent.\n   * @param childState The state object representing the child block.\n   * @internal\n   */\n  constructor(\n      reason: string, childConnection: string, public childBlock: Block,\n      public childState: State) {\n    super(`The block ${childBlock.toDevString()} could not connect its\n${childConnection} to its parent, because: ${reason}`);\n  }\n}\n\n/**\n * Represents an error where deserialization encountered a real block as it\n * was deserializing children of a shadow.\n * This is an error because it is an invariant of Blockly that shadow blocks\n * do not have real children.\n *\n * @alias Blockly.serialization.exceptions.RealChildOfShadow\n */\nexport class RealChildOfShadow extends DeserializationError {\n  /**\n   * @param state The state object representing the real block.\n   * @internal\n   */\n  constructor(public state: State) {\n    super(`Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren`);\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The top level namespace for priorities of plugin serializers.\n * Includes constants for the priorities of different plugin serializers. Higher\n * priorities are deserialized first.\n *\n * @namespace Blockly.serialization.priorities\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.serialization.priorities');\n\n\n/**\n * The priority for deserializing variables.\n *\n * @alias Blockly.serialization.priorities.VARIABLES\n */\nexport const VARIABLES = 100;\n/**\n * The priority for deserializing blocks.\n *\n * @alias Blockly.serialization.priorities.BLOCKS\n */\nexport const BLOCKS = 50;\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block creation event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.BlockCreate');\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport * as blocks from '../serialization/blocks.js';\nimport * as Xml from '../xml.js';\n\nimport {BlockBase} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a block creation event.\n *\n * @alias Blockly.Events.BlockCreate\n */\nexport class BlockCreate extends BlockBase {\n  override type: string;\n  xml: AnyDuringMigration;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  ids!: string[];\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  json!: blocks.State;\n\n  /** @param opt_block The created block.  Undefined for a blank event. */\n  constructor(opt_block?: Block) {\n    super(opt_block);\n\n    /** Type of this event. */\n    this.type = eventUtils.BLOCK_CREATE;\n\n    if (!opt_block) {\n      return;  // Blank event to be populated by fromJson.\n    }\n\n    if (opt_block.isShadow()) {\n      // Moving shadow blocks is handled via disconnection.\n      this.recordUndo = false;\n    }\n\n    this.xml = Xml.blockToDomWithXY(opt_block);\n    this.ids = eventUtils.getDescendantIds(opt_block);\n\n    /** JSON representation of the block that was just created. */\n    this.json = blocks.save(opt_block, {addCoordinates: true}) as blocks.State;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['xml'] = Xml.domToText(this.xml);\n    json['ids'] = this.ids;\n    json['json'] = this.json;\n    if (!this.recordUndo) {\n      json['recordUndo'] = this.recordUndo;\n    }\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.xml = Xml.textToDom(json['xml']);\n    this.ids = json['ids'];\n    this.json = json['json'] as blocks.State;\n    if (json['recordUndo'] !== undefined) {\n      this.recordUndo = json['recordUndo'];\n    }\n  }\n\n  /**\n   * Run a creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (forward) {\n      blocks.append(this.json, workspace);\n    } else {\n      for (let i = 0; i < this.ids.length; i++) {\n        const id = this.ids[i];\n        const block = workspace.getBlockById(id);\n        if (block) {\n          block.dispose(false);\n        } else if (id === this.blockId) {\n          // Only complain about root-level block.\n          console.warn('Can\\'t uncreate non-existent block: ' + id);\n        }\n      }\n    }\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.CREATE, BlockCreate);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block delete event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.BlockDelete');\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport * as blocks from '../serialization/blocks.js';\nimport * as Xml from '../xml.js';\n\nimport {BlockBase} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a block deletion event.\n *\n * @alias Blockly.Events.BlockDelete\n */\nexport class BlockDelete extends BlockBase {\n  override type: string;\n  oldXml: AnyDuringMigration;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  ids!: string[];\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  wasShadow!: boolean;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  oldJson!: blocks.State;\n\n  /** @param opt_block The deleted block.  Undefined for a blank event. */\n  constructor(opt_block?: Block) {\n    super(opt_block);\n\n    /** Type of this event. */\n    this.type = eventUtils.BLOCK_DELETE;\n\n    if (!opt_block) {\n      return;  // Blank event to be populated by fromJson.\n    }\n\n    if (opt_block.getParent()) {\n      throw Error('Connected blocks cannot be deleted.');\n    }\n    if (opt_block.isShadow()) {\n      // Respawning shadow blocks is handled via disconnection.\n      this.recordUndo = false;\n    }\n\n    this.oldXml = Xml.blockToDomWithXY(opt_block);\n    this.ids = eventUtils.getDescendantIds(opt_block);\n\n    /** Was the block that was just deleted a shadow? */\n    this.wasShadow = opt_block.isShadow();\n\n    /** JSON representation of the block that was just deleted. */\n    this.oldJson =\n        blocks.save(opt_block, {addCoordinates: true}) as blocks.State;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['oldXml'] = Xml.domToText(this.oldXml);\n    json['ids'] = this.ids;\n    json['wasShadow'] = this.wasShadow;\n    json['oldJson'] = this.oldJson;\n    if (!this.recordUndo) {\n      json['recordUndo'] = this.recordUndo;\n    }\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.oldXml = Xml.textToDom(json['oldXml']);\n    this.ids = json['ids'];\n    this.wasShadow =\n        json['wasShadow'] || this.oldXml.tagName.toLowerCase() === 'shadow';\n    this.oldJson = json['oldJson'] as blocks.State;\n    if (json['recordUndo'] !== undefined) {\n      this.recordUndo = json['recordUndo'];\n    }\n  }\n\n  /**\n   * Run a deletion event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (forward) {\n      for (let i = 0; i < this.ids.length; i++) {\n        const id = this.ids[i];\n        const block = workspace.getBlockById(id);\n        if (block) {\n          block.dispose(false);\n        } else if (id === this.blockId) {\n          // Only complain about root-level block.\n          console.warn('Can\\'t delete non-existent block: ' + id);\n        }\n      }\n    } else {\n      blocks.append(this.oldJson, workspace);\n    }\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.DELETE, BlockDelete);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An enum for the possible types of connections.\n *\n * @namespace Blockly.ConnectionType\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ConnectionType');\n\n\n/**\n * Enum for the type of a connection or input.\n *\n * @alias Blockly.ConnectionType\n */\nexport enum ConnectionType {\n  // A right-facing value input.  E.g. 'set item to' or 'return'.\n  INPUT_VALUE = 1,\n  // A left-facing value output.  E.g. 'random fraction'.\n  OUTPUT_VALUE,\n  // A down-facing block stack.  E.g. 'if-do' or 'else'.\n  NEXT_STATEMENT,\n  // An up-facing block stack.  E.g. 'break out of loop'.\n  PREVIOUS_STATEMENT\n}\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Blockly constants.\n *\n * @namespace Blockly.constants\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.constants');\n\n\n/**\n * The language-neutral ID given to the collapsed input.\n *\n * @alias Blockly.constants.COLLAPSED_INPUT_NAME\n */\nexport const COLLAPSED_INPUT_NAME = '_TEMP_COLLAPSED_INPUT';\n\n/**\n * The language-neutral ID given to the collapsed field.\n *\n * @alias Blockly.constants.COLLAPSED_FIELD_NAME\n */\nexport const COLLAPSED_FIELD_NAME = '_TEMP_COLLAPSED_FIELD';\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object in charge of managing markers and the cursor.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.MarkerManager');\n\nimport type {Cursor} from './keyboard_nav/cursor.js';\nimport type {Marker} from './keyboard_nav/marker.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Class to manage the multiple markers and the cursor on a workspace.\n *\n * @alias Blockly.MarkerManager\n */\nexport class MarkerManager {\n  /** The name of the local marker. */\n  static readonly LOCAL_MARKER = 'local_marker_1';\n\n  /** The cursor. */\n  private cursor_: Cursor|null = null;\n\n  /** The cursor's SVG element. */\n  private cursorSvg_: SVGElement|null = null;\n\n  /** The map of markers for the workspace. */\n  private markers = new Map<string, Marker>();\n\n  /** The marker's SVG element. */\n  private markerSvg_: SVGElement|null = null;\n\n  /**\n   * @param workspace The workspace for the marker manager.\n   * @internal\n   */\n  constructor(private readonly workspace: WorkspaceSvg) {}\n\n  /**\n   * Register the marker by adding it to the map of markers.\n   *\n   * @param id A unique identifier for the marker.\n   * @param marker The marker to register.\n   */\n  registerMarker(id: string, marker: Marker) {\n    if (this.markers.has(id)) {\n      this.unregisterMarker(id);\n    }\n    marker.setDrawer(\n        this.workspace.getRenderer().makeMarkerDrawer(this.workspace, marker));\n    this.setMarkerSvg(marker.getDrawer().createDom());\n    this.markers.set(id, marker);\n  }\n\n  /**\n   * Unregister the marker by removing it from the map of markers.\n   *\n   * @param id The ID of the marker to unregister.\n   */\n  unregisterMarker(id: string) {\n    const marker = this.markers.get(id);\n    if (marker) {\n      marker.dispose();\n      this.markers.delete(id);\n    } else {\n      throw Error(\n          'Marker with ID ' + id + ' does not exist. ' +\n          'Can only unregister markers that exist.');\n    }\n  }\n\n  /**\n   * Get the cursor for the workspace.\n   *\n   * @returns The cursor for this workspace.\n   */\n  getCursor(): Cursor|null {\n    return this.cursor_;\n  }\n\n  /**\n   * Get a single marker that corresponds to the given ID.\n   *\n   * @param id A unique identifier for the marker.\n   * @returns The marker that corresponds to the given ID, or null if none\n   *     exists.\n   */\n  getMarker(id: string): Marker|null {\n    return this.markers.get(id) || null;\n  }\n\n  /**\n   * Sets the cursor and initializes the drawer for use with keyboard\n   * navigation.\n   *\n   * @param cursor The cursor used to move around this workspace.\n   */\n  setCursor(cursor: Cursor) {\n    if (this.cursor_ && this.cursor_.getDrawer()) {\n      this.cursor_.getDrawer().dispose();\n    }\n    this.cursor_ = cursor;\n    if (this.cursor_) {\n      const drawer = this.workspace.getRenderer().makeMarkerDrawer(\n          this.workspace, this.cursor_);\n      this.cursor_.setDrawer(drawer);\n      this.setCursorSvg(this.cursor_.getDrawer().createDom());\n    }\n  }\n\n  /**\n   * Add the cursor SVG to this workspace SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement|null) {\n    if (!cursorSvg) {\n      this.cursorSvg_ = null;\n      return;\n    }\n\n    this.workspace.getBlockCanvas()!.appendChild(cursorSvg);\n    this.cursorSvg_ = cursorSvg;\n  }\n\n  /**\n   * Add the marker SVG to this workspaces SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement|null) {\n    if (!markerSvg) {\n      this.markerSvg_ = null;\n      return;\n    }\n\n    if (this.workspace.getBlockCanvas()) {\n      if (this.cursorSvg_) {\n        this.workspace.getBlockCanvas()!.insertBefore(\n            markerSvg, this.cursorSvg_);\n      } else {\n        this.workspace.getBlockCanvas()!.appendChild(markerSvg);\n      }\n    }\n  }\n\n  /**\n   * Redraw the attached cursor SVG if needed.\n   *\n   * @internal\n   */\n  updateMarkers() {\n    if (this.workspace.keyboardAccessibilityMode && this.cursorSvg_) {\n      this.workspace.getCursor()!.draw();\n    }\n  }\n\n  /**\n   * Dispose of the marker manager.\n   * Go through and delete all markers associated with this marker manager.\n   *\n   * @suppress {checkTypes}\n   * @internal\n   */\n  dispose() {\n    const markerIds = Object.keys(this.markers);\n    for (let i = 0, markerId; markerId = markerIds[i]; i++) {\n      this.unregisterMarker(markerId);\n    }\n    this.markers.clear();\n    if (this.cursor_) {\n      this.cursor_.dispose();\n      this.cursor_ = null;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A type used to create flag values.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.Sentinel');\n\n\n/**\n * A type used to create flag values.\n *\n * @alias Blockly.utils.Sentinel\n */\nexport class Sentinel {}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Field.  Used for editable titles, variables, etc.\n * This is an abstract class that defines the UI on the block.  Actual\n * instances would be FieldTextInput, FieldDropdown, etc.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Field');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Input} from './input.js';\nimport type {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport type {IASTNodeLocationWithBlock} from './interfaces/i_ast_node_location_with_block.js';\nimport type {IKeyboardAccessible} from './interfaces/i_keyboard_accessible.js';\nimport type {IRegistrable} from './interfaces/i_registrable.js';\nimport {MarkerManager} from './marker_manager.js';\nimport type {ConstantProvider} from './renderers/common/constants.js';\nimport type {KeyboardShortcut} from './shortcut_registry.js';\nimport * as Tooltip from './tooltip.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport {Rect} from './utils/rect.js';\nimport {Sentinel} from './utils/sentinel.js';\nimport {Size} from './utils/size.js';\nimport * as style from './utils/style.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as utilsXml from './utils/xml.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as Xml from './xml.js';\n\n\n/**\n * Abstract class for an editable field.\n *\n * @alias Blockly.Field\n */\nexport abstract class Field implements IASTNodeLocationSvg,\n                                       IASTNodeLocationWithBlock,\n                                       IKeyboardAccessible, IRegistrable {\n  /** The default value for this field. */\n  protected DEFAULT_VALUE: any = null;\n\n  /** Non-breaking space. */\n  static readonly NBSP = '\\u00A0';\n\n  /**\n   * A value used to signal when a field's constructor should *not* set the\n   * field's value or run configure_, and should allow a subclass to do that\n   * instead.\n   */\n  static readonly SKIP_SETUP = new Sentinel();\n\n  /**\n   * Name of field.  Unique within each block.\n   * Static labels are usually unnamed.\n   */\n  name?: string = undefined;\n  protected value_: AnyDuringMigration;\n\n  /** Validation function called when user edits an editable field. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'Function'.\n  protected validator_: Function = null as AnyDuringMigration;\n\n  /**\n   * Used to cache the field's tooltip value if setTooltip is called when the\n   * field is not yet initialized. Is *not* guaranteed to be accurate.\n   */\n  private tooltip_: Tooltip.TipInfo|null = null;\n  protected size_: Size;\n\n  /**\n   * Holds the cursors svg element when the cursor is attached to the field.\n   * This is null if there is no cursor on the field.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGElement'.\n  private cursorSvg_: SVGElement = null as AnyDuringMigration;\n\n  /**\n   * Holds the markers svg element when the marker is attached to the field.\n   * This is null if there is no marker on the field.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGElement'.\n  private markerSvg_: SVGElement = null as AnyDuringMigration;\n\n  /** The rendered field's SVG group element. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGGElement'.\n  protected fieldGroup_: SVGGElement = null as AnyDuringMigration;\n\n  /** The rendered field's SVG border element. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGRectElement'.\n  protected borderRect_: SVGRectElement = null as AnyDuringMigration;\n\n  /** The rendered field's SVG text element. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGTextElement'.\n  protected textElement_: SVGTextElement = null as AnyDuringMigration;\n\n  /** The rendered field's text content element. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type 'Text'.\n  protected textContent_: Text = null as AnyDuringMigration;\n\n  /** Mouse down event listener data. */\n  private mouseDownWrapper_: browserEvents.Data|null = null;\n\n  /** Constants associated with the source block's renderer. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'ConstantProvider'.\n  protected constants_: ConstantProvider = null as AnyDuringMigration;\n\n  /**\n   * Has this field been disposed of?\n   *\n   * @internal\n   */\n  disposed = false;\n\n  /** Maximum characters of text to display before adding an ellipsis. */\n  maxDisplayLength = 50;\n\n  /** Block this field is attached to.  Starts as null, then set in init. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type 'Block'.\n  protected sourceBlock_: Block = null as AnyDuringMigration;\n\n  /** Does this block need to be re-rendered? */\n  protected isDirty_ = true;\n\n  /** Is the field visible, or hidden due to the block being collapsed? */\n  protected visible_ = true;\n\n  /**\n   * Can the field value be changed using the editor on an editable block?\n   */\n  protected enabled_ = true;\n\n  /** The element the click handler is bound to. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'Element'.\n  protected clickTarget_: Element = null as AnyDuringMigration;\n\n  /**\n   * The prefix field.\n   *\n   * @internal\n   */\n  prefixField: string|null = null;\n\n  /**\n   * The suffix field.\n   *\n   * @internal\n   */\n  suffixField: string|null = null;\n\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. They will also be saved by the serializer.\n   */\n  EDITABLE = true;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable. This is not the\n   * case by default so that SERIALIZABLE is backwards compatible.\n   */\n  SERIALIZABLE = false;\n\n  /** Mouse cursor style when over the hotspot that initiates the editor. */\n  CURSOR = '';\n\n  /**\n   * @param value The initial value of the field.\n   *     Also accepts Field.SKIP_SETUP if you wish to skip setup (only used by\n   * subclasses that want to handle configuration and setting the field value\n   * after their own constructors have run).\n   * @param opt_validator  A function that is called to validate changes to the\n   *     field's value. Takes in a value & returns a validated value, or null to\n   *     abort the change.\n   * @param opt_config A map of options used to configure the field.\n   *    Refer to the individual field's documentation for a list of properties\n   * this parameter supports.\n   */\n  constructor(\n      value: AnyDuringMigration, opt_validator?: Function|null,\n      opt_config?: FieldConfig) {\n    /**\n     * A generic value possessed by the field.\n     * Should generally be non-null, only null when the field is created.\n     */\n    this.value_ = (new.target).prototype.DEFAULT_VALUE;\n\n    /** The size of the area rendered by the field. */\n    this.size_ = new Size(0, 0);\n\n    if (value === Field.SKIP_SETUP) {\n      return;\n    }\n    if (opt_config) {\n      this.configure_(opt_config);\n    }\n    this.setValue(value);\n    if (opt_validator) {\n      this.setValidator(opt_validator);\n    }\n  }\n\n  /**\n   * Process the configuration map passed to the field.\n   *\n   * @param config A map of options used to configure the field. See the\n   *     individual field's documentation for a list of properties this\n   *     parameter supports.\n   */\n  protected configure_(config: FieldConfig) {\n    // TODO (#2884): Possibly add CSS class config option.\n    // TODO (#2885): Possibly add cursor config option.\n    if (config.tooltip) {\n      this.setTooltip(parsing.replaceMessageReferences(config.tooltip));\n    }\n  }\n\n  /**\n   * Attach this field to a block.\n   *\n   * @param block The block containing this field.\n   */\n  setSourceBlock(block: Block) {\n    if (this.sourceBlock_) {\n      throw Error('Field already bound to a block');\n    }\n    this.sourceBlock_ = block;\n  }\n\n  /**\n   * Get the renderer constant provider.\n   *\n   * @returns The renderer constant provider.\n   */\n  getConstants(): ConstantProvider|null {\n    if (!this.constants_ && this.sourceBlock_ && !this.sourceBlock_.disposed &&\n        this.sourceBlock_.workspace.rendered) {\n      this.constants_ = (this.sourceBlock_.workspace as WorkspaceSvg)\n                            .getRenderer()\n                            .getConstants();\n    }\n    return this.constants_;\n  }\n\n  /**\n   * Get the block this field is attached to.\n   *\n   * @returns The block containing this field.\n   */\n  getSourceBlock(): Block {\n    return this.sourceBlock_;\n  }\n\n  /**\n   * Initialize everything to render this field. Override\n   * methods initModel and initView rather than this method.\n   *\n   * @sealed\n   * @internal\n   */\n  init() {\n    if (this.fieldGroup_) {\n      // Field has already been initialized once.\n      return;\n    }\n    this.fieldGroup_ = dom.createSvgElement(Svg.G, {});\n    if (!this.isVisible()) {\n      this.fieldGroup_.style.display = 'none';\n    }\n    const sourceBlockSvg = this.sourceBlock_ as BlockSvg;\n    sourceBlockSvg.getSvgRoot().appendChild(this.fieldGroup_);\n    this.initView();\n    this.updateEditable();\n    this.setTooltip(this.tooltip_);\n    this.bindEvents_();\n    this.initModel();\n  }\n\n  /**\n   * Create the block UI for this field.\n   *\n   * @internal\n   */\n  initView() {\n    this.createBorderRect_();\n    this.createTextElement_();\n  }\n\n  /**\n   * Initializes the model of the field after it has been installed on a block.\n   * No-op by default.\n   *\n   * @internal\n   */\n  initModel() {}\n\n  /**\n   * Create a field border rect element. Not to be overridden by subclasses.\n   * Instead modify the result of the function inside initView, or create a\n   * separate function to call.\n   */\n  protected createBorderRect_() {\n    this.borderRect_ = dom.createSvgElement(\n        Svg.RECT, {\n          'rx': this.getConstants()!.FIELD_BORDER_RECT_RADIUS,\n          'ry': this.getConstants()!.FIELD_BORDER_RECT_RADIUS,\n          'x': 0,\n          'y': 0,\n          'height': this.size_.height,\n          'width': this.size_.width,\n          'class': 'blocklyFieldRect',\n        },\n        this.fieldGroup_);\n  }\n\n  /**\n   * Create a field text element. Not to be overridden by subclasses. Instead\n   * modify the result of the function inside initView, or create a separate\n   * function to call.\n   */\n  protected createTextElement_() {\n    this.textElement_ = dom.createSvgElement(\n        Svg.TEXT, {\n          'class': 'blocklyText',\n        },\n        this.fieldGroup_);\n    if (this.getConstants()!.FIELD_TEXT_BASELINE_CENTER) {\n      this.textElement_.setAttribute('dominant-baseline', 'central');\n    }\n    this.textContent_ = document.createTextNode('');\n    this.textElement_.appendChild(this.textContent_);\n  }\n\n  /**\n   * Bind events to the field. Can be overridden by subclasses if they need to\n   * do custom input handling.\n   */\n  protected bindEvents_() {\n    Tooltip.bindMouseEvents(this.getClickTarget_());\n    this.mouseDownWrapper_ = browserEvents.conditionalBind(\n        this.getClickTarget_(), 'mousedown', this, this.onMouseDown_);\n  }\n\n  /**\n   * Sets the field's value based on the given XML element. Should only be\n   * called by Blockly.Xml.\n   *\n   * @param fieldElement The element containing info about the field's state.\n   * @internal\n   */\n  fromXml(fieldElement: Element) {\n    this.setValue(fieldElement.textContent);\n  }\n\n  /**\n   * Serializes this field's value to XML. Should only be called by Blockly.Xml.\n   *\n   * @param fieldElement The element to populate with info about the field's\n   *     state.\n   * @returns The element containing info about the field's state.\n   * @internal\n   */\n  toXml(fieldElement: Element): Element {\n    fieldElement.textContent = this.getValue();\n    return fieldElement;\n  }\n\n  /**\n   * Saves this fields value as something which can be serialized to JSON.\n   * Should only be called by the serialization system.\n   *\n   * @param _doFullSerialization If true, this signals to the field that if it\n   *     normally just saves a reference to some state (eg variable fields) it\n   *     should instead serialize the full state of the thing being referenced.\n   * @returns JSON serializable state.\n   * @internal\n   */\n  saveState(_doFullSerialization?: boolean): AnyDuringMigration {\n    const legacyState = this.saveLegacyState(Field);\n    if (legacyState !== null) {\n      return legacyState;\n    }\n    return this.getValue();\n  }\n\n  /**\n   * Sets the field's state based on the given state value. Should only be\n   * called by the serialization system.\n   *\n   * @param state The state we want to apply to the field.\n   * @internal\n   */\n  loadState(state: AnyDuringMigration) {\n    if (this.loadLegacyState(Field, state)) {\n      return;\n    }\n    this.setValue(state);\n  }\n\n  /**\n   * Returns a stringified version of the XML state, if it should be used.\n   * Otherwise this returns null, to signal the field should use its own\n   * serialization.\n   *\n   * @param callingClass The class calling this method.\n   *     Used to see if `this` has overridden any relevant hooks.\n   * @returns The stringified version of the XML state, or null.\n   */\n  protected saveLegacyState(callingClass: AnyDuringMigration): string|null {\n    if (callingClass.prototype.saveState === this.saveState &&\n        callingClass.prototype.toXml !== this.toXml) {\n      const elem = utilsXml.createElement('field');\n      elem.setAttribute('name', this.name || '');\n      const text = Xml.domToText(this.toXml(elem));\n      return text.replace(\n          ' xmlns=\"https://developers.google.com/blockly/xml\"', '');\n    }\n    // Either they called this on purpose from their saveState, or they have\n    // no implementations of either hook. Just do our thing.\n    return null;\n  }\n\n  /**\n   * Loads the given state using either the old XML hooks, if they should be\n   * used. Returns true to indicate loading has been handled, false otherwise.\n   *\n   * @param callingClass The class calling this method.\n   *     Used to see if `this` has overridden any relevant hooks.\n   * @param state The state to apply to the field.\n   * @returns Whether the state was applied or not.\n   */\n  loadLegacyState(callingClass: AnyDuringMigration, state: AnyDuringMigration):\n      boolean {\n    if (callingClass.prototype.loadState === this.loadState &&\n        callingClass.prototype.fromXml !== this.fromXml) {\n      this.fromXml(Xml.textToDom(state as string));\n      return true;\n    }\n    // Either they called this on purpose from their loadState, or they have\n    // no implementations of either hook. Just do our thing.\n    return false;\n  }\n\n  /**\n   * Dispose of all DOM objects and events belonging to this editable field.\n   *\n   * @internal\n   */\n  dispose() {\n    dropDownDiv.hideIfOwner(this);\n    WidgetDiv.hideIfOwner(this);\n    Tooltip.unbindMouseEvents(this.getClickTarget_());\n\n    if (this.mouseDownWrapper_) {\n      browserEvents.unbind(this.mouseDownWrapper_);\n    }\n\n    dom.removeNode(this.fieldGroup_);\n\n    this.disposed = true;\n  }\n\n  /** Add or remove the UI indicating if this field is editable or not. */\n  updateEditable() {\n    const group = this.fieldGroup_;\n    if (!this.EDITABLE || !group) {\n      return;\n    }\n    if (this.enabled_ && this.sourceBlock_.isEditable()) {\n      dom.addClass(group, 'blocklyEditableText');\n      dom.removeClass(group, 'blocklyNonEditableText');\n      group.style.cursor = this.CURSOR;\n    } else {\n      dom.addClass(group, 'blocklyNonEditableText');\n      dom.removeClass(group, 'blocklyEditableText');\n      group.style.cursor = '';\n    }\n  }\n\n  /**\n   * Set whether this field's value can be changed using the editor when the\n   *     source block is editable.\n   *\n   * @param enabled True if enabled.\n   */\n  setEnabled(enabled: boolean) {\n    this.enabled_ = enabled;\n    this.updateEditable();\n  }\n\n  /**\n   * Check whether this field's value can be changed using the editor when the\n   *     source block is editable.\n   *\n   * @returns Whether this field is enabled.\n   */\n  isEnabled(): boolean {\n    return this.enabled_;\n  }\n\n  /**\n   * Check whether this field defines the showEditor_ function.\n   *\n   * @returns Whether this field is clickable.\n   */\n  isClickable(): boolean {\n    return this.enabled_ && !!this.sourceBlock_ &&\n        this.sourceBlock_.isEditable() &&\n        this.showEditor_ !== Field.prototype.showEditor_;\n  }\n\n  /**\n   * Check whether this field is currently editable.  Some fields are never\n   * EDITABLE (e.g. text labels). Other fields may be EDITABLE but may exist on\n   * non-editable blocks or be currently disabled.\n   *\n   * @returns Whether this field is currently enabled, editable and on an\n   *     editable block.\n   */\n  isCurrentlyEditable(): boolean {\n    return this.enabled_ && this.EDITABLE && !!this.sourceBlock_ &&\n        this.sourceBlock_.isEditable();\n  }\n\n  /**\n   * Check whether this field should be serialized by the XML renderer.\n   * Handles the logic for backwards compatibility and incongruous states.\n   *\n   * @returns Whether this field should be serialized or not.\n   */\n  isSerializable(): boolean {\n    let isSerializable = false;\n    if (this.name) {\n      if (this.SERIALIZABLE) {\n        isSerializable = true;\n      } else if (this.EDITABLE) {\n        console.warn(\n            'Detected an editable field that was not serializable.' +\n            ' Please define SERIALIZABLE property as true on all editable custom' +\n            ' fields. Proceeding with serialization.');\n        isSerializable = true;\n      }\n    }\n    return isSerializable;\n  }\n\n  /**\n   * Gets whether this editable field is visible or not.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.visible_;\n  }\n\n  /**\n   * Sets whether this editable field is visible or not. Should only be called\n   * by input.setVisible.\n   *\n   * @param visible True if visible.\n   * @internal\n   */\n  setVisible(visible: boolean) {\n    if (this.visible_ === visible) {\n      return;\n    }\n    this.visible_ = visible;\n    const root = this.getSvgRoot();\n    if (root) {\n      root.style.display = visible ? 'block' : 'none';\n    }\n  }\n\n  /**\n   * Sets a new validation function for editable fields, or clears a previously\n   * set validator.\n   *\n   * The validator function takes in the new field value, and returns\n   * validated value. The validated value could be the input value, a modified\n   * version of the input value, or null to abort the change.\n   *\n   * If the function does not return anything (or returns undefined) the new\n   * value is accepted as valid. This is to allow for fields using the\n   * validated function as a field-level change event notification.\n   *\n   * @param handler The validator function or null to clear a previous\n   *     validator.\n   */\n  setValidator(handler: Function) {\n    this.validator_ = handler;\n  }\n\n  /**\n   * Gets the validation function for editable fields, or null if not set.\n   *\n   * @returns Validation function, or null.\n   */\n  getValidator(): Function|null {\n    return this.validator_;\n  }\n\n  /**\n   * Gets the group element for this editable field.\n   * Used for measuring the size and for positioning.\n   *\n   * @returns The group element.\n   */\n  getSvgRoot(): SVGGElement {\n    return this.fieldGroup_;\n  }\n\n  /**\n   * Updates the field to match the colour/style of the block. Should only be\n   * called by BlockSvg.applyColour().\n   *\n   * @internal\n   */\n  applyColour() {}\n  // Non-abstract sub-classes may wish to implement this. See FieldDropdown.\n\n  /**\n   * Used by getSize() to move/resize any DOM elements, and get the new size.\n   *\n   * All rendering that has an effect on the size/shape of the block should be\n   * done here, and should be triggered by getSize().\n   */\n  protected render_() {\n    if (this.textContent_) {\n      this.textContent_.nodeValue = this.getDisplayText_();\n    }\n    this.updateSize_();\n  }\n\n  /**\n   * Calls showEditor_ when the field is clicked if the field is clickable.\n   * Do not override.\n   *\n   * @param opt_e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   * @sealed\n   * @internal\n   */\n  showEditor(opt_e?: Event) {\n    if (this.isClickable()) {\n      this.showEditor_(opt_e);\n    }\n  }\n\n  /**\n   * A developer hook to create an editor for the field. This is no-op by\n   * default, and must be overriden to create an editor.\n   *\n   * @param _e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   */\n  protected showEditor_(_e?: Event): void {}\n  // NOP\n\n  /**\n   * Updates the size of the field based on the text.\n   *\n   * @param opt_margin margin to use when positioning the text element.\n   */\n  protected updateSize_(opt_margin?: number) {\n    const constants = this.getConstants();\n    const xOffset = opt_margin !== undefined ? opt_margin :\n        this.borderRect_ ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING :\n                           0;\n    let totalWidth = xOffset * 2;\n    let totalHeight = constants!.FIELD_TEXT_HEIGHT;\n\n    let contentWidth = 0;\n    if (this.textElement_) {\n      contentWidth = dom.getFastTextWidth(\n          this.textElement_, constants!.FIELD_TEXT_FONTSIZE,\n          constants!.FIELD_TEXT_FONTWEIGHT, constants!.FIELD_TEXT_FONTFAMILY);\n      totalWidth += contentWidth;\n    }\n    if (this.borderRect_) {\n      totalHeight = Math.max(totalHeight, constants!.FIELD_BORDER_RECT_HEIGHT);\n    }\n\n    this.size_.height = totalHeight;\n    this.size_.width = totalWidth;\n\n    this.positionTextElement_(xOffset, contentWidth);\n    this.positionBorderRect_();\n  }\n\n  /**\n   * Position a field's text element after a size change.  This handles both LTR\n   * and RTL positioning.\n   *\n   * @param xOffset x offset to use when positioning the text element.\n   * @param contentWidth The content width.\n   */\n  protected positionTextElement_(xOffset: number, contentWidth: number) {\n    if (!this.textElement_) {\n      return;\n    }\n    const constants = this.getConstants();\n    const halfHeight = this.size_.height / 2;\n\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.textElement_.setAttribute(\n        'x',\n        (this.sourceBlock_.RTL ? this.size_.width - contentWidth - xOffset :\n                                 xOffset) as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.textElement_.setAttribute(\n        'y',\n        (constants!.FIELD_TEXT_BASELINE_CENTER ?\n             halfHeight :\n             halfHeight - constants!.FIELD_TEXT_HEIGHT / 2 +\n                 constants!.FIELD_TEXT_BASELINE) as AnyDuringMigration);\n  }\n\n  /** Position a field's border rect after a size change. */\n  protected positionBorderRect_() {\n    if (!this.borderRect_) {\n      return;\n    }\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.borderRect_.setAttribute(\n        'width', this.size_.width as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.borderRect_.setAttribute(\n        'height', this.size_.height as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.borderRect_.setAttribute(\n        'rx',\n        this.getConstants()!.FIELD_BORDER_RECT_RADIUS as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.borderRect_.setAttribute(\n        'ry',\n        this.getConstants()!.FIELD_BORDER_RECT_RADIUS as AnyDuringMigration);\n  }\n\n  /**\n   * Returns the height and width of the field.\n   *\n   * This should *in general* be the only place render_ gets called from.\n   *\n   * @returns Height and width.\n   */\n  getSize(): Size {\n    if (!this.isVisible()) {\n      return new Size(0, 0);\n    }\n\n    if (this.isDirty_) {\n      this.render_();\n      this.isDirty_ = false;\n    } else if (this.visible_ && this.size_.width === 0) {\n      // If the field is not visible the width will be 0 as well, one of the\n      // problems with the old system.\n      console.warn(\n          'Deprecated use of setting size_.width to 0 to rerender a' +\n          ' field. Set field.isDirty_ to true instead.');\n      this.render_();\n    }\n    return this.size_;\n  }\n\n  /**\n   * Returns the bounding box of the rendered field, accounting for workspace\n   * scaling.\n   *\n   * @returns An object with top, bottom, left, and right in pixels relative to\n   *     the top left corner of the page (window coordinates).\n   * @internal\n   */\n  getScaledBBox(): Rect {\n    let scaledWidth;\n    let scaledHeight;\n    let xy;\n    if (!this.borderRect_) {\n      // Browsers are inconsistent in what they return for a bounding box.\n      // - Webkit / Blink: fill-box / object bounding box\n      // - Gecko: stroke-box\n      const bBox = (this.sourceBlock_ as BlockSvg).getHeightWidth();\n      const scale = (this.sourceBlock_.workspace as WorkspaceSvg).scale;\n      xy = this.getAbsoluteXY_();\n      scaledWidth = (bBox.width + 1) * scale;\n      scaledHeight = (bBox.height + 1) * scale;\n\n      if (userAgent.GECKO) {\n        xy.x += 1.5 * scale;\n        xy.y += 1.5 * scale;\n      } else {\n        xy.x -= 0.5 * scale;\n        xy.y -= 0.5 * scale;\n      }\n    } else {\n      const bBox = this.borderRect_.getBoundingClientRect();\n      xy = style.getPageOffset(this.borderRect_);\n      scaledWidth = bBox.width;\n      scaledHeight = bBox.height;\n    }\n    return new Rect(xy.y, xy.y + scaledHeight, xy.x, xy.x + scaledWidth);\n  }\n\n  /**\n   * Get the text from this field to display on the block. May differ from\n   * `getText` due to ellipsis, and other formatting.\n   *\n   * @returns Text to display.\n   */\n  protected getDisplayText_(): string {\n    let text = this.getText();\n    if (!text) {\n      // Prevent the field from disappearing if empty.\n      return Field.NBSP;\n    }\n    if (text.length > this.maxDisplayLength) {\n      // Truncate displayed string and add an ellipsis ('...').\n      text = text.substring(0, this.maxDisplayLength - 2) + '\\u2026';\n    }\n    // Replace whitespace with non-breaking spaces so the text doesn't collapse.\n    text = text.replace(/\\s/g, Field.NBSP);\n    if (this.sourceBlock_ && this.sourceBlock_.RTL) {\n      // The SVG is LTR, force text to be RTL.\n      text += '\\u200F';\n    }\n    return text;\n  }\n\n  /**\n   * Get the text from this field.\n   * Override getText_ to provide a different behavior than simply casting the\n   * value to a string.\n   *\n   * @returns Current text.\n   * @sealed\n   */\n  getText(): string {\n    // this.getText_ was intended so that devs don't have to remember to call\n    // super when overriding how the text of the field is generated. (#2910)\n    const text = this.getText_();\n    if (text !== null) {\n      return String(text);\n    }\n    return String(this.getValue());\n  }\n\n  /**\n   * A developer hook to override the returned text of this field.\n   * Override if the text representation of the value of this field\n   * is not just a string cast of its value.\n   * Return null to resort to a string cast.\n   *\n   * @returns Current text or null.\n   */\n  protected getText_(): string|null {\n    return null;\n  }\n\n  /**\n   * Force a rerender of the block that this field is installed on, which will\n   * rerender this field and adjust for any sizing changes.\n   * Other fields on the same block will not rerender, because their sizes have\n   * already been recorded.\n   *\n   * @internal\n   */\n  markDirty() {\n    this.isDirty_ = true;\n    // AnyDuringMigration because:  Type 'null' is not assignable to type\n    // 'ConstantProvider'.\n    this.constants_ = null as AnyDuringMigration;\n  }\n\n  /**\n   * Force a rerender of the block that this field is installed on, which will\n   * rerender this field and adjust for any sizing changes.\n   * Other fields on the same block will not rerender, because their sizes have\n   * already been recorded.\n   *\n   * @internal\n   */\n  forceRerender() {\n    this.isDirty_ = true;\n    if (this.sourceBlock_ && this.sourceBlock_.rendered) {\n      (this.sourceBlock_ as BlockSvg).render();\n      (this.sourceBlock_ as BlockSvg).bumpNeighbours();\n      this.updateMarkers_();\n    }\n  }\n\n  /**\n   * Used to change the value of the field. Handles validation and events.\n   * Subclasses should override doClassValidation_ and doValueUpdate_ rather\n   * than this method.\n   *\n   * @param newValue New value.\n   * @sealed\n   */\n  setValue(newValue: AnyDuringMigration) {\n    const doLogging = false;\n    if (newValue === null) {\n      doLogging && console.log('null, return');\n      // Not a valid value to check.\n      return;\n    }\n\n    let validatedValue = this.doClassValidation_(newValue);\n    // Class validators might accidentally forget to return, we'll ignore that.\n    newValue = this.processValidation_(newValue, validatedValue);\n    if (newValue instanceof Error) {\n      doLogging && console.log('invalid class validation, return');\n      return;\n    }\n\n    const localValidator = this.getValidator();\n    if (localValidator) {\n      validatedValue = localValidator.call(this, newValue);\n      // Local validators might accidentally forget to return, we'll ignore\n      // that.\n      newValue = this.processValidation_(newValue, validatedValue);\n      if (newValue instanceof Error) {\n        doLogging && console.log('invalid local validation, return');\n        return;\n      }\n    }\n    const source = this.sourceBlock_;\n    if (source && source.disposed) {\n      doLogging && console.log('source disposed, return');\n      return;\n    }\n    const oldValue = this.getValue();\n    if (oldValue === newValue) {\n      doLogging && console.log('same, doValueUpdate_, return');\n      this.doValueUpdate_(newValue);\n      return;\n    }\n\n    this.doValueUpdate_(newValue);\n    if (source && eventUtils.isEnabled()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          source, 'field', this.name || null, oldValue, newValue));\n    }\n    if (this.isDirty_) {\n      this.forceRerender();\n    }\n    doLogging && console.log(this.value_);\n  }\n\n  /**\n   * Process the result of validation.\n   *\n   * @param newValue New value.\n   * @param validatedValue Validated value.\n   * @returns New value, or an Error object.\n   */\n  private processValidation_(\n      newValue: AnyDuringMigration,\n      validatedValue: AnyDuringMigration): AnyDuringMigration {\n    if (validatedValue === null) {\n      this.doValueInvalid_(newValue);\n      if (this.isDirty_) {\n        this.forceRerender();\n      }\n      return Error();\n    }\n    if (validatedValue !== undefined) {\n      newValue = validatedValue;\n    }\n    return newValue;\n  }\n\n  /**\n   * Get the current value of the field.\n   *\n   * @returns Current value.\n   */\n  getValue(): AnyDuringMigration {\n    return this.value_;\n  }\n\n  /**\n   * Used to validate a value. Returns input by default. Can be overridden by\n   * subclasses, see FieldDropdown.\n   *\n   * @param opt_newValue The value to be validated.\n   * @returns The validated value, same as input by default.\n   */\n  protected doClassValidation_(opt_newValue?: AnyDuringMigration):\n      AnyDuringMigration {\n    if (opt_newValue === null || opt_newValue === undefined) {\n      return null;\n    }\n    return opt_newValue;\n  }\n\n  /**\n   * Used to update the value of a field. Can be overridden by subclasses to do\n   * custom storage of values/updating of external things.\n   *\n   * @param newValue The value to be saved.\n   */\n  protected doValueUpdate_(newValue: AnyDuringMigration) {\n    this.value_ = newValue;\n    this.isDirty_ = true;\n  }\n\n  /**\n   * Used to notify the field an invalid value was input. Can be overridden by\n   * subclasses, see FieldTextInput.\n   * No-op by default.\n   *\n   * @param _invalidValue The input value that was determined to be invalid.\n   */\n  protected doValueInvalid_(_invalidValue: AnyDuringMigration) {}\n  // NOP\n\n  /**\n   * Handle a mouse down event on a field.\n   *\n   * @param e Mouse down event.\n   */\n  protected onMouseDown_(e: Event) {\n    if (!this.sourceBlock_ || this.sourceBlock_.disposed) {\n      return;\n    }\n    const gesture = (this.sourceBlock_.workspace as WorkspaceSvg).getGesture(e);\n    if (gesture) {\n      gesture.setStartField(this);\n    }\n  }\n\n  /**\n   * Sets the tooltip for this field.\n   *\n   * @param newTip The text for the tooltip, a function that returns the text\n   *     for the tooltip, a parent object whose tooltip will be used, or null to\n   *     display the tooltip of the parent block. To not display a tooltip pass\n   *     the empty string.\n   */\n  setTooltip(newTip: Tooltip.TipInfo|null) {\n    if (!newTip && newTip !== '') {  // If null or undefined.\n      newTip = this.sourceBlock_;\n    }\n    const clickTarget = this.getClickTarget_();\n    if (clickTarget) {\n      (clickTarget as AnyDuringMigration).tooltip = newTip;\n    } else {\n      // Field has not been initialized yet.\n      this.tooltip_ = newTip;\n    }\n  }\n\n  /**\n   * Returns the tooltip text for this field.\n   *\n   * @returns The tooltip text for this field.\n   */\n  getTooltip(): string {\n    const clickTarget = this.getClickTarget_();\n    if (clickTarget) {\n      return Tooltip.getTooltipOfObject(clickTarget);\n    }\n    // Field has not been initialized yet. Return stashed this.tooltip_ value.\n    return Tooltip.getTooltipOfObject({tooltip: this.tooltip_});\n  }\n\n  /**\n   * The element to bind the click handler to. If not set explicitly, defaults\n   * to the SVG root of the field. When this element is\n   * clicked on an editable field, the editor will open.\n   *\n   * @returns Element to bind click handler to.\n   */\n  protected getClickTarget_(): Element {\n    return this.clickTarget_ || this.getSvgRoot();\n  }\n\n  /**\n   * Return the absolute coordinates of the top-left corner of this field.\n   * The origin (0,0) is the top-left corner of the page body.\n   *\n   * @returns Object with .x and .y properties.\n   */\n  protected getAbsoluteXY_(): Coordinate {\n    return style.getPageOffset(this.getClickTarget_() as SVGRectElement);\n  }\n\n  /**\n   * Whether this field references any Blockly variables.  If true it may need\n   * to be handled differently during serialization and deserialization.\n   * Subclasses may override this.\n   *\n   * @returns True if this field has any variable references.\n   * @internal\n   */\n  referencesVariables(): boolean {\n    return false;\n  }\n\n  /**\n   * Refresh the variable name referenced by this field if this field references\n   * variables.\n   *\n   * @internal\n   */\n  refreshVariableName() {}\n  // NOP\n\n  /**\n   * Search through the list of inputs and their fields in order to find the\n   * parent input of a field.\n   *\n   * @returns The input that the field belongs to.\n   * @internal\n   */\n  getParentInput(): Input {\n    let parentInput = null;\n    const block = this.sourceBlock_;\n    const inputs = block.inputList;\n\n    for (let idx = 0; idx < block.inputList.length; idx++) {\n      const input = inputs[idx];\n      const fieldRows = input.fieldRow;\n      for (let j = 0; j < fieldRows.length; j++) {\n        if (fieldRows[j] === this) {\n          parentInput = input;\n          break;\n        }\n      }\n    }\n    // AnyDuringMigration because:  Type 'Input | null' is not assignable to\n    // type 'Input'.\n    return parentInput as AnyDuringMigration;\n  }\n\n  /**\n   * Returns whether or not we should flip the field in RTL.\n   *\n   * @returns True if we should flip in RTL.\n   */\n  getFlipRtl(): boolean {\n    return false;\n  }\n\n  /**\n   * Returns whether or not the field is tab navigable.\n   *\n   * @returns True if the field is tab navigable.\n   */\n  isTabNavigable(): boolean {\n    return false;\n  }\n\n  /**\n   * Handles the given keyboard shortcut.\n   *\n   * @param _shortcut The shortcut to be handled.\n   * @returns True if the shortcut has been handled, false otherwise.\n   */\n  onShortcut(_shortcut: KeyboardShortcut): boolean {\n    return false;\n  }\n\n  /**\n   * Add the cursor SVG to this fields SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the field group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    if (!cursorSvg) {\n      // AnyDuringMigration because:  Type 'null' is not assignable to type\n      // 'SVGElement'.\n      this.cursorSvg_ = null as AnyDuringMigration;\n      return;\n    }\n\n    this.fieldGroup_.appendChild(cursorSvg);\n    this.cursorSvg_ = cursorSvg;\n  }\n\n  /**\n   * Add the marker SVG to this fields SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the field group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    if (!markerSvg) {\n      // AnyDuringMigration because:  Type 'null' is not assignable to type\n      // 'SVGElement'.\n      this.markerSvg_ = null as AnyDuringMigration;\n      return;\n    }\n\n    this.fieldGroup_.appendChild(markerSvg);\n    this.markerSvg_ = markerSvg;\n  }\n\n  /** Redraw any attached marker or cursor svgs if needed. */\n  protected updateMarkers_() {\n    const workspace = this.sourceBlock_.workspace as WorkspaceSvg;\n    if (workspace.keyboardAccessibilityMode && this.cursorSvg_) {\n      workspace.getCursor()!.draw();\n    }\n    if (workspace.keyboardAccessibilityMode && this.markerSvg_) {\n      // TODO(#4592): Update all markers on the field.\n      workspace.getMarker(MarkerManager.LOCAL_MARKER)!.draw();\n    }\n  }\n}\n\n/**\n * Extra configuration options for the base field.\n */\nexport interface FieldConfig {\n  tooltip?: string;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Constant declarations for common key codes.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @namespace Blockly.utils.KeyCodes\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.KeyCodes');\n\n\n/**\n * Key codes for common characters.\n *\n * Copied from Closure's goog.events.KeyCodes\n *\n * This list is not localized and therefore some of the key codes are not\n * correct for non US keyboard layouts. See comments below.\n *\n * @alias Blockly.utils.KeyCodes\n */\nexport enum KeyCodes {\n  WIN_KEY_FF_LINUX = 0,\n  MAC_ENTER = 3,\n  BACKSPACE = 8,\n  TAB = 9,\n  NUM_CENTER = 12,  // NUMLOCK on FF/Safari Mac\n  ENTER = 13,\n  SHIFT = 16,\n  CTRL = 17,\n  ALT = 18,\n  PAUSE = 19,\n  CAPS_LOCK = 20,\n  ESC = 27,\n  SPACE = 32,\n  PAGE_UP = 33,    // also NUM_NORTH_EAST\n  PAGE_DOWN = 34,  // also NUM_SOUTH_EAST\n  END = 35,        // also NUM_SOUTH_WEST\n  HOME = 36,       // also NUM_NORTH_WEST\n  LEFT = 37,       // also NUM_WEST\n  UP = 38,         // also NUM_NORTH\n  RIGHT = 39,      // also NUM_EAST\n  DOWN = 40,       // also NUM_SOUTH\n  PLUS_SIGN = 43,  // NOT numpad plus\n  PRINT_SCREEN = 44,\n  INSERT = 45,  // also NUM_INSERT\n  DELETE = 46,  // also NUM_DELETE\n  ZERO = 48,\n  ONE = 49,\n  TWO = 50,\n  THREE = 51,\n  FOUR = 52,\n  FIVE = 53,\n  SIX = 54,\n  SEVEN = 55,\n  EIGHT = 56,\n  NINE = 57,\n  FF_SEMICOLON = 59,  // Firefox (Gecko) fires this for semicolon instead of 186\n  FF_EQUALS = 61,     // Firefox (Gecko) fires this for equals instead of 187\n  FF_DASH = 173,      // Firefox (Gecko) fires this for dash instead of 189\n  // Firefox (Gecko) fires this for # on UK keyboards, rather than\n  // Shift+SINGLE_QUOTE.\n  FF_HASH = 163,\n  QUESTION_MARK = 63,  // needs localization\n  AT_SIGN = 64,\n  A = 65,\n  B = 66,\n  C = 67,\n  D = 68,\n  E = 69,\n  F = 70,\n  G = 71,\n  H = 72,\n  I = 73,\n  J = 74,\n  K = 75,\n  L = 76,\n  M = 77,\n  N = 78,\n  O = 79,\n  P = 80,\n  Q = 81,\n  R = 82,\n  S = 83,\n  T = 84,\n  U = 85,\n  V = 86,\n  W = 87,\n  X = 88,\n  Y = 89,\n  Z = 90,\n  META = 91,  // WIN_KEY_LEFT\n  WIN_KEY_RIGHT = 92,\n  CONTEXT_MENU = 93,\n  NUM_ZERO = 96,\n  NUM_ONE = 97,\n  NUM_TWO = 98,\n  NUM_THREE = 99,\n  NUM_FOUR = 100,\n  NUM_FIVE = 101,\n  NUM_SIX = 102,\n  NUM_SEVEN = 103,\n  NUM_EIGHT = 104,\n  NUM_NINE = 105,\n  NUM_MULTIPLY = 106,\n  NUM_PLUS = 107,\n  NUM_MINUS = 109,\n  NUM_PERIOD = 110,\n  NUM_DIVISION = 111,\n  F1 = 112,\n  F2 = 113,\n  F3 = 114,\n  F4 = 115,\n  F5 = 116,\n  F6 = 117,\n  F7 = 118,\n  F8 = 119,\n  F9 = 120,\n  F10 = 121,\n  F11 = 122,\n  F12 = 123,\n  NUMLOCK = 144,\n  SCROLL_LOCK = 145,\n\n  // OS-specific media keys like volume controls and browser controls.\n  FIRST_MEDIA_KEY = 166,\n  LAST_MEDIA_KEY = 183,\n\n  SEMICOLON = 186,             // needs localization\n  DASH = 189,                  // needs localization\n  EQUALS = 187,                // needs localization\n  COMMA = 188,                 // needs localization\n  PERIOD = 190,                // needs localization\n  SLASH = 191,                 // needs localization\n  APOSTROPHE = 192,            // needs localization\n  TILDE = 192,                 // needs localization\n  SINGLE_QUOTE = 222,          // needs localization\n  OPEN_SQUARE_BRACKET = 219,   // needs localization\n  BACKSLASH = 220,             // needs localization\n  CLOSE_SQUARE_BRACKET = 221,  // needs localization\n  WIN_KEY = 224,\n  MAC_FF_META =\n      224,  // Firefox (Gecko) fires this for the meta key instead of 91\n  MAC_WK_CMD_LEFT = 91,   // WebKit Left Command key fired, same as META\n  MAC_WK_CMD_RIGHT = 93,  // WebKit Right Command key fired, different from META\n  WIN_IME = 229,\n\n  // \"Reserved for future use\". Some programs (e.g. the SlingPlayer 2.4 ActiveX\n  // control) fire this as a hacky way to disable screensavers.\n  VK_NONAME = 252,\n\n  // We've seen users whose machines fire this keycode at regular one\n  // second intervals. The common thread among these users is that\n  // they're all using Dell Inspiron laptops, so we suspect that this\n  // indicates a hardware/bios problem.\n  // http://en.community.dell.com/support-forums/laptop/f/3518/p/19285957/19523128.aspx\n  PHANTOM = 255,\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Blockly menu similar to Closure's goog.ui.Menu\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Menu');\n\nimport * as browserEvents from './browser_events.js';\nimport type {MenuItem} from './menuitem.js';\nimport * as aria from './utils/aria.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {KeyCodes} from './utils/keycodes.js';\nimport type {Size} from './utils/size.js';\nimport * as style from './utils/style.js';\n\n\n/**\n * A basic menu class.\n *\n * @alias Blockly.Menu\n */\nexport class Menu {\n  /**\n   * Array of menu items.\n   * (Nulls are never in the array, but typing the array as nullable prevents\n   * the compiler from objecting to .indexOf(null))\n   */\n  private readonly menuItems_: MenuItem[] = [];\n\n  /**\n   * Coordinates of the mousedown event that caused this menu to open. Used to\n   * prevent the consequent mouseup event due to a simple click from\n   * activating a menu item immediately.\n   */\n  openingCoords: Coordinate|null = null;\n\n  /**\n   * This is the element that we will listen to the real focus events on.\n   * A value of null means no menu item is highlighted.\n   */\n  private highlightedItem_: MenuItem|null = null;\n\n  /** Mouse over event data. */\n  private mouseOverHandler_: browserEvents.Data|null = null;\n\n  /** Click event data. */\n  private clickHandler_: browserEvents.Data|null = null;\n\n  /** Mouse enter event data. */\n  private mouseEnterHandler_: browserEvents.Data|null = null;\n\n  /** Mouse leave event data. */\n  private mouseLeaveHandler_: browserEvents.Data|null = null;\n\n  /** Key down event data. */\n  private onKeyDownHandler_: browserEvents.Data|null = null;\n\n  /** The menu's root DOM element. */\n  private element_: HTMLDivElement|null = null;\n\n  /** ARIA name for this menu. */\n  private roleName_: aria.Role|null = null;\n\n  /** Constructs a new Menu instance. */\n  constructor() {}\n\n  /**\n   * Add a new menu item to the bottom of this menu.\n   *\n   * @param menuItem Menu item to append.\n   * @internal\n   */\n  addChild(menuItem: MenuItem) {\n    this.menuItems_.push(menuItem);\n  }\n\n  /**\n   * Creates the menu DOM.\n   *\n   * @param container Element upon which to append this menu.\n   */\n  render(container: Element) {\n    const element = (document.createElement('div'));\n    // goog-menu is deprecated, use blocklyMenu.  May 2020.\n    element.className = 'blocklyMenu goog-menu blocklyNonSelectable';\n    element.tabIndex = 0;\n    if (this.roleName_) {\n      aria.setRole(element, this.roleName_);\n    }\n    this.element_ = element;\n\n    // Add menu items.\n    for (let i = 0, menuItem; menuItem = this.menuItems_[i]; i++) {\n      element.appendChild(menuItem.createDom());\n    }\n\n    // Add event handlers.\n    this.mouseOverHandler_ = browserEvents.conditionalBind(\n        element, 'mouseover', this, this.handleMouseOver_, true);\n    this.clickHandler_ = browserEvents.conditionalBind(\n        element, 'click', this, this.handleClick_, true);\n    this.mouseEnterHandler_ = browserEvents.conditionalBind(\n        element, 'mouseenter', this, this.handleMouseEnter_, true);\n    this.mouseLeaveHandler_ = browserEvents.conditionalBind(\n        element, 'mouseleave', this, this.handleMouseLeave_, true);\n    this.onKeyDownHandler_ = browserEvents.conditionalBind(\n        element, 'keydown', this, this.handleKeyEvent_);\n\n    container.appendChild(element);\n  }\n\n  /**\n   * Gets the menu's element.\n   *\n   * @returns The DOM element.\n   * @internal\n   */\n  getElement(): HTMLDivElement|null {\n    return this.element_;\n  }\n\n  /**\n   * Focus the menu element.\n   *\n   * @internal\n   */\n  focus() {\n    const el = this.getElement();\n    if (el) {\n      el.focus({preventScroll: true});\n      dom.addClass(el, 'blocklyFocused');\n    }\n  }\n\n  /** Blur the menu element. */\n  private blur_() {\n    const el = this.getElement();\n    if (el) {\n      el.blur();\n      dom.removeClass(el, 'blocklyFocused');\n    }\n  }\n\n  /**\n   * Set the menu accessibility role.\n   *\n   * @param roleName role name.\n   * @internal\n   */\n  setRole(roleName: aria.Role) {\n    this.roleName_ = roleName;\n  }\n\n  /** Dispose of this menu. */\n  dispose() {\n    // Remove event handlers.\n    if (this.mouseOverHandler_) {\n      browserEvents.unbind(this.mouseOverHandler_);\n      this.mouseOverHandler_ = null;\n    }\n    if (this.clickHandler_) {\n      browserEvents.unbind(this.clickHandler_);\n      this.clickHandler_ = null;\n    }\n    if (this.mouseEnterHandler_) {\n      browserEvents.unbind(this.mouseEnterHandler_);\n      this.mouseEnterHandler_ = null;\n    }\n    if (this.mouseLeaveHandler_) {\n      browserEvents.unbind(this.mouseLeaveHandler_);\n      this.mouseLeaveHandler_ = null;\n    }\n    if (this.onKeyDownHandler_) {\n      browserEvents.unbind(this.onKeyDownHandler_);\n      this.onKeyDownHandler_ = null;\n    }\n\n    // Remove menu items.\n    for (let i = 0, menuItem; menuItem = this.menuItems_[i]; i++) {\n      menuItem.dispose();\n    }\n    this.element_ = null;\n  }\n\n  // Child component management.\n\n  /**\n   * Returns the child menu item that owns the given DOM element,\n   * or null if no such menu item is found.\n   *\n   * @param elem DOM element whose owner is to be returned.\n   * @returns Menu item for which the DOM element belongs to.\n   */\n  private getMenuItem_(elem: Element): MenuItem|null {\n    const menuElem = this.getElement();\n    // Node might be the menu border (resulting in no associated menu item), or\n    // a menu item's div, or some element within the menu item.\n    // Walk up parents until one meets either the menu's root element, or\n    // a menu item's div.\n    let currentElement: Element|null = elem;\n    while (currentElement && currentElement !== menuElem) {\n      if (dom.hasClass(currentElement, 'blocklyMenuItem')) {\n        // Having found a menu item's div, locate that menu item in this menu.\n        for (let i = 0, menuItem; menuItem = this.menuItems_[i]; i++) {\n          if (menuItem.getElement() === currentElement) {\n            return menuItem;\n          }\n        }\n      }\n      currentElement = currentElement.parentElement;\n    }\n    return null;\n  }\n\n  // Highlight management.\n\n  /**\n   * Highlights the given menu item, or clears highlighting if null.\n   *\n   * @param item Item to highlight, or null.\n   * @internal\n   */\n  setHighlighted(item: MenuItem|null) {\n    const currentHighlighted = this.highlightedItem_;\n    if (currentHighlighted) {\n      currentHighlighted.setHighlighted(false);\n      this.highlightedItem_ = null;\n    }\n    if (item) {\n      item.setHighlighted(true);\n      this.highlightedItem_ = item;\n      // Bring the highlighted item into view. This has no effect if the menu is\n      // not scrollable.\n      const el = this.getElement() as Element;\n      style.scrollIntoContainerView(item.getElement() as Element, el);\n\n      aria.setState(el, aria.State.ACTIVEDESCENDANT, item.getId());\n    }\n  }\n\n  /**\n   * Highlights the next highlightable item (or the first if nothing is\n   * currently highlighted).\n   *\n   * @internal\n   */\n  highlightNext() {\n    const index = this.highlightedItem_ ?\n        this.menuItems_.indexOf(this.highlightedItem_) :\n        -1;\n    this.highlightHelper_(index, 1);\n  }\n\n  /**\n   * Highlights the previous highlightable item (or the last if nothing is\n   * currently highlighted).\n   *\n   * @internal\n   */\n  highlightPrevious() {\n    const index = this.highlightedItem_ ?\n        this.menuItems_.indexOf(this.highlightedItem_) :\n        -1;\n    this.highlightHelper_(index < 0 ? this.menuItems_.length : index, -1);\n  }\n\n  /** Highlights the first highlightable item. */\n  private highlightFirst_() {\n    this.highlightHelper_(-1, 1);\n  }\n\n  /** Highlights the last highlightable item. */\n  private highlightLast_() {\n    this.highlightHelper_(this.menuItems_.length, -1);\n  }\n\n  /**\n   * Helper function that manages the details of moving the highlight among\n   * child menuitems in response to keyboard events.\n   *\n   * @param startIndex Start index.\n   * @param delta Step direction: 1 to go down, -1 to go up.\n   */\n  private highlightHelper_(startIndex: number, delta: number) {\n    let index = startIndex + delta;\n    let menuItem;\n    while (menuItem = this.menuItems_[index]) {\n      if (menuItem.isEnabled()) {\n        this.setHighlighted(menuItem);\n        break;\n      }\n      index += delta;\n    }\n  }\n\n  // Mouse events.\n\n  /**\n   * Handles mouseover events. Highlight menuitems as the user hovers over them.\n   *\n   * @param e Mouse event to handle.\n   */\n  private handleMouseOver_(e: Event) {\n    const menuItem = this.getMenuItem_(e.target as Element);\n\n    if (menuItem) {\n      if (menuItem.isEnabled()) {\n        if (this.highlightedItem_ !== menuItem) {\n          this.setHighlighted(menuItem);\n        }\n      } else {\n        this.setHighlighted(null);\n      }\n    }\n  }\n\n  /**\n   * Handles click events. Pass the event onto the child menuitem to handle.\n   *\n   * @param e Click event to handle.\n   */\n  private handleClick_(e: Event) {\n    const oldCoords = this.openingCoords;\n    // Clear out the saved opening coords immediately so they're not used twice.\n    this.openingCoords = null;\n    // AnyDuringMigration because:  Property 'clientX' does not exist on type\n    // 'Event'.\n    if (oldCoords && typeof (e as AnyDuringMigration).clientX === 'number') {\n      // AnyDuringMigration because:  Property 'clientY' does not exist on type\n      // 'Event'. AnyDuringMigration because:  Property 'clientX' does not exist\n      // on type 'Event'.\n      const newCoords = new Coordinate(\n          (e as AnyDuringMigration).clientX, (e as AnyDuringMigration).clientY);\n      if (Coordinate.distance(oldCoords, newCoords) < 1) {\n        // This menu was opened by a mousedown and we're handling the consequent\n        // click event. The coords haven't changed, meaning this was the same\n        // opening event. Don't do the usual behavior because the menu just\n        // popped up under the mouse and the user didn't mean to activate this\n        // item.\n        return;\n      }\n    }\n\n    const menuItem = this.getMenuItem_(e.target as Element);\n    if (menuItem) {\n      menuItem.performAction();\n    }\n  }\n\n  /**\n   * Handles mouse enter events. Focus the element.\n   *\n   * @param _e Mouse event to handle.\n   */\n  private handleMouseEnter_(_e: Event) {\n    this.focus();\n  }\n\n  /**\n   * Handles mouse leave events. Blur and clear highlight.\n   *\n   * @param _e Mouse event to handle.\n   */\n  private handleMouseLeave_(_e: Event) {\n    if (this.getElement()) {\n      this.blur_();\n      this.setHighlighted(null);\n    }\n  }\n\n  // Keyboard events.\n\n  /**\n   * Attempts to handle a keyboard event, if the menu item is enabled, by\n   * calling\n   * {@link Menu#handleKeyEventInternal_}.\n   *\n   * @param e Key event to handle.\n   */\n  private handleKeyEvent_(e: Event) {\n    if (!this.menuItems_.length) {\n      // Empty menu.\n      return;\n    }\n    // AnyDuringMigration because:  Property 'altKey' does not exist on type\n    // 'Event'. AnyDuringMigration because:  Property 'metaKey' does not exist\n    // on type 'Event'. AnyDuringMigration because:  Property 'ctrlKey' does not\n    // exist on type 'Event'. AnyDuringMigration because:  Property 'shiftKey'\n    // does not exist on type 'Event'.\n    if ((e as AnyDuringMigration).shiftKey ||\n        (e as AnyDuringMigration).ctrlKey ||\n        (e as AnyDuringMigration).metaKey || (e as AnyDuringMigration).altKey) {\n      // Do not handle the key event if any modifier key is pressed.\n      return;\n    }\n\n    const highlighted = this.highlightedItem_;\n    // AnyDuringMigration because:  Property 'keyCode' does not exist on type\n    // 'Event'.\n    switch ((e as AnyDuringMigration).keyCode) {\n      case KeyCodes.ENTER:\n      case KeyCodes.SPACE:\n        if (highlighted) {\n          highlighted.performAction();\n        }\n        break;\n\n      case KeyCodes.UP:\n        this.highlightPrevious();\n        break;\n\n      case KeyCodes.DOWN:\n        this.highlightNext();\n        break;\n\n      case KeyCodes.PAGE_UP:\n      case KeyCodes.HOME:\n        this.highlightFirst_();\n        break;\n\n      case KeyCodes.PAGE_DOWN:\n      case KeyCodes.END:\n        this.highlightLast_();\n        break;\n\n      default:\n        // Not a key the menu is interested in.\n        return;\n    }\n    // The menu used this key, don't let it have secondary effects.\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  /**\n   * Get the size of a rendered menu.\n   *\n   * @returns Object with width and height properties.\n   * @internal\n   */\n  getSize(): Size {\n    const menuDom = this.getElement();\n    const menuSize = style.getSize(menuDom as Element);\n    // Recalculate height for the total content, not only box height.\n    menuSize.height = menuDom!.scrollHeight;\n    return menuSize;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Blockly menu item similar to Closure's goog.ui.MenuItem\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.MenuItem');\n\nimport * as aria from './utils/aria.js';\nimport * as dom from './utils/dom.js';\nimport * as idGenerator from './utils/idgenerator.js';\n\n\n/**\n * Class representing an item in a menu.\n *\n * @alias Blockly.MenuItem\n */\nexport class MenuItem {\n  /** Is the menu item clickable, as opposed to greyed-out. */\n  private enabled_ = true;\n\n  /** The DOM element for the menu item. */\n  private element_: HTMLDivElement|null = null;\n\n  /** Whether the menu item is rendered right-to-left. */\n  private rightToLeft_ = false;\n\n  /** ARIA name for this menu. */\n  private roleName_: aria.Role|null = null;\n\n  /** Is this menu item checkable. */\n  private checkable_ = false;\n\n  /** Is this menu item currently checked. */\n  private checked_ = false;\n\n  /** Is this menu item currently highlighted. */\n  private highlight_ = false;\n\n  /** Bound function to call when this menu item is clicked. */\n  private actionHandler_: Function|null = null;\n\n  /**\n   * @param content Text caption to display as the content of the item, or a\n   *     HTML element to display.\n   * @param opt_value Data/model associated with the menu item.\n   */\n  constructor(\n      private readonly content: string|HTMLElement,\n      private readonly opt_value?: string) {}\n\n  /**\n   * Creates the menuitem's DOM.\n   *\n   * @returns Completed DOM.\n   */\n  createDom(): Element {\n    const element = (document.createElement('div'));\n    element.id = idGenerator.getNextUniqueId();\n    this.element_ = element;\n\n    // Set class and style\n    // goog-menuitem* is deprecated, use blocklyMenuItem*.  May 2020.\n    element.className = 'blocklyMenuItem goog-menuitem ' +\n        (this.enabled_ ? '' :\n                         'blocklyMenuItemDisabled goog-menuitem-disabled ') +\n        (this.checked_ ? 'blocklyMenuItemSelected goog-option-selected ' : '') +\n        (this.highlight_ ? 'blocklyMenuItemHighlight goog-menuitem-highlight ' :\n                           '') +\n        (this.rightToLeft_ ? 'blocklyMenuItemRtl goog-menuitem-rtl ' : '');\n\n    const content = (document.createElement('div'));\n    content.className = 'blocklyMenuItemContent goog-menuitem-content';\n    // Add a checkbox for checkable menu items.\n    if (this.checkable_) {\n      const checkbox = (document.createElement('div'));\n      checkbox.className = 'blocklyMenuItemCheckbox goog-menuitem-checkbox';\n      content.appendChild(checkbox);\n    }\n\n    let contentDom: Node = this.content as HTMLElement;\n    if (typeof this.content === 'string') {\n      contentDom = document.createTextNode(this.content);\n    }\n    content.appendChild(contentDom);\n    element.appendChild(content);\n\n    // Initialize ARIA role and state.\n    if (this.roleName_) {\n      aria.setRole(element, this.roleName_);\n    }\n    aria.setState(\n        element, aria.State.SELECTED,\n        this.checkable_ && this.checked_ || false);\n    aria.setState(element, aria.State.DISABLED, !this.enabled_);\n\n    return element;\n  }\n\n  /** Dispose of this menu item. */\n  dispose() {\n    this.element_ = null;\n  }\n\n  /**\n   * Gets the menu item's element.\n   *\n   * @returns The DOM element.\n   * @internal\n   */\n  getElement(): Element|null {\n    return this.element_;\n  }\n\n  /**\n   * Gets the unique ID for this menu item.\n   *\n   * @returns Unique component ID.\n   * @internal\n   */\n  getId(): string {\n    return this.element_!.id;\n  }\n\n  /**\n   * Gets the value associated with the menu item.\n   *\n   * @returns value Value associated with the menu item.\n   * @internal\n   */\n  getValue(): string|null {\n    return this.opt_value ?? null;\n  }\n\n  /**\n   * Set menu item's rendering direction.\n   *\n   * @param rtl True if RTL, false if LTR.\n   * @internal\n   */\n  setRightToLeft(rtl: boolean) {\n    this.rightToLeft_ = rtl;\n  }\n\n  /**\n   * Set the menu item's accessibility role.\n   *\n   * @param roleName Role name.\n   * @internal\n   */\n  setRole(roleName: aria.Role) {\n    this.roleName_ = roleName;\n  }\n\n  /**\n   * Sets the menu item to be checkable or not. Set to true for menu items\n   * that represent checkable options.\n   *\n   * @param checkable Whether the menu item is checkable.\n   * @internal\n   */\n  setCheckable(checkable: boolean) {\n    this.checkable_ = checkable;\n  }\n\n  /**\n   * Checks or unchecks the component.\n   *\n   * @param checked Whether to check or uncheck the component.\n   * @internal\n   */\n  setChecked(checked: boolean) {\n    this.checked_ = checked;\n  }\n\n  /**\n   * Highlights or unhighlights the component.\n   *\n   * @param highlight Whether to highlight or unhighlight the component.\n   * @internal\n   */\n  setHighlighted(highlight: boolean) {\n    this.highlight_ = highlight;\n\n    const el = this.getElement();\n    if (el && this.isEnabled()) {\n      // goog-menuitem-highlight is deprecated, use blocklyMenuItemHighlight.\n      // May 2020.\n      const name = 'blocklyMenuItemHighlight';\n      const nameDep = 'goog-menuitem-highlight';\n      if (highlight) {\n        dom.addClass(el, name);\n        dom.addClass(el, nameDep);\n      } else {\n        dom.removeClass(el, name);\n        dom.removeClass(el, nameDep);\n      }\n    }\n  }\n\n  /**\n   * Returns true if the menu item is enabled, false otherwise.\n   *\n   * @returns Whether the menu item is enabled.\n   * @internal\n   */\n  isEnabled(): boolean {\n    return this.enabled_;\n  }\n\n  /**\n   * Enables or disables the menu item.\n   *\n   * @param enabled Whether to enable or disable the menu item.\n   * @internal\n   */\n  setEnabled(enabled: boolean) {\n    this.enabled_ = enabled;\n  }\n\n  /**\n   * Performs the appropriate action when the menu item is activated\n   * by the user.\n   *\n   * @internal\n   */\n  performAction() {\n    if (this.isEnabled() && this.actionHandler_) {\n      this.actionHandler_(this);\n    }\n  }\n\n  /**\n   * Set the handler that's called when the menu item is activated by the user.\n   * `obj` will be used as the 'this' object in the function when called.\n   *\n   * @param fn The handler.\n   * @param obj Used as the 'this' object in fn when called.\n   * @internal\n   */\n  onAction(fn: (p1: MenuItem) => void, obj: object) {\n    this.actionHandler_ = fn.bind(obj);\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of bubble open.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.BubbleOpen');\n\nimport type {BlockSvg} from '../block_svg.js';\nimport * as registry from '../registry.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a bubble open event.\n *\n * @alias Blockly.Events.BubbleOpen\n */\nexport class BubbleOpen extends UiBase {\n  blockId: string|null;\n  isOpen?: boolean;\n  bubbleType?: string;\n  override type: string;\n\n  /**\n   * @param opt_block The associated block. Undefined for a blank event.\n   * @param opt_isOpen Whether the bubble is opening (false if closing).\n   *     Undefined for a blank event.\n   * @param opt_bubbleType The type of bubble. One of 'mutator', 'comment' or\n   *     'warning'. Undefined for a blank event.\n   */\n  constructor(\n      opt_block?: BlockSvg, opt_isOpen?: boolean, opt_bubbleType?: string) {\n    const workspaceId = opt_block ? opt_block.workspace.id : undefined;\n    super(workspaceId);\n    this.blockId = opt_block ? opt_block.id : null;\n\n    /** Whether the bubble is opening (false if closing). */\n    this.isOpen = opt_isOpen;\n\n    /** The type of bubble. One of 'mutator', 'comment', or 'warning'. */\n    this.bubbleType = opt_bubbleType;\n\n    /** Type of this event. */\n    this.type = eventUtils.BUBBLE_OPEN;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['isOpen'] = this.isOpen;\n    json['bubbleType'] = this.bubbleType;\n    json['blockId'] = this.blockId;\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.isOpen = json['isOpen'];\n    this.bubbleType = json['bubbleType'];\n    this.blockId = json['blockId'];\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.BUBBLE_OPEN, BubbleOpen);\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a scrollbar.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Scrollbar');\n\nimport * as browserEvents from './browser_events.js';\nimport * as Touch from './touch.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * A note on units: most of the numbers that are in CSS pixels are scaled if the\n * scrollbar is in a mutator.\n */\n\n/**\n * Class for a pure SVG scrollbar.\n * This technique offers a scrollbar that is guaranteed to work, but may not\n * look or behave like the system's scrollbars.\n *\n * @alias Blockly.Scrollbar\n */\nexport class Scrollbar {\n  /**\n   * Width of vertical scrollbar or height of horizontal scrollbar in CSS\n   * pixels. Scrollbars should be larger on touch devices.\n   */\n  static scrollbarThickness = Touch.TOUCH_ENABLED ? 25 : 15;\n\n  /**\n   * Default margin around the scrollbar (between the scrollbar and the edge of\n   * the viewport in pixels).\n   *\n   * @internal\n   */\n  static readonly DEFAULT_SCROLLBAR_MARGIN = 0.5;\n  private readonly pair_: boolean;\n  private readonly margin_: number;\n\n  /** Previously recorded metrics from the workspace. */\n  private oldHostMetrics_: Metrics|null = null;\n\n  /**\n   * The ratio of handle position offset to workspace content displacement.\n   *\n   * @internal\n   */\n  ratio = 1;\n  private origin_: Coordinate;\n\n  /**\n   * The position of the mouse along this scrollbar's major axis at the start\n   * of the most recent drag. Units are CSS pixels, with (0, 0) at the top\n   * left of the browser window. For a horizontal scrollbar this is the x\n   * coordinate of the mouse down event; for a vertical scrollbar it's the y\n   * coordinate of the mouse down event.\n   */\n  private startDragMouse_ = 0;\n\n  /**\n   * The length of the scrollbars (including the handle and the background),\n   * in CSS pixels. This is equivalent to scrollbar background length and the\n   * area within which the scrollbar handle can move.\n   */\n  private scrollbarLength_ = 0;\n\n  /** The length of the scrollbar handle in CSS pixels. */\n  private handleLength_ = 0;\n\n  /**\n   * The offset of the start of the handle from the scrollbar position, in CSS\n   * pixels.\n   */\n  private handlePosition_ = 0;\n\n  private startDragHandle = 0;\n\n  /** Whether the scrollbar handle is visible. */\n  private isVisible_ = true;\n\n  /** Whether the workspace containing this scrollbar is visible. */\n  private containerVisible_ = true;\n  private svgBackground_: SVGRectElement|null = null;\n\n  private svgHandle_: SVGRectElement|null = null;\n\n  private outerSvg_: SVGSVGElement|null = null;\n\n  private svgGroup_: SVGGElement|null = null;\n  position: Coordinate;\n\n  lengthAttribute_ = 'width';\n  positionAttribute_ = 'x';\n  onMouseDownBarWrapper_: browserEvents.Data|null;\n  onMouseDownHandleWrapper_: browserEvents.Data|null;\n  onMouseUpWrapper_: browserEvents.Data|null = null;\n  onMouseMoveWrapper_: browserEvents.Data|null = null;\n\n  /**\n   * @param workspace Workspace to bind the scrollbar to.\n   * @param horizontal True if horizontal, false if vertical.\n   * @param opt_pair True if scrollbar is part of a horiz/vert pair.\n   * @param opt_class A class to be applied to this scrollbar.\n   * @param opt_margin The margin to apply to this scrollbar.\n   */\n  constructor(\n      private workspace: WorkspaceSvg, private readonly horizontal: boolean,\n      opt_pair?: boolean, opt_class?: string, opt_margin?: number) {\n    /** Whether this scrollbar is part of a pair. */\n    this.pair_ = opt_pair || false;\n    /**\n     * Margin around the scrollbar (between the scrollbar and the edge of the\n     * viewport in pixels).\n     */\n    this.margin_ = opt_margin !== undefined ?\n        opt_margin :\n        Scrollbar.DEFAULT_SCROLLBAR_MARGIN;\n\n    /**\n     * The location of the origin of the workspace that the scrollbar is in,\n     * measured in CSS pixels relative to the injection div origin.  This is\n     * usually (0, 0).  When the scrollbar is in a flyout it may have a\n     * different origin.\n     */\n    this.origin_ = new Coordinate(0, 0);\n\n    this.createDom_(opt_class);\n\n    /**\n     * The upper left corner of the scrollbar's SVG group in CSS pixels relative\n     * to the scrollbar's origin.  This is usually relative to the injection div\n     * origin.\n     *\n     * @internal\n     */\n    this.position = new Coordinate(0, 0);\n\n    // Store the thickness in a temp variable for readability.\n    const scrollbarThickness = Scrollbar.scrollbarThickness;\n    if (horizontal) {\n      this.svgBackground_!.setAttribute('height', String(scrollbarThickness));\n      this.outerSvg_!.setAttribute('height', String(scrollbarThickness));\n      this.svgHandle_!.setAttribute('height', String(scrollbarThickness - 5));\n      this.svgHandle_!.setAttribute('y', String(2.5));\n    } else {\n      this.svgBackground_!.setAttribute('width', String(scrollbarThickness));\n      this.outerSvg_!.setAttribute('width', String(scrollbarThickness));\n      this.svgHandle_!.setAttribute('width', String(scrollbarThickness - 5));\n      this.svgHandle_!.setAttribute('x', String(2.5));\n\n      this.lengthAttribute_ = 'height';\n      this.positionAttribute_ = 'y';\n    }\n    this.onMouseDownBarWrapper_ = browserEvents.conditionalBind(\n        this.svgBackground_!, 'mousedown', this, this.onMouseDownBar_);\n    this.onMouseDownHandleWrapper_ = browserEvents.conditionalBind(\n        this.svgHandle_!, 'mousedown', this, this.onMouseDownHandle_);\n  }\n\n  /**\n   * Dispose of this scrollbar.\n   * Unlink from all DOM elements to prevent memory leaks.\n   *\n   * @suppress {checkTypes}\n   */\n  dispose() {\n    this.cleanUp_();\n    if (this.onMouseDownBarWrapper_) {\n      browserEvents.unbind(this.onMouseDownBarWrapper_);\n      this.onMouseDownBarWrapper_ = null;\n    }\n    if (this.onMouseDownHandleWrapper_) {\n      browserEvents.unbind(this.onMouseDownHandleWrapper_);\n      this.onMouseDownHandleWrapper_ = null;\n    }\n\n    dom.removeNode(this.outerSvg_);\n    this.outerSvg_ = null;\n    this.svgGroup_ = null;\n    this.svgBackground_ = null;\n    if (this.svgHandle_) {\n      this.workspace.getThemeManager().unsubscribe(this.svgHandle_);\n      this.svgHandle_ = null;\n    }\n  }\n\n  /**\n   * Constrain the handle's length within the minimum (0) and maximum\n   * (scrollbar background) values allowed for the scrollbar.\n   *\n   * @param value Value that is potentially out of bounds, in CSS pixels.\n   * @returns Constrained value, in CSS pixels.\n   */\n  private constrainHandleLength_(value: number): number {\n    if (value <= 0 || isNaN(value)) {\n      value = 0;\n    } else {\n      value = Math.min(value, this.scrollbarLength_);\n    }\n    return value;\n  }\n\n  /**\n   * Set the length of the scrollbar's handle and change the SVG attribute\n   * accordingly.\n   *\n   * @param newLength The new scrollbar handle length in CSS pixels.\n   */\n  private setHandleLength_(newLength: number) {\n    this.handleLength_ = newLength;\n    this.svgHandle_!.setAttribute(\n        this.lengthAttribute_, String(this.handleLength_));\n  }\n\n  /**\n   * Constrain the handle's position within the minimum (0) and maximum values\n   * allowed for the scrollbar.\n   *\n   * @param value Value that is potentially out of bounds, in CSS pixels.\n   * @returns Constrained value, in CSS pixels.\n   */\n  private constrainHandlePosition_(value: number): number {\n    if (value <= 0 || isNaN(value)) {\n      value = 0;\n    } else {\n      // Handle length should never be greater than this.scrollbarLength_.\n      // If the viewSize is greater than or equal to the scrollSize, the\n      // handleLength will end up equal to this.scrollbarLength_.\n      value = Math.min(value, this.scrollbarLength_ - this.handleLength_);\n    }\n    return value;\n  }\n\n  /**\n   * Set the offset of the scrollbar's handle from the scrollbar's position, and\n   * change the SVG attribute accordingly.\n   *\n   * @param newPosition The new scrollbar handle offset in CSS pixels.\n   */\n  setHandlePosition(newPosition: number) {\n    this.handlePosition_ = newPosition;\n    this.svgHandle_!.setAttribute(\n        this.positionAttribute_, String(this.handlePosition_));\n  }\n\n  /**\n   * Set the size of the scrollbar's background and change the SVG attribute\n   * accordingly.\n   *\n   * @param newSize The new scrollbar background length in CSS pixels.\n   */\n  private setScrollbarLength_(newSize: number) {\n    this.scrollbarLength_ = newSize;\n    this.outerSvg_!.setAttribute(\n        this.lengthAttribute_, String(this.scrollbarLength_));\n    this.svgBackground_!.setAttribute(\n        this.lengthAttribute_, String(this.scrollbarLength_));\n  }\n\n  /**\n   * Set the position of the scrollbar's SVG group in CSS pixels relative to the\n   * scrollbar's origin.  This sets the scrollbar's location within the\n   * workspace.\n   *\n   * @param x The new x coordinate.\n   * @param y The new y coordinate.\n   * @internal\n   */\n  setPosition(x: number, y: number) {\n    this.position.x = x;\n    this.position.y = y;\n\n    const tempX = this.position.x + this.origin_.x;\n    const tempY = this.position.y + this.origin_.y;\n    const transform = 'translate(' + tempX + 'px,' + tempY + 'px)';\n    dom.setCssTransform(this.outerSvg_ as Element, transform);\n  }\n\n  /**\n   * Recalculate the scrollbar's location and its length.\n   *\n   * @param opt_metrics A data structure of from the describing all the required\n   *     dimensions.  If not provided, it will be fetched from the host object.\n   */\n  resize(opt_metrics?: Metrics) {\n    // Determine the location, height and width of the host element.\n    let hostMetrics = opt_metrics;\n    if (!hostMetrics) {\n      hostMetrics = this.workspace.getMetrics();\n      if (!hostMetrics) {\n        // Host element is likely not visible.\n        return;\n      }\n    }\n\n    if (this.oldHostMetrics_ &&\n        Scrollbar.metricsAreEquivalent_(hostMetrics, this.oldHostMetrics_)) {\n      return;\n    }\n\n    if (this.horizontal) {\n      this.resizeHorizontal_(hostMetrics);\n    } else {\n      this.resizeVertical_(hostMetrics);\n    }\n\n    this.oldHostMetrics_ = hostMetrics;\n\n    // Resizing may have caused some scrolling.\n    this.updateMetrics_();\n  }\n\n  /**\n   * Returns whether the a resizeView is necessary by comparing the passed\n   * hostMetrics with cached old host metrics.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   * @returns Whether a resizeView is necessary.\n   */\n  private requiresViewResize_(hostMetrics: Metrics): boolean {\n    if (!this.oldHostMetrics_) {\n      return true;\n    }\n    return this.oldHostMetrics_.viewWidth !== hostMetrics.viewWidth ||\n        this.oldHostMetrics_.viewHeight !== hostMetrics.viewHeight ||\n        this.oldHostMetrics_.absoluteLeft !== hostMetrics.absoluteLeft ||\n        this.oldHostMetrics_.absoluteTop !== hostMetrics.absoluteTop;\n  }\n\n  /**\n   * Recalculate a horizontal scrollbar's location and length.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  private resizeHorizontal_(hostMetrics: Metrics) {\n    if (this.requiresViewResize_(hostMetrics)) {\n      this.resizeViewHorizontal(hostMetrics);\n    } else {\n      this.resizeContentHorizontal(hostMetrics);\n    }\n  }\n\n  /**\n   * Recalculate a horizontal scrollbar's location on the screen and path\n   * length. This should be called when the layout or size of the window has\n   * changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeViewHorizontal(hostMetrics: Metrics) {\n    let viewSize = hostMetrics.viewWidth - this.margin_ * 2;\n    if (this.pair_) {\n      // Shorten the scrollbar to make room for the corner square.\n      viewSize -= Scrollbar.scrollbarThickness;\n    }\n    this.setScrollbarLength_(Math.max(0, viewSize));\n\n    let xCoordinate = hostMetrics.absoluteLeft + this.margin_;\n    if (this.pair_ && this.workspace.RTL) {\n      xCoordinate += Scrollbar.scrollbarThickness;\n    }\n\n    // Horizontal toolbar should always be just above the bottom of the\n    // workspace.\n    const yCoordinate = hostMetrics.absoluteTop + hostMetrics.viewHeight -\n        Scrollbar.scrollbarThickness - this.margin_;\n    this.setPosition(xCoordinate, yCoordinate);\n\n    // If the view has been resized, a content resize will also be necessary.\n    // The reverse is not true.\n    this.resizeContentHorizontal(hostMetrics);\n  }\n\n  /**\n   * Recalculate a horizontal scrollbar's location within its path and length.\n   * This should be called when the contents of the workspace have changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeContentHorizontal(hostMetrics: Metrics) {\n    if (hostMetrics.viewWidth >= hostMetrics.scrollWidth) {\n      // viewWidth is often greater than scrollWidth in flyouts and\n      // non-scrollable workspaces.\n      this.setHandleLength_(this.scrollbarLength_);\n      this.setHandlePosition(0);\n      if (!this.pair_) {\n        // The scrollbar isn't needed.\n        // This doesn't apply to scrollbar pairs because interactions with the\n        // corner square aren't handled.\n        this.setVisible(false);\n      }\n      return;\n    } else if (!this.pair_) {\n      // The scrollbar is needed. Only non-paired scrollbars are hidden/shown.\n      this.setVisible(true);\n    }\n\n    // Resize the handle.\n    let handleLength =\n        this.scrollbarLength_ * hostMetrics.viewWidth / hostMetrics.scrollWidth;\n    handleLength = this.constrainHandleLength_(handleLength);\n    this.setHandleLength_(handleLength);\n\n    // Compute the handle offset.\n    // The position of the handle can be between:\n    //     0 and this.scrollbarLength_ - handleLength\n    // If viewLeft === scrollLeft\n    //     then the offset should be 0\n    // If viewRight === scrollRight\n    //     then viewLeft = scrollLeft + scrollWidth - viewWidth\n    //     then the offset should be max offset\n\n    const maxScrollDistance = hostMetrics.scrollWidth - hostMetrics.viewWidth;\n    const contentDisplacement = hostMetrics.viewLeft - hostMetrics.scrollLeft;\n    // Percent of content to the left of our current position.\n    const offsetRatio = contentDisplacement / maxScrollDistance;\n    // Area available to scroll * percent to the left\n    const maxHandleOffset = this.scrollbarLength_ - this.handleLength_;\n    let handleOffset = maxHandleOffset * offsetRatio;\n    handleOffset = this.constrainHandlePosition_(handleOffset);\n    this.setHandlePosition(handleOffset);\n\n    // Compute ratio (for use with set calls, which pass in content\n    // displacement).\n    this.ratio = maxHandleOffset / maxScrollDistance;\n  }\n\n  /**\n   * Recalculate a vertical scrollbar's location and length.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  private resizeVertical_(hostMetrics: Metrics) {\n    if (this.requiresViewResize_(hostMetrics)) {\n      this.resizeViewVertical(hostMetrics);\n    } else {\n      this.resizeContentVertical(hostMetrics);\n    }\n  }\n\n  /**\n   * Recalculate a vertical scrollbar's location on the screen and path length.\n   * This should be called when the layout or size of the window has changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeViewVertical(hostMetrics: Metrics) {\n    let viewSize = hostMetrics.viewHeight - this.margin_ * 2;\n    if (this.pair_) {\n      // Shorten the scrollbar to make room for the corner square.\n      viewSize -= Scrollbar.scrollbarThickness;\n    }\n    this.setScrollbarLength_(Math.max(0, viewSize));\n\n    const xCoordinate = this.workspace.RTL ?\n        hostMetrics.absoluteLeft + this.margin_ :\n        hostMetrics.absoluteLeft + hostMetrics.viewWidth -\n            Scrollbar.scrollbarThickness - this.margin_;\n\n    const yCoordinate = hostMetrics.absoluteTop + this.margin_;\n    this.setPosition(xCoordinate, yCoordinate);\n\n    // If the view has been resized, a content resize will also be necessary.\n    // The reverse is not true.\n    this.resizeContentVertical(hostMetrics);\n  }\n\n  /**\n   * Recalculate a vertical scrollbar's location within its path and length.\n   * This should be called when the contents of the workspace have changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeContentVertical(hostMetrics: Metrics) {\n    if (hostMetrics.viewHeight >= hostMetrics.scrollHeight) {\n      // viewHeight is often greater than scrollHeight in flyouts and\n      // non-scrollable workspaces.\n      this.setHandleLength_(this.scrollbarLength_);\n      this.setHandlePosition(0);\n      if (!this.pair_) {\n        // The scrollbar isn't needed.\n        // This doesn't apply to scrollbar pairs because interactions with the\n        // corner square aren't handled.\n        this.setVisible(false);\n      }\n      return;\n    } else if (!this.pair_) {\n      // The scrollbar is needed. Only non-paired scrollbars are hidden/shown.\n      this.setVisible(true);\n    }\n\n    // Resize the handle.\n    let handleLength = this.scrollbarLength_ * hostMetrics.viewHeight /\n        hostMetrics.scrollHeight;\n    handleLength = this.constrainHandleLength_(handleLength);\n    this.setHandleLength_(handleLength);\n\n    // Compute the handle offset.\n    // The position of the handle can be between:\n    //     0 and this.scrollbarLength_ - handleLength\n    // If viewTop === scrollTop\n    //     then the offset should be 0\n    // If viewBottom === scrollBottom\n    //     then viewTop = scrollTop + scrollHeight - viewHeight\n    //     then the offset should be max offset\n\n    const maxScrollDistance = hostMetrics.scrollHeight - hostMetrics.viewHeight;\n    const contentDisplacement = hostMetrics.viewTop - hostMetrics.scrollTop;\n    // Percent of content to the left of our current position.\n    const offsetRatio = contentDisplacement / maxScrollDistance;\n    // Area available to scroll * percent to the left\n    const maxHandleOffset = this.scrollbarLength_ - this.handleLength_;\n    let handleOffset = maxHandleOffset * offsetRatio;\n    handleOffset = this.constrainHandlePosition_(handleOffset);\n    this.setHandlePosition(handleOffset);\n\n    // Compute ratio (for use with set calls, which pass in content\n    // displacement).\n    this.ratio = maxHandleOffset / maxScrollDistance;\n  }\n\n  /**\n   * Create all the DOM elements required for a scrollbar.\n   * The resulting widget is not sized.\n   *\n   * @param opt_class A class to be applied to this scrollbar.\n   */\n  private createDom_(opt_class?: string) {\n    /* Create the following DOM:\n        <svg class=\"blocklyScrollbarHorizontal  optionalClass\">\n          <g>\n            <rect class=\"blocklyScrollbarBackground\" />\n            <rect class=\"blocklyScrollbarHandle\" rx=\"8\" ry=\"8\" />\n          </g>\n        </svg>\n        */\n    let className =\n        'blocklyScrollbar' + (this.horizontal ? 'Horizontal' : 'Vertical');\n    if (opt_class) {\n      className += ' ' + opt_class;\n    }\n    this.outerSvg_ = dom.createSvgElement(Svg.SVG, {'class': className});\n    this.svgGroup_ = dom.createSvgElement(Svg.G, {}, this.outerSvg_);\n    this.svgBackground_ = dom.createSvgElement(\n        Svg.RECT, {'class': 'blocklyScrollbarBackground'}, this.svgGroup_);\n    const radius = Math.floor((Scrollbar.scrollbarThickness - 5) / 2);\n    this.svgHandle_ = dom.createSvgElement(\n        Svg.RECT,\n        {'class': 'blocklyScrollbarHandle', 'rx': radius, 'ry': radius},\n        this.svgGroup_);\n    this.workspace.getThemeManager().subscribe(\n        this.svgHandle_!, 'scrollbarColour', 'fill');\n    this.workspace.getThemeManager().subscribe(\n        this.svgHandle_!, 'scrollbarOpacity', 'fill-opacity');\n    dom.insertAfter(this.outerSvg_!, this.workspace.getParentSvg());\n  }\n\n  /**\n   * Is the scrollbar visible.  Non-paired scrollbars disappear when they aren't\n   * needed.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.isVisible_;\n  }\n\n  /**\n   * Set whether the scrollbar's container is visible and update\n   * display accordingly if visibility has changed.\n   *\n   * @param visible Whether the container is visible\n   */\n  setContainerVisible(visible: boolean) {\n    const visibilityChanged = visible !== this.containerVisible_;\n\n    this.containerVisible_ = visible;\n    if (visibilityChanged) {\n      this.updateDisplay_();\n    }\n  }\n\n  /**\n   * Set whether the scrollbar is visible.\n   * Only applies to non-paired scrollbars.\n   *\n   * @param visible True if visible.\n   */\n  setVisible(visible: boolean) {\n    const visibilityChanged = visible !== this.isVisible();\n\n    // Ideally this would also apply to scrollbar pairs, but that's a bigger\n    // headache (due to interactions with the corner square).\n    if (this.pair_) {\n      throw Error('Unable to toggle visibility of paired scrollbars.');\n    }\n    this.isVisible_ = visible;\n    if (visibilityChanged) {\n      this.updateDisplay_();\n    }\n  }\n\n  /**\n   * Update visibility of scrollbar based on whether it thinks it should\n   * be visible and whether its containing workspace is visible.\n   * We cannot rely on the containing workspace being hidden to hide us\n   * because it is not necessarily our parent in the DOM.\n   */\n  updateDisplay_() {\n    let show = true;\n    // Check whether our parent/container is visible.\n    if (!this.containerVisible_) {\n      show = false;\n    } else {\n      show = this.isVisible();\n    }\n    if (show) {\n      this.outerSvg_!.setAttribute('display', 'block');\n    } else {\n      this.outerSvg_!.setAttribute('display', 'none');\n    }\n  }\n\n  /**\n   * Scroll by one pageful.\n   * Called when scrollbar background is clicked.\n   *\n   * @param e Mouse down event.\n   */\n  private onMouseDownBar_(e: MouseEvent) {\n    this.workspace.markFocused();\n    Touch.clearTouchIdentifier();  // This is really a click.\n    this.cleanUp_();\n    if (browserEvents.isRightButton(e)) {\n      // Right-click.\n      // Scrollbars have no context menu.\n      e.stopPropagation();\n      return;\n    }\n    const mouseXY = browserEvents.mouseToSvg(\n        e, this.workspace.getParentSvg(), this.workspace.getInverseScreenCTM());\n    const mouseLocation = this.horizontal ? mouseXY.x : mouseXY.y;\n\n    const handleXY = svgMath.getInjectionDivXY(this.svgHandle_ as Element);\n    const handleStart = this.horizontal ? handleXY.x : handleXY.y;\n    let handlePosition = this.handlePosition_;\n\n    const pageLength = this.handleLength_ * 0.95;\n    if (mouseLocation <= handleStart) {\n      // Decrease the scrollbar's value by a page.\n      handlePosition -= pageLength;\n    } else if (mouseLocation >= handleStart + this.handleLength_) {\n      // Increase the scrollbar's value by a page.\n      handlePosition += pageLength;\n    }\n\n    this.setHandlePosition(this.constrainHandlePosition_(handlePosition));\n\n    this.updateMetrics_();\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  /**\n   * Start a dragging operation.\n   * Called when scrollbar handle is clicked.\n   *\n   * @param e Mouse down event.\n   */\n  private onMouseDownHandle_(e: MouseEvent) {\n    this.workspace.markFocused();\n    this.cleanUp_();\n    if (browserEvents.isRightButton(e)) {\n      // Right-click.\n      // Scrollbars have no context menu.\n      e.stopPropagation();\n      return;\n    }\n    // Look up the current translation and record it.\n    this.startDragHandle = this.handlePosition_;\n\n    // Tell the workspace to setup its drag surface since it is about to move.\n    // onMouseMoveHandle will call onScroll which actually tells the workspace\n    // to move.\n    this.workspace.setupDragSurface();\n\n    // Record the current mouse position.\n    this.startDragMouse_ = this.horizontal ? e.clientX : e.clientY;\n    this.onMouseUpWrapper_ = browserEvents.conditionalBind(\n        document, 'mouseup', this, this.onMouseUpHandle_);\n    this.onMouseMoveWrapper_ = browserEvents.conditionalBind(\n        document, 'mousemove', this, this.onMouseMoveHandle_);\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  /**\n   * Drag the scrollbar's handle.\n   *\n   * @param e Mouse move event.\n   */\n  private onMouseMoveHandle_(e: MouseEvent) {\n    const currentMouse = this.horizontal ? e.clientX : e.clientY;\n    const mouseDelta = currentMouse - this.startDragMouse_;\n    const handlePosition = this.startDragHandle + mouseDelta;\n    // Position the bar.\n    this.setHandlePosition(this.constrainHandlePosition_(handlePosition));\n    this.updateMetrics_();\n  }\n\n  /** Release the scrollbar handle and reset state accordingly. */\n  private onMouseUpHandle_() {\n    // Tell the workspace to clean up now that the workspace is done moving.\n    this.workspace.resetDragSurface();\n    Touch.clearTouchIdentifier();\n    this.cleanUp_();\n  }\n\n  /**\n   * Hide chaff and stop binding to mouseup and mousemove events.  Call this to\n   * wrap up loose ends associated with the scrollbar.\n   */\n  private cleanUp_() {\n    this.workspace.hideChaff(true);\n    if (this.onMouseUpWrapper_) {\n      browserEvents.unbind(this.onMouseUpWrapper_);\n      this.onMouseUpWrapper_ = null;\n    }\n    if (this.onMouseMoveWrapper_) {\n      browserEvents.unbind(this.onMouseMoveWrapper_);\n      this.onMouseMoveWrapper_ = null;\n    }\n  }\n\n  /**\n   * Helper to calculate the ratio of handle position to scrollbar view size.\n   *\n   * @returns Ratio.\n   * @internal\n   */\n  getRatio_(): number {\n    const scrollHandleRange = this.scrollbarLength_ - this.handleLength_;\n    let ratio = this.handlePosition_ / scrollHandleRange;\n    if (isNaN(ratio)) {\n      ratio = 0;\n    }\n    return ratio;\n  }\n\n  /**\n   * Updates workspace metrics based on new scroll ratio. Called when scrollbar\n   * is moved.\n   */\n  private updateMetrics_() {\n    const ratio = this.getRatio_();\n    if (this.horizontal) {\n      this.workspace.setMetrics({x: ratio});\n    } else {\n      this.workspace.setMetrics({y: ratio});\n    }\n  }\n\n  /**\n   * Set the scrollbar handle's position.\n   *\n   * @param value The content displacement, relative to the view in pixels.\n   * @param updateMetrics Whether to update metrics on this set call.\n   *    Defaults to true.\n   */\n  set(value: number, updateMetrics?: boolean) {\n    this.setHandlePosition(this.constrainHandlePosition_(value * this.ratio));\n    if (updateMetrics || updateMetrics === undefined) {\n      this.updateMetrics_();\n    }\n  }\n\n  /**\n   * Record the origin of the workspace that the scrollbar is in, in pixels\n   * relative to the injection div origin. This is for times when the scrollbar\n   * is used in an object whose origin isn't the same as the main workspace\n   * (e.g. in a flyout.)\n   *\n   * @param x The x coordinate of the scrollbar's origin, in CSS pixels.\n   * @param y The y coordinate of the scrollbar's origin, in CSS pixels.\n   */\n  setOrigin(x: number, y: number) {\n    this.origin_ = new Coordinate(x, y);\n  }\n\n  /**\n   * @param first An object containing computed measurements of a workspace.\n   * @param second Another object containing computed measurements of a\n   *     workspace.\n   * @returns Whether the two sets of metrics are equivalent.\n   */\n  private static metricsAreEquivalent_(first: Metrics, second: Metrics):\n      boolean {\n    return first.viewWidth === second.viewWidth &&\n        first.viewHeight === second.viewHeight &&\n        first.viewLeft === second.viewLeft &&\n        first.viewTop === second.viewTop &&\n        first.absoluteTop === second.absoluteTop &&\n        first.absoluteLeft === second.absoluteLeft &&\n        first.scrollWidth === second.scrollWidth &&\n        first.scrollHeight === second.scrollHeight &&\n        first.scrollLeft === second.scrollLeft &&\n        first.scrollTop === second.scrollTop;\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a UI bubble.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Bubble');\n\nimport type {BlockDragSurfaceSvg} from './block_drag_surface.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport type {IBubble} from './interfaces/i_bubble.js';\nimport type {ContainerRegion} from './metrics_manager.js';\nimport {Scrollbar} from './scrollbar.js';\nimport * as Touch from './touch.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as math from './utils/math.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Class for UI bubble.\n *\n * @alias Blockly.Bubble\n */\nexport class Bubble implements IBubble {\n  /** Width of the border around the bubble. */\n  static BORDER_WIDTH = 6;\n\n  /**\n   * Determines the thickness of the base of the arrow in relation to the size\n   * of the bubble.  Higher numbers result in thinner arrows.\n   */\n  static ARROW_THICKNESS = 5;\n\n  /** The number of degrees that the arrow bends counter-clockwise. */\n  static ARROW_ANGLE = 20;\n\n  /**\n   * The sharpness of the arrow's bend.  Higher numbers result in smoother\n   * arrows.\n   */\n  static ARROW_BEND = 4;\n\n  /** Distance between arrow point and anchor point. */\n  static ANCHOR_RADIUS = 8;\n\n  /** Mouse up event data. */\n  private static onMouseUpWrapper_: browserEvents.Data|null = null;\n\n  /** Mouse move event data. */\n  private static onMouseMoveWrapper_: browserEvents.Data|null = null;\n  workspace_: WorkspaceSvg;\n  content_: SVGElement;\n  shape_: SVGElement;\n\n  /** Flag to stop incremental rendering during construction. */\n  private readonly rendered_: boolean;\n\n  /** The SVG group containing all parts of the bubble. */\n  private bubbleGroup_: SVGGElement|null = null;\n\n  /**\n   * The SVG path for the arrow from the bubble to the icon on the block.\n   */\n  private bubbleArrow_: SVGPathElement|null = null;\n\n  /** The SVG rect for the main body of the bubble. */\n  private bubbleBack_: SVGRectElement|null = null;\n\n  /** The SVG group for the resize hash marks on some bubbles. */\n  private resizeGroup_: SVGGElement|null = null;\n\n  /** Absolute coordinate of anchor point, in workspace coordinates. */\n  private anchorXY_!: Coordinate;\n\n  /**\n   * Relative X coordinate of bubble with respect to the anchor's centre,\n   * in workspace units.\n   * In RTL mode the initial value is negated.\n   */\n  private relativeLeft_ = 0;\n\n  /**\n   * Relative Y coordinate of bubble with respect to the anchor's centre, in\n   * workspace units.\n   */\n  private relativeTop_ = 0;\n\n  /** Width of bubble, in workspace units. */\n  private width_ = 0;\n\n  /** Height of bubble, in workspace units. */\n  private height_ = 0;\n\n  /** Automatically position and reposition the bubble. */\n  private autoLayout_ = true;\n\n  /** Method to call on resize of bubble. */\n  private resizeCallback_: (() => void)|null = null;\n\n  /** Method to call on move of bubble. */\n  private moveCallback_: (() => void)|null = null;\n\n  /** Mouse down on bubbleBack_ event data. */\n  private onMouseDownBubbleWrapper_: browserEvents.Data|null = null;\n\n  /** Mouse down on resizeGroup_ event data. */\n  private onMouseDownResizeWrapper_: browserEvents.Data|null = null;\n\n  /**\n   * Describes whether this bubble has been disposed of (nodes and event\n   * listeners removed from the page) or not.\n   *\n   * @internal\n   */\n  disposed = false;\n  private arrow_radians_: number;\n\n  /**\n   * @param workspace The workspace on which to draw the bubble.\n   * @param content SVG content for the bubble.\n   * @param shape SVG element to avoid eclipsing.\n   * @param anchorXY Absolute position of bubble's anchor point.\n   * @param bubbleWidth Width of bubble, or null if not resizable.\n   * @param bubbleHeight Height of bubble, or null if not resizable.\n   */\n  constructor(\n      workspace: WorkspaceSvg, content: SVGElement, shape: SVGElement,\n      anchorXY: Coordinate, bubbleWidth: number|null,\n      bubbleHeight: number|null) {\n    this.rendered_ = false;\n    this.workspace_ = workspace;\n    this.content_ = content;\n    this.shape_ = shape;\n\n    let angle = Bubble.ARROW_ANGLE;\n    if (this.workspace_.RTL) {\n      angle = -angle;\n    }\n    this.arrow_radians_ = math.toRadians(angle);\n\n    const canvas = workspace.getBubbleCanvas();\n    canvas.appendChild(\n        this.createDom_(content, !!(bubbleWidth && bubbleHeight)));\n\n    this.setAnchorLocation(anchorXY);\n    if (!bubbleWidth || !bubbleHeight) {\n      const bBox = (this.content_ as SVGGraphicsElement).getBBox();\n      bubbleWidth = bBox.width + 2 * Bubble.BORDER_WIDTH;\n      bubbleHeight = bBox.height + 2 * Bubble.BORDER_WIDTH;\n    }\n    this.setBubbleSize(bubbleWidth, bubbleHeight);\n\n    // Render the bubble.\n    this.positionBubble_();\n    this.renderArrow_();\n    this.rendered_ = true;\n  }\n\n  /**\n   * Create the bubble's DOM.\n   *\n   * @param content SVG content for the bubble.\n   * @param hasResize Add diagonal resize gripper if true.\n   * @returns The bubble's SVG group.\n   */\n  private createDom_(content: Element, hasResize: boolean): SVGElement {\n    /* Create the bubble.  Here's the markup that will be generated:\n        <g>\n          <g filter=\"url(#blocklyEmbossFilter837493)\">\n            <path d=\"... Z\" />\n            <rect class=\"blocklyDraggable\" rx=\"8\" ry=\"8\" width=\"180\"\n       height=\"180\"/>\n          </g>\n          <g transform=\"translate(165, 165)\" class=\"blocklyResizeSE\">\n            <polygon points=\"0,15 15,15 15,0\"/>\n            <line class=\"blocklyResizeLine\" x1=\"5\" y1=\"14\" x2=\"14\" y2=\"5\"/>\n            <line class=\"blocklyResizeLine\" x1=\"10\" y1=\"14\" x2=\"14\" y2=\"10\"/>\n          </g>\n          [...content goes here...]\n        </g>\n        */\n    this.bubbleGroup_ = dom.createSvgElement(Svg.G, {});\n    let filter: {filter?: string} = {\n      'filter': 'url(#' +\n          this.workspace_.getRenderer().getConstants().embossFilterId + ')',\n    };\n    if (userAgent.JavaFx) {\n      // Multiple reports that JavaFX can't handle filters.\n      // https://github.com/google/blockly/issues/99\n      filter = {};\n    }\n    const bubbleEmboss = dom.createSvgElement(Svg.G, filter, this.bubbleGroup_);\n    this.bubbleArrow_ = dom.createSvgElement(Svg.PATH, {}, bubbleEmboss);\n    this.bubbleBack_ = dom.createSvgElement(\n        Svg.RECT, {\n          'class': 'blocklyDraggable',\n          'x': 0,\n          'y': 0,\n          'rx': Bubble.BORDER_WIDTH,\n          'ry': Bubble.BORDER_WIDTH,\n        },\n        bubbleEmboss);\n    if (hasResize) {\n      this.resizeGroup_ = dom.createSvgElement(\n          Svg.G, {\n            'class': this.workspace_.RTL ? 'blocklyResizeSW' :\n                                           'blocklyResizeSE',\n          },\n          this.bubbleGroup_);\n      const resizeSize = 2 * Bubble.BORDER_WIDTH;\n      dom.createSvgElement(\n          Svg.POLYGON,\n          {'points': '0,x x,x x,0'.replace(/x/g, resizeSize.toString())},\n          this.resizeGroup_);\n      dom.createSvgElement(\n          Svg.LINE, {\n            'class': 'blocklyResizeLine',\n            'x1': resizeSize / 3,\n            'y1': resizeSize - 1,\n            'x2': resizeSize - 1,\n            'y2': resizeSize / 3,\n          },\n          this.resizeGroup_);\n      dom.createSvgElement(\n          Svg.LINE, {\n            'class': 'blocklyResizeLine',\n            'x1': resizeSize * 2 / 3,\n            'y1': resizeSize - 1,\n            'x2': resizeSize - 1,\n            'y2': resizeSize * 2 / 3,\n          },\n          this.resizeGroup_);\n    } else {\n      this.resizeGroup_ = null;\n    }\n\n    if (!this.workspace_.options.readOnly) {\n      this.onMouseDownBubbleWrapper_ = browserEvents.conditionalBind(\n          this.bubbleBack_, 'mousedown', this, this.bubbleMouseDown_);\n      if (this.resizeGroup_) {\n        this.onMouseDownResizeWrapper_ = browserEvents.conditionalBind(\n            this.resizeGroup_, 'mousedown', this, this.resizeMouseDown_);\n      }\n    }\n    this.bubbleGroup_.appendChild(content);\n    return this.bubbleGroup_;\n  }\n\n  /**\n   * Return the root node of the bubble's SVG group.\n   *\n   * @returns The root SVG node of the bubble's group.\n   */\n  getSvgRoot(): SVGElement {\n    return this.bubbleGroup_ as SVGElement;\n  }\n\n  /**\n   * Expose the block's ID on the bubble's top-level SVG group.\n   *\n   * @param id ID of block.\n   */\n  setSvgId(id: string) {\n    this.bubbleGroup_?.setAttribute('data-block-id', id);\n  }\n\n  /**\n   * Handle a mouse-down on bubble's border.\n   *\n   * @param e Mouse down event.\n   */\n  private bubbleMouseDown_(e: Event) {\n    const gesture = this.workspace_.getGesture(e);\n    if (gesture) {\n      gesture.handleBubbleStart(e, this);\n    }\n  }\n\n  /**\n   * Show the context menu for this bubble.\n   *\n   * @param _e Mouse event.\n   * @internal\n   */\n  showContextMenu(_e: Event) {}\n  // NOP on bubbles, but used by the bubble dragger to pass events to\n  // workspace comments.\n\n  /**\n   * Get whether this bubble is deletable or not.\n   *\n   * @returns True if deletable.\n   * @internal\n   */\n  isDeletable(): boolean {\n    return false;\n  }\n\n  /**\n   * Update the style of this bubble when it is dragged over a delete area.\n   *\n   * @param _enable True if the bubble is about to be deleted, false otherwise.\n   */\n  setDeleteStyle(_enable: boolean) {}\n  // NOP if bubble is not deletable.\n\n  /**\n   * Handle a mouse-down on bubble's resize corner.\n   *\n   * @param e Mouse down event.\n   */\n  private resizeMouseDown_(e: MouseEvent) {\n    this.promote();\n    Bubble.unbindDragEvents_();\n    if (browserEvents.isRightButton(e)) {\n      // No right-click.\n      e.stopPropagation();\n      return;\n    }\n    // Left-click (or middle click)\n    this.workspace_.startDrag(\n        e,\n        new Coordinate(\n            this.workspace_.RTL ? -this.width_ : this.width_, this.height_));\n\n    Bubble.onMouseUpWrapper_ = browserEvents.conditionalBind(\n        document, 'mouseup', this, Bubble.bubbleMouseUp_);\n    Bubble.onMouseMoveWrapper_ = browserEvents.conditionalBind(\n        document, 'mousemove', this, this.resizeMouseMove_);\n    this.workspace_.hideChaff();\n    // This event has been handled.  No need to bubble up to the document.\n    e.stopPropagation();\n  }\n\n  /**\n   * Resize this bubble to follow the mouse.\n   *\n   * @param e Mouse move event.\n   */\n  private resizeMouseMove_(e: MouseEvent) {\n    this.autoLayout_ = false;\n    const newXY = this.workspace_.moveDrag(e);\n    this.setBubbleSize(this.workspace_.RTL ? -newXY.x : newXY.x, newXY.y);\n    if (this.workspace_.RTL) {\n      // RTL requires the bubble to move its left edge.\n      this.positionBubble_();\n    }\n  }\n\n  /**\n   * Register a function as a callback event for when the bubble is resized.\n   *\n   * @param callback The function to call on resize.\n   */\n  registerResizeEvent(callback: () => void) {\n    this.resizeCallback_ = callback;\n  }\n\n  /**\n   * Register a function as a callback event for when the bubble is moved.\n   *\n   * @param callback The function to call on move.\n   */\n  registerMoveEvent(callback: () => void) {\n    this.moveCallback_ = callback;\n  }\n\n  /**\n   * Move this bubble to the top of the stack.\n   *\n   * @returns Whether or not the bubble has been moved.\n   * @internal\n   */\n  promote(): boolean {\n    const svgGroup = this.bubbleGroup_?.parentNode;\n    if (svgGroup?.lastChild !== this.bubbleGroup_ && this.bubbleGroup_) {\n      svgGroup?.appendChild(this.bubbleGroup_);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Notification that the anchor has moved.\n   * Update the arrow and bubble accordingly.\n   *\n   * @param xy Absolute location.\n   */\n  setAnchorLocation(xy: Coordinate) {\n    this.anchorXY_ = xy;\n    if (this.rendered_) {\n      this.positionBubble_();\n    }\n  }\n\n  /** Position the bubble so that it does not fall off-screen. */\n  private layoutBubble_() {\n    // Get the metrics in workspace units.\n    const viewMetrics =\n        this.workspace_.getMetricsManager().getViewMetrics(true);\n\n    const optimalLeft = this.getOptimalRelativeLeft_(viewMetrics);\n    const optimalTop = this.getOptimalRelativeTop_(viewMetrics);\n    const bbox = (this.shape_ as SVGGraphicsElement).getBBox();\n\n    const topPosition = {\n      x: optimalLeft,\n      y: -this.height_ -\n              this.workspace_.getRenderer().getConstants().MIN_BLOCK_HEIGHT as\n          number,\n    };\n    const startPosition = {x: -this.width_ - 30, y: optimalTop};\n    const endPosition = {x: bbox.width, y: optimalTop};\n    const bottomPosition = {x: optimalLeft, y: bbox.height};\n\n    const closerPosition =\n        bbox.width < bbox.height ? endPosition : bottomPosition;\n    const fartherPosition =\n        bbox.width < bbox.height ? bottomPosition : endPosition;\n\n    const topPositionOverlap = this.getOverlap_(topPosition, viewMetrics);\n    const startPositionOverlap = this.getOverlap_(startPosition, viewMetrics);\n    const closerPositionOverlap = this.getOverlap_(closerPosition, viewMetrics);\n    const fartherPositionOverlap =\n        this.getOverlap_(fartherPosition, viewMetrics);\n\n    // Set the position to whichever position shows the most of the bubble,\n    // with tiebreaks going in the order: top > start > close > far.\n    const mostOverlap = Math.max(\n        topPositionOverlap, startPositionOverlap, closerPositionOverlap,\n        fartherPositionOverlap);\n    if (topPositionOverlap === mostOverlap) {\n      this.relativeLeft_ = topPosition.x;\n      this.relativeTop_ = topPosition.y;\n      return;\n    }\n    if (startPositionOverlap === mostOverlap) {\n      this.relativeLeft_ = startPosition.x;\n      this.relativeTop_ = startPosition.y;\n      return;\n    }\n    if (closerPositionOverlap === mostOverlap) {\n      this.relativeLeft_ = closerPosition.x;\n      this.relativeTop_ = closerPosition.y;\n      return;\n    }\n    // TODO: I believe relativeLeft_ should actually be called relativeStart_\n    //  and then the math should be fixed to reflect this. (hopefully it'll\n    //  make it look simpler)\n    this.relativeLeft_ = fartherPosition.x;\n    this.relativeTop_ = fartherPosition.y;\n  }\n\n  /**\n   * Calculate the what percentage of the bubble overlaps with the visible\n   * workspace (what percentage of the bubble is visible).\n   *\n   * @param relativeMin The position of the top-left corner of the bubble\n   *     relative to the anchor point.\n   * @param viewMetrics The view metrics of the workspace the bubble will appear\n   *     in.\n   * @returns The percentage of the bubble that is visible.\n   */\n  private getOverlap_(\n      relativeMin: {x: number, y: number},\n      viewMetrics: ContainerRegion): number {\n    // The position of the top-left corner of the bubble in workspace units.\n    const bubbleMin = {\n      x: this.workspace_.RTL ? this.anchorXY_.x - relativeMin.x - this.width_ :\n                               relativeMin.x + this.anchorXY_.x,\n      y: relativeMin.y + this.anchorXY_.y,\n    };\n    // The position of the bottom-right corner of the bubble in workspace units.\n    const bubbleMax = {\n      x: bubbleMin.x + this.width_,\n      y: bubbleMin.y + this.height_,\n    };\n\n    // We could adjust these values to account for the scrollbars, but the\n    // bubbles should have been adjusted to not collide with them anyway, so\n    // giving the workspace a slightly larger \"bounding box\" shouldn't affect\n    // the calculation.\n\n    // The position of the top-left corner of the workspace.\n    const workspaceMin = {x: viewMetrics.left, y: viewMetrics.top};\n    // The position of the bottom-right corner of the workspace.\n    const workspaceMax = {\n      x: viewMetrics.left + viewMetrics.width,\n      y: viewMetrics.top + viewMetrics.height,\n    };\n\n    const overlapWidth = Math.min(bubbleMax.x, workspaceMax.x) -\n        Math.max(bubbleMin.x, workspaceMin.x);\n    const overlapHeight = Math.min(bubbleMax.y, workspaceMax.y) -\n        Math.max(bubbleMin.y, workspaceMin.y);\n    return Math.max(\n        0,\n        Math.min(\n            1, overlapWidth * overlapHeight / (this.width_ * this.height_)));\n  }\n\n  /**\n   * Calculate what the optimal horizontal position of the top-left corner of\n   * the bubble is (relative to the anchor point) so that the most area of the\n   * bubble is shown.\n   *\n   * @param viewMetrics The view metrics of the workspace the bubble will appear\n   *     in.\n   * @returns The optimal horizontal position of the top-left corner of the\n   *     bubble.\n   */\n  private getOptimalRelativeLeft_(viewMetrics: ContainerRegion): number {\n    let relativeLeft = -this.width_ / 4;\n\n    // No amount of sliding left or right will give us a better overlap.\n    if (this.width_ > viewMetrics.width) {\n      return relativeLeft;\n    }\n\n    if (this.workspace_.RTL) {\n      // Bubble coordinates are flipped in RTL.\n      const bubbleRight = this.anchorXY_.x - relativeLeft;\n      const bubbleLeft = bubbleRight - this.width_;\n\n      const workspaceRight = viewMetrics.left + viewMetrics.width;\n      const workspaceLeft = viewMetrics.left +\n          // Thickness in workspace units.\n          Scrollbar.scrollbarThickness / this.workspace_.scale;\n\n      if (bubbleLeft < workspaceLeft) {\n        // Slide the bubble right until it is onscreen.\n        relativeLeft = -(workspaceLeft - this.anchorXY_.x + this.width_);\n      } else if (bubbleRight > workspaceRight) {\n        // Slide the bubble left until it is onscreen.\n        relativeLeft = -(workspaceRight - this.anchorXY_.x);\n      }\n    } else {\n      const bubbleLeft = relativeLeft + this.anchorXY_.x;\n      const bubbleRight = bubbleLeft + this.width_;\n\n      const workspaceLeft = viewMetrics.left;\n      const workspaceRight = viewMetrics.left + viewMetrics.width -\n          // Thickness in workspace units.\n          Scrollbar.scrollbarThickness / this.workspace_.scale;\n\n      if (bubbleLeft < workspaceLeft) {\n        // Slide the bubble right until it is onscreen.\n        relativeLeft = workspaceLeft - this.anchorXY_.x;\n      } else if (bubbleRight > workspaceRight) {\n        // Slide the bubble left until it is onscreen.\n        relativeLeft = workspaceRight - this.anchorXY_.x - this.width_;\n      }\n    }\n\n    return relativeLeft;\n  }\n\n  /**\n   * Calculate what the optimal vertical position of the top-left corner of\n   * the bubble is (relative to the anchor point) so that the most area of the\n   * bubble is shown.\n   *\n   * @param viewMetrics The view metrics of the workspace the bubble will appear\n   *     in.\n   * @returns The optimal vertical position of the top-left corner of the\n   *     bubble.\n   */\n  private getOptimalRelativeTop_(viewMetrics: ContainerRegion): number {\n    let relativeTop = -this.height_ / 4;\n\n    // No amount of sliding up or down will give us a better overlap.\n    if (this.height_ > viewMetrics.height) {\n      return relativeTop;\n    }\n\n    const bubbleTop = this.anchorXY_.y + relativeTop;\n    const bubbleBottom = bubbleTop + this.height_;\n    const workspaceTop = viewMetrics.top;\n    const workspaceBottom = viewMetrics.top +\n        viewMetrics.height -  // Thickness in workspace units.\n        Scrollbar.scrollbarThickness / this.workspace_.scale;\n\n    const anchorY = this.anchorXY_.y;\n    if (bubbleTop < workspaceTop) {\n      // Slide the bubble down until it is onscreen.\n      relativeTop = workspaceTop - anchorY;\n    } else if (bubbleBottom > workspaceBottom) {\n      // Slide the bubble up until it is onscreen.\n      relativeTop = workspaceBottom - anchorY - this.height_;\n    }\n\n    return relativeTop;\n  }\n\n  /** Move the bubble to a location relative to the anchor's centre. */\n  private positionBubble_() {\n    let left = this.anchorXY_.x;\n    if (this.workspace_.RTL) {\n      left -= this.relativeLeft_ + this.width_;\n    } else {\n      left += this.relativeLeft_;\n    }\n    const top = this.relativeTop_ + this.anchorXY_.y;\n    this.moveTo(left, top);\n  }\n\n  /**\n   * Move the bubble group to the specified location in workspace coordinates.\n   *\n   * @param x The x position to move to.\n   * @param y The y position to move to.\n   * @internal\n   */\n  moveTo(x: number, y: number) {\n    this.bubbleGroup_?.setAttribute(\n        'transform', 'translate(' + x + ',' + y + ')');\n  }\n\n  /**\n   * Triggers a move callback if one exists at the end of a drag.\n   *\n   * @param adding True if adding, false if removing.\n   * @internal\n   */\n  setDragging(adding: boolean) {\n    if (!adding && this.moveCallback_) {\n      this.moveCallback_();\n    }\n  }\n\n  /**\n   * Get the dimensions of this bubble.\n   *\n   * @returns The height and width of the bubble.\n   */\n  getBubbleSize(): Size {\n    return new Size(this.width_, this.height_);\n  }\n\n  /**\n   * Size this bubble.\n   *\n   * @param width Width of the bubble.\n   * @param height Height of the bubble.\n   */\n  setBubbleSize(width: number, height: number) {\n    const doubleBorderWidth = 2 * Bubble.BORDER_WIDTH;\n    // Minimum size of a bubble.\n    width = Math.max(width, doubleBorderWidth + 45);\n    height = Math.max(height, doubleBorderWidth + 20);\n    this.width_ = width;\n    this.height_ = height;\n    this.bubbleBack_?.setAttribute('width', width.toString());\n    this.bubbleBack_?.setAttribute('height', height.toString());\n    if (this.resizeGroup_) {\n      if (this.workspace_.RTL) {\n        // Mirror the resize group.\n        const resizeSize = 2 * Bubble.BORDER_WIDTH;\n        this.resizeGroup_.setAttribute(\n            'transform',\n            'translate(' + resizeSize + ',' + (height - doubleBorderWidth) +\n                ') scale(-1 1)');\n      } else {\n        this.resizeGroup_.setAttribute(\n            'transform',\n            'translate(' + (width - doubleBorderWidth) + ',' +\n                (height - doubleBorderWidth) + ')');\n      }\n    }\n    if (this.autoLayout_) {\n      this.layoutBubble_();\n    }\n    this.positionBubble_();\n    this.renderArrow_();\n\n    // Allow the contents to resize.\n    if (this.resizeCallback_) {\n      this.resizeCallback_();\n    }\n  }\n\n  /** Draw the arrow between the bubble and the origin. */\n  private renderArrow_() {\n    const steps = [];\n    // Find the relative coordinates of the center of the bubble.\n    const relBubbleX = this.width_ / 2;\n    const relBubbleY = this.height_ / 2;\n    // Find the relative coordinates of the center of the anchor.\n    let relAnchorX = -this.relativeLeft_;\n    let relAnchorY = -this.relativeTop_;\n    if (relBubbleX === relAnchorX && relBubbleY === relAnchorY) {\n      // Null case.  Bubble is directly on top of the anchor.\n      // Short circuit this rather than wade through divide by zeros.\n      steps.push('M ' + relBubbleX + ',' + relBubbleY);\n    } else {\n      // Compute the angle of the arrow's line.\n      const rise = relAnchorY - relBubbleY;\n      let run = relAnchorX - relBubbleX;\n      if (this.workspace_.RTL) {\n        run *= -1;\n      }\n      const hypotenuse = Math.sqrt(rise * rise + run * run);\n      let angle = Math.acos(run / hypotenuse);\n      if (rise < 0) {\n        angle = 2 * Math.PI - angle;\n      }\n      // Compute a line perpendicular to the arrow.\n      let rightAngle = angle + Math.PI / 2;\n      if (rightAngle > Math.PI * 2) {\n        rightAngle -= Math.PI * 2;\n      }\n      const rightRise = Math.sin(rightAngle);\n      const rightRun = Math.cos(rightAngle);\n\n      // Calculate the thickness of the base of the arrow.\n      const bubbleSize = this.getBubbleSize();\n      let thickness =\n          (bubbleSize.width + bubbleSize.height) / Bubble.ARROW_THICKNESS;\n      thickness = Math.min(thickness, bubbleSize.width, bubbleSize.height) / 4;\n\n      // Back the tip of the arrow off of the anchor.\n      const backoffRatio = 1 - Bubble.ANCHOR_RADIUS / hypotenuse;\n      relAnchorX = relBubbleX + backoffRatio * run;\n      relAnchorY = relBubbleY + backoffRatio * rise;\n\n      // Coordinates for the base of the arrow.\n      const baseX1 = relBubbleX + thickness * rightRun;\n      const baseY1 = relBubbleY + thickness * rightRise;\n      const baseX2 = relBubbleX - thickness * rightRun;\n      const baseY2 = relBubbleY - thickness * rightRise;\n\n      // Distortion to curve the arrow.\n      let swirlAngle = angle + this.arrow_radians_;\n      if (swirlAngle > Math.PI * 2) {\n        swirlAngle -= Math.PI * 2;\n      }\n      const swirlRise = Math.sin(swirlAngle) * hypotenuse / Bubble.ARROW_BEND;\n      const swirlRun = Math.cos(swirlAngle) * hypotenuse / Bubble.ARROW_BEND;\n\n      steps.push('M' + baseX1 + ',' + baseY1);\n      steps.push(\n          'C' + (baseX1 + swirlRun) + ',' + (baseY1 + swirlRise) + ' ' +\n          relAnchorX + ',' + relAnchorY + ' ' + relAnchorX + ',' + relAnchorY);\n      steps.push(\n          'C' + relAnchorX + ',' + relAnchorY + ' ' + (baseX2 + swirlRun) +\n          ',' + (baseY2 + swirlRise) + ' ' + baseX2 + ',' + baseY2);\n    }\n    steps.push('z');\n    this.bubbleArrow_?.setAttribute('d', steps.join(' '));\n  }\n\n  /**\n   * Change the colour of a bubble.\n   *\n   * @param hexColour Hex code of colour.\n   */\n  setColour(hexColour: string) {\n    this.bubbleBack_?.setAttribute('fill', hexColour);\n    this.bubbleArrow_?.setAttribute('fill', hexColour);\n  }\n\n  /** Dispose of this bubble. */\n  dispose() {\n    if (this.onMouseDownBubbleWrapper_) {\n      browserEvents.unbind(this.onMouseDownBubbleWrapper_);\n    }\n    if (this.onMouseDownResizeWrapper_) {\n      browserEvents.unbind(this.onMouseDownResizeWrapper_);\n    }\n    Bubble.unbindDragEvents_();\n    dom.removeNode(this.bubbleGroup_);\n    this.disposed = true;\n  }\n\n  /**\n   * Move this bubble during a drag, taking into account whether or not there is\n   * a drag surface.\n   *\n   * @param dragSurface The surface that carries rendered items during a drag,\n   *     or null if no drag surface is in use.\n   * @param newLoc The location to translate to, in workspace coordinates.\n   * @internal\n   */\n  moveDuringDrag(dragSurface: BlockDragSurfaceSvg, newLoc: Coordinate) {\n    if (dragSurface) {\n      dragSurface.translateSurface(newLoc.x, newLoc.y);\n    } else {\n      this.moveTo(newLoc.x, newLoc.y);\n    }\n    if (this.workspace_.RTL) {\n      this.relativeLeft_ = this.anchorXY_.x - newLoc.x - this.width_;\n    } else {\n      this.relativeLeft_ = newLoc.x - this.anchorXY_.x;\n    }\n    this.relativeTop_ = newLoc.y - this.anchorXY_.y;\n    this.renderArrow_();\n  }\n\n  /**\n   * Return the coordinates of the top-left corner of this bubble's body\n   * relative to the drawing surface's origin (0,0), in workspace units.\n   *\n   * @returns Object with .x and .y properties.\n   */\n  getRelativeToSurfaceXY(): Coordinate {\n    return new Coordinate(\n        this.workspace_.RTL ?\n            -this.relativeLeft_ + this.anchorXY_.x - this.width_ :\n            this.anchorXY_.x + this.relativeLeft_,\n        this.anchorXY_.y + this.relativeTop_);\n  }\n\n  /**\n   * Set whether auto-layout of this bubble is enabled.  The first time a bubble\n   * is shown it positions itself to not cover any blocks.  Once a user has\n   * dragged it to reposition, it renders where the user put it.\n   *\n   * @param enable True if auto-layout should be enabled, false otherwise.\n   * @internal\n   */\n  setAutoLayout(enable: boolean) {\n    this.autoLayout_ = enable;\n  }\n\n  /** Stop binding to the global mouseup and mousemove events. */\n  private static unbindDragEvents_() {\n    if (Bubble.onMouseUpWrapper_) {\n      browserEvents.unbind(Bubble.onMouseUpWrapper_);\n      Bubble.onMouseUpWrapper_ = null;\n    }\n    if (Bubble.onMouseMoveWrapper_) {\n      browserEvents.unbind(Bubble.onMouseMoveWrapper_);\n      Bubble.onMouseMoveWrapper_ = null;\n    }\n  }\n\n  /**\n   * Handle a mouse-up event while dragging a bubble's border or resize handle.\n   *\n   * @param _e Mouse up event.\n   */\n  private static bubbleMouseUp_(_e: MouseEvent) {\n    Touch.clearTouchIdentifier();\n    Bubble.unbindDragEvents_();\n  }\n\n  /**\n   * Create the text for a non editable bubble.\n   *\n   * @param text The text to display.\n   * @returns The top-level node of the text.\n   * @internal\n   */\n  static textToDom(text: string): SVGTextElement {\n    const paragraph = dom.createSvgElement(Svg.TEXT, {\n      'class': 'blocklyText blocklyBubbleText blocklyNoPointerEvents',\n      'y': Bubble.BORDER_WIDTH,\n    });\n    const lines = text.split('\\n');\n    for (let i = 0; i < lines.length; i++) {\n      const tspanElement = dom.createSvgElement(\n          Svg.TSPAN, {'dy': '1em', 'x': Bubble.BORDER_WIDTH}, paragraph);\n      const textNode = document.createTextNode(lines[i]);\n      tspanElement.appendChild(textNode);\n    }\n    return paragraph;\n  }\n\n  /**\n   * Creates a bubble that can not be edited.\n   *\n   * @param paragraphElement The text element for the non editable bubble.\n   * @param block The block that the bubble is attached to.\n   * @param iconXY The coordinate of the icon.\n   * @returns The non editable bubble.\n   * @internal\n   */\n  static createNonEditableBubble(\n      paragraphElement: SVGTextElement, block: BlockSvg,\n      iconXY: Coordinate): Bubble {\n    const bubble = new Bubble(\n        block.workspace!, paragraphElement, block.pathObject.svgPath, (iconXY),\n        null, null);\n    // Expose this bubble's block's ID on its top-level SVG group.\n    bubble.setSvgId(block.id);\n    if (block.RTL) {\n      // Right-align the paragraph.\n      // This cannot be done until the bubble is rendered on screen.\n      const maxWidth = paragraphElement.getBBox().width;\n      for (let i = 0, textElement;\n           textElement = paragraphElement.childNodes[i] as SVGTSpanElement;\n           i++) {\n        textElement.setAttribute('text-anchor', 'end');\n        textElement.setAttribute(\n            'x', (maxWidth + Bubble.BORDER_WIDTH).toString());\n      }\n    }\n    return bubble;\n  }\n}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * All the values that we expect developers to be able to change\n * before injecting Blockly. Changing these values during run time is not\n * generally recommended.\n *\n * @namespace Blockly.config\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.config');\n\n\n/**\n * All the values that we expect developers to be able to change\n * before injecting Blockly.\n */\ninterface Config {\n  dragRadius: number;\n  flyoutDragRadius: number;\n  snapRadius: number;\n  currentConnectionPreference: number;\n  bumpDelay: number;\n  connectingSnapRadius: number;\n}\n\n/** Default snap radius. */\nconst DEFAULT_SNAP_RADIUS = 28;\n\n/**\n * Object holding all the values on Blockly that we expect developers to be\n * able to change.\n */\nexport const config: Config = {\n  /**\n   * Number of pixels the mouse must move before a drag starts.\n   *\n   * @alias Blockly.config.dragRadius\n   */\n  dragRadius: 5,\n  /**\n   * Number of pixels the mouse must move before a drag/scroll starts from the\n   * flyout.  Because the drag-intention is determined when this is reached, it\n   * is larger than dragRadius so that the drag-direction is clearer.\n   *\n   * @alias Blockly.config.flyoutDragRadius\n   */\n  flyoutDragRadius: 10,\n  /**\n   * Maximum misalignment between connections for them to snap together.\n   *\n   * @alias Blockly.config.snapRadius\n   */\n  snapRadius: DEFAULT_SNAP_RADIUS,\n  /**\n   * Maximum misalignment between connections for them to snap together.\n   * This should be the same as the snap radius.\n   *\n   * @alias Blockly.config.connectingSnapRadius\n   */\n  connectingSnapRadius: DEFAULT_SNAP_RADIUS,\n  /**\n   * How much to prefer staying connected to the current connection over moving\n   * to a new connection.  The current previewed connection is considered to be\n   * this much closer to the matching connection on the block than it actually\n   * is.\n   *\n   * @alias Blockly.config.currentConnectionPreference\n   */\n  currentConnectionPreference: 8,\n  /**\n   * Delay in ms between trigger and bumping unconnected block out of alignment.\n   *\n   * @alias Blockly.config.bumpDelay\n   */\n  bumpDelay: 250,\n};\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing an icon on a block.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Icon');\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport type {Bubble} from './bubble.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\n\n\n/**\n * Class for an icon.\n *\n * @alias Blockly.Icon\n */\nexport abstract class Icon {\n  protected block_: BlockSvg;\n  /** The icon SVG group. */\n  iconGroup_: SVGGElement|null = null;\n\n  /** Whether this icon gets hidden when the block is collapsed. */\n  collapseHidden = true;\n\n  /** Height and width of icons. */\n  readonly SIZE = 17;\n\n  /** Bubble UI (if visible). */\n  protected bubble_: Bubble|null = null;\n\n  /** Absolute coordinate of icon's center. */\n  protected iconXY_: Coordinate|null = null;\n\n  /** @param block The block associated with this icon. */\n  constructor(block: BlockSvg) {\n    this.block_ = block;\n  }\n\n  /** Create the icon on the block. */\n  createIcon() {\n    if (this.iconGroup_) {\n      // Icon already exists.\n      return;\n    }\n    /* Here's the markup that will be generated:\n        <g class=\"blocklyIconGroup\">\n          ...\n        </g>\n        */\n    this.iconGroup_ =\n        dom.createSvgElement(Svg.G, {'class': 'blocklyIconGroup'});\n    if (this.block_.isInFlyout) {\n      dom.addClass(this.iconGroup_, 'blocklyIconGroupReadonly');\n    }\n    this.drawIcon_(this.iconGroup_);\n\n    this.block_.getSvgRoot().appendChild(this.iconGroup_);\n    browserEvents.conditionalBind(\n        this.iconGroup_, 'mouseup', this, this.iconClick_);\n    this.updateEditable();\n  }\n\n  /** Dispose of this icon. */\n  dispose() {\n    dom.removeNode(this.iconGroup_);  // Dispose of and unlink the icon.\n    this.setVisible(false);           // Dispose of and unlink the bubble.\n  }\n\n  /** Add or remove the UI indicating if this icon may be clicked or not. */\n  updateEditable() {\n    // No-op on the base class.\n  }\n\n  /**\n   * Is the associated bubble visible?\n   *\n   * @returns True if the bubble is visible.\n   */\n  isVisible(): boolean {\n    return !!this.bubble_;\n  }\n\n  /**\n   * Clicking on the icon toggles if the bubble is visible.\n   *\n   * @param e Mouse click event.\n   */\n  protected iconClick_(e: MouseEvent) {\n    if (this.block_.workspace.isDragging()) {\n      // Drag operation is concluding.  Don't open the editor.\n      return;\n    }\n    if (!this.block_.isInFlyout && !browserEvents.isRightButton(e)) {\n      this.setVisible(!this.isVisible());\n    }\n  }\n\n  /** Change the colour of the associated bubble to match its block. */\n  applyColour() {\n    if (this.isVisible()) {\n      this.bubble_!.setColour(this.block_.style.colourPrimary);\n    }\n  }\n\n  /**\n   * Notification that the icon has moved.  Update the arrow accordingly.\n   *\n   * @param xy Absolute location in workspace coordinates.\n   */\n  setIconLocation(xy: Coordinate) {\n    this.iconXY_ = xy;\n    if (this.isVisible()) {\n      this.bubble_!.setAnchorLocation(xy);\n    }\n  }\n\n  /**\n   * Notification that the icon has moved, but we don't really know where.\n   * Recompute the icon's location from scratch.\n   */\n  computeIconLocation() {\n    // Find coordinates for the centre of the icon and update the arrow.\n    const blockXY = this.block_.getRelativeToSurfaceXY();\n    const iconXY = svgMath.getRelativeXY(this.iconGroup_ as SVGElement);\n    const newXY = new Coordinate(\n        blockXY.x + iconXY.x + this.SIZE / 2,\n        blockXY.y + iconXY.y + this.SIZE / 2);\n    if (!Coordinate.equals(this.getIconLocation(), newXY)) {\n      this.setIconLocation(newXY);\n    }\n  }\n\n  /**\n   * Returns the center of the block's icon relative to the surface.\n   *\n   * @returns Object with x and y properties in workspace coordinates.\n   */\n  getIconLocation(): Coordinate|null {\n    return this.iconXY_;\n  }\n\n  /**\n   * Get the size of the icon as used for rendering.\n   * This differs from the actual size of the icon, because it bulges slightly\n   * out of its row rather than increasing the height of its row.\n   *\n   * @returns Height and width.\n   */\n  getCorrectedSize(): Size {\n    // TODO (#2562): Remove getCorrectedSize.\n    return new Size(this.SIZE, this.SIZE - 2);\n  }\n\n  /**\n   * Draw the icon.\n   *\n   * @param _group The icon group.\n   */\n  protected drawIcon_(_group: Element) {}\n  // No-op on base class.\n\n  /**\n   * Show or hide the icon.\n   *\n   * @param _visible True if the icon should be visible.\n   */\n  setVisible(_visible: boolean) {}\n}\n// No-op on base class\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a theme.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Theme');\n\nimport * as registry from './registry.js';\nimport * as object from './utils/object.js';\n\n\nexport interface ITheme {\n  blockStyles: {[key: string]: BlockStyle};\n  categoryStyles: {[key: string]: CategoryStyle};\n  componentStyles: ComponentStyle;\n  fontStyle: FontStyle;\n  startHats: boolean|null;\n  base?: string|Theme;\n  name: string;\n}\n\n/**\n * Class for a theme.\n *\n * @alias Blockly.Theme\n */\nexport class Theme implements ITheme {\n  /** @internal */\n  blockStyles: {[key: string]: BlockStyle};\n  /** @internal */\n  categoryStyles: {[key: string]: CategoryStyle};\n  /** @internal */\n  componentStyles: ComponentStyle;\n  /** @internal */\n  fontStyle: FontStyle;\n\n  /**\n   * Whether or not to add a 'hat' on top of all blocks with no previous or\n   * output connections.\n   *\n   * @internal\n   */\n  startHats: boolean|null = null;\n\n  /**\n   * @param name Theme name.\n   * @param opt_blockStyles A map from style names (strings) to objects with\n   *     style attributes for blocks.\n   * @param opt_categoryStyles A map from style names (strings) to objects with\n   *     style attributes for categories.\n   * @param opt_componentStyles A map of Blockly component names to style value.\n   */\n  constructor(\n      public name: string, opt_blockStyles?: {[key: string]: BlockStyle},\n      opt_categoryStyles?: {[key: string]: CategoryStyle},\n      opt_componentStyles?: ComponentStyle) {\n    /** The block styles map. */\n    this.blockStyles = opt_blockStyles || Object.create(null);\n\n    /** The category styles map. */\n    this.categoryStyles = opt_categoryStyles || Object.create(null);\n\n    /** The UI components styles map. */\n    this.componentStyles =\n        opt_componentStyles || Object.create(null) as ComponentStyle;\n\n    /** The font style. */\n    this.fontStyle = Object.create(null) as FontStyle;\n\n    // Register the theme by name.\n    registry.register(registry.Type.THEME, name, this);\n  }\n\n  /**\n   * Gets the class name that identifies this theme.\n   *\n   * @returns The CSS class name.\n   * @internal\n   */\n  getClassName(): string {\n    return this.name + '-theme';\n  }\n\n  /**\n   * Overrides or adds a style to the blockStyles map.\n   *\n   * @param blockStyleName The name of the block style.\n   * @param blockStyle The block style.\n   */\n  setBlockStyle(blockStyleName: string, blockStyle: BlockStyle) {\n    this.blockStyles[blockStyleName] = blockStyle;\n  }\n\n  /**\n   * Overrides or adds a style to the categoryStyles map.\n   *\n   * @param categoryStyleName The name of the category style.\n   * @param categoryStyle The category style.\n   */\n  setCategoryStyle(categoryStyleName: string, categoryStyle: CategoryStyle) {\n    this.categoryStyles[categoryStyleName] = categoryStyle;\n  }\n\n  /**\n   * Gets the style for a given Blockly UI component.  If the style value is a\n   * string, we attempt to find the value of any named references.\n   *\n   * @param componentName The name of the component.\n   * @returns The style value.\n   */\n  getComponentStyle(componentName: string): string|null {\n    const style = (this.componentStyles as AnyDuringMigration)[componentName];\n    if (style && typeof style === 'string' && this.getComponentStyle((style))) {\n      return this.getComponentStyle((style));\n    }\n    return style ? String(style) : null;\n  }\n\n  /**\n   * Configure a specific Blockly UI component with a style value.\n   *\n   * @param componentName The name of the component.\n   * @param styleValue The style value.\n   */\n  setComponentStyle(componentName: string, styleValue: AnyDuringMigration) {\n    (this.componentStyles as AnyDuringMigration)[componentName] = styleValue;\n  }\n\n  /**\n   * Configure a theme's font style.\n   *\n   * @param fontStyle The font style.\n   */\n  setFontStyle(fontStyle: FontStyle) {\n    this.fontStyle = fontStyle;\n  }\n\n  /**\n   * Configure a theme's start hats.\n   *\n   * @param startHats True if the theme enables start hats, false otherwise.\n   */\n  setStartHats(startHats: boolean) {\n    this.startHats = startHats;\n  }\n\n  /**\n   * Define a new Blockly theme.\n   *\n   * @param name The name of the theme.\n   * @param themeObj An object containing theme properties.\n   * @returns A new Blockly theme.\n   */\n  static defineTheme(name: string, themeObj: ITheme): Theme {\n    name = name.toLowerCase();\n    const theme = new Theme(name);\n    let base = themeObj['base'];\n    if (base) {\n      if (typeof base === 'string') {\n        base = registry.getObject(registry.Type.THEME, base) ?? undefined;\n      }\n      if (base instanceof Theme) {\n        object.deepMerge(theme, base);\n        theme.name = name;\n      }\n    }\n\n    object.deepMerge(theme.blockStyles, themeObj['blockStyles']);\n    object.deepMerge(theme.categoryStyles, themeObj['categoryStyles']);\n    object.deepMerge(theme.componentStyles, themeObj['componentStyles']);\n    object.deepMerge(theme.fontStyle, themeObj['fontStyle']);\n    if (themeObj['startHats'] !== null) {\n      theme.startHats = themeObj['startHats'];\n    }\n\n    return theme;\n  }\n}\n\nexport namespace Theme {\n  export interface BlockStyle {\n    colourPrimary: string;\n    colourSecondary: string;\n    colourTertiary: string;\n    hat?: string;\n  }\n\n  export interface CategoryStyle {\n    colour: string;\n  }\n\n  export interface ComponentStyle {\n    workspaceBackgroundColour: string|null;\n    toolboxBackgroundColour: string|null;\n    toolboxForegroundColour: string|null;\n    flyoutBackgroundColour: string|null;\n    flyoutForegroundColour: string|null;\n    flyoutOpacity: number|null;\n    scrollbarColour: string|null;\n    scrollbarOpacity: number|null;\n    insertionMarkerColour: string|null;\n    insertionMarkerOpacity: number|null;\n    markerColour: string|null;\n    cursorColour: string|null;\n    selectedGlowColour: string|null;\n    selectedGlowOpacity: number|null;\n    replacementGlowColour: string|null;\n    replacementGlowOpacity: number|null;\n  }\n\n  export interface FontStyle {\n    family: string|null;\n    weight: string|null;\n    size: number|null;\n  }\n}\n\nexport type BlockStyle = Theme.BlockStyle;\nexport type CategoryStyle = Theme.CategoryStyle;\nexport type ComponentStyle = Theme.ComponentStyle;\nexport type FontStyle = Theme.FontStyle;\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Classic theme.\n * Contains multi-coloured border to create shadow effect.\n *\n * @namespace Blockly.Themes.Classic\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Themes.Classic');\n\nimport {Theme} from '../theme.js';\n\n\nconst defaultBlockStyles = {\n  'colour_blocks': {'colourPrimary': '20'},\n  'list_blocks': {'colourPrimary': '260'},\n  'logic_blocks': {'colourPrimary': '210'},\n  'loop_blocks': {'colourPrimary': '120'},\n  'math_blocks': {'colourPrimary': '230'},\n  'procedure_blocks': {'colourPrimary': '290'},\n  'text_blocks': {'colourPrimary': '160'},\n  'variable_blocks': {'colourPrimary': '330'},\n  'variable_dynamic_blocks': {'colourPrimary': '310'},\n  'hat_blocks': {'colourPrimary': '330', 'hat': 'cap'},\n};\n\nconst categoryStyles = {\n  'colour_category': {'colour': '20'},\n  'list_category': {'colour': '260'},\n  'logic_category': {'colour': '210'},\n  'loop_category': {'colour': '120'},\n  'math_category': {'colour': '230'},\n  'procedure_category': {'colour': '290'},\n  'text_category': {'colour': '160'},\n  'variable_category': {'colour': '330'},\n  'variable_dynamic_category': {'colour': '310'},\n};\n\n/**\n * Classic theme.\n * Contains multi-coloured border to create shadow effect.\n *\n * @alias Blockly.Themes.Classic\n */\nexport const Classic = new Theme(\n    'classic', defaultBlockStyles as AnyDuringMigration, categoryStyles);\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object that controls settings for the workspace.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Options');\n\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as deprecation from './utils/deprecation.js';\nimport * as registry from './registry.js';\nimport {Theme} from './theme.js';\nimport {Classic} from './theme/classic.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport type {Metrics} from './utils/metrics.js';\nimport * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Parse the user-specified options, using reasonable defaults where behaviour\n * is unspecified.\n *\n * @alias Blockly.Options\n */\nexport class Options {\n  RTL: boolean;\n  oneBasedIndex: boolean;\n  collapse: boolean;\n  comments: boolean;\n  disable: boolean;\n  readOnly: boolean;\n  maxBlocks: number;\n  maxInstances: {[key: string]: number}|null;\n  pathToMedia: string;\n  hasCategories: boolean;\n  moveOptions: MoveOptions;\n  hasScrollbars: boolean;\n  hasTrashcan: boolean;\n  maxTrashcanContents: number;\n  hasSounds: boolean;\n  hasCss: boolean;\n  horizontalLayout: boolean;\n  languageTree: toolbox.ToolboxInfo|null;\n  gridOptions: GridOptions;\n  zoomOptions: ZoomOptions;\n  toolboxPosition: toolbox.Position;\n  theme: Theme;\n  renderer: string;\n  rendererOverrides: {[rendererConstant: string]: any}|null;\n\n  /**\n   * The SVG element for the grid pattern.\n   * Created during injection.\n   */\n  gridPattern: SVGElement|null = null;\n  parentWorkspace: WorkspaceSvg|null;\n  plugins: {[key: string]: (new(...p1: any[]) => any)|string};\n\n  /**\n   * If set, sets the translation of the workspace to match the scrollbars.\n   * A function that\n   *     sets the translation of the workspace to match the scrollbars. The\n   *     argument Contains an x and/or y property which is a float between 0\n   *     and 1 specifying the degree of scrolling.\n   */\n  setMetrics?: ((p1: {x?: number, y?: number}) => void) = undefined;\n\n  /**\n   * A function that returns a metrics\n   *     object that describes the current workspace.\n   */\n  getMetrics?: (() => Metrics) = undefined;\n\n  /**\n   * @param options Dictionary of options.\n   *     Specification:\n   * https://developers.google.com/blockly/guides/get-started/web#configuration\n   */\n  constructor(options: BlocklyOptions) {\n    let toolboxJsonDef = null;\n    let hasCategories = false;\n    let hasTrashcan = false;\n    let hasCollapse = false;\n    let hasComments = false;\n    let hasDisable = false;\n    let hasSounds = false;\n    const readOnly = !!options['readOnly'];\n    if (!readOnly) {\n      toolboxJsonDef =\n          toolbox.convertToolboxDefToJson(options['toolbox'] ?? null);\n      hasCategories = toolbox.hasCategories(toolboxJsonDef);\n      const rawHasTrashcan = options['trashcan'];\n      hasTrashcan =\n          rawHasTrashcan === undefined ? hasCategories : rawHasTrashcan;\n      const rawHasCollapse = options['collapse'];\n      hasCollapse =\n          rawHasCollapse === undefined ? hasCategories : rawHasCollapse;\n      const rawHasComments = options['comments'];\n      hasComments =\n          rawHasComments === undefined ? hasCategories : rawHasComments;\n      const rawHasDisable = options['disable'];\n      hasDisable = rawHasDisable === undefined ? hasCategories : rawHasDisable;\n      const rawHasSounds = options['sounds'];\n      hasSounds = rawHasSounds === undefined ? true : rawHasSounds;\n    }\n\n    let maxTrashcanContents = options['maxTrashcanContents'];\n    if (hasTrashcan) {\n      if (maxTrashcanContents === undefined) {\n        maxTrashcanContents = 32;\n      }\n    } else {\n      maxTrashcanContents = 0;\n    }\n    const rtl = !!options['rtl'];\n    let horizontalLayout = options['horizontalLayout'];\n    if (horizontalLayout === undefined) {\n      horizontalLayout = false;\n    }\n    const toolboxAtStart = options['toolboxPosition'] !== 'end';\n\n    let toolboxPosition: toolbox.Position;\n    if (horizontalLayout) {\n      toolboxPosition =\n          toolboxAtStart ? toolbox.Position.TOP : toolbox.Position.BOTTOM;\n    } else {\n      toolboxPosition = toolboxAtStart === rtl ? toolbox.Position.RIGHT :\n                                                 toolbox.Position.LEFT;\n    }\n\n    let hasCss = options['css'];\n    if (hasCss === undefined) {\n      hasCss = true;\n    }\n    let pathToMedia = 'https://blockly-demo.appspot.com/static/media/';\n    if (options['media']) {\n      pathToMedia = options['media'].endsWith('/') ? options['media'] :\n                                                     options['media'] + '/';\n    } else if ('path' in options) {\n      // 'path' is a deprecated option which has been replaced by 'media'.\n      deprecation.warn('path', 'Nov 2014', 'Jul 2023', 'media');\n      pathToMedia = (options as any)['path'] + 'media/';\n    }\n    const rawOneBasedIndex = options['oneBasedIndex'];\n    const oneBasedIndex =\n        rawOneBasedIndex === undefined ? true : rawOneBasedIndex;\n    const renderer = options['renderer'] || 'geras';\n\n    const plugins = options['plugins'] || {};\n\n    this.RTL = rtl;\n    this.oneBasedIndex = oneBasedIndex;\n    this.collapse = hasCollapse;\n    this.comments = hasComments;\n    this.disable = hasDisable;\n    this.readOnly = readOnly;\n    this.maxBlocks = options['maxBlocks'] || Infinity;\n    this.maxInstances = options['maxInstances'] ?? null;\n    this.pathToMedia = pathToMedia;\n    this.hasCategories = hasCategories;\n    this.moveOptions = Options.parseMoveOptions_(options, hasCategories);\n    /** @deprecated  January 2019 */\n    this.hasScrollbars = !!this.moveOptions.scrollbars;\n    this.hasTrashcan = hasTrashcan;\n    this.maxTrashcanContents = maxTrashcanContents;\n    this.hasSounds = hasSounds;\n    this.hasCss = hasCss;\n    this.horizontalLayout = horizontalLayout;\n    this.languageTree = toolboxJsonDef;\n    this.gridOptions = Options.parseGridOptions_(options);\n    this.zoomOptions = Options.parseZoomOptions_(options);\n    this.toolboxPosition = toolboxPosition;\n    this.theme = Options.parseThemeOptions_(options);\n    this.renderer = renderer;\n    this.rendererOverrides = options['rendererOverrides'] ?? null;\n\n    /**\n     * The parent of the current workspace, or null if there is no parent\n     * workspace.  We can assert that this is of type WorkspaceSvg as opposed to\n     * Workspace as this is only used in a rendered workspace.\n     */\n    this.parentWorkspace = options['parentWorkspace'] ?? null;\n\n    /** Map of plugin type to name of registered plugin or plugin class. */\n    this.plugins = plugins;\n  }\n\n  /**\n   * Parse the user-specified move options, using reasonable defaults where\n   *    behaviour is unspecified.\n   *\n   * @param options Dictionary of options.\n   * @param hasCategories Whether the workspace has categories or not.\n   * @returns Normalized move options.\n   */\n  private static parseMoveOptions_(\n      options: BlocklyOptions, hasCategories: boolean): MoveOptions {\n    const move = options['move'] || {};\n    const moveOptions = {} as MoveOptions;\n    if (move['scrollbars'] === undefined &&\n        options['scrollbars'] === undefined) {\n      moveOptions.scrollbars = hasCategories;\n    } else if (typeof move['scrollbars'] === 'object') {\n      moveOptions.scrollbars = {\n        'horizontal': !!move['scrollbars']['horizontal'],\n        'vertical': !!move['scrollbars']['vertical'],\n      };\n      // Convert scrollbars object to boolean if they have the same value.\n      // This allows us to easily check for whether any scrollbars exist using\n      // !!moveOptions.scrollbars.\n      if (moveOptions.scrollbars.horizontal &&\n          moveOptions.scrollbars.vertical) {\n        moveOptions.scrollbars = true;\n      } else if (\n          !moveOptions.scrollbars.horizontal &&\n          !moveOptions.scrollbars.vertical) {\n        moveOptions.scrollbars = false;\n      }\n    } else {\n      moveOptions.scrollbars = !!move['scrollbars'] || !!options['scrollbars'];\n    }\n\n    if (!moveOptions.scrollbars || move['wheel'] === undefined) {\n      // Defaults to true if single-direction scroll is enabled.\n      moveOptions.wheel = typeof moveOptions.scrollbars === 'object';\n    } else {\n      moveOptions.wheel = !!move['wheel'];\n    }\n    if (!moveOptions.scrollbars) {\n      moveOptions.drag = false;\n    } else if (move['drag'] === undefined) {\n      // Defaults to true if scrollbars is true.\n      moveOptions.drag = true;\n    } else {\n      moveOptions.drag = !!move['drag'];\n    }\n    return moveOptions;\n  }\n\n  /**\n   * Parse the user-specified zoom options, using reasonable defaults where\n   * behaviour is unspecified.  See zoom documentation:\n   *   https://developers.google.com/blockly/guides/configure/web/zoom\n   *\n   * @param options Dictionary of options.\n   * @returns Normalized zoom options.\n   */\n  private static parseZoomOptions_(options: BlocklyOptions): ZoomOptions {\n    const zoom = options['zoom'] || {};\n    const zoomOptions = {} as ZoomOptions;\n    if (zoom['controls'] === undefined) {\n      zoomOptions.controls = false;\n    } else {\n      zoomOptions.controls = !!zoom['controls'];\n    }\n    if (zoom['wheel'] === undefined) {\n      zoomOptions.wheel = false;\n    } else {\n      zoomOptions.wheel = !!zoom['wheel'];\n    }\n    if (zoom['startScale'] === undefined) {\n      zoomOptions.startScale = 1;\n    } else {\n      zoomOptions.startScale = Number(zoom['startScale']);\n    }\n    if (zoom['maxScale'] === undefined) {\n      zoomOptions.maxScale = 3;\n    } else {\n      zoomOptions.maxScale = Number(zoom['maxScale']);\n    }\n    if (zoom['minScale'] === undefined) {\n      zoomOptions.minScale = 0.3;\n    } else {\n      zoomOptions.minScale = Number(zoom['minScale']);\n    }\n    if (zoom['scaleSpeed'] === undefined) {\n      zoomOptions.scaleSpeed = 1.2;\n    } else {\n      zoomOptions.scaleSpeed = Number(zoom['scaleSpeed']);\n    }\n    if (zoom['pinch'] === undefined) {\n      zoomOptions.pinch = zoomOptions.wheel || zoomOptions.controls;\n    } else {\n      zoomOptions.pinch = !!zoom['pinch'];\n    }\n    return zoomOptions;\n  }\n\n  /**\n   * Parse the user-specified grid options, using reasonable defaults where\n   * behaviour is unspecified. See grid documentation:\n   *   https://developers.google.com/blockly/guides/configure/web/grid\n   *\n   * @param options Dictionary of options.\n   * @returns Normalized grid options.\n   */\n  private static parseGridOptions_(options: BlocklyOptions): GridOptions {\n    const grid = options['grid'] || {};\n    const gridOptions = {} as GridOptions;\n    gridOptions.spacing = Number(grid['spacing']) || 0;\n    gridOptions.colour = grid['colour'] || '#888';\n    gridOptions.length =\n        grid['length'] === undefined ? 1 : Number(grid['length']);\n    gridOptions.snap = gridOptions.spacing > 0 && !!grid['snap'];\n    return gridOptions;\n  }\n\n  /**\n   * Parse the user-specified theme options, using the classic theme as a\n   * default. https://developers.google.com/blockly/guides/configure/web/themes\n   *\n   * @param options Dictionary of options.\n   * @returns A Blockly Theme.\n   */\n  private static parseThemeOptions_(options: BlocklyOptions): Theme {\n    const theme = options['theme'] || Classic;\n    if (typeof theme === 'string') {\n      return registry.getObject(registry.Type.THEME, theme) as Theme;\n    } else if (theme instanceof Theme) {\n      return theme;\n    }\n    return Theme.defineTheme(\n        theme.name || 'builtin' + idGenerator.getNextUniqueId(), theme);\n  }\n}\n\nexport namespace Options {\n  export interface GridOptions {\n    colour: string;\n    length: number;\n    snap: boolean;\n    spacing: number;\n  }\n\n  export interface MoveOptions {\n    drag: boolean;\n    scrollbars: boolean|ScrollbarOptions;\n    wheel: boolean;\n  }\n\n  export interface ScrollbarOptions {\n    horizontal: boolean;\n    vertical: boolean;\n  }\n\n  export interface ZoomOptions {\n    controls: boolean;\n    maxScale: number;\n    minScale: number;\n    pinch: boolean;\n    scaleSpeed: number;\n    startScale: number;\n    wheel: boolean;\n  }\n}\n\nexport type GridOptions = Options.GridOptions;\nexport type MoveOptions = Options.MoveOptions;\nexport type ScrollbarOptions = Options.ScrollbarOptions;\nexport type ZoomOptions = Options.ZoomOptions;\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a mutator dialog.  A mutator allows the\n * user to change the shape of a block using a nested blocks editor.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Mutator');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_bubble_open.js';\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport type {BlocklyOptions} from './blockly_options.js';\nimport {Bubble} from './bubble.js';\nimport {config} from './config.js';\nimport type {Connection} from './connection.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport {BlockChange} from './events/events_block_change.js';\nimport * as eventUtils from './events/utils.js';\nimport {Icon} from './icon.js';\nimport {Options} from './options.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as xml from './utils/xml.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Class for a mutator dialog.\n *\n * @alias Blockly.Mutator\n */\nexport class Mutator extends Icon {\n  private quarkNames_: string[];\n\n  /** Workspace in the mutator's bubble. */\n  private workspace_: WorkspaceSvg|null = null;\n\n  /** Width of workspace. */\n  private workspaceWidth_ = 0;\n\n  /** Height of workspace. */\n  private workspaceHeight_ = 0;\n\n  /**\n   * The SVG element that is the parent of the mutator workspace, or null if\n   * not created.\n   */\n  private svgDialog_: SVGSVGElement|null = null;\n\n  /**\n   * The root block of the mutator workspace, created by decomposing the\n   * source block.\n   */\n  private rootBlock_: BlockSvg|null = null;\n\n  /**\n   * Function registered on the main workspace to update the mutator contents\n   * when the main workspace changes.\n   */\n  private sourceListener_: Function|null = null;\n\n  /**\n   * The PID associated with the updateWorkpace_ timeout, or null if no timeout\n   * is currently running.\n   */\n  private updateWorkspacePid_: ReturnType<typeof setTimeout>|null = null;\n\n  /** @param quarkNames List of names of sub-blocks for flyout. */\n  constructor(block: BlockSvg, quarkNames: string[]) {\n    super(block);\n    this.quarkNames_ = quarkNames;\n  }\n\n  /**\n   * Set the block this mutator is associated with.\n   *\n   * @param block The block associated with this mutator.\n   * @internal\n   */\n  setBlock(block: BlockSvg) {\n    this.block_ = block;\n  }\n\n  /**\n   * Returns the workspace inside this mutator icon's bubble.\n   *\n   * @returns The workspace inside this mutator icon's bubble or null if the\n   *     mutator isn't open.\n   * @internal\n   */\n  getWorkspace(): WorkspaceSvg|null {\n    return this.workspace_;\n  }\n\n  /**\n   * Draw the mutator icon.\n   *\n   * @param group The icon group.\n   */\n  protected override drawIcon_(group: Element) {\n    // Square with rounded corners.\n    dom.createSvgElement(\n        Svg.RECT, {\n          'class': 'blocklyIconShape',\n          'rx': '4',\n          'ry': '4',\n          'height': '16',\n          'width': '16',\n        },\n        group);\n    // Gear teeth.\n    dom.createSvgElement(\n        Svg.PATH, {\n          'class': 'blocklyIconSymbol',\n          'd': 'm4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,' +\n              '0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,' +\n              '-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,' +\n              '-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,' +\n              '-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 ' +\n              '-0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,' +\n              '0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z',\n        },\n        group);\n    // Axle hole.\n    dom.createSvgElement(\n        Svg.CIRCLE,\n        {'class': 'blocklyIconShape', 'r': '2.7', 'cx': '8', 'cy': '8'}, group);\n  }\n\n  /**\n   * Clicking on the icon toggles if the mutator bubble is visible.\n   * Disable if block is uneditable.\n   *\n   * @param e Mouse click event.\n   */\n  protected override iconClick_(e: MouseEvent) {\n    if (this.block_.isEditable()) {\n      super.iconClick_(e);\n    }\n  }\n\n  /**\n   * Create the editor for the mutator's bubble.\n   *\n   * @returns The top-level node of the editor.\n   */\n  private createEditor_(): SVGElement {\n    /* Create the editor.  Here's the markup that will be generated:\n        <svg>\n          [Workspace]\n        </svg>\n        */\n    this.svgDialog_ = dom.createSvgElement(\n        Svg.SVG, {'x': Bubble.BORDER_WIDTH, 'y': Bubble.BORDER_WIDTH});\n    // Convert the list of names into a list of XML objects for the flyout.\n    let quarkXml;\n    if (this.quarkNames_.length) {\n      quarkXml = xml.createElement('xml');\n      for (let i = 0, quarkName; quarkName = this.quarkNames_[i]; i++) {\n        const element = xml.createElement('block');\n        element.setAttribute('type', quarkName);\n        quarkXml.appendChild(element);\n      }\n    } else {\n      quarkXml = null;\n    }\n    const workspaceOptions = new Options(({\n      // If you want to enable disabling, also remove the\n      // event filter from workspaceChanged_ .\n      'disable': false,\n      'parentWorkspace': this.block_.workspace,\n      'media': this.block_.workspace.options.pathToMedia,\n      'rtl': this.block_.RTL,\n      'horizontalLayout': false,\n      'renderer': this.block_.workspace.options.renderer,\n      'rendererOverrides': this.block_.workspace.options.rendererOverrides,\n    } as BlocklyOptions));\n    workspaceOptions.toolboxPosition =\n        this.block_.RTL ? toolbox.Position.RIGHT : toolbox.Position.LEFT;\n    const hasFlyout = !!quarkXml;\n    if (hasFlyout) {\n      workspaceOptions.languageTree = toolbox.convertToolboxDefToJson(quarkXml);\n    }\n    this.workspace_ = this.newWorkspaceSvg(workspaceOptions);\n    this.workspace_.internalIsMutator = true;\n    this.workspace_.addChangeListener(eventUtils.disableOrphans);\n\n    // Mutator flyouts go inside the mutator workspace's <g> rather than in\n    // a top level SVG. Instead of handling scale themselves, mutators\n    // inherit scale from the parent workspace.\n    // To fix this, scale needs to be applied at a different level in the DOM.\n    const flyoutSvg = hasFlyout ? this.workspace_.addFlyout(Svg.G) : null;\n    const background = this.workspace_.createDom('blocklyMutatorBackground');\n\n    if (flyoutSvg) {\n      // Insert the flyout after the <rect> but before the block canvas so that\n      // the flyout is underneath in z-order.  This makes blocks layering during\n      // dragging work properly.\n      background.insertBefore(flyoutSvg, this.workspace_.svgBlockCanvas_);\n    }\n    this.svgDialog_!.appendChild(background);\n\n    return this.svgDialog_;\n  }\n\n  /**\n   * @internal\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  newWorkspaceSvg(options: Options): WorkspaceSvg {\n    throw new Error(\n        'The implementation of newWorkspaceSvg should be ' +\n        'monkey-patched in by blockly.ts');\n  }\n\n  /** Add or remove the UI indicating if this icon may be clicked or not. */\n  override updateEditable() {\n    super.updateEditable();\n    if (!this.block_.isInFlyout) {\n      if (this.block_.isEditable()) {\n        if (this.iconGroup_) {\n          dom.removeClass(\n              this.iconGroup_ as Element, 'blocklyIconGroupReadonly');\n        }\n      } else {\n        // Close any mutator bubble.  Icon is not clickable.\n        this.setVisible(false);\n        if (this.iconGroup_) {\n          dom.addClass(this.iconGroup_ as Element, 'blocklyIconGroupReadonly');\n        }\n      }\n    }\n  }\n\n  /** Resize the bubble to match the size of the workspace. */\n  private resizeBubble_() {\n    const doubleBorderWidth = 2 * Bubble.BORDER_WIDTH;\n    const workspaceSize = this.workspace_!.getCanvas().getBBox();\n    let width = workspaceSize.width + workspaceSize.x;\n    let height = workspaceSize.height + doubleBorderWidth * 3;\n    const flyout = this.workspace_!.getFlyout();\n    if (flyout) {\n      const flyoutScrollMetrics =\n          flyout.getWorkspace().getMetricsManager().getScrollMetrics();\n      height = Math.max(height, flyoutScrollMetrics.height + 20);\n      width += flyout.getWidth();\n    }\n    if (this.block_.RTL) {\n      width = -workspaceSize.x;\n    }\n    width += doubleBorderWidth * 3;\n    // Only resize if the size difference is significant.  Eliminates\n    // shuddering.\n    if (Math.abs(this.workspaceWidth_ - width) > doubleBorderWidth ||\n        Math.abs(this.workspaceHeight_ - height) > doubleBorderWidth) {\n      // Record some layout information for workspace metrics.\n      this.workspaceWidth_ = width;\n      this.workspaceHeight_ = height;\n      // Resize the bubble.\n      this.bubble_!.setBubbleSize(\n          width + doubleBorderWidth, height + doubleBorderWidth);\n      this.svgDialog_!.setAttribute('width', `${this.workspaceWidth_}`);\n      this.svgDialog_!.setAttribute('height', `${this.workspaceHeight_}`);\n      this.workspace_!.setCachedParentSvgSize(\n          this.workspaceWidth_, this.workspaceHeight_);\n    }\n\n    if (this.block_.RTL) {\n      // Scroll the workspace to always left-align.\n      const translation = 'translate(' + this.workspaceWidth_ + ',0)';\n      this.workspace_!.getCanvas().setAttribute('transform', translation);\n    }\n    this.workspace_!.resize();\n  }\n\n  /** A method handler for when the bubble is moved. */\n  private onBubbleMove_() {\n    if (this.workspace_) {\n      this.workspace_.recordDragTargets();\n    }\n  }\n\n  /**\n   * Show or hide the mutator bubble.\n   *\n   * @param visible True if the bubble should be visible.\n   */\n  override setVisible(visible: boolean) {\n    if (visible === this.isVisible()) {\n      // No change.\n      return;\n    }\n    eventUtils.fire(new (eventUtils.get(eventUtils.BUBBLE_OPEN))(\n        this.block_, visible, 'mutator'));\n    if (visible) {\n      // Create the bubble.\n      this.bubble_ = new Bubble(\n          (this.block_.workspace as WorkspaceSvg), this.createEditor_(),\n          this.block_.pathObject.svgPath, (this.iconXY_ as Coordinate), null,\n          null);\n      // Expose this mutator's block's ID on its top-level SVG group.\n      this.bubble_.setSvgId(this.block_.id);\n      this.bubble_.registerMoveEvent(this.onBubbleMove_.bind(this));\n      const tree = this.workspace_!.options.languageTree;\n      const flyout = this.workspace_!.getFlyout();\n      if (tree) {\n        flyout!.init(this.workspace_!);\n        flyout!.show(tree);\n      }\n\n      this.rootBlock_ = this.block_!.decompose!(this.workspace_!)!;\n      const blocks = this.rootBlock_!.getDescendants(false);\n      for (let i = 0, child; child = blocks[i]; i++) {\n        child.render();\n      }\n      // The root block should not be draggable or deletable.\n      this.rootBlock_!.setMovable(false);\n      this.rootBlock_!.setDeletable(false);\n      let margin;\n      let x;\n      if (flyout) {\n        margin = flyout.CORNER_RADIUS * 2;\n        x = this.rootBlock_!.RTL ? flyout.getWidth() + margin : margin;\n      } else {\n        margin = 16;\n        x = margin;\n      }\n      if (this.block_.RTL) {\n        x = -x;\n      }\n      this.rootBlock_!.moveBy(x, margin);\n      // Save the initial connections, then listen for further changes.\n      if (this.block_.saveConnections) {\n        const thisRootBlock = this.rootBlock_;\n        this.block_.saveConnections(thisRootBlock);\n        this.sourceListener_ = () => {\n          if (this.block_ && this.block_.saveConnections) {\n            this.block_.saveConnections(thisRootBlock);\n          }\n        };\n        this.block_.workspace.addChangeListener(this.sourceListener_);\n      }\n      this.resizeBubble_();\n      // When the mutator's workspace changes, update the source block.\n      this.workspace_!.addChangeListener(this.workspaceChanged_.bind(this));\n      // Update the source block immediately after the bubble becomes visible.\n      this.updateWorkspace_();\n      this.applyColour();\n    } else {\n      // Dispose of the bubble.\n      this.svgDialog_ = null;\n      this.workspace_!.dispose();\n      this.workspace_ = null;\n      this.rootBlock_ = null;\n      this.bubble_?.dispose();\n      this.bubble_ = null;\n      this.workspaceWidth_ = 0;\n      this.workspaceHeight_ = 0;\n      if (this.sourceListener_) {\n        this.block_.workspace.removeChangeListener(this.sourceListener_);\n        this.sourceListener_ = null;\n      }\n    }\n  }\n\n  /**\n   * Fired whenever a change is made to the mutator's workspace.\n   *\n   * @param e Custom data for event.\n   */\n  private workspaceChanged_(e: Abstract) {\n    if (!this.shouldIgnoreMutatorEvent_(e) && !this.updateWorkspacePid_) {\n      this.updateWorkspacePid_ = setTimeout(() => {\n        this.updateWorkspacePid_ = null;\n        this.updateWorkspace_();\n      }, 0);\n    }\n  }\n\n  /**\n   * Returns whether the given event in the mutator workspace should be ignored\n   * when deciding whether to update the workspace and compose the block or not.\n   *\n   * @param e The event.\n   * @returns Whether to ignore the event or not.\n   */\n  shouldIgnoreMutatorEvent_(e: Abstract) {\n    return e.isUiEvent || e.type === eventUtils.CREATE ||\n        e.type === eventUtils.CHANGE &&\n        (e as BlockChange).element === 'disabled';\n  }\n\n  /**\n   * Updates the source block when the mutator's blocks are changed.\n   * Bump down any block that's too high.\n   */\n  private updateWorkspace_() {\n    if (!this.workspace_!.isDragging()) {\n      const blocks = this.workspace_!.getTopBlocks(false);\n      const MARGIN = 20;\n\n      for (let b = 0, block; block = blocks[b]; b++) {\n        const blockXY = block.getRelativeToSurfaceXY();\n\n        // Bump any block that's above the top back inside.\n        if (blockXY.y < MARGIN) {\n          block.moveBy(0, MARGIN - blockXY.y);\n        }\n        // Bump any block overlapping the flyout back inside.\n        if (block.RTL) {\n          let right = -MARGIN;\n          const flyout = this.workspace_!.getFlyout();\n          if (flyout) {\n            right -= flyout.getWidth();\n          }\n          if (blockXY.x > right) {\n            block.moveBy(right - blockXY.x, 0);\n          }\n        } else if (blockXY.x < MARGIN) {\n          block.moveBy(MARGIN - blockXY.x, 0);\n        }\n      }\n    }\n\n    // When the mutator's workspace changes, update the source block.\n    if (this.rootBlock_ && this.rootBlock_.workspace === this.workspace_) {\n      const existingGroup = eventUtils.getGroup();\n      if (!existingGroup) {\n        eventUtils.setGroup(true);\n      }\n      const block = this.block_ as BlockSvg;\n      const oldExtraState = BlockChange.getExtraBlockState_(block);\n\n      // Switch off rendering while the source block is rebuilt.\n      const savedRendered = block.rendered;\n      // TODO(#4288): We should not be setting the rendered property to false.\n      block.rendered = false;\n\n      // Allow the source block to rebuild itself.\n      block.compose!(this.rootBlock_);\n      // Restore rendering and show the changes.\n      block.rendered = savedRendered;\n      // Mutation may have added some elements that need initializing.\n      block.initSvg();\n\n      if (block.rendered) {\n        block.render();\n      }\n\n      const newExtraState = BlockChange.getExtraBlockState_(block);\n      if (oldExtraState !== newExtraState) {\n        eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n            block, 'mutation', null, oldExtraState, newExtraState));\n        // Ensure that any bump is part of this mutation's event group.\n        const mutationGroup = eventUtils.getGroup();\n        setTimeout(function() {\n          const oldGroup = eventUtils.getGroup();\n          eventUtils.setGroup(mutationGroup);\n          block.bumpNeighbours();\n          eventUtils.setGroup(oldGroup);\n        }, config.bumpDelay);\n      }\n\n      // Don't update the bubble until the drag has ended, to avoid moving\n      // blocks under the cursor.\n      if (!this.workspace_!.isDragging()) {\n        setTimeout(() => this.resizeBubble_(), 0);\n      }\n      eventUtils.setGroup(existingGroup);\n    }\n  }\n\n  /** Dispose of this mutator. */\n  override dispose() {\n    this.block_.mutator = null;\n    super.dispose();\n  }\n\n  /** Update the styles on all blocks in the mutator. */\n  updateBlockStyle() {\n    const ws = this.workspace_;\n\n    if (ws && ws.getAllBlocks(false)) {\n      const workspaceBlocks = ws.getAllBlocks(false);\n      for (let i = 0, block; block = workspaceBlocks[i]; i++) {\n        block.setStyle(block.getStyleName());\n      }\n\n      const flyout = ws.getFlyout();\n      if (flyout) {\n        const flyoutBlocks = flyout.getWorkspace().getAllBlocks(false);\n        for (let i = 0, block; block = flyoutBlocks[i]; i++) {\n          block.setStyle(block.getStyleName());\n        }\n      }\n    }\n  }\n\n  /**\n   * Reconnect an block to a mutated input.\n   *\n   * @param connectionChild Connection on child block.\n   * @param block Parent block.\n   * @param inputName Name of input on parent block.\n   * @returns True iff a reconnection was made, false otherwise.\n   */\n  static reconnect(\n      connectionChild: Connection, block: Block, inputName: string): boolean {\n    if (!connectionChild || !connectionChild.getSourceBlock().workspace) {\n      return false;  // No connection or block has been deleted.\n    }\n    const connectionParent = block.getInput(inputName)!.connection;\n    const currentParent = connectionChild.targetBlock();\n    if ((!currentParent || currentParent === block) && connectionParent &&\n        connectionParent.targetConnection !== connectionChild) {\n      if (connectionParent.isConnected()) {\n        // There's already something connected here.  Get rid of it.\n        connectionParent.disconnect();\n      }\n      connectionParent.connect(connectionChild);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Get the parent workspace of a workspace that is inside a mutator, taking\n   * into account whether it is a flyout.\n   *\n   * @param workspace The workspace that is inside a mutator.\n   * @returns The mutator's parent workspace or null.\n   */\n  static findParentWs(workspace: WorkspaceSvg): WorkspaceSvg|null {\n    let outerWs = null;\n    if (workspace && workspace.options) {\n      const parent = workspace.options.parentWorkspace;\n      // If we were in a flyout in a mutator, need to go up two levels to find\n      // the actual parent.\n      if (workspace.isFlyout) {\n        if (parent && parent.options) {\n          outerWs = parent.options.parentWorkspace;\n        }\n      } else if (parent) {\n        outerWs = parent;\n      }\n    }\n    return outerWs;\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Non-editable, non-serializable text field.  Used for titles,\n *    labels, etc.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldLabel');\n\nimport {FieldConfig, Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport type {Sentinel} from './utils/sentinel.js';\n\n\n/**\n * Class for a non-editable, non-serializable text field.\n *\n * @alias Blockly.FieldLabel\n */\nexport class FieldLabel extends Field {\n  /** The html class name to use for this field. */\n  private class_: string|null = null;\n\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. This field should not.\n   */\n  override EDITABLE = false;\n\n  /**\n   * @param opt_value The initial value of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param opt_class Optional CSS class for the field's text.\n   * @param opt_config A map of options used to configure the field.\n   *    See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/label#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n      opt_value?: string|Sentinel, opt_class?: string,\n      opt_config?: FieldLabelConfig) {\n    super(Field.SKIP_SETUP);\n\n    if (opt_value === Field.SKIP_SETUP) {\n      return;\n    }\n    if (opt_config) {\n      this.configure_(opt_config);\n    } else {\n      this.class_ = opt_class || null;\n    }\n    this.setValue(opt_value);\n  }\n\n  protected override configure_(config: FieldLabelConfig) {\n    super.configure_(config);\n    if (config.class) this.class_ = config.class;\n  }\n\n  /**\n   * Create block UI for this label.\n   *\n   * @internal\n   */\n  override initView() {\n    this.createTextElement_();\n    if (this.class_) {\n      dom.addClass((this.textElement_), this.class_);\n    }\n  }\n\n  /**\n   * Ensure that the input value casts to a valid string.\n   *\n   * @param opt_newValue The input value.\n   * @returns A valid string, or null if invalid.\n   */\n  protected override doClassValidation_(opt_newValue?: AnyDuringMigration):\n      string|null {\n    if (opt_newValue === null || opt_newValue === undefined) {\n      return null;\n    }\n    return String(opt_newValue);\n  }\n\n  /**\n   * Set the CSS class applied to the field's textElement_.\n   *\n   * @param cssClass The new CSS class name, or null to remove.\n   */\n  setClass(cssClass: string|null) {\n    if (this.textElement_) {\n      // This check isn't necessary, but it's faster than letting removeClass\n      // figure it out.\n      if (this.class_) {\n        dom.removeClass(this.textElement_, this.class_);\n      }\n      if (cssClass) {\n        dom.addClass(this.textElement_, cssClass);\n      }\n    }\n    this.class_ = cssClass;\n  }\n\n  /**\n   * Construct a FieldLabel from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (text, and class).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldLabelFromJsonConfig): FieldLabel {\n    const text = parsing.replaceMessageReferences(options.text);\n    // `this` might be a subclass of FieldLabel if that class doesn't override\n    // the static fromJson method.\n    return new this(text, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_label', FieldLabel);\n\n(FieldLabel.prototype as AnyDuringMigration).DEFAULT_VALUE = '';\n\n// clang-format off\n// Clang does not like the 'class' keyword being used as a property.\n/**\n * Config options for the label field.\n */\nexport interface FieldLabelConfig extends FieldConfig {\n  class?: string;\n}\n// clang-format on\n\n\n/**\n * fromJson config options for the label field.\n */\nexport interface FieldLabelFromJsonConfig extends FieldLabelConfig {\n  text?: string;\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing an input (value, statement, or dummy).\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Input');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './field_label.js';\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport type {Connection} from './connection.js';\nimport type {Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {inputTypes} from './input_types.js';\nimport type {RenderedConnection} from './rendered_connection.js';\n\n\n/**\n * Class for an input with an optional field.\n *\n * @alias Blockly.Input\n */\nexport class Input {\n  private sourceBlock_: Block;\n  fieldRow: Field[] = [];\n  align: Align;\n\n  /** Is the input visible? */\n  private visible_ = true;\n\n  /**\n   * @param type The type of the input.\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.\n   * @param block The block containing this input.\n   * @param connection Optional connection for this input.\n   */\n  constructor(\n      public type: number, public name: string, block: Block,\n      public connection: Connection|null) {\n    if (type !== inputTypes.DUMMY && !name) {\n      throw Error(\n          'Value inputs and statement inputs must have non-empty name.');\n    }\n    this.sourceBlock_ = block;\n\n    /** Alignment of input's fields (left, right or centre). */\n    this.align = Align.LEFT;\n  }\n\n  /**\n   * Get the source block for this input.\n   *\n   * @returns The source block, or null if there is none.\n   */\n  getSourceBlock(): Block {\n    return this.sourceBlock_;\n  }\n\n  /**\n   * Add a field (or label from string), and all prefix and suffix fields, to\n   * the end of the input's field row.\n   *\n   * @param field Something to add as a field.\n   * @param opt_name Language-neutral identifier which may used to find this\n   *     field again.  Should be unique to the host block.\n   * @returns The input being append to (to allow chaining).\n   */\n  appendField(field: string|Field, opt_name?: string): Input {\n    this.insertFieldAt(this.fieldRow.length, field, opt_name);\n    return this;\n  }\n\n  /**\n   * Inserts a field (or label from string), and all prefix and suffix fields,\n   * at the location of the input's field row.\n   *\n   * @param index The index at which to insert field.\n   * @param field Something to add as a field.\n   * @param opt_name Language-neutral identifier which may used to find this\n   *     field again.  Should be unique to the host block.\n   * @returns The index following the last inserted field.\n   */\n  insertFieldAt(index: number, field: string|Field, opt_name?: string): number {\n    if (index < 0 || index > this.fieldRow.length) {\n      throw Error('index ' + index + ' out of bounds.');\n    }\n    // Falsy field values don't generate a field, unless the field is an empty\n    // string and named.\n    if (!field && !(field === '' && opt_name)) {\n      return index;\n    }\n\n    // Generate a FieldLabel when given a plain text field.\n    if (typeof field === 'string') {\n      field = fieldRegistry.fromJson({\n        'type': 'field_label',\n        'text': field,\n      }) as Field;\n    }\n\n    field.setSourceBlock(this.sourceBlock_);\n    if (this.sourceBlock_.rendered) {\n      field.init();\n      field.applyColour();\n    }\n    field.name = opt_name;\n    field.setVisible(this.isVisible());\n\n    if (field.prefixField) {\n      // Add any prefix.\n      index = this.insertFieldAt(index, field.prefixField);\n    }\n    // Add the field to the field row.\n    this.fieldRow.splice(index, 0, field);\n    index++;\n    if (field.suffixField) {\n      // Add any suffix.\n      index = this.insertFieldAt(index, field.suffixField);\n    }\n\n    if (this.sourceBlock_.rendered) {\n      (this.sourceBlock_ as BlockSvg).render();\n      // Adding a field will cause the block to change shape.\n      this.sourceBlock_.bumpNeighbours();\n    }\n    return index;\n  }\n\n  /**\n   * Remove a field from this input.\n   *\n   * @param name The name of the field.\n   * @param opt_quiet True to prevent an error if field is not present.\n   * @returns True if operation succeeds, false if field is not present and\n   *     opt_quiet is true.\n   * @throws {Error} if the field is not present and opt_quiet is false.\n   */\n  removeField(name: string, opt_quiet?: boolean): boolean {\n    for (let i = 0, field; field = this.fieldRow[i]; i++) {\n      if (field.name === name) {\n        field.dispose();\n        this.fieldRow.splice(i, 1);\n        if (this.sourceBlock_.rendered) {\n          (this.sourceBlock_ as BlockSvg).render();\n          // Removing a field will cause the block to change shape.\n          this.sourceBlock_.bumpNeighbours();\n        }\n        return true;\n      }\n    }\n    if (opt_quiet) {\n      return false;\n    }\n    throw Error('Field \"' + name + '\" not found.');\n  }\n\n  /**\n   * Gets whether this input is visible or not.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.visible_;\n  }\n\n  /**\n   * Sets whether this input is visible or not.\n   * Should only be used to collapse/uncollapse a block.\n   *\n   * @param visible True if visible.\n   * @returns List of blocks to render.\n   * @internal\n   */\n  setVisible(visible: boolean): BlockSvg[] {\n    // Note: Currently there are only unit tests for block.setCollapsed()\n    // because this function is package. If this function goes back to being a\n    // public API tests (lots of tests) should be added.\n    let renderList: AnyDuringMigration[] = [];\n    if (this.visible_ === visible) {\n      return renderList;\n    }\n    this.visible_ = visible;\n\n    for (let y = 0, field; field = this.fieldRow[y]; y++) {\n      field.setVisible(visible);\n    }\n    if (this.connection) {\n      const renderedConnection = this.connection as RenderedConnection;\n      // Has a connection.\n      if (visible) {\n        renderList = renderedConnection.startTrackingAll();\n      } else {\n        renderedConnection.stopTrackingAll();\n      }\n      const child = renderedConnection.targetBlock();\n      if (child) {\n        child.getSvgRoot().style.display = visible ? 'block' : 'none';\n      }\n    }\n    return renderList;\n  }\n\n  /**\n   * Mark all fields on this input as dirty.\n   *\n   * @internal\n   */\n  markDirty() {\n    for (let y = 0, field; field = this.fieldRow[y]; y++) {\n      field.markDirty();\n    }\n  }\n\n  /**\n   * Change a connection's compatibility.\n   *\n   * @param check Compatible value type or list of value types.  Null if all\n   *     types are compatible.\n   * @returns The input being modified (to allow chaining).\n   */\n  setCheck(check: string|string[]|null): Input {\n    if (!this.connection) {\n      throw Error('This input does not have a connection.');\n    }\n    this.connection.setCheck(check);\n    return this;\n  }\n\n  /**\n   * Change the alignment of the connection's field(s).\n   *\n   * @param align One of the values of Align.  In RTL mode directions\n   *     are reversed, and Align.RIGHT aligns to the left.\n   * @returns The input being modified (to allow chaining).\n   */\n  setAlign(align: Align): Input {\n    this.align = align;\n    if (this.sourceBlock_.rendered) {\n      const sourceBlock = this.sourceBlock_ as BlockSvg;\n      sourceBlock.render();\n    }\n    return this;\n  }\n\n  /**\n   * Changes the connection's shadow block.\n   *\n   * @param shadow DOM representation of a block or null.\n   * @returns The input being modified (to allow chaining).\n   */\n  setShadowDom(shadow: Element|null): Input {\n    if (!this.connection) {\n      throw Error('This input does not have a connection.');\n    }\n    this.connection.setShadowDom(shadow);\n    return this;\n  }\n\n  /**\n   * Returns the XML representation of the connection's shadow block.\n   *\n   * @returns Shadow DOM representation of a block or null.\n   */\n  getShadowDom(): Element|null {\n    if (!this.connection) {\n      throw Error('This input does not have a connection.');\n    }\n    return this.connection.getShadowDom();\n  }\n\n  /** Initialize the fields on this input. */\n  init() {\n    if (!this.sourceBlock_.workspace.rendered) {\n      return;  // Headless blocks don't need fields initialized.\n    }\n    for (let i = 0; i < this.fieldRow.length; i++) {\n      this.fieldRow[i].init();\n    }\n  }\n\n  /**\n   * Sever all links to this input.\n   *\n   * @suppress {checkTypes}\n   */\n  dispose() {\n    for (let i = 0, field; field = this.fieldRow[i]; i++) {\n      field.dispose();\n    }\n    if (this.connection) {\n      this.connection.dispose();\n    }\n  }\n}\n\nexport namespace Input {\n  /**\n   * Enum for alignment of inputs.\n   *\n   * @alias Blockly.Input.Align\n   */\n  export enum Align {\n    LEFT = -1,\n    CENTRE = 0,\n    RIGHT = 1,\n  }\n}\n\nexport type Align = Input.Align;\nexport const Align = Input.Align;\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing one block.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Block');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_create.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_delete.js';\n\nimport {Blocks} from './blocks.js';\nimport type {Comment} from './comment.js';\nimport * as common from './common.js';\nimport {Connection} from './connection.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as constants from './constants.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport * as eventUtils from './events/utils.js';\nimport * as Extensions from './extensions.js';\nimport type {Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {Align, Input} from './input.js';\nimport {inputTypes} from './input_types.js';\nimport type {IASTNodeLocation} from './interfaces/i_ast_node_location.js';\nimport type {IDeletable} from './interfaces/i_deletable.js';\nimport {ASTNode} from './keyboard_nav/ast_node.js';\nimport type {Mutator} from './mutator.js';\nimport * as Tooltip from './tooltip.js';\nimport * as arrayUtils from './utils/array.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport * as parsing from './utils/parsing.js';\nimport {Size} from './utils/size.js';\nimport type {VariableModel} from './variable_model.js';\nimport type {Workspace} from './workspace.js';\n\n\n/**\n * Class for one block.\n * Not normally called directly, workspace.newBlock() is preferred.\n *\n * @alias Blockly.Block\n */\nexport class Block implements IASTNodeLocation, IDeletable {\n  /**\n   * An optional callback method to use whenever the block's parent workspace\n   * changes. This is usually only called from the constructor, the block type\n   * initializer function, or an extension initializer function.\n   */\n  onchange?: ((p1: Abstract) => AnyDuringMigration)|null;\n\n  /** The language-neutral ID given to the collapsed input. */\n  static readonly COLLAPSED_INPUT_NAME: string = constants.COLLAPSED_INPUT_NAME;\n\n  /** The language-neutral ID given to the collapsed field. */\n  static readonly COLLAPSED_FIELD_NAME: string = constants.COLLAPSED_FIELD_NAME;\n\n  /**\n   * Optional text data that round-trips between blocks and XML.\n   * Has no effect. May be used by 3rd parties for meta information.\n   */\n  data: string|null = null;\n\n  /**\n   * Has this block been disposed of?\n   *\n   * @internal\n   */\n  disposed = false;\n\n  /**\n   * Colour of the block as HSV hue value (0-360)\n   * This may be null if the block colour was not set via a hue number.\n   */\n  private hue_: number|null = null;\n\n  /** Colour of the block in '#RRGGBB' format. */\n  protected colour_ = '#000000';\n\n  /** Name of the block style. */\n  protected styleName_ = '';\n\n  /** An optional method called during initialization. */\n  init?: (() => AnyDuringMigration)|null = undefined;\n\n  /**\n   * An optional serialization method for defining how to serialize the\n   * mutation state to XML. This must be coupled with defining\n   * `domToMutation`.\n   */\n  mutationToDom?: ((...p1: AnyDuringMigration[]) => Element)|null = undefined;\n\n  /**\n   * An optional deserialization method for defining how to deserialize the\n   * mutation state from XML. This must be coupled with defining\n   * `mutationToDom`.\n   */\n  domToMutation?: ((p1: Element) => AnyDuringMigration)|null = undefined;\n\n  /**\n   * An optional serialization method for defining how to serialize the\n   * block's extra state (eg mutation state) to something JSON compatible.\n   * This must be coupled with defining `loadExtraState`.\n   */\n  saveExtraState?: (() => AnyDuringMigration)|null = undefined;\n\n  /**\n   * An optional serialization method for defining how to deserialize the\n   * block's extra state (eg mutation state) from something JSON compatible.\n   * This must be coupled with defining `saveExtraState`.\n   */\n  loadExtraState?:\n      ((p1: AnyDuringMigration) => AnyDuringMigration)|null = undefined;\n\n  /**\n   * An optional property for suppressing adding STATEMENT_PREFIX and\n   * STATEMENT_SUFFIX to generated code.\n   */\n  suppressPrefixSuffix: boolean|null = false;\n\n  /**\n   * An optional property for declaring developer variables.  Return a list of\n   * variable names for use by generators.  Developer variables are never\n   * shown to the user, but are declared as global variables in the generated\n   * code.\n   */\n  getDeveloperVariables?: (() => string[]) = undefined;\n\n  /**\n   * An optional function that reconfigures the block based on the contents of\n   * the mutator dialog.\n   */\n  compose?: ((p1: Block) => void) = undefined;\n\n  /**\n   * An optional function that populates the mutator's dialog with\n   * this block's components.\n   */\n  decompose?: ((p1: Workspace) => Block) = undefined;\n  id: string;\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'Connection'.\n  outputConnection: Connection = null as AnyDuringMigration;\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'Connection'.\n  nextConnection: Connection = null as AnyDuringMigration;\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'Connection'.\n  previousConnection: Connection = null as AnyDuringMigration;\n  inputList: Input[] = [];\n  inputsInline?: boolean = undefined;\n  private disabled = false;\n  tooltip: Tooltip.TipInfo = '';\n  contextMenu = true;\n\n  protected parentBlock_: this|null = null;\n\n  protected childBlocks_: this[] = [];\n\n  private deletable_ = true;\n\n  private movable_ = true;\n\n  private editable_ = true;\n\n  private isShadow_ = false;\n\n  protected collapsed_ = false;\n  protected outputShape_: number|null = null;\n\n  /**\n   * A string representing the comment attached to this block.\n   *\n   * @deprecated August 2019. Use getCommentText instead.\n   */\n  comment: string|Comment|null = null;\n  /** @internal */\n  commentModel: CommentModel;\n  private readonly xy_: Coordinate;\n  isInFlyout: boolean;\n  isInMutator: boolean;\n  RTL: boolean;\n\n  /** True if this block is an insertion marker. */\n  protected isInsertionMarker_ = false;\n\n  /** Name of the type of hat. */\n  hat?: string = undefined;\n\n  rendered: boolean|null = null;\n\n  /**\n   * String for block help, or function that returns a URL. Null for no help.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type 'string\n  // | Function'.\n  helpUrl: string|Function = null as AnyDuringMigration;\n\n  /** A bound callback function to use when the parent workspace changes. */\n  private onchangeWrapper_: ((p1: Abstract) => AnyDuringMigration)|null = null;\n\n  /**\n   * A count of statement inputs on the block.\n   *\n   * @internal\n   */\n  statementInputCount = 0;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  type!: string;\n  // Record initial inline state.\n  inputsInlineDefault?: boolean;\n  workspace: Workspace;\n\n  /**\n   * @param workspace The block's workspace.\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   * @throws When the prototypeName is not valid or not allowed.\n   */\n  constructor(workspace: Workspace, prototypeName: string, opt_id?: string) {\n    this.workspace = workspace;\n\n    this.id = opt_id && !workspace.getBlockById(opt_id) ? opt_id :\n                                                          idGenerator.genUid();\n    workspace.setBlockById(this.id, this);\n\n    /** A model of the comment attached to this block. */\n    this.commentModel = {text: null, pinned: false, size: new Size(160, 80)};\n\n    /**\n     * The block's position in workspace units.  (0, 0) is at the workspace's\n     * origin; scale does not change this value.\n     */\n    this.xy_ = new Coordinate(0, 0);\n    this.isInFlyout = workspace.isFlyout;\n    this.isInMutator = workspace.isMutator;\n\n    this.RTL = workspace.RTL;\n\n    // Copy the type-specific functions and data from the prototype.\n    if (prototypeName) {\n      this.type = prototypeName;\n      const prototype = Blocks[prototypeName];\n      if (!prototype || typeof prototype !== 'object') {\n        throw TypeError('Invalid block definition for type: ' + prototypeName);\n      }\n      Object.assign(this, prototype);\n    }\n\n    workspace.addTopBlock(this);\n    workspace.addTypedBlock(this);\n\n    if (new.target === Block) {\n      this.doInit_();\n    }\n  }\n\n  /** Calls the init() function and handles associated event firing, etc. */\n  protected doInit_() {\n    // All events fired should be part of the same group.\n    // Any events fired during init should not be undoable,\n    // so that block creation is atomic.\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n    const initialUndoFlag = eventUtils.getRecordUndo();\n\n    try {\n      // Call an initialization function, if it exists.\n      if (typeof this.init === 'function') {\n        eventUtils.setRecordUndo(false);\n        this.init();\n        eventUtils.setRecordUndo(initialUndoFlag);\n      }\n\n      // Fire a create event.\n      if (eventUtils.isEnabled()) {\n        eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(this));\n      }\n    } finally {\n      if (!existingGroup) {\n        eventUtils.setGroup(false);\n      }\n      // In case init threw, recordUndo flag should still be reset.\n      eventUtils.setRecordUndo(initialUndoFlag);\n    }\n    this.inputsInlineDefault = this.inputsInline;\n\n    // Bind an onchange function, if it exists.\n    if (typeof this.onchange === 'function') {\n      this.setOnChange(this.onchange);\n    }\n  }\n\n  /**\n   * Dispose of this block.\n   *\n   * @param healStack If true, then try to heal any gap by connecting the next\n   *     statement with the previous statement.  Otherwise, dispose of all\n   *     children of this block.\n   * @suppress {checkTypes}\n   */\n  dispose(healStack: boolean) {\n    if (this.disposed) {\n      return;\n    }\n\n    this.unplug(healStack);\n    if (eventUtils.isEnabled()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_DELETE))(this));\n    }\n\n    if (this.onchangeWrapper_) {\n      this.workspace.removeChangeListener(this.onchangeWrapper_);\n    }\n\n    eventUtils.disable();\n\n    try {\n      // This block is now at the top of the workspace.\n      // Remove this block from the workspace's list of top-most blocks.\n      this.workspace.removeTopBlock(this);\n      this.workspace.removeTypedBlock(this);\n      // Remove from block database.\n      this.workspace.removeBlockById(this.id);\n\n      // First, dispose of all my children.\n      for (let i = this.childBlocks_.length - 1; i >= 0; i--) {\n        this.childBlocks_[i].dispose(false);\n      }\n      // Then dispose of myself.\n      // Dispose of all inputs and their fields.\n      for (let i = 0, input; input = this.inputList[i]; i++) {\n        input.dispose();\n      }\n      this.inputList.length = 0;\n      // Dispose of any remaining connections (next/previous/output).\n      const connections = this.getConnections_(true);\n      for (let i = 0, connection; connection = connections[i]; i++) {\n        connection.dispose();\n      }\n    } finally {\n      eventUtils.enable();\n      this.disposed = true;\n    }\n  }\n\n  /**\n   * Call initModel on all fields on the block.\n   * May be called more than once.\n   * Either initModel or initSvg must be called after creating a block and\n   * before the first interaction with it.  Interactions include UI actions\n   * (e.g. clicking and dragging) and firing events (e.g. create, delete, and\n   * change).\n   */\n  initModel() {\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      for (let j = 0, field; field = input.fieldRow[j]; j++) {\n        if (field.initModel) {\n          field.initModel();\n        }\n      }\n    }\n  }\n\n  /**\n   * Unplug this block from its superior block.  If this block is a statement,\n   * optionally reconnect the block underneath with the block on top.\n   *\n   * @param opt_healStack Disconnect child statement and reconnect stack.\n   *     Defaults to false.\n   */\n  unplug(opt_healStack?: boolean) {\n    if (this.outputConnection) {\n      this.unplugFromRow_(opt_healStack);\n    }\n    if (this.previousConnection) {\n      this.unplugFromStack_(opt_healStack);\n    }\n  }\n\n  /**\n   * Unplug this block's output from an input on another block.  Optionally\n   * reconnect the block's parent to the only child block, if possible.\n   *\n   * @param opt_healStack Disconnect right-side block and connect to left-side\n   *     block.  Defaults to false.\n   */\n  private unplugFromRow_(opt_healStack?: boolean) {\n    let parentConnection = null;\n    if (this.outputConnection.isConnected()) {\n      parentConnection = this.outputConnection.targetConnection;\n      // Disconnect from any superior block.\n      this.outputConnection.disconnect();\n    }\n\n    // Return early in obvious cases.\n    if (!parentConnection || !opt_healStack) {\n      return;\n    }\n\n    const thisConnection = this.getOnlyValueConnection_();\n    if (!thisConnection || !thisConnection.isConnected() ||\n        thisConnection.targetBlock()!.isShadow()) {\n      // Too many or too few possible connections on this block, or there's\n      // nothing on the other side of this connection.\n      return;\n    }\n\n    const childConnection = thisConnection.targetConnection;\n    // Disconnect the child block.\n    childConnection?.disconnect();\n    // Connect child to the parent if possible, otherwise bump away.\n    if (this.workspace.connectionChecker.canConnect(\n            childConnection, parentConnection, false)) {\n      parentConnection.connect(childConnection!);\n    } else {\n      childConnection?.onFailedConnect(parentConnection);\n    }\n  }\n\n  /**\n   * Returns the connection on the value input that is connected to another\n   * block. When an insertion marker is connected to a connection with a block\n   * already attached, the connected block is attached to the insertion marker.\n   * Since only one block can be displaced and attached to the insertion marker\n   * this should only ever return one connection.\n   *\n   * @returns The connection on the value input, or null.\n   */\n  private getOnlyValueConnection_(): Connection|null {\n    let connection = null;\n    for (let i = 0; i < this.inputList.length; i++) {\n      const thisConnection = this.inputList[i].connection;\n      if (thisConnection &&\n          thisConnection.type === ConnectionType.INPUT_VALUE &&\n          thisConnection.targetConnection) {\n        if (connection) {\n          return null;  // More than one value input found.\n        }\n        connection = thisConnection;\n      }\n    }\n    return connection;\n  }\n\n  /**\n   * Unplug this statement block from its superior block.  Optionally reconnect\n   * the block underneath with the block on top.\n   *\n   * @param opt_healStack Disconnect child statement and reconnect stack.\n   *     Defaults to false.\n   */\n  private unplugFromStack_(opt_healStack?: boolean) {\n    let previousTarget = null;\n    if (this.previousConnection.isConnected()) {\n      // Remember the connection that any next statements need to connect to.\n      previousTarget = this.previousConnection.targetConnection;\n      // Detach this block from the parent's tree.\n      this.previousConnection.disconnect();\n    }\n    const nextBlock = this.getNextBlock();\n    if (opt_healStack && nextBlock && !nextBlock.isShadow()) {\n      // Disconnect the next statement.\n      const nextTarget = this.nextConnection.targetConnection;\n      nextTarget?.disconnect();\n      if (previousTarget &&\n          this.workspace.connectionChecker.canConnect(\n              previousTarget, nextTarget, false)) {\n        // Attach the next statement to the previous statement.\n        previousTarget.connect(nextTarget!);\n      }\n    }\n  }\n\n  /**\n   * Returns all connections originating from this block.\n   *\n   * @param _all If true, return all connections even hidden ones.\n   * @returns Array of connections.\n   * @internal\n   */\n  getConnections_(_all: boolean): Connection[] {\n    const myConnections = [];\n    if (this.outputConnection) {\n      myConnections.push(this.outputConnection);\n    }\n    if (this.previousConnection) {\n      myConnections.push(this.previousConnection);\n    }\n    if (this.nextConnection) {\n      myConnections.push(this.nextConnection);\n    }\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      if (input.connection) {\n        myConnections.push(input.connection);\n      }\n    }\n    return myConnections;\n  }\n\n  /**\n   * Walks down a stack of blocks and finds the last next connection on the\n   * stack.\n   *\n   * @param ignoreShadows If true,the last connection on a non-shadow block will\n   *     be returned. If false, this will follow shadows to find the last\n   *     connection.\n   * @returns The last next connection on the stack, or null.\n   * @internal\n   */\n  lastConnectionInStack(ignoreShadows: boolean): Connection|null {\n    let nextConnection = this.nextConnection;\n    while (nextConnection) {\n      const nextBlock = nextConnection.targetBlock();\n      if (!nextBlock || ignoreShadows && nextBlock.isShadow()) {\n        return nextConnection;\n      }\n      nextConnection = nextBlock.nextConnection;\n    }\n    return null;\n  }\n\n  /**\n   * Bump unconnected blocks out of alignment.  Two blocks which aren't actually\n   * connected should not coincidentally line up on screen.\n   */\n  bumpNeighbours() {}\n  // noop.\n\n  /**\n   * Return the parent block or null if this block is at the top level. The\n   * parent block is either the block connected to the previous connection (for\n   * a statement block) or the block connected to the output connection (for a\n   * value block).\n   *\n   * @returns The block (if any) that holds the current block.\n   */\n  getParent(): this|null {\n    return this.parentBlock_;\n  }\n\n  /**\n   * Return the input that connects to the specified block.\n   *\n   * @param block A block connected to an input on this block.\n   * @returns The input (if any) that connects to the specified block.\n   */\n  getInputWithBlock(block: Block): Input|null {\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      if (input.connection && input.connection.targetBlock() === block) {\n        return input;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Return the parent block that surrounds the current block, or null if this\n   * block has no surrounding block.  A parent block might just be the previous\n   * statement, whereas the surrounding block is an if statement, while loop,\n   * etc.\n   *\n   * @returns The block (if any) that surrounds the current block.\n   */\n  getSurroundParent(): this|null {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block = this;\n    let prevBlock;\n    do {\n      prevBlock = block;\n      // AnyDuringMigration because:  Type 'Block | null' is not assignable to\n      // type 'this'.\n      block = block.getParent() as AnyDuringMigration;\n      if (!block) {\n        // Ran off the top.\n        return null;\n      }\n    } while (block.getNextBlock() === prevBlock);\n    // This block is an enclosing parent, not just a statement in a stack.\n    return block;\n  }\n\n  /**\n   * Return the next statement block directly connected to this block.\n   *\n   * @returns The next statement block or null.\n   */\n  getNextBlock(): Block|null {\n    return this.nextConnection && this.nextConnection.targetBlock();\n  }\n\n  /**\n   * Returns the block connected to the previous connection.\n   *\n   * @returns The previous statement block or null.\n   */\n  getPreviousBlock(): Block|null {\n    return this.previousConnection && this.previousConnection.targetBlock();\n  }\n\n  /**\n   * Return the connection on the first statement input on this block, or null\n   * if there are none.\n   *\n   * @returns The first statement connection or null.\n   * @internal\n   */\n  getFirstStatementConnection(): Connection|null {\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      if (input.connection &&\n          input.connection.type === ConnectionType.NEXT_STATEMENT) {\n        return input.connection;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Return the top-most block in this block's tree.\n   * This will return itself if this block is at the top level.\n   *\n   * @returns The root block.\n   */\n  getRootBlock(): this {\n    let rootBlock: this;\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block: this|null = this;\n    do {\n      rootBlock = block;\n      block = rootBlock.parentBlock_;\n    } while (block);\n    return rootBlock;\n  }\n\n  /**\n   * Walk up from the given block up through the stack of blocks to find\n   * the top block of the sub stack. If we are nested in a statement input only\n   * find the top-most nested block. Do not go all the way to the root block.\n   *\n   * @returns The top block in a stack.\n   * @internal\n   */\n  getTopStackBlock(): this {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block = this;\n    let previous;\n    do {\n      previous = block.getPreviousBlock();\n      // AnyDuringMigration because:  Type 'Block' is not assignable to type\n      // 'this'.\n    } while (previous && previous.getNextBlock() === block &&\n             (block = previous as AnyDuringMigration));\n    return block;\n  }\n\n  /**\n   * Find all the blocks that are directly nested inside this one.\n   * Includes value and statement inputs, as well as any following statement.\n   * Excludes any connection on an output tab or any preceding statement.\n   * Blocks are optionally sorted by position; top to bottom.\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  getChildren(ordered: boolean): Block[] {\n    if (!ordered) {\n      return this.childBlocks_;\n    }\n    const blocks = [];\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      if (input.connection) {\n        const child = input.connection.targetBlock();\n        if (child) {\n          blocks.push(child);\n        }\n      }\n    }\n    const next = this.getNextBlock();\n    if (next) {\n      blocks.push(next);\n    }\n    return blocks;\n  }\n\n  /**\n   * Set parent of this block to be a new block or null.\n   *\n   * @param newParent New parent block.\n   * @internal\n   */\n  setParent(newParent: this|null) {\n    if (newParent === this.parentBlock_) {\n      return;\n    }\n\n    // Check that block is connected to new parent if new parent is not null and\n    //    that block is not connected to superior one if new parent is null.\n    const targetBlock =\n        this.previousConnection && this.previousConnection.targetBlock() ||\n        this.outputConnection && this.outputConnection.targetBlock();\n    const isConnected = !!targetBlock;\n\n    if (isConnected && newParent && targetBlock !== newParent) {\n      throw Error('Block connected to superior one that is not new parent.');\n    } else if (!isConnected && newParent) {\n      throw Error('Block not connected to new parent.');\n    } else if (isConnected && !newParent) {\n      throw Error(\n          'Cannot set parent to null while block is still connected to' +\n          ' superior block.');\n    }\n\n    // This block hasn't actually moved on-screen, so there's no need to\n    // update\n    //     its connection locations.\n    if (this.parentBlock_) {\n      // Remove this block from the old parent's child list.\n      arrayUtils.removeElem(this.parentBlock_.childBlocks_, this);\n    } else {\n      // New parent must be non-null so remove this block from the workspace's\n      //     list of top-most blocks.\n      this.workspace.removeTopBlock(this);\n    }\n\n    this.parentBlock_ = newParent;\n    if (newParent) {\n      // Add this block to the new parent's child list.\n      newParent.childBlocks_.push(this);\n    } else {\n      this.workspace.addTopBlock(this);\n    }\n  }\n\n  /**\n   * Find all the blocks that are directly or indirectly nested inside this one.\n   * Includes this block in the list.\n   * Includes value and statement inputs, as well as any following statements.\n   * Excludes any connection on an output tab or any preceding statements.\n   * Blocks are optionally sorted by position; top to bottom.\n   *\n   * @param ordered Sort the list if true.\n   * @returns Flattened array of blocks.\n   */\n  getDescendants(ordered: boolean): this[] {\n    const blocks = [this];\n    const childBlocks = this.getChildren(ordered);\n    for (let child, i = 0; child = childBlocks[i]; i++) {\n      // AnyDuringMigration because:  Argument of type 'Block[]' is not\n      // assignable to parameter of type 'this[]'.\n      blocks.push(...child.getDescendants(ordered) as AnyDuringMigration);\n    }\n    return blocks;\n  }\n\n  /**\n   * Get whether this block is deletable or not.\n   *\n   * @returns True if deletable.\n   */\n  isDeletable(): boolean {\n    return this.deletable_ && !this.isShadow_ && !this.disposed &&\n        !this.workspace.options.readOnly;\n  }\n\n  /**\n   * Set whether this block is deletable or not.\n   *\n   * @param deletable True if deletable.\n   */\n  setDeletable(deletable: boolean) {\n    this.deletable_ = deletable;\n  }\n\n  /**\n   * Get whether this block is movable or not.\n   *\n   * @returns True if movable.\n   */\n  isMovable(): boolean {\n    return this.movable_ && !this.isShadow_ && !this.disposed &&\n        !this.workspace.options.readOnly;\n  }\n\n  /**\n   * Set whether this block is movable or not.\n   *\n   * @param movable True if movable.\n   */\n  setMovable(movable: boolean) {\n    this.movable_ = movable;\n  }\n\n  /**\n   * Get whether is block is duplicatable or not. If duplicating this block and\n   * descendants will put this block over the workspace's capacity this block is\n   * not duplicatable. If duplicating this block and descendants will put any\n   * type over their maxInstances this block is not duplicatable.\n   *\n   * @returns True if duplicatable.\n   */\n  isDuplicatable(): boolean {\n    if (!this.workspace.hasBlockLimits()) {\n      return true;\n    }\n    return this.workspace.isCapacityAvailable(\n        common.getBlockTypeCounts(this, true));\n  }\n\n  /**\n   * Get whether this block is a shadow block or not.\n   *\n   * @returns True if a shadow.\n   */\n  isShadow(): boolean {\n    return this.isShadow_;\n  }\n\n  /**\n   * Set whether this block is a shadow block or not.\n   *\n   * @param shadow True if a shadow.\n   * @internal\n   */\n  setShadow(shadow: boolean) {\n    this.isShadow_ = shadow;\n  }\n\n  /**\n   * Get whether this block is an insertion marker block or not.\n   *\n   * @returns True if an insertion marker.\n   */\n  isInsertionMarker(): boolean {\n    return this.isInsertionMarker_;\n  }\n\n  /**\n   * Set whether this block is an insertion marker block or not.\n   * Once set this cannot be unset.\n   *\n   * @param insertionMarker True if an insertion marker.\n   * @internal\n   */\n  setInsertionMarker(insertionMarker: boolean) {\n    this.isInsertionMarker_ = insertionMarker;\n  }\n\n  /**\n   * Get whether this block is editable or not.\n   *\n   * @returns True if editable.\n   */\n  isEditable(): boolean {\n    return this.editable_ && !this.disposed && !this.workspace.options.readOnly;\n  }\n\n  /**\n   * Set whether this block is editable or not.\n   *\n   * @param editable True if editable.\n   */\n  setEditable(editable: boolean) {\n    this.editable_ = editable;\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      for (let j = 0, field; field = input.fieldRow[j]; j++) {\n        field.updateEditable();\n      }\n    }\n  }\n\n  /**\n   * Returns if this block has been disposed of / deleted.\n   *\n   * @returns True if this block has been disposed of / deleted.\n   */\n  isDisposed(): boolean {\n    return this.disposed;\n  }\n\n  /**\n   * Find the connection on this block that corresponds to the given connection\n   * on the other block.\n   * Used to match connections between a block and its insertion marker.\n   *\n   * @param otherBlock The other block to match against.\n   * @param conn The other connection to match.\n   * @returns The matching connection on this block, or null.\n   * @internal\n   */\n  getMatchingConnection(otherBlock: Block, conn: Connection): Connection|null {\n    const connections = this.getConnections_(true);\n    const otherConnections = otherBlock.getConnections_(true);\n    if (connections.length !== otherConnections.length) {\n      throw Error('Connection lists did not match in length.');\n    }\n    for (let i = 0; i < otherConnections.length; i++) {\n      if (otherConnections[i] === conn) {\n        return connections[i];\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Set the URL of this block's help page.\n   *\n   * @param url URL string for block help, or function that returns a URL.  Null\n   *     for no help.\n   */\n  setHelpUrl(url: string|Function) {\n    this.helpUrl = url;\n  }\n\n  /**\n   * Sets the tooltip for this block.\n   *\n   * @param newTip The text for the tooltip, a function that returns the text\n   *     for the tooltip, or a parent object whose tooltip will be used. To not\n   *     display a tooltip pass the empty string.\n   */\n  setTooltip(newTip: Tooltip.TipInfo) {\n    this.tooltip = newTip;\n  }\n\n  /**\n   * Returns the tooltip text for this block.\n   *\n   * @returns The tooltip text for this block.\n   */\n  getTooltip(): string {\n    return Tooltip.getTooltipOfObject(this);\n  }\n\n  /**\n   * Get the colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  getColour(): string {\n    return this.colour_;\n  }\n\n  /**\n   * Get the name of the block style.\n   *\n   * @returns Name of the block style.\n   */\n  getStyleName(): string {\n    return this.styleName_;\n  }\n\n  /**\n   * Get the HSV hue value of a block.  Null if hue not set.\n   *\n   * @returns Hue value (0-360).\n   */\n  getHue(): number|null {\n    return this.hue_;\n  }\n\n  /**\n   * Change the colour of a block.\n   *\n   * @param colour HSV hue value (0 to 360), #RRGGBB string, or a message\n   *     reference string pointing to one of those two values.\n   */\n  setColour(colour: number|string) {\n    const parsed = parsing.parseBlockColour(colour);\n    this.hue_ = parsed.hue;\n    this.colour_ = parsed.hex;\n  }\n\n  /**\n   * Set the style and colour values of a block.\n   *\n   * @param blockStyleName Name of the block style.\n   */\n  setStyle(blockStyleName: string) {\n    this.styleName_ = blockStyleName;\n  }\n\n  /**\n   * Sets a callback function to use whenever the block's parent workspace\n   * changes, replacing any prior onchange handler. This is usually only called\n   * from the constructor, the block type initializer function, or an extension\n   * initializer function.\n   *\n   * @param onchangeFn The callback to call when the block's workspace changes.\n   * @throws {Error} if onchangeFn is not falsey and not a function.\n   */\n  setOnChange(onchangeFn: (p1: Abstract) => AnyDuringMigration) {\n    if (onchangeFn && typeof onchangeFn !== 'function') {\n      throw Error('onchange must be a function.');\n    }\n    if (this.onchangeWrapper_) {\n      this.workspace.removeChangeListener(this.onchangeWrapper_);\n    }\n    this.onchange = onchangeFn;\n    this.onchangeWrapper_ = onchangeFn.bind(this);\n    this.workspace.addChangeListener(this.onchangeWrapper_);\n  }\n\n  /**\n   * Returns the named field from a block.\n   *\n   * @param name The name of the field.\n   * @returns Named field, or null if field does not exist.\n   */\n  getField(name: string): Field|null {\n    if (typeof name !== 'string') {\n      throw TypeError(\n          'Block.prototype.getField expects a string ' +\n          'with the field name but received ' +\n          (name === undefined ? 'nothing' : name + ' of type ' + typeof name) +\n          ' instead');\n    }\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      for (let j = 0, field; field = input.fieldRow[j]; j++) {\n        if (field.name === name) {\n          return field;\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Return all variables referenced by this block.\n   *\n   * @returns List of variable ids.\n   */\n  getVars(): string[] {\n    const vars = [];\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      for (let j = 0, field; field = input.fieldRow[j]; j++) {\n        if (field.referencesVariables()) {\n          vars.push(field.getValue());\n        }\n      }\n    }\n    return vars;\n  }\n\n  /**\n   * Return all variables referenced by this block.\n   *\n   * @returns List of variable models.\n   * @internal\n   */\n  getVarModels(): VariableModel[] {\n    const vars = [];\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      for (let j = 0, field; field = input.fieldRow[j]; j++) {\n        if (field.referencesVariables()) {\n          const model =\n              this.workspace.getVariableById(field.getValue() as string);\n          // Check if the variable actually exists (and isn't just a potential\n          // variable).\n          if (model) {\n            vars.push(model);\n          }\n        }\n      }\n    }\n    return vars;\n  }\n\n  /**\n   * Notification that a variable is renaming but keeping the same ID.  If the\n   * variable is in use on this block, rerender to show the new name.\n   *\n   * @param variable The variable being renamed.\n   * @internal\n   */\n  updateVarName(variable: VariableModel) {\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      for (let j = 0, field; field = input.fieldRow[j]; j++) {\n        if (field.referencesVariables() &&\n            variable.getId() === field.getValue()) {\n          field.refreshVariableName();\n        }\n      }\n    }\n  }\n\n  /**\n   * Notification that a variable is renaming.\n   * If the ID matches one of this block's variables, rename it.\n   *\n   * @param oldId ID of variable to rename.\n   * @param newId ID of new variable.  May be the same as oldId, but with an\n   *     updated name.\n   */\n  renameVarById(oldId: string, newId: string) {\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      for (let j = 0, field; field = input.fieldRow[j]; j++) {\n        if (field.referencesVariables() && oldId === field.getValue()) {\n          field.setValue(newId);\n        }\n      }\n    }\n  }\n\n  /**\n   * Returns the language-neutral value of the given field.\n   *\n   * @param name The name of the field.\n   * @returns Value of the field or null if field does not exist.\n   */\n  getFieldValue(name: string): AnyDuringMigration {\n    const field = this.getField(name);\n    if (field) {\n      return field.getValue();\n    }\n    return null;\n  }\n\n  /**\n   * Sets the value of the given field for this block.\n   *\n   * @param newValue The value to set.\n   * @param name The name of the field to set the value of.\n   */\n  setFieldValue(newValue: AnyDuringMigration, name: string) {\n    const field = this.getField(name);\n    if (!field) {\n      throw Error('Field \"' + name + '\" not found.');\n    }\n    field.setValue(newValue);\n  }\n\n  /**\n   * Set whether this block can chain onto the bottom of another block.\n   *\n   * @param newBoolean True if there can be a previous statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  setPreviousStatement(newBoolean: boolean, opt_check?: string|string[]|null) {\n    if (newBoolean) {\n      if (opt_check === undefined) {\n        opt_check = null;\n      }\n      if (!this.previousConnection) {\n        this.previousConnection =\n            this.makeConnection_(ConnectionType.PREVIOUS_STATEMENT);\n      }\n      this.previousConnection.setCheck(opt_check);\n    } else {\n      if (this.previousConnection) {\n        if (this.previousConnection.isConnected()) {\n          throw Error(\n              'Must disconnect previous statement before removing ' +\n              'connection.');\n        }\n        this.previousConnection.dispose();\n        // AnyDuringMigration because:  Type 'null' is not assignable to type\n        // 'Connection'.\n        this.previousConnection = null as AnyDuringMigration;\n      }\n    }\n  }\n\n  /**\n   * Set whether another block can chain onto the bottom of this block.\n   *\n   * @param newBoolean True if there can be a next statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  setNextStatement(newBoolean: boolean, opt_check?: string|string[]|null) {\n    if (newBoolean) {\n      if (opt_check === undefined) {\n        opt_check = null;\n      }\n      if (!this.nextConnection) {\n        this.nextConnection =\n            this.makeConnection_(ConnectionType.NEXT_STATEMENT);\n      }\n      this.nextConnection.setCheck(opt_check);\n    } else {\n      if (this.nextConnection) {\n        if (this.nextConnection.isConnected()) {\n          throw Error(\n              'Must disconnect next statement before removing ' +\n              'connection.');\n        }\n        this.nextConnection.dispose();\n        // AnyDuringMigration because:  Type 'null' is not assignable to type\n        // 'Connection'.\n        this.nextConnection = null as AnyDuringMigration;\n      }\n    }\n  }\n\n  /**\n   * Set whether this block returns a value.\n   *\n   * @param newBoolean True if there is an output.\n   * @param opt_check Returned type or list of returned types.  Null or\n   *     undefined if any type could be returned (e.g. variable get).\n   */\n  setOutput(newBoolean: boolean, opt_check?: string|string[]|null) {\n    if (newBoolean) {\n      if (opt_check === undefined) {\n        opt_check = null;\n      }\n      if (!this.outputConnection) {\n        this.outputConnection =\n            this.makeConnection_(ConnectionType.OUTPUT_VALUE);\n      }\n      this.outputConnection.setCheck(opt_check);\n    } else {\n      if (this.outputConnection) {\n        if (this.outputConnection.isConnected()) {\n          throw Error(\n              'Must disconnect output value before removing connection.');\n        }\n        this.outputConnection.dispose();\n        // AnyDuringMigration because:  Type 'null' is not assignable to type\n        // 'Connection'.\n        this.outputConnection = null as AnyDuringMigration;\n      }\n    }\n  }\n\n  /**\n   * Set whether value inputs are arranged horizontally or vertically.\n   *\n   * @param newBoolean True if inputs are horizontal.\n   */\n  setInputsInline(newBoolean: boolean) {\n    if (this.inputsInline !== newBoolean) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this, 'inline', null, this.inputsInline, newBoolean));\n      this.inputsInline = newBoolean;\n    }\n  }\n\n  /**\n   * Get whether value inputs are arranged horizontally or vertically.\n   *\n   * @returns True if inputs are horizontal.\n   */\n  getInputsInline(): boolean {\n    if (this.inputsInline !== undefined) {\n      // Set explicitly.\n      return this.inputsInline;\n    }\n    // Not defined explicitly.  Figure out what would look best.\n    for (let i = 1; i < this.inputList.length; i++) {\n      if (this.inputList[i - 1].type === inputTypes.DUMMY &&\n          this.inputList[i].type === inputTypes.DUMMY) {\n        // Two dummy inputs in a row.  Don't inline them.\n        return false;\n      }\n    }\n    for (let i = 1; i < this.inputList.length; i++) {\n      if (this.inputList[i - 1].type === inputTypes.VALUE &&\n          this.inputList[i].type === inputTypes.DUMMY) {\n        // Dummy input after a value input.  Inline them.\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Set the block's output shape.\n   *\n   * @param outputShape Value representing an output shape.\n   */\n  setOutputShape(outputShape: number|null) {\n    this.outputShape_ = outputShape;\n  }\n\n  /**\n   * Get the block's output shape.\n   *\n   * @returns Value representing output shape if one exists.\n   */\n  getOutputShape(): number|null {\n    return this.outputShape_;\n  }\n\n  /**\n   * Get whether this block is enabled or not.\n   *\n   * @returns True if enabled.\n   */\n  isEnabled(): boolean {\n    return !this.disabled;\n  }\n\n  /**\n   * Set whether the block is enabled or not.\n   *\n   * @param enabled True if enabled.\n   */\n  setEnabled(enabled: boolean) {\n    if (this.isEnabled() !== enabled) {\n      const oldValue = this.disabled;\n      this.disabled = !enabled;\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this, 'disabled', null, oldValue, !enabled));\n    }\n  }\n\n  /**\n   * Get whether the block is disabled or not due to parents.\n   * The block's own disabled property is not considered.\n   *\n   * @returns True if disabled.\n   */\n  getInheritedDisabled(): boolean {\n    let ancestor = this.getSurroundParent();\n    while (ancestor) {\n      if (ancestor.disabled) {\n        return true;\n      }\n      ancestor = ancestor.getSurroundParent();\n    }\n    // Ran off the top.\n    return false;\n  }\n\n  /**\n   * Get whether the block is collapsed or not.\n   *\n   * @returns True if collapsed.\n   */\n  isCollapsed(): boolean {\n    return this.collapsed_;\n  }\n\n  /**\n   * Set whether the block is collapsed or not.\n   *\n   * @param collapsed True if collapsed.\n   */\n  setCollapsed(collapsed: boolean) {\n    if (this.collapsed_ !== collapsed) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this, 'collapsed', null, this.collapsed_, collapsed));\n      this.collapsed_ = collapsed;\n    }\n  }\n\n  /**\n   * Create a human-readable text representation of this block and any children.\n   *\n   * @param opt_maxLength Truncate the string to this length.\n   * @param opt_emptyToken The placeholder string used to denote an empty field.\n   *     If not specified, '?' is used.\n   * @returns Text of block.\n   */\n  toString(opt_maxLength?: number, opt_emptyToken?: string): string {\n    let text = [];\n    const emptyFieldPlaceholder = opt_emptyToken || '?';\n\n    // Temporarily set flag to navigate to all fields.\n    const prevNavigateFields = ASTNode.NAVIGATE_ALL_FIELDS;\n    ASTNode.NAVIGATE_ALL_FIELDS = true;\n\n    let node = ASTNode.createBlockNode(this);\n    const rootNode = node;\n\n    /**\n     * Whether or not to add parentheses around an input.\n     *\n     * @param connection The connection.\n     * @returns True if we should add parentheses around the input.\n     */\n    function shouldAddParentheses(connection: Connection): boolean {\n      let checks = connection.getCheck();\n      if (!checks && connection.targetConnection) {\n        checks = connection.targetConnection.getCheck();\n      }\n      return !!checks &&\n          (checks.indexOf('Boolean') !== -1 || checks.indexOf('Number') !== -1);\n    }\n\n    /** Check that we haven't circled back to the original root node. */\n    function checkRoot() {\n      if (node && node.getType() === rootNode?.getType() &&\n          node.getLocation() === rootNode?.getLocation()) {\n        node = null;\n      }\n    }\n\n    // Traverse the AST building up our text string.\n    while (node) {\n      switch (node.getType()) {\n        case ASTNode.types.INPUT: {\n          const connection = node.getLocation() as Connection;\n          if (!node.in()) {\n            text.push(emptyFieldPlaceholder);\n          } else if (shouldAddParentheses(connection)) {\n            text.push('(');\n          }\n          break;\n        }\n        case ASTNode.types.FIELD: {\n          const field = node.getLocation() as Field;\n          if (field.name !== constants.COLLAPSED_FIELD_NAME) {\n            text.push(field.getText());\n          }\n          break;\n        }\n      }\n\n      const current = node;\n      node = current.in() || current.next();\n      if (!node) {\n        // Can't go in or next, keep going out until we can go next.\n        node = current.out();\n        checkRoot();\n        while (node && !node.next()) {\n          node = node.out();\n          checkRoot();\n          // If we hit an input on the way up, possibly close out parentheses.\n          if (node && node.getType() === ASTNode.types.INPUT &&\n              shouldAddParentheses(node.getLocation() as Connection)) {\n            text.push(')');\n          }\n        }\n        if (node) {\n          node = node.next();\n        }\n      }\n    }\n\n    // Restore state of NAVIGATE_ALL_FIELDS.\n    ASTNode.NAVIGATE_ALL_FIELDS = prevNavigateFields;\n\n    // Run through our text array and simplify expression to remove parentheses\n    // around single field blocks.\n    // E.g. ['repeat', '(', '10', ')', 'times', 'do', '?']\n    for (let i = 2; i < text.length; i++) {\n      if (text[i - 2] === '(' && text[i] === ')') {\n        text[i - 2] = text[i - 1];\n        text.splice(i - 1, 2);\n      }\n    }\n\n    // Join the text array, removing spaces around added parentheses.\n    // AnyDuringMigration because:  Type 'string' is not assignable to type\n    // 'any[]'.\n    text = text.reduce(function(acc, value) {\n      return acc + (acc.substr(-1) === '(' || value === ')' ? '' : ' ') + value;\n    }, '') as AnyDuringMigration;\n    // AnyDuringMigration because:  Property 'trim' does not exist on type\n    // 'any[]'.\n    text = (text as AnyDuringMigration).trim() || '???';\n    if (opt_maxLength) {\n      // TODO: Improve truncation so that text from this block is given\n      // priority. E.g. \"1+2+3+4+5+6+7+8+9=0\" should be \"...6+7+8+9=0\", not\n      // \"1+2+3+4+5...\". E.g. \"1+2+3+4+5=6+7+8+9+0\" should be \"...4+5=6+7...\".\n      if (text.length > opt_maxLength) {\n        // AnyDuringMigration because:  Type 'string' is not assignable to type\n        // 'any[]'.\n        text = (text.substring(0, opt_maxLength - 3) + '...') as\n            AnyDuringMigration;\n      }\n    }\n    return text;\n  }\n\n  /**\n   * Shortcut for appending a value input row.\n   *\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  appendValueInput(name: string): Input {\n    return this.appendInput_(inputTypes.VALUE, name);\n  }\n\n  /**\n   * Shortcut for appending a statement input row.\n   *\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  appendStatementInput(name: string): Input {\n    return this.appendInput_(inputTypes.STATEMENT, name);\n  }\n\n  /**\n   * Shortcut for appending a dummy input row.\n   *\n   * @param opt_name Language-neutral identifier which may used to find this\n   *     input again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  appendDummyInput(opt_name?: string): Input {\n    return this.appendInput_(inputTypes.DUMMY, opt_name || '');\n  }\n\n  /**\n   * Initialize this block using a cross-platform, internationalization-friendly\n   * JSON description.\n   *\n   * @param json Structured data describing the block.\n   */\n  jsonInit(json: AnyDuringMigration) {\n    const warningPrefix = json['type'] ? 'Block \"' + json['type'] + '\": ' : '';\n\n    // Validate inputs.\n    if (json['output'] && json['previousStatement']) {\n      throw Error(\n          warningPrefix +\n          'Must not have both an output and a previousStatement.');\n    }\n\n    // Set basic properties of block.\n    // Makes styles backward compatible with old way of defining hat style.\n    if (json['style'] && json['style'].hat) {\n      this.hat = json['style'].hat;\n      // Must set to null so it doesn't error when checking for style and\n      // colour.\n      json['style'] = null;\n    }\n\n    if (json['style'] && json['colour']) {\n      throw Error(warningPrefix + 'Must not have both a colour and a style.');\n    } else if (json['style']) {\n      this.jsonInitStyle_(json, warningPrefix);\n    } else {\n      this.jsonInitColour_(json, warningPrefix);\n    }\n\n    // Interpolate the message blocks.\n    let i = 0;\n    while (json['message' + i] !== undefined) {\n      this.interpolate_(\n          json['message' + i], json['args' + i] || [],\n          json['lastDummyAlign' + i], warningPrefix);\n      i++;\n    }\n\n    if (json['inputsInline'] !== undefined) {\n      this.setInputsInline(json['inputsInline']);\n    }\n    // Set output and previous/next connections.\n    if (json['output'] !== undefined) {\n      this.setOutput(true, json['output']);\n    }\n    if (json['outputShape'] !== undefined) {\n      this.setOutputShape(json['outputShape']);\n    }\n    if (json['previousStatement'] !== undefined) {\n      this.setPreviousStatement(true, json['previousStatement']);\n    }\n    if (json['nextStatement'] !== undefined) {\n      this.setNextStatement(true, json['nextStatement']);\n    }\n    if (json['tooltip'] !== undefined) {\n      const rawValue = json['tooltip'];\n      const localizedText = parsing.replaceMessageReferences(rawValue);\n      this.setTooltip(localizedText);\n    }\n    if (json['enableContextMenu'] !== undefined) {\n      this.contextMenu = !!json['enableContextMenu'];\n    }\n    if (json['suppressPrefixSuffix'] !== undefined) {\n      this.suppressPrefixSuffix = !!json['suppressPrefixSuffix'];\n    }\n    if (json['helpUrl'] !== undefined) {\n      const rawValue = json['helpUrl'];\n      const localizedValue = parsing.replaceMessageReferences(rawValue);\n      this.setHelpUrl(localizedValue);\n    }\n    if (typeof json['extensions'] === 'string') {\n      console.warn(\n          warningPrefix +\n          'JSON attribute \\'extensions\\' should be an array of' +\n          ' strings. Found raw string in JSON for \\'' + json['type'] +\n          '\\' block.');\n      json['extensions'] = [json['extensions']];  // Correct and continue.\n    }\n\n    // Add the mutator to the block.\n    if (json['mutator'] !== undefined) {\n      Extensions.apply(json['mutator'], this, true);\n    }\n\n    const extensionNames = json['extensions'];\n    if (Array.isArray(extensionNames)) {\n      for (let j = 0; j < extensionNames.length; j++) {\n        Extensions.apply(extensionNames[j], this, false);\n      }\n    }\n  }\n\n  /**\n   * Initialize the colour of this block from the JSON description.\n   *\n   * @param json Structured data describing the block.\n   * @param warningPrefix Warning prefix string identifying block.\n   */\n  private jsonInitColour_(json: AnyDuringMigration, warningPrefix: string) {\n    if ('colour' in json) {\n      if (json['colour'] === undefined) {\n        console.warn(warningPrefix + 'Undefined colour value.');\n      } else {\n        const rawValue = json['colour'];\n        try {\n          this.setColour(rawValue);\n        } catch (e) {\n          console.warn(warningPrefix + 'Illegal colour value: ', rawValue);\n        }\n      }\n    }\n  }\n\n  /**\n   * Initialize the style of this block from the JSON description.\n   *\n   * @param json Structured data describing the block.\n   * @param warningPrefix Warning prefix string identifying block.\n   */\n  private jsonInitStyle_(json: AnyDuringMigration, warningPrefix: string) {\n    const blockStyleName = json['style'];\n    try {\n      this.setStyle(blockStyleName);\n    } catch (styleError) {\n      console.warn(warningPrefix + 'Style does not exist: ', blockStyleName);\n    }\n  }\n\n  /**\n   * Add key/values from mixinObj to this block object. By default, this method\n   * will check that the keys in mixinObj will not overwrite existing values in\n   * the block, including prototype values. This provides some insurance against\n   * mixin / extension incompatibilities with future block features. This check\n   * can be disabled by passing true as the second argument.\n   *\n   * @param mixinObj The key/values pairs to add to this block object.\n   * @param opt_disableCheck Option flag to disable overwrite checks.\n   */\n  mixin(mixinObj: AnyDuringMigration, opt_disableCheck?: boolean) {\n    if (opt_disableCheck !== undefined &&\n        typeof opt_disableCheck !== 'boolean') {\n      throw Error('opt_disableCheck must be a boolean if provided');\n    }\n    if (!opt_disableCheck) {\n      const overwrites = [];\n      for (const key in mixinObj) {\n        if ((this as AnyDuringMigration)[key] !== undefined) {\n          overwrites.push(key);\n        }\n      }\n      if (overwrites.length) {\n        throw Error(\n            'Mixin will overwrite block members: ' +\n            JSON.stringify(overwrites));\n      }\n    }\n    Object.assign(this, mixinObj);\n  }\n\n  /**\n   * Interpolate a message description onto the block.\n   *\n   * @param message Text contains interpolation tokens (%1, %2, ...) that match\n   *     with fields or inputs defined in the args array.\n   * @param args Array of arguments to be interpolated.\n   * @param lastDummyAlign If a dummy input is added at the end, how should it\n   *     be aligned?\n   * @param warningPrefix Warning prefix string identifying block.\n   */\n  private interpolate_(\n      message: string, args: AnyDuringMigration[],\n      lastDummyAlign: string|undefined, warningPrefix: string) {\n    const tokens = parsing.tokenizeInterpolation(message);\n    this.validateTokens_(tokens, args.length);\n    const elements = this.interpolateArguments_(tokens, args, lastDummyAlign);\n\n    // An array of [field, fieldName] tuples.\n    const fieldStack = [];\n    for (let i = 0, element; element = elements[i]; i++) {\n      if (this.isInputKeyword_(element['type'])) {\n        const input = this.inputFromJson_(element, warningPrefix);\n        // Should never be null, but just in case.\n        if (input) {\n          for (let j = 0, tuple; tuple = fieldStack[j]; j++) {\n            input.appendField(tuple[0], tuple[1]);\n          }\n          fieldStack.length = 0;\n        }\n      } else {\n        // All other types, including ones starting with 'input_' get routed\n        // here.\n        const field = this.fieldFromJson_(element);\n        if (field) {\n          fieldStack.push([field, element['name']]);\n        }\n      }\n    }\n  }\n\n  /**\n   * Validates that the tokens are within the correct bounds, with no\n   * duplicates, and that all of the arguments are referred to. Throws errors if\n   * any of these things are not true.\n   *\n   * @param tokens An array of tokens to validate\n   * @param argsCount The number of args that need to be referred to.\n   */\n  private validateTokens_(tokens: Array<string|number>, argsCount: number) {\n    const visitedArgsHash = [];\n    let visitedArgsCount = 0;\n    for (let i = 0; i < tokens.length; i++) {\n      const token = tokens[i];\n      if (typeof token !== 'number') {\n        continue;\n      }\n      if (token < 1 || token > argsCount) {\n        throw Error(\n            'Block \"' + this.type + '\": ' +\n            'Message index %' + token + ' out of range.');\n      }\n      if (visitedArgsHash[token]) {\n        throw Error(\n            'Block \"' + this.type + '\": ' +\n            'Message index %' + token + ' duplicated.');\n      }\n      visitedArgsHash[token] = true;\n      visitedArgsCount++;\n    }\n    if (visitedArgsCount !== argsCount) {\n      throw Error(\n          'Block \"' + this.type + '\": ' +\n          'Message does not reference all ' + argsCount + ' arg(s).');\n    }\n  }\n\n  /**\n   * Inserts args in place of numerical tokens. String args are converted to\n   * JSON that defines a label field. If necessary an extra dummy input is added\n   * to the end of the elements.\n   *\n   * @param tokens The tokens to interpolate\n   * @param args The arguments to insert.\n   * @param lastDummyAlign The alignment the added dummy input should have, if\n   *     we are required to add one.\n   * @returns The JSON definitions of field and inputs to add to the block.\n   */\n  private interpolateArguments_(\n      tokens: Array<string|number>, args: Array<AnyDuringMigration|string>,\n      lastDummyAlign: string|undefined): AnyDuringMigration[] {\n    const elements = [];\n    for (let i = 0; i < tokens.length; i++) {\n      let element = tokens[i];\n      if (typeof element === 'number') {\n        element = args[element - 1];\n      }\n      // Args can be strings, which is why this isn't elseif.\n      if (typeof element === 'string') {\n        // AnyDuringMigration because:  Type '{ text: string; type: string; } |\n        // null' is not assignable to type 'string | number'.\n        element = this.stringToFieldJson_(element) as AnyDuringMigration;\n        if (!element) {\n          continue;\n        }\n      }\n      elements.push(element);\n    }\n\n    const length = elements.length;\n    if (length &&\n        !this.isInputKeyword_(\n            (elements as AnyDuringMigration)[length - 1]['type'])) {\n      const dummyInput = {'type': 'input_dummy'};\n      if (lastDummyAlign) {\n        (dummyInput as AnyDuringMigration)['align'] = lastDummyAlign;\n      }\n      elements.push(dummyInput);\n    }\n\n    return elements;\n  }\n\n  /**\n   * Creates a field from the JSON definition of a field. If a field with the\n   * given type cannot be found, this attempts to create a different field using\n   * the 'alt' property of the JSON definition (if it exists).\n   *\n   * @param element The element to try to turn into a field.\n   * @returns The field defined by the JSON, or null if one couldn't be created.\n   */\n  private fieldFromJson_(element: {alt?: string, type?: string, text?: string}):\n      Field|null {\n    const field = fieldRegistry.fromJson(element);\n    if (!field && element['alt']) {\n      if (typeof element['alt'] === 'string') {\n        const json = this.stringToFieldJson_(element['alt']);\n        return json ? this.fieldFromJson_(json) : null;\n      }\n      return this.fieldFromJson_(element['alt']);\n    }\n    return field;\n  }\n\n  /**\n   * Creates an input from the JSON definition of an input. Sets the input's\n   * check and alignment if they are provided.\n   *\n   * @param element The JSON to turn into an input.\n   * @param warningPrefix The prefix to add to warnings to help the developer\n   *     debug.\n   * @returns The input that has been created, or null if one could not be\n   *     created for some reason (should never happen).\n   */\n  private inputFromJson_(element: AnyDuringMigration, warningPrefix: string):\n      Input|null {\n    const alignmentLookup = {\n      'LEFT': Align.LEFT,\n      'RIGHT': Align.RIGHT,\n      'CENTRE': Align.CENTRE,\n      'CENTER': Align.CENTRE,\n    };\n\n    let input = null;\n    switch (element['type']) {\n      case 'input_value':\n        input = this.appendValueInput(element['name']);\n        break;\n      case 'input_statement':\n        input = this.appendStatementInput(element['name']);\n        break;\n      case 'input_dummy':\n        input = this.appendDummyInput(element['name']);\n        break;\n    }\n    // Should never be hit because of interpolate_'s checks, but just in case.\n    if (!input) {\n      return null;\n    }\n\n    if (element['check']) {\n      input.setCheck(element['check']);\n    }\n    if (element['align']) {\n      const alignment =\n          (alignmentLookup as\n           AnyDuringMigration)[element['align'].toUpperCase()];\n      if (alignment === undefined) {\n        console.warn(warningPrefix + 'Illegal align value: ', element['align']);\n      } else {\n        input.setAlign(alignment);\n      }\n    }\n    return input;\n  }\n\n  /**\n   * Returns true if the given string matches one of the input keywords.\n   *\n   * @param str The string to check.\n   * @returns True if the given string matches one of the input keywords, false\n   *     otherwise.\n   */\n  private isInputKeyword_(str: string): boolean {\n    return str === 'input_value' || str === 'input_statement' ||\n        str === 'input_dummy';\n  }\n\n  /**\n   * Turns a string into the JSON definition of a label field. If the string\n   * becomes an empty string when trimmed, this returns null.\n   *\n   * @param str String to turn into the JSON definition of a label field.\n   * @returns The JSON definition or null.\n   */\n  private stringToFieldJson_(str: string): {text: string, type: string}|null {\n    str = str.trim();\n    if (str) {\n      return {\n        'type': 'field_label',\n        'text': str,\n      };\n    }\n    return null;\n  }\n\n  /**\n   * Add a value input, statement input or local variable to this block.\n   *\n   * @param type One of Blockly.inputTypes.\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  protected appendInput_(type: number, name: string): Input {\n    let connection = null;\n    if (type === inputTypes.VALUE || type === inputTypes.STATEMENT) {\n      connection = this.makeConnection_(type);\n    }\n    if (type === inputTypes.STATEMENT) {\n      this.statementInputCount++;\n    }\n    // AnyDuringMigration because:  Argument of type 'Connection | null' is not\n    // assignable to parameter of type 'Connection'.\n    const input =\n        new Input(type, name, this, (connection as AnyDuringMigration));\n    // Append input to list.\n    this.inputList.push(input);\n    return input;\n  }\n\n  /**\n   * Move a named input to a different location on this block.\n   *\n   * @param name The name of the input to move.\n   * @param refName Name of input that should be after the moved input, or null\n   *     to be the input at the end.\n   */\n  moveInputBefore(name: string, refName: string|null) {\n    if (name === refName) {\n      return;\n    }\n    // Find both inputs.\n    let inputIndex = -1;\n    let refIndex = refName ? -1 : this.inputList.length;\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      if (input.name === name) {\n        inputIndex = i;\n        if (refIndex !== -1) {\n          break;\n        }\n      } else if (refName && input.name === refName) {\n        refIndex = i;\n        if (inputIndex !== -1) {\n          break;\n        }\n      }\n    }\n    if (inputIndex === -1) {\n      throw Error('Named input \"' + name + '\" not found.');\n    }\n    if (refIndex === -1) {\n      throw Error('Reference input \"' + refName + '\" not found.');\n    }\n    this.moveNumberedInputBefore(inputIndex, refIndex);\n  }\n\n  /**\n   * Move a numbered input to a different location on this block.\n   *\n   * @param inputIndex Index of the input to move.\n   * @param refIndex Index of input that should be after the moved input.\n   */\n  moveNumberedInputBefore(inputIndex: number, refIndex: number) {\n    // Validate arguments.\n    if (inputIndex === refIndex) {\n      throw Error('Can\\'t move input to itself.');\n    }\n    if (inputIndex >= this.inputList.length) {\n      throw RangeError('Input index ' + inputIndex + ' out of bounds.');\n    }\n    if (refIndex > this.inputList.length) {\n      throw RangeError('Reference input ' + refIndex + ' out of bounds.');\n    }\n    // Remove input.\n    const input = this.inputList[inputIndex];\n    this.inputList.splice(inputIndex, 1);\n    if (inputIndex < refIndex) {\n      refIndex--;\n    }\n    // Reinsert input.\n    this.inputList.splice(refIndex, 0, input);\n  }\n\n  /**\n   * Remove an input from this block.\n   *\n   * @param name The name of the input.\n   * @param opt_quiet True to prevent an error if input is not present.\n   * @returns True if operation succeeds, false if input is not present and\n   *     opt_quiet is true.\n   * @throws {Error} if the input is not present and opt_quiet is not true.\n   */\n  removeInput(name: string, opt_quiet?: boolean): boolean {\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      if (input.name === name) {\n        if (input.type === inputTypes.STATEMENT) {\n          this.statementInputCount--;\n        }\n        input.dispose();\n        this.inputList.splice(i, 1);\n        return true;\n      }\n    }\n    if (opt_quiet) {\n      return false;\n    }\n    throw Error('Input not found: ' + name);\n  }\n\n  /**\n   * Fetches the named input object.\n   *\n   * @param name The name of the input.\n   * @returns The input object, or null if input does not exist.\n   */\n  getInput(name: string): Input|null {\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      if (input.name === name) {\n        return input;\n      }\n    }\n    // This input does not exist.\n    return null;\n  }\n\n  /**\n   * Fetches the block attached to the named input.\n   *\n   * @param name The name of the input.\n   * @returns The attached value block, or null if the input is either\n   *     disconnected or if the input does not exist.\n   */\n  getInputTargetBlock(name: string): Block|null {\n    const input = this.getInput(name);\n    return input && input.connection && input.connection.targetBlock();\n  }\n\n  /**\n   * Returns the comment on this block (or null if there is no comment).\n   *\n   * @returns Block's comment.\n   */\n  getCommentText(): string|null {\n    return this.commentModel.text;\n  }\n\n  /**\n   * Set this block's comment text.\n   *\n   * @param text The text, or null to delete.\n   */\n  setCommentText(text: string|null) {\n    if (this.commentModel.text === text) {\n      return;\n    }\n    eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n        this, 'comment', null, this.commentModel.text, text));\n    this.commentModel.text = text;\n    // AnyDuringMigration because:  Type 'string | null' is not assignable to\n    // type 'string | Comment'.\n    this.comment = text as AnyDuringMigration;  // For backwards compatibility.\n  }\n\n  /**\n   * Set this block's warning text.\n   *\n   * @param _text The text, or null to delete.\n   * @param _opt_id An optional ID for the warning text to be able to maintain\n   *     multiple warnings.\n   */\n  setWarningText(_text: string|null, _opt_id?: string) {}\n  // NOP.\n\n  /**\n   * Give this block a mutator dialog.\n   *\n   * @param _mutator A mutator dialog instance or null to remove.\n   */\n  setMutator(_mutator: Mutator) {}\n  // NOP.\n\n  /**\n   * Return the coordinates of the top-left corner of this block relative to the\n   * drawing surface's origin (0,0), in workspace units.\n   *\n   * @returns Object with .x and .y properties.\n   */\n  getRelativeToSurfaceXY(): Coordinate {\n    return this.xy_;\n  }\n\n  /**\n   * Move a block by a relative offset.\n   *\n   * @param dx Horizontal offset, in workspace units.\n   * @param dy Vertical offset, in workspace units.\n   */\n  moveBy(dx: number, dy: number) {\n    if (this.parentBlock_) {\n      throw Error('Block has parent.');\n    }\n    const event =\n        new (eventUtils.get(eventUtils.BLOCK_MOVE))(this) as BlockMove;\n    this.xy_.translate(dx, dy);\n    event.recordNew();\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Create a connection of the specified type.\n   *\n   * @param type The type of the connection to create.\n   * @returns A new connection of the specified type.\n   */\n  protected makeConnection_(type: number): Connection {\n    return new Connection(this, type);\n  }\n\n  /**\n   * Recursively checks whether all statement and value inputs are filled with\n   * blocks. Also checks all following statement blocks in this stack.\n   *\n   * @param opt_shadowBlocksAreFilled An optional argument controlling whether\n   *     shadow blocks are counted as filled. Defaults to true.\n   * @returns True if all inputs are filled, false otherwise.\n   */\n  allInputsFilled(opt_shadowBlocksAreFilled?: boolean): boolean {\n    // Account for the shadow block filledness toggle.\n    if (opt_shadowBlocksAreFilled === undefined) {\n      opt_shadowBlocksAreFilled = true;\n    }\n    if (!opt_shadowBlocksAreFilled && this.isShadow()) {\n      return false;\n    }\n\n    // Recursively check each input block of the current block.\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      if (!input.connection) {\n        continue;\n      }\n      const target = input.connection.targetBlock();\n      if (!target || !target.allInputsFilled(opt_shadowBlocksAreFilled)) {\n        return false;\n      }\n    }\n\n    // Recursively check the next block after the current block.\n    const next = this.getNextBlock();\n    if (next) {\n      return next.allInputsFilled(opt_shadowBlocksAreFilled);\n    }\n\n    return true;\n  }\n\n  /**\n   * This method returns a string describing this Block in developer terms (type\n   * name and ID; English only).\n   *\n   * Intended to on be used in console logs and errors. If you need a string\n   * that uses the user's native language (including block text, field values,\n   * and child blocks), use [toString()]{@link Block#toString}.\n   *\n   * @returns The description.\n   */\n  toDevString(): string {\n    let msg = this.type ? '\"' + this.type + '\" block' : 'Block';\n    if (this.id) {\n      msg += ' (id=\"' + this.id + '\")';\n    }\n    return msg;\n  }\n}\n\nexport namespace Block {\n  export interface CommentModel {\n    text: string|null;\n    pinned: boolean;\n    size: Size;\n  }\n}\n\nexport type CommentModel = Block.CommentModel;\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a code comment.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Comment');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_bubble_open.js';\n\nimport type {CommentModel} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport {Bubble} from './bubble.js';\nimport * as Css from './css.js';\nimport * as eventUtils from './events/utils.js';\nimport {Icon} from './icon.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport type {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\n\n\n/**\n * Class for a comment.\n *\n * @alias Blockly.Comment\n */\nexport class Comment extends Icon {\n  private readonly model_: CommentModel;\n\n  /**\n   * The model's text value at the start of an edit.\n   * Used to tell if an event should be fired at the end of an edit.\n   */\n  private cachedText_: string|null = '';\n\n  /** Mouse up event data. */\n  private onMouseUpWrapper_: browserEvents.Data|null = null;\n\n  /** Wheel event data. */\n  private onWheelWrapper_: browserEvents.Data|null = null;\n\n  /** Change event data. */\n  private onChangeWrapper_: browserEvents.Data|null = null;\n\n  /** Input event data. */\n  private onInputWrapper_: browserEvents.Data|null = null;\n\n  /**\n   * The SVG element that contains the text edit area, or null if not created.\n   */\n  private foreignObject_: SVGForeignObjectElement|null = null;\n\n  /** The editable text area, or null if not created. */\n  private textarea_: HTMLTextAreaElement|null = null;\n\n  /** The top-level node of the comment text, or null if not created. */\n  private paragraphElement_: SVGTextElement|null = null;\n\n  /** @param block The block associated with this comment. */\n  constructor(block: BlockSvg) {\n    super(block);\n\n    /** The model for this comment. */\n    this.model_ = block.commentModel;\n    // If someone creates the comment directly instead of calling\n    // block.setCommentText we want to make sure the text is non-null;\n    this.model_.text = this.model_.text ?? '';\n\n    this.createIcon();\n  }\n\n  /**\n   * Draw the comment icon.\n   *\n   * @param group The icon group.\n   */\n  protected override drawIcon_(group: Element) {\n    // Circle.\n    dom.createSvgElement(\n        Svg.CIRCLE,\n        {'class': 'blocklyIconShape', 'r': '8', 'cx': '8', 'cy': '8'}, group);\n    // Can't use a real '?' text character since different browsers and\n    // operating systems render it differently. Body of question mark.\n    dom.createSvgElement(\n        Svg.PATH, {\n          'class': 'blocklyIconSymbol',\n          'd': 'm6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.405' +\n              '0.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25' +\n              '-1.201,0.998 -1.201,1.528 -1.204,2.19z',\n        },\n        group);\n    // Dot of question mark.\n    dom.createSvgElement(\n        Svg.RECT, {\n          'class': 'blocklyIconSymbol',\n          'x': '6.8',\n          'y': '10.78',\n          'height': '2',\n          'width': '2',\n        },\n        group);\n  }\n\n  /**\n   * Create the editor for the comment's bubble.\n   *\n   * @returns The top-level node of the editor.\n   */\n  private createEditor_(): SVGElement {\n    /* Create the editor.  Here's the markup that will be generated in\n         * editable mode:\n          <foreignObject x=\"8\" y=\"8\" width=\"164\" height=\"164\">\n            <body xmlns=\"http://www.w3.org/1999/xhtml\"\n       class=\"blocklyMinimalBody\"> <textarea\n       xmlns=\"http://www.w3.org/1999/xhtml\" class=\"blocklyCommentTextarea\"\n                  style=\"height: 164px; width: 164px;\"></textarea>\n            </body>\n          </foreignObject>\n         * For non-editable mode see Warning.textToDom_.\n         */\n\n    this.foreignObject_ = dom.createSvgElement(\n        Svg.FOREIGNOBJECT,\n        {'x': Bubble.BORDER_WIDTH, 'y': Bubble.BORDER_WIDTH});\n\n    const body = document.createElementNS(dom.HTML_NS, 'body');\n    body.setAttribute('xmlns', dom.HTML_NS);\n    body.className = 'blocklyMinimalBody';\n\n    this.textarea_ = document.createElementNS(dom.HTML_NS, 'textarea') as\n        HTMLTextAreaElement;\n    const textarea = this.textarea_;\n    textarea.className = 'blocklyCommentTextarea';\n    textarea.setAttribute('dir', this.block_.RTL ? 'RTL' : 'LTR');\n    textarea.value = this.model_.text ?? '';\n    this.resizeTextarea_();\n\n    body.appendChild(textarea);\n    this.foreignObject_!.appendChild(body);\n\n    // Ideally this would be hooked to the focus event for the comment.\n    // However doing so in Firefox swallows the cursor for unknown reasons.\n    // So this is hooked to mouseup instead.  No big deal.\n    this.onMouseUpWrapper_ = browserEvents.conditionalBind(\n        textarea, 'mouseup', this, this.startEdit_, true, true);\n    // Don't zoom with mousewheel.\n    this.onWheelWrapper_ = browserEvents.conditionalBind(\n        textarea, 'wheel', this, function(e: Event) {\n          e.stopPropagation();\n        });\n    this.onChangeWrapper_ = browserEvents.conditionalBind(\n        textarea, 'change', this,\n        /**\n         * @param _e Unused event parameter.\n         */\n        function(this: Comment, _e: Event) {\n          if (this.cachedText_ !== this.model_.text) {\n            eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n                this.block_, 'comment', null, this.cachedText_,\n                this.model_.text));\n          }\n        });\n    this.onInputWrapper_ = browserEvents.conditionalBind(\n        textarea, 'input', this,\n        /**\n         * @param _e Unused event parameter.\n         */\n        function(this: Comment, _e: Event) {\n          this.model_.text = textarea.value;\n        });\n\n    setTimeout(textarea.focus.bind(textarea), 0);\n\n    return this.foreignObject_;\n  }\n\n  /** Add or remove editability of the comment. */\n  override updateEditable() {\n    super.updateEditable();\n    if (this.isVisible()) {\n      // Recreate the bubble with the correct UI.\n      this.disposeBubble_();\n      this.createBubble_();\n    }\n  }\n\n  /**\n   * Callback function triggered when the bubble has resized.\n   * Resize the text area accordingly.\n   */\n  private onBubbleResize_() {\n    if (!this.isVisible() || !this.bubble_) {\n      return;\n    }\n\n    this.model_.size = this.bubble_.getBubbleSize();\n    this.resizeTextarea_();\n  }\n\n  /**\n   * Resizes the text area to match the size defined on the model (which is\n   * the size of the bubble).\n   */\n  private resizeTextarea_() {\n    const size = this.model_.size;\n    const doubleBorderWidth = 2 * Bubble.BORDER_WIDTH;\n    const widthMinusBorder = size.width - doubleBorderWidth;\n    const heightMinusBorder = size.height - doubleBorderWidth;\n    this.foreignObject_!.setAttribute('width', `${widthMinusBorder}`);\n    this.foreignObject_!.setAttribute('height', `${heightMinusBorder}`);\n    this.textarea_!.style.width = widthMinusBorder - 4 + 'px';\n    this.textarea_!.style.height = heightMinusBorder - 4 + 'px';\n  }\n\n  /**\n   * Show or hide the comment bubble.\n   *\n   * @param visible True if the bubble should be visible.\n   */\n  override setVisible(visible: boolean) {\n    if (visible === this.isVisible()) {\n      return;\n    }\n    eventUtils.fire(new (eventUtils.get(eventUtils.BUBBLE_OPEN))(\n        this.block_, visible, 'comment'));\n    this.model_.pinned = visible;\n    if (visible) {\n      this.createBubble_();\n    } else {\n      this.disposeBubble_();\n    }\n  }\n\n  /** Show the bubble. Handles deciding if it should be editable or not. */\n  private createBubble_() {\n    if (!this.block_.isEditable()) {\n      this.createNonEditableBubble_();\n    } else {\n      this.createEditableBubble_();\n    }\n  }\n\n  /** Show an editable bubble. */\n  private createEditableBubble_() {\n    this.bubble_ = new Bubble(\n        this.block_.workspace, this.createEditor_(),\n        this.block_.pathObject.svgPath, (this.iconXY_ as Coordinate),\n        this.model_.size.width, this.model_.size.height);\n    // Expose this comment's block's ID on its top-level SVG group.\n    this.bubble_.setSvgId(this.block_.id);\n    this.bubble_.registerResizeEvent(this.onBubbleResize_.bind(this));\n    this.applyColour();\n  }\n\n  /**\n   * Show a non-editable bubble.\n   *\n   * @suppress {checkTypes} Suppress `this` type mismatch.\n   */\n  private createNonEditableBubble_() {\n    // TODO (#2917): It would be great if the comment could support line breaks.\n    this.paragraphElement_ = Bubble.textToDom(this.model_.text ?? '');\n    this.bubble_ = Bubble.createNonEditableBubble(\n        this.paragraphElement_, (this.block_), this.iconXY_ as Coordinate);\n    this.applyColour();\n  }\n\n  /**\n   * Dispose of the bubble.\n   *\n   * @suppress {checkTypes} Suppress `this` type mismatch.\n   */\n  private disposeBubble_() {\n    if (this.onMouseUpWrapper_) {\n      browserEvents.unbind(this.onMouseUpWrapper_);\n      this.onMouseUpWrapper_ = null;\n    }\n    if (this.onWheelWrapper_) {\n      browserEvents.unbind(this.onWheelWrapper_);\n      this.onWheelWrapper_ = null;\n    }\n    if (this.onChangeWrapper_) {\n      browserEvents.unbind(this.onChangeWrapper_);\n      this.onChangeWrapper_ = null;\n    }\n    if (this.onInputWrapper_) {\n      browserEvents.unbind(this.onInputWrapper_);\n      this.onInputWrapper_ = null;\n    }\n    if (this.bubble_) {\n      this.bubble_.dispose();\n      this.bubble_ = null;\n    }\n    this.textarea_ = null;\n    this.foreignObject_ = null;\n    this.paragraphElement_ = null;\n  }\n\n  /**\n   * Callback fired when an edit starts.\n   *\n   * Bring the comment to the top of the stack when clicked on. Also cache the\n   * current text so it can be used to fire a change event.\n   *\n   * @param _e Mouse up event.\n   */\n  private startEdit_(_e: Event) {\n    if (this.bubble_?.promote()) {\n      // Since the act of moving this node within the DOM causes a loss of\n      // focus, we need to reapply the focus.\n      this.textarea_!.focus();\n    }\n\n    this.cachedText_ = this.model_.text;\n  }\n\n  /**\n   * Get the dimensions of this comment's bubble.\n   *\n   * @returns Object with width and height properties.\n   */\n  getBubbleSize(): Size {\n    return this.model_.size;\n  }\n\n  /**\n   * Size this comment's bubble.\n   *\n   * @param width Width of the bubble.\n   * @param height Height of the bubble.\n   */\n  setBubbleSize(width: number, height: number) {\n    if (this.bubble_) {\n      this.bubble_.setBubbleSize(width, height);\n    } else {\n      this.model_.size.width = width;\n      this.model_.size.height = height;\n    }\n  }\n\n  /**\n   * Update the comment's view to match the model.\n   *\n   * @internal\n   */\n  updateText() {\n    if (this.textarea_) {\n      this.textarea_.value = this.model_.text ?? '';\n    } else if (this.paragraphElement_) {\n      // Non-Editable mode.\n      // TODO (#2917): If 2917 gets added this will probably need to be updated.\n      this.paragraphElement_.firstChild!.textContent = this.model_.text;\n    }\n  }\n\n  /**\n   * Dispose of this comment.\n   *\n   * If you want to receive a comment \"delete\" event (newValue: null), then this\n   * should not be called directly. Instead call block.setCommentText(null);\n   */\n  override dispose() {\n    this.block_.comment = null;\n    super.dispose();\n  }\n}\n\n/** CSS for block comment.  See css.js for use. */\nCss.register(`\n.blocklyCommentTextarea {\n  background-color: #fef49c;\n  border: 0;\n  display: block;\n  margin: 0;\n  outline: 0;\n  padding: 3px;\n  resize: none;\n  text-overflow: hidden;\n}\n`);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Registry for context menu option items.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ContextMenuRegistry');\n\nimport type {BlockSvg} from './block_svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Class for the registry of context menu items. This is intended to be a\n * singleton. You should not create a new instance, and only access this class\n * from ContextMenuRegistry.registry.\n *\n * @alias Blockly.ContextMenuRegistry\n */\nexport class ContextMenuRegistry {\n  static registry: ContextMenuRegistry;\n  /** Registry of all registered RegistryItems, keyed by ID. */\n  private registry_ = new Map<string, RegistryItem>();\n\n  /** Resets the existing singleton instance of ContextMenuRegistry. */\n  constructor() {\n    this.reset();\n  }\n\n  /** Clear and recreate the registry. */\n  reset() {\n    this.registry_.clear();\n  }\n\n  /**\n   * Registers a RegistryItem.\n   *\n   * @param item Context menu item to register.\n   * @throws {Error} if an item with the given ID already exists.\n   */\n  register(item: RegistryItem) {\n    if (this.registry_.has(item.id)) {\n      throw Error('Menu item with ID \"' + item.id + '\" is already registered.');\n    }\n    this.registry_.set(item.id, item);\n  }\n\n  /**\n   * Unregisters a RegistryItem with the given ID.\n   *\n   * @param id The ID of the RegistryItem to remove.\n   * @throws {Error} if an item with the given ID does not exist.\n   */\n  unregister(id: string) {\n    if (!this.registry_.has(id)) {\n      throw new Error('Menu item with ID \"' + id + '\" not found.');\n    }\n    this.registry_.delete(id);\n  }\n\n  /**\n   * @param id The ID of the RegistryItem to get.\n   * @returns RegistryItem or null if not found\n   */\n  getItem(id: string): RegistryItem|null {\n    return this.registry_.get(id) ?? null;\n  }\n\n  /**\n   * Gets the valid context menu options for the given scope type (e.g. block or\n   * workspace) and scope. Blocks are only shown if the preconditionFn shows\n   * they should not be hidden.\n   *\n   * @param scopeType Type of scope where menu should be shown (e.g. on a block\n   *     or on a workspace)\n   * @param scope Current scope of context menu (i.e., the exact workspace or\n   *     block being clicked on)\n   * @returns the list of ContextMenuOptions\n   */\n  getContextMenuOptions(scopeType: ScopeType, scope: Scope):\n      ContextMenuOption[] {\n    const menuOptions: ContextMenuOption[] = [];\n    for (const item of this.registry_.values()) {\n      if (scopeType === item.scopeType) {\n        const precondition = item.preconditionFn(scope);\n        if (precondition !== 'hidden') {\n          const displayText = typeof item.displayText === 'function' ?\n              item.displayText(scope) :\n              item.displayText;\n          const menuOption: ContextMenuOption = {\n            text: displayText,\n            enabled: precondition === 'enabled',\n            callback: item.callback,\n            scope,\n            weight: item.weight,\n          };\n          menuOptions.push(menuOption);\n        }\n      }\n    }\n    menuOptions.sort(function(a, b) {\n      return a.weight - b.weight;\n    });\n    return menuOptions;\n  }\n}\n\nexport namespace ContextMenuRegistry {\n  /**\n   * Where this menu item should be rendered. If the menu item should be\n   * rendered in multiple scopes, e.g. on both a block and a workspace, it\n   * should be registered for each scope.\n   */\n  export enum ScopeType {\n    BLOCK = 'block',\n    WORKSPACE = 'workspace',\n  }\n\n  /**\n   * The actual workspace/block where the menu is being rendered. This is passed\n   * to callback and displayText functions that depend on this information.\n   */\n  export interface Scope {\n    block?: BlockSvg;\n    workspace?: WorkspaceSvg;\n  }\n\n  /**\n   * A menu item as entered in the registry.\n   */\n  export interface RegistryItem {\n    callback: (p1: Scope) => void;\n    scopeType: ScopeType;\n    displayText: ((p1: Scope) => string)|string;\n    preconditionFn: (p1: Scope) => string;\n    weight: number;\n    id: string;\n  }\n\n  /**\n   * A menu item as presented to contextmenu.js.\n   */\n  export interface ContextMenuOption {\n    text: string;\n    enabled: boolean;\n    callback: (p1: Scope) => void;\n    scope: Scope;\n    weight: number;\n  }\n\n  /**\n   * A subset of ContextMenuOption corresponding to what was publicly\n   * documented.  ContextMenuOption should be preferred for new code.\n   */\n  export interface LegacyContextMenuOption {\n    text: string;\n    enabled: boolean;\n    callback: (p1: Scope) => void;\n  }\n\n  /**\n   * Singleton instance of this class. All interactions with this class should\n   * be done on this object.\n   */\n  ContextMenuRegistry.registry = new ContextMenuRegistry();\n}\n\nexport type ScopeType = ContextMenuRegistry.ScopeType;\nexport const ScopeType = ContextMenuRegistry.ScopeType;\nexport type Scope = ContextMenuRegistry.Scope;\nexport type RegistryItem = ContextMenuRegistry.RegistryItem;\nexport type ContextMenuOption = ContextMenuRegistry.ContextMenuOption;\nexport type LegacyContextMenuOption =\n    ContextMenuRegistry.LegacyContextMenuOption;\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Module that provides constants for use inside Blockly. Do not\n * use these constants outside of the core library.\n *\n * @namespace Blockly.internalConstants\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.internalConstants');\n\nimport {ConnectionType} from './connection_type.js';\n\n\n/**\n * Number of characters to truncate a collapsed block to.\n *\n * @alias Blockly.internalConstants.COLLAPSE_CHARS\n * @internal\n */\nexport const COLLAPSE_CHARS = 30;\n\n/**\n * When dragging a block out of a stack, split the stack in two (true), or drag\n * out the block healing the stack (false).\n *\n * @alias Blockly.internalConstants.DRAG_STACK\n * @internal\n */\nexport const DRAG_STACK = true;\n\n/**\n * Lookup table for determining the opposite type of a connection.\n *\n * @alias Blockly.internalConstants.OPPOSITE_TYPE\n * @internal\n */\nexport const OPPOSITE_TYPE: number[] = [];\nOPPOSITE_TYPE[ConnectionType.INPUT_VALUE] = ConnectionType.OUTPUT_VALUE;\nOPPOSITE_TYPE[ConnectionType.OUTPUT_VALUE] = ConnectionType.INPUT_VALUE;\nOPPOSITE_TYPE[ConnectionType.NEXT_STATEMENT] =\n    ConnectionType.PREVIOUS_STATEMENT;\nOPPOSITE_TYPE[ConnectionType.PREVIOUS_STATEMENT] =\n    ConnectionType.NEXT_STATEMENT;\n\n/**\n * String for use in the dropdown created in field_variable.\n * This string indicates that this option in the dropdown is 'Rename\n * variable...' and if selected, should trigger the prompt to rename a variable.\n *\n * @alias Blockly.internalConstants.RENAME_VARIABLE_ID\n * @internal\n */\nexport const RENAME_VARIABLE_ID = 'RENAME_VARIABLE_ID';\n\n/**\n * String for use in the dropdown created in field_variable.\n * This string indicates that this option in the dropdown is 'Delete the \"%1\"\n * variable' and if selected, should trigger the prompt to delete a variable.\n *\n * @alias Blockly.internalConstants.DELETE_VARIABLE_ID\n * @internal\n */\nexport const DELETE_VARIABLE_ID = 'DELETE_VARIABLE_ID';\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a marker.\n * Used primarily for keyboard navigation to show a marked location.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Marker');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {MarkerSvg} from '../renderers/common/marker_svg.js';\n\nimport type {ASTNode} from './ast_node.js';\n\n\n/**\n * Class for a marker.\n * This is used in keyboard navigation to save a location in the Blockly AST.\n *\n * @alias Blockly.Marker\n */\nexport class Marker {\n  /** The colour of the marker. */\n  colour: string|null = null;\n\n  /** The current location of the marker. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'ASTNode'.\n  private curNode_: ASTNode = null as AnyDuringMigration;\n\n  /**\n   * The object in charge of drawing the visual representation of the current\n   * node.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'MarkerSvg'.\n  private drawer_: MarkerSvg = null as AnyDuringMigration;\n\n  /** The type of the marker. */\n  type = 'marker';\n\n  /** Constructs a new Marker instance. */\n  constructor() {}\n\n  /**\n   * Sets the object in charge of drawing the marker.\n   *\n   * @param drawer The object in charge of drawing the marker.\n   */\n  setDrawer(drawer: MarkerSvg) {\n    this.drawer_ = drawer;\n  }\n\n  /**\n   * Get the current drawer for the marker.\n   *\n   * @returns The object in charge of drawing the marker.\n   */\n  getDrawer(): MarkerSvg {\n    return this.drawer_;\n  }\n\n  /**\n   * Gets the current location of the marker.\n   *\n   * @returns The current field, connection, or block the marker is on.\n   */\n  getCurNode(): ASTNode {\n    return this.curNode_;\n  }\n\n  /**\n   * Set the location of the marker and call the update method.\n   * Setting isStack to true will only work if the newLocation is the top most\n   * output or previous connection on a stack.\n   *\n   * @param newNode The new location of the marker.\n   */\n  setCurNode(newNode: ASTNode) {\n    const oldNode = this.curNode_;\n    this.curNode_ = newNode;\n    if (this.drawer_) {\n      this.drawer_.draw(oldNode, this.curNode_);\n    }\n  }\n\n  /**\n   * Redraw the current marker.\n   *\n   * @internal\n   */\n  draw() {\n    if (this.drawer_) {\n      this.drawer_.draw(this.curNode_, this.curNode_);\n    }\n  }\n\n  /** Hide the marker SVG. */\n  hide() {\n    if (this.drawer_) {\n      this.drawer_.hide();\n    }\n  }\n\n  /** Dispose of this marker. */\n  dispose() {\n    if (this.getDrawer()) {\n      this.getDrawer().dispose();\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a cursor.\n * Used primarily for keyboard navigation.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Cursor');\n\nimport * as registry from '../registry.js';\n\nimport {ASTNode} from './ast_node.js';\nimport {Marker} from './marker.js';\n\n\n/**\n * Class for a cursor.\n * A cursor controls how a user navigates the Blockly AST.\n *\n * @alias Blockly.Cursor\n */\nexport class Cursor extends Marker {\n  override type = 'cursor';\n\n  /** @alias Blockly.Cursor */\n  constructor() {\n    super();\n  }\n\n  /**\n   * Find the next connection, field, or block.\n   *\n   * @returns The next element, or null if the current node is not set or there\n   *     is no next value.\n   */\n  next(): ASTNode|null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n\n    let newNode = curNode.next();\n    while (newNode && newNode.next() &&\n           (newNode.getType() === ASTNode.types.NEXT ||\n            newNode.getType() === ASTNode.types.BLOCK)) {\n      newNode = newNode.next();\n    }\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * Find the in connection or field.\n   *\n   * @returns The in element, or null if the current node is not set or there is\n   *     no in value.\n   */\n  in(): ASTNode|null {\n    let curNode: ASTNode|null = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    // If we are on a previous or output connection, go to the block level\n    // before performing next operation.\n    if (curNode.getType() === ASTNode.types.PREVIOUS ||\n        curNode.getType() === ASTNode.types.OUTPUT) {\n      curNode = curNode.next();\n    }\n    const newNode = curNode?.in() ?? null;\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * Find the previous connection, field, or block.\n   *\n   * @returns The previous element, or null if the current node is not set or\n   *     there is no previous value.\n   */\n  prev(): ASTNode|null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    let newNode = curNode.prev();\n\n    while (newNode && newNode.prev() &&\n           (newNode.getType() === ASTNode.types.NEXT ||\n            newNode.getType() === ASTNode.types.BLOCK)) {\n      newNode = newNode.prev();\n    }\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * Find the out connection, field, or block.\n   *\n   * @returns The out element, or null if the current node is not set or there\n   *     is no out value.\n   */\n  out(): ASTNode|null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    let newNode = curNode.out();\n\n    if (newNode && newNode.getType() === ASTNode.types.BLOCK) {\n      newNode = newNode.prev() || newNode;\n    }\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n}\n\nregistry.register(registry.Type.CURSOR, registry.DEFAULT, Cursor);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a basic cursor.\n * Used to demo switching between different cursors.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.BasicCursor');\n\nimport * as registry from '../registry.js';\n\nimport {ASTNode} from './ast_node.js';\nimport {Cursor} from './cursor.js';\n\n\n/**\n * Class for a basic cursor.\n * This will allow the user to get to all nodes in the AST by hitting next or\n * previous.\n *\n * @alias Blockly.BasicCursor\n */\nexport class BasicCursor extends Cursor {\n  /** Name used for registering a basic cursor. */\n  static readonly registrationName = 'basicCursor';\n\n  /** @alias Blockly.BasicCursor */\n  constructor() {\n    super();\n  }\n\n  /**\n   * Find the next node in the pre order traversal.\n   *\n   * @returns The next node, or null if the current node is not set or there is\n   *     no next value.\n   */\n  override next(): ASTNode|null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    const newNode = this.getNextNode_(curNode, this.validNode_);\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * For a basic cursor we only have the ability to go next and previous, so\n   * in will also allow the user to get to the next node in the pre order\n   * traversal.\n   *\n   * @returns The next node, or null if the current node is not set or there is\n   *     no next value.\n   */\n  override in(): ASTNode|null {\n    return this.next();\n  }\n\n  /**\n   * Find the previous node in the pre order traversal.\n   *\n   * @returns The previous node, or null if the current node is not set or there\n   *     is no previous value.\n   */\n  override prev(): ASTNode|null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    const newNode = this.getPreviousNode_(curNode, this.validNode_);\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * For a basic cursor we only have the ability to go next and previous, so\n   * out will allow the user to get to the previous node in the pre order\n   * traversal.\n   *\n   * @returns The previous node, or null if the current node is not set or there\n   *     is no previous value.\n   */\n  override out(): ASTNode|null {\n    return this.prev();\n  }\n\n  /**\n   * Uses pre order traversal to navigate the Blockly AST. This will allow\n   * a user to easily navigate the entire Blockly AST without having to go in\n   * and out levels on the tree.\n   *\n   * @param node The current position in the AST.\n   * @param isValid A function true/false depending on whether the given node\n   *     should be traversed.\n   * @returns The next node in the traversal.\n   */\n  protected getNextNode_(\n      node: ASTNode|null, isValid: (p1: ASTNode|null) => boolean): ASTNode\n      |null {\n    if (!node) {\n      return null;\n    }\n    const newNode = node.in() || node.next();\n    if (isValid(newNode)) {\n      return newNode;\n    } else if (newNode) {\n      return this.getNextNode_(newNode, isValid);\n    }\n    const siblingOrParent = this.findSiblingOrParent_(node.out());\n    if (isValid(siblingOrParent)) {\n      return siblingOrParent;\n    } else if (siblingOrParent) {\n      return this.getNextNode_(siblingOrParent, isValid);\n    }\n    return null;\n  }\n\n  /**\n   * Reverses the pre order traversal in order to find the previous node. This\n   * will allow a user to easily navigate the entire Blockly AST without having\n   * to go in and out levels on the tree.\n   *\n   * @param node The current position in the AST.\n   * @param isValid A function true/false depending on whether the given node\n   *     should be traversed.\n   * @returns The previous node in the traversal or null if no previous node\n   *     exists.\n   */\n  protected getPreviousNode_(\n      node: ASTNode|null, isValid: (p1: ASTNode|null) => boolean): ASTNode\n      |null {\n    if (!node) {\n      return null;\n    }\n    let newNode: ASTNode|null = node.prev();\n\n    if (newNode) {\n      newNode = this.getRightMostChild_(newNode);\n    } else {\n      newNode = node.out();\n    }\n    if (isValid(newNode)) {\n      return newNode;\n    } else if (newNode) {\n      return this.getPreviousNode_(newNode, isValid);\n    }\n    return null;\n  }\n\n  /**\n   * Decides what nodes to traverse and which ones to skip. Currently, it\n   * skips output, stack and workspace nodes.\n   *\n   * @param node The AST node to check whether it is valid.\n   * @returns True if the node should be visited, false otherwise.\n   */\n  protected validNode_(node: ASTNode|null): boolean {\n    let isValid = false;\n    const type = node && node.getType();\n    if (type === ASTNode.types.OUTPUT || type === ASTNode.types.INPUT ||\n        type === ASTNode.types.FIELD || type === ASTNode.types.NEXT ||\n        type === ASTNode.types.PREVIOUS || type === ASTNode.types.WORKSPACE) {\n      isValid = true;\n    }\n    return isValid;\n  }\n\n  /**\n   * From the given node find either the next valid sibling or parent.\n   *\n   * @param node The current position in the AST.\n   * @returns The parent AST node or null if there are no valid parents.\n   */\n  private findSiblingOrParent_(node: ASTNode|null): ASTNode|null {\n    if (!node) {\n      return null;\n    }\n    const nextNode = node.next();\n    if (nextNode) {\n      return nextNode;\n    }\n    return this.findSiblingOrParent_(node.out());\n  }\n\n  /**\n   * Get the right most child of a node.\n   *\n   * @param node The node to find the right most child of.\n   * @returns The right most child of the given node, or the node if no child\n   *     exists.\n   */\n  private getRightMostChild_(node: ASTNode|null): ASTNode|null {\n    if (!node!.in()) {\n      return node;\n    }\n    let newNode = node!.in();\n    while (newNode && newNode.next()) {\n      newNode = newNode.next();\n    }\n    return this.getRightMostChild_(newNode);\n  }\n}\n\nregistry.register(\n    registry.Type.CURSOR, BasicCursor.registrationName, BasicCursor);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a cursor that is used to navigate\n * between tab navigable fields.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.TabNavigateCursor');\n\nimport type {Field} from '../field.js';\n\nimport {ASTNode} from './ast_node.js';\nimport {BasicCursor} from './basic_cursor.js';\n\n\n/**\n * A cursor for navigating between tab navigable fields.\n *\n * @alias Blockly.TabNavigateCursor\n */\nexport class TabNavigateCursor extends BasicCursor {\n  /**\n   * Skip all nodes except for tab navigable fields.\n   *\n   * @param node The AST node to check whether it is valid.\n   * @returns True if the node should be visited, false otherwise.\n   */\n  override validNode_(node: ASTNode|null): boolean {\n    let isValid = false;\n    const type = node && node.getType();\n    if (node) {\n      const location = node.getLocation() as Field;\n      if (type === ASTNode.types.FIELD && location &&\n          location.isTabNavigable() && location.isClickable()) {\n        isValid = true;\n      }\n    }\n    return isValid;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Components for creating connections between blocks.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.RenderedConnection');\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as common from './common.js';\nimport {config} from './config.js';\nimport {Connection} from './connection.js';\nimport type {ConnectionDB} from './connection_db.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as eventUtils from './events/utils.js';\nimport * as internalConstants from './internal_constants.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport * as svgPaths from './utils/svg_paths.js';\n\n\n/** A shape that has a pathDown property. */\ninterface PathDownShape {\n  pathDown: string;\n}\n\n/** A shape that has a pathLeft property. */\ninterface PathLeftShape {\n  pathLeft: string;\n}\n\n/** Maximum randomness in workspace units for bumping a block. */\nconst BUMP_RANDOMNESS = 10;\n\n/**\n * Class for a connection between blocks that may be rendered on screen.\n *\n * @alias Blockly.RenderedConnection\n */\nexport class RenderedConnection extends Connection {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  sourceBlock_!: BlockSvg;\n  private readonly db_: ConnectionDB;\n  private readonly dbOpposite_: ConnectionDB;\n  private readonly offsetInBlock_: Coordinate;\n  private trackedState_: TrackedState;\n\n  /** Connection this connection connects to.  Null if not connected. */\n  override targetConnection: RenderedConnection|null = null;\n\n  /**\n   * @param source The block establishing this connection.\n   * @param type The type of the connection.\n   */\n  constructor(source: BlockSvg, type: number) {\n    super(source, type);\n\n    /**\n     * Connection database for connections of this type on the current\n     * workspace.\n     */\n    this.db_ = source.workspace.connectionDBList[type];\n\n    /**\n     * Connection database for connections compatible with this type on the\n     * current workspace.\n     */\n    this.dbOpposite_ =\n        source.workspace\n            .connectionDBList[internalConstants.OPPOSITE_TYPE[type]];\n\n    /** Workspace units, (0, 0) is top left of block. */\n    this.offsetInBlock_ = new Coordinate(0, 0);\n\n    /** Describes the state of this connection's tracked-ness. */\n    this.trackedState_ = RenderedConnection.TrackedState.WILL_TRACK;\n  }\n\n  /**\n   * Dispose of this connection. Remove it from the database (if it is\n   * tracked) and call the super-function to deal with connected blocks.\n   *\n   * @internal\n   */\n  override dispose() {\n    super.dispose();\n    if (this.trackedState_ === RenderedConnection.TrackedState.TRACKED) {\n      this.db_.removeConnection(this, this.y);\n    }\n  }\n\n  /**\n   * Get the source block for this connection.\n   *\n   * @returns The source block.\n   */\n  override getSourceBlock(): BlockSvg {\n    return super.getSourceBlock() as BlockSvg;\n  }\n\n  /**\n   * Returns the block that this connection connects to.\n   *\n   * @returns The connected block or null if none is connected.\n   */\n  override targetBlock(): BlockSvg|null {\n    return super.targetBlock() as BlockSvg;\n  }\n\n  /**\n   * Returns the distance between this connection and another connection in\n   * workspace units.\n   *\n   * @param otherConnection The other connection to measure the distance to.\n   * @returns The distance between connections, in workspace units.\n   */\n  distanceFrom(otherConnection: Connection): number {\n    const xDiff = this.x - otherConnection.x;\n    const yDiff = this.y - otherConnection.y;\n    return Math.sqrt(xDiff * xDiff + yDiff * yDiff);\n  }\n\n  /**\n   * Move the block(s) belonging to the connection to a point where they don't\n   * visually interfere with the specified connection.\n   *\n   * @param staticConnection The connection to move away from.\n   * @internal\n   */\n  bumpAwayFrom(staticConnection: RenderedConnection) {\n    if (this.sourceBlock_.workspace.isDragging()) {\n      // Don't move blocks around while the user is doing the same.\n      return;\n    }\n    // Move the root block.\n    let rootBlock = this.sourceBlock_.getRootBlock();\n    if (rootBlock.isInFlyout) {\n      // Don't move blocks around in a flyout.\n      return;\n    }\n    let reverse = false;\n    if (!rootBlock.isMovable()) {\n      // Can't bump an uneditable block away.\n      // Check to see if the other block is movable.\n      rootBlock = staticConnection.getSourceBlock().getRootBlock();\n      if (!rootBlock.isMovable()) {\n        return;\n      }\n      // Swap the connections and move the 'static' connection instead.\n      /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n      staticConnection = this;\n      reverse = true;\n    }\n    // Raise it to the top for extra visibility.\n    const selected = common.getSelected() == rootBlock;\n    selected || rootBlock.addSelect();\n    let dx = staticConnection.x + config.snapRadius +\n        Math.floor(Math.random() * BUMP_RANDOMNESS) - this.x;\n    let dy = staticConnection.y + config.snapRadius +\n        Math.floor(Math.random() * BUMP_RANDOMNESS) - this.y;\n    if (reverse) {\n      // When reversing a bump due to an uneditable block, bump up.\n      dy = -dy;\n    }\n    if (rootBlock.RTL) {\n      dx = staticConnection.x - config.snapRadius -\n          Math.floor(Math.random() * BUMP_RANDOMNESS) - this.x;\n    }\n    rootBlock.moveBy(dx, dy);\n    selected || rootBlock.removeSelect();\n  }\n\n  /**\n   * Change the connection's coordinates.\n   *\n   * @param x New absolute x coordinate, in workspace coordinates.\n   * @param y New absolute y coordinate, in workspace coordinates.\n   */\n  moveTo(x: number, y: number) {\n    if (this.trackedState_ === RenderedConnection.TrackedState.WILL_TRACK) {\n      this.db_.addConnection(this, y);\n      this.trackedState_ = RenderedConnection.TrackedState.TRACKED;\n    } else if (this.trackedState_ === RenderedConnection.TrackedState.TRACKED) {\n      this.db_.removeConnection(this, this.y);\n      this.db_.addConnection(this, y);\n    }\n    this.x = x;\n    this.y = y;\n  }\n\n  /**\n   * Change the connection's coordinates.\n   *\n   * @param dx Change to x coordinate, in workspace units.\n   * @param dy Change to y coordinate, in workspace units.\n   */\n  moveBy(dx: number, dy: number) {\n    this.moveTo(this.x + dx, this.y + dy);\n  }\n\n  /**\n   * Move this connection to the location given by its offset within the block\n   * and the location of the block's top left corner.\n   *\n   * @param blockTL The location of the top left corner of the block, in\n   *     workspace coordinates.\n   */\n  moveToOffset(blockTL: Coordinate) {\n    this.moveTo(\n        blockTL.x + this.offsetInBlock_.x, blockTL.y + this.offsetInBlock_.y);\n  }\n\n  /**\n   * Set the offset of this connection relative to the top left of its block.\n   *\n   * @param x The new relative x, in workspace units.\n   * @param y The new relative y, in workspace units.\n   */\n  setOffsetInBlock(x: number, y: number) {\n    this.offsetInBlock_.x = x;\n    this.offsetInBlock_.y = y;\n  }\n\n  /**\n   * Get the offset of this connection relative to the top left of its block.\n   *\n   * @returns The offset of the connection.\n   * @internal\n   */\n  getOffsetInBlock(): Coordinate {\n    return this.offsetInBlock_;\n  }\n\n  /**\n   * Move the blocks on either side of this connection right next to each other.\n   *\n   * @internal\n   */\n  tighten() {\n    const dx = this.targetConnection!.x - this.x;\n    const dy = this.targetConnection!.y - this.y;\n    if (dx !== 0 || dy !== 0) {\n      const block = this.targetBlock();\n      const svgRoot = block!.getSvgRoot();\n      if (!svgRoot) {\n        throw Error('block is not rendered.');\n      }\n      // Workspace coordinates.\n      const xy = svgMath.getRelativeXY(svgRoot);\n      block!.getSvgRoot().setAttribute(\n          'transform', 'translate(' + (xy.x - dx) + ',' + (xy.y - dy) + ')');\n      block!.moveConnections(-dx, -dy);\n    }\n  }\n\n  /**\n   * Find the closest compatible connection to this connection.\n   * All parameters are in workspace units.\n   *\n   * @param maxLimit The maximum radius to another connection.\n   * @param dxy Offset between this connection's location in the database and\n   *     the current location (as a result of dragging).\n   * @returns Contains two properties: 'connection' which is either another\n   *     connection or null, and 'radius' which is the distance.\n   */\n  closest(maxLimit: number, dxy: Coordinate):\n      {connection: RenderedConnection|null, radius: number} {\n    return this.dbOpposite_.searchForClosest(this, maxLimit, dxy);\n  }\n\n  /** Add highlighting around this connection. */\n  highlight() {\n    let steps;\n    const sourceBlockSvg = (this.sourceBlock_);\n    const renderConstants =\n        sourceBlockSvg.workspace.getRenderer().getConstants();\n    const shape = renderConstants.shapeFor(this);\n    if (this.type === ConnectionType.INPUT_VALUE ||\n        this.type === ConnectionType.OUTPUT_VALUE) {\n      // Vertical line, puzzle tab, vertical line.\n      const yLen = renderConstants.TAB_OFFSET_FROM_TOP;\n      steps = svgPaths.moveBy(0, -yLen) + svgPaths.lineOnAxis('v', yLen) +\n          (shape as unknown as PathDownShape).pathDown +\n          svgPaths.lineOnAxis('v', yLen);\n    } else {\n      const xLen =\n          renderConstants.NOTCH_OFFSET_LEFT - renderConstants.CORNER_RADIUS;\n      // Horizontal line, notch, horizontal line.\n      steps = svgPaths.moveBy(-xLen, 0) + svgPaths.lineOnAxis('h', xLen) +\n          (shape as unknown as PathLeftShape).pathLeft +\n          svgPaths.lineOnAxis('h', xLen);\n    }\n    const xy = this.sourceBlock_.getRelativeToSurfaceXY();\n    const x = this.x - xy.x;\n    const y = this.y - xy.y;\n    // AnyDuringMigration because:  Property 'highlightedPath_' does not exist\n    // on type 'typeof Connection'.\n    (Connection as AnyDuringMigration).highlightedPath_ = dom.createSvgElement(\n        Svg.PATH, {\n          'class': 'blocklyHighlightedConnectionPath',\n          'd': steps,\n          'transform': 'translate(' + x + ',' + y + ')' +\n              (this.sourceBlock_.RTL ? ' scale(-1 1)' : ''),\n        },\n        this.sourceBlock_.getSvgRoot());\n  }\n\n  /** Remove the highlighting around this connection. */\n  unhighlight() {\n    // AnyDuringMigration because:  Property 'highlightedPath_' does not exist\n    // on type 'typeof Connection'.\n    dom.removeNode((Connection as AnyDuringMigration).highlightedPath_);\n    // AnyDuringMigration because:  Property 'highlightedPath_' does not exist\n    // on type 'typeof Connection'.\n    delete (Connection as AnyDuringMigration).highlightedPath_;\n  }\n\n  /**\n   * Set whether this connections is tracked in the database or not.\n   *\n   * @param doTracking If true, start tracking. If false, stop tracking.\n   * @internal\n   */\n  setTracking(doTracking: boolean) {\n    if (doTracking &&\n            this.trackedState_ === RenderedConnection.TrackedState.TRACKED ||\n        !doTracking &&\n            this.trackedState_ === RenderedConnection.TrackedState.UNTRACKED) {\n      return;\n    }\n    if (this.sourceBlock_.isInFlyout) {\n      // Don't bother maintaining a database of connections in a flyout.\n      return;\n    }\n    if (doTracking) {\n      this.db_.addConnection(this, this.y);\n      this.trackedState_ = RenderedConnection.TrackedState.TRACKED;\n      return;\n    }\n    if (this.trackedState_ === RenderedConnection.TrackedState.TRACKED) {\n      this.db_.removeConnection(this, this.y);\n    }\n    this.trackedState_ = RenderedConnection.TrackedState.UNTRACKED;\n  }\n\n  /**\n   * Stop tracking this connection, as well as all down-stream connections on\n   * any block attached to this connection. This happens when a block is\n   * collapsed.\n   *\n   * Also closes down-stream icons/bubbles.\n   *\n   * @internal\n   */\n  stopTrackingAll() {\n    this.setTracking(false);\n    if (this.targetConnection) {\n      const blocks = this.targetBlock()!.getDescendants(false);\n      for (let i = 0; i < blocks.length; i++) {\n        const block = blocks[i];\n        // Stop tracking connections of all children.\n        const connections = block.getConnections_(true);\n        for (let j = 0; j < connections.length; j++) {\n          (connections[j]).setTracking(false);\n        }\n        // Close all bubbles of all children.\n        const icons = block.getIcons();\n        for (let j = 0; j < icons.length; j++) {\n          icons[j].setVisible(false);\n        }\n      }\n    }\n  }\n\n  /**\n   * Start tracking this connection, as well as all down-stream connections on\n   * any block attached to this connection. This happens when a block is\n   * expanded.\n   *\n   * @returns List of blocks to render.\n   */\n  startTrackingAll(): Block[] {\n    this.setTracking(true);\n    // All blocks that are not tracked must start tracking before any\n    // rendering takes place, since rendering requires knowing the dimensions\n    // of lower blocks. Also, since rendering a block renders all its parents,\n    // we only need to render the leaf nodes.\n    let renderList: AnyDuringMigration[] = [];\n    if (this.type !== ConnectionType.INPUT_VALUE &&\n        this.type !== ConnectionType.NEXT_STATEMENT) {\n      // Only spider down.\n      return renderList;\n    }\n    const block = this.targetBlock();\n    if (block) {\n      let connections;\n      if (block.isCollapsed()) {\n        // This block should only be partially revealed since it is collapsed.\n        connections = [];\n        block.outputConnection && connections.push(block.outputConnection);\n        block.nextConnection && connections.push(block.nextConnection);\n        block.previousConnection && connections.push(block.previousConnection);\n      } else {\n        // Show all connections of this block.\n        connections = block.getConnections_(true);\n      }\n      for (let i = 0; i < connections.length; i++) {\n        renderList.push(...connections[i].startTrackingAll());\n      }\n      if (!renderList.length) {\n        // Leaf block.\n        renderList = [block];\n      }\n    }\n    return renderList;\n  }\n\n  /**\n   * Behavior after a connection attempt fails.\n   * Bumps this connection away from the other connection. Called when an\n   * attempted connection fails.\n   *\n   * @param otherConnection Connection that this connection failed to connect\n   *     to.\n   * @internal\n   */\n  override onFailedConnect(otherConnection: Connection) {\n    const block = this.getSourceBlock();\n    if (eventUtils.getRecordUndo()) {\n      const group = eventUtils.getGroup();\n      setTimeout(function(this: RenderedConnection) {\n        if (!block.isDisposed() && !block.getParent()) {\n          eventUtils.setGroup(group);\n          this.bumpAwayFrom(otherConnection as RenderedConnection);\n          eventUtils.setGroup(false);\n        }\n      }.bind(this), config.bumpDelay);\n    }\n  }\n\n  /**\n   * Disconnect two blocks that are connected by this connection.\n   *\n   * @param parentBlock The superior block.\n   * @param childBlock The inferior block.\n   */\n  protected override disconnectInternal_(\n      parentBlock: Block, childBlock: Block) {\n    super.disconnectInternal_(parentBlock, childBlock);\n    const renderedParent = parentBlock as BlockSvg;\n    const renderedChild = childBlock as BlockSvg;\n    // Rerender the parent so that it may reflow.\n    if (renderedParent.rendered) {\n      renderedParent.render();\n    }\n    if (renderedChild.rendered) {\n      renderedChild.updateDisabled();\n      renderedChild.render();\n      // Reset visibility, since the child is now a top block.\n      renderedChild.getSvgRoot().style.display = 'block';\n    }\n  }\n\n  /**\n   * Respawn the shadow block if there was one connected to the this connection.\n   * Render/rerender blocks as needed.\n   */\n  protected override respawnShadow_() {\n    super.respawnShadow_();\n    const blockShadow = this.targetBlock();\n    if (!blockShadow) {\n      return;\n    }\n    blockShadow.initSvg();\n    blockShadow.render(false);\n\n    const parentBlock = this.getSourceBlock();\n    if (parentBlock.rendered) {\n      parentBlock.render();\n    }\n  }\n\n  /**\n   * Find all nearby compatible connections to this connection.\n   * Type checking does not apply, since this function is used for bumping.\n   *\n   * @param maxLimit The maximum radius to another connection, in workspace\n   *     units.\n   * @returns List of connections.\n   * @internal\n   */\n  override neighbours(maxLimit: number): Connection[] {\n    return this.dbOpposite_.getNeighbours(this, maxLimit);\n  }\n\n  /**\n   * Connect two connections together.  This is the connection on the superior\n   * block.  Rerender blocks as needed.\n   *\n   * @param childConnection Connection on inferior block.\n   */\n  protected override connect_(childConnection: Connection) {\n    super.connect_(childConnection);\n\n    const renderedChildConnection = childConnection as RenderedConnection;\n\n    const parentBlock = this.getSourceBlock();\n    const childBlock = renderedChildConnection.getSourceBlock();\n    const parentRendered = parentBlock.rendered;\n    const childRendered = childBlock.rendered;\n\n    if (parentRendered) {\n      parentBlock.updateDisabled();\n    }\n    if (childRendered) {\n      childBlock.updateDisabled();\n    }\n    if (parentRendered && childRendered) {\n      if (this.type === ConnectionType.NEXT_STATEMENT ||\n          this.type === ConnectionType.PREVIOUS_STATEMENT) {\n        // Child block may need to square off its corners if it is in a stack.\n        // Rendering a child will render its parent.\n        childBlock.render();\n      } else {\n        // Child block does not change shape.  Rendering the parent node will\n        // move its connected children into position.\n        parentBlock.render();\n      }\n    }\n\n    // The input the child block is connected to (if any).\n    const parentInput = parentBlock.getInputWithBlock(childBlock);\n    if (parentInput) {\n      const visible = parentInput.isVisible();\n      childBlock.getSvgRoot().style.display = visible ? 'block' : 'none';\n    }\n  }\n\n  /**\n   * Function to be called when this connection's compatible types have changed.\n   */\n  protected override onCheckChanged_() {\n    // The new value type may not be compatible with the existing connection.\n    if (this.isConnected() &&\n        (!this.targetConnection ||\n         !this.getConnectionChecker().canConnect(\n             this, this.targetConnection, false))) {\n      const child = this.isSuperior() ? this.targetBlock() : this.sourceBlock_;\n      child!.unplug();\n      // Bump away.\n      this.sourceBlock_.bumpNeighbours();\n    }\n  }\n}\n\nexport namespace RenderedConnection {\n  /**\n   * Enum for different kinds of tracked states.\n   *\n   * WILL_TRACK means that this connection will add itself to\n   * the db on the next moveTo call it receives.\n   *\n   * UNTRACKED means that this connection will not add\n   * itself to the database until setTracking(true) is explicitly called.\n   *\n   * TRACKED means that this connection is currently being tracked.\n   */\n  export enum TrackedState {\n    WILL_TRACK = -1,\n    UNTRACKED = 0,\n    TRACKED = 1,\n  }\n}\n\nexport type TrackedState = RenderedConnection.TrackedState;\nexport const TrackedState = RenderedConnection.TrackedState;\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a warning.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Warning');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_bubble_open.js';\n\nimport type {BlockSvg} from './block_svg.js';\nimport {Bubble} from './bubble.js';\nimport * as eventUtils from './events/utils.js';\nimport {Icon} from './icon.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\n\n\n/**\n * Class for a warning.\n *\n * @alias Blockly.Warning\n */\nexport class Warning extends Icon {\n  private text_: {[key: string]: string};\n\n  /** The top-level node of the warning text, or null if not created. */\n  private paragraphElement_: SVGTextElement|null = null;\n\n  /** Does this icon get hidden when the block is collapsed? */\n  override collapseHidden = false;\n\n  /** @param block The block associated with this warning. */\n  constructor(block: BlockSvg) {\n    super(block);\n    this.createIcon();\n    // The text_ object can contain multiple warnings.\n    this.text_ = Object.create(null);\n  }\n\n  /**\n   * Draw the warning icon.\n   *\n   * @param group The icon group.\n   */\n  protected override drawIcon_(group: Element) {\n    // Triangle with rounded corners.\n    dom.createSvgElement(\n        Svg.PATH, {\n          'class': 'blocklyIconShape',\n          'd': 'M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z',\n        },\n        group);\n    // Can't use a real '!' text character since different browsers and\n    // operating systems render it differently. Body of exclamation point.\n    dom.createSvgElement(\n        Svg.PATH, {\n          'class': 'blocklyIconSymbol',\n          'd': 'm7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z',\n        },\n        group);\n    // Dot of exclamation point.\n    dom.createSvgElement(\n        Svg.RECT, {\n          'class': 'blocklyIconSymbol',\n          'x': '7',\n          'y': '11',\n          'height': '2',\n          'width': '2',\n        },\n        group);\n  }\n\n  /**\n   * Show or hide the warning bubble.\n   *\n   * @param visible True if the bubble should be visible.\n   */\n  override setVisible(visible: boolean) {\n    if (visible === this.isVisible()) {\n      return;\n    }\n    eventUtils.fire(new (eventUtils.get(eventUtils.BUBBLE_OPEN))(\n        this.block_, visible, 'warning'));\n    if (visible) {\n      this.createBubble_();\n    } else {\n      this.disposeBubble_();\n    }\n  }\n\n  /** Show the bubble. */\n  private createBubble_() {\n    this.paragraphElement_ = Bubble.textToDom(this.getText());\n    this.bubble_ = Bubble.createNonEditableBubble(\n        this.paragraphElement_, this.block_, this.iconXY_ as Coordinate);\n    this.applyColour();\n  }\n\n  /** Dispose of the bubble and references to it. */\n  private disposeBubble_() {\n    if (this.bubble_) {\n      this.bubble_.dispose();\n      this.bubble_ = null;\n    }\n    this.paragraphElement_ = null;\n  }\n\n  /**\n   * Set this warning's text.\n   *\n   * @param text Warning text (or '' to delete). This supports linebreaks.\n   * @param id An ID for this text entry to be able to maintain multiple\n   *     warnings.\n   */\n  setText(text: string, id: string) {\n    if (this.text_[id] === text) {\n      return;\n    }\n    if (text) {\n      this.text_[id] = text;\n    } else {\n      delete this.text_[id];\n    }\n    if (this.isVisible()) {\n      this.setVisible(false);\n      this.setVisible(true);\n    }\n  }\n\n  /**\n   * Get this warning's texts.\n   *\n   * @returns All texts concatenated into one string.\n   */\n  getText(): string {\n    const allWarnings = [];\n    for (const id in this.text_) {\n      allWarnings.push(this.text_[id]);\n    }\n    return allWarnings.join('\\n');\n  }\n\n  /** Dispose of this warning. */\n  override dispose() {\n    this.block_.warning = null;\n    super.dispose();\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for graphically rendering a block as SVG.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.BlockSvg');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_selected.js';\n\nimport {Block} from './block.js';\nimport * as blockAnimations from './block_animations.js';\nimport * as browserEvents from './browser_events.js';\nimport {Comment} from './comment.js';\nimport * as common from './common.js';\nimport {config} from './config.js';\nimport type {Connection} from './connection.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as constants from './constants.js';\nimport * as ContextMenu from './contextmenu.js';\nimport {ContextMenuOption, ContextMenuRegistry, LegacyContextMenuOption} from './contextmenu_registry.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Field} from './field.js';\nimport {FieldLabel} from './field_label.js';\nimport type {Icon} from './icon.js';\nimport type {Input} from './input.js';\nimport type {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport type {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport type {CopyData, ICopyable} from './interfaces/i_copyable.js';\nimport type {IDraggable} from './interfaces/i_draggable.js';\nimport * as internalConstants from './internal_constants.js';\nimport {ASTNode} from './keyboard_nav/ast_node.js';\nimport {TabNavigateCursor} from './keyboard_nav/tab_navigate_cursor.js';\nimport {MarkerManager} from './marker_manager.js';\nimport {Msg} from './msg.js';\nimport type {Mutator} from './mutator.js';\nimport {RenderedConnection} from './rendered_connection.js';\nimport type {Debug as BlockRenderingDebug} from './renderers/common/debugger.js';\nimport type {IPathObject} from './renderers/common/i_path_object.js';\nimport * as blocks from './serialization/blocks.js';\nimport type {BlockStyle} from './theme.js';\nimport * as Tooltip from './tooltip.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport {Warning} from './warning.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Class for a block's SVG representation.\n * Not normally called directly, workspace.newBlock() is preferred.\n *\n * @alias Blockly.BlockSvg\n */\nexport class BlockSvg extends Block implements IASTNodeLocationSvg,\n                                               IBoundedElement, ICopyable,\n                                               IDraggable {\n  /**\n   * Constant for identifying rows that are to be rendered inline.\n   * Don't collide with Blockly.inputTypes.\n   */\n  static readonly INLINE = -1;\n\n  /**\n   * ID to give the \"collapsed warnings\" warning. Allows us to remove the\n   * \"collapsed warnings\" warning without removing any warnings that belong to\n   * the block.\n   */\n  static readonly COLLAPSED_WARNING_ID = 'TEMP_COLLAPSED_WARNING_';\n  override decompose?: ((p1: Workspace) => BlockSvg);\n  // override compose?: ((p1: BlockSvg) => void)|null;\n  saveConnections?: ((p1: BlockSvg) => AnyDuringMigration);\n  customContextMenu?:\n      ((p1: Array<ContextMenuOption|LegacyContextMenuOption>) =>\n           AnyDuringMigration)|null;\n\n  /**\n   * An property used internally to reference the block's rendering debugger.\n   *\n   * @internal\n   */\n  renderingDebugger: BlockRenderingDebug|null = null;\n\n  /**\n   * Height of this block, not including any statement blocks above or below.\n   * Height is in workspace units.\n   */\n  height = 0;\n\n  /**\n   * Width of this block, including any connected value blocks.\n   * Width is in workspace units.\n   */\n  width = 0;\n\n  /**\n   * Map from IDs for warnings text to PIDs of functions to apply them.\n   * Used to be able to maintain multiple warnings.\n   */\n  private warningTextDb = new Map<string, ReturnType<typeof setTimeout>>();\n\n  /** Block's mutator icon (if any). */\n  mutator: Mutator|null = null;\n\n  /** Block's comment icon (if any). */\n  private commentIcon_: Comment|null = null;\n\n  /** Block's warning icon (if any). */\n  warning: Warning|null = null;\n\n  private svgGroup_: SVGGElement;\n  style: BlockStyle;\n  /** @internal */\n  pathObject: IPathObject;\n  override rendered = false;\n\n  /**\n   * Is this block currently rendering? Used to stop recursive render calls\n   * from actually triggering a re-render.\n   */\n  private renderIsInProgress_ = false;\n\n  /** Whether mousedown events have been bound yet. */\n  private eventsInit_ = false;\n\n  override workspace: WorkspaceSvg;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override outputConnection!: RenderedConnection;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override nextConnection!: RenderedConnection;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override previousConnection!: RenderedConnection;\n  private readonly useDragSurface_: boolean;\n\n  /**\n   * @param workspace The block's workspace.\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   */\n  constructor(workspace: WorkspaceSvg, prototypeName: string, opt_id?: string) {\n    super(workspace, prototypeName, opt_id);\n    this.workspace = workspace;\n\n    /**\n     * An optional method called when a mutator dialog is first opened.\n     * This function must create and initialize a top-level block for the\n     * mutator dialog, and return it. This function should also populate this\n     * top-level block with any sub-blocks which are appropriate. This method\n     * must also be coupled with defining a `compose` method for the default\n     * mutation dialog button and UI to appear.\n     */\n    this.decompose = this.decompose;\n\n    /**\n     * An optional method called when a mutator dialog saves its content.\n     * This function is called to modify the original block according to new\n     * settings. This method must also be coupled with defining a `decompose`\n     * method for the default mutation dialog button and UI to appear.\n     */\n    this.compose = this.compose;\n\n    /**\n     * An optional method called by the default mutator UI which gives the block\n     * a chance to save information about what child blocks are connected to\n     * what mutated connections.\n     */\n    this.saveConnections = this.saveConnections;\n\n    /** An optional method for defining custom block context menu items. */\n    this.customContextMenu = this.customContextMenu;\n    this.svgGroup_ = dom.createSvgElement(Svg.G, {});\n    (this.svgGroup_ as AnyDuringMigration).translate_ = '';\n\n    /** A block style object. */\n    this.style = workspace.getRenderer().getConstants().getBlockStyle(null);\n\n    /** The renderer's path object. */\n    this.pathObject =\n        workspace.getRenderer().makePathObject(this.svgGroup_, this.style);\n\n    /**\n     * Whether to move the block to the drag surface when it is dragged.\n     * True if it should move, false if it should be translated directly.\n     */\n    this.useDragSurface_ = !!workspace.getBlockDragSurface();\n\n    const svgPath = this.pathObject.svgPath;\n    (svgPath as AnyDuringMigration).tooltip = this;\n    Tooltip.bindMouseEvents(svgPath);\n\n    // Expose this block's ID on its top-level SVG group.\n    this.svgGroup_.setAttribute('data-id', this.id);\n\n    this.doInit_();\n  }\n\n  /**\n   * Create and initialize the SVG representation of the block.\n   * May be called more than once.\n   */\n  initSvg() {\n    if (!this.workspace.rendered) {\n      throw TypeError('Workspace is headless.');\n    }\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      input.init();\n    }\n    const icons = this.getIcons();\n    for (let i = 0; i < icons.length; i++) {\n      icons[i].createIcon();\n    }\n    this.applyColour();\n    this.pathObject.updateMovable(this.isMovable());\n    const svg = this.getSvgRoot();\n    if (!this.workspace.options.readOnly && !this.eventsInit_ && svg) {\n      browserEvents.conditionalBind(svg, 'mousedown', this, this.onMouseDown_);\n    }\n    this.eventsInit_ = true;\n\n    if (!svg.parentNode) {\n      this.workspace.getCanvas().appendChild(svg);\n    }\n  }\n\n  /**\n   * Get the secondary colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  getColourSecondary(): string|null {\n    return this.style.colourSecondary;\n  }\n\n  /**\n   * Get the tertiary colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  getColourTertiary(): string|null {\n    return this.style.colourTertiary;\n  }\n\n  /**\n   * Selects this block. Highlights the block visually and fires a select event\n   * if the block is not already selected.\n   */\n  select() {\n    if (this.isShadow() && this.getParent()) {\n      // Shadow blocks should not be selected.\n      this.getParent()!.select();\n      return;\n    }\n    if (common.getSelected() === this) {\n      return;\n    }\n    let oldId = null;\n    if (common.getSelected()) {\n      oldId = common.getSelected()!.id;\n      // Unselect any previously selected block.\n      eventUtils.disable();\n      try {\n        common.getSelected()!.unselect();\n      } finally {\n        eventUtils.enable();\n      }\n    }\n    const event = new (eventUtils.get(eventUtils.SELECTED))(\n        oldId, this.id, this.workspace.id);\n    eventUtils.fire(event);\n    common.setSelected(this);\n    this.addSelect();\n  }\n\n  /**\n   * Unselects this block. Unhighlights the block and fires a select (false)\n   * event if the block is currently selected.\n   */\n  unselect() {\n    if (common.getSelected() !== this) {\n      return;\n    }\n    const event = new (eventUtils.get(eventUtils.SELECTED))(\n        this.id, null, this.workspace.id);\n    event.workspaceId = this.workspace.id;\n    eventUtils.fire(event);\n    common.setSelected(null);\n    this.removeSelect();\n  }\n\n  /**\n   * Returns a list of mutator, comment, and warning icons.\n   *\n   * @returns List of icons.\n   */\n  getIcons(): Icon[] {\n    const icons = [];\n    if (this.mutator) {\n      icons.push(this.mutator);\n    }\n    if (this.commentIcon_) {\n      icons.push(this.commentIcon_);\n    }\n    if (this.warning) {\n      icons.push(this.warning);\n    }\n    return icons;\n  }\n\n  /**\n   * Sets the parent of this block to be a new block or null.\n   *\n   * @param newParent New parent block.\n   * @internal\n   */\n  override setParent(newParent: this|null) {\n    const oldParent = this.parentBlock_;\n    if (newParent === oldParent) {\n      return;\n    }\n\n    dom.startTextWidthCache();\n    // AnyDuringMigration because:  Argument of type 'Block | null' is not\n    // assignable to parameter of type 'Block'.\n    super.setParent(newParent as AnyDuringMigration);\n    dom.stopTextWidthCache();\n\n    const svgRoot = this.getSvgRoot();\n\n    // Bail early if workspace is clearing, or we aren't rendered.\n    // We won't need to reattach ourselves anywhere.\n    if (this.workspace.isClearing || !svgRoot) {\n      return;\n    }\n\n    const oldXY = this.getRelativeToSurfaceXY();\n    if (newParent) {\n      (newParent as BlockSvg).getSvgRoot().appendChild(svgRoot);\n      const newXY = this.getRelativeToSurfaceXY();\n      // Move the connections to match the child's new position.\n      this.moveConnections(newXY.x - oldXY.x, newXY.y - oldXY.y);\n    } else if (oldParent) {\n      // If we are losing a parent, we want to move our DOM element to the\n      // root of the workspace.\n      this.workspace.getCanvas().appendChild(svgRoot);\n      this.translate(oldXY.x, oldXY.y);\n    }\n\n    this.applyColour();\n  }\n\n  /**\n   * Return the coordinates of the top-left corner of this block relative to the\n   * drawing surface's origin (0,0), in workspace units.\n   * If the block is on the workspace, (0, 0) is the origin of the workspace\n   * coordinate system.\n   * This does not change with workspace scale.\n   *\n   * @returns Object with .x and .y properties in workspace coordinates.\n   */\n  override getRelativeToSurfaceXY(): Coordinate {\n    let x = 0;\n    let y = 0;\n\n    const dragSurfaceGroup = this.useDragSurface_ ?\n        this.workspace.getBlockDragSurface()!.getGroup() :\n        null;\n\n    let element: SVGElement = this.getSvgRoot();\n    if (element) {\n      do {\n        // Loop through this block and every parent.\n        const xy = svgMath.getRelativeXY(element);\n        x += xy.x;\n        y += xy.y;\n        // If this element is the current element on the drag surface, include\n        // the translation of the drag surface itself.\n        if (this.useDragSurface_ &&\n            this.workspace.getBlockDragSurface()!.getCurrentBlock() ===\n                element) {\n          const surfaceTranslation =\n              this.workspace.getBlockDragSurface()!.getSurfaceTranslation();\n          x += surfaceTranslation.x;\n          y += surfaceTranslation.y;\n        }\n        element = element.parentNode as SVGElement;\n      } while (element && element !== this.workspace.getCanvas() &&\n               element !== dragSurfaceGroup);\n    }\n    return new Coordinate(x, y);\n  }\n\n  /**\n   * Move a block by a relative offset.\n   *\n   * @param dx Horizontal offset in workspace units.\n   * @param dy Vertical offset in workspace units.\n   */\n  override moveBy(dx: number, dy: number) {\n    if (this.parentBlock_) {\n      throw Error('Block has parent.');\n    }\n    const eventsEnabled = eventUtils.isEnabled();\n    let event: BlockMove|null = null;\n    if (eventsEnabled) {\n      event = new (eventUtils.get(eventUtils.BLOCK_MOVE))!(this) as BlockMove;\n    }\n    const xy = this.getRelativeToSurfaceXY();\n    this.translate(xy.x + dx, xy.y + dy);\n    this.moveConnections(dx, dy);\n    if (eventsEnabled && event) {\n      event!.recordNew();\n      eventUtils.fire(event);\n    }\n    this.workspace.resizeContents();\n  }\n\n  /**\n   * Transforms a block by setting the translation on the transform attribute\n   * of the block's SVG.\n   *\n   * @param x The x coordinate of the translation in workspace units.\n   * @param y The y coordinate of the translation in workspace units.\n   */\n  translate(x: number, y: number) {\n    this.getSvgRoot().setAttribute(\n        'transform', 'translate(' + x + ',' + y + ')');\n  }\n\n  /**\n   * Move this block to its workspace's drag surface, accounting for\n   * positioning. Generally should be called at the same time as\n   * setDragging_(true). Does nothing if useDragSurface_ is false.\n   *\n   * @internal\n   */\n  moveToDragSurface() {\n    if (!this.useDragSurface_) {\n      return;\n    }\n    // The translation for drag surface blocks,\n    // is equal to the current relative-to-surface position,\n    // to keep the position in sync as it move on/off the surface.\n    // This is in workspace coordinates.\n    const xy = this.getRelativeToSurfaceXY();\n    this.clearTransformAttributes_();\n    this.workspace.getBlockDragSurface()!.translateSurface(xy.x, xy.y);\n    // Execute the move on the top-level SVG component\n    const svg = this.getSvgRoot();\n    if (svg) {\n      this.workspace.getBlockDragSurface()!.setBlocksAndShow(svg);\n    }\n  }\n\n  /**\n   * Move a block to a position.\n   *\n   * @param xy The position to move to in workspace units.\n   */\n  moveTo(xy: Coordinate) {\n    const curXY = this.getRelativeToSurfaceXY();\n    this.moveBy(xy.x - curXY.x, xy.y - curXY.y);\n  }\n\n  /**\n   * Move this block back to the workspace block canvas.\n   * Generally should be called at the same time as setDragging_(false).\n   * Does nothing if useDragSurface_ is false.\n   *\n   * @param newXY The position the block should take on on the workspace canvas,\n   *     in workspace coordinates.\n   * @internal\n   */\n  moveOffDragSurface(newXY: Coordinate) {\n    if (!this.useDragSurface_) {\n      return;\n    }\n    // Translate to current position, turning off 3d.\n    this.translate(newXY.x, newXY.y);\n    this.workspace.getBlockDragSurface()!.clearAndHide(\n        this.workspace.getCanvas());\n  }\n\n  /**\n   * Move this block during a drag, taking into account whether we are using a\n   * drag surface to translate blocks.\n   * This block must be a top-level block.\n   *\n   * @param newLoc The location to translate to, in workspace coordinates.\n   * @internal\n   */\n  moveDuringDrag(newLoc: Coordinate) {\n    if (this.useDragSurface_) {\n      this.workspace.getBlockDragSurface()!.translateSurface(\n          newLoc.x, newLoc.y);\n    } else {\n      (this.svgGroup_ as AnyDuringMigration).translate_ =\n          'translate(' + newLoc.x + ',' + newLoc.y + ')';\n      (this.svgGroup_ as AnyDuringMigration)\n          .setAttribute(\n              'transform',\n              (this.svgGroup_ as AnyDuringMigration).translate_ +\n                  (this.svgGroup_ as AnyDuringMigration).skew_);\n    }\n  }\n\n  /**\n   * Clear the block of transform=\"...\" attributes.\n   * Used when the block is switching from 3d to 2d transform or vice versa.\n   */\n  private clearTransformAttributes_() {\n    this.getSvgRoot().removeAttribute('transform');\n  }\n\n  /** Snap this block to the nearest grid point. */\n  snapToGrid() {\n    if (this.disposed) {\n      return;  // Deleted block.\n    }\n    if (this.workspace.isDragging()) {\n      return;  // Don't bump blocks during a drag.;\n    }\n\n    if (this.getParent()) {\n      return;  // Only snap top-level blocks.\n    }\n    if (this.isInFlyout) {\n      return;  // Don't move blocks around in a flyout.\n    }\n    const grid = this.workspace.getGrid();\n    if (!grid || !grid.shouldSnap()) {\n      return;  // Config says no snapping.\n    }\n    const spacing = grid.getSpacing();\n    const half = spacing / 2;\n    const xy = this.getRelativeToSurfaceXY();\n    const dx =\n        Math.round(Math.round((xy.x - half) / spacing) * spacing + half - xy.x);\n    const dy =\n        Math.round(Math.round((xy.y - half) / spacing) * spacing + half - xy.y);\n    if (dx || dy) {\n      this.moveBy(dx, dy);\n    }\n  }\n\n  /**\n   * Returns the coordinates of a bounding box describing the dimensions of this\n   * block and any blocks stacked below it.\n   * Coordinate system: workspace coordinates.\n   *\n   * @returns Object with coordinates of the bounding box.\n   */\n  getBoundingRectangle(): Rect {\n    const blockXY = this.getRelativeToSurfaceXY();\n    const blockBounds = this.getHeightWidth();\n    let left;\n    let right;\n    if (this.RTL) {\n      left = blockXY.x - blockBounds.width;\n      right = blockXY.x;\n    } else {\n      left = blockXY.x;\n      right = blockXY.x + blockBounds.width;\n    }\n    return new Rect(blockXY.y, blockXY.y + blockBounds.height, left, right);\n  }\n\n  /**\n   * Notify every input on this block to mark its fields as dirty.\n   * A dirty field is a field that needs to be re-rendered.\n   */\n  markDirty() {\n    this.pathObject.constants = this.workspace.getRenderer().getConstants();\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      input.markDirty();\n    }\n  }\n\n  /**\n   * Set whether the block is collapsed or not.\n   *\n   * @param collapsed True if collapsed.\n   */\n  override setCollapsed(collapsed: boolean) {\n    if (this.collapsed_ === collapsed) {\n      return;\n    }\n    super.setCollapsed(collapsed);\n    if (!collapsed) {\n      this.updateCollapsed_();\n    } else if (this.rendered) {\n      this.render();\n      // Don't bump neighbours. Users like to store collapsed functions together\n      // and bumping makes them go out of alignment.\n    }\n  }\n\n  /**\n   * Makes sure that when the block is collapsed, it is rendered correctly\n   * for that state.\n   */\n  private updateCollapsed_() {\n    const collapsed = this.isCollapsed();\n    const collapsedInputName = constants.COLLAPSED_INPUT_NAME;\n    const collapsedFieldName = constants.COLLAPSED_FIELD_NAME;\n\n    for (let i = 0, input; input = this.inputList[i]; i++) {\n      if (input.name !== collapsedInputName) {\n        input.setVisible(!collapsed);\n      }\n    }\n\n    if (!collapsed) {\n      this.updateDisabled();\n      this.removeInput(collapsedInputName);\n      return;\n    }\n\n    const icons = this.getIcons();\n    for (let i = 0, icon; icon = icons[i]; i++) {\n      icon.setVisible(false);\n    }\n\n    const text = this.toString(internalConstants.COLLAPSE_CHARS);\n    const field = this.getField(collapsedFieldName);\n    if (field) {\n      field.setValue(text);\n      return;\n    }\n    const input = this.getInput(collapsedInputName) ||\n        this.appendDummyInput(collapsedInputName);\n    // AnyDuringMigration because:  Argument of type 'FieldLabel' is not\n    // assignable to parameter of type 'string | Field'.\n    input.appendField(\n        new FieldLabel(text) as AnyDuringMigration, collapsedFieldName);\n  }\n\n  /**\n   * Open the next (or previous) FieldTextInput.\n   *\n   * @param start Current field.\n   * @param forward If true go forward, otherwise backward.\n   */\n  tab(start: Field, forward: boolean) {\n    const tabCursor = new TabNavigateCursor();\n    tabCursor.setCurNode(ASTNode.createFieldNode(start)!);\n    const currentNode = tabCursor.getCurNode();\n\n    if (forward) {\n      tabCursor.next();\n    } else {\n      tabCursor.prev();\n    }\n\n    const nextNode = tabCursor.getCurNode();\n    if (nextNode && nextNode !== currentNode) {\n      const nextField = nextNode.getLocation() as Field;\n      nextField.showEditor();\n\n      // Also move the cursor if we're in keyboard nav mode.\n      if (this.workspace.keyboardAccessibilityMode) {\n        this.workspace.getCursor()!.setCurNode(nextNode);\n      }\n    }\n  }\n\n  /**\n   * Handle a mouse-down on an SVG block.\n   *\n   * @param e Mouse down event or touch start event.\n   */\n  private onMouseDown_(e: Event) {\n    const gesture = this.workspace.getGesture(e);\n    if (gesture) {\n      gesture.handleBlockStart(e, this);\n    }\n  }\n\n  /**\n   * Load the block's help page in a new window.\n   *\n   * @internal\n   */\n  showHelp() {\n    const url =\n        typeof this.helpUrl === 'function' ? this.helpUrl() : this.helpUrl;\n    if (url) {\n      window.open(url);\n    }\n  }\n\n  /**\n   * Generate the context menu for this block.\n   *\n   * @returns Context menu options or null if no menu.\n   */\n  protected generateContextMenu():\n      Array<ContextMenuOption|LegacyContextMenuOption>|null {\n    if (this.workspace.options.readOnly || !this.contextMenu) {\n      return null;\n    }\n    // AnyDuringMigration because:  Argument of type '{ block: this; }' is not\n    // assignable to parameter of type 'Scope'.\n    const menuOptions = ContextMenuRegistry.registry.getContextMenuOptions(\n        ContextMenuRegistry.ScopeType.BLOCK,\n        {block: this} as AnyDuringMigration);\n\n    // Allow the block to add or modify menuOptions.\n    if (this.customContextMenu) {\n      this.customContextMenu(menuOptions);\n    }\n\n    return menuOptions;\n  }\n\n  /**\n   * Show the context menu for this block.\n   *\n   * @param e Mouse event.\n   * @internal\n   */\n  showContextMenu(e: Event) {\n    const menuOptions = this.generateContextMenu();\n\n    if (menuOptions && menuOptions.length) {\n      ContextMenu.show(e, menuOptions, this.RTL);\n      // AnyDuringMigration because:  Argument of type 'this' is not assignable\n      // to parameter of type 'Block | null'.\n      ContextMenu.setCurrentBlock(this as AnyDuringMigration);\n    }\n  }\n\n  /**\n   * Move the connections for this block and all blocks attached under it.\n   * Also update any attached bubbles.\n   *\n   * @param dx Horizontal offset from current location, in workspace units.\n   * @param dy Vertical offset from current location, in workspace units.\n   * @internal\n   */\n  moveConnections(dx: number, dy: number) {\n    if (!this.rendered) {\n      // Rendering is required to lay out the blocks.\n      // This is probably an invisible block attached to a collapsed block.\n      return;\n    }\n    const myConnections = this.getConnections_(false);\n    for (let i = 0; i < myConnections.length; i++) {\n      myConnections[i].moveBy(dx, dy);\n    }\n    const icons = this.getIcons();\n    for (let i = 0; i < icons.length; i++) {\n      icons[i].computeIconLocation();\n    }\n\n    // Recurse through all blocks attached under this one.\n    for (let i = 0; i < this.childBlocks_.length; i++) {\n      (this.childBlocks_[i] as BlockSvg).moveConnections(dx, dy);\n    }\n  }\n\n  /**\n   * Recursively adds or removes the dragging class to this node and its\n   * children.\n   *\n   * @param adding True if adding, false if removing.\n   * @internal\n   */\n  setDragging(adding: boolean) {\n    if (adding) {\n      const group = this.getSvgRoot();\n      (group as AnyDuringMigration).translate_ = '';\n      (group as AnyDuringMigration).skew_ = '';\n      common.draggingConnections.push(...this.getConnections_(true));\n      dom.addClass(this.svgGroup_ as Element, 'blocklyDragging');\n    } else {\n      common.draggingConnections.length = 0;\n      dom.removeClass(this.svgGroup_ as Element, 'blocklyDragging');\n    }\n    // Recurse through all blocks attached under this one.\n    for (let i = 0; i < this.childBlocks_.length; i++) {\n      (this.childBlocks_[i] as BlockSvg).setDragging(adding);\n    }\n  }\n\n  /**\n   * Set whether this block is movable or not.\n   *\n   * @param movable True if movable.\n   */\n  override setMovable(movable: boolean) {\n    super.setMovable(movable);\n    this.pathObject.updateMovable(movable);\n  }\n\n  /**\n   * Set whether this block is editable or not.\n   *\n   * @param editable True if editable.\n   */\n  override setEditable(editable: boolean) {\n    super.setEditable(editable);\n    const icons = this.getIcons();\n    for (let i = 0; i < icons.length; i++) {\n      icons[i].updateEditable();\n    }\n  }\n\n  /**\n   * Sets whether this block is a shadow block or not.\n   *\n   * @param shadow True if a shadow.\n   * @internal\n   */\n  override setShadow(shadow: boolean) {\n    super.setShadow(shadow);\n    this.applyColour();\n  }\n\n  /**\n   * Set whether this block is an insertion marker block or not.\n   * Once set this cannot be unset.\n   *\n   * @param insertionMarker True if an insertion marker.\n   * @internal\n   */\n  override setInsertionMarker(insertionMarker: boolean) {\n    if (this.isInsertionMarker_ === insertionMarker) {\n      return;  // No change.\n    }\n    this.isInsertionMarker_ = insertionMarker;\n    if (this.isInsertionMarker_) {\n      this.setColour(\n          this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR);\n      this.pathObject.updateInsertionMarker(true);\n    }\n  }\n\n  /**\n   * Return the root node of the SVG or null if none exists.\n   *\n   * @returns The root SVG node (probably a group).\n   */\n  getSvgRoot(): SVGGElement {\n    return this.svgGroup_;\n  }\n\n  /**\n   * Dispose of this block.\n   *\n   * @param healStack If true, then try to heal any gap by connecting the next\n   *     statement with the previous statement.  Otherwise, dispose of all\n   *     children of this block.\n   * @param animate If true, show a disposal animation and sound.\n   * @suppress {checkTypes}\n   */\n  override dispose(healStack?: boolean, animate?: boolean) {\n    if (this.disposed) {\n      // The block has already been deleted.\n      return;\n    }\n    Tooltip.dispose();\n    Tooltip.unbindMouseEvents(this.pathObject.svgPath);\n    dom.startTextWidthCache();\n    // Save the block's workspace temporarily so we can resize the\n    // contents once the block is disposed.\n    const blockWorkspace = this.workspace;\n    // If this block is being dragged, unlink the mouse events.\n    if (common.getSelected() === this) {\n      this.unselect();\n      this.workspace.cancelCurrentGesture();\n    }\n    // If this block has a context menu open, close it.\n    if (ContextMenu.getCurrentBlock() === this) {\n      ContextMenu.hide();\n    }\n\n    if (animate && this.rendered) {\n      this.unplug(healStack);\n      blockAnimations.disposeUiEffect(this);\n    }\n    // Stop rerendering.\n    this.rendered = false;\n\n    // Clear pending warnings.\n    for (const n of this.warningTextDb.values()) {\n      clearTimeout(n);\n    }\n    this.warningTextDb.clear();\n\n    const icons = this.getIcons();\n    for (let i = 0; i < icons.length; i++) {\n      icons[i].dispose();\n    }\n\n    // Just deleting this block from the DOM would result in a memory leak as\n    // well as corruption of the connection database.  Therefore we must\n    // methodically step through the blocks and carefully disassemble them.\n    if (common.getSelected() === this) {\n      common.setSelected(null);\n    }\n\n    super.dispose(!!healStack);\n\n    dom.removeNode(this.svgGroup_);\n    blockWorkspace.resizeContents();\n    // Sever JavaScript to DOM connections.\n    // AnyDuringMigration because:  Type 'null' is not assignable to type\n    // 'SVGGElement'.\n    this.svgGroup_ = null as AnyDuringMigration;\n    dom.stopTextWidthCache();\n  }\n\n  /**\n   * Delete a block and hide chaff when doing so. The block will not be deleted\n   * if it's in a flyout. This is called from the context menu and keyboard\n   * shortcuts as the full delete action. If you are disposing of a block from\n   * the workspace and don't need to perform flyout checks, handle event\n   * grouping, or hide chaff, then use `block.dispose()` directly.\n   */\n  checkAndDelete() {\n    if (this.workspace.isFlyout) {\n      return;\n    }\n    eventUtils.setGroup(true);\n    this.workspace.hideChaff();\n    if (this.outputConnection) {\n      // Do not attempt to heal rows\n      // (https://github.com/google/blockly/issues/4832)\n      this.dispose(false, true);\n    } else {\n      this.dispose(/* heal */\n                   true, true);\n    }\n    eventUtils.setGroup(false);\n  }\n\n  /**\n   * Encode a block for copying.\n   *\n   * @returns Copy metadata, or null if the block is an insertion marker.\n   * @internal\n   */\n  toCopyData(): CopyData|null {\n    if (this.isInsertionMarker_) {\n      return null;\n    }\n    // AnyDuringMigration because:  Argument of type 'this' is not assignable to\n    // parameter of type 'Block'. AnyDuringMigration because:  Argument of type\n    // 'this' is not assignable to parameter of type 'Block'.\n    return {\n      saveInfo: blocks.save(\n                    this as AnyDuringMigration,\n                    {addCoordinates: true, addNextBlocks: false}) as\n          blocks.State,\n      source: this.workspace,\n      typeCounts: common.getBlockTypeCounts(this as AnyDuringMigration, true),\n    };\n  }\n\n  /**\n   * Updates the colour of the block to match the block's state.\n   *\n   * @internal\n   */\n  applyColour() {\n    this.pathObject.applyColour(this);\n\n    const icons = this.getIcons();\n    for (let i = 0; i < icons.length; i++) {\n      icons[i].applyColour();\n    }\n\n    for (let x = 0, input; input = this.inputList[x]; x++) {\n      for (let y = 0, field; field = input.fieldRow[y]; y++) {\n        field.applyColour();\n      }\n    }\n  }\n\n  /**\n   * Updates the color of the block (and children) to match the current disabled\n   * state.\n   *\n   * @internal\n   */\n  updateDisabled() {\n    const children = (this.getChildren(false));\n    this.applyColour();\n    if (this.isCollapsed()) {\n      return;\n    }\n    for (let i = 0, child; child = children[i]; i++) {\n      if (child.rendered) {\n        child.updateDisabled();\n      }\n    }\n  }\n\n  /**\n   * Get the comment icon attached to this block, or null if the block has no\n   * comment.\n   *\n   * @returns The comment icon attached to this block, or null.\n   */\n  getCommentIcon(): Comment|null {\n    return this.commentIcon_;\n  }\n\n  /**\n   * Set this block's comment text.\n   *\n   * @param text The text, or null to delete.\n   */\n  override setCommentText(text: string|null) {\n    // AnyDuringMigration because:  Property 'get' does not exist on type\n    // '(name: string) => void'.\n    if (this.commentModel.text === text) {\n      return;\n    }\n    super.setCommentText(text);\n\n    const shouldHaveComment = text !== null;\n    if (!!this.commentIcon_ === shouldHaveComment) {\n      // If the comment's state of existence is correct, but the text is new\n      // that means we're just updating a comment.\n      this.commentIcon_!.updateText();\n      return;\n    }\n    if (shouldHaveComment) {\n      this.commentIcon_ = new Comment(this);\n      this.comment = this.commentIcon_;  // For backwards compatibility.\n    } else {\n      this.commentIcon_!.dispose();\n      this.commentIcon_ = null;\n      this.comment = null;  // For backwards compatibility.\n    }\n    if (this.rendered) {\n      this.render();\n      // Adding or removing a comment icon will cause the block to change shape.\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Set this block's warning text.\n   *\n   * @param text The text, or null to delete.\n   * @param opt_id An optional ID for the warning text to be able to maintain\n   *     multiple warnings.\n   */\n  override setWarningText(text: string|null, opt_id?: string) {\n    const id = opt_id || '';\n    if (!id) {\n      // Kill all previous pending processes, this edit supersedes them all.\n      for (const timeout of this.warningTextDb.values()) {\n        clearTimeout(timeout);\n      }\n      this.warningTextDb.clear();\n    } else if (this.warningTextDb.has(id)) {\n      // Only queue up the latest change.  Kill any earlier pending process.\n      clearTimeout(this.warningTextDb.get(id)!);\n      this.warningTextDb.delete(id);\n    }\n    if (this.workspace.isDragging()) {\n      // Don't change the warning text during a drag.\n      // Wait until the drag finishes.\n      this.warningTextDb.set(\n          id, setTimeout(() => {\n            if (!this.disposed) {  // Check block wasn't deleted.\n              this.warningTextDb.delete(id);\n              this.setWarningText(text, id);\n            }\n          }, 100));\n      return;\n    }\n    if (this.isInFlyout) {\n      text = null;\n    }\n\n    let changedState = false;\n    if (typeof text === 'string') {\n      // Bubble up to add a warning on top-most collapsed block.\n      let parent = this.getSurroundParent();\n      let collapsedParent = null;\n      while (parent) {\n        if (parent.isCollapsed()) {\n          collapsedParent = parent;\n        }\n        parent = parent.getSurroundParent();\n      }\n      if (collapsedParent) {\n        collapsedParent.setWarningText(\n            Msg['COLLAPSED_WARNINGS_WARNING'], BlockSvg.COLLAPSED_WARNING_ID);\n      }\n\n      if (!this.warning) {\n        this.warning = new Warning(this);\n        changedState = true;\n      }\n      this.warning!.setText((text), id);\n    } else {\n      // Dispose all warnings if no ID is given.\n      if (this.warning && !id) {\n        this.warning.dispose();\n        changedState = true;\n      } else if (this.warning) {\n        const oldText = this.warning.getText();\n        this.warning.setText('', id);\n        const newText = this.warning.getText();\n        if (!newText) {\n          this.warning.dispose();\n        }\n        changedState = oldText !== newText;\n      }\n    }\n    if (changedState && this.rendered) {\n      this.render();\n      // Adding or removing a warning icon will cause the block to change shape.\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Give this block a mutator dialog.\n   *\n   * @param mutator A mutator dialog instance or null to remove.\n   */\n  override setMutator(mutator: Mutator|null) {\n    if (this.mutator && this.mutator !== mutator) {\n      this.mutator.dispose();\n    }\n    if (mutator) {\n      mutator.setBlock(this);\n      this.mutator = mutator;\n      mutator.createIcon();\n    }\n    if (this.rendered) {\n      this.render();\n      // Adding or removing a mutator icon will cause the block to change shape.\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Set whether the block is enabled or not.\n   *\n   * @param enabled True if enabled.\n   */\n  override setEnabled(enabled: boolean) {\n    if (this.isEnabled() !== enabled) {\n      super.setEnabled(enabled);\n      if (this.rendered && !this.getInheritedDisabled()) {\n        this.updateDisabled();\n      }\n    }\n  }\n\n  /**\n   * Set whether the block is highlighted or not.  Block highlighting is\n   * often used to visually mark blocks currently being executed.\n   *\n   * @param highlighted True if highlighted.\n   */\n  setHighlighted(highlighted: boolean) {\n    if (!this.rendered) {\n      return;\n    }\n    this.pathObject.updateHighlighted(highlighted);\n  }\n\n  /**\n   * Adds the visual \"select\" effect to the block, but does not actually select\n   * it or fire an event.\n   *\n   * @see BlockSvg#select\n   */\n  addSelect() {\n    this.pathObject.updateSelected(true);\n  }\n\n  /**\n   * Removes the visual \"select\" effect from the block, but does not actually\n   * unselect it or fire an event.\n   *\n   * @see BlockSvg#unselect\n   */\n  removeSelect() {\n    this.pathObject.updateSelected(false);\n  }\n\n  /**\n   * Update the cursor over this block by adding or removing a class.\n   *\n   * @param enable True if the delete cursor should be shown, false otherwise.\n   * @internal\n   */\n  setDeleteStyle(enable: boolean) {\n    this.pathObject.updateDraggingDelete(enable);\n  }\n\n  // Overrides of functions on Blockly.Block that take into account whether the\n\n  // block has been rendered.\n\n  /**\n   * Get the colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  override getColour(): string {\n    return this.style.colourPrimary;\n  }\n\n  /**\n   * Change the colour of a block.\n   *\n   * @param colour HSV hue value, or #RRGGBB string.\n   */\n  override setColour(colour: number|string) {\n    super.setColour(colour);\n    const styleObj =\n        this.workspace.getRenderer().getConstants().getBlockStyleForColour(\n            this.colour_);\n\n    this.pathObject.setStyle(styleObj.style);\n    this.style = styleObj.style;\n    this.styleName_ = styleObj.name;\n\n    this.applyColour();\n  }\n\n  /**\n   * Set the style and colour values of a block.\n   *\n   * @param blockStyleName Name of the block style.\n   * @throws {Error} if the block style does not exist.\n   */\n  override setStyle(blockStyleName: string) {\n    const blockStyle =\n        this.workspace.getRenderer().getConstants().getBlockStyle(\n            blockStyleName);\n    this.styleName_ = blockStyleName;\n\n    if (blockStyle) {\n      this.hat = blockStyle.hat;\n      this.pathObject.setStyle(blockStyle);\n      // Set colour to match Block.\n      this.colour_ = blockStyle.colourPrimary;\n      this.style = blockStyle;\n\n      this.applyColour();\n    } else {\n      throw Error('Invalid style name: ' + blockStyleName);\n    }\n  }\n\n  /**\n   * Move this block to the front of the visible workspace.\n   * <g> tags do not respect z-index so SVG renders them in the\n   * order that they are in the DOM.  By placing this block first within the\n   * block group's <g>, it will render on top of any other blocks.\n   *\n   * @internal\n   */\n  bringToFront() {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block = this;\n    do {\n      const root = block.getSvgRoot();\n      const parent = root.parentNode;\n      const childNodes = parent!.childNodes;\n      // Avoid moving the block if it's already at the bottom.\n      if (childNodes[childNodes.length - 1] !== root) {\n        parent!.appendChild(root);\n      }\n      // AnyDuringMigration because:  Type 'BlockSvg | null' is not assignable\n      // to type 'this'.\n      block = block.getParent() as AnyDuringMigration;\n    } while (block);\n  }\n\n  /**\n   * Set whether this block can chain onto the bottom of another block.\n   *\n   * @param newBoolean True if there can be a previous statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  override setPreviousStatement(\n      newBoolean: boolean, opt_check?: string|string[]|null) {\n    super.setPreviousStatement(newBoolean, opt_check);\n\n    if (this.rendered) {\n      this.render();\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Set whether another block can chain onto the bottom of this block.\n   *\n   * @param newBoolean True if there can be a next statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  override setNextStatement(\n      newBoolean: boolean, opt_check?: string|string[]|null) {\n    super.setNextStatement(newBoolean, opt_check);\n\n    if (this.rendered) {\n      this.render();\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Set whether this block returns a value.\n   *\n   * @param newBoolean True if there is an output.\n   * @param opt_check Returned type or list of returned types.  Null or\n   *     undefined if any type could be returned (e.g. variable get).\n   */\n  override setOutput(newBoolean: boolean, opt_check?: string|string[]|null) {\n    super.setOutput(newBoolean, opt_check);\n\n    if (this.rendered) {\n      this.render();\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Set whether value inputs are arranged horizontally or vertically.\n   *\n   * @param newBoolean True if inputs are horizontal.\n   */\n  override setInputsInline(newBoolean: boolean) {\n    super.setInputsInline(newBoolean);\n\n    if (this.rendered) {\n      this.render();\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Remove an input from this block.\n   *\n   * @param name The name of the input.\n   * @param opt_quiet True to prevent error if input is not present.\n   * @returns True if operation succeeds, false if input is not present and\n   *     opt_quiet is true\n   * @throws {Error} if the input is not present and opt_quiet is not true.\n   */\n  override removeInput(name: string, opt_quiet?: boolean): boolean {\n    const removed = super.removeInput(name, opt_quiet);\n\n    if (this.rendered) {\n      this.render();\n      // Removing an input will cause the block to change shape.\n      this.bumpNeighbours();\n    }\n\n    return removed;\n  }\n\n  /**\n   * Move a numbered input to a different location on this block.\n   *\n   * @param inputIndex Index of the input to move.\n   * @param refIndex Index of input that should be after the moved input.\n   */\n  override moveNumberedInputBefore(inputIndex: number, refIndex: number) {\n    super.moveNumberedInputBefore(inputIndex, refIndex);\n\n    if (this.rendered) {\n      this.render();\n      // Moving an input will cause the block to change shape.\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Add a value input, statement input or local variable to this block.\n   *\n   * @param type One of Blockly.inputTypes.\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  protected override appendInput_(type: number, name: string): Input {\n    const input = super.appendInput_(type, name);\n\n    if (this.rendered) {\n      this.render();\n      // Adding an input will cause the block to change shape.\n      this.bumpNeighbours();\n    }\n    return input;\n  }\n\n  /**\n   * Sets whether this block's connections are tracked in the database or not.\n   *\n   * Used by the deserializer to be more efficient. Setting a connection's\n   * tracked_ value to false keeps it from adding itself to the db when it\n   * gets its first moveTo call, saving expensive ops for later.\n   *\n   * @param track If true, start tracking. If false, stop tracking.\n   * @internal\n   */\n  setConnectionTracking(track: boolean) {\n    if (this.previousConnection) {\n      (this.previousConnection).setTracking(track);\n    }\n    if (this.outputConnection) {\n      (this.outputConnection).setTracking(track);\n    }\n    if (this.nextConnection) {\n      (this.nextConnection).setTracking(track);\n      const child = (this.nextConnection).targetBlock();\n      if (child) {\n        child.setConnectionTracking(track);\n      }\n    }\n\n    if (this.collapsed_) {\n      // When track is true, we don't want to start tracking collapsed\n      // connections. When track is false, we're already not tracking\n      // collapsed connections, so no need to update.\n      return;\n    }\n\n    for (let i = 0; i < this.inputList.length; i++) {\n      const conn = this.inputList[i].connection as RenderedConnection;\n      if (conn) {\n        conn.setTracking(track);\n\n        // Pass tracking on down the chain.\n        const block = conn.targetBlock();\n        if (block) {\n          block.setConnectionTracking(track);\n        }\n      }\n    }\n  }\n\n  /**\n   * Returns connections originating from this block.\n   *\n   * @param all If true, return all connections even hidden ones.\n   *     Otherwise, for a non-rendered block return an empty list, and for a\n   * collapsed block don't return inputs connections.\n   * @returns Array of connections.\n   * @internal\n   */\n  override getConnections_(all: boolean): RenderedConnection[] {\n    const myConnections = [];\n    if (all || this.rendered) {\n      if (this.outputConnection) {\n        myConnections.push(this.outputConnection);\n      }\n      if (this.previousConnection) {\n        myConnections.push(this.previousConnection);\n      }\n      if (this.nextConnection) {\n        myConnections.push(this.nextConnection);\n      }\n      if (all || !this.collapsed_) {\n        for (let i = 0, input; input = this.inputList[i]; i++) {\n          if (input.connection) {\n            myConnections.push(input.connection as RenderedConnection);\n          }\n        }\n      }\n    }\n    return myConnections;\n  }\n\n  /**\n   * Walks down a stack of blocks and finds the last next connection on the\n   * stack.\n   *\n   * @param ignoreShadows If true,the last connection on a non-shadow block will\n   *     be returned. If false, this will follow shadows to find the last\n   *     connection.\n   * @returns The last next connection on the stack, or null.\n   * @internal\n   */\n  override lastConnectionInStack(ignoreShadows: boolean): RenderedConnection\n      |null {\n    return super.lastConnectionInStack(ignoreShadows) as RenderedConnection;\n  }\n\n  /**\n   * Find the connection on this block that corresponds to the given connection\n   * on the other block.\n   * Used to match connections between a block and its insertion marker.\n   *\n   * @param otherBlock The other block to match against.\n   * @param conn The other connection to match.\n   * @returns The matching connection on this block, or null.\n   * @internal\n   */\n  override getMatchingConnection(otherBlock: Block, conn: Connection):\n      RenderedConnection|null {\n    return super.getMatchingConnection(otherBlock, conn) as RenderedConnection;\n  }\n\n  /**\n   * Create a connection of the specified type.\n   *\n   * @param type The type of the connection to create.\n   * @returns A new connection of the specified type.\n   */\n  protected override makeConnection_(type: number): RenderedConnection {\n    return new RenderedConnection(this, type);\n  }\n\n  /**\n   * Return the next statement block directly connected to this block.\n   *\n   * @returns The next statement block or null.\n   */\n  override getNextBlock(): BlockSvg|null {\n    return super.getNextBlock() as BlockSvg;\n  }\n\n  /**\n   * Returns the block connected to the previous connection.\n   *\n   * @returns The previous statement block or null.\n   */\n  override getPreviousBlock(): BlockSvg|null {\n    return super.getPreviousBlock() as BlockSvg;\n  }\n\n  /**\n   * Bump unconnected blocks out of alignment.  Two blocks which aren't actually\n   * connected should not coincidentally line up on screen.\n   */\n  override bumpNeighbours() {\n    if (this.disposed) {\n      return;  // Deleted block.\n    }\n    if (this.workspace.isDragging()) {\n      return;  // Don't bump blocks during a drag.\n    }\n    const rootBlock = this.getRootBlock();\n    if (rootBlock.isInFlyout) {\n      return;\n    }\n    // Don't move blocks around in a flyout.\n    // Loop through every connection on this block.\n    const myConnections = this.getConnections_(false);\n    for (let i = 0, connection; connection = myConnections[i]; i++) {\n      const renderedConn = (connection);\n      // Spider down from this block bumping all sub-blocks.\n      if (renderedConn.isConnected() && renderedConn.isSuperior()) {\n        renderedConn.targetBlock()!.bumpNeighbours();\n      }\n\n      const neighbours = connection.neighbours(config.snapRadius);\n      for (let j = 0, otherConnection; otherConnection = neighbours[j]; j++) {\n        const renderedOther = otherConnection as RenderedConnection;\n        // If both connections are connected, that's probably fine.  But if\n        // either one of them is unconnected, then there could be confusion.\n        if (!renderedConn.isConnected() || !renderedOther.isConnected()) {\n          // Only bump blocks if they are from different tree structures.\n          if (renderedOther.getSourceBlock().getRootBlock() !== rootBlock) {\n            // Always bump the inferior block.\n            if (renderedConn.isSuperior()) {\n              renderedOther.bumpAwayFrom(renderedConn);\n            } else {\n              renderedConn.bumpAwayFrom(renderedOther);\n            }\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Schedule snapping to grid and bumping neighbours to occur after a brief\n   * delay.\n   *\n   * @internal\n   */\n  scheduleSnapAndBump() {\n    // Ensure that any snap and bump are part of this move's event group.\n    const group = eventUtils.getGroup();\n\n    setTimeout(() => {\n      eventUtils.setGroup(group);\n      this.snapToGrid();\n      eventUtils.setGroup(false);\n    }, config.bumpDelay / 2);\n\n    setTimeout(() => {\n      eventUtils.setGroup(group);\n      this.bumpNeighbours();\n      eventUtils.setGroup(false);\n    }, config.bumpDelay);\n  }\n\n  /**\n   * Position a block so that it doesn't move the target block when connected.\n   * The block to position is usually either the first block in a dragged stack\n   * or an insertion marker.\n   *\n   * @param sourceConnection The connection on the moving block's stack.\n   * @param targetConnection The connection that should stay stationary as this\n   *     block is positioned.\n   * @internal\n   */\n  positionNearConnection(\n      sourceConnection: RenderedConnection,\n      targetConnection: RenderedConnection) {\n    // We only need to position the new block if it's before the existing one,\n    // otherwise its position is set by the previous block.\n    if (sourceConnection.type === ConnectionType.NEXT_STATEMENT ||\n        sourceConnection.type === ConnectionType.INPUT_VALUE) {\n      const dx = targetConnection.x - sourceConnection.x;\n      const dy = targetConnection.y - sourceConnection.y;\n\n      this.moveBy(dx, dy);\n    }\n  }\n\n  /**\n   * @returns The first statement connection or null.\n   * @internal\n   */\n  override getFirstStatementConnection(): RenderedConnection|null {\n    return super.getFirstStatementConnection() as RenderedConnection | null;\n  }\n\n  /**\n   * Find all the blocks that are directly nested inside this one.\n   * Includes value and statement inputs, as well as any following statement.\n   * Excludes any connection on an output tab or any preceding statement.\n   * Blocks are optionally sorted by position; top to bottom.\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  override getChildren(ordered: boolean): BlockSvg[] {\n    return super.getChildren(ordered) as BlockSvg[];\n  }\n\n  /**\n   * Lays out and reflows a block based on its contents and settings.\n   *\n   * @param opt_bubble If false, just render this block.\n   *   If true, also render block's parent, grandparent, etc.  Defaults to true.\n   */\n  render(opt_bubble?: boolean) {\n    if (this.renderIsInProgress_) {\n      return;  // Don't allow recursive renders.\n    }\n    this.renderIsInProgress_ = true;\n    try {\n      this.rendered = true;\n      dom.startTextWidthCache();\n\n      if (this.isCollapsed()) {\n        this.updateCollapsed_();\n      }\n      this.workspace.getRenderer().render(this);\n      this.updateConnectionLocations_();\n\n      if (opt_bubble !== false) {\n        const parentBlock = this.getParent();\n        if (parentBlock) {\n          parentBlock.render(true);\n        } else {\n          // Top-most block. Fire an event to allow scrollbars to resize.\n          this.workspace.resizeContents();\n        }\n      }\n\n      dom.stopTextWidthCache();\n      this.updateMarkers_();\n    } finally {\n      this.renderIsInProgress_ = false;\n    }\n  }\n\n  /** Redraw any attached marker or cursor svgs if needed. */\n  protected updateMarkers_() {\n    if (this.workspace.keyboardAccessibilityMode && this.pathObject.cursorSvg) {\n      this.workspace.getCursor()!.draw();\n    }\n    if (this.workspace.keyboardAccessibilityMode && this.pathObject.markerSvg) {\n      // TODO(#4592): Update all markers on the block.\n      this.workspace.getMarker(MarkerManager.LOCAL_MARKER)!.draw();\n    }\n  }\n\n  /**\n   * Update all of the connections on this block with the new locations\n   * calculated during rendering.  Also move all of the connected blocks based\n   * on the new connection locations.\n   */\n  private updateConnectionLocations_() {\n    const blockTL = this.getRelativeToSurfaceXY();\n    // Don't tighten previous or output connections because they are inferior\n    // connections.\n    if (this.previousConnection) {\n      this.previousConnection.moveToOffset(blockTL);\n    }\n    if (this.outputConnection) {\n      this.outputConnection.moveToOffset(blockTL);\n    }\n\n    for (let i = 0; i < this.inputList.length; i++) {\n      const conn = this.inputList[i].connection as RenderedConnection;\n      if (conn) {\n        conn.moveToOffset(blockTL);\n        if (conn.isConnected()) {\n          conn.tighten();\n        }\n      }\n    }\n\n    if (this.nextConnection) {\n      this.nextConnection.moveToOffset(blockTL);\n      if (this.nextConnection.isConnected()) {\n        this.nextConnection.tighten();\n      }\n    }\n  }\n\n  /**\n   * Add the cursor SVG to this block's SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the block SVG\n   *     group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    this.pathObject.setCursorSvg(cursorSvg);\n  }\n\n  /**\n   * Add the marker SVG to this block's SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the block SVG\n   *     group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    this.pathObject.setMarkerSvg(markerSvg);\n  }\n\n  /**\n   * Returns a bounding box describing the dimensions of this block\n   * and any blocks stacked below it.\n   *\n   * @returns Object with height and width properties in workspace units.\n   * @internal\n   */\n  getHeightWidth(): {height: number, width: number} {\n    let height = this.height;\n    let width = this.width;\n    // Recursively add size of subsequent blocks.\n    const nextBlock = this.getNextBlock();\n    if (nextBlock) {\n      const nextHeightWidth = nextBlock.getHeightWidth();\n      const tabHeight =\n          this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;\n      height += nextHeightWidth.height - tabHeight;\n      width = Math.max(width, nextHeightWidth.width);\n    }\n    return {height, width};\n  }\n\n  /**\n   * Visual effect to show that if the dragging block is dropped, this block\n   * will be replaced.  If a shadow block, it will disappear.  Otherwise it will\n   * bump.\n   *\n   * @param add True if highlighting should be added.\n   * @internal\n   */\n  fadeForReplacement(add: boolean) {\n    this.pathObject.updateReplacementFade(add);\n  }\n\n  /**\n   * Visual effect to show that if the dragging block is dropped it will connect\n   * to this input.\n   *\n   * @param conn The connection on the input to highlight.\n   * @param add True if highlighting should be added.\n   * @internal\n   */\n  highlightShapeForInput(conn: Connection, add: boolean) {\n    this.pathObject.updateShapeForInputHighlight(conn, add);\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The abstract class for a component with custom behaviour when a\n * block or bubble is dragged over or dropped on top of it.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.DragTarget');\n\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {IDraggable} from './interfaces/i_draggable.js';\nimport type {Rect} from './utils/rect.js';\n\n\n/**\n * Abstract class for a component with custom behaviour when a block or bubble\n * is dragged over or dropped on top of it.\n *\n * @alias Blockly.DragTarget\n */\nexport class DragTarget implements IDragTarget {\n  /**\n   * The unique id for this component that is used to register with the\n   * ComponentManager.\n   */\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  id!: string;\n\n  /**\n   * Constructor for DragTarget. It exists to add the id property and should not\n   * be called directly, only by a subclass.\n   */\n  constructor() {}\n\n  /**\n   * Handles when a cursor with a block or bubble enters this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDragEnter(_dragElement: IDraggable) {}\n  // no-op\n\n  /**\n   * Handles when a cursor with a block or bubble is dragged over this drag\n   * target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDragOver(_dragElement: IDraggable) {}\n  // no-op\n\n  /**\n   * Handles when a cursor with a block or bubble exits this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDragExit(_dragElement: IDraggable) {}\n  // no-op\n  /**\n   * Handles when a block or bubble is dropped on this component.\n   * Should not handle delete here.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDrop(_dragElement: IDraggable) {}\n  // no-op\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to the Blockly injection div.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  getClientRect(): Rect|null {\n    return null;\n  }\n\n  /**\n   * Returns whether the provided block or bubble should not be moved after\n   * being dropped on this component. If true, the element will return to where\n   * it was when the drag started.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   * @returns Whether the block or bubble provided should be returned to drag\n   *     start.\n   */\n  shouldPreventMove(_dragElement: IDraggable): boolean {\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The abstract class for a component that can delete a block or\n * bubble that is dropped on top of it.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.DeleteArea');\n\nimport {BlockSvg} from './block_svg.js';\nimport {DragTarget} from './drag_target.js';\nimport type {IDeleteArea} from './interfaces/i_delete_area.js';\nimport type {IDraggable} from './interfaces/i_draggable.js';\n\n\n/**\n * Abstract class for a component that can delete a block or bubble that is\n * dropped on top of it.\n *\n * @alias Blockly.DeleteArea\n */\nexport class DeleteArea extends DragTarget implements IDeleteArea {\n  /**\n   * Whether the last block or bubble dragged over this delete area would be\n   * deleted if dropped on this component.\n   * This property is not updated after the block or bubble is deleted.\n   */\n  protected wouldDelete_ = false;\n\n  /**\n   * The unique id for this component that is used to register with the\n   * ComponentManager.\n   */\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override id!: string;\n\n  /**\n   * Constructor for DeleteArea. Should not be called directly, only by a\n   * subclass.\n   */\n  constructor() {\n    super();\n  }\n\n  /**\n   * Returns whether the provided block or bubble would be deleted if dropped on\n   * this area.\n   * This method should check if the element is deletable and is always called\n   * before onDragEnter/onDragOver/onDragExit.\n   *\n   * @param element The block or bubble currently being dragged.\n   * @param couldConnect Whether the element could could connect to another.\n   * @returns Whether the element provided would be deleted if dropped on this\n   *     area.\n   */\n  wouldDelete(element: IDraggable, couldConnect: boolean): boolean {\n    if (element instanceof BlockSvg) {\n      const block = (element);\n      const couldDeleteBlock = !block.getParent() && block.isDeletable();\n      this.updateWouldDelete_(couldDeleteBlock && !couldConnect);\n    } else {\n      this.updateWouldDelete_(element.isDeletable());\n    }\n    return this.wouldDelete_;\n  }\n\n  /**\n   * Updates the internal wouldDelete_ state.\n   *\n   * @param wouldDelete The new value for the wouldDelete state.\n   */\n  protected updateWouldDelete_(wouldDelete: boolean) {\n    this.wouldDelete_ = wouldDelete;\n  }\n}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Contains the path to a single png tat holds the images for the trashcan\n * as well as the zoom controls.\n *\n * @alias Blockly.sprite.SPRITE\n */\nexport const SPRITE = {\n  width: 96,\n  height: 124,\n  url: 'sprites.png',\n};\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a trash can icon.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Trashcan');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_trashcan_open.js';\n\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as browserEvents from './browser_events.js';\nimport {ComponentManager} from './component_manager.js';\nimport {DeleteArea} from './delete_area.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BlockDelete} from './events/events_block_delete.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IAutoHideable} from './interfaces/i_autohideable.js';\nimport type {IDraggable} from './interfaces/i_draggable.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IPositionable} from './interfaces/i_positionable.js';\nimport type {UiMetrics} from './metrics_manager.js';\nimport {Options} from './options.js';\nimport * as uiPosition from './positionable_helpers.js';\nimport * as registry from './registry.js';\nimport type * as blocks from './serialization/blocks.js';\nimport {SPRITE} from './sprites.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\nimport {BlockInfo} from './utils/toolbox.js';\nimport * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Class for a trash can.\n *\n * @alias Blockly.Trashcan\n */\nexport class Trashcan extends DeleteArea implements IAutoHideable,\n                                                    IPositionable {\n  /**\n   * The unique id for this component that is used to register with the\n   * ComponentManager.\n   */\n  override id = 'trashcan';\n\n  /**\n   * A list of JSON (stored as strings) representing blocks in the trashcan.\n   */\n  private readonly contents_: string[] = [];\n\n  /**\n   * The trashcan flyout.\n   *\n   * @internal\n   */\n  flyout: IFlyout|null = null;\n\n  /** Current open/close state of the lid. */\n  isLidOpen = false;\n\n  /**\n   * The minimum openness of the lid. Used to indicate if the trashcan\n   * contains blocks.\n   */\n  private minOpenness_ = 0;\n\n  /** The SVG group containing the trash can. */\n  private svgGroup_: SVGElement|null = null;\n\n  /** The SVG image element of the trash can lid. */\n  private svgLid_: SVGElement|null = null;\n\n  /** Task ID of opening/closing animation. */\n  private lidTask_: ReturnType<typeof setTimeout>|null = null;\n\n  /** Current state of lid opening (0.0 = closed, 1.0 = open). */\n  private lidOpen_ = 0;\n\n  /** Left coordinate of the trash can. */\n  private left_ = 0;\n\n  /** Top coordinate of the trash can. */\n  private top_ = 0;\n\n  /** Whether this trash can has been initialized. */\n  private initialized_ = false;\n\n  /** @param workspace The workspace to sit in. */\n  constructor(private workspace: WorkspaceSvg) {\n    super();\n\n    if (this.workspace.options.maxTrashcanContents <= 0) {\n      return;\n    }\n\n    // Create flyout options.\n    const flyoutWorkspaceOptions = new Options(({\n      'scrollbars': true,\n      'parentWorkspace': this.workspace,\n      'rtl': this.workspace.RTL,\n      'oneBasedIndex': this.workspace.options.oneBasedIndex,\n      'renderer': this.workspace.options.renderer,\n      'rendererOverrides': this.workspace.options.rendererOverrides,\n      'move': {\n        'scrollbars': true,\n      },\n    } as BlocklyOptions));\n    // Create vertical or horizontal flyout.\n    if (this.workspace.horizontalLayout) {\n      flyoutWorkspaceOptions.toolboxPosition =\n          this.workspace.toolboxPosition === toolbox.Position.TOP ?\n          toolbox.Position.BOTTOM :\n          toolbox.Position.TOP;\n      const HorizontalFlyout = registry.getClassFromOptions(\n          registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX, this.workspace.options,\n          true);\n      this.flyout = new HorizontalFlyout!(flyoutWorkspaceOptions);\n    } else {\n      flyoutWorkspaceOptions.toolboxPosition =\n          this.workspace.toolboxPosition === toolbox.Position.RIGHT ?\n          toolbox.Position.LEFT :\n          toolbox.Position.RIGHT;\n      const VerticalFlyout = registry.getClassFromOptions(\n          registry.Type.FLYOUTS_VERTICAL_TOOLBOX, this.workspace.options, true);\n      this.flyout = new VerticalFlyout!(flyoutWorkspaceOptions);\n    }\n    this.workspace.addChangeListener(this.onDelete_.bind(this));\n  }\n\n  /**\n   * Create the trash can elements.\n   *\n   * @returns The trash can's SVG group.\n   */\n  createDom(): SVGElement {\n    /* Here's the markup that will be generated:\n        <g class=\"blocklyTrash\">\n          <clippath id=\"blocklyTrashBodyClipPath837493\">\n            <rect width=\"47\" height=\"45\" y=\"15\"></rect>\n          </clippath>\n          <image width=\"64\" height=\"92\" y=\"-32\" xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyTrashBodyClipPath837493)\"></image>\n          <clippath id=\"blocklyTrashLidClipPath837493\">\n            <rect width=\"47\" height=\"15\"></rect>\n          </clippath>\n          <image width=\"84\" height=\"92\" y=\"-32\" xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyTrashLidClipPath837493)\"></image>\n        </g>\n        */\n    this.svgGroup_ = dom.createSvgElement(Svg.G, {'class': 'blocklyTrash'});\n    let clip;\n    const rnd = String(Math.random()).substring(2);\n    clip = dom.createSvgElement(\n        Svg.CLIPPATH, {'id': 'blocklyTrashBodyClipPath' + rnd}, this.svgGroup_);\n    dom.createSvgElement(\n        Svg.RECT, {'width': WIDTH, 'height': BODY_HEIGHT, 'y': LID_HEIGHT},\n        clip);\n    const body = dom.createSvgElement(\n        Svg.IMAGE, {\n          'width': SPRITE.width,\n          'x': -SPRITE_LEFT,\n          'height': SPRITE.height,\n          'y': -SPRITE_TOP,\n          'clip-path': 'url(#blocklyTrashBodyClipPath' + rnd + ')',\n        },\n        this.svgGroup_);\n    body.setAttributeNS(\n        dom.XLINK_NS, 'xlink:href',\n        this.workspace.options.pathToMedia + SPRITE.url);\n\n    clip = dom.createSvgElement(\n        Svg.CLIPPATH, {'id': 'blocklyTrashLidClipPath' + rnd}, this.svgGroup_);\n    dom.createSvgElement(\n        Svg.RECT, {'width': WIDTH, 'height': LID_HEIGHT}, clip);\n    this.svgLid_ = dom.createSvgElement(\n        Svg.IMAGE, {\n          'width': SPRITE.width,\n          'x': -SPRITE_LEFT,\n          'height': SPRITE.height,\n          'y': -SPRITE_TOP,\n          'clip-path': 'url(#blocklyTrashLidClipPath' + rnd + ')',\n        },\n        this.svgGroup_);\n    this.svgLid_.setAttributeNS(\n        dom.XLINK_NS, 'xlink:href',\n        this.workspace.options.pathToMedia + SPRITE.url);\n\n    // bindEventWithChecks_ quashes events too aggressively. See:\n    // https://groups.google.com/forum/#!topic/blockly/QF4yB9Wx00s\n    // Using bindEventWithChecks_ for blocking mousedown causes issue in mobile.\n    // See #4303\n    browserEvents.bind(\n        this.svgGroup_, 'mousedown', this, this.blockMouseDownWhenOpenable_);\n    browserEvents.bind(this.svgGroup_, 'mouseup', this, this.click);\n    // Bind to body instead of this.svgGroup_ so that we don't get lid jitters\n    browserEvents.bind(body, 'mouseover', this, this.mouseOver_);\n    browserEvents.bind(body, 'mouseout', this, this.mouseOut_);\n    this.animateLid_();\n    return this.svgGroup_;\n  }\n\n  /** Initializes the trash can. */\n  init() {\n    if (this.workspace.options.maxTrashcanContents > 0) {\n      dom.insertAfter(\n          this.flyout!.createDom(Svg.SVG)!, this.workspace.getParentSvg());\n      this.flyout!.init(this.workspace);\n    }\n    this.workspace.getComponentManager().addComponent({\n      component: this,\n      weight: 1,\n      capabilities: [\n        ComponentManager.Capability.AUTOHIDEABLE,\n        ComponentManager.Capability.DELETE_AREA,\n        ComponentManager.Capability.DRAG_TARGET,\n        ComponentManager.Capability.POSITIONABLE,\n      ],\n    });\n    this.initialized_ = true;\n    this.setLidOpen(false);\n  }\n\n  /**\n   * Dispose of this trash can.\n   * Unlink from all DOM elements to prevent memory leaks.\n   *\n   * @suppress {checkTypes}\n   */\n  dispose() {\n    this.workspace.getComponentManager().removeComponent('trashcan');\n    if (this.svgGroup_) {\n      dom.removeNode(this.svgGroup_);\n      this.svgGroup_ = null;\n    }\n    this.svgLid_ = null;\n    if (this.lidTask_) {\n      clearTimeout(this.lidTask_);\n    }\n  }\n\n  /**\n   * Whether the trashcan has contents.\n   *\n   * @returns True if the trashcan has contents.\n   */\n  private hasContents_(): boolean {\n    return !!this.contents_.length;\n  }\n\n  /**\n   * Returns true if the trashcan contents-flyout is currently open.\n   *\n   * @returns True if the trashcan contents-flyout is currently open.\n   */\n  contentsIsOpen(): boolean {\n    return !!this.flyout && this.flyout.isVisible();\n  }\n\n  /** Opens the trashcan flyout. */\n  openFlyout() {\n    if (this.contentsIsOpen()) {\n      return;\n    }\n    const contents = this.contents_.map(function(string) {\n      return JSON.parse(string);\n    });\n    this.flyout?.show(contents);\n    this.fireUiEvent_(true);\n  }\n\n  /** Closes the trashcan flyout. */\n  closeFlyout() {\n    if (!this.contentsIsOpen()) {\n      return;\n    }\n    this.flyout?.hide();\n    this.fireUiEvent_(false);\n    this.workspace.recordDragTargets();\n  }\n\n  /**\n   * Hides the component. Called in WorkspaceSvg.hideChaff.\n   *\n   * @param onlyClosePopups Whether only popups should be closed.\n   *     Flyouts should not be closed if this is true.\n   */\n  autoHide(onlyClosePopups: boolean) {\n    // For now the trashcan flyout always autocloses because it overlays the\n    // trashcan UI (no trashcan to click to close it).\n    if (!onlyClosePopups && this.flyout) {\n      this.closeFlyout();\n    }\n  }\n\n  /**\n   * Empties the trashcan's contents. If the contents-flyout is currently open\n   * it will be closed.\n   */\n  emptyContents() {\n    if (!this.hasContents_()) {\n      return;\n    }\n    this.contents_.length = 0;\n    this.setMinOpenness_(0);\n    this.closeFlyout();\n  }\n\n  /**\n   * Positions the trashcan.\n   * It is positioned in the opposite corner to the corner the\n   * categories/toolbox starts at.\n   *\n   * @param metrics The workspace metrics.\n   * @param savedPositions List of rectangles that are already on the workspace.\n   */\n  position(metrics: UiMetrics, savedPositions: Rect[]) {\n    // Not yet initialized.\n    if (!this.initialized_) {\n      return;\n    }\n\n    const cornerPosition =\n        uiPosition.getCornerOppositeToolbox(this.workspace, metrics);\n\n    const height = BODY_HEIGHT + LID_HEIGHT;\n    const startRect = uiPosition.getStartPositionRect(\n        cornerPosition, new Size(WIDTH, height), MARGIN_HORIZONTAL,\n        MARGIN_VERTICAL, metrics, this.workspace);\n\n    const verticalPosition = cornerPosition.vertical;\n    const bumpDirection = verticalPosition === uiPosition.verticalPosition.TOP ?\n        uiPosition.bumpDirection.DOWN :\n        uiPosition.bumpDirection.UP;\n    const positionRect = uiPosition.bumpPositionRect(\n        startRect, MARGIN_VERTICAL, bumpDirection, savedPositions);\n\n    this.top_ = positionRect.top;\n    this.left_ = positionRect.left;\n    this.svgGroup_?.setAttribute(\n        'transform', 'translate(' + this.left_ + ',' + this.top_ + ')');\n  }\n\n  /**\n   * Returns the bounding rectangle of the UI element in pixel units relative to\n   * the Blockly injection div.\n   *\n   * @returns The UI elements's bounding box. Null if bounding box should be\n   *     ignored by other UI elements.\n   */\n  getBoundingRectangle(): Rect|null {\n    const bottom = this.top_ + BODY_HEIGHT + LID_HEIGHT;\n    const right = this.left_ + WIDTH;\n    return new Rect(this.top_, bottom, this.left_, right);\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect|null {\n    if (!this.svgGroup_) {\n      return null;\n    }\n\n    const trashRect = this.svgGroup_.getBoundingClientRect();\n    const top = trashRect.top + SPRITE_TOP - MARGIN_HOTSPOT;\n    const bottom = top + LID_HEIGHT + BODY_HEIGHT + 2 * MARGIN_HOTSPOT;\n    const left = trashRect.left + SPRITE_LEFT - MARGIN_HOTSPOT;\n    const right = left + WIDTH + 2 * MARGIN_HOTSPOT;\n    return new Rect(top, bottom, left, right);\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble is dragged over this drag\n   * target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragOver(_dragElement: IDraggable) {\n    this.setLidOpen(this.wouldDelete_);\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble exits this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragExit(_dragElement: IDraggable) {\n    this.setLidOpen(false);\n  }\n\n  /**\n   * Handles when a block or bubble is dropped on this component.\n   * Should not handle delete here.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDrop(_dragElement: IDraggable) {\n    setTimeout(this.setLidOpen.bind(this, false), 100);\n  }\n\n  /**\n   * Flip the lid open or shut.\n   *\n   * @param state True if open.\n   * @internal\n   */\n  setLidOpen(state: boolean) {\n    if (this.isLidOpen === state) {\n      return;\n    }\n    if (this.lidTask_) {\n      clearTimeout(this.lidTask_);\n    }\n    this.isLidOpen = state;\n    this.animateLid_();\n  }\n\n  /** Rotate the lid open or closed by one step.  Then wait and recurse. */\n  private animateLid_() {\n    const frames = ANIMATION_FRAMES;\n\n    const delta = 1 / (frames + 1);\n    this.lidOpen_ += this.isLidOpen ? delta : -delta;\n    this.lidOpen_ = Math.min(Math.max(this.lidOpen_, this.minOpenness_), 1);\n\n    this.setLidAngle_(this.lidOpen_ * MAX_LID_ANGLE);\n\n    // Linear interpolation between min and max.\n    const opacity = OPACITY_MIN + this.lidOpen_ * (OPACITY_MAX - OPACITY_MIN);\n    if (this.svgGroup_) {\n      this.svgGroup_.style.opacity = opacity.toString();\n    }\n\n    if (this.lidOpen_ > this.minOpenness_ && this.lidOpen_ < 1) {\n      this.lidTask_ =\n          setTimeout(this.animateLid_.bind(this), ANIMATION_LENGTH / frames);\n    }\n  }\n\n  /**\n   * Set the angle of the trashcan's lid.\n   *\n   * @param lidAngle The angle at which to set the lid.\n   */\n  private setLidAngle_(lidAngle: number) {\n    const openAtRight =\n        this.workspace.toolboxPosition === toolbox.Position.RIGHT ||\n        this.workspace.horizontalLayout && this.workspace.RTL;\n    this.svgLid_?.setAttribute(\n        'transform',\n        'rotate(' + (openAtRight ? -lidAngle : lidAngle) + ',' +\n            (openAtRight ? 4 : WIDTH - 4) + ',' + (LID_HEIGHT - 2) + ')');\n  }\n\n  /**\n   * Sets the minimum openness of the trashcan lid. If the lid is currently\n   * closed, this will update lid's position.\n   *\n   * @param newMin The new minimum openness of the lid. Should be between 0\n   *     and 1.\n   */\n  private setMinOpenness_(newMin: number) {\n    this.minOpenness_ = newMin;\n    if (!this.isLidOpen) {\n      this.setLidAngle_(newMin * MAX_LID_ANGLE);\n    }\n  }\n\n  /**\n   * Flip the lid shut.\n   * Called externally after a drag.\n   */\n  closeLid() {\n    this.setLidOpen(false);\n  }\n\n  /** Inspect the contents of the trash. */\n  click() {\n    if (!this.hasContents_()) {\n      return;\n    }\n    this.openFlyout();\n  }\n\n  /**\n   * Fires a UI event for trashcan flyout open or close.\n   *\n   * @param trashcanOpen Whether the flyout is opening.\n   */\n  private fireUiEvent_(trashcanOpen: boolean) {\n    const uiEvent = new (eventUtils.get(eventUtils.TRASHCAN_OPEN))(\n        trashcanOpen, this.workspace.id);\n    eventUtils.fire(uiEvent);\n  }\n\n  /**\n   * Prevents a workspace scroll and click event if the trashcan has blocks.\n   *\n   * @param e A mouse down event.\n   */\n  private blockMouseDownWhenOpenable_(e: Event) {\n    if (!this.contentsIsOpen() && this.hasContents_()) {\n      // Don't start a workspace scroll.\n      e.stopPropagation();\n    }\n  }\n\n  /**\n   * Indicate that the trashcan can be clicked (by opening it) if it has blocks.\n   */\n  private mouseOver_() {\n    if (this.hasContents_()) {\n      this.setLidOpen(true);\n    }\n  }\n\n  /**\n   * Close the lid of the trashcan if it was open (Vis. it was indicating it had\n   *    blocks).\n   */\n  private mouseOut_() {\n    // No need to do a .hasBlocks check here because if it doesn't the trashcan\n    // won't be open in the first place, and setOpen won't run.\n    this.setLidOpen(false);\n  }\n\n  /**\n   * Handle a BLOCK_DELETE event. Adds deleted blocks oldXml to the content\n   * array.\n   *\n   * @param event Workspace event.\n   */\n  private onDelete_(event: Abstract) {\n    if (this.workspace.options.maxTrashcanContents <= 0 ||\n        event.type !== eventUtils.BLOCK_DELETE) {\n      return;\n    }\n    const deleteEvent = event as BlockDelete;\n    if (event.type === eventUtils.BLOCK_DELETE && !deleteEvent.wasShadow) {\n      const cleanedJson =\n          JSON.stringify(this.cleanBlockJson_(deleteEvent.oldJson));\n      if (this.contents_.indexOf(cleanedJson) !== -1) {\n        return;\n      }\n      this.contents_.unshift(cleanedJson);\n      while (this.contents_.length >\n             this.workspace.options.maxTrashcanContents) {\n        this.contents_.pop();\n      }\n\n      this.setMinOpenness_(HAS_BLOCKS_LID_ANGLE);\n    }\n  }\n\n  /**\n   * Converts JSON representing a block into text that can be stored in the\n   * content array.\n   *\n   * @param json A JSON representation of a block's state.\n   * @returns A BlockInfo object corresponding to the JSON, cleaned of all\n   *     unnecessary attributes.\n   */\n  private cleanBlockJson_(json: blocks.State): BlockInfo {\n    // Create a deep copy.\n    json = JSON.parse(JSON.stringify(json)) as blocks.State;\n\n    /**\n     * Reshape JSON into a nicer format.\n     *\n     * @param json The JSON to clean.\n     */\n    function cleanRec(json: blocks.State) {\n      if (!json) {\n        return;\n      }\n\n      delete json['id'];\n      delete json['x'];\n      delete json['y'];\n      delete json['enabled'];\n\n      if (json['icons'] && json['icons']['comment']) {\n        const comment = json['icons']['comment'];\n        delete comment['height'];\n        delete comment['width'];\n        delete comment['pinned'];\n      }\n\n      const inputs = json['inputs'];\n      for (const name in inputs) {\n        const input = inputs[name];\n        const block = input['block'];\n        const shadow = input['shadow'];\n        if (block) {\n          cleanRec(block);\n        }\n        if (shadow) {\n          cleanRec(shadow);\n        }\n      }\n      if (json['next']) {\n        const next = json['next'];\n        const block = next['block'];\n        const shadow = next['shadow'];\n        if (block) {\n          cleanRec(block);\n        }\n        if (shadow) {\n          cleanRec(shadow);\n        }\n      }\n    }\n\n    cleanRec(json);\n\n    const blockInfo: BlockInfo = {\n      'kind': 'BLOCK',\n      ...json,\n    };\n    return blockInfo;\n  }\n}\n\n\n/** Width of both the trash can and lid images. */\nconst WIDTH = 47;\n\n/** Height of the trashcan image (minus lid). */\nconst BODY_HEIGHT = 44;\n\n/** Height of the lid image. */\nconst LID_HEIGHT = 16;\n\n/** Distance between trashcan and bottom or top edge of workspace. */\nconst MARGIN_VERTICAL = 20;\n\n/** Distance between trashcan and right or left edge of workspace. */\nconst MARGIN_HORIZONTAL = 20;\n\n/** Extent of hotspot on all sides beyond the size of the image. */\nconst MARGIN_HOTSPOT = 10;\n\n/** Location of trashcan in sprite image. */\nconst SPRITE_LEFT = 0;\n\n/** Location of trashcan in sprite image. */\nconst SPRITE_TOP = 32;\n\n/**\n * The openness of the lid when the trashcan contains blocks.\n *    (0.0 = closed, 1.0 = open)\n */\nconst HAS_BLOCKS_LID_ANGLE = 0.1;\n\n/** The length of the lid open/close animation in milliseconds. */\nconst ANIMATION_LENGTH = 80;\n\n/** The number of frames in the animation. */\nconst ANIMATION_FRAMES = 4;\n\n/** The minimum (resting) opacity of the trashcan and lid. */\nconst OPACITY_MIN = 0.4;\n\n/** The maximum (hovered) opacity of the trashcan and lid. */\nconst OPACITY_MAX = 0.8;\n\n/**\n * The maximum angle the trashcan lid can opens to. At the end of the open\n * animation the lid will be open to this angle.\n */\nconst MAX_LID_ANGLE = 45;\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of selecting an item on the toolbox.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.ToolboxItemSelect');\n\nimport * as registry from '../registry.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a toolbox item select event.\n *\n * @alias Blockly.Events.ToolboxItemSelect\n */\nexport class ToolboxItemSelect extends UiBase {\n  oldItem?: string|null;\n  newItem?: string|null;\n  override type: string;\n\n  /**\n   * @param opt_oldItem The previously selected toolbox item.\n   *     Undefined for a blank event.\n   * @param opt_newItem The newly selected toolbox item. Undefined for a blank\n   *     event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   */\n  constructor(\n      opt_oldItem?: string|null, opt_newItem?: string|null,\n      opt_workspaceId?: string) {\n    super(opt_workspaceId);\n\n    /** The previously selected toolbox item. */\n    this.oldItem = opt_oldItem;\n\n    /** The newly selected toolbox item. */\n    this.newItem = opt_newItem;\n\n    /** Type of this event. */\n    this.type = eventUtils.TOOLBOX_ITEM_SELECT;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['oldItem'] = this.oldItem;\n    json['newItem'] = this.newItem;\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.oldItem = json['oldItem'];\n    this.newItem = json['newItem'];\n  }\n}\n\nregistry.register(\n    registry.Type.EVENT, eventUtils.TOOLBOX_ITEM_SELECT, ToolboxItemSelect);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An item in the toolbox.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ToolboxItem');\n\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport * as idGenerator from '../utils/idgenerator.js';\nimport type * as toolbox from '../utils/toolbox.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\n\n/**\n * Class for an item in the toolbox.\n *\n * @alias Blockly.ToolboxItem\n */\nexport class ToolboxItem implements IToolboxItem {\n  protected id_: string;\n  protected parent_: ICollapsibleToolboxItem|null;\n  protected level_: number;\n  protected toolboxItemDef_: toolbox.ToolboxItemInfo|null;\n  protected workspace_: WorkspaceSvg;\n  /** The toolbox this category belongs to. */\n  protected readonly parentToolbox_: IToolbox;\n\n  /**\n   * @param toolboxItemDef The JSON defining the toolbox item.\n   * @param parentToolbox The toolbox that holds the toolbox item.\n   * @param opt_parent The parent toolbox item or null if the category does not\n   *     have a parent.\n   */\n  constructor(\n      toolboxItemDef: toolbox.ToolboxItemInfo, parentToolbox: IToolbox,\n      opt_parent?: ICollapsibleToolboxItem) {\n    /** The id for the category. */\n    this.id_ = (toolboxItemDef as AnyDuringMigration)['toolboxitemid'] ||\n        idGenerator.getNextUniqueId();\n\n    /** The parent of the category. */\n    this.parent_ = opt_parent || null;\n\n    /** The level that the category is nested at. */\n    this.level_ = this.parent_ ? this.parent_.getLevel() + 1 : 0;\n\n    /** The JSON definition of the toolbox item. */\n    this.toolboxItemDef_ = toolboxItemDef;\n\n    this.parentToolbox_ = parentToolbox;\n\n    /** The workspace of the parent toolbox. */\n    this.workspace_ = this.parentToolbox_.getWorkspace();\n  }\n\n  /**\n   * Initializes the toolbox item.\n   * This includes creating the DOM and updating the state of any items based\n   * on the info object.\n   */\n  init() {}\n  // No-op by default.\n\n  /**\n   * Gets the div for the toolbox item.\n   *\n   * @returns The div for the toolbox item.\n   */\n  getDiv(): Element|null {\n    return null;\n  }\n\n  /**\n   * Gets the HTML element that is clickable.\n   * The parent toolbox element receives clicks. The parent toolbox will add an\n   * ID to this element so it can pass the onClick event to the correct\n   * toolboxItem.\n   *\n   * @returns The HTML element that receives clicks, or null if this item should\n   *     not receive clicks.\n   */\n  getClickTarget(): Element|null {\n    return null;\n  }\n\n  /**\n   * Gets a unique identifier for this toolbox item.\n   *\n   * @returns The ID for the toolbox item.\n   */\n  getId(): string {\n    return this.id_;\n  }\n\n  /**\n   * Gets the parent if the toolbox item is nested.\n   *\n   * @returns The parent toolbox item, or null if this toolbox item is not\n   *     nested.\n   */\n  getParent(): ICollapsibleToolboxItem|null {\n    return null;\n  }\n\n  /**\n   * Gets the nested level of the category.\n   *\n   * @returns The nested level of the category.\n   * @internal\n   */\n  getLevel(): number {\n    return this.level_;\n  }\n\n  /**\n   * Whether the toolbox item is selectable.\n   *\n   * @returns True if the toolbox item can be selected.\n   */\n  isSelectable(): boolean {\n    return false;\n  }\n\n  /**\n   * Whether the toolbox item is collapsible.\n   *\n   * @returns True if the toolbox item is collapsible.\n   */\n  isCollapsible(): boolean {\n    return false;\n  }\n\n  /** Dispose of this toolbox item. No-op by default. */\n  dispose() {}\n\n  /**\n   * Sets whether the category is visible or not.\n   * For a category to be visible its parent category must also be expanded.\n   *\n   * @param _isVisible True if category should be visible.\n   */\n  setVisible_(_isVisible: boolean) {}\n}\n// nop by default\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A toolbox category used to organize blocks in the toolbox.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ToolboxCategory');\n\nimport * as Css from '../css.js';\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {ISelectableToolboxItem} from '../interfaces/i_selectable_toolbox_item.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport * as registry from '../registry.js';\nimport * as aria from '../utils/aria.js';\nimport * as colourUtils from '../utils/colour.js';\nimport * as dom from '../utils/dom.js';\nimport * as parsing from '../utils/parsing.js';\nimport * as toolbox from '../utils/toolbox.js';\n\nimport {ToolboxItem} from './toolbox_item.js';\n\n\n/**\n * Class for a category in a toolbox.\n *\n * @alias Blockly.ToolboxCategory\n */\nexport class ToolboxCategory extends ToolboxItem implements\n    ISelectableToolboxItem {\n  /** Name used for registering a toolbox category. */\n  static registrationName = 'category';\n\n  /** The number of pixels to move the category over at each nested level. */\n  static nestedPadding = 19;\n\n  /** The width in pixels of the strip of colour next to each category. */\n  static borderWidth = 8;\n\n  /**\n   * The default colour of the category. This is used as the background colour\n   * of the category when it is selected.\n   */\n  static defaultBackgroundColour = '#57e';\n\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override toolboxItemDef_!: toolbox.CategoryInfo;\n\n  /** The name that will be displayed on the category. */\n  protected name_ = '';\n\n  /** The colour of the category. */\n  protected colour_ = '';\n\n  /** The html container for the category. */\n  protected htmlDiv_: HTMLDivElement|null = null;\n\n  /** The html element for the category row. */\n  protected rowDiv_: HTMLDivElement|null = null;\n\n  /** The html element that holds children elements of the category row. */\n  protected rowContents_: HTMLDivElement|null = null;\n\n  /** The html element for the toolbox icon. */\n  protected iconDom_: Element|null = null;\n\n  /** The html element for the toolbox label. */\n  protected labelDom_: Element|null = null;\n  protected cssConfig_: CssConfig;\n\n  /** True if the category is meant to be hidden, false otherwise. */\n  protected isHidden_ = false;\n\n  /** True if this category is disabled, false otherwise. */\n  protected isDisabled_ = false;\n\n  /** The flyout items for this category. */\n  protected flyoutItems_: string|toolbox.FlyoutItemInfoArray = [];\n\n  /**\n   * @param categoryDef The information needed to create a category in the\n   *     toolbox.\n   * @param parentToolbox The parent toolbox for the category.\n   * @param opt_parent The parent category or null if the category does not have\n   *     a parent.\n   */\n  constructor(\n      categoryDef: toolbox.CategoryInfo, parentToolbox: IToolbox,\n      opt_parent?: ICollapsibleToolboxItem) {\n    super(categoryDef, parentToolbox, opt_parent);\n\n    /** All the css class names that are used to create a category. */\n    this.cssConfig_ = this.makeDefaultCssConfig_();\n  }\n\n  /**\n   * Initializes the toolbox item.\n   * This includes creating the DOM and updating the state of any items based\n   * on the info object.\n   * Init should be called immediately after the construction of the toolbox\n   * item, to ensure that the category contents are properly parsed.\n   */\n  override init() {\n    this.parseCategoryDef_(this.toolboxItemDef_);\n    this.parseContents_(this.toolboxItemDef_);\n    this.createDom_();\n    if (this.toolboxItemDef_['hidden'] === 'true') {\n      this.hide();\n    }\n  }\n\n  /**\n   * Creates an object holding the default classes for a category.\n   *\n   * @returns The configuration object holding all the CSS classes for a\n   *     category.\n   */\n  protected makeDefaultCssConfig_(): CssConfig {\n    // AnyDuringMigration because:  Type '{ container: string; row: string;\n    // rowcontentcontainer: string; icon: string; label: string; contents:\n    // string; selected: string; openicon: string; closedicon: string; }' is not\n    // assignable to type 'CssConfig'.\n    return {\n      'container': 'blocklyToolboxCategory',\n      'row': 'blocklyTreeRow',\n      'rowcontentcontainer': 'blocklyTreeRowContentContainer',\n      'icon': 'blocklyTreeIcon',\n      'label': 'blocklyTreeLabel',\n      'contents': 'blocklyToolboxContents',\n      'selected': 'blocklyTreeSelected',\n      'openicon': 'blocklyTreeIconOpen',\n      'closedicon': 'blocklyTreeIconClosed',\n    } as AnyDuringMigration;\n  }\n\n  /**\n   * Parses the contents array depending on if the category is a dynamic\n   * category, or if its contents are meant to be shown in the flyout.\n   *\n   * @param categoryDef The information needed to create a category.\n   */\n  protected parseContents_(categoryDef: toolbox.CategoryInfo) {\n    const contents = (categoryDef as AnyDuringMigration)['contents'];\n\n    if ((categoryDef as AnyDuringMigration)['custom']) {\n      this.flyoutItems_ = (categoryDef as AnyDuringMigration)['custom'];\n    } else if (contents) {\n      for (let i = 0; i < contents.length; i++) {\n        const itemDef = contents[i];\n        const flyoutItem = itemDef as toolbox.FlyoutItemInfo;\n        // AnyDuringMigration because:  Property 'push' does not exist on type\n        // 'string | FlyoutItemInfoArray'.\n        (this.flyoutItems_ as AnyDuringMigration).push(flyoutItem);\n      }\n    }\n  }\n\n  /**\n   * Parses the non-contents parts of the category def.\n   *\n   * @param categoryDef The information needed to create a category.\n   */\n  protected parseCategoryDef_(categoryDef: toolbox.CategoryInfo) {\n    this.name_ = parsing.replaceMessageReferences(\n        (categoryDef as AnyDuringMigration)['name']);\n    this.colour_ = this.getColour_(categoryDef);\n    Object.assign(\n        this.cssConfig_,\n        categoryDef['cssconfig'] ||\n            (categoryDef as AnyDuringMigration)['cssConfig']);\n  }\n\n  /**\n   * Creates the DOM for the category.\n   *\n   * @returns The parent element for the category.\n   */\n  protected createDom_(): HTMLDivElement {\n    this.htmlDiv_ = this.createContainer_();\n    aria.setRole(this.htmlDiv_, aria.Role.TREEITEM);\n    aria.setState((this.htmlDiv_), aria.State.SELECTED, false);\n    aria.setState((this.htmlDiv_), aria.State.LEVEL, this.level_);\n\n    this.rowDiv_ = this.createRowContainer_();\n    this.rowDiv_.style.pointerEvents = 'auto';\n    this.htmlDiv_.appendChild(this.rowDiv_);\n\n    this.rowContents_ = this.createRowContentsContainer_();\n    this.rowContents_.style.pointerEvents = 'none';\n    this.rowDiv_.appendChild(this.rowContents_);\n\n    this.iconDom_ = this.createIconDom_();\n    aria.setRole(this.iconDom_, aria.Role.PRESENTATION);\n    this.rowContents_.appendChild(this.iconDom_);\n\n    this.labelDom_ = this.createLabelDom_(this.name_);\n    this.rowContents_.appendChild(this.labelDom_);\n    // AnyDuringMigration because:  Argument of type 'string | null' is not\n    // assignable to parameter of type 'string | number | boolean | string[]'.\n    aria.setState(\n        this.htmlDiv_ as Element, aria.State.LABELLEDBY,\n        this.labelDom_.getAttribute('id') as AnyDuringMigration);\n\n    this.addColourBorder_(this.colour_);\n\n    return this.htmlDiv_;\n  }\n\n  /**\n   * Creates the container that holds the row and any subcategories.\n   *\n   * @returns The div that holds the icon and the label.\n   */\n  protected createContainer_(): HTMLDivElement {\n    const container = (document.createElement('div'));\n    // AnyDuringMigration because:  Argument of type 'string | undefined' is not\n    // assignable to parameter of type 'string'.\n    dom.addClass(\n        container, (this.cssConfig_ as AnyDuringMigration)['container']);\n    return container;\n  }\n\n  /**\n   * Creates the parent of the contents container. All clicks will happen on\n   * this div.\n   *\n   * @returns The div that holds the contents container.\n   */\n  protected createRowContainer_(): HTMLDivElement {\n    const rowDiv = (document.createElement('div'));\n    // AnyDuringMigration because:  Argument of type 'string | undefined' is not\n    // assignable to parameter of type 'string'.\n    dom.addClass(rowDiv, (this.cssConfig_ as AnyDuringMigration)['row']);\n    let nestedPadding = ToolboxCategory.nestedPadding * this.getLevel();\n    // AnyDuringMigration because:  Type 'string' is not assignable to type\n    // 'number'.\n    nestedPadding = (nestedPadding.toString() + 'px') as AnyDuringMigration;\n    // AnyDuringMigration because:  Type 'number' is not assignable to type\n    // 'string'. AnyDuringMigration because:  Type 'number' is not assignable to\n    // type 'string'.\n    this.workspace_.RTL ?\n        rowDiv.style.paddingRight = nestedPadding as AnyDuringMigration :\n        rowDiv.style.paddingLeft = nestedPadding as AnyDuringMigration;\n    return rowDiv;\n  }\n\n  /**\n   * Creates the container for the label and icon.\n   * This is necessary so we can set all subcategory pointer events to none.\n   *\n   * @returns The div that holds the icon and the label.\n   */\n  protected createRowContentsContainer_(): HTMLDivElement {\n    const contentsContainer = (document.createElement('div'));\n    // AnyDuringMigration because:  Argument of type 'string | undefined' is not\n    // assignable to parameter of type 'string'.\n    dom.addClass(\n        contentsContainer,\n        (this.cssConfig_ as AnyDuringMigration)['rowcontentcontainer']);\n    return contentsContainer;\n  }\n\n  /**\n   * Creates the span that holds the category icon.\n   *\n   * @returns The span that holds the category icon.\n   */\n  protected createIconDom_(): Element {\n    const toolboxIcon = document.createElement('span');\n    if (!this.parentToolbox_.isHorizontal()) {\n      // AnyDuringMigration because:  Argument of type 'string | undefined' is\n      // not assignable to parameter of type 'string'.\n      dom.addClass(\n          toolboxIcon, (this.cssConfig_ as AnyDuringMigration)['icon']);\n    }\n\n    toolboxIcon.style.display = 'inline-block';\n    return toolboxIcon;\n  }\n\n  /**\n   * Creates the span that holds the category label.\n   * This should have an ID for accessibility purposes.\n   *\n   * @param name The name of the category.\n   * @returns The span that holds the category label.\n   */\n  protected createLabelDom_(name: string): Element {\n    const toolboxLabel = document.createElement('span');\n    toolboxLabel.setAttribute('id', this.getId() + '.label');\n    toolboxLabel.textContent = name;\n    // AnyDuringMigration because:  Argument of type 'string | undefined' is not\n    // assignable to parameter of type 'string'.\n    dom.addClass(\n        toolboxLabel, (this.cssConfig_ as AnyDuringMigration)['label']);\n    return toolboxLabel;\n  }\n\n  /** Updates the colour for this category. */\n  refreshTheme() {\n    this.colour_ = this.getColour_((this.toolboxItemDef_));\n    this.addColourBorder_(this.colour_);\n  }\n\n  /**\n   * Add the strip of colour to the toolbox category.\n   *\n   * @param colour The category colour.\n   */\n  protected addColourBorder_(colour: string) {\n    if (colour) {\n      const border =\n          ToolboxCategory.borderWidth + 'px solid ' + (colour || '#ddd');\n      if (this.workspace_.RTL) {\n        this.rowDiv_!.style.borderRight = border;\n      } else {\n        this.rowDiv_!.style.borderLeft = border;\n      }\n    }\n  }\n\n  /**\n   * Gets either the colour or the style for a category.\n   *\n   * @param categoryDef The object holding information on the category.\n   * @returns The hex colour for the category.\n   */\n  protected getColour_(categoryDef: toolbox.CategoryInfo): string {\n    const styleName =\n        categoryDef['categorystyle'] || (categoryDef as any)['categoryStyle'];\n    const colour = categoryDef['colour'];\n\n    if (colour && styleName) {\n      console.warn(\n          'Toolbox category \"' + this.name_ +\n          '\" must not have both a style and a colour');\n    } else if (styleName) {\n      return this.getColourfromStyle_(styleName);\n    } else {\n      // AnyDuringMigration because:  Argument of type 'string | undefined' is\n      // not assignable to parameter of type 'string | number'.\n      return this.parseColour_(colour as AnyDuringMigration);\n    }\n    return '';\n  }\n\n  /**\n   * Sets the colour for the category using the style name and returns the new\n   * colour as a hex string.\n   *\n   * @param styleName Name of the style.\n   * @returns The hex colour for the category.\n   */\n  private getColourfromStyle_(styleName: string): string {\n    const theme = this.workspace_.getTheme();\n    if (styleName && theme) {\n      const style = theme.categoryStyles[styleName];\n      if (style && style.colour) {\n        return this.parseColour_(style.colour);\n      } else {\n        console.warn(\n            'Style \"' + styleName + '\" must exist and contain a colour value');\n      }\n    }\n    return '';\n  }\n\n  /**\n   * Gets the HTML element that is clickable.\n   * The parent toolbox element receives clicks. The parent toolbox will add an\n   * ID to this element so it can pass the onClick event to the correct\n   * toolboxItem.\n   *\n   * @returns The HTML element that receives clicks.\n   */\n  override getClickTarget(): Element {\n    return this.rowDiv_ as Element;\n  }\n\n  /**\n   * Parses the colour on the category.\n   *\n   * @param colourValue HSV hue value (0 to 360), #RRGGBB string, or a message\n   *     reference string pointing to one of those two values.\n   * @returns The hex colour for the category.\n   */\n  private parseColour_(colourValue: number|string): string {\n    // Decode the colour for any potential message references\n    // (eg. `%{BKY_MATH_HUE}`).\n    const colour = parsing.replaceMessageReferences(colourValue);\n    if (colour == null || colour === '') {\n      // No attribute. No colour.\n      return '';\n    } else {\n      const hue = Number(colour);\n      if (!isNaN(hue)) {\n        return colourUtils.hueToHex(hue);\n      } else {\n        const hex = colourUtils.parse(colour);\n        if (hex) {\n          return hex;\n        } else {\n          console.warn(\n              'Toolbox category \"' + this.name_ +\n              '\" has unrecognized colour attribute: ' + colour);\n          return '';\n        }\n      }\n    }\n  }\n\n  /**\n   * Adds appropriate classes to display an open icon.\n   *\n   * @param iconDiv The div that holds the icon.\n   */\n  protected openIcon_(iconDiv: Element|null) {\n    if (!iconDiv) {\n      return;\n    }\n    // AnyDuringMigration because:  Argument of type 'string | undefined' is not\n    // assignable to parameter of type 'string'.\n    dom.removeClasses(\n        iconDiv, (this.cssConfig_ as AnyDuringMigration)['closedicon']);\n    // AnyDuringMigration because:  Argument of type 'string | undefined' is not\n    // assignable to parameter of type 'string'.\n    dom.addClass(iconDiv, (this.cssConfig_ as AnyDuringMigration)['openicon']);\n  }\n\n  /**\n   * Adds appropriate classes to display a closed icon.\n   *\n   * @param iconDiv The div that holds the icon.\n   */\n  protected closeIcon_(iconDiv: Element|null) {\n    if (!iconDiv) {\n      return;\n    }\n    // AnyDuringMigration because:  Argument of type 'string | undefined' is not\n    // assignable to parameter of type 'string'.\n    dom.removeClasses(\n        iconDiv, (this.cssConfig_ as AnyDuringMigration)['openicon']);\n    // AnyDuringMigration because:  Argument of type 'string | undefined' is not\n    // assignable to parameter of type 'string'.\n    dom.addClass(\n        iconDiv, (this.cssConfig_ as AnyDuringMigration)['closedicon']);\n  }\n\n  /**\n   * Sets whether the category is visible or not.\n   * For a category to be visible its parent category must also be expanded.\n   *\n   * @param isVisible True if category should be visible.\n   */\n  override setVisible_(isVisible: boolean) {\n    this.htmlDiv_!.style.display = isVisible ? 'block' : 'none';\n    this.isHidden_ = !isVisible;\n\n    if (this.parentToolbox_.getSelectedItem() === this) {\n      this.parentToolbox_.clearSelection();\n    }\n  }\n\n  /** Hide the category. */\n  hide() {\n    this.setVisible_(false);\n  }\n\n  /**\n   * Show the category. Category will only appear if its parent category is also\n   * expanded.\n   */\n  show() {\n    this.setVisible_(true);\n  }\n\n  /**\n   * Whether the category is visible.\n   * A category is only visible if all of its ancestors are expanded and\n   * isHidden_ is false.\n   *\n   * @returns True if the category is visible, false otherwise.\n   */\n  isVisible(): boolean {\n    return !this.isHidden_ && this.allAncestorsExpanded_();\n  }\n\n  /**\n   * Whether all ancestors of a category (parent and parent's parent, etc.) are\n   * expanded.\n   *\n   * @returns True only if every ancestor is expanded\n   */\n  protected allAncestorsExpanded_(): boolean {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let category: IToolboxItem = this;\n    while (category.getParent()) {\n      category = category.getParent()!;\n      if (!(category as ICollapsibleToolboxItem).isExpanded()) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  override isSelectable() {\n    return this.isVisible() && !this.isDisabled_;\n  }\n\n  /**\n   * Handles when the toolbox item is clicked.\n   *\n   * @param _e Click event to handle.\n   */\n  onClick(_e: Event) {}\n  // No-op\n\n  /**\n   * Sets the current category as selected.\n   *\n   * @param isSelected True if this category is selected, false otherwise.\n   */\n  setSelected(isSelected: boolean) {\n    if (isSelected) {\n      const defaultColour =\n          this.parseColour_(ToolboxCategory.defaultBackgroundColour);\n      this.rowDiv_!.style.backgroundColor = this.colour_ || defaultColour;\n      dom.addClass(this.rowDiv_!, this.cssConfig_['selected']!);\n    } else {\n      this.rowDiv_!.style.backgroundColor = '';\n      dom.removeClass(this.rowDiv_!, this.cssConfig_['selected']!);\n    }\n    aria.setState(this.htmlDiv_ as Element, aria.State.SELECTED, isSelected);\n  }\n\n  /**\n   * Sets whether the category is disabled.\n   *\n   * @param isDisabled True to disable the category, false otherwise.\n   */\n  setDisabled(isDisabled: boolean) {\n    this.isDisabled_ = isDisabled;\n    // AnyDuringMigration because:  Argument of type 'boolean' is not assignable\n    // to parameter of type 'string'.\n    this.getDiv()!.setAttribute('disabled', isDisabled as AnyDuringMigration);\n    isDisabled ? this.getDiv()!.setAttribute('disabled', 'true') :\n                 this.getDiv()!.removeAttribute('disabled');\n  }\n\n  /**\n   * Gets the name of the category. Used for emitting events.\n   *\n   * @returns The name of the toolbox item.\n   */\n  getName(): string {\n    return this.name_;\n  }\n\n  override getParent() {\n    return this.parent_;\n  }\n\n  override getDiv() {\n    return this.htmlDiv_;\n  }\n\n  /**\n   * Gets the contents of the category. These are items that are meant to be\n   * displayed in the flyout.\n   *\n   * @returns The definition of items to be displayed in the flyout.\n   */\n  getContents(): toolbox.FlyoutItemInfoArray|string {\n    return this.flyoutItems_;\n  }\n\n  /**\n   * Updates the contents to be displayed in the flyout.\n   * If the flyout is open when the contents are updated, refreshSelection on\n   * the toolbox must also be called.\n   *\n   * @param contents The contents to be displayed in the flyout. A string can be\n   *     supplied to create a dynamic category.\n   */\n  updateFlyoutContents(contents: toolbox.FlyoutDefinition|string) {\n    this.flyoutItems_ = [];\n\n    if (typeof contents === 'string') {\n      (this.toolboxItemDef_ as AnyDuringMigration)['custom'] = contents;\n    } else {\n      // Removes old custom field when contents is updated.\n      delete (this.toolboxItemDef_ as AnyDuringMigration)['custom'];\n      (this.toolboxItemDef_ as AnyDuringMigration)['contents'] =\n          toolbox.convertFlyoutDefToJsonArray(contents);\n    }\n    this.parseContents_((this.toolboxItemDef_));\n  }\n\n  override dispose() {\n    dom.removeNode(this.htmlDiv_);\n  }\n}\n\nexport namespace ToolboxCategory {\n  /** All the CSS class names that are used to create a category. */\n  export interface CssConfig {\n    container: string|undefined;\n    row: string|undefined;\n    rowcontentcontainer: string|undefined;\n    icon: string|undefined;\n    label: string|undefined;\n    selected: string|undefined;\n    openicon: string|undefined;\n    closedicon: string|undefined;\n  }\n}\n\nexport type CssConfig = ToolboxCategory.CssConfig;\n\n/** CSS for Toolbox.  See css.js for use. */\nCss.register(`\n.blocklyTreeRow:not(.blocklyTreeSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolboxDiv[layout=\"h\"] .blocklyToolboxCategory {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"][layout=\"h\"] .blocklyToolboxCategory {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyTreeRow {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeRow {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyTreeIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyTreeIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyTreeIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyTreeLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyTreeLabel {\n  cursor: url(\"<<<PATH>>>/handdelete.cur\"), auto;\n}\n\n.blocklyTreeSelected .blocklyTreeLabel {\n  color: #fff;\n}\n`);\n\nregistry.register(\n    registry.Type.TOOLBOX_ITEM, ToolboxCategory.registrationName,\n    ToolboxCategory);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A separator used for separating toolbox categories.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ToolboxSeparator');\n\nimport * as Css from '../css.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport * as registry from '../registry.js';\nimport * as dom from '../utils/dom.js';\nimport type * as toolbox from '../utils/toolbox.js';\n\nimport {ToolboxItem} from './toolbox_item.js';\n\n\n/**\n * Class for a toolbox separator. This is the thin visual line that appears on\n * the toolbox. This item is not interactable.\n *\n * @alias Blockly.ToolboxSeparator\n */\nexport class ToolboxSeparator extends ToolboxItem {\n  /** Name used for registering a toolbox separator. */\n  static registrationName = 'sep';\n\n  /** All the CSS class names that are used to create a separator. */\n  protected cssConfig_: CssConfig = {'container': 'blocklyTreeSeparator'};\n\n  private htmlDiv_: HTMLDivElement|null = null;\n\n  /**\n   * @param separatorDef The information needed to create a separator.\n   * @param toolbox The parent toolbox for the separator.\n   */\n  constructor(separatorDef: toolbox.SeparatorInfo, toolbox: IToolbox) {\n    super(separatorDef, toolbox);\n\n    const cssConfig =\n        separatorDef['cssconfig'] || (separatorDef as any)['cssConfig'];\n    Object.assign(this.cssConfig_, cssConfig);\n  }\n\n  override init() {\n    this.createDom_();\n  }\n\n  /**\n   * Creates the DOM for a separator.\n   *\n   * @returns The parent element for the separator.\n   */\n  protected createDom_(): HTMLDivElement {\n    const container = (document.createElement('div'));\n    dom.addClass(container, this.cssConfig_['container']!);\n    this.htmlDiv_ = container;\n    return container;\n  }\n\n  override getDiv() {\n    return this.htmlDiv_ as HTMLDivElement;\n  }\n\n  override dispose() {\n    dom.removeNode(this.htmlDiv_ as HTMLDivElement);\n  }\n}\n\nexport namespace ToolboxSeparator {\n  export interface CssConfig {\n    container: string|undefined;\n  }\n}\n\nexport type CssConfig = ToolboxSeparator.CssConfig;\n\n/** CSS for Toolbox.  See css.js for use. */\nCss.register(`\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolboxDiv[layout=\"h\"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n`);\n\nregistry.register(\n    registry.Type.TOOLBOX_ITEM, ToolboxSeparator.registrationName,\n    ToolboxSeparator);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A toolbox category used to organize blocks in the toolbox.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.CollapsibleToolboxCategory');\n\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport * as registry from '../registry.js';\nimport * as aria from '../utils/aria.js';\nimport * as dom from '../utils/dom.js';\nimport * as toolbox from '../utils/toolbox.js';\n\nimport {ToolboxCategory} from './category.js';\nimport {ToolboxSeparator} from './separator.js';\n\n\n/**\n * Class for a category in a toolbox that can be collapsed.\n *\n * @alias Blockly.CollapsibleToolboxCategory\n */\nexport class CollapsibleToolboxCategory extends ToolboxCategory implements\n    ICollapsibleToolboxItem {\n  /** Name used for registering a collapsible toolbox category. */\n  static override registrationName = 'collapsibleCategory';\n\n  /** Container for any child categories. */\n  protected subcategoriesDiv_: HTMLDivElement|null = null;\n\n  /** Whether or not the category should display its subcategories. */\n  protected expanded_ = false;\n\n  /** The child toolbox items for this category. */\n  protected toolboxItems_: IToolboxItem[] = [];\n  override flyoutItems_: AnyDuringMigration;\n  override isHidden_: AnyDuringMigration;\n\n  /**\n   * @param categoryDef The information needed to create a category in the\n   *     toolbox.\n   * @param toolbox The parent toolbox for the category.\n   * @param opt_parent The parent category or null if the category does not have\n   *     a parent.\n   */\n  constructor(\n      categoryDef: toolbox.CategoryInfo, toolbox: IToolbox,\n      opt_parent?: ICollapsibleToolboxItem) {\n    super(categoryDef, toolbox, opt_parent);\n  }\n\n  override makeDefaultCssConfig_() {\n    const cssConfig = super.makeDefaultCssConfig_();\n    (cssConfig as AnyDuringMigration)['contents'] = 'blocklyToolboxContents';\n    return cssConfig;\n  }\n\n  override parseContents_(categoryDef: toolbox.CategoryInfo) {\n    // AnyDuringMigration because:  Element implicitly has an 'any' type because\n    // expression of type '\"contents\"' can't be used to index type\n    // 'CategoryInfo'.\n    const contents = (categoryDef as AnyDuringMigration)['contents'];\n    let prevIsFlyoutItem = true;\n\n    // AnyDuringMigration because:  Element implicitly has an 'any' type because\n    // expression of type '\"custom\"' can't be used to index type 'CategoryInfo'.\n    if ((categoryDef as AnyDuringMigration)['custom']) {\n      // AnyDuringMigration because:  Element implicitly has an 'any' type\n      // because expression of type '\"custom\"' can't be used to index type\n      // 'CategoryInfo'.\n      this.flyoutItems_ = (categoryDef as AnyDuringMigration)['custom'];\n    } else if (contents) {\n      for (let i = 0; i < contents.length; i++) {\n        const itemDef = contents[i];\n        // Separators can exist as either a flyout item or a toolbox item so\n        // decide where it goes based on the type of the previous item.\n        if (!registry.hasItem(registry.Type.TOOLBOX_ITEM, itemDef['kind']) ||\n            itemDef['kind'].toLowerCase() ===\n                    ToolboxSeparator.registrationName &&\n                prevIsFlyoutItem) {\n          const flyoutItem = itemDef as toolbox.FlyoutItemInfo;\n          this.flyoutItems_.push(flyoutItem);\n          prevIsFlyoutItem = true;\n        } else {\n          this.createToolboxItem_(itemDef);\n          prevIsFlyoutItem = false;\n        }\n      }\n    }\n  }\n\n  /**\n   * Creates a toolbox item and adds it to the list of toolbox items.\n   *\n   * @param itemDef The information needed to create a toolbox item.\n   */\n  private createToolboxItem_(itemDef: toolbox.ToolboxItemInfo) {\n    let registryName = itemDef['kind'];\n    const categoryDef = itemDef as toolbox.CategoryInfo;\n    // Categories that are collapsible are created using a class registered\n    // under a different name.\n    if (registryName.toUpperCase() == 'CATEGORY' &&\n        toolbox.isCategoryCollapsible(categoryDef)) {\n      registryName = CollapsibleToolboxCategory.registrationName;\n    }\n    const ToolboxItemClass =\n        registry.getClass(registry.Type.TOOLBOX_ITEM, registryName);\n    const toolboxItem =\n        new ToolboxItemClass!(itemDef, this.parentToolbox_, this);\n    this.toolboxItems_.push(toolboxItem);\n  }\n\n  override init() {\n    super.init();\n\n    this.setExpanded(\n        (this.toolboxItemDef_ as AnyDuringMigration)['expanded'] === 'true' ||\n        (this.toolboxItemDef_ as AnyDuringMigration)['expanded']);\n  }\n\n  override createDom_() {\n    super.createDom_();\n\n    const subCategories = this.getChildToolboxItems();\n    this.subcategoriesDiv_ = this.createSubCategoriesDom_(subCategories);\n    aria.setRole(this.subcategoriesDiv_, aria.Role.GROUP);\n    this.htmlDiv_!.appendChild(this.subcategoriesDiv_);\n\n    return this.htmlDiv_!;\n  }\n\n  override createIconDom_() {\n    const toolboxIcon = document.createElement('span');\n    if (!this.parentToolbox_.isHorizontal()) {\n      // AnyDuringMigration because:  Argument of type 'string | undefined' is\n      // not assignable to parameter of type 'string'.\n      dom.addClass(\n          toolboxIcon, (this.cssConfig_ as AnyDuringMigration)['icon']);\n      toolboxIcon.style.visibility = 'visible';\n    }\n\n    toolboxIcon.style.display = 'inline-block';\n    return toolboxIcon;\n  }\n\n  /**\n   * Create the DOM for all subcategories.\n   *\n   * @param subcategories The subcategories.\n   * @returns The div holding all the subcategories.\n   */\n  protected createSubCategoriesDom_(subcategories: IToolboxItem[]):\n      HTMLDivElement {\n    const contentsContainer = (document.createElement('div'));\n    dom.addClass(\n        contentsContainer, (this.cssConfig_ as AnyDuringMigration)['contents']);\n\n    for (let i = 0; i < subcategories.length; i++) {\n      const newCategory = subcategories[i];\n      newCategory.init();\n      const newCategoryDiv = newCategory.getDiv();\n      contentsContainer.appendChild(newCategoryDiv!);\n      if (newCategory.getClickTarget) {\n        newCategory.getClickTarget()?.setAttribute('id', newCategory.getId());\n      }\n    }\n    return contentsContainer;\n  }\n\n  /**\n   * Opens or closes the current category.\n   *\n   * @param isExpanded True to expand the category, false to close.\n   */\n  setExpanded(isExpanded: boolean) {\n    if (this.expanded_ === isExpanded) {\n      return;\n    }\n    this.expanded_ = isExpanded;\n    if (isExpanded) {\n      this.subcategoriesDiv_!.style.display = 'block';\n      this.openIcon_(this.iconDom_);\n    } else {\n      this.subcategoriesDiv_!.style.display = 'none';\n      this.closeIcon_(this.iconDom_);\n    }\n    aria.setState(\n        this.htmlDiv_ as HTMLDivElement, aria.State.EXPANDED, isExpanded);\n\n    this.parentToolbox_.handleToolboxItemResize();\n  }\n\n  override setVisible_(isVisible: boolean) {\n    this.htmlDiv_!.style.display = isVisible ? 'block' : 'none';\n    const childToolboxItems = this.getChildToolboxItems();\n    for (let i = 0; i < childToolboxItems.length; i++) {\n      const child = childToolboxItems[i];\n      child.setVisible_(isVisible);\n    }\n    this.isHidden_ = !isVisible;\n\n    if (this.parentToolbox_.getSelectedItem() === this) {\n      this.parentToolbox_.clearSelection();\n    }\n  }\n\n  /**\n   * Whether the category is expanded to show its child subcategories.\n   *\n   * @returns True if the toolbox item shows its children, false if it is\n   *     collapsed.\n   */\n  isExpanded(): boolean {\n    return this.expanded_;\n  }\n\n  override isCollapsible() {\n    return true;\n  }\n\n  override onClick(_e: Event) {\n    this.toggleExpanded();\n  }\n\n  /** Toggles whether or not the category is expanded. */\n  toggleExpanded() {\n    this.setExpanded(!this.expanded_);\n  }\n\n  override getDiv() {\n    return this.htmlDiv_;\n  }\n\n  /**\n   * Gets any children toolbox items. (ex. Gets the subcategories)\n   *\n   * @returns The child toolbox items.\n   */\n  getChildToolboxItems(): IToolboxItem[] {\n    return this.toolboxItems_;\n  }\n}\n\nexport namespace CollapsibleToolboxCategory {\n  /**\n   * All the CSS class names that are used to create a collapsible\n   * category. This is all the properties from the regular category plus\n   * contents.\n   */\n  export interface CssConfig {\n    container: string|null;\n    row: string|null;\n    rowcontentcontainer: string|null;\n    icon: string|null;\n    label: string|null;\n    selected: string|null;\n    openicon: string|null;\n    closedicon: string|null;\n    contents: string|null;\n  }\n}\n\nexport type CssConfig = CollapsibleToolboxCategory.CssConfig;\n\nregistry.register(\n    registry.Type.TOOLBOX_ITEM, CollapsibleToolboxCategory.registrationName,\n    CollapsibleToolboxCategory);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Toolbox from whence to create blocks.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Toolbox');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport '../events/events_toolbox_item_select.js';\n\nimport {BlockSvg} from '../block_svg.js';\nimport type {BlocklyOptions} from '../blockly_options.js';\nimport * as browserEvents from '../browser_events.js';\nimport * as common from '../common.js';\nimport {ComponentManager} from '../component_manager.js';\nimport * as Css from '../css.js';\nimport {DeleteArea} from '../delete_area.js';\nimport * as eventUtils from '../events/utils.js';\nimport type {IAutoHideable} from '../interfaces/i_autohideable.js';\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {IDraggable} from '../interfaces/i_draggable.js';\nimport type {IFlyout} from '../interfaces/i_flyout.js';\nimport type {IKeyboardAccessible} from '../interfaces/i_keyboard_accessible.js';\nimport type {ISelectableToolboxItem} from '../interfaces/i_selectable_toolbox_item.js';\nimport type {IStyleable} from '../interfaces/i_styleable.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport {Options} from '../options.js';\nimport * as registry from '../registry.js';\nimport type {KeyboardShortcut} from '../shortcut_registry.js';\nimport * as Touch from '../touch.js';\nimport * as aria from '../utils/aria.js';\nimport * as dom from '../utils/dom.js';\nimport {KeyCodes} from '../utils/keycodes.js';\nimport {Rect} from '../utils/rect.js';\nimport * as toolbox from '../utils/toolbox.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\nimport type {ToolboxCategory} from './category.js';\nimport {CollapsibleToolboxCategory} from './collapsible_category.js';\n\n\n/**\n * Class for a Toolbox.\n * Creates the toolbox's DOM.\n *\n * @alias Blockly.Toolbox\n */\nexport class Toolbox extends DeleteArea implements IAutoHideable,\n                                                   IKeyboardAccessible,\n                                                   IStyleable, IToolbox {\n  /**\n   * The unique id for this component that is used to register with the\n   * ComponentManager.\n   */\n  override id = 'toolbox';\n  protected toolboxDef_: toolbox.ToolboxInfo;\n  private readonly horizontalLayout_: boolean;\n\n  /** The html container for the toolbox. */\n  HtmlDiv: HTMLDivElement|null = null;\n\n  /** The html container for the contents of a toolbox. */\n  protected contentsDiv_: HTMLDivElement|null = null;\n\n  /** Whether the Toolbox is visible. */\n  protected isVisible_ = false;\n\n  /** The list of items in the toolbox. */\n  protected contents_: IToolboxItem[] = [];\n\n  /** The width of the toolbox. */\n  protected width_ = 0;\n\n  /** The height of the toolbox. */\n  protected height_ = 0;\n  RTL: boolean;\n\n  /** The flyout for the toolbox. */\n  private flyout_: IFlyout|null = null;\n  protected contentMap_: {[key: string]: IToolboxItem};\n  toolboxPosition: toolbox.Position;\n\n  /** The currently selected item. */\n  protected selectedItem_: ISelectableToolboxItem|null = null;\n\n  /** The previously selected item. */\n  protected previouslySelectedItem_: ISelectableToolboxItem|null = null;\n\n  /**\n   * Array holding info needed to unbind event handlers.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  protected boundEvents_: browserEvents.Data[] = [];\n  override wouldDelete_: AnyDuringMigration;\n\n  /** The workspace this toolbox is on. */\n  protected readonly workspace_: WorkspaceSvg;\n\n  /** @param workspace The workspace in which to create new blocks. */\n  constructor(workspace: WorkspaceSvg) {\n    super();\n\n    this.workspace_ = workspace;\n\n    /** The JSON describing the contents of this toolbox. */\n    // AnyDuringMigration because:  Type 'ToolboxInfo | { contents: never[]; }'\n    // is not assignable to type 'ToolboxInfo'.\n    this.toolboxDef_ = (workspace.options.languageTree || {'contents': []}) as\n        AnyDuringMigration;\n\n    /** Whether the toolbox should be laid out horizontally. */\n    this.horizontalLayout_ = workspace.options.horizontalLayout;\n\n    /** Is RTL vs LTR. */\n    this.RTL = workspace.options.RTL;\n\n    /** A map from toolbox item IDs to toolbox items. */\n    this.contentMap_ = Object.create(null);\n\n    /** Position of the toolbox and flyout relative to the workspace. */\n    this.toolboxPosition = workspace.options.toolboxPosition;\n  }\n\n  /**\n   * Handles the given keyboard shortcut.\n   *\n   * @param _shortcut The shortcut to be handled.\n   * @returns True if the shortcut has been handled, false otherwise.\n   */\n  onShortcut(_shortcut: KeyboardShortcut): boolean {\n    return false;\n  }\n\n  /** Initializes the toolbox */\n  init() {\n    const workspace = this.workspace_;\n    const svg = workspace.getParentSvg();\n\n    this.flyout_ = this.createFlyout_();\n\n    this.HtmlDiv = this.createDom_(this.workspace_);\n    dom.insertAfter(this.flyout_.createDom('svg'), svg);\n    this.setVisible(true);\n    this.flyout_.init(workspace);\n\n    this.render(this.toolboxDef_);\n    const themeManager = workspace.getThemeManager();\n    themeManager.subscribe(\n        this.HtmlDiv, 'toolboxBackgroundColour', 'background-color');\n    themeManager.subscribe(this.HtmlDiv, 'toolboxForegroundColour', 'color');\n    this.workspace_.getComponentManager().addComponent({\n      component: this,\n      weight: 1,\n      capabilities: [\n        ComponentManager.Capability.AUTOHIDEABLE,\n        ComponentManager.Capability.DELETE_AREA,\n        ComponentManager.Capability.DRAG_TARGET,\n      ],\n    });\n  }\n\n  /**\n   * Creates the DOM for the toolbox.\n   *\n   * @param workspace The workspace this toolbox is on.\n   * @returns The HTML container for the toolbox.\n   */\n  protected createDom_(workspace: WorkspaceSvg): HTMLDivElement {\n    const svg = workspace.getParentSvg();\n\n    const container = this.createContainer_();\n\n    this.contentsDiv_ = this.createContentsContainer_();\n    this.contentsDiv_.tabIndex = 0;\n    aria.setRole(this.contentsDiv_, aria.Role.TREE);\n    container.appendChild(this.contentsDiv_);\n\n    svg.parentNode!.insertBefore(container, svg);\n\n    this.attachEvents_(container, this.contentsDiv_);\n    return container;\n  }\n\n  /**\n   * Creates the container div for the toolbox.\n   *\n   * @returns The HTML container for the toolbox.\n   */\n  protected createContainer_(): HTMLDivElement {\n    const toolboxContainer = (document.createElement('div'));\n    toolboxContainer.setAttribute('layout', this.isHorizontal() ? 'h' : 'v');\n    dom.addClass(toolboxContainer, 'blocklyToolboxDiv');\n    dom.addClass(toolboxContainer, 'blocklyNonSelectable');\n    toolboxContainer.setAttribute('dir', this.RTL ? 'RTL' : 'LTR');\n    return toolboxContainer;\n  }\n\n  /**\n   * Creates the container for all the contents in the toolbox.\n   *\n   * @returns The HTML container for the toolbox contents.\n   */\n  protected createContentsContainer_(): HTMLDivElement {\n    const contentsContainer = (document.createElement('div'));\n    dom.addClass(contentsContainer, 'blocklyToolboxContents');\n    if (this.isHorizontal()) {\n      contentsContainer.style.flexDirection = 'row';\n    }\n    return contentsContainer;\n  }\n\n  /**\n   * Adds event listeners to the toolbox container div.\n   *\n   * @param container The HTML container for the toolbox.\n   * @param contentsContainer The HTML container for the contents of the\n   *     toolbox.\n   */\n  protected attachEvents_(\n      container: HTMLDivElement, contentsContainer: HTMLDivElement) {\n    // Clicking on toolbox closes popups.\n    const clickEvent = browserEvents.conditionalBind(\n        container, 'click', this, this.onClick_,\n        /* opt_noCaptureIdentifier */ false, /* opt_noPreventDefault */ true);\n    this.boundEvents_.push(clickEvent);\n\n    const keyDownEvent = browserEvents.conditionalBind(\n        contentsContainer, 'keydown', this, this.onKeyDown_,\n        /* opt_noCaptureIdentifier */ false, /* opt_noPreventDefault */ true);\n    this.boundEvents_.push(keyDownEvent);\n  }\n\n  /**\n   * Handles on click events for when the toolbox or toolbox items are clicked.\n   *\n   * @param e Click event to handle.\n   */\n  protected onClick_(e: MouseEvent) {\n    if (browserEvents.isRightButton(e) || e.target === this.HtmlDiv) {\n      // Close flyout.\n      (common.getMainWorkspace() as WorkspaceSvg).hideChaff(false);\n    } else {\n      const targetElement = e.target;\n      const itemId = (targetElement as Element).getAttribute('id');\n      if (itemId) {\n        const item = this.getToolboxItemById(itemId);\n        if (item!.isSelectable()) {\n          this.setSelectedItem(item);\n          (item as ISelectableToolboxItem).onClick(e);\n        }\n      }\n      // Just close popups.\n      (common.getMainWorkspace() as WorkspaceSvg).hideChaff(true);\n    }\n    Touch.clearTouchIdentifier();\n  }\n\n  /**\n   * Handles key down events for the toolbox.\n   *\n   * @param e The key down event.\n   */\n  protected onKeyDown_(e: KeyboardEvent) {\n    let handled = false;\n    switch (e.keyCode) {\n      case KeyCodes.DOWN:\n        handled = this.selectNext_();\n        break;\n      case KeyCodes.UP:\n        handled = this.selectPrevious_();\n        break;\n      case KeyCodes.LEFT:\n        handled = this.selectParent_();\n        break;\n      case KeyCodes.RIGHT:\n        handled = this.selectChild_();\n        break;\n      case KeyCodes.ENTER:\n      case KeyCodes.SPACE:\n        if (this.selectedItem_ && this.selectedItem_.isCollapsible()) {\n          const collapsibleItem = this.selectedItem_ as ICollapsibleToolboxItem;\n          collapsibleItem.toggleExpanded();\n          handled = true;\n        }\n        break;\n      default:\n        handled = false;\n        break;\n    }\n    if (!handled && this.selectedItem_) {\n      // TODO(#6097): Figure out who implements onKeyDown and which interface it\n      // should be part of.\n      const untypedItem = this.selectedItem_ as AnyDuringMigration;\n      if (untypedItem.onKeyDown) {\n        handled = untypedItem.onKeyDown(e);\n      }\n    }\n\n    if (handled) {\n      e.preventDefault();\n    }\n  }\n\n  /**\n   * Creates the flyout based on the toolbox layout.\n   *\n   * @returns The flyout for the toolbox.\n   * @throws {Error} If missing a require for `Blockly.HorizontalFlyout`,\n   *     `Blockly.VerticalFlyout`, and no flyout plugin is specified.\n   */\n  protected createFlyout_(): IFlyout {\n    const workspace = this.workspace_;\n    // TODO (#4247): Look into adding a makeFlyout method to Blockly Options.\n    const workspaceOptions = new Options(({\n      'parentWorkspace': workspace,\n      'rtl': workspace.RTL,\n      'oneBasedIndex': workspace.options.oneBasedIndex,\n      'horizontalLayout': workspace.horizontalLayout,\n      'renderer': workspace.options.renderer,\n      'rendererOverrides': workspace.options.rendererOverrides,\n      'move': {\n        'scrollbars': true,\n      },\n    } as BlocklyOptions));\n    // Options takes in either 'end' or 'start'. This has already been parsed to\n    // be either 0 or 1, so set it after.\n    workspaceOptions.toolboxPosition = workspace.options.toolboxPosition;\n    let FlyoutClass = null;\n    if (workspace.horizontalLayout) {\n      FlyoutClass = registry.getClassFromOptions(\n          registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX, workspace.options, true);\n    } else {\n      FlyoutClass = registry.getClassFromOptions(\n          registry.Type.FLYOUTS_VERTICAL_TOOLBOX, workspace.options, true);\n    }\n    return new FlyoutClass!(workspaceOptions);\n  }\n\n  /**\n   * Fills the toolbox with new toolbox items and removes any old contents.\n   *\n   * @param toolboxDef Object holding information for creating a toolbox.\n   * @internal\n   */\n  render(toolboxDef: toolbox.ToolboxInfo) {\n    this.toolboxDef_ = toolboxDef;\n    for (let i = 0; i < this.contents_.length; i++) {\n      const toolboxItem = this.contents_[i];\n      if (toolboxItem) {\n        toolboxItem.dispose();\n      }\n    }\n    this.contents_ = [];\n    this.contentMap_ = Object.create(null);\n    this.renderContents_(toolboxDef['contents']);\n    this.position();\n    this.handleToolboxItemResize();\n  }\n\n  /**\n   * Adds all the toolbox items to the toolbox.\n   *\n   * @param toolboxDef Array holding objects containing information on the\n   *     contents of the toolbox.\n   */\n  protected renderContents_(toolboxDef: toolbox.ToolboxItemInfo[]) {\n    // This is for performance reasons. By using document fragment we only have\n    // to add to the DOM once.\n    const fragment = document.createDocumentFragment();\n    for (let i = 0; i < toolboxDef.length; i++) {\n      const toolboxItemDef = toolboxDef[i];\n      this.createToolboxItem_(toolboxItemDef, fragment);\n    }\n    this.contentsDiv_!.appendChild(fragment);\n  }\n\n  /**\n   * Creates and renders the toolbox item.\n   *\n   * @param toolboxItemDef Any information that can be used to create an item in\n   *     the toolbox.\n   * @param fragment The document fragment to add the child toolbox elements to.\n   */\n  private createToolboxItem_(\n      toolboxItemDef: toolbox.ToolboxItemInfo, fragment: DocumentFragment) {\n    let registryName = toolboxItemDef['kind'];\n\n    // Categories that are collapsible are created using a class registered\n    // under a different name.\n    if (registryName.toUpperCase() === 'CATEGORY' &&\n        toolbox.isCategoryCollapsible(toolboxItemDef as toolbox.CategoryInfo)) {\n      registryName = CollapsibleToolboxCategory.registrationName;\n    }\n\n    const ToolboxItemClass = registry.getClass(\n        registry.Type.TOOLBOX_ITEM, registryName.toLowerCase());\n    if (ToolboxItemClass) {\n      const toolboxItem = new ToolboxItemClass(toolboxItemDef, this);\n      toolboxItem.init();\n      this.addToolboxItem_(toolboxItem);\n      const toolboxItemDom = toolboxItem.getDiv();\n      if (toolboxItemDom) {\n        fragment.appendChild(toolboxItemDom);\n      }\n      // Adds the ID to the HTML element that can receive a click.\n      // This is used in onClick_ to find the toolboxItem that was clicked.\n      if (toolboxItem.getClickTarget()) {\n        toolboxItem.getClickTarget()!.setAttribute('id', toolboxItem.getId());\n      }\n    }\n  }\n\n  /**\n   * Adds an item to the toolbox.\n   *\n   * @param toolboxItem The item in the toolbox.\n   */\n  protected addToolboxItem_(toolboxItem: IToolboxItem) {\n    this.contents_.push(toolboxItem);\n    this.contentMap_[toolboxItem.getId()] = toolboxItem;\n    if (toolboxItem.isCollapsible()) {\n      const collapsibleItem = toolboxItem as ICollapsibleToolboxItem;\n      const childToolboxItems = collapsibleItem.getChildToolboxItems();\n      for (let i = 0; i < childToolboxItems.length; i++) {\n        const child = childToolboxItems[i];\n        this.addToolboxItem_(child);\n      }\n    }\n  }\n\n  /**\n   * Gets the items in the toolbox.\n   *\n   * @returns The list of items in the toolbox.\n   */\n  getToolboxItems(): IToolboxItem[] {\n    return this.contents_;\n  }\n\n  /**\n   * Adds a style on the toolbox. Usually used to change the cursor.\n   *\n   * @param style The name of the class to add.\n   * @internal\n   */\n  addStyle(style: string) {\n    dom.addClass(this.HtmlDiv as Element, style);\n  }\n\n  /**\n   * Removes a style from the toolbox. Usually used to change the cursor.\n   *\n   * @param style The name of the class to remove.\n   * @internal\n   */\n  removeStyle(style: string) {\n    dom.removeClass(this.HtmlDiv as Element, style);\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect|null {\n    if (!this.HtmlDiv || !this.isVisible_) {\n      return null;\n    }\n    // BIG_NUM is offscreen padding so that blocks dragged beyond the toolbox\n    // area are still deleted.  Must be smaller than Infinity, but larger than\n    // the largest screen size.\n    const BIG_NUM = 10000000;\n    const toolboxRect = this.HtmlDiv.getBoundingClientRect();\n\n    const top = toolboxRect.top;\n    const bottom = top + toolboxRect.height;\n    const left = toolboxRect.left;\n    const right = left + toolboxRect.width;\n\n    // Assumes that the toolbox is on the SVG edge.  If this changes\n    // (e.g. toolboxes in mutators) then this code will need to be more complex.\n    if (this.toolboxPosition === toolbox.Position.TOP) {\n      return new Rect(-BIG_NUM, bottom, -BIG_NUM, BIG_NUM);\n    } else if (this.toolboxPosition === toolbox.Position.BOTTOM) {\n      return new Rect(top, BIG_NUM, -BIG_NUM, BIG_NUM);\n    } else if (this.toolboxPosition === toolbox.Position.LEFT) {\n      return new Rect(-BIG_NUM, BIG_NUM, -BIG_NUM, right);\n    } else {  // Right\n      return new Rect(-BIG_NUM, BIG_NUM, left, BIG_NUM);\n    }\n  }\n\n  /**\n   * Returns whether the provided block or bubble would be deleted if dropped on\n   * this area.\n   * This method should check if the element is deletable and is always called\n   * before onDragEnter/onDragOver/onDragExit.\n   *\n   * @param element The block or bubble currently being dragged.\n   * @param _couldConnect Whether the element could could connect to another.\n   * @returns Whether the element provided would be deleted if dropped on this\n   *     area.\n   */\n  override wouldDelete(element: IDraggable, _couldConnect: boolean): boolean {\n    if (element instanceof BlockSvg) {\n      const block = (element);\n      // Prefer dragging to the toolbox over connecting to other blocks.\n      this.updateWouldDelete_(!block.getParent() && block.isDeletable());\n    } else {\n      this.updateWouldDelete_(element.isDeletable());\n    }\n    return this.wouldDelete_;\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble enters this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragEnter(_dragElement: IDraggable) {\n    this.updateCursorDeleteStyle_(true);\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble exits this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragExit(_dragElement: IDraggable) {\n    this.updateCursorDeleteStyle_(false);\n  }\n\n  /**\n   * Handles when a block or bubble is dropped on this component.\n   * Should not handle delete here.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDrop(_dragElement: IDraggable) {\n    this.updateCursorDeleteStyle_(false);\n  }\n\n  /**\n   * Updates the internal wouldDelete_ state.\n   *\n   * @param wouldDelete The new value for the wouldDelete state.\n   */\n  protected override updateWouldDelete_(wouldDelete: boolean) {\n    if (wouldDelete === this.wouldDelete_) {\n      return;\n    }\n    // This logic handles updating the deleteStyle properly if the delete state\n    // changes while the block is over the Toolbox. This could happen if the\n    // implementation of wouldDeleteBlock depends on the couldConnect parameter\n    // or if the isDeletable property of the block currently being dragged\n    // changes during the drag.\n    this.updateCursorDeleteStyle_(false);\n    this.wouldDelete_ = wouldDelete;\n    this.updateCursorDeleteStyle_(true);\n  }\n\n  /**\n   * Adds or removes the CSS style of the cursor over the toolbox based whether\n   * the block or bubble over it is expected to be deleted if dropped (using the\n   * internal this.wouldDelete_ property).\n   *\n   * @param addStyle Whether the style should be added or removed.\n   */\n  protected updateCursorDeleteStyle_(addStyle: boolean) {\n    const style =\n        this.wouldDelete_ ? 'blocklyToolboxDelete' : 'blocklyToolboxGrab';\n    if (addStyle) {\n      this.addStyle(style);\n    } else {\n      this.removeStyle(style);\n    }\n  }\n\n  /**\n   * Gets the toolbox item with the given ID.\n   *\n   * @param id The ID of the toolbox item.\n   * @returns The toolbox item with the given ID, or null if no item exists.\n   */\n  getToolboxItemById(id: string): IToolboxItem|null {\n    return this.contentMap_[id] || null;\n  }\n\n  /**\n   * Gets the width of the toolbox.\n   *\n   * @returns The width of the toolbox.\n   */\n  getWidth(): number {\n    return this.width_;\n  }\n\n  /**\n   * Gets the height of the toolbox.\n   *\n   * @returns The width of the toolbox.\n   */\n  getHeight(): number {\n    return this.height_;\n  }\n\n  /**\n   * Gets the toolbox flyout.\n   *\n   * @returns The toolbox flyout.\n   */\n  getFlyout(): IFlyout|null {\n    return this.flyout_;\n  }\n\n  /**\n   * Gets the workspace for the toolbox.\n   *\n   * @returns The parent workspace for the toolbox.\n   */\n  getWorkspace(): WorkspaceSvg {\n    return this.workspace_;\n  }\n\n  /**\n   * Gets the selected item.\n   *\n   * @returns The selected item, or null if no item is currently selected.\n   */\n  getSelectedItem(): ISelectableToolboxItem|null {\n    return this.selectedItem_;\n  }\n\n  /**\n   * Gets the previously selected item.\n   *\n   * @returns The previously selected item, or null if no item was previously\n   *     selected.\n   */\n  getPreviouslySelectedItem(): ISelectableToolboxItem|null {\n    return this.previouslySelectedItem_;\n  }\n\n  /**\n   * Gets whether or not the toolbox is horizontal.\n   *\n   * @returns True if the toolbox is horizontal, false if the toolbox is\n   *     vertical.\n   */\n  isHorizontal(): boolean {\n    return this.horizontalLayout_;\n  }\n\n  /**\n   * Positions the toolbox based on whether it is a horizontal toolbox and\n   * whether the workspace is in rtl.\n   */\n  position() {\n    const workspaceMetrics = this.workspace_.getMetrics();\n    const toolboxDiv = this.HtmlDiv;\n    if (!toolboxDiv) {\n      // Not initialized yet.\n      return;\n    }\n\n    if (this.horizontalLayout_) {\n      toolboxDiv.style.left = '0';\n      toolboxDiv.style.height = 'auto';\n      toolboxDiv.style.width = '100%';\n      this.height_ = toolboxDiv.offsetHeight;\n      this.width_ = workspaceMetrics.viewWidth;\n      if (this.toolboxPosition === toolbox.Position.TOP) {\n        toolboxDiv.style.top = '0';\n      } else {  // Bottom\n        toolboxDiv.style.bottom = '0';\n      }\n    } else {\n      if (this.toolboxPosition === toolbox.Position.RIGHT) {\n        toolboxDiv.style.right = '0';\n      } else {  // Left\n        toolboxDiv.style.left = '0';\n      }\n      toolboxDiv.style.height = '100%';\n      this.width_ = toolboxDiv.offsetWidth;\n      this.height_ = workspaceMetrics.viewHeight;\n    }\n    this.flyout_!.position();\n  }\n\n  /**\n   * Handles resizing the toolbox when a toolbox item resizes.\n   *\n   * @internal\n   */\n  handleToolboxItemResize() {\n    // Reposition the workspace so that (0,0) is in the correct position\n    // relative to the new absolute edge (ie toolbox edge).\n    const workspace = this.workspace_;\n    const rect = this.HtmlDiv!.getBoundingClientRect();\n    const newX = this.toolboxPosition === toolbox.Position.LEFT ?\n        workspace.scrollX + rect.width :\n        workspace.scrollX;\n    const newY = this.toolboxPosition === toolbox.Position.TOP ?\n        workspace.scrollY + rect.height :\n        workspace.scrollY;\n    workspace.translate(newX, newY);\n\n    // Even though the div hasn't changed size, the visible workspace\n    // surface of the workspace has, so we may need to reposition everything.\n    common.svgResize(workspace);\n  }\n\n  /** Unhighlights any previously selected item. */\n  clearSelection() {\n    this.setSelectedItem(null);\n  }\n\n  /**\n   * Updates the category colours and background colour of selected categories.\n   *\n   * @internal\n   */\n  refreshTheme() {\n    for (let i = 0; i < this.contents_.length; i++) {\n      const child = this.contents_[i];\n      // TODO(#6097): Fix types or add refreshTheme to IToolboxItem.\n      const childAsCategory = child as ToolboxCategory;\n      if (childAsCategory.refreshTheme) {\n        childAsCategory.refreshTheme();\n      }\n    }\n  }\n\n  /**\n   * Updates the flyout's content without closing it.  Should be used in\n   * response to a change in one of the dynamic categories, such as variables or\n   * procedures.\n   */\n  refreshSelection() {\n    if (this.selectedItem_ && this.selectedItem_.isSelectable() &&\n        this.selectedItem_.getContents().length) {\n      this.flyout_!.show(this.selectedItem_.getContents());\n    }\n  }\n\n  /**\n   * Shows or hides the toolbox.\n   *\n   * @param isVisible True if toolbox should be visible.\n   */\n  setVisible(isVisible: boolean) {\n    if (this.isVisible_ === isVisible) {\n      return;\n    }\n\n    this.HtmlDiv!.style.display = isVisible ? 'block' : 'none';\n    this.isVisible_ = isVisible;\n    // Invisible toolbox is ignored as drag targets and must have the drag\n    // target updated.\n    this.workspace_.recordDragTargets();\n  }\n\n  /**\n   * Hides the component. Called in WorkspaceSvg.hideChaff.\n   *\n   * @param onlyClosePopups Whether only popups should be closed.\n   *     Flyouts should not be closed if this is true.\n   */\n  autoHide(onlyClosePopups: boolean) {\n    if (!onlyClosePopups && this.flyout_ && this.flyout_.autoClose) {\n      this.clearSelection();\n    }\n  }\n\n  /**\n   * Sets the given item as selected.\n   * No-op if the item is not selectable.\n   *\n   * @param newItem The toolbox item to select.\n   */\n  setSelectedItem(newItem: IToolboxItem|null) {\n    const oldItem = this.selectedItem_;\n\n    if (!newItem && !oldItem || newItem && !newItem.isSelectable()) {\n      return;\n    }\n    newItem = newItem as ISelectableToolboxItem;\n\n    // AnyDuringMigration because:  Argument of type 'IToolboxItem' is not\n    // assignable to parameter of type 'ISelectableToolboxItem'.\n    if (this.shouldDeselectItem_(oldItem, newItem as AnyDuringMigration) &&\n        oldItem !== null) {\n      this.deselectItem_(oldItem);\n    }\n\n    // AnyDuringMigration because:  Argument of type 'IToolboxItem' is not\n    // assignable to parameter of type 'ISelectableToolboxItem'.\n    if (this.shouldSelectItem_(oldItem, newItem as AnyDuringMigration) &&\n        newItem !== null) {\n      // AnyDuringMigration because:  Argument of type 'IToolboxItem' is not\n      // assignable to parameter of type 'ISelectableToolboxItem'.\n      this.selectItem_(oldItem, newItem as AnyDuringMigration);\n    }\n\n    // AnyDuringMigration because:  Argument of type 'IToolboxItem' is not\n    // assignable to parameter of type 'ISelectableToolboxItem'.\n    this.updateFlyout_(oldItem, newItem as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'IToolboxItem' is not\n    // assignable to parameter of type 'ISelectableToolboxItem'.\n    this.fireSelectEvent_(oldItem, newItem as AnyDuringMigration);\n  }\n\n  /**\n   * Decides whether the old item should be deselected.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   * @returns True if the old item should be deselected, false otherwise.\n   */\n  protected shouldDeselectItem_(\n      oldItem: ISelectableToolboxItem|null,\n      newItem: ISelectableToolboxItem|null): boolean {\n    // Deselect the old item unless the old item is collapsible and has been\n    // previously clicked on.\n    return oldItem !== null &&\n        (!oldItem.isCollapsible() || oldItem !== newItem);\n  }\n\n  /**\n   * Decides whether the new item should be selected.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   * @returns True if the new item should be selected, false otherwise.\n   */\n  protected shouldSelectItem_(\n      oldItem: ISelectableToolboxItem|null,\n      newItem: ISelectableToolboxItem|null): boolean {\n    // Select the new item unless the old item equals the new item.\n    return newItem !== null && newItem !== oldItem;\n  }\n\n  /**\n   * Deselects the given item, marks it as unselected, and updates aria state.\n   *\n   * @param item The previously selected toolbox item which should be\n   *     deselected.\n   */\n  protected deselectItem_(item: ISelectableToolboxItem) {\n    this.selectedItem_ = null;\n    this.previouslySelectedItem_ = item;\n    item.setSelected(false);\n    aria.setState(\n        this.contentsDiv_ as Element, aria.State.ACTIVEDESCENDANT, '');\n  }\n\n  /**\n   * Selects the given item, marks it selected, and updates aria state.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   */\n  protected selectItem_(\n      oldItem: ISelectableToolboxItem|null, newItem: ISelectableToolboxItem) {\n    this.selectedItem_ = newItem;\n    this.previouslySelectedItem_ = oldItem;\n    newItem.setSelected(true);\n    aria.setState(\n        this.contentsDiv_ as Element, aria.State.ACTIVEDESCENDANT,\n        newItem.getId());\n  }\n\n  /**\n   * Selects the toolbox item by its position in the list of toolbox items.\n   *\n   * @param position The position of the item to select.\n   */\n  selectItemByPosition(position: number) {\n    if (position > -1 && position < this.contents_.length) {\n      const item = this.contents_[position];\n      if (item.isSelectable()) {\n        this.setSelectedItem(item);\n      }\n    }\n  }\n\n  /**\n   * Decides whether to hide or show the flyout depending on the selected item.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   */\n  protected updateFlyout_(\n      oldItem: ISelectableToolboxItem|null,\n      newItem: ISelectableToolboxItem|null) {\n    if (!newItem || oldItem === newItem && !newItem.isCollapsible() ||\n        !newItem.getContents().length) {\n      this.flyout_!.hide();\n    } else {\n      this.flyout_!.show(newItem.getContents());\n      this.flyout_!.scrollToStart();\n    }\n  }\n\n  /**\n   * Emits an event when a new toolbox item is selected.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   */\n  private fireSelectEvent_(\n      oldItem: ISelectableToolboxItem|null,\n      newItem: ISelectableToolboxItem|null) {\n    const oldElement = oldItem && oldItem.getName();\n    let newElement = newItem && newItem.getName();\n    // In this case the toolbox closes, so the newElement should be null.\n    if (oldItem === newItem) {\n      newElement = null;\n    }\n    const event = new (eventUtils.get(eventUtils.TOOLBOX_ITEM_SELECT))(\n        oldElement, newElement, this.workspace_.id);\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Closes the current item if it is expanded, or selects the parent.\n   *\n   * @returns True if a parent category was selected, false otherwise.\n   */\n  private selectParent_(): boolean {\n    if (!this.selectedItem_) {\n      return false;\n    }\n\n    if (this.selectedItem_.isCollapsible() &&\n        (this.selectedItem_ as ICollapsibleToolboxItem).isExpanded()) {\n      const collapsibleItem = this.selectedItem_ as ICollapsibleToolboxItem;\n      collapsibleItem.toggleExpanded();\n      return true;\n    } else if (\n        this.selectedItem_.getParent() &&\n        this.selectedItem_.getParent()!.isSelectable()) {\n      this.setSelectedItem(this.selectedItem_.getParent());\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Selects the first child of the currently selected item, or nothing if the\n   * toolbox item has no children.\n   *\n   * @returns True if a child category was selected, false otherwise.\n   */\n  private selectChild_(): boolean {\n    if (!this.selectedItem_ || !this.selectedItem_.isCollapsible()) {\n      return false;\n    }\n    const collapsibleItem = this.selectedItem_ as ICollapsibleToolboxItem;\n    if (!collapsibleItem.isExpanded()) {\n      collapsibleItem.toggleExpanded();\n      return true;\n    } else {\n      this.selectNext_();\n      return true;\n    }\n  }\n\n  /**\n   * Selects the next visible toolbox item.\n   *\n   * @returns True if a next category was selected, false otherwise.\n   */\n  private selectNext_(): boolean {\n    if (!this.selectedItem_) {\n      return false;\n    }\n\n    let nextItemIdx = this.contents_.indexOf(this.selectedItem_) + 1;\n    if (nextItemIdx > -1 && nextItemIdx < this.contents_.length) {\n      let nextItem = this.contents_[nextItemIdx];\n      while (nextItem && !nextItem.isSelectable()) {\n        nextItem = this.contents_[++nextItemIdx];\n      }\n      if (nextItem && nextItem.isSelectable()) {\n        this.setSelectedItem(nextItem);\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Selects the previous visible toolbox item.\n   *\n   * @returns True if a previous category was selected, false otherwise.\n   */\n  private selectPrevious_(): boolean {\n    if (!this.selectedItem_) {\n      return false;\n    }\n\n    let prevItemIdx = this.contents_.indexOf(this.selectedItem_) - 1;\n    if (prevItemIdx > -1 && prevItemIdx < this.contents_.length) {\n      let prevItem = this.contents_[prevItemIdx];\n      while (prevItem && !prevItem.isSelectable()) {\n        prevItem = this.contents_[--prevItemIdx];\n      }\n      if (prevItem && prevItem.isSelectable()) {\n        this.setSelectedItem(prevItem);\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /** Disposes of this toolbox. */\n  dispose() {\n    this.workspace_.getComponentManager().removeComponent('toolbox');\n    this.flyout_!.dispose();\n    for (let i = 0; i < this.contents_.length; i++) {\n      const toolboxItem = this.contents_[i];\n      toolboxItem.dispose();\n    }\n\n    for (let j = 0; j < this.boundEvents_.length; j++) {\n      browserEvents.unbind(this.boundEvents_[j]);\n    }\n    this.boundEvents_ = [];\n    this.contents_ = [];\n\n    // AnyDuringMigration because:  Argument of type 'HTMLDivElement | null' is\n    // not assignable to parameter of type 'Element'.\n    this.workspace_.getThemeManager().unsubscribe(\n        this.HtmlDiv as AnyDuringMigration);\n    dom.removeNode(this.HtmlDiv);\n  }\n}\n\n/** CSS for Toolbox.  See css.js for use. */\nCss.register(`\n.blocklyToolboxDelete {\n  cursor: url(\"<<<PATH>>>/handdelete.cur\"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url(\"<<<PATH>>>/handclosed.cur\"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolboxDiv {\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxContents {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxContents:focus {\n  outline: none;\n}\n`);\n\nregistry.register(registry.Type.TOOLBOX, registry.DEFAULT, Toolbox);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Zelos theme.\n *\n * @namespace Blockly.Themes.Zelos\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Themes.Zelos');\n\nimport {Theme} from '../theme.js';\n\n\nconst defaultBlockStyles = {\n  'colour_blocks': {\n    'colourPrimary': '#CF63CF',\n    'colourSecondary': '#C94FC9',\n    'colourTertiary': '#BD42BD',\n  },\n  'list_blocks': {\n    'colourPrimary': '#9966FF',\n    'colourSecondary': '#855CD6',\n    'colourTertiary': '#774DCB',\n  },\n  'logic_blocks': {\n    'colourPrimary': '#4C97FF',\n    'colourSecondary': '#4280D7',\n    'colourTertiary': '#3373CC',\n  },\n  'loop_blocks': {\n    'colourPrimary': '#0fBD8C',\n    'colourSecondary': '#0DA57A',\n    'colourTertiary': '#0B8E69',\n  },\n  'math_blocks': {\n    'colourPrimary': '#59C059',\n    'colourSecondary': '#46B946',\n    'colourTertiary': '#389438',\n  },\n  'procedure_blocks': {\n    'colourPrimary': '#FF6680',\n    'colourSecondary': '#FF4D6A',\n    'colourTertiary': '#FF3355',\n  },\n  'text_blocks': {\n    'colourPrimary': '#FFBF00',\n    'colourSecondary': '#E6AC00',\n    'colourTertiary': '#CC9900',\n  },\n  'variable_blocks': {\n    'colourPrimary': '#FF8C1A',\n    'colourSecondary': '#FF8000',\n    'colourTertiary': '#DB6E00',\n  },\n  'variable_dynamic_blocks': {\n    'colourPrimary': '#FF8C1A',\n    'colourSecondary': '#FF8000',\n    'colourTertiary': '#DB6E00',\n  },\n  'hat_blocks': {\n    'colourPrimary': '#4C97FF',\n    'colourSecondary': '#4280D7',\n    'colourTertiary': '#3373CC',\n    'hat': 'cap',\n  },\n};\n\nconst categoryStyles = {\n  'colour_category': {'colour': '#CF63CF'},\n  'list_category': {'colour': '#9966FF'},\n  'logic_category': {'colour': '#4C97FF'},\n  'loop_category': {'colour': '#0fBD8C'},\n  'math_category': {'colour': '#59C059'},\n  'procedure_category': {'colour': '#FF6680'},\n  'text_category': {'colour': '#FFBF00'},\n  'variable_category': {'colour': '#FF8C1A'},\n  'variable_dynamic_category': {'colour': '#FF8C1A'},\n};\n\n/**\n * Zelos theme.\n *\n * @alias Blockly.Themes.Zelos\n */\nexport const Zelos = new Theme('zelos', defaultBlockStyles, categoryStyles);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Namespace for themes.\n *\n * @namespace Blockly.Themes\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Themes');\n\nimport {Classic} from './classic.js';\nimport {Zelos} from './zelos.js';\n\n\nexport {Classic, Zelos};\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of UI click in Blockly's editor.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.Click');\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a click event.\n *\n * @alias Blockly.Events.Click\n */\nexport class Click extends UiBase {\n  blockId: AnyDuringMigration;\n  targetType?: string;\n  override type: string;\n\n  /**\n   * @param opt_block The affected block. Null for click events that do not have\n   *     an associated block (i.e. workspace click). Undefined for a blank\n   *     event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Not used if block is passed. Undefined for a blank event.\n   * @param opt_targetType The type of element targeted by this click event.\n   *     Undefined for a blank event.\n   */\n  constructor(\n      opt_block?: Block|null, opt_workspaceId?: string|null,\n      opt_targetType?: string) {\n    let workspaceId = opt_block ? opt_block.workspace.id : opt_workspaceId;\n    if (workspaceId === null) {\n      workspaceId = undefined;\n    }\n    super(workspaceId);\n    this.blockId = opt_block ? opt_block.id : null;\n\n    /** The type of element targeted by this click event. */\n    this.targetType = opt_targetType;\n\n    /** Type of this event. */\n    this.type = eventUtils.CLICK;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['targetType'] = this.targetType;\n    if (this.blockId) {\n      json['blockId'] = this.blockId;\n    }\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.targetType = json['targetType'];\n    this.blockId = json['blockId'];\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.CLICK, Click);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for dragging a bubble visually.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.BubbleDragger');\n\nimport type {BlockDragSurfaceSvg} from './block_drag_surface.js';\nimport {ComponentManager} from './component_manager.js';\nimport type {CommentMove} from './events/events_comment_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IBubble} from './interfaces/i_bubble.js';\nimport type {IDeleteArea} from './interfaces/i_delete_area.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Class for a bubble dragger.  It moves things on the bubble canvas around the\n * workspace when they are being dragged by a mouse or touch.  These can be\n * block comments, mutators, warnings, or workspace comments.\n *\n * @alias Blockly.BubbleDragger\n */\nexport class BubbleDragger {\n  /** Which drag target the mouse pointer is over, if any. */\n  private dragTarget_: IDragTarget|null = null;\n\n  /** Whether the bubble would be deleted if dropped immediately. */\n  private wouldDeleteBubble_ = false;\n  private readonly startXY_: Coordinate;\n  private dragSurface_: BlockDragSurfaceSvg|null;\n\n  /**\n   * @param bubble The item on the bubble canvas to drag.\n   * @param workspace The workspace to drag on.\n   */\n  constructor(private bubble: IBubble, private workspace: WorkspaceSvg) {\n    /**\n     * The location of the top left corner of the dragging bubble's body at the\n     * beginning of the drag, in workspace coordinates.\n     */\n    this.startXY_ = this.bubble.getRelativeToSurfaceXY();\n\n    /**\n     * The drag surface to move bubbles to during a drag, or null if none should\n     * be used.  Block dragging and bubble dragging use the same surface.\n     */\n    this.dragSurface_ = workspace.getBlockDragSurface();\n  }\n\n  /**\n   * Start dragging a bubble.  This includes moving it to the drag surface.\n   *\n   * @internal\n   */\n  startBubbleDrag() {\n    if (!eventUtils.getGroup()) {\n      eventUtils.setGroup(true);\n    }\n\n    this.workspace.setResizesEnabled(false);\n    this.bubble.setAutoLayout(false);\n    if (this.dragSurface_) {\n      this.bubble.moveTo(0, 0);\n      this.dragSurface_.translateSurface(this.startXY_.x, this.startXY_.y);\n      // Execute the move on the top-level SVG component.\n      this.dragSurface_.setBlocksAndShow(this.bubble.getSvgRoot());\n    }\n\n    this.bubble.setDragging && this.bubble.setDragging(true);\n  }\n\n  /**\n   * Execute a step of bubble dragging, based on the given event.  Update the\n   * display accordingly.\n   *\n   * @param e The most recent move event.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   * @internal\n   */\n  dragBubble(e: Event, currentDragDeltaXY: Coordinate) {\n    const delta = this.pixelsToWorkspaceUnits_(currentDragDeltaXY);\n    const newLoc = Coordinate.sum(this.startXY_, delta);\n    this.bubble.moveDuringDrag(this.dragSurface_, newLoc);\n\n    const oldDragTarget = this.dragTarget_;\n    this.dragTarget_ = this.workspace.getDragTarget(e);\n\n    const oldWouldDeleteBubble = this.wouldDeleteBubble_;\n    this.wouldDeleteBubble_ = this.shouldDelete_(this.dragTarget_);\n    if (oldWouldDeleteBubble !== this.wouldDeleteBubble_) {\n      // Prevent unnecessary add/remove class calls.\n      this.updateCursorDuringBubbleDrag_();\n    }\n    // Call drag enter/exit/over after wouldDeleteBlock is called in\n    // shouldDelete_\n    if (this.dragTarget_ !== oldDragTarget) {\n      oldDragTarget && oldDragTarget.onDragExit(this.bubble);\n      this.dragTarget_ && this.dragTarget_.onDragEnter(this.bubble);\n    }\n    this.dragTarget_ && this.dragTarget_.onDragOver(this.bubble);\n  }\n\n  /**\n   * Whether ending the drag would delete the bubble.\n   *\n   * @param dragTarget The drag target that the bubblee is currently over.\n   * @returns Whether dropping the bubble immediately would delete the block.\n   */\n  private shouldDelete_(dragTarget: IDragTarget|null): boolean {\n    if (dragTarget) {\n      const componentManager = this.workspace.getComponentManager();\n      const isDeleteArea = componentManager.hasCapability(\n          dragTarget.id, ComponentManager.Capability.DELETE_AREA);\n      if (isDeleteArea) {\n        return (dragTarget as IDeleteArea).wouldDelete(this.bubble, false);\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Update the cursor (and possibly the trash can lid) to reflect whether the\n   * dragging bubble would be deleted if released immediately.\n   */\n  private updateCursorDuringBubbleDrag_() {\n    this.bubble.setDeleteStyle(this.wouldDeleteBubble_);\n  }\n\n  /**\n   * Finish a bubble drag and put the bubble back on the workspace.\n   *\n   * @param e The mouseup/touchend event.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   * @internal\n   */\n  endBubbleDrag(e: Event, currentDragDeltaXY: Coordinate) {\n    // Make sure internal state is fresh.\n    this.dragBubble(e, currentDragDeltaXY);\n\n    const preventMove =\n        this.dragTarget_ && this.dragTarget_.shouldPreventMove(this.bubble);\n    let newLoc;\n    if (preventMove) {\n      newLoc = this.startXY_;\n    } else {\n      const delta = this.pixelsToWorkspaceUnits_(currentDragDeltaXY);\n      newLoc = Coordinate.sum(this.startXY_, delta);\n    }\n    // Move the bubble to its final location.\n    this.bubble.moveTo(newLoc.x, newLoc.y);\n\n    if (this.dragTarget_) {\n      this.dragTarget_.onDrop(this.bubble);\n    }\n\n    if (this.wouldDeleteBubble_) {\n      // Fire a move event, so we know where to go back to for an undo.\n      this.fireMoveEvent_();\n      this.bubble.dispose();\n    } else {\n      // Put everything back onto the bubble canvas.\n      if (this.dragSurface_) {\n        this.dragSurface_.clearAndHide(this.workspace.getBubbleCanvas());\n      }\n      if (this.bubble.setDragging) {\n        this.bubble.setDragging(false);\n      }\n      this.fireMoveEvent_();\n    }\n    this.workspace.setResizesEnabled(true);\n\n    eventUtils.setGroup(false);\n  }\n\n  /** Fire a move event at the end of a bubble drag. */\n  private fireMoveEvent_() {\n    if (this.bubble instanceof WorkspaceCommentSvg) {\n      const event = new (eventUtils.get(eventUtils.COMMENT_MOVE))(\n                        this.bubble) as CommentMove;\n      event.setOldCoordinate(this.startXY_);\n      event.recordNew();\n      eventUtils.fire(event);\n    }\n    // TODO (fenichel): move events for comments.\n    return;\n  }\n\n  /**\n   * Convert a coordinate object from pixels to workspace units, including a\n   * correction for mutator workspaces.\n   * This function does not consider differing origins.  It simply scales the\n   * input's x and y values.\n   *\n   * @param pixelCoord A coordinate with x and y values in CSS pixel units.\n   * @returns The input coordinate divided by the workspace scale.\n   */\n  private pixelsToWorkspaceUnits_(pixelCoord: Coordinate): Coordinate {\n    const result = new Coordinate(\n        pixelCoord.x / this.workspace.scale,\n        pixelCoord.y / this.workspace.scale);\n    if (this.workspace.isMutator) {\n      // If we're in a mutator, its scale is always 1, purely because of some\n      // oddities in our rendering optimizations.  The actual scale is the same\n      // as the scale on the parent workspace. Fix that for dragging.\n      const mainScale = this.workspace.options.parentWorkspace!.scale;\n      result.scale(1 / mainScale);\n    }\n    return result;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for dragging a workspace visually.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.WorkspaceDragger');\n\nimport * as common from './common.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Class for a workspace dragger.  It moves the workspace around when it is\n * being dragged by a mouse or touch.\n * Note that the workspace itself manages whether or not it has a drag surface\n * and how to do translations based on that.  This simply passes the right\n * commands based on events.\n *\n * @alias Blockly.WorkspaceDragger\n */\nexport class WorkspaceDragger {\n  private readonly horizontalScrollEnabled_: boolean;\n  private readonly verticalScrollEnabled_: boolean;\n  protected startScrollXY_: Coordinate;\n\n  /** @param workspace The workspace to drag. */\n  constructor(private workspace: WorkspaceSvg) {\n    /** Whether horizontal scroll is enabled. */\n    this.horizontalScrollEnabled_ = this.workspace.isMovableHorizontally();\n\n    /** Whether vertical scroll is enabled. */\n    this.verticalScrollEnabled_ = this.workspace.isMovableVertically();\n\n    /**\n     * The scroll position of the workspace at the beginning of the drag.\n     * Coordinate system: pixel coordinates.\n     */\n    this.startScrollXY_ = new Coordinate(workspace.scrollX, workspace.scrollY);\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @suppress {checkTypes}\n   * @internal\n   */\n  dispose() {\n    // AnyDuringMigration because:  Type 'null' is not assignable to type\n    // 'WorkspaceSvg'.\n    this.workspace = null as AnyDuringMigration;\n  }\n\n  /**\n   * Start dragging the workspace.\n   *\n   * @internal\n   */\n  startDrag() {\n    if (common.getSelected()) {\n      common.getSelected()!.unselect();\n    }\n    this.workspace.setupDragSurface();\n  }\n\n  /**\n   * Finish dragging the workspace and put everything back where it belongs.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel coordinates.\n   * @internal\n   */\n  endDrag(currentDragDeltaXY: Coordinate) {\n    // Make sure everything is up to date.\n    this.drag(currentDragDeltaXY);\n    this.workspace.resetDragSurface();\n  }\n\n  /**\n   * Move the workspace based on the most recent mouse movements.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel coordinates.\n   * @internal\n   */\n  drag(currentDragDeltaXY: Coordinate) {\n    const newXY = Coordinate.sum(this.startScrollXY_, currentDragDeltaXY);\n\n    if (this.horizontalScrollEnabled_ && this.verticalScrollEnabled_) {\n      this.workspace.scroll(newXY.x, newXY.y);\n    } else if (this.horizontalScrollEnabled_) {\n      this.workspace.scroll(newXY.x, this.workspace.scrollY);\n    } else if (this.verticalScrollEnabled_) {\n      this.workspace.scroll(this.workspace.scrollX, newXY.y);\n    } else {\n      throw new TypeError('Invalid state.');\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing an in-progress gesture, usually a drag\n * or a tap.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Gesture');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_click.js';\n\nimport * as blockAnimations from './block_animations.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport {BubbleDragger} from './bubble_dragger.js';\nimport * as common from './common.js';\nimport {config} from './config.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Field} from './field.js';\nimport type {IBlockDragger} from './interfaces/i_block_dragger.js';\nimport type {IBubble} from './interfaces/i_bubble.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport * as internalConstants from './internal_constants.js';\nimport * as registry from './registry.js';\nimport * as Tooltip from './tooltip.js';\nimport * as Touch from './touch.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport {WorkspaceDragger} from './workspace_dragger.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Note: In this file \"start\" refers to touchstart, mousedown, and pointerstart\n * events.  \"End\" refers to touchend, mouseup, and pointerend events.\n */\n// TODO: Consider touchcancel/pointercancel.\n/**\n * Class for one gesture.\n *\n * @alias Blockly.Gesture\n */\nexport class Gesture {\n  /**\n   * The position of the mouse when the gesture started.  Units are CSS\n   * pixels, with (0, 0) at the top left of the browser window (mouseEvent\n   * clientX/Y).\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'Coordinate'.\n  private mouseDownXY_: Coordinate = null as AnyDuringMigration;\n  private currentDragDeltaXY_: Coordinate;\n\n  /**\n   * The bubble that the gesture started on, or null if it did not start on a\n   * bubble.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'IBubble'.\n  private startBubble_: IBubble = null as AnyDuringMigration;\n\n  /**\n   * The field that the gesture started on, or null if it did not start on a\n   * field.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type 'Field'.\n  private startField_: Field = null as AnyDuringMigration;\n\n  /**\n   * The block that the gesture started on, or null if it did not start on a\n   * block.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'BlockSvg'.\n  private startBlock_: BlockSvg = null as AnyDuringMigration;\n\n  /**\n   * The block that this gesture targets.  If the gesture started on a\n   * shadow block, this is the first non-shadow parent of the block.  If the\n   * gesture started in the flyout, this is the root block of the block group\n   * that was clicked or dragged.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'BlockSvg'.\n  private targetBlock_: BlockSvg = null as AnyDuringMigration;\n\n  /**\n   * The workspace that the gesture started on.  There may be multiple\n   * workspaces on a page; this is more accurate than using\n   * Blockly.common.getMainWorkspace().\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'WorkspaceSvg'.\n  protected startWorkspace_: WorkspaceSvg = null as AnyDuringMigration;\n\n  /**\n   * Whether the pointer has at any point moved out of the drag radius.\n   * A gesture that exceeds the drag radius is a drag even if it ends exactly\n   * at its start point.\n   */\n  private hasExceededDragRadius_ = false;\n\n  /** Whether the workspace is currently being dragged. */\n  private isDraggingWorkspace_ = false;\n\n  /** Whether the block is currently being dragged. */\n  private isDraggingBlock_ = false;\n\n  /** Whether the bubble is currently being dragged. */\n  private isDraggingBubble_ = false;\n\n  /**\n   * A handle to use to unbind a mouse move listener at the end of a drag.\n   * Opaque data returned from Blockly.bindEventWithChecks_.\n   */\n  protected onMoveWrapper_: browserEvents.Data|null = null;\n\n  /**\n   * A handle to use to unbind a mouse up listener at the end of a drag.\n   * Opaque data returned from Blockly.bindEventWithChecks_.\n   */\n  protected onUpWrapper_: browserEvents.Data|null = null;\n\n  /** The object tracking a bubble drag, or null if none is in progress. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'BubbleDragger'.\n  private bubbleDragger_: BubbleDragger = null as AnyDuringMigration;\n\n  /** The object tracking a block drag, or null if none is in progress. */\n  private blockDragger_: IBlockDragger|null = null;\n\n  /**\n   * The object tracking a workspace or flyout workspace drag, or null if none\n   * is in progress.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'WorkspaceDragger'.\n  private workspaceDragger_: WorkspaceDragger = null as AnyDuringMigration;\n\n  /** The flyout a gesture started in, if any. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'IFlyout'.\n  private flyout_: IFlyout = null as AnyDuringMigration;\n\n  /** Boolean for sanity-checking that some code is only called once. */\n  private calledUpdateIsDragging_ = false;\n\n  /** Boolean for sanity-checking that some code is only called once. */\n  private hasStarted_ = false;\n\n  /** Boolean used internally to break a cycle in disposal. */\n  protected isEnding_ = false;\n  private healStack_: boolean;\n\n  /** The event that most recently updated this gesture. */\n  private mostRecentEvent_: Event;\n\n  /**\n   * @param e The event that kicked off this gesture.\n   * @param creatorWorkspace The workspace that created this gesture and has a\n   *     reference to it.\n   */\n  constructor(e: Event, private readonly creatorWorkspace: WorkspaceSvg) {\n    this.mostRecentEvent_ = e;\n\n    /**\n     * How far the mouse has moved during this drag, in pixel units.\n     * (0, 0) is at this.mouseDownXY_.\n     */\n    this.currentDragDeltaXY_ = new Coordinate(0, 0);\n\n    /**\n     * Boolean used to indicate whether or not to heal the stack after\n     * disconnecting a block.\n     */\n    this.healStack_ = !internalConstants.DRAG_STACK;\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @internal\n   */\n  dispose() {\n    Touch.clearTouchIdentifier();\n    Tooltip.unblock();\n    // Clear the owner's reference to this gesture.\n    this.creatorWorkspace.clearGesture();\n\n    if (this.onMoveWrapper_) {\n      browserEvents.unbind(this.onMoveWrapper_);\n    }\n    if (this.onUpWrapper_) {\n      browserEvents.unbind(this.onUpWrapper_);\n    }\n\n    if (this.blockDragger_) {\n      this.blockDragger_.dispose();\n    }\n    if (this.workspaceDragger_) {\n      this.workspaceDragger_.dispose();\n    }\n  }\n\n  /**\n   * Update internal state based on an event.\n   *\n   * @param e The most recent mouse or touch event.\n   */\n  private updateFromEvent_(e: Event) {\n    // AnyDuringMigration because:  Property 'clientY' does not exist on type\n    // 'Event'. AnyDuringMigration because:  Property 'clientX' does not exist\n    // on type 'Event'.\n    const currentXY = new Coordinate(\n        (e as AnyDuringMigration).clientX, (e as AnyDuringMigration).clientY);\n    const changed = this.updateDragDelta_(currentXY);\n    // Exceeded the drag radius for the first time.\n    if (changed) {\n      this.updateIsDragging_();\n      Touch.longStop();\n    }\n    this.mostRecentEvent_ = e;\n  }\n\n  /**\n   * DO MATH to set currentDragDeltaXY_ based on the most recent mouse position.\n   *\n   * @param currentXY The most recent mouse/pointer position, in pixel units,\n   *     with (0, 0) at the window's top left corner.\n   * @returns True if the drag just exceeded the drag radius for the first time.\n   */\n  private updateDragDelta_(currentXY: Coordinate): boolean {\n    this.currentDragDeltaXY_ =\n        Coordinate.difference(currentXY, (this.mouseDownXY_));\n\n    if (!this.hasExceededDragRadius_) {\n      const currentDragDelta = Coordinate.magnitude(this.currentDragDeltaXY_);\n\n      // The flyout has a different drag radius from the rest of Blockly.\n      const limitRadius =\n          this.flyout_ ? config.flyoutDragRadius : config.dragRadius;\n\n      this.hasExceededDragRadius_ = currentDragDelta > limitRadius;\n      return this.hasExceededDragRadius_;\n    }\n    return false;\n  }\n\n  /**\n   * Update this gesture to record whether a block is being dragged from the\n   * flyout.\n   * This function should be called on a mouse/touch move event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture. If a block should be dragged from the flyout this function creates\n   * the new block on the main workspace and updates targetBlock_ and\n   * startWorkspace_.\n   *\n   * @returns True if a block is being dragged from the flyout.\n   */\n  private updateIsDraggingFromFlyout_(): boolean {\n    if (!this.targetBlock_) {\n      return false;\n    }\n    if (!this.flyout_.isBlockCreatable(this.targetBlock_)) {\n      return false;\n    }\n    if (!this.flyout_.isScrollable() ||\n        this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)) {\n      // AnyDuringMigration because:  Type 'WorkspaceSvg | null' is not\n      // assignable to type 'WorkspaceSvg'.\n      this.startWorkspace_ = this.flyout_.targetWorkspace as AnyDuringMigration;\n      this.startWorkspace_.updateScreenCalculationsIfScrolled();\n      // Start the event group now, so that the same event group is used for\n      // block creation and block dragging.\n      if (!eventUtils.getGroup()) {\n        eventUtils.setGroup(true);\n      }\n      // The start block is no longer relevant, because this is a drag.\n      // AnyDuringMigration because:  Type 'null' is not assignable to type\n      // 'BlockSvg'.\n      this.startBlock_ = null as AnyDuringMigration;\n      this.targetBlock_ = this.flyout_.createBlock(this.targetBlock_);\n      this.targetBlock_.select();\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Update this gesture to record whether a bubble is being dragged.\n   * This function should be called on a mouse/touch move event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture. If a bubble should be dragged this function creates the necessary\n   * BubbleDragger and starts the drag.\n   *\n   * @returns True if a bubble is being dragged.\n   */\n  private updateIsDraggingBubble_(): boolean {\n    if (!this.startBubble_) {\n      return false;\n    }\n\n    this.isDraggingBubble_ = true;\n    this.startDraggingBubble_();\n    return true;\n  }\n\n  /**\n   * Update this gesture to record whether a block is being dragged.\n   * This function should be called on a mouse/touch move event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture. If a block should be dragged, either from the flyout or in the\n   * workspace, this function creates the necessary BlockDragger and starts the\n   * drag.\n   *\n   * @returns True if a block is being dragged.\n   */\n  private updateIsDraggingBlock_(): boolean {\n    if (!this.targetBlock_) {\n      return false;\n    }\n\n    if (this.flyout_) {\n      this.isDraggingBlock_ = this.updateIsDraggingFromFlyout_();\n    } else if (this.targetBlock_.isMovable()) {\n      this.isDraggingBlock_ = true;\n    }\n\n    if (this.isDraggingBlock_) {\n      this.startDraggingBlock_();\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Update this gesture to record whether a workspace is being dragged.\n   * This function should be called on a mouse/touch move event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture. If a workspace is being dragged this function creates the\n   * necessary WorkspaceDragger and starts the drag.\n   */\n  private updateIsDraggingWorkspace_() {\n    const wsMovable = this.flyout_ ?\n        this.flyout_.isScrollable() :\n        this.startWorkspace_ && this.startWorkspace_.isDraggable();\n\n    if (!wsMovable) {\n      return;\n    }\n\n    this.workspaceDragger_ = new WorkspaceDragger((this.startWorkspace_));\n\n    this.isDraggingWorkspace_ = true;\n    this.workspaceDragger_.startDrag();\n  }\n\n  /**\n   * Update this gesture to record whether anything is being dragged.\n   * This function should be called on a mouse/touch move event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture.\n   */\n  private updateIsDragging_() {\n    // Sanity check.\n    if (this.calledUpdateIsDragging_) {\n      throw Error('updateIsDragging_ should only be called once per gesture.');\n    }\n    this.calledUpdateIsDragging_ = true;\n\n    // First check if it was a bubble drag.  Bubbles always sit on top of\n    // blocks.\n    if (this.updateIsDraggingBubble_()) {\n      return;\n    }\n    // Then check if it was a block drag.\n    if (this.updateIsDraggingBlock_()) {\n      return;\n    }\n    // Then check if it's a workspace drag.\n    this.updateIsDraggingWorkspace_();\n  }\n\n  /** Create a block dragger and start dragging the selected block. */\n  private startDraggingBlock_() {\n    const BlockDraggerClass = registry.getClassFromOptions(\n        registry.Type.BLOCK_DRAGGER, this.creatorWorkspace.options, true);\n\n    this.blockDragger_ =\n        new BlockDraggerClass!((this.targetBlock_), (this.startWorkspace_));\n    this.blockDragger_!.startDrag(this.currentDragDeltaXY_, this.healStack_);\n    this.blockDragger_!.drag(this.mostRecentEvent_, this.currentDragDeltaXY_);\n  }\n\n  // TODO (fenichel): Possibly combine this and startDraggingBlock_.\n  /** Create a bubble dragger and start dragging the selected bubble. */\n  private startDraggingBubble_() {\n    this.bubbleDragger_ =\n        new BubbleDragger((this.startBubble_), (this.startWorkspace_));\n    this.bubbleDragger_.startBubbleDrag();\n    this.bubbleDragger_.dragBubble(\n        this.mostRecentEvent_, this.currentDragDeltaXY_);\n  }\n\n  /**\n   * Start a gesture: update the workspace to indicate that a gesture is in\n   * progress and bind mousemove and mouseup handlers.\n   *\n   * @param e A mouse down or touch start event.\n   * @internal\n   */\n  doStart(e: MouseEvent) {\n    if (browserEvents.isTargetInput(e)) {\n      this.cancel();\n      return;\n    }\n    this.hasStarted_ = true;\n\n    blockAnimations.disconnectUiStop();\n    this.startWorkspace_.updateScreenCalculationsIfScrolled();\n    if (this.startWorkspace_.isMutator) {\n      // Mutator's coordinate system could be out of date because the bubble was\n      // dragged, the block was moved, the parent workspace zoomed, etc.\n      this.startWorkspace_.resize();\n    }\n    // Hide chaff also hides the flyout, so don't do it if the click is in a\n    // flyout.\n    this.startWorkspace_.hideChaff(!!this.flyout_);\n\n    this.startWorkspace_.markFocused();\n    this.mostRecentEvent_ = e;\n\n    Tooltip.block();\n\n    if (this.targetBlock_) {\n      this.targetBlock_.select();\n    }\n\n    if (browserEvents.isRightButton(e)) {\n      this.handleRightClick(e);\n      return;\n    }\n\n    // TODO(#6097): Make types accurate, possibly by refactoring touch handling.\n    const typelessEvent = e as AnyDuringMigration;\n    if ((e.type.toLowerCase() === 'touchstart' ||\n         e.type.toLowerCase() === 'pointerdown') &&\n        typelessEvent.pointerType !== 'mouse') {\n      Touch.longStart(typelessEvent, this);\n    }\n\n    // AnyDuringMigration because:  Property 'clientY' does not exist on type\n    // 'Event'. AnyDuringMigration because:  Property 'clientX' does not exist\n    // on type 'Event'.\n    this.mouseDownXY_ = new Coordinate(\n        (e as AnyDuringMigration).clientX, (e as AnyDuringMigration).clientY);\n    // AnyDuringMigration because:  Property 'metaKey' does not exist on type\n    // 'Event'. AnyDuringMigration because:  Property 'ctrlKey' does not exist\n    // on type 'Event'. AnyDuringMigration because:  Property 'altKey' does not\n    // exist on type 'Event'.\n    this.healStack_ = (e as AnyDuringMigration).altKey ||\n        (e as AnyDuringMigration).ctrlKey || (e as AnyDuringMigration).metaKey;\n\n    this.bindMouseEvents(e);\n  }\n\n  /**\n   * Bind gesture events.\n   *\n   * @param e A mouse down or touch start event.\n   * @internal\n   */\n  bindMouseEvents(e: Event) {\n    this.onMoveWrapper_ = browserEvents.conditionalBind(\n        document, 'mousemove', null, this.handleMove.bind(this));\n    this.onUpWrapper_ = browserEvents.conditionalBind(\n        document, 'mouseup', null, this.handleUp.bind(this));\n\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  /**\n   * Handle a mouse move or touch move event.\n   *\n   * @param e A mouse move or touch move event.\n   * @internal\n   */\n  handleMove(e: Event) {\n    this.updateFromEvent_(e);\n    if (this.isDraggingWorkspace_) {\n      this.workspaceDragger_.drag(this.currentDragDeltaXY_);\n    } else if (this.isDraggingBlock_) {\n      this.blockDragger_!.drag(this.mostRecentEvent_, this.currentDragDeltaXY_);\n    } else if (this.isDraggingBubble_) {\n      this.bubbleDragger_.dragBubble(\n          this.mostRecentEvent_, this.currentDragDeltaXY_);\n    }\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  /**\n   * Handle a mouse up or touch end event.\n   *\n   * @param e A mouse up or touch end event.\n   * @internal\n   */\n  handleUp(e: Event) {\n    this.updateFromEvent_(e);\n    Touch.longStop();\n\n    if (this.isEnding_) {\n      console.log('Trying to end a gesture recursively.');\n      return;\n    }\n    this.isEnding_ = true;\n    // The ordering of these checks is important: drags have higher priority\n    // than clicks.  Fields have higher priority than blocks; blocks have higher\n    // priority than workspaces.\n    // The ordering within drags does not matter, because the three types of\n    // dragging are exclusive.\n    if (this.isDraggingBubble_) {\n      this.bubbleDragger_.endBubbleDrag(e, this.currentDragDeltaXY_);\n    } else if (this.isDraggingBlock_) {\n      this.blockDragger_!.endDrag(e, this.currentDragDeltaXY_);\n    } else if (this.isDraggingWorkspace_) {\n      this.workspaceDragger_.endDrag(this.currentDragDeltaXY_);\n    } else if (this.isBubbleClick_()) {\n      // Bubbles are in front of all fields and blocks.\n      this.doBubbleClick_();\n    } else if (this.isFieldClick_()) {\n      this.doFieldClick_();\n    } else if (this.isBlockClick_()) {\n      this.doBlockClick_();\n    } else if (this.isWorkspaceClick_()) {\n      this.doWorkspaceClick_(e);\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.dispose();\n  }\n\n  /**\n   * Cancel an in-progress gesture.  If a workspace or block drag is in\n   * progress, end the drag at the most recent location.\n   *\n   * @internal\n   */\n  cancel() {\n    // Disposing of a block cancels in-progress drags, but dragging to a delete\n    // area disposes of a block and leads to recursive disposal. Break that\n    // cycle.\n    if (this.isEnding_) {\n      return;\n    }\n    Touch.longStop();\n    if (this.isDraggingBubble_) {\n      this.bubbleDragger_.endBubbleDrag(\n          this.mostRecentEvent_, this.currentDragDeltaXY_);\n    } else if (this.isDraggingBlock_) {\n      this.blockDragger_!.endDrag(\n          this.mostRecentEvent_, this.currentDragDeltaXY_);\n    } else if (this.isDraggingWorkspace_) {\n      this.workspaceDragger_.endDrag(this.currentDragDeltaXY_);\n    }\n    this.dispose();\n  }\n\n  /**\n   * Handle a real or faked right-click event by showing a context menu.\n   *\n   * @param e A mouse move or touch move event.\n   * @internal\n   */\n  handleRightClick(e: Event) {\n    if (this.targetBlock_) {\n      this.bringBlockToFront_();\n      this.targetBlock_.workspace.hideChaff(!!this.flyout_);\n      this.targetBlock_.showContextMenu(e);\n    } else if (this.startBubble_) {\n      this.startBubble_.showContextMenu(e);\n    } else if (this.startWorkspace_ && !this.flyout_) {\n      this.startWorkspace_.hideChaff();\n      this.startWorkspace_.showContextMenu(e);\n    }\n\n    // TODO: Handle right-click on a bubble.\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.dispose();\n  }\n\n  /**\n   * Handle a mousedown/touchstart event on a workspace.\n   *\n   * @param e A mouse down or touch start event.\n   * @param ws The workspace the event hit.\n   * @internal\n   */\n  handleWsStart(e: MouseEvent, ws: WorkspaceSvg) {\n    if (this.hasStarted_) {\n      throw Error(\n          'Tried to call gesture.handleWsStart, ' +\n          'but the gesture had already been started.');\n    }\n    this.setStartWorkspace_(ws);\n    this.mostRecentEvent_ = e;\n    this.doStart(e);\n  }\n\n  /**\n   * Fires a workspace click event.\n   *\n   * @param ws The workspace that a user clicks on.\n   */\n  private fireWorkspaceClick_(ws: WorkspaceSvg) {\n    eventUtils.fire(\n        new (eventUtils.get(eventUtils.CLICK))(null, ws.id, 'workspace'));\n  }\n\n  /**\n   * Handle a mousedown/touchstart event on a flyout.\n   *\n   * @param e A mouse down or touch start event.\n   * @param flyout The flyout the event hit.\n   * @internal\n   */\n  handleFlyoutStart(e: MouseEvent, flyout: IFlyout) {\n    if (this.hasStarted_) {\n      throw Error(\n          'Tried to call gesture.handleFlyoutStart, ' +\n          'but the gesture had already been started.');\n    }\n    this.setStartFlyout_(flyout);\n    this.handleWsStart(e, flyout.getWorkspace());\n  }\n\n  /**\n   * Handle a mousedown/touchstart event on a block.\n   *\n   * @param e A mouse down or touch start event.\n   * @param block The block the event hit.\n   * @internal\n   */\n  handleBlockStart(e: Event, block: BlockSvg) {\n    if (this.hasStarted_) {\n      throw Error(\n          'Tried to call gesture.handleBlockStart, ' +\n          'but the gesture had already been started.');\n    }\n    this.setStartBlock(block);\n    this.mostRecentEvent_ = e;\n  }\n\n  /**\n   * Handle a mousedown/touchstart event on a bubble.\n   *\n   * @param e A mouse down or touch start event.\n   * @param bubble The bubble the event hit.\n   * @internal\n   */\n  handleBubbleStart(e: Event, bubble: IBubble) {\n    if (this.hasStarted_) {\n      throw Error(\n          'Tried to call gesture.handleBubbleStart, ' +\n          'but the gesture had already been started.');\n    }\n    this.setStartBubble(bubble);\n    this.mostRecentEvent_ = e;\n  }\n\n  /* Begin functions defining what actions to take to execute clicks on each\n   * type of target.  Any developer wanting to add behaviour on clicks should\n   * modify only this code. */\n\n  /** Execute a bubble click. */\n  private doBubbleClick_() {\n    // TODO (#1673): Consistent handling of single clicks.\n    if (this.startBubble_ instanceof WorkspaceCommentSvg) {\n      this.startBubble_.setFocus();\n      this.startBubble_.select();\n    }\n  }\n\n  /** Execute a field click. */\n  private doFieldClick_() {\n    this.startField_.showEditor(this.mostRecentEvent_);\n    this.bringBlockToFront_();\n  }\n\n  /** Execute a block click. */\n  private doBlockClick_() {\n    // Block click in an autoclosing flyout.\n    if (this.flyout_ && this.flyout_.autoClose) {\n      if (this.targetBlock_.isEnabled()) {\n        if (!eventUtils.getGroup()) {\n          eventUtils.setGroup(true);\n        }\n        const newBlock = this.flyout_.createBlock(this.targetBlock_);\n        newBlock.scheduleSnapAndBump();\n      }\n    } else {\n      // Clicks events are on the start block, even if it was a shadow.\n      const event = new (eventUtils.get(eventUtils.CLICK))(\n          this.startBlock_, this.startWorkspace_.id, 'block');\n      eventUtils.fire(event);\n    }\n    this.bringBlockToFront_();\n    eventUtils.setGroup(false);\n  }\n\n  /**\n   * Execute a workspace click. When in accessibility mode shift clicking will\n   * move the cursor.\n   *\n   * @param _e A mouse up or touch end event.\n   */\n  private doWorkspaceClick_(_e: Event) {\n    const ws = this.creatorWorkspace;\n    if (common.getSelected()) {\n      common.getSelected()!.unselect();\n    }\n    this.fireWorkspaceClick_(this.startWorkspace_ || ws);\n  }\n\n  /* End functions defining what actions to take to execute clicks on each type\n   * of target. */\n\n  // TODO (fenichel): Move bubbles to the front.\n\n  /**\n   * Move the dragged/clicked block to the front of the workspace so that it is\n   * not occluded by other blocks.\n   */\n  private bringBlockToFront_() {\n    // Blocks in the flyout don't overlap, so skip the work.\n    if (this.targetBlock_ && !this.flyout_) {\n      this.targetBlock_.bringToFront();\n    }\n  }\n\n  /* Begin functions for populating a gesture at mouse down. */\n\n  /**\n   * Record the field that a gesture started on.\n   *\n   * @param field The field the gesture started on.\n   * @internal\n   */\n  setStartField(field: Field) {\n    if (this.hasStarted_) {\n      throw Error(\n          'Tried to call gesture.setStartField, ' +\n          'but the gesture had already been started.');\n    }\n    if (!this.startField_) {\n      this.startField_ = field;\n    }\n  }\n\n  /**\n   * Record the bubble that a gesture started on\n   *\n   * @param bubble The bubble the gesture started on.\n   * @internal\n   */\n  setStartBubble(bubble: IBubble) {\n    if (!this.startBubble_) {\n      this.startBubble_ = bubble;\n    }\n  }\n\n  /**\n   * Record the block that a gesture started on, and set the target block\n   * appropriately.\n   *\n   * @param block The block the gesture started on.\n   * @internal\n   */\n  setStartBlock(block: BlockSvg) {\n    // If the gesture already went through a bubble, don't set the start block.\n    if (!this.startBlock_ && !this.startBubble_) {\n      this.startBlock_ = block;\n      if (block.isInFlyout && block !== block.getRootBlock()) {\n        this.setTargetBlock_(block.getRootBlock());\n      } else {\n        this.setTargetBlock_(block);\n      }\n    }\n  }\n\n  /**\n   * Record the block that a gesture targets, meaning the block that will be\n   * dragged if this turns into a drag.  If this block is a shadow, that will be\n   * its first non-shadow parent.\n   *\n   * @param block The block the gesture targets.\n   */\n  private setTargetBlock_(block: BlockSvg) {\n    if (block.isShadow()) {\n      // AnyDuringMigration because:  Argument of type 'BlockSvg | null' is not\n      // assignable to parameter of type 'BlockSvg'.\n      this.setTargetBlock_(block.getParent() as AnyDuringMigration);\n    } else {\n      this.targetBlock_ = block;\n    }\n  }\n\n  /**\n   * Record the workspace that a gesture started on.\n   *\n   * @param ws The workspace the gesture started on.\n   */\n  private setStartWorkspace_(ws: WorkspaceSvg) {\n    if (!this.startWorkspace_) {\n      this.startWorkspace_ = ws;\n    }\n  }\n\n  /**\n   * Record the flyout that a gesture started on.\n   *\n   * @param flyout The flyout the gesture started on.\n   */\n  private setStartFlyout_(flyout: IFlyout) {\n    if (!this.flyout_) {\n      this.flyout_ = flyout;\n    }\n  }\n\n  /* End functions for populating a gesture at mouse down. */\n\n  /* Begin helper functions defining types of clicks.  Any developer wanting\n   * to change the definition of a click should modify only this code. */\n\n  /**\n   * Whether this gesture is a click on a bubble.  This should only be called\n   * when ending a gesture (mouse up, touch end).\n   *\n   * @returns Whether this gesture was a click on a bubble.\n   */\n  private isBubbleClick_(): boolean {\n    // A bubble click starts on a bubble and never escapes the drag radius.\n    const hasStartBubble = !!this.startBubble_;\n    return hasStartBubble && !this.hasExceededDragRadius_;\n  }\n\n  /**\n   * Whether this gesture is a click on a block.  This should only be called\n   * when ending a gesture (mouse up, touch end).\n   *\n   * @returns Whether this gesture was a click on a block.\n   */\n  private isBlockClick_(): boolean {\n    // A block click starts on a block, never escapes the drag radius, and is\n    // not a field click.\n    const hasStartBlock = !!this.startBlock_;\n    return hasStartBlock && !this.hasExceededDragRadius_ &&\n        !this.isFieldClick_();\n  }\n\n  /**\n   * Whether this gesture is a click on a field.  This should only be called\n   * when ending a gesture (mouse up, touch end).\n   *\n   * @returns Whether this gesture was a click on a field.\n   */\n  private isFieldClick_(): boolean {\n    const fieldClickable =\n        this.startField_ ? this.startField_.isClickable() : false;\n    return fieldClickable && !this.hasExceededDragRadius_ &&\n        (!this.flyout_ || !this.flyout_.autoClose);\n  }\n\n  /**\n   * Whether this gesture is a click on a workspace.  This should only be called\n   * when ending a gesture (mouse up, touch end).\n   *\n   * @returns Whether this gesture was a click on a workspace.\n   */\n  private isWorkspaceClick_(): boolean {\n    const onlyTouchedWorkspace =\n        !this.startBlock_ && !this.startBubble_ && !this.startField_;\n    return onlyTouchedWorkspace && !this.hasExceededDragRadius_;\n  }\n\n  /* End helper functions defining types of clicks. */\n\n  /**\n   * Whether this gesture is a drag of either a workspace or block.\n   * This function is called externally to block actions that cannot be taken\n   * mid-drag (e.g. using the keyboard to delete the selected blocks).\n   *\n   * @returns True if this gesture is a drag of a workspace or block.\n   * @internal\n   */\n  isDragging(): boolean {\n    return this.isDraggingWorkspace_ || this.isDraggingBlock_ ||\n        this.isDraggingBubble_;\n  }\n\n  /**\n   * Whether this gesture has already been started.  In theory every mouse down\n   * has a corresponding mouse up, but in reality it is possible to lose a\n   * mouse up, leaving an in-process gesture hanging.\n   *\n   * @returns Whether this gesture was a click on a workspace.\n   * @internal\n   */\n  hasStarted(): boolean {\n    return this.hasStarted_;\n  }\n\n  /**\n   * Get a list of the insertion markers that currently exist.  Block drags have\n   * 0, 1, or 2 insertion markers.\n   *\n   * @returns A possibly empty list of insertion marker blocks.\n   * @internal\n   */\n  getInsertionMarkers(): BlockSvg[] {\n    if (this.blockDragger_) {\n      return this.blockDragger_.getInsertionMarkers();\n    }\n    return [];\n  }\n\n  /**\n   * Gets the current dragger if an item is being dragged. Null if nothing is\n   * being dragged.\n   *\n   * @returns The dragger that is currently in use or null if no drag is in\n   *     progress.\n   */\n  getCurrentDragger(): WorkspaceDragger|BubbleDragger|IBlockDragger|null {\n    if (this.isDraggingBlock_) {\n      return this.blockDragger_;\n    } else if (this.isDraggingWorkspace_) {\n      return this.workspaceDragger_;\n    } else if (this.isDraggingBubble_) {\n      return this.bubbleDragger_;\n    }\n    return null;\n  }\n\n  /**\n   * Is a drag or other gesture currently in progress on any workspace?\n   *\n   * @returns True if gesture is occurring.\n   */\n  static inProgress(): boolean {\n    const workspaces = common.getAllWorkspaces();\n    for (let i = 0, workspace; workspace = workspaces[i]; i++) {\n      // Not actually necessarily a WorkspaceSvg, but it doesn't matter b/c\n      // we're just checking if the property exists. Theoretically we would\n      // want to use instanceof, but that causes a circular dependency.\n      if ((workspace as WorkspaceSvg).currentGesture_) {\n        return true;\n      }\n    }\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The namespace used to keep track of keyboard shortcuts and the\n * key codes used to execute those shortcuts.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ShortcutRegistry');\n\nimport {KeyCodes} from './utils/keycodes.js';\nimport * as object from './utils/object.js';\nimport type {Workspace} from './workspace.js';\n\n\n/**\n * Class for the registry of keyboard shortcuts. This is intended to be a\n * singleton. You should not create a new instance, and only access this class\n * from ShortcutRegistry.registry.\n *\n * @alias Blockly.ShortcutRegistry\n */\nexport class ShortcutRegistry {\n  static readonly registry = new ShortcutRegistry();\n\n  /** Registry of all keyboard shortcuts, keyed by name of shortcut. */\n  private shortcuts = new Map<string, KeyboardShortcut>();\n\n  /** Map of key codes to an array of shortcut names. */\n  private keyMap = new Map<string, string[]>();\n\n  /** Resets the existing ShortcutRegistry singleton. */\n  private constructor() {\n    this.reset();\n  }\n\n  /** Clear and recreate the registry and keyMap. */\n  reset() {\n    this.shortcuts.clear();\n    this.keyMap.clear();\n  }\n\n  /**\n   * Registers a keyboard shortcut.\n   *\n   * @param shortcut The shortcut for this key code.\n   * @param opt_allowOverrides True to prevent a warning when overriding an\n   *     already registered item.\n   * @throws {Error} if a shortcut with the same name already exists.\n   */\n  register(shortcut: KeyboardShortcut, opt_allowOverrides?: boolean) {\n    const registeredShortcut = this.shortcuts.get(shortcut.name);\n    if (registeredShortcut && !opt_allowOverrides) {\n      throw new Error(\n          'Shortcut with name \"' + shortcut.name + '\" already exists.');\n    }\n    this.shortcuts.set(shortcut.name, shortcut);\n\n    const keyCodes = shortcut.keyCodes;\n    if (keyCodes && keyCodes.length > 0) {\n      for (let i = 0; i < keyCodes.length; i++) {\n        this.addKeyMapping(\n            keyCodes[i], shortcut.name, !!shortcut.allowCollision);\n      }\n    }\n  }\n\n  /**\n   * Unregisters a keyboard shortcut registered with the given key code. This\n   * will also remove any key mappings that reference this shortcut.\n   *\n   * @param shortcutName The name of the shortcut to unregister.\n   * @returns True if an item was unregistered, false otherwise.\n   */\n  unregister(shortcutName: string): boolean {\n    const shortcut = this.shortcuts.get(shortcutName);\n\n    if (!shortcut) {\n      console.warn(\n          'Keyboard shortcut with name \"' + shortcutName + '\" not found.');\n      return false;\n    }\n\n    this.removeAllKeyMappings(shortcutName);\n\n    this.shortcuts.delete(shortcutName);\n    return true;\n  }\n\n  /**\n   * Adds a mapping between a keycode and a keyboard shortcut.\n   *\n   * @param keyCode The key code for the keyboard shortcut. If registering a key\n   *     code with a modifier (ex: ctrl+c) use\n   *     ShortcutRegistry.registry.createSerializedKey;\n   * @param shortcutName The name of the shortcut to execute when the given\n   *     keycode is pressed.\n   * @param opt_allowCollision True to prevent an error when adding a shortcut\n   *     to a key that is already mapped to a shortcut.\n   * @throws {Error} if the given key code is already mapped to a shortcut.\n   */\n  addKeyMapping(\n      keyCode: string|number|KeyCodes, shortcutName: string,\n      opt_allowCollision?: boolean) {\n    keyCode = String(keyCode);\n    const shortcutNames = this.keyMap.get(keyCode);\n    if (shortcutNames && !opt_allowCollision) {\n      throw new Error(\n          'Shortcut with name \"' + shortcutName + '\" collides with shortcuts ' +\n          shortcutNames.toString());\n    } else if (shortcutNames && opt_allowCollision) {\n      shortcutNames.unshift(shortcutName);\n    } else {\n      this.keyMap.set(keyCode, [shortcutName]);\n    }\n  }\n\n  /**\n   * Removes a mapping between a keycode and a keyboard shortcut.\n   *\n   * @param keyCode The key code for the keyboard shortcut. If registering a key\n   *     code with a modifier (ex: ctrl+c) use\n   *     ShortcutRegistry.registry.createSerializedKey;\n   * @param shortcutName The name of the shortcut to execute when the given\n   *     keycode is pressed.\n   * @param opt_quiet True to not console warn when there is no shortcut to\n   *     remove.\n   * @returns True if a key mapping was removed, false otherwise.\n   */\n  removeKeyMapping(keyCode: string, shortcutName: string, opt_quiet?: boolean):\n      boolean {\n    const shortcutNames = this.keyMap.get(keyCode);\n\n    if (!shortcutNames) {\n      if (!opt_quiet) {\n        console.warn(\n            'No keyboard shortcut with name \"' + shortcutName +\n            '\" registered with key code \"' + keyCode + '\"');\n      }\n      return false;\n    }\n\n    const shortcutIdx = shortcutNames.indexOf(shortcutName);\n    if (shortcutIdx > -1) {\n      shortcutNames.splice(shortcutIdx, 1);\n      if (shortcutNames.length === 0) {\n        this.keyMap.delete(keyCode);\n      }\n      return true;\n    }\n    if (!opt_quiet) {\n      console.warn(\n          'No keyboard shortcut with name \"' + shortcutName +\n          '\" registered with key code \"' + keyCode + '\"');\n    }\n    return false;\n  }\n\n  /**\n   * Removes all the key mappings for a shortcut with the given name.\n   * Useful when changing the default key mappings and the key codes registered\n   * to the shortcut are unknown.\n   *\n   * @param shortcutName The name of the shortcut to remove from the key map.\n   */\n  removeAllKeyMappings(shortcutName: string) {\n    for (const keyCode of this.keyMap.keys()) {\n      this.removeKeyMapping(keyCode, shortcutName, true);\n    }\n  }\n\n  /**\n   * Sets the key map. Setting the key map will override any default key\n   * mappings.\n   *\n   * @param newKeyMap The object with key code to shortcut names.\n   */\n  setKeyMap(newKeyMap: {[key: string]: string[]}) {\n    this.keyMap.clear();\n    for (const key in newKeyMap) {\n      this.keyMap.set(key, newKeyMap[key]);\n    }\n  }\n\n  /**\n   * Gets the current key map.\n   *\n   * @returns The object holding key codes to ShortcutRegistry.KeyboardShortcut.\n   */\n  getKeyMap(): {[key: string]: string[]} {\n    const legacyKeyMap: {[key: string]: string[]} = Object.create(null);\n    for (const [key, value] of this.keyMap) {\n      legacyKeyMap[key] = value;\n    }\n    return legacyKeyMap;\n  }\n\n  /**\n   * Gets the registry of keyboard shortcuts.\n   *\n   * @returns The registry of keyboard shortcuts.\n   */\n  getRegistry(): {[key: string]: KeyboardShortcut} {\n    const legacyRegistry: {[key: string]: KeyboardShortcut} =\n        Object.create(null);\n    for (const [key, value] of this.shortcuts) {\n      legacyRegistry[key] = value;\n    }\n    return object.deepMerge(Object.create(null), legacyRegistry);\n  }\n\n  /**\n   * Handles key down events.\n   *\n   * @param workspace The main workspace where the event was captured.\n   * @param e The key down event.\n   * @returns True if the event was handled, false otherwise.\n   */\n  onKeyDown(workspace: Workspace, e: KeyboardEvent): boolean {\n    const key = this.serializeKeyEvent_(e);\n    const shortcutNames = this.getShortcutNamesByKeyCode(key);\n    if (!shortcutNames) {\n      return false;\n    }\n    for (let i = 0, shortcutName; shortcutName = shortcutNames[i]; i++) {\n      const shortcut = this.shortcuts.get(shortcutName);\n      if (!shortcut?.preconditionFn || shortcut?.preconditionFn(workspace)) {\n        // If the key has been handled, stop processing shortcuts.\n        if (shortcut?.callback && shortcut?.callback(workspace, e, shortcut)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Gets the shortcuts registered to the given key code.\n   *\n   * @param keyCode The serialized key code.\n   * @returns The list of shortcuts to call when the given keyCode is used.\n   *     Undefined if no shortcuts exist.\n   */\n  getShortcutNamesByKeyCode(keyCode: string): string[]|undefined {\n    return this.keyMap.get(keyCode) || [];\n  }\n\n  /**\n   * Gets the serialized key codes that the shortcut with the given name is\n   * registered under.\n   *\n   * @param shortcutName The name of the shortcut.\n   * @returns An array with all the key codes the shortcut is registered under.\n   */\n  getKeyCodesByShortcutName(shortcutName: string): string[] {\n    const keys = [];\n    for (const [keyCode, shortcuts] of this.keyMap) {\n      const shortcutIdx = shortcuts.indexOf(shortcutName);\n      if (shortcutIdx > -1) {\n        keys.push(keyCode);\n      }\n    }\n    return keys;\n  }\n\n  /**\n   * Serializes a key event.\n   *\n   * @param e A key down event.\n   * @returns The serialized key code for the given event.\n   */\n  private serializeKeyEvent_(e: KeyboardEvent): string {\n    let serializedKey = '';\n    for (const modifier in ShortcutRegistry.modifierKeys) {\n      if (e.getModifierState(modifier)) {\n        if (serializedKey !== '') {\n          serializedKey += '+';\n        }\n        serializedKey += modifier;\n      }\n    }\n    if (serializedKey !== '' && e.keyCode) {\n      serializedKey = serializedKey + '+' + e.keyCode;\n    } else if (e.keyCode) {\n      serializedKey = e.keyCode.toString();\n    }\n    return serializedKey;\n  }\n\n  /**\n   * Checks whether any of the given modifiers are not valid.\n   *\n   * @param modifiers List of modifiers to be used with the key.\n   * @throws {Error} if the modifier is not in the valid modifiers list.\n   */\n  private checkModifiers_(modifiers: KeyCodes[]) {\n    for (let i = 0, modifier; modifier = modifiers[i]; i++) {\n      if (!(modifier in ShortcutRegistry.modifierKeys)) {\n        throw new Error(modifier + ' is not a valid modifier key.');\n      }\n    }\n  }\n\n  /**\n   * Creates the serialized key code that will be used in the key map.\n   *\n   * @param keyCode Number code representing the key.\n   * @param modifiers List of modifier key codes to be used with the key. All\n   *     valid modifiers can be found in the ShortcutRegistry.modifierKeys.\n   * @returns The serialized key code for the given modifiers and key.\n   */\n  createSerializedKey(keyCode: number, modifiers: KeyCodes[]|null): string {\n    let serializedKey = '';\n\n    if (modifiers) {\n      this.checkModifiers_(modifiers);\n      for (const modifier in ShortcutRegistry.modifierKeys) {\n        const modifierKeyCode =\n            (ShortcutRegistry.modifierKeys as AnyDuringMigration)[modifier];\n        if (modifiers.indexOf(modifierKeyCode) > -1) {\n          if (serializedKey !== '') {\n            serializedKey += '+';\n          }\n          serializedKey += modifier;\n        }\n      }\n    }\n\n    if (serializedKey !== '' && keyCode) {\n      serializedKey = serializedKey + '+' + keyCode;\n    } else if (keyCode) {\n      serializedKey = keyCode.toString();\n    }\n    return serializedKey;\n  }\n}\n\nexport namespace ShortcutRegistry {\n  export interface KeyboardShortcut {\n    callback?: ((p1: Workspace, p2: Event, p3: KeyboardShortcut) => boolean);\n    name: string;\n    preconditionFn?: ((p1: Workspace) => boolean);\n    metadata?: object;\n    keyCodes?: (number|string)[];\n    allowCollision?: boolean;\n  }\n\n  /** Supported modifiers. */\n  export enum modifierKeys {\n    Shift = KeyCodes.SHIFT,\n    Control = KeyCodes.CTRL,\n    Alt = KeyCodes.ALT,\n    Meta = KeyCodes.META,\n  }\n}\n\nexport type KeyboardShortcut = ShortcutRegistry.KeyboardShortcut;\n// No need to export ShorcutRegistry.modifierKeys from the module at this time\n// because (1) it wasn't automatically converted by the automatic migration\n// script, (2) the name doesn't follow the styleguide.\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of a theme update.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.ThemeChange');\n\nimport * as registry from '../registry.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a theme change event.\n *\n * @alias Blockly.Events.ThemeChange\n */\nexport class ThemeChange extends UiBase {\n  themeName?: string;\n  override type: string;\n\n  /**\n   * @param opt_themeName The theme name. Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    event. Undefined for a blank event.\n   */\n  constructor(opt_themeName?: string, opt_workspaceId?: string) {\n    super(opt_workspaceId);\n\n    /** The theme name. */\n    this.themeName = opt_themeName;\n\n    /** Type of this event. */\n    this.type = eventUtils.THEME_CHANGE;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['themeName'] = this.themeName;\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.themeName = json['themeName'];\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.THEME_CHANGE, ThemeChange);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of a viewport change.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.ViewportChange');\n\nimport * as registry from '../registry.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a viewport change event.\n *\n * @alias Blockly.Events.ViewportChange\n */\nexport class ViewportChange extends UiBase {\n  viewTop?: number;\n  viewLeft?: number;\n  scale?: number;\n  oldScale?: number;\n  override type: string;\n\n  /**\n   * @param opt_top Top-edge of the visible portion of the workspace, relative\n   *     to the workspace origin. Undefined for a blank event.\n   * @param opt_left Left-edge of the visible portion of the workspace relative\n   *     to the workspace origin. Undefined for a blank event.\n   * @param opt_scale The scale of the workspace. Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   * @param opt_oldScale The old scale of the workspace. Undefined for a blank\n   *     event.\n   */\n  constructor(\n      opt_top?: number, opt_left?: number, opt_scale?: number,\n      opt_workspaceId?: string, opt_oldScale?: number) {\n    super(opt_workspaceId);\n\n    /**\n     * Top-edge of the visible portion of the workspace, relative to the\n     * workspace origin.\n     */\n    this.viewTop = opt_top;\n\n    /**\n     * Left-edge of the visible portion of the workspace, relative to the\n     * workspace origin.\n     */\n    this.viewLeft = opt_left;\n\n    /** The scale of the workspace. */\n    this.scale = opt_scale;\n\n    /** The old scale of the workspace. */\n    this.oldScale = opt_oldScale;\n\n    /** Type of this event. */\n    this.type = eventUtils.VIEWPORT_CHANGE;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['viewTop'] = this.viewTop;\n    json['viewLeft'] = this.viewLeft;\n    json['scale'] = this.scale;\n    json['oldScale'] = this.oldScale;\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.viewTop = json['viewTop'];\n    this.viewLeft = json['viewLeft'];\n    this.scale = json['scale'];\n    this.oldScale = json['oldScale'];\n  }\n}\n\nregistry.register(\n    registry.Type.EVENT, eventUtils.VIEWPORT_CHANGE, ViewportChange);\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A database of all the rendered connections that could\n *    possibly be connected to (i.e. not collapsed, etc).\n *    Sorted by y coordinate.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ConnectionDB');\n\nimport {ConnectionType} from './connection_type.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport type {RenderedConnection} from './rendered_connection.js';\nimport type {Coordinate} from './utils/coordinate.js';\n\n\n/**\n * Database of connections.\n * Connections are stored in order of their vertical component.  This way\n * connections in an area may be looked up quickly using a binary search.\n *\n * @alias Blockly.ConnectionDB\n */\nexport class ConnectionDB {\n  /** Array of connections sorted by y position in workspace units. */\n  private readonly connections_: RenderedConnection[] = [];\n\n  /**\n   * @param connectionChecker The workspace's connection type checker, used to\n   *     decide if connections are valid during a drag.\n   */\n  constructor(private readonly connectionChecker: IConnectionChecker) {}\n\n  /**\n   * Add a connection to the database. Should not already exist in the database.\n   *\n   * @param connection The connection to be added.\n   * @param yPos The y position used to decide where to insert the connection.\n   * @internal\n   */\n  addConnection(connection: RenderedConnection, yPos: number) {\n    const index = this.calculateIndexForYPos_(yPos);\n    this.connections_.splice(index, 0, connection);\n  }\n\n  /**\n   * Finds the index of the given connection.\n   *\n   * Starts by doing a binary search to find the approximate location, then\n   * linearly searches nearby for the exact connection.\n   *\n   * @param conn The connection to find.\n   * @param yPos The y position used to find the index of the connection.\n   * @returns The index of the connection, or -1 if the connection was not\n   *     found.\n   */\n  private findIndexOfConnection_(conn: RenderedConnection, yPos: number):\n      number {\n    if (!this.connections_.length) {\n      return -1;\n    }\n\n    const bestGuess = this.calculateIndexForYPos_(yPos);\n    if (bestGuess >= this.connections_.length) {\n      // Not in list\n      return -1;\n    }\n\n    yPos = conn.y;\n    // Walk forward and back on the y axis looking for the connection.\n    let pointer = bestGuess;\n    while (pointer >= 0 && this.connections_[pointer].y === yPos) {\n      if (this.connections_[pointer] === conn) {\n        return pointer;\n      }\n      pointer--;\n    }\n\n    pointer = bestGuess;\n    while (pointer < this.connections_.length &&\n           this.connections_[pointer].y === yPos) {\n      if (this.connections_[pointer] === conn) {\n        return pointer;\n      }\n      pointer++;\n    }\n    return -1;\n  }\n\n  /**\n   * Finds the correct index for the given y position.\n   *\n   * @param yPos The y position used to decide where to insert the connection.\n   * @returns The candidate index.\n   */\n  private calculateIndexForYPos_(yPos: number): number {\n    if (!this.connections_.length) {\n      return 0;\n    }\n    let pointerMin = 0;\n    let pointerMax = this.connections_.length;\n    while (pointerMin < pointerMax) {\n      const pointerMid = Math.floor((pointerMin + pointerMax) / 2);\n      if (this.connections_[pointerMid].y < yPos) {\n        pointerMin = pointerMid + 1;\n      } else if (this.connections_[pointerMid].y > yPos) {\n        pointerMax = pointerMid;\n      } else {\n        pointerMin = pointerMid;\n        break;\n      }\n    }\n    return pointerMin;\n  }\n\n  /**\n   * Remove a connection from the database.  Must already exist in DB.\n   *\n   * @param connection The connection to be removed.\n   * @param yPos The y position used to find the index of the connection.\n   * @throws {Error} If the connection cannot be found in the database.\n   */\n  removeConnection(connection: RenderedConnection, yPos: number) {\n    const index = this.findIndexOfConnection_(connection, yPos);\n    if (index === -1) {\n      throw Error('Unable to find connection in connectionDB.');\n    }\n    this.connections_.splice(index, 1);\n  }\n\n  /**\n   * Find all nearby connections to the given connection.\n   * Type checking does not apply, since this function is used for bumping.\n   *\n   * @param connection The connection whose neighbours should be returned.\n   * @param maxRadius The maximum radius to another connection.\n   * @returns List of connections.\n   */\n  getNeighbours(connection: RenderedConnection, maxRadius: number):\n      RenderedConnection[] {\n    const db = this.connections_;\n    const currentX = connection.x;\n    const currentY = connection.y;\n\n    // Binary search to find the closest y location.\n    let pointerMin = 0;\n    let pointerMax = db.length - 2;\n    let pointerMid = pointerMax;\n    while (pointerMin < pointerMid) {\n      if (db[pointerMid].y < currentY) {\n        pointerMin = pointerMid;\n      } else {\n        pointerMax = pointerMid;\n      }\n      pointerMid = Math.floor((pointerMin + pointerMax) / 2);\n    }\n\n    const neighbours: RenderedConnection[] = [];\n    /**\n     * Computes if the current connection is within the allowed radius of\n     * another connection. This function is a closure and has access to outside\n     * variables.\n     *\n     * @param yIndex The other connection's index in the database.\n     * @returns True if the current connection's vertical distance from the\n     *     other connection is less than the allowed radius.\n     */\n    function checkConnection_(yIndex: number): boolean {\n      const dx = currentX - db[yIndex].x;\n      const dy = currentY - db[yIndex].y;\n      const r = Math.sqrt(dx * dx + dy * dy);\n      if (r <= maxRadius) {\n        neighbours.push(db[yIndex]);\n      }\n      return dy < maxRadius;\n    }\n\n    // Walk forward and back on the y axis looking for the closest x,y point.\n    pointerMin = pointerMid;\n    pointerMax = pointerMid;\n    if (db.length) {\n      while (pointerMin >= 0 && checkConnection_(pointerMin)) {\n        pointerMin--;\n      }\n      do {\n        pointerMax++;\n      } while (pointerMax < db.length && checkConnection_(pointerMax));\n    }\n\n    return neighbours;\n  }\n\n  /**\n   * Is the candidate connection close to the reference connection.\n   * Extremely fast; only looks at Y distance.\n   *\n   * @param index Index in database of candidate connection.\n   * @param baseY Reference connection's Y value.\n   * @param maxRadius The maximum radius to another connection.\n   * @returns True if connection is in range.\n   */\n  private isInYRange_(index: number, baseY: number, maxRadius: number):\n      boolean {\n    return Math.abs(this.connections_[index].y - baseY) <= maxRadius;\n  }\n\n  /**\n   * Find the closest compatible connection to this connection.\n   *\n   * @param conn The connection searching for a compatible mate.\n   * @param maxRadius The maximum radius to another connection.\n   * @param dxy Offset between this connection's location in the database and\n   *     the current location (as a result of dragging).\n   * @returns Contains two properties: 'connection' which is either another\n   *     connection or null, and 'radius' which is the distance.\n   */\n  searchForClosest(\n      conn: RenderedConnection, maxRadius: number,\n      dxy: Coordinate): {connection: RenderedConnection|null, radius: number} {\n    if (!this.connections_.length) {\n      // Don't bother.\n      return {connection: null, radius: maxRadius};\n    }\n\n    // Stash the values of x and y from before the drag.\n    const baseY = conn.y;\n    const baseX = conn.x;\n\n    conn.x = baseX + dxy.x;\n    conn.y = baseY + dxy.y;\n\n    // calculateIndexForYPos_ finds an index for insertion, which is always\n    // after any block with the same y index.  We want to search both forward\n    // and back, so search on both sides of the index.\n    const closestIndex = this.calculateIndexForYPos_(conn.y);\n\n    let bestConnection = null;\n    let bestRadius = maxRadius;\n    let temp;\n\n    // Walk forward and back on the y axis looking for the closest x,y point.\n    let pointerMin = closestIndex - 1;\n    while (pointerMin >= 0 && this.isInYRange_(pointerMin, conn.y, maxRadius)) {\n      temp = this.connections_[pointerMin];\n      if (this.connectionChecker.canConnect(conn, temp, true, bestRadius)) {\n        bestConnection = temp;\n        bestRadius = temp.distanceFrom(conn);\n      }\n      pointerMin--;\n    }\n\n    let pointerMax = closestIndex;\n    while (pointerMax < this.connections_.length &&\n           this.isInYRange_(pointerMax, conn.y, maxRadius)) {\n      temp = this.connections_[pointerMax];\n      if (this.connectionChecker.canConnect(conn, temp, true, bestRadius)) {\n        bestConnection = temp;\n        bestRadius = temp.distanceFrom(conn);\n      }\n      pointerMax++;\n    }\n\n    // Reset the values of x and y.\n    conn.x = baseX;\n    conn.y = baseY;\n    // If there were no valid connections, bestConnection will be null.\n    return {connection: bestConnection, radius: bestRadius};\n  }\n\n  /**\n   * Initialize a set of connection DBs for a workspace.\n   *\n   * @param checker The workspace's connection checker, used to decide if\n   *     connections are valid during a drag.\n   * @returns Array of databases.\n   */\n  static init(checker: IConnectionChecker): ConnectionDB[] {\n    // Create four databases, one for each connection type.\n    const dbList = [];\n    dbList[ConnectionType.INPUT_VALUE] = new ConnectionDB(checker);\n    dbList[ConnectionType.OUTPUT_VALUE] = new ConnectionDB(checker);\n    dbList[ConnectionType.NEXT_STATEMENT] = new ConnectionDB(checker);\n    dbList[ConnectionType.PREVIOUS_STATEMENT] = new ConnectionDB(checker);\n    return dbList;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object for configuring and updating a workspace grid in\n * Blockly.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Grid');\n\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\nimport {GridOptions} from './blockly_options.js';\n\n\n/**\n * Class for a workspace's grid.\n *\n * @alias Blockly.Grid\n */\nexport class Grid {\n  private readonly spacing: number;\n  private readonly length: number;\n  private readonly line1: SVGElement;\n  private readonly line2: SVGElement;\n  private readonly snapToGrid: boolean;\n\n  /**\n   * @param pattern The grid's SVG pattern, created during injection.\n   * @param options A dictionary of normalized options for the grid.\n   *     See grid documentation:\n   *     https://developers.google.com/blockly/guides/configure/web/grid\n   */\n  constructor(private pattern: SVGElement, options: GridOptions) {\n    /** The spacing of the grid lines (in px). */\n    this.spacing = options['spacing'] ?? 0;\n\n    /** How long the grid lines should be (in px). */\n    this.length = options['length'] ?? 1;\n\n    /** The horizontal grid line, if it exists. */\n    this.line1 = pattern.firstChild as SVGElement;\n\n    /** The vertical grid line, if it exists. */\n    this.line2 = this.line1 && this.line1.nextSibling as SVGElement;\n\n    /** Whether blocks should snap to the grid. */\n    this.snapToGrid = options['snap'] ?? false;\n  }\n\n  /**\n   * Whether blocks should snap to the grid, based on the initial configuration.\n   *\n   * @returns True if blocks should snap, false otherwise.\n   * @internal\n   */\n  shouldSnap(): boolean {\n    return this.snapToGrid;\n  }\n\n  /**\n   * Get the spacing of the grid points (in px).\n   *\n   * @returns The spacing of the grid points.\n   * @internal\n   */\n  getSpacing(): number {\n    return this.spacing;\n  }\n\n  /**\n   * Get the ID of the pattern element, which should be randomized to avoid\n   * conflicts with other Blockly instances on the page.\n   *\n   * @returns The pattern ID.\n   * @internal\n   */\n  getPatternId(): string {\n    return this.pattern.id;\n  }\n\n  /**\n   * Update the grid with a new scale.\n   *\n   * @param scale The new workspace scale.\n   * @internal\n   */\n  update(scale: number) {\n    // MSIE freaks if it sees a 0x0 pattern, so set empty patterns to 100x100.\n    const safeSpacing = this.spacing * scale || 100;\n\n    this.pattern.setAttribute('width', safeSpacing.toString());\n    this.pattern.setAttribute('height', safeSpacing.toString());\n\n    let half = Math.floor(this.spacing / 2) + 0.5;\n    let start = half - this.length / 2;\n    let end = half + this.length / 2;\n\n    half *= scale;\n    start *= scale;\n    end *= scale;\n\n    this.setLineAttributes(this.line1, scale, start, end, half, half);\n    this.setLineAttributes(this.line2, scale, half, half, start, end);\n  }\n\n  /**\n   * Set the attributes on one of the lines in the grid.  Use this to update the\n   * length and stroke width of the grid lines.\n   *\n   * @param line Which line to update.\n   * @param width The new stroke size (in px).\n   * @param x1 The new x start position of the line (in px).\n   * @param x2 The new x end position of the line (in px).\n   * @param y1 The new y start position of the line (in px).\n   * @param y2 The new y end position of the line (in px).\n   */\n  private setLineAttributes(\n      line: SVGElement, width: number, x1: number, x2: number, y1: number,\n      y2: number) {\n    if (line) {\n      line.setAttribute('stroke-width', width.toString());\n      line.setAttribute('x1', x1.toString());\n      line.setAttribute('y1', y1.toString());\n      line.setAttribute('x2', x2.toString());\n      line.setAttribute('y2', y2.toString());\n    }\n  }\n\n  /**\n   * Move the grid to a new x and y position, and make sure that change is\n   * visible.\n   *\n   * @param x The new x position of the grid (in px).\n   * @param y The new y position of the grid (in px).\n   * @internal\n   */\n  moveTo(x: number, y: number) {\n    this.pattern.setAttribute('x', x.toString());\n    this.pattern.setAttribute('y', y.toString());\n  }\n\n  /**\n   * Create the DOM for the grid described by options.\n   *\n   * @param rnd A random ID to append to the pattern's ID.\n   * @param gridOptions The object containing grid configuration.\n   * @param defs The root SVG element for this workspace's defs.\n   * @returns The SVG element for the grid pattern.\n   * @internal\n   */\n  static createDom(rnd: string, gridOptions: GridOptions, defs: SVGElement):\n      SVGElement {\n    /*\n          <pattern id=\"blocklyGridPattern837493\" patternUnits=\"userSpaceOnUse\">\n            <rect stroke=\"#888\" />\n            <rect stroke=\"#888\" />\n          </pattern>\n        */\n    const gridPattern = dom.createSvgElement(\n        Svg.PATTERN,\n        {'id': 'blocklyGridPattern' + rnd, 'patternUnits': 'userSpaceOnUse'},\n        defs);\n    // x1, y1, x1, x2 properties will be set later in update.\n    if ((gridOptions['length'] ?? 1) > 0 && (gridOptions['spacing'] ?? 0) > 0) {\n      dom.createSvgElement(\n          Svg.LINE, {'stroke': gridOptions['colour']}, gridPattern);\n      if (gridOptions['length'] ?? 1 > 1) {\n        dom.createSvgElement(\n            Svg.LINE, {'stroke': gridOptions['colour']}, gridPattern);\n      }\n    } else {\n      // Edge 16 doesn't handle empty patterns\n      dom.createSvgElement(Svg.LINE, {}, gridPattern);\n    }\n    return gridPattern;\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility functions for handling variable and procedure names.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Names');\n\nimport {Msg} from './msg.js';\n// import * as Procedures from './procedures.js';\nimport type {VariableMap} from './variable_map.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\n\n\n/**\n * Class for a database of entity names (variables, procedures, etc).\n *\n * @alias Blockly.Names\n */\nexport class Names {\n  static DEVELOPER_VARIABLE_TYPE: NameType;\n  private readonly variablePrefix_: string;\n\n  /** A set of reserved words. */\n  private readonly reservedWords: Set<string>;\n\n  /**\n   * A map from type (e.g. name, procedure) to maps from names to generated\n   * names.\n   */\n  private readonly db = new Map<string, Map<string, string>>();\n\n  /** A set of used names to avoid collisions. */\n  private readonly dbReverse = new Set<string>();\n\n  /**\n   * The variable map from the workspace, containing Blockly variable models.\n   */\n  private variableMap_: VariableMap|null = null;\n\n  /**\n   * @param reservedWordsList A comma-separated string of words that are illegal\n   *     for use as names in a language (e.g. 'new,if,this,...').\n   * @param opt_variablePrefix Some languages need a '$' or a namespace before\n   *     all variable names (but not procedure names).\n   */\n  constructor(reservedWordsList: string, opt_variablePrefix?: string) {\n    /** The prefix to attach to variable names in generated code. */\n    this.variablePrefix_ = opt_variablePrefix || '';\n\n    this.reservedWords =\n        new Set<string>(reservedWordsList ? reservedWordsList.split(',') : []);\n  }\n\n  /**\n   * Empty the database and start from scratch.  The reserved words are kept.\n   */\n  reset() {\n    this.db.clear();\n    this.dbReverse.clear();\n    this.variableMap_ = null;\n  }\n\n  /**\n   * Set the variable map that maps from variable name to variable object.\n   *\n   * @param map The map to track.\n   */\n  setVariableMap(map: VariableMap) {\n    this.variableMap_ = map;\n  }\n\n  /**\n   * Get the name for a user-defined variable, based on its ID.\n   * This should only be used for variables of NameType VARIABLE.\n   *\n   * @param id The ID to look up in the variable map.\n   * @returns The name of the referenced variable, or null if there was no\n   *     variable map or the variable was not found in the map.\n   */\n  private getNameForUserVariable_(id: string): string|null {\n    if (!this.variableMap_) {\n      console.warn(\n          'Deprecated call to Names.prototype.getName without ' +\n          'defining a variable map. To fix, add the following code in your ' +\n          'generator\\'s init() function:\\n' +\n          'Blockly.YourGeneratorName.nameDB_.setVariableMap(' +\n          'workspace.getVariableMap());');\n      return null;\n    }\n    const variable = this.variableMap_.getVariableById(id);\n    if (variable) {\n      return variable.name;\n    }\n    return null;\n  }\n\n  /**\n   * Generate names for user variables, but only ones that are being used.\n   *\n   * @param workspace Workspace to generate variables from.\n   */\n  populateVariables(workspace: Workspace) {\n    const variables = Variables.allUsedVarModels(workspace);\n    for (let i = 0; i < variables.length; i++) {\n      this.getName(variables[i].getId(), NameType.VARIABLE);\n    }\n  }\n\n  /**\n   * Generate names for procedures.\n   *\n   * @param workspace Workspace to generate procedures from.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  populateProcedures(workspace: Workspace) {\n    throw new Error(\n        'The implementation of populateProcedures should be ' +\n        'monkey-patched in by blockly.ts');\n  }\n\n  /**\n   * Convert a Blockly entity name to a legal exportable entity name.\n   *\n   * @param nameOrId The Blockly entity name (no constraints) or variable ID.\n   * @param type The type of the name in Blockly ('VARIABLE', 'PROCEDURE',\n   *     'DEVELOPER_VARIABLE', etc...).\n   * @returns An entity name that is legal in the exported language.\n   */\n  getName(nameOrId: string, type: NameType|string): string {\n    let name = nameOrId;\n    if (type === NameType.VARIABLE) {\n      const varName = this.getNameForUserVariable_(nameOrId);\n      if (varName) {\n        // Successful ID lookup.\n        name = varName;\n      }\n    }\n    const normalizedName = name.toLowerCase();\n\n    const isVar =\n        type === NameType.VARIABLE || type === NameType.DEVELOPER_VARIABLE;\n\n    const prefix = isVar ? this.variablePrefix_ : '';\n    if (!this.db.has(type)) {\n      this.db.set(type, new Map<string, string>());\n    }\n    const typeDb = this.db.get(type);\n    if (typeDb!.has(normalizedName)) {\n      return prefix + typeDb!.get(normalizedName);\n    }\n    const safeName = this.getDistinctName(name, type);\n    typeDb!.set(normalizedName, safeName.substr(prefix.length));\n    return safeName;\n  }\n\n  /**\n   * Return a list of all known user-created names of a specified name type.\n   *\n   * @param type The type of entity in Blockly ('VARIABLE', 'PROCEDURE',\n   *     'DEVELOPER_VARIABLE', etc...).\n   * @returns A list of Blockly entity names (no constraints).\n   */\n  getUserNames(type: NameType|string): string[] {\n    const userNames = this.db.get(type)?.keys();\n    return userNames ? Array.from(userNames) : [];\n  }\n\n  /**\n   * Convert a Blockly entity name to a legal exportable entity name.\n   * Ensure that this is a new name not overlapping any previously defined name.\n   * Also check against list of reserved words for the current language and\n   * ensure name doesn't collide.\n   *\n   * @param name The Blockly entity name (no constraints).\n   * @param type The type of entity in Blockly ('VARIABLE', 'PROCEDURE',\n   *     'DEVELOPER_VARIABLE', etc...).\n   * @returns An entity name that is legal in the exported language.\n   */\n  getDistinctName(name: string, type: NameType|string): string {\n    let safeName = this.safeName_(name);\n    let i = '';\n    while (this.dbReverse.has(safeName + i) ||\n           this.reservedWords.has(safeName + i)) {\n      // Collision with existing name.  Create a unique name.\n      // AnyDuringMigration because:  Type 'string | 2' is not assignable to\n      // type 'string'.\n      i = (i ? i + 1 : 2) as AnyDuringMigration;\n    }\n    safeName += i;\n    this.dbReverse.add(safeName);\n    const isVar =\n        type === NameType.VARIABLE || type === NameType.DEVELOPER_VARIABLE;\n    const prefix = isVar ? this.variablePrefix_ : '';\n    return prefix + safeName;\n  }\n\n  /**\n   * Given a proposed entity name, generate a name that conforms to the\n   * [_A-Za-z][_A-Za-z0-9]* format that most languages consider legal for\n   * variable and function names.\n   *\n   * @param name Potentially illegal entity name.\n   * @returns Safe entity name.\n   */\n  private safeName_(name: string): string {\n    if (!name) {\n      name = Msg['UNNAMED_KEY'] || 'unnamed';\n    } else {\n      // Unfortunately names in non-latin characters will look like\n      // _E9_9F_B3_E4_B9_90 which is pretty meaningless.\n      // https://github.com/google/blockly/issues/1654\n      name = encodeURI(name.replace(/ /g, '_')).replace(/[^\\w]/g, '_');\n      // Most languages don't allow names with leading numbers.\n      if ('0123456789'.indexOf(name[0]) !== -1) {\n        name = 'my_' + name;\n      }\n    }\n    return name;\n  }\n\n  /**\n   * Do the given two entity names refer to the same entity?\n   * Blockly names are case-insensitive.\n   *\n   * @param name1 First name.\n   * @param name2 Second name.\n   * @returns True if names are the same.\n   */\n  static equals(name1: string, name2: string): boolean {\n    // name1.localeCompare(name2) is slower.\n    return name1.toLowerCase() === name2.toLowerCase();\n  }\n}\n\nexport namespace Names {\n  /**\n   * Enum for the type of a name. Different name types may have different rules\n   * about collisions.\n   * When JavaScript (or most other languages) is generated, variable 'foo' and\n   * procedure 'foo' would collide.  However, Blockly has no such problems since\n   * variable get 'foo' and procedure call 'foo' are unambiguous.\n   * Therefore, Blockly keeps a separate name type to disambiguate.\n   * getName('foo', 'VARIABLE') = 'foo'\n   * getName('foo', 'PROCEDURE') = 'foo2'\n   *\n   * @alias Blockly.Names.NameType\n   */\n  export enum NameType {\n    DEVELOPER_VARIABLE = 'DEVELOPER_VARIABLE',\n    VARIABLE = 'VARIABLE',\n    PROCEDURE = 'PROCEDURE',\n  }\n}\n\nexport type NameType = Names.NameType;\nexport const NameType = Names.NameType;\n\n/**\n * Constant to separate developer variable names from user-defined variable\n * names when running generators.\n * A developer variable will be declared as a global in the generated code, but\n * will never be shown to the user in the workspace or stored in the variable\n * map.\n */\nNames.DEVELOPER_VARIABLE_TYPE = NameType.DEVELOPER_VARIABLE;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Measurable types.\n *\n * @namespace Blockly.blockRendering.Types\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Types');\n\nimport type {Measurable} from './base.js';\nimport type {Row} from './row.js';\n\n\n/**\n * Types of rendering elements.\n *\n * @alias Blockly.blockRendering.Types\n */\nclass TypesContainer {\n  [index: string]: number|Function;\n\n  NONE = 0;                       // None\n  FIELD = 1 << 0;                 // Field.\n  HAT = 1 << 1;                   // Hat.\n  ICON = 1 << 2;                  // Icon.\n  SPACER = 1 << 3;                // Spacer.\n  BETWEEN_ROW_SPACER = 1 << 4;    // Between Row Spacer.\n  IN_ROW_SPACER = 1 << 5;         // In Row Spacer.\n  EXTERNAL_VALUE_INPUT = 1 << 6;  // External Value Input.\n  INPUT = 1 << 7;                 // Input.\n  INLINE_INPUT = 1 << 8;          // Inline Input.\n  STATEMENT_INPUT = 1 << 9;       // Statement Input.\n  CONNECTION = 1 << 10;           // Connection.\n  PREVIOUS_CONNECTION = 1 << 11;  // Previous Connection.\n  NEXT_CONNECTION = 1 << 12;      // Next Connection.\n  OUTPUT_CONNECTION = 1 << 13;    // Output Connection.\n  CORNER = 1 << 14;               // Corner.\n  LEFT_SQUARE_CORNER = 1 << 15;   // Square Corner.\n  LEFT_ROUND_CORNER = 1 << 16;    // Round Corner.\n  RIGHT_SQUARE_CORNER = 1 << 17;  // Right Square Corner.\n  RIGHT_ROUND_CORNER = 1 << 18;   // Right Round Corner.\n  JAGGED_EDGE = 1 << 19;          // Jagged Edge.\n  ROW = 1 << 20;                  // Row.\n  TOP_ROW = 1 << 21;              // Top Row.\n  BOTTOM_ROW = 1 << 22;           // Bottom Row.\n  INPUT_ROW = 1 << 23;            // Input Row.\n\n  /**\n   * A Left Corner Union Type.\n   *\n   * @internal\n   */\n  LEFT_CORNER = this.LEFT_SQUARE_CORNER | this.LEFT_ROUND_CORNER;\n\n  /**\n   * A Right Corner Union Type.\n   *\n   * @internal\n   */\n  RIGHT_CORNER = this.RIGHT_SQUARE_CORNER | this.RIGHT_ROUND_CORNER;\n\n  /**\n   * Next flag value to use for custom rendering element types.\n   * This must be updated to reflect the next enum flag value\n   * to use if additional elements are added to\n   * `Types`.\n   */\n  nextTypeValue_ = 1 << 24;\n\n  /**\n   * Get the enum flag value of an existing type or register a new type.\n   *\n   * @param type The name of the type.\n   * @returns The enum flag value associated with that type.\n   * @internal\n   */\n  getType(type: string): number {\n    if (!Object.prototype.hasOwnProperty.call(this, type)) {\n      this[type] = this.nextTypeValue_;\n      this.nextTypeValue_ <<= 1;\n    }\n    return this[type] as number;\n  }\n\n  /**\n   * Whether a measurable stores information about a field.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a field.\n   * @internal\n   */\n  isField(elem: Measurable): number {\n    return elem.type & this.FIELD;\n  }\n\n  /**\n   * Whether a measurable stores information about a hat.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a hat.\n   * @internal\n   */\n  isHat(elem: Measurable): number {\n    return elem.type & this.HAT;\n  }\n\n  /**\n   * Whether a measurable stores information about an icon.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an icon.\n   * @internal\n   */\n  isIcon(elem: Measurable): number {\n    return elem.type & this.ICON;\n  }\n\n  /**\n   * Whether a measurable stores information about a spacer.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a spacer.\n   * @internal\n   */\n  isSpacer(elem: Measurable|Row): number {\n    return elem.type & this.SPACER;\n  }\n\n  /**\n   * Whether a measurable stores information about an in-row spacer.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an in-row spacer.\n   * @internal\n   */\n  isInRowSpacer(elem: Measurable): number {\n    return elem.type & this.IN_ROW_SPACER;\n  }\n\n  /**\n   * Whether a measurable stores information about an input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an input.\n   * @internal\n   */\n  isInput(elem: Measurable): number {\n    return elem.type & this.INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about an external input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an external input.\n   * @internal\n   */\n  isExternalInput(elem: Measurable): number {\n    return elem.type & this.EXTERNAL_VALUE_INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about an inline input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an inline input.\n   * @internal\n   */\n  isInlineInput(elem: Measurable): number {\n    return elem.type & this.INLINE_INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about a statement input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a statement input.\n   * @internal\n   */\n  isStatementInput(elem: Measurable): number {\n    return elem.type & this.STATEMENT_INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about a previous connection.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a previous connection.\n   * @internal\n   */\n  isPreviousConnection(elem: Measurable): number {\n    return elem.type & this.PREVIOUS_CONNECTION;\n  }\n\n  /**\n   * Whether a measurable stores information about a next connection.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a next connection.\n   * @internal\n   */\n  isNextConnection(elem: Measurable): number {\n    return elem.type & this.NEXT_CONNECTION;\n  }\n\n  /**\n   * Whether a measurable stores information about a previous or next\n   * connection.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a previous or next\n   *     connection.\n   * @internal\n   */\n  isPreviousOrNextConnection(elem: Measurable): number {\n    return elem.type & (this.PREVIOUS_CONNECTION | this.NEXT_CONNECTION);\n  }\n\n  /**\n   * Whether a measurable stores information about a left round corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a left round corner.\n   * @internal\n   */\n  isLeftRoundedCorner(elem: Measurable): number {\n    return elem.type & this.LEFT_ROUND_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a right round corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a right round corner.\n   * @internal\n   */\n  isRightRoundedCorner(elem: Measurable): number {\n    return elem.type & this.RIGHT_ROUND_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a left square corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a left square corner.\n   * @internal\n   */\n  isLeftSquareCorner(elem: Measurable): number {\n    return elem.type & this.LEFT_SQUARE_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a right square corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a right square corner.\n   * @internal\n   */\n  isRightSquareCorner(elem: Measurable): number {\n    return elem.type & this.RIGHT_SQUARE_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a corner.\n   * @internal\n   */\n  isCorner(elem: Measurable): number {\n    return elem.type & this.CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a jagged edge.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a jagged edge.\n   * @internal\n   */\n  isJaggedEdge(elem: Measurable): number {\n    return elem.type & this.JAGGED_EDGE;\n  }\n\n  /**\n   * Whether a measurable stores information about a row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a row.\n   * @internal\n   */\n  isRow(row: Row): number {\n    return row.type & this.ROW;\n  }\n\n  /**\n   * Whether a measurable stores information about a between-row spacer.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a between-row spacer.\n   * @internal\n   */\n  isBetweenRowSpacer(row: Row): number {\n    return row.type & this.BETWEEN_ROW_SPACER;\n  }\n\n  /**\n   * Whether a measurable stores information about a top row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a top row.\n   * @internal\n   */\n  isTopRow(row: Row): number {\n    return row.type & this.TOP_ROW;\n  }\n\n  /**\n   * Whether a measurable stores information about a bottom row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a bottom row.\n   * @internal\n   */\n  isBottomRow(row: Row): number {\n    return row.type & this.BOTTOM_ROW;\n  }\n\n  /**\n   * Whether a measurable stores information about a top or bottom row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a top or bottom row.\n   * @internal\n   */\n  isTopOrBottomRow(row: Row): number {\n    return row.type & (this.TOP_ROW | this.BOTTOM_ROW);\n  }\n\n  /**\n   * Whether a measurable stores information about an input row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about an input row.\n   * @internal\n   */\n  isInputRow(row: Row): number {\n    return row.type & this.INPUT_ROW;\n  }\n}\n\nexport const Types = new TypesContainer();\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for graphically rendering a block as SVG.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Measurable');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Types} from './types.js';\n\n\n/**\n * The base class to represent a part of a block that takes up space during\n * rendering.  The constructor for each non-spacer Measurable records the size\n * of the block element (e.g. field, statement input).\n *\n * @alias Blockly.blockRendering.Measurable\n */\nexport class Measurable {\n  width = 0;\n\n  height = 0;\n  type: number;\n  xPos = 0;\n\n  centerline = 0;\n  notchOffset: number;\n\n  /** The renderer's constant provider. */\n  protected readonly constants_: ConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @internal\n   */\n  constructor(constants: ConstantProvider) {\n    this.constants_ = constants;\n\n    this.type = Types.NONE;\n\n    this.notchOffset = this.constants_.NOTCH_OFFSET_LEFT;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a single row on a rendered block.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Row');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport type {Measurable} from './base.js';\nimport type {InRowSpacer} from './in_row_spacer.js';\nimport type {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object representing a single row on a rendered block and all of its\n * subcomponents.\n *\n * @alias Blockly.blockRendering.Row\n */\nexport class Row {\n  /** @internal */\n  type: number;\n\n  /**\n   * An array of elements contained in this row.\n   *\n   * @internal\n   */\n  elements: Measurable[] = [];\n\n  /**\n   * The height of the row.\n   *\n   * @internal\n   */\n  height = 0;\n\n  /**\n   * The width of the row, from the left edge of the block to the right.\n   * Does not include child blocks unless they are inline.\n   *\n   * @internal\n   */\n  width = 0;\n\n  /**\n   * The minimum height of the row.\n   *\n   * @internal\n   */\n  minHeight = 0;\n\n  /**\n   * The minimum width of the row, from the left edge of the block to the\n   * right. Does not include child blocks unless they are inline.\n   *\n   * @internal\n   */\n  minWidth = 0;\n\n  /**\n   * The width of the row, from the left edge of the block to the edge of the\n   * block or any connected child blocks.\n   *\n   * @internal\n   */\n  widthWithConnectedBlocks = 0;\n\n  /**\n   * The Y position of the row relative to the origin of the block's svg\n   * group.\n   *\n   * @internal\n   */\n  yPos = 0;\n\n  /**\n   * The X position of the row relative to the origin of the block's svg\n   * group.\n   *\n   * @internal\n   */\n  xPos = 0;\n\n  /**\n   * Whether the row has any external inputs.\n   *\n   * @internal\n   */\n  hasExternalInput = false;\n\n  /**\n   * Whether the row has any statement inputs.\n   *\n   * @internal\n   */\n  hasStatement = false;\n\n  /**\n   * Where the left edge of all of the statement inputs on the block should\n   * be. This makes sure that statement inputs which are proceded by fields\n   * of varius widths are all aligned.\n   */\n  statementEdge = 0;\n\n  /**\n   * Whether the row has any inline inputs.\n   *\n   * @internal\n   */\n  hasInlineInput = false;\n\n  /**\n   * Whether the row has any dummy inputs.\n   *\n   * @internal\n   */\n  hasDummyInput = false;\n\n  /**\n   * Whether the row has a jagged edge.\n   *\n   * @internal\n   */\n  hasJaggedEdge = false;\n  notchOffset: number;\n\n  /**\n   * Alignment of the row.\n   *\n   * @internal\n   */\n  align: number|null = null;\n\n  protected readonly constants_: ConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @internal\n   */\n  constructor(constants: ConstantProvider) {\n    /** The renderer's constant provider. */\n    this.constants_ = constants;\n\n    /** The type of this rendering object. */\n    this.type = Types.ROW;\n\n    this.notchOffset = this.constants_.NOTCH_OFFSET_LEFT;\n  }\n\n  /**\n   * Get the last input on this row, if it has one.\n   *\n   * @returns The last input on the row, or null.\n   * @internal\n   */\n  getLastInput(): InputConnection {\n    // TODO: Consider moving this to InputRow, if possible.\n    for (let i = this.elements.length - 1; i >= 0; i--) {\n      const elem = this.elements[i];\n      if (Types.isInput(elem)) {\n        return elem as InputConnection;\n      }\n    }\n    // AnyDuringMigration because:  Type 'null' is not assignable to type\n    // 'InputConnection'.\n    return null as AnyDuringMigration;\n  }\n\n  /**\n   * Inspect all subcomponents and populate all size properties on the row.\n   *\n   * @internal\n   */\n  measure() {\n    throw Error('Unexpected attempt to measure a base Row.');\n  }\n\n  /**\n   * Determines whether this row should start with an element spacer.\n   *\n   * @returns Whether the row should start with a spacer.\n   * @internal\n   */\n  startsWithElemSpacer(): boolean {\n    return true;\n  }\n\n  /**\n   * Determines whether this row should end with an element spacer.\n   *\n   * @returns Whether the row should end with a spacer.\n   * @internal\n   */\n  endsWithElemSpacer(): boolean {\n    return true;\n  }\n\n  /**\n   * Convenience method to get the first spacer element on this row.\n   *\n   * @returns The first spacer element on this row.\n   * @internal\n   */\n  getFirstSpacer(): InRowSpacer {\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      if (Types.isSpacer(elem)) {\n        return elem as InRowSpacer;\n      }\n    }\n    // AnyDuringMigration because:  Type 'null' is not assignable to type\n    // 'InRowSpacer'.\n    return null as AnyDuringMigration;\n  }\n\n  /**\n   * Convenience method to get the last spacer element on this row.\n   *\n   * @returns The last spacer element on this row.\n   * @internal\n   */\n  getLastSpacer(): InRowSpacer {\n    for (let i = this.elements.length - 1; i >= 0; i--) {\n      const elem = this.elements[i];\n      if (Types.isSpacer(elem)) {\n        return elem as InRowSpacer;\n      }\n    }\n    // AnyDuringMigration because:  Type 'null' is not assignable to type\n    // 'InRowSpacer'.\n    return null as AnyDuringMigration;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a bottom row on a rendered block.\n * of its subcomponents.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.BottomRow');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport type {NextConnection} from './next_connection.js';\nimport {Row} from './row.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about what elements are in the bottom row of\n * a block as well as spacing information for the bottom row.\n * Elements in a bottom row can consist of corners, spacers and next\n * connections.\n *\n * @alias Blockly.blockRendering.BottomRow\n */\nexport class BottomRow extends Row {\n  /**\n   * Whether this row has a next connection.\n   *\n   * @internal\n   */\n  hasNextConnection = false;\n\n  /**\n   * The next connection on the row, if any.\n   *\n   * @internal\n   */\n  connection: NextConnection|null = null;\n\n  /**\n   * The amount that the bottom of the block extends below the horizontal\n   * edge, e.g. because of a next connection.  Must be non-negative (see\n   * #2820).\n   *\n   * @internal\n   */\n  descenderHeight = 0;\n\n  /**\n   * The Y position of the bottom edge of the block, relative to the origin\n   * of the block rendering.\n   */\n  baseline = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @internal\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.BOTTOM_ROW;\n  }\n\n  /**\n   * Returns whether or not the bottom row has a left square corner.\n   *\n   * @param block The block whose bottom row this represents.\n   * @returns Whether or not the bottom row has a left square corner.\n   */\n  hasLeftSquareCorner(block: BlockSvg): boolean {\n    return !!block.outputConnection || !!block.getNextBlock();\n  }\n\n  /**\n   * Returns whether or not the bottom row has a right square corner.\n   *\n   * @param _block The block whose bottom row this represents.\n   * @returns Whether or not the bottom row has a right square corner.\n   */\n  hasRightSquareCorner(_block: BlockSvg): boolean {\n    return true;\n  }\n\n  override measure() {\n    let height = 0;\n    let width = 0;\n    let descenderHeight = 0;\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      width += elem.width;\n      if (!Types.isSpacer(elem)) {\n        // Note: this assumes that next connections have *only* descenderHeight,\n        // with no height above the baseline.\n        if (Types.isNextConnection(elem)) {\n          descenderHeight = Math.max(descenderHeight, elem.height);\n        } else {\n          height = Math.max(height, elem.height);\n        }\n      }\n    }\n    this.width = Math.max(this.minWidth, width);\n    this.height = Math.max(this.minHeight, height) + descenderHeight;\n    this.descenderHeight = descenderHeight;\n    this.widthWithConnectedBlocks = this.width;\n  }\n\n  override startsWithElemSpacer() {\n    return false;\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Base class representing the space a connection takes up during\n * rendering.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Connection');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider, Shape} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n\n/**\n * The base class to represent a connection and the space that it takes up on\n * the block.\n *\n * @alias Blockly.blockRendering.Connection\n */\nexport class Connection extends Measurable {\n  shape: Shape;\n  isDynamicShape: boolean;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   * @internal\n   */\n  constructor(\n      constants: ConstantProvider, public connectionModel: RenderedConnection) {\n    super(constants);\n\n    this.shape = this.constants_.shapeFor(connectionModel);\n\n    this.isDynamicShape = 'isDynamic' in this.shape && this.shape.isDynamic;\n    this.type |= Types.CONNECTION;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class representing inputs with connections on a rendered block.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.InputConnection');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Input} from '../../input.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n\n/**\n * The base class to represent an input that takes up space on a block\n * during rendering\n *\n * @alias Blockly.blockRendering.InputConnection\n */\nexport class InputConnection extends Connection {\n  align: number;\n  connectedBlock: BlockSvg|null;\n  connectedBlockWidth: number;\n  connectedBlockHeight: number;\n  connectionOffsetX = 0;\n  connectionOffsetY = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The input to measure and store information for.\n   * @internal\n   */\n  constructor(constants: ConstantProvider, public input: Input) {\n    super(constants, input.connection as RenderedConnection);\n\n    this.type |= Types.INPUT;\n\n    this.align = input.align;\n\n    this.connectedBlock =\n        (input.connection && input.connection.targetBlock() ?\n             input.connection.targetBlock() as BlockSvg :\n             null);\n\n    if (this.connectedBlock) {\n      const bBox = this.connectedBlock.getHeightWidth();\n      this.connectedBlockWidth = bBox.width;\n      this.connectedBlockHeight = bBox.height;\n    } else {\n      this.connectedBlockWidth = 0;\n      this.connectedBlockHeight = 0;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class representing external value inputs with connections on a\n * rendered block.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.ExternalValueInput');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about the space an external value input\n * takes up during rendering\n *\n * @alias Blockly.blockRendering.ExternalValueInput\n */\nexport class ExternalValueInput extends InputConnection {\n  override height = 0;\n  override width: number;\n  override connectionOffsetY: number;\n  connectionHeight: number;\n  connectionWidth: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The external value input to measure and store information for.\n   * @internal\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n    this.type |= Types.EXTERNAL_VALUE_INPUT;\n    if (!this.connectedBlock) {\n      this.height = this.shape.height as number;\n    } else {\n      this.height = this.connectedBlockHeight -\n          this.constants_.TAB_OFFSET_FROM_TOP - this.constants_.MEDIUM_PADDING;\n    }\n\n    this.width = this.shape.width as\n        number + this.constants_.EXTERNAL_VALUE_INPUT_PADDING;\n\n    this.connectionOffsetY = this.constants_.TAB_OFFSET_FROM_TOP;\n\n    this.connectionHeight = this.shape.height as number;\n\n    this.connectionWidth = this.shape.width as number;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Objects representing a field in a row of a rendered\n * block.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Field');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Field as BlocklyField} from '../../field.js';\nimport type {Input} from '../../input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about the space a field takes up during\n * rendering\n *\n * @alias Blockly.blockRendering.Field\n */\nexport class Field extends Measurable {\n  isEditable: boolean;\n  flipRtl: boolean;\n  override height: number;\n  override width: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param field The field to measure and store information for.\n   * @param parentInput The parent input for the field.\n   * @internal\n   */\n  constructor(\n      constants: ConstantProvider, public field: BlocklyField,\n      public parentInput: Input) {\n    super(constants);\n\n    this.isEditable = field.EDITABLE;\n\n    this.flipRtl = field.getFlipRtl();\n    this.type |= Types.FIELD;\n\n    const size = this.field.getSize();\n\n    this.height = size.height;\n\n    this.width = size.width;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Objects representing a hat in a row of a rendered\n * block.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Hat');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about the space a hat takes up during\n * rendering.\n *\n * @alias Blockly.blockRendering.Hat\n */\nexport class Hat extends Measurable {\n  ascenderHeight: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @internal\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.HAT;\n\n    this.height = this.constants_.START_HAT.height;\n    this.width = this.constants_.START_HAT.width;\n\n    this.ascenderHeight = this.height;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Objects representing an icon in a row of a rendered\n * block.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Icon');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Icon as BlocklyIcon} from '../../icon.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about the space an icon takes up during\n * rendering\n *\n * @alias Blockly.blockRendering.Icon\n */\nexport class Icon extends Measurable {\n  isVisible: boolean;\n\n  /**\n   * An object containing information about the space an icon takes up during\n   * rendering\n   *\n   * @param constants The rendering constants provider.\n   * @param icon The icon to measure and store information for.\n   * @internal\n   */\n  constructor(constants: ConstantProvider, public icon: BlocklyIcon) {\n    super(constants);\n\n    this.isVisible = icon.isVisible();\n    this.type |= Types.ICON;\n\n    const size = icon.getCorrectedSize();\n    this.height = size.height;\n    this.width = size.width;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Objects representing a spacer in a row of a rendered\n * block.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.InRowSpacer');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about a spacer between two elements on a\n * row.\n *\n * @alias Blockly.blockRendering.InRowSpacer\n */\nexport class InRowSpacer extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   * @param width The width of the spacer.\n   * @internal\n   */\n  constructor(constants: ConstantProvider, width: number) {\n    super(constants);\n    this.type |= Types.SPACER | Types.IN_ROW_SPACER;\n    this.width = width;\n    this.height = this.constants_.SPACER_DEFAULT_HEIGHT;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class representing inline inputs with connections on a rendered\n * block.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.InlineInput');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about the space an inline input takes up\n * during rendering\n *\n * @alias Blockly.blockRendering.InlineInput\n */\nexport class InlineInput extends InputConnection {\n  connectionHeight: number;\n  connectionWidth: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The inline input to measure and store information for.\n   * @internal\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n    this.type |= Types.INLINE_INPUT;\n\n    if (!this.connectedBlock) {\n      this.height = this.constants_.EMPTY_INLINE_INPUT_HEIGHT;\n      this.width = this.constants_.EMPTY_INLINE_INPUT_PADDING;\n    } else {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.width = this.connectedBlockWidth;\n      this.height = this.connectedBlockHeight;\n    }\n\n    this.connectionHeight = !this.isDynamicShape ?\n        this.shape.height as number :\n        (this.shape.height as (p1: number) => number)(this.height);\n\n    this.connectionWidth = !this.isDynamicShape ?\n        this.shape.width as number :\n        (this.shape.width as (p1: number) => number)(this.height);\n    if (!this.connectedBlock) {\n      this.width += this.connectionWidth * (this.isDynamicShape ? 2 : 1);\n    }\n\n    this.connectionOffsetY = 'connectionOffsetY' in this.shape ?\n        this.shape.connectionOffsetY(this.connectionHeight) :\n        this.constants_.TAB_OFFSET_FROM_TOP;\n\n    this.connectionOffsetX = 'connectionOffsetX' in this.shape ?\n        this.shape.connectionOffsetX(this.connectionWidth) :\n        0;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class representing statement inputs with connections on a\n * rendered block.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.StatementInput');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about the space a statement input takes up\n * during rendering\n *\n * @alias Blockly.blockRendering.StatementInput\n */\nexport class StatementInput extends InputConnection {\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The statement input to measure and store information for.\n   * @internal\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n    this.type |= Types.STATEMENT_INPUT;\n\n    if (!this.connectedBlock) {\n      this.height = this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT;\n    } else {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.height =\n          this.connectedBlockHeight + this.constants_.STATEMENT_BOTTOM_SPACER;\n    }\n    this.width = this.constants_.STATEMENT_INPUT_NOTCH_OFFSET +\n        (this.shape.width as number);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a row that holds one or more inputs on a\n * rendered block.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.InputRow');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {ExternalValueInput} from './external_value_input.js';\nimport {InputConnection} from './input_connection.js';\nimport {Row} from './row.js';\nimport {StatementInput} from './statement_input.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about a row that holds one or more inputs.\n *\n * @alias Blockly.blockRendering.InputRow\n */\nexport class InputRow extends Row {\n  /**\n   * The total width of all blocks connected to this row.\n   *\n   * @internal\n   */\n  connectedBlockWidths = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @internal\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.INPUT_ROW;\n  }\n\n  /**\n   * Inspect all subcomponents and populate all size properties on the row.\n   *\n   * @internal\n   */\n  override measure() {\n    this.width = this.minWidth;\n    this.height = this.minHeight;\n    let connectedBlockWidths = 0;\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      this.width += elem.width;\n      if (Types.isInput(elem) && elem instanceof InputConnection) {\n        if (Types.isStatementInput(elem) && elem instanceof StatementInput) {\n          connectedBlockWidths += elem.connectedBlockWidth;\n        } else if (\n            Types.isExternalInput(elem) && elem instanceof ExternalValueInput &&\n            elem.connectedBlockWidth !== 0) {\n          connectedBlockWidths +=\n              elem.connectedBlockWidth - elem.connectionWidth;\n        }\n      }\n      if (!Types.isSpacer(elem)) {\n        this.height = Math.max(this.height, elem.height);\n      }\n    }\n    this.connectedBlockWidths = connectedBlockWidths;\n    this.widthWithConnectedBlocks = this.width + connectedBlockWidths;\n  }\n\n  override endsWithElemSpacer() {\n    return !this.hasExternalInput && !this.hasStatement;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Objects representing a jagged edge in a row of a rendered\n * block.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.JaggedEdge');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about the jagged edge of a collapsed block\n * takes up during rendering\n *\n * @alias Blockly.blockRendering.JaggedEdge\n */\nexport class JaggedEdge extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   * @internal\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.JAGGED_EDGE;\n    this.height = this.constants_.JAGGED_TEETH.height;\n    this.width = this.constants_.JAGGED_TEETH.width;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class representing the space a next connection takes up during\n * rendering.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.NextConnection');\n\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about the space a next connection takes\n * up during rendering.\n *\n * @alias Blockly.blockRendering.NextConnection\n */\nexport class NextConnection extends Connection {\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   * @internal\n   */\n  constructor(\n      constants: ConstantProvider, connectionModel: RenderedConnection) {\n    super(constants, connectionModel);\n    this.type |= Types.NEXT_CONNECTION;\n    this.height = this.shape.height as number;\n    this.width = this.shape.width as number;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class representing the space a output connection takes up\n * during rendering.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.OutputConnection');\n\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about the space an output connection takes\n * up during rendering.\n *\n * @alias Blockly.blockRendering.OutputConnection\n */\nexport class OutputConnection extends Connection {\n  startX: number;\n  connectionOffsetY: number;\n  connectionOffsetX = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   * @internal\n   */\n  constructor(\n      constants: ConstantProvider, connectionModel: RenderedConnection) {\n    super(constants, connectionModel);\n    this.type |= Types.OUTPUT_CONNECTION;\n\n    this.height = !this.isDynamicShape ? this.shape.height as number : 0;\n    this.width = !this.isDynamicShape ? this.shape.width as number : 0;\n\n    this.startX = this.width;\n\n    this.connectionOffsetY = this.constants_.TAB_OFFSET_FROM_TOP;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class representing the space a previous connection takes up\n * during rendering.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.PreviousConnection');\n\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about the space a previous connection takes\n * up during rendering.\n *\n * @alias Blockly.blockRendering.PreviousConnection\n */\nexport class PreviousConnection extends Connection {\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   * @internal\n   */\n  constructor(\n      constants: ConstantProvider, connectionModel: RenderedConnection) {\n    super(constants, connectionModel);\n    this.type |= Types.PREVIOUS_CONNECTION;\n    this.height = this.shape.height as number;\n    this.width = this.shape.width as number;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Objects representing a round corner in a row of a rendered\n * block.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.RoundCorner');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about the space a rounded corner takes up\n * during rendering.\n *\n * @alias Blockly.blockRendering.RoundCorner\n */\nexport class RoundCorner extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   * @param opt_position The position of this corner.\n   * @internal\n   */\n  constructor(constants: ConstantProvider, opt_position?: string) {\n    super(constants);\n    this.type =\n        (!opt_position || opt_position === 'left' ? Types.LEFT_ROUND_CORNER :\n                                                    Types.RIGHT_ROUND_CORNER) |\n        Types.CORNER;\n    this.width = this.constants_.CORNER_RADIUS;\n    // The rounded corner extends into the next row by 4 so we only take the\n    // height that is aligned with this row.\n    this.height = this.constants_.CORNER_RADIUS / 2;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a spacer between two rows.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.SpacerRow');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InRowSpacer} from './in_row_spacer.js';\nimport {Row} from './row.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about a spacer between two rows.\n *\n * @alias Blockly.blockRendering.SpacerRow\n */\nexport class SpacerRow extends Row {\n  followsStatement = false;\n\n  precedesStatement = false;\n\n  override widthWithConnectedBlocks = 0;\n  override elements: InRowSpacer[];\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param height The height of the spacer.\n   * @param width The width of the spacer.\n   * @internal\n   */\n  constructor(\n      constants: ConstantProvider, public override height: number,\n      public override width: number) {\n    super(constants);\n    this.type |= Types.SPACER | Types.BETWEEN_ROW_SPACER;\n\n    this.elements = [new InRowSpacer(this.constants_, width)];\n  }\n\n  override measure() {}\n}\n// NOP.  Width and height were set at creation.\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Objects representing a square corner in a row of a rendered\n * block.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.SquareCorner');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about the space a square corner takes up\n * during rendering.\n *\n * @alias Blockly.blockRendering.SquareCorner\n */\nexport class SquareCorner extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   * @param opt_position The position of this corner.\n   * @internal\n   */\n  constructor(constants: ConstantProvider, opt_position?: string) {\n    super(constants);\n    this.type =\n        (!opt_position || opt_position === 'left' ? Types.LEFT_SQUARE_CORNER :\n                                                    Types.RIGHT_SQUARE_CORNER) |\n        Types.CORNER;\n    this.height = this.constants_.NO_PADDING;\n    this.width = this.constants_.NO_PADDING;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a top row on a rendered block.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.TopRow');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Hat} from './hat.js';\nimport type {PreviousConnection} from './previous_connection.js';\nimport {Row} from './row.js';\nimport {Types} from './types.js';\n\n\n/**\n * An object containing information about what elements are in the top row of a\n * block as well as sizing information for the top row.\n * Elements in a top row can consist of corners, hats, spacers, and previous\n * connections.\n * After this constructor is called, the row will contain all non-spacer\n * elements it needs.\n *\n * @alias Blockly.blockRendering.TopRow\n */\nexport class TopRow extends Row {\n  /**\n   * The starting point for drawing the row, in the y direction.\n   * This allows us to draw hats and similar shapes that don't start at the\n   * origin. Must be non-negative (see #2820).\n   *\n   * @internal\n   */\n  capline = 0;\n\n  /** How much the row extends up above its capline. */\n  ascenderHeight = 0;\n\n  /** Whether the block has a previous connection. */\n  hasPreviousConnection = false;\n\n  /** The previous connection on the block, if any. */\n  connection: PreviousConnection|null = null;\n  override widthWithConnectedBlocks: AnyDuringMigration;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @internal\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n\n    this.type |= Types.TOP_ROW;\n  }\n\n  /**\n   * Returns whether or not the top row has a left square corner.\n   *\n   * @param block The block whose top row this represents.\n   * @returns Whether or not the top row has a left square corner.\n   * @internal\n   */\n  hasLeftSquareCorner(block: BlockSvg): boolean {\n    const hasHat =\n        (block.hat ? block.hat === 'cap' : this.constants_.ADD_START_HATS) &&\n        !block.outputConnection && !block.previousConnection;\n    const prevBlock = block.getPreviousBlock();\n\n    return !!block.outputConnection || hasHat ||\n        (prevBlock ? prevBlock.getNextBlock() === block : false);\n  }\n\n  /**\n   * Returns whether or not the top row has a right square corner.\n   *\n   * @param _block The block whose top row this represents.\n   * @returns Whether or not the top row has a right square corner.\n   */\n  hasRightSquareCorner(_block: BlockSvg): boolean {\n    return true;\n  }\n\n  override measure() {\n    let height = 0;\n    let width = 0;\n    let ascenderHeight = 0;\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      width += elem.width;\n      if (!Types.isSpacer(elem)) {\n        // AnyDuringMigration because:  Property 'isHat' does not exist on type\n        // 'typeof Types'.\n        if ((Types as AnyDuringMigration).isHat(elem) && elem instanceof Hat) {\n          ascenderHeight = Math.max(ascenderHeight, elem.ascenderHeight);\n        } else {\n          height = Math.max(height, elem.height);\n        }\n      }\n    }\n    this.width = Math.max(this.minWidth, width);\n    this.height = Math.max(this.minHeight, height) + ascenderHeight;\n    this.ascenderHeight = ascenderHeight;\n    this.capline = this.ascenderHeight;\n    this.widthWithConnectedBlocks = this.width;\n  }\n\n  override startsWithElemSpacer() {\n    return false;\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object that provides constants for rendering blocks.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.ConstantProvider');\n\nimport {ConnectionType} from '../../connection_type.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {BlockStyle, Theme} from '../../theme.js';\nimport * as colour from '../../utils/colour.js';\nimport * as dom from '../../utils/dom.js';\nimport * as parsing from '../../utils/parsing.js';\nimport {Svg} from '../../utils/svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\n\n\n/** An object containing sizing and path information about outside corners. */\nexport interface OutsideCorners {\n  topLeft: string;\n  topRight: string;\n  bottomRight: string;\n  bottomLeft: string;\n  rightHeight: number;\n}\n\n/** An object containing sizing and path information about inside corners. */\nexport interface InsideCorners {\n  width: number;\n  height: number;\n  pathTop: string;\n  pathBottom: string;\n}\n\n/** An object containing sizing and path information about a start hat. */\nexport interface StartHat {\n  height: number;\n  width: number;\n  path: string;\n}\n\n/** An object containing sizing and path information about a notch. */\nexport interface Notch {\n  type: number;\n  width: number;\n  height: number;\n  pathLeft: string;\n  pathRight: string;\n}\n\n/** An object containing sizing and path information about a puzzle tab. */\nexport interface PuzzleTab {\n  type: number;\n  width: number;\n  height: number;\n  pathDown: string|((p1: number) => string);\n  pathUp: string|((p1: number) => string);\n}\n\n/**\n * An object containing sizing and path information about collapsed block\n * indicators.\n */\nexport interface JaggedTeeth {\n  height: number;\n  width: number;\n  path: string;\n}\n\nexport type BaseShape = {\n  type: number; width: number; height: number;\n};\n\n/** An object containing sizing and type information about a dynamic shape. */\nexport type DynamicShape = {\n  type: number; width: (p1: number) => number; height: (p1: number) => number;\n  isDynamic: true;\n  connectionOffsetY: (p1: number) => number;\n  connectionOffsetX: (p1: number) => number;\n  pathDown: (p1: number) => string;\n  pathUp: (p1: number) => string;\n  pathRightDown: (p1: number) => string;\n  pathRightUp: (p1: number) => string;\n};\n\n/** An object containing sizing and type information about a shape. */\nexport type Shape = BaseShape|DynamicShape;\n\n/**\n * An object that provides constants for rendering blocks.\n *\n * @alias Blockly.blockRendering.ConstantProvider\n */\nexport class ConstantProvider {\n  /** The size of an empty spacer. */\n  NO_PADDING = 0;\n\n  /** The size of small padding. */\n  SMALL_PADDING = 3;\n\n  /** The size of medium padding. */\n  MEDIUM_PADDING = 5;\n\n  /** The size of medium-large padding. */\n  MEDIUM_LARGE_PADDING = 8;\n\n  /** The size of large padding. */\n  LARGE_PADDING = 10;\n  TALL_INPUT_FIELD_OFFSET_Y: number;\n\n  /** The height of the puzzle tab used for input and output connections. */\n  TAB_HEIGHT = 15;\n\n  /**\n   * The offset from the top of the block at which a puzzle tab is positioned.\n   */\n  TAB_OFFSET_FROM_TOP = 5;\n\n  /**\n   * Vertical overlap of the puzzle tab, used to make it look more like a\n   * puzzle piece.\n   */\n  TAB_VERTICAL_OVERLAP = 2.5;\n\n  /** The width of the puzzle tab used for input and output connections. */\n  TAB_WIDTH = 8;\n\n  /** The width of the notch used for previous and next connections. */\n  NOTCH_WIDTH = 15;\n\n  /** The height of the notch used for previous and next connections. */\n  NOTCH_HEIGHT = 4;\n\n  /** The minimum width of the block. */\n  MIN_BLOCK_WIDTH = 12;\n  EMPTY_BLOCK_SPACER_HEIGHT = 16;\n  DUMMY_INPUT_MIN_HEIGHT: number;\n  DUMMY_INPUT_SHADOW_MIN_HEIGHT: number;\n\n  /** Rounded corner radius. */\n  CORNER_RADIUS = 8;\n\n  /**\n   * Offset from the left side of a block or the inside of a statement input\n   * to the left side of the notch.\n   */\n  NOTCH_OFFSET_LEFT = 15;\n  STATEMENT_INPUT_NOTCH_OFFSET: number;\n\n  STATEMENT_BOTTOM_SPACER = 0;\n  STATEMENT_INPUT_PADDING_LEFT = 20;\n\n  /** Vertical padding between consecutive statement inputs. */\n  BETWEEN_STATEMENT_PADDING_Y = 4;\n  TOP_ROW_MIN_HEIGHT: number;\n  TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT: number;\n  BOTTOM_ROW_MIN_HEIGHT: number;\n  BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT: number;\n\n  /**\n   * Whether to add a 'hat' on top of all blocks with no previous or output\n   * connections. Can be overridden by 'hat' property on Theme.BlockStyle.\n   */\n  ADD_START_HATS = false;\n\n  /** Height of the top hat. */\n  START_HAT_HEIGHT = 15;\n\n  /** Width of the top hat. */\n  START_HAT_WIDTH = 100;\n\n  SPACER_DEFAULT_HEIGHT = 15;\n\n  MIN_BLOCK_HEIGHT = 24;\n\n  EMPTY_INLINE_INPUT_PADDING = 14.5;\n  EMPTY_INLINE_INPUT_HEIGHT: number;\n\n  EXTERNAL_VALUE_INPUT_PADDING = 2;\n  EMPTY_STATEMENT_INPUT_HEIGHT: number;\n  START_POINT: AnyDuringMigration;\n\n  /** Height of SVG path for jagged teeth at the end of collapsed blocks. */\n  JAGGED_TEETH_HEIGHT = 12;\n\n  /** Width of SVG path for jagged teeth at the end of collapsed blocks. */\n  JAGGED_TEETH_WIDTH = 6;\n\n  /** Point size of text. */\n  FIELD_TEXT_FONTSIZE = 11;\n\n  /** Text font weight. */\n  FIELD_TEXT_FONTWEIGHT = 'normal';\n\n  /** Text font family. */\n  FIELD_TEXT_FONTFAMILY = 'sans-serif';\n\n  /**\n   * Height of text.  This constant is dynamically set in\n   * `setFontConstants_` to be the height of the text based on the font\n   * used.\n   */\n  FIELD_TEXT_HEIGHT = -1;  // Dynamically set.\n\n  /**\n   * Text baseline.  This constant is dynamically set in `setFontConstants_`\n   * to be the baseline of the text based on the font used.\n   */\n  FIELD_TEXT_BASELINE = -1;  // Dynamically set.\n\n  /** A field's border rect corner radius. */\n  FIELD_BORDER_RECT_RADIUS = 4;\n\n  /** A field's border rect default height. */\n  FIELD_BORDER_RECT_HEIGHT = 16;\n\n  /** A field's border rect X padding. */\n  FIELD_BORDER_RECT_X_PADDING = 5;\n\n  /** A field's border rect Y padding. */\n  FIELD_BORDER_RECT_Y_PADDING = 3;\n\n  /**\n   * The backing colour of a field's border rect.\n   *\n   * @internal\n   */\n  FIELD_BORDER_RECT_COLOUR = '#fff';\n  FIELD_TEXT_BASELINE_CENTER: boolean;\n  FIELD_DROPDOWN_BORDER_RECT_HEIGHT: number;\n\n  /**\n   * Whether or not a dropdown field should add a border rect when in a shadow\n   * block.\n   */\n  FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW = false;\n\n  /**\n   * Whether or not a dropdown field's div should be coloured to match the\n   * block colours.\n   */\n  FIELD_DROPDOWN_COLOURED_DIV = false;\n\n  /** Whether or not a dropdown field uses a text or SVG arrow. */\n  FIELD_DROPDOWN_SVG_ARROW = false;\n  FIELD_DROPDOWN_SVG_ARROW_PADDING: number;\n\n  /** A dropdown field's SVG arrow size. */\n  FIELD_DROPDOWN_SVG_ARROW_SIZE = 12;\n  FIELD_DROPDOWN_SVG_ARROW_DATAURI: string;\n\n  /**\n   * Whether or not to show a box shadow around the widget div. This is only a\n   * feature of full block fields.\n   */\n  FIELD_TEXTINPUT_BOX_SHADOW = false;\n\n  /**\n   * Whether or not the colour field should display its colour value on the\n   * entire block.\n   */\n  FIELD_COLOUR_FULL_BLOCK = false;\n\n  /** A colour field's default width. */\n  FIELD_COLOUR_DEFAULT_WIDTH = 26;\n  FIELD_COLOUR_DEFAULT_HEIGHT: number;\n  FIELD_CHECKBOX_X_OFFSET: number;\n  /** @internal */\n  randomIdentifier: string;\n\n  /**\n   * The defs tag that contains all filters and patterns for this Blockly\n   * instance.\n   */\n  private defs_: SVGElement|null = null;\n\n  /**\n   * The ID of the emboss filter, or the empty string if no filter is set.\n   *\n   * @internal\n   */\n  embossFilterId = '';\n\n  /** The <filter> element to use for highlighting, or null if not set. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGElement'.\n  private embossFilter_: SVGElement = null as AnyDuringMigration;\n\n  /**\n   * The ID of the disabled pattern, or the empty string if no pattern is set.\n   *\n   * @internal\n   */\n  disabledPatternId = '';\n\n  /**\n   * The <pattern> element to use for disabled blocks, or null if not set.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGElement'.\n  private disabledPattern_: SVGElement = null as AnyDuringMigration;\n\n  /**\n   * The ID of the debug filter, or the empty string if no pattern is set.\n   */\n  debugFilterId = '';\n\n  /**\n   * The <filter> element to use for a debug highlight, or null if not set.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGElement'.\n  private debugFilter_: SVGElement = null as AnyDuringMigration;\n\n  /** The <style> element to use for injecting renderer specific CSS. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'HTMLStyleElement'.\n  private cssNode_: HTMLStyleElement = null as AnyDuringMigration;\n\n  /**\n   * Cursor colour.\n   *\n   * @internal\n   */\n  CURSOR_COLOUR = '#cc0a0a';\n\n  /**\n   * Immovable marker colour.\n   *\n   * @internal\n   */\n  MARKER_COLOUR = '#4286f4';\n\n  /**\n   * Width of the horizontal cursor.\n   *\n   * @internal\n   */\n  CURSOR_WS_WIDTH = 100;\n\n  /**\n   * Height of the horizontal cursor.\n   *\n   * @internal\n   */\n  WS_CURSOR_HEIGHT = 5;\n\n  /**\n   * Padding around a stack.\n   *\n   * @internal\n   */\n  CURSOR_STACK_PADDING = 10;\n\n  /**\n   * Padding around a block.\n   *\n   * @internal\n   */\n  CURSOR_BLOCK_PADDING = 2;\n\n  /**\n   * Stroke of the cursor.\n   *\n   * @internal\n   */\n  CURSOR_STROKE_WIDTH = 4;\n\n  /**\n   * Whether text input and colour fields fill up the entire source block.\n   *\n   * @internal\n   */\n  FULL_BLOCK_FIELDS = false;\n\n  /**\n   * The main colour of insertion markers, in hex.  The block is rendered a\n   * transparent grey by changing the fill opacity in CSS.\n   *\n   * @internal\n   */\n  INSERTION_MARKER_COLOUR = '#000000';\n\n  /**\n   * The insertion marker opacity.\n   *\n   * @internal\n   */\n  INSERTION_MARKER_OPACITY = 0.2;\n\n  SHAPES: {[key: string]: number} = {PUZZLE: 1, NOTCH: 2};\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  JAGGED_TEETH!: JaggedTeeth;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  NOTCH!: Notch;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  START_HAT!: StartHat;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  PUZZLE_TAB!: PuzzleTab;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  INSIDE_CORNERS!: InsideCorners;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  OUTSIDE_CORNERS!: OutsideCorners;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  /** @internal */\n  blockStyles!: {[key: string]: BlockStyle};\n\n  /** @internal */\n  constructor() {\n    /**\n     * Offset from the top of the row for placing fields on inline input rows\n     * and statement input rows.\n     * Matches existing rendering (in 2019).\n     */\n    this.TALL_INPUT_FIELD_OFFSET_Y = this.MEDIUM_PADDING;\n\n    /** The minimum height of a dummy input row. */\n    this.DUMMY_INPUT_MIN_HEIGHT = this.TAB_HEIGHT;\n\n    /** The minimum height of a dummy input row in a shadow block. */\n    this.DUMMY_INPUT_SHADOW_MIN_HEIGHT = this.TAB_HEIGHT;\n\n    /**\n     * Additional offset added to the statement input's width to account for the\n     * notch.\n     */\n    this.STATEMENT_INPUT_NOTCH_OFFSET = this.NOTCH_OFFSET_LEFT;\n\n    /** The top row's minimum height. */\n    this.TOP_ROW_MIN_HEIGHT = this.MEDIUM_PADDING;\n\n    /** The top row's minimum height if it precedes a statement. */\n    this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT = this.LARGE_PADDING;\n\n    /** The bottom row's minimum height. */\n    this.BOTTOM_ROW_MIN_HEIGHT = this.MEDIUM_PADDING;\n\n    /** The bottom row's minimum height if it follows a statement input. */\n    this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT = this.LARGE_PADDING;\n\n    /** The height of an empty inline input. */\n    this.EMPTY_INLINE_INPUT_HEIGHT = this.TAB_HEIGHT + 11;\n\n    /**\n     * The height of an empty statement input.  Note that in the old rendering\n     * this varies slightly depending on whether the block has external or\n     * inline inputs. In the new rendering this is consistent.  It seems\n     * unlikely that the old behaviour was intentional.\n     */\n    this.EMPTY_STATEMENT_INPUT_HEIGHT = this.MIN_BLOCK_HEIGHT;\n\n    this.START_POINT = svgPaths.moveBy(0, 0);\n\n    /**\n     * A field's text element's dominant baseline. Pre-2022 this could be false\n     * for certain browsers.\n     */\n    this.FIELD_TEXT_BASELINE_CENTER = true;\n\n    /** A dropdown field's border rect height. */\n    this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT = this.FIELD_BORDER_RECT_HEIGHT;\n\n    /** A dropdown field's SVG arrow padding. */\n    this.FIELD_DROPDOWN_SVG_ARROW_PADDING = this.FIELD_BORDER_RECT_X_PADDING;\n\n    /** A dropdown field's SVG arrow datauri. */\n    this.FIELD_DROPDOWN_SVG_ARROW_DATAURI =\n        'data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllci' +\n        'AxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaG' +\n        'VpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLW' +\n        'Fycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuND' +\n        'EsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTD' +\n        'AuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNz' +\n        'FDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMC' +\n        'wxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNz' +\n        'lhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYz' +\n        'AuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMz' +\n        'dBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=';\n\n    /** A colour field's default height. */\n    this.FIELD_COLOUR_DEFAULT_HEIGHT = this.FIELD_BORDER_RECT_HEIGHT;\n\n    /** A checkbox field's X offset. */\n    this.FIELD_CHECKBOX_X_OFFSET = this.FIELD_BORDER_RECT_X_PADDING - 3;\n\n    /**\n     * A random identifier used to ensure a unique ID is used for each\n     * filter/pattern for the case of multiple Blockly instances on a page.\n     *\n     * @internal\n     */\n    this.randomIdentifier = String(Math.random()).substring(2);\n  }\n\n  /**\n   * Initialize shape objects based on the constants set in the constructor.\n   *\n   * @internal\n   */\n  init() {\n    /**\n     * An object containing sizing and path information about collapsed block\n     * indicators.\n     */\n    this.JAGGED_TEETH = this.makeJaggedTeeth();\n\n    /** An object containing sizing and path information about notches. */\n    this.NOTCH = this.makeNotch();\n\n    /** An object containing sizing and path information about start hats */\n    this.START_HAT = this.makeStartHat();\n\n    /**\n     * An object containing sizing and path information about puzzle tabs.\n     */\n    this.PUZZLE_TAB = this.makePuzzleTab();\n\n    /**\n     * An object containing sizing and path information about inside corners\n     */\n    this.INSIDE_CORNERS = this.makeInsideCorners();\n\n    /**\n     * An object containing sizing and path information about outside corners.\n     */\n    this.OUTSIDE_CORNERS = this.makeOutsideCorners();\n  }\n\n  /**\n   * Refresh constants properties that depend on the theme.\n   *\n   * @param theme The current workspace theme.\n   * @internal\n   */\n  setTheme(theme: Theme) {\n    /** The block styles map. */\n    this.blockStyles = Object.create(null);\n\n    const blockStyles = theme.blockStyles;\n    for (const key in blockStyles) {\n      this.blockStyles[key] = this.validatedBlockStyle_(blockStyles[key]);\n    }\n\n    this.setDynamicProperties_(theme);\n  }\n\n  /**\n   * Sets dynamic properties that depend on other values or theme properties.\n   *\n   * @param theme The current workspace theme.\n   */\n  protected setDynamicProperties_(theme: Theme) {\n    this.setFontConstants_(theme);\n    this.setComponentConstants_(theme);\n\n    this.ADD_START_HATS =\n        theme.startHats !== null ? theme.startHats : this.ADD_START_HATS;\n  }\n\n  /**\n   * Set constants related to fonts.\n   *\n   * @param theme The current workspace theme.\n   */\n  protected setFontConstants_(theme: Theme) {\n    if (theme.fontStyle && theme.fontStyle['family']) {\n      this.FIELD_TEXT_FONTFAMILY = theme.fontStyle['family'];\n    }\n\n    if (theme.fontStyle && theme.fontStyle['weight']) {\n      this.FIELD_TEXT_FONTWEIGHT = theme.fontStyle['weight'];\n    }\n\n    if (theme.fontStyle && theme.fontStyle['size']) {\n      this.FIELD_TEXT_FONTSIZE = theme.fontStyle['size'];\n    }\n\n    const fontMetrics = dom.measureFontMetrics(\n        'Hg', this.FIELD_TEXT_FONTSIZE + 'pt', this.FIELD_TEXT_FONTWEIGHT,\n        this.FIELD_TEXT_FONTFAMILY);\n\n    this.FIELD_TEXT_HEIGHT = fontMetrics.height;\n    this.FIELD_TEXT_BASELINE = fontMetrics.baseline;\n  }\n\n  /**\n   * Set constants from a theme's component styles.\n   *\n   * @param theme The current workspace theme.\n   */\n  protected setComponentConstants_(theme: Theme) {\n    this.CURSOR_COLOUR =\n        theme.getComponentStyle('cursorColour') || this.CURSOR_COLOUR;\n    this.MARKER_COLOUR =\n        theme.getComponentStyle('markerColour') || this.MARKER_COLOUR;\n    this.INSERTION_MARKER_COLOUR =\n        theme.getComponentStyle('insertionMarkerColour') ||\n        this.INSERTION_MARKER_COLOUR;\n    this.INSERTION_MARKER_OPACITY =\n        Number(theme.getComponentStyle('insertionMarkerOpacity')) ||\n        this.INSERTION_MARKER_OPACITY;\n  }\n\n  /**\n   * Get or create a block style based on a single colour value.  Generate a\n   * name for the style based on the colour.\n   *\n   * @param colour #RRGGBB colour string.\n   * @returns An object containing the style and an autogenerated name for that\n   *     style.\n   * @internal\n   */\n  getBlockStyleForColour(colour: string): {style: BlockStyle, name: string} {\n    const name = 'auto_' + colour;\n    if (!this.blockStyles[name]) {\n      this.blockStyles[name] = this.createBlockStyle_(colour);\n    }\n    return {style: this.blockStyles[name], name};\n  }\n\n  /**\n   * Gets the BlockStyle for the given block style name.\n   *\n   * @param blockStyleName The name of the block style.\n   * @returns The named block style, or a default style if no style with the\n   *     given name was found.\n   */\n  getBlockStyle(blockStyleName: string|null): BlockStyle {\n    return this.blockStyles[blockStyleName || ''] ||\n        (blockStyleName && blockStyleName.indexOf('auto_') === 0 ?\n             this.getBlockStyleForColour(blockStyleName.substring(5)).style :\n             this.createBlockStyle_('#000000'));\n  }\n\n  /**\n   * Create a block style object based on the given colour.\n   *\n   * @param colour #RRGGBB colour string.\n   * @returns A populated block style based on the given colour.\n   */\n  protected createBlockStyle_(colour: string): BlockStyle {\n    return this.validatedBlockStyle_({'colourPrimary': colour});\n  }\n\n  /**\n   * Get a full block style object based on the input style object.  Populate\n   * any missing values.\n   *\n   * @param blockStyle A full or partial block style object.\n   * @returns A full block style object, with all required properties populated.\n   */\n  protected validatedBlockStyle_(blockStyle: {\n    colourPrimary: string,\n    colourSecondary?: string,\n    colourTertiary?: string,\n    hat?: string\n  }): BlockStyle {\n    // Make a new object with all of the same properties.\n    const valid = {} as BlockStyle;\n    if (blockStyle) {\n      Object.assign(valid, blockStyle);\n    }\n    // Validate required properties.\n    const parsedColour =\n        parsing.parseBlockColour(valid['colourPrimary'] || '#000');\n    valid.colourPrimary = parsedColour.hex;\n    valid.colourSecondary = valid['colourSecondary'] ?\n        parsing.parseBlockColour(valid['colourSecondary']).hex :\n        this.generateSecondaryColour_(valid.colourPrimary);\n    valid.colourTertiary = valid['colourTertiary'] ?\n        parsing.parseBlockColour(valid['colourTertiary']).hex :\n        this.generateTertiaryColour_(valid.colourPrimary);\n\n    valid.hat = valid['hat'] || '';\n    return valid;\n  }\n\n  /**\n   * Generate a secondary colour from the passed in primary colour.\n   *\n   * @param inputColour Primary colour.\n   * @returns The generated secondary colour.\n   */\n  protected generateSecondaryColour_(inputColour: string): string {\n    return colour.blend('#fff', inputColour, 0.6) || inputColour;\n  }\n\n  /**\n   * Generate a tertiary colour from the passed in primary colour.\n   *\n   * @param inputColour Primary colour.\n   * @returns The generated tertiary colour.\n   */\n  protected generateTertiaryColour_(inputColour: string): string {\n    return colour.blend('#fff', inputColour, 0.3) || inputColour;\n  }\n\n  /**\n   * Dispose of this constants provider.\n   * Delete all DOM elements that this provider created.\n   *\n   * @internal\n   */\n  dispose() {\n    if (this.embossFilter_) {\n      dom.removeNode(this.embossFilter_);\n    }\n    if (this.disabledPattern_) {\n      dom.removeNode(this.disabledPattern_);\n    }\n    if (this.debugFilter_) {\n      dom.removeNode(this.debugFilter_);\n    }\n    // AnyDuringMigration because:  Type 'null' is not assignable to type\n    // 'HTMLStyleElement'.\n    this.cssNode_ = null as AnyDuringMigration;\n  }\n\n  /**\n   * @returns An object containing sizing and path information about collapsed\n   *     block indicators.\n   * @internal\n   */\n  makeJaggedTeeth(): JaggedTeeth {\n    const height = this.JAGGED_TEETH_HEIGHT;\n    const width = this.JAGGED_TEETH_WIDTH;\n\n    const mainPath = svgPaths.line([\n      svgPaths.point(width, height / 4),\n      svgPaths.point(-width * 2, height / 2),\n      svgPaths.point(width, height / 4),\n    ]);\n    return {height, width, path: mainPath};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about start hats.\n   * @internal\n   */\n  makeStartHat(): StartHat {\n    const height = this.START_HAT_HEIGHT;\n    const width = this.START_HAT_WIDTH;\n\n    const mainPath = svgPaths.curve('c', [\n      svgPaths.point(30, -height),\n      svgPaths.point(70, -height),\n      svgPaths.point(width, 0),\n    ]);\n    return {height, width, path: mainPath};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about puzzle\n   *     tabs.\n   * @internal\n   */\n  makePuzzleTab(): PuzzleTab {\n    const width = this.TAB_WIDTH;\n    const height = this.TAB_HEIGHT;\n\n    /**\n     * Make the main path for the puzzle tab made out of a few curves (c and s).\n     * Those curves are defined with relative positions.  The 'up' and 'down'\n     * versions of the paths are the same, but the Y sign flips.  Forward and\n     * back are the signs to use to move the cursor in the direction that the\n     * path is being drawn.\n     *\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @returns A path fragment describing a puzzle tab.\n     */\n    function makeMainPath(up: boolean): string {\n      const forward = up ? -1 : 1;\n      const back = -forward;\n\n      const overlap = 2.5;\n      const halfHeight = height / 2;\n      const control1Y = halfHeight + overlap;\n      const control2Y = halfHeight + 0.5;\n      const control3Y = overlap;  // 2.5\n\n      const endPoint1 = svgPaths.point(-width, forward * halfHeight);\n      const endPoint2 = svgPaths.point(width, forward * halfHeight);\n\n      return svgPaths.curve(\n                 'c',\n                 [\n                   svgPaths.point(0, forward * control1Y),\n                   svgPaths.point(-width, back * control2Y),\n                   endPoint1,\n                 ]) +\n          svgPaths.curve(\n              's', [svgPaths.point(width, back * control3Y), endPoint2]);\n    }\n\n    // c 0,-10  -8,8  -8,-7.5  s 8,2.5  8,-7.5\n    const pathUp = makeMainPath(true);\n    // c 0,10  -8,-8  -8,7.5  s 8,-2.5  8,7.5\n    const pathDown = makeMainPath(false);\n\n    return {\n      type: this.SHAPES.PUZZLE,\n      width,\n      height,\n      pathDown,\n      pathUp,\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about notches.\n   * @internal\n   */\n  makeNotch(): Notch {\n    const width = this.NOTCH_WIDTH;\n    const height = this.NOTCH_HEIGHT;\n    const innerWidth = 3;\n    const outerWidth = (width - innerWidth) / 2;\n\n    /**\n     * Make the main path for the notch.\n     *\n     * @param dir Direction multiplier to apply to horizontal offsets along the\n     *     path. Either 1 or -1.\n     * @returns A path fragment describing a notch.\n     */\n    function makeMainPath(dir: number): string {\n      return svgPaths.line([\n        svgPaths.point(dir * outerWidth, height),\n        svgPaths.point(dir * innerWidth, 0),\n        svgPaths.point(dir * outerWidth, -height),\n      ]);\n    }\n    const pathLeft = makeMainPath(1);\n    const pathRight = makeMainPath(-1);\n\n    return {\n      type: this.SHAPES.NOTCH,\n      width,\n      height,\n      pathLeft,\n      pathRight,\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about inside\n   *     corners.\n   * @internal\n   */\n  makeInsideCorners(): InsideCorners {\n    const radius = this.CORNER_RADIUS;\n\n    const innerTopLeftCorner =\n        svgPaths.arc('a', '0 0,0', radius, svgPaths.point(-radius, radius));\n\n    const innerBottomLeftCorner =\n        svgPaths.arc('a', '0 0,0', radius, svgPaths.point(radius, radius));\n\n    return {\n      width: radius,\n      height: radius,\n      pathTop: innerTopLeftCorner,\n      pathBottom: innerBottomLeftCorner,\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about outside\n   *     corners.\n   * @internal\n   */\n  makeOutsideCorners(): OutsideCorners {\n    const radius = this.CORNER_RADIUS;\n    /** SVG path for drawing the rounded top-left corner. */\n    const topLeft = svgPaths.moveBy(0, radius) +\n        svgPaths.arc('a', '0 0,1', radius, svgPaths.point(radius, -radius));\n\n    /** SVG path for drawing the rounded top-right corner. */\n    const topRight =\n        svgPaths.arc('a', '0 0,1', radius, svgPaths.point(radius, radius));\n\n    /** SVG path for drawing the rounded bottom-left corner. */\n    const bottomLeft =\n        svgPaths.arc('a', '0 0,1', radius, svgPaths.point(-radius, -radius));\n\n    /** SVG path for drawing the rounded bottom-right corner. */\n    const bottomRight =\n        svgPaths.arc('a', '0 0,1', radius, svgPaths.point(-radius, radius));\n\n    return {\n      topLeft,\n      topRight,\n      bottomRight,\n      bottomLeft,\n      rightHeight: radius,\n    };\n  }\n\n  /**\n   * Get an object with connection shape and sizing information based on the\n   * type of the connection.\n   *\n   * @param connection The connection to find a shape object for\n   * @returns The shape object for the connection.\n   * @internal\n   */\n  shapeFor(connection: RenderedConnection): Shape {\n    switch (connection.type) {\n      case ConnectionType.INPUT_VALUE:\n      case ConnectionType.OUTPUT_VALUE:\n        return this.PUZZLE_TAB;\n      case ConnectionType.PREVIOUS_STATEMENT:\n      case ConnectionType.NEXT_STATEMENT:\n        return this.NOTCH;\n      default:\n        throw Error('Unknown connection type');\n    }\n  }\n\n  /**\n   * Create any DOM elements that this renderer needs (filters, patterns, etc).\n   *\n   * @param svg The root of the workspace's SVG.\n   * @param tagName The name to use for the CSS style tag.\n   * @param selector The CSS selector to use.\n   * @suppress {strictModuleDepCheck} Debug renderer only included in\n   * playground.\n   * @internal\n   */\n  createDom(svg: SVGElement, tagName: string, selector: string) {\n    this.injectCSS_(tagName, selector);\n\n    /*\n        <defs>\n          ... filters go here ...\n        </defs>\n        */\n    this.defs_ = dom.createSvgElement(Svg.DEFS, {}, svg);\n    /*\n          <filter id=\"blocklyEmbossFilter837493\">\n            <feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"1\" result=\"blur\" />\n            <feSpecularLighting in=\"blur\" surfaceScale=\"1\"\n       specularConstant=\"0.5\" specularExponent=\"10\" lighting-color=\"white\"\n                                result=\"specOut\">\n              <fePointLight x=\"-5000\" y=\"-10000\" z=\"20000\" />\n            </feSpecularLighting>\n            <feComposite in=\"specOut\" in2=\"SourceAlpha\" operator=\"in\"\n                         result=\"specOut\" />\n            <feComposite in=\"SourceGraphic\" in2=\"specOut\" operator=\"arithmetic\"\n                         k1=\"0\" k2=\"1\" k3=\"1\" k4=\"0\" />\n          </filter>\n        */\n    // AnyDuringMigration because:  Argument of type 'SVGElement | null' is not\n    // assignable to parameter of type 'Element | undefined'.\n    const embossFilter = dom.createSvgElement(\n        Svg.FILTER, {'id': 'blocklyEmbossFilter' + this.randomIdentifier},\n        this.defs_ as AnyDuringMigration);\n    dom.createSvgElement(\n        Svg.FEGAUSSIANBLUR,\n        {'in': 'SourceAlpha', 'stdDeviation': 1, 'result': 'blur'},\n        embossFilter);\n    const feSpecularLighting = dom.createSvgElement(\n        Svg.FESPECULARLIGHTING, {\n          'in': 'blur',\n          'surfaceScale': 1,\n          'specularConstant': 0.5,\n          'specularExponent': 10,\n          'lighting-color': 'white',\n          'result': 'specOut',\n        },\n        embossFilter);\n    dom.createSvgElement(\n        Svg.FEPOINTLIGHT, {'x': -5000, 'y': -10000, 'z': 20000},\n        feSpecularLighting);\n    dom.createSvgElement(\n        Svg.FECOMPOSITE, {\n          'in': 'specOut',\n          'in2': 'SourceAlpha',\n          'operator': 'in',\n          'result': 'specOut',\n        },\n        embossFilter);\n    dom.createSvgElement(\n        Svg.FECOMPOSITE, {\n          'in': 'SourceGraphic',\n          'in2': 'specOut',\n          'operator': 'arithmetic',\n          'k1': 0,\n          'k2': 1,\n          'k3': 1,\n          'k4': 0,\n        },\n        embossFilter);\n    this.embossFilterId = embossFilter.id;\n    this.embossFilter_ = embossFilter;\n\n    /*\n          <pattern id=\"blocklyDisabledPattern837493\"\n       patternUnits=\"userSpaceOnUse\" width=\"10\" height=\"10\"> <rect width=\"10\"\n       height=\"10\" fill=\"#aaa\" /> <path d=\"M 0 0 L 10 10 M 10 0 L 0 10\"\n       stroke=\"#cc0\" />\n          </pattern>\n        */\n    // AnyDuringMigration because:  Argument of type 'SVGElement | null' is not\n    // assignable to parameter of type 'Element | undefined'.\n    const disabledPattern = dom.createSvgElement(\n        Svg.PATTERN, {\n          'id': 'blocklyDisabledPattern' + this.randomIdentifier,\n          'patternUnits': 'userSpaceOnUse',\n          'width': 10,\n          'height': 10,\n        },\n        this.defs_ as AnyDuringMigration);\n    dom.createSvgElement(\n        Svg.RECT, {'width': 10, 'height': 10, 'fill': '#aaa'}, disabledPattern);\n    dom.createSvgElement(\n        Svg.PATH, {'d': 'M 0 0 L 10 10 M 10 0 L 0 10', 'stroke': '#cc0'},\n        disabledPattern);\n    this.disabledPatternId = disabledPattern.id;\n    this.disabledPattern_ = disabledPattern;\n\n    this.createDebugFilter();\n  }\n\n  /**\n   * Create a filter for highlighting the currently rendering block during\n   * render debugging.\n   */\n  private createDebugFilter() {\n    // Only create the debug filter once.\n    if (!this.debugFilter_) {\n      // AnyDuringMigration because:  Argument of type 'SVGElement | null' is\n      // not assignable to parameter of type 'Element | undefined'.\n      const debugFilter = dom.createSvgElement(\n          Svg.FILTER, {\n            'id': 'blocklyDebugFilter' + this.randomIdentifier,\n            'height': '160%',\n            'width': '180%',\n            'y': '-30%',\n            'x': '-40%',\n          },\n          this.defs_ as AnyDuringMigration);\n      // Set all gaussian blur pixels to 1 opacity before applying flood\n      const debugComponentTransfer = dom.createSvgElement(\n          Svg.FECOMPONENTTRANSFER, {'result': 'outBlur'}, debugFilter);\n      dom.createSvgElement(\n          Svg.FEFUNCA,\n          {'type': 'table', 'tableValues': '0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1'},\n          debugComponentTransfer);\n      // Color the highlight\n      dom.createSvgElement(\n          Svg.FEFLOOD, {\n            'flood-color': '#ff0000',\n            'flood-opacity': 0.5,\n            'result': 'outColor',\n          },\n          debugFilter);\n      dom.createSvgElement(\n          Svg.FECOMPOSITE, {\n            'in': 'outColor',\n            'in2': 'outBlur',\n            'operator': 'in',\n            'result': 'outGlow',\n          },\n          debugFilter);\n      this.debugFilterId = debugFilter.id;\n      this.debugFilter_ = debugFilter;\n    }\n  }\n\n  /**\n   * Inject renderer specific CSS into the page.\n   *\n   * @param tagName The name of the style tag to use.\n   * @param selector The CSS selector to use.\n   */\n  protected injectCSS_(tagName: string, selector: string) {\n    const cssArray = this.getCSS_(selector);\n    const cssNodeId = 'blockly-renderer-style-' + tagName;\n    this.cssNode_ = document.getElementById(cssNodeId) as HTMLStyleElement;\n    const text = cssArray.join('\\n');\n    if (this.cssNode_) {\n      // Already injected, update if the theme changed.\n      this.cssNode_.firstChild!.textContent = text;\n      return;\n    }\n    // Inject CSS tag at start of head.\n    const cssNode = (document.createElement('style'));\n    cssNode.id = cssNodeId;\n    const cssTextNode = document.createTextNode(text);\n    cssNode.appendChild(cssTextNode);\n    document.head.insertBefore(cssNode, document.head.firstChild);\n    this.cssNode_ = cssNode;\n  }\n\n  /**\n   * Get any renderer specific CSS to inject when the renderer is initialized.\n   *\n   * @param selector CSS selector to use.\n   * @returns Array of CSS strings.\n   */\n  protected getCSS_(selector: string): string[] {\n    return [\n      /* eslint-disable indent */\n      /* clang-format off */\n      // Text.\n      `${selector} .blocklyText, `,\n      `${selector} .blocklyFlyoutLabelText {`,\n        `font: ${this.FIELD_TEXT_FONTWEIGHT} ` +\n            `${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,\n      `}`,\n\n      // Fields.\n      `${selector} .blocklyText {`,\n        `fill: #fff;`,\n      `}`,\n      `${selector} .blocklyNonEditableText>rect,`,\n      `${selector} .blocklyEditableText>rect {`,\n        `fill: ${this.FIELD_BORDER_RECT_COLOUR};`,\n        `fill-opacity: .6;`,\n        `stroke: none;`,\n      `}`,\n      `${selector} .blocklyNonEditableText>text,`,\n      `${selector} .blocklyEditableText>text {`,\n        `fill: #000;`,\n      `}`,\n\n      // Flyout labels.\n      `${selector} .blocklyFlyoutLabelText {`,\n        `fill: #000;`,\n      `}`,\n\n      // Bubbles.\n      `${selector} .blocklyText.blocklyBubbleText {`,\n        `fill: #000;`,\n      `}`,\n\n      // Editable field hover.\n      `${selector} .blocklyEditableText:not(.editing):hover>rect {`,\n        `stroke: #fff;`,\n        `stroke-width: 2;`,\n      `}`,\n\n      // Text field input.\n      `${selector} .blocklyHtmlInput {`,\n        `font-family: ${this.FIELD_TEXT_FONTFAMILY};`,\n        `font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,\n      `}`,\n\n      // Selection highlight.\n      `${selector} .blocklySelected>.blocklyPath {`,\n        `stroke: #fc3;`,\n        `stroke-width: 3px;`,\n      `}`,\n\n      // Connection highlight.\n      `${selector} .blocklyHighlightedConnectionPath {`,\n        `stroke: #fc3;`,\n      `}`,\n\n      // Replaceable highlight.\n      `${selector} .blocklyReplaceable .blocklyPath {`,\n        `fill-opacity: .5;`,\n      `}`,\n      `${selector} .blocklyReplaceable .blocklyPathLight,`,\n      `${selector} .blocklyReplaceable .blocklyPathDark {`,\n        `display: none;`,\n      `}`,\n\n      // Insertion marker.\n      `${selector} .blocklyInsertionMarker>.blocklyPath {`,\n        `fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,\n        `stroke: none;`,\n      `}`,\n      /* clang-format on */\n      /* eslint-enable indent */\n    ];\n  }\n}\n/* clang-format on */\n/* eslint-enable indent */\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for rendering debug graphics.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Debug');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {ConnectionType} from '../../connection_type.js';\nimport {FieldLabel} from '../../field_label.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport type {Measurable} from '../measurables/base.js';\nimport {Field} from '../measurables/field.js';\nimport type {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport {InputConnection} from '../measurables/input_connection.js';\nimport type {Row} from '../measurables/row.js';\nimport {Types} from '../measurables/types.js';\nimport type {RenderInfo as ZelosInfo} from '../zelos/info.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport type {RenderInfo} from './info.js';\n\n\n/**\n * An object that renders rectangles and dots for debugging rendering code.\n *\n * @alias Blockly.blockRendering.Debug\n */\nexport class Debug {\n  /**\n   * Configuration object containing booleans to enable and disable debug\n   * rendering of specific rendering components.\n   */\n  static config = {\n    rowSpacers: true,\n    elemSpacers: true,\n    rows: true,\n    elems: true,\n    connections: true,\n    blockBounds: true,\n    connectedBlockBounds: true,\n    render: true,\n  };\n\n  /** An array of SVG elements that have been created by this object. */\n  private debugElements_: SVGElement[] = [];\n\n  /**\n   * The SVG root of the block that is being rendered.  Debug elements will\n   * be attached to this root.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGElement'.\n  private svgRoot_: SVGElement = null as AnyDuringMigration;\n\n  private randomColour_ = '';\n\n  /**\n   * @param constants The renderer's constants.\n   * @internal\n   */\n  constructor(private readonly constants: ConstantProvider) {}\n\n  /**\n   * Remove all elements the this object created on the last pass.\n   *\n   * @internal\n   */\n  clearElems() {\n    for (let i = 0; i < this.debugElements_.length; i++) {\n      const elem = this.debugElements_[i];\n      dom.removeNode(elem);\n    }\n\n    this.debugElements_ = [];\n  }\n\n  /**\n   * Draw a debug rectangle for a spacer (empty) row.\n   *\n   * @param row The row to render.\n   * @param cursorY The y position of the top of the row.\n   * @param isRtl Whether the block is rendered RTL.\n   * @internal\n   */\n  drawSpacerRow(row: Row, cursorY: number, isRtl: boolean) {\n    if (!Debug.config.rowSpacers) {\n      return;\n    }\n\n    const height = Math.abs(row.height);\n    const isNegativeSpacing = row.height < 0;\n    if (isNegativeSpacing) {\n      cursorY -= height;\n    }\n\n    this.debugElements_.push(dom.createSvgElement(\n        Svg.RECT, {\n          'class': 'rowSpacerRect blockRenderDebug',\n          'x': isRtl ? -(row.xPos + row.width) : row.xPos,\n          'y': cursorY,\n          'width': row.width,\n          'height': height,\n          'stroke': isNegativeSpacing ? 'black' : 'blue',\n          'fill': 'blue',\n          'fill-opacity': '0.5',\n          'stroke-width': '1px',\n        },\n        this.svgRoot_));\n  }\n\n  /**\n   * Draw a debug rectangle for a horizontal spacer.\n   *\n   * @param elem The spacer to render.\n   * @param rowHeight The height of the container row.\n   * @param isRtl Whether the block is rendered RTL.\n   * @internal\n   */\n  drawSpacerElem(elem: InRowSpacer, rowHeight: number, isRtl: boolean) {\n    if (!Debug.config.elemSpacers) {\n      return;\n    }\n\n    const width = Math.abs(elem.width);\n    const isNegativeSpacing = elem.width < 0;\n    let xPos = isNegativeSpacing ? elem.xPos - width : elem.xPos;\n    if (isRtl) {\n      xPos = -(xPos + width);\n    }\n    const yPos = elem.centerline - elem.height / 2;\n    this.debugElements_.push(dom.createSvgElement(\n        Svg.RECT, {\n          'class': 'elemSpacerRect blockRenderDebug',\n          'x': xPos,\n          'y': yPos,\n          'width': width,\n          'height': elem.height,\n          'stroke': 'pink',\n          'fill': isNegativeSpacing ? 'black' : 'pink',\n          'fill-opacity': '0.5',\n          'stroke-width': '1px',\n        },\n        this.svgRoot_));\n  }\n\n  /**\n   * Draw a debug rectangle for an in-row element.\n   *\n   * @param elem The element to render.\n   * @param isRtl Whether the block is rendered RTL.\n   * @internal\n   */\n  drawRenderedElem(elem: Measurable, isRtl: boolean) {\n    if (Debug.config.elems) {\n      let xPos = elem.xPos;\n      if (isRtl) {\n        xPos = -(xPos + elem.width);\n      }\n      const yPos = elem.centerline - elem.height / 2;\n      this.debugElements_.push(dom.createSvgElement(\n          Svg.RECT, {\n            'class': 'rowRenderingRect blockRenderDebug',\n            'x': xPos,\n            'y': yPos,\n            'width': elem.width,\n            'height': elem.height,\n            'stroke': 'black',\n            'fill': 'none',\n            'stroke-width': '1px',\n          },\n          this.svgRoot_));\n\n      if (Types.isField(elem) && elem instanceof Field &&\n          elem.field instanceof FieldLabel) {\n        const baseline = this.constants.FIELD_TEXT_BASELINE;\n        this.debugElements_.push(dom.createSvgElement(\n            Svg.RECT, {\n              'class': 'rowRenderingRect blockRenderDebug',\n              'x': xPos,\n              'y': yPos + baseline,\n              'width': elem.width,\n              'height': '0.1px',\n              'stroke': 'red',\n              'fill': 'none',\n              'stroke-width': '0.5px',\n            },\n            this.svgRoot_));\n      }\n    }\n\n    if (Types.isInput(elem) && elem instanceof InputConnection &&\n        Debug.config.connections) {\n      this.drawConnection(elem.connectionModel);\n    }\n  }\n\n  /**\n   * Draw a circle at the location of the given connection.  Inputs and outputs\n   * share the same colours, as do previous and next.  When positioned correctly\n   * a connected pair will look like a bullseye.\n   *\n   * @param conn The connection to circle.\n   * @suppress {visibility} Suppress visibility of conn.offsetInBlock_ since\n   * this is a debug module.\n   * @internal\n   */\n  drawConnection(conn: RenderedConnection) {\n    if (!Debug.config.connections) {\n      return;\n    }\n\n    let colour;\n    let size;\n    let fill;\n    if (conn.type === ConnectionType.INPUT_VALUE) {\n      size = 4;\n      colour = 'magenta';\n      fill = 'none';\n    } else if (conn.type === ConnectionType.OUTPUT_VALUE) {\n      size = 2;\n      colour = 'magenta';\n      fill = colour;\n    } else if (conn.type === ConnectionType.NEXT_STATEMENT) {\n      size = 4;\n      colour = 'goldenrod';\n      fill = 'none';\n    } else if (conn.type === ConnectionType.PREVIOUS_STATEMENT) {\n      size = 2;\n      colour = 'goldenrod';\n      fill = colour;\n    }\n    // AnyDuringMigration because:  Property 'offsetInBlock_' is private and\n    // only accessible within class 'RenderedConnection'. AnyDuringMigration\n    // because:  Property 'offsetInBlock_' is private and only accessible within\n    // class 'RenderedConnection'.\n    this.debugElements_.push(dom.createSvgElement(\n        Svg.CIRCLE, {\n          'class': 'blockRenderDebug',\n          'cx': (conn as AnyDuringMigration).offsetInBlock_.x,\n          'cy': (conn as AnyDuringMigration).offsetInBlock_.y,\n          'r': size,\n          'fill': fill,\n          'stroke': colour,\n        },\n        this.svgRoot_));\n  }\n\n  /**\n   * Draw a debug rectangle for a non-empty row.\n   *\n   * @param row The non-empty row to render.\n   * @param cursorY The y position of the top of the row.\n   * @param isRtl Whether the block is rendered RTL.\n   * @internal\n   */\n  drawRenderedRow(row: Row, cursorY: number, isRtl: boolean) {\n    if (!Debug.config.rows) {\n      return;\n    }\n    this.debugElements_.push(dom.createSvgElement(\n        Svg.RECT, {\n          'class': 'elemRenderingRect blockRenderDebug',\n          'x': isRtl ? -(row.xPos + row.width) : row.xPos,\n          'y': row.yPos,\n          'width': row.width,\n          'height': row.height,\n          'stroke': 'red',\n          'fill': 'none',\n          'stroke-width': '1px',\n        },\n        this.svgRoot_));\n\n    // AnyDuringMigration because:  Property 'isTopOrBottomRow' does not exist\n    // on type 'typeof Types'.\n    if ((Types as AnyDuringMigration).isTopOrBottomRow(row)) {\n      return;\n    }\n\n    if (Debug.config.connectedBlockBounds) {\n      this.debugElements_.push(dom.createSvgElement(\n          Svg.RECT, {\n            'class': 'connectedBlockWidth blockRenderDebug',\n            'x': isRtl ? -(row.xPos + row.widthWithConnectedBlocks) : row.xPos,\n            'y': row.yPos,\n            'width': row.widthWithConnectedBlocks,\n            'height': row.height,\n            'stroke': this.randomColour_,\n            'fill': 'none',\n            'stroke-width': '1px',\n            'stroke-dasharray': '3,3',\n          },\n          this.svgRoot_));\n    }\n  }\n\n  /**\n   * Draw debug rectangles for a non-empty row and all of its subcomponents.\n   *\n   * @param row The non-empty row to render.\n   * @param cursorY The y position of the top of the row.\n   * @param isRtl Whether the block is rendered RTL.\n   * @internal\n   */\n  drawRowWithElements(row: Row, cursorY: number, isRtl: boolean) {\n    for (let i = 0; i < row.elements.length; i++) {\n      const elem = row.elements[i];\n      if (!elem) {\n        console.warn('A row has an undefined or null element.', row, elem);\n        continue;\n      }\n      if (Types.isSpacer(elem)) {\n        this.drawSpacerElem(elem as InRowSpacer, row.height, isRtl);\n      } else {\n        this.drawRenderedElem(elem, isRtl);\n      }\n    }\n    this.drawRenderedRow(row, cursorY, isRtl);\n  }\n\n  /**\n   * Draw a debug rectangle around the entire block.\n   *\n   * @param info Rendering information about the block to debug.\n   * @internal\n   */\n  drawBoundingBox(info: RenderInfo) {\n    if (!Debug.config.blockBounds) {\n      return;\n    }\n    // Bounding box without children.\n    let xPos = info.RTL ? -info.width : 0;\n    const yPos = 0;\n    this.debugElements_.push(dom.createSvgElement(\n        Svg.RECT, {\n          'class': 'blockBoundingBox blockRenderDebug',\n          'x': xPos,\n          'y': yPos,\n          'width': info.width,\n          'height': info.height,\n          'stroke': 'black',\n          'fill': 'none',\n          'stroke-width': '1px',\n          'stroke-dasharray': '5,5',\n        },\n        this.svgRoot_));\n\n    if (Debug.config.connectedBlockBounds) {\n      // Bounding box with children.\n      xPos = info.RTL ? -info.widthWithChildren : 0;\n      this.debugElements_.push(dom.createSvgElement(\n          Svg.RECT, {\n            'class': 'blockRenderDebug',\n            'x': xPos,\n            'y': yPos,\n            'width': info.widthWithChildren,\n            'height': info.height,\n            'stroke': '#DF57BC',\n            'fill': 'none',\n            'stroke-width': '1px',\n            'stroke-dasharray': '3,3',\n          },\n          this.svgRoot_));\n    }\n  }\n\n  /**\n   * Do all of the work to draw debug information for the whole block.\n   *\n   * @param block The block to draw debug information for.\n   * @param info Rendering information about the block to debug.\n   * @internal\n   */\n  drawDebug(block: BlockSvg, info: RenderInfo) {\n    this.clearElems();\n    this.svgRoot_ = block.getSvgRoot();\n\n    this.randomColour_ =\n        '#' + Math.floor(Math.random() * 16777215).toString(16);\n\n    let cursorY = 0;\n    for (let i = 0; i < info.rows.length; i++) {\n      const row = info.rows[i];\n      if (Types.isBetweenRowSpacer(row)) {\n        this.drawSpacerRow(row, cursorY, info.RTL);\n      } else {\n        this.drawRowWithElements(row, cursorY, info.RTL);\n      }\n      cursorY += row.height;\n    }\n\n    if (block.previousConnection) {\n      this.drawConnection(block.previousConnection);\n    }\n    if (block.nextConnection) {\n      this.drawConnection(block.nextConnection);\n    }\n    if (block.outputConnection) {\n      this.drawConnection(block.outputConnection);\n    }\n    /**\n     * TODO: Find a better way to do this check without pulling in all of\n     * zelos, or just delete this line or the whole debug renderer.\n     */\n    const maybeZelosInfo = info as ZelosInfo;\n    if (maybeZelosInfo.rightSide) {\n      this.drawRenderedElem(maybeZelosInfo.rightSide, info.RTL);\n    }\n\n    this.drawBoundingBox(info);\n\n    this.drawRender(block.pathObject.svgPath);\n  }\n\n  /**\n   * Show a debug filter to highlight that a block has been rendered.\n   *\n   * @param svgPath The block's SVG path.\n   * @internal\n   */\n  drawRender(svgPath: SVGElement) {\n    if (!Debug.config.render) {\n      return;\n    }\n    svgPath.setAttribute(\n        'filter', 'url(#' + this.constants.debugFilterId + ')');\n    setTimeout(function() {\n      svgPath.setAttribute('filter', '');\n    }, 100);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for graphically rendering a block as SVG.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Drawer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport {Connection} from '../measurables/connection.js';\nimport type {ExternalValueInput} from '../measurables/external_value_input.js';\nimport type {Field} from '../measurables/field.js';\nimport type {Icon} from '../measurables/icon.js';\nimport type {InlineInput} from '../measurables/inline_input.js';\nimport type {PreviousConnection} from '../measurables/previous_connection.js';\nimport type {Row} from '../measurables/row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {ConstantProvider, Notch, PuzzleTab} from './constants.js';\nimport * as debug from './debug.js';\nimport type {RenderInfo} from './info.js';\n\n\n/**\n * An object that draws a block based on the given rendering information.\n *\n * @alias Blockly.blockRendering.Drawer\n */\nexport class Drawer {\n  block_: AnyDuringMigration;\n  info_: AnyDuringMigration;\n  topLeft_: AnyDuringMigration;\n  outlinePath_ = '';\n  inlinePath_ = '';\n  protected constants_: ConstantProvider;\n\n  /**\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @internal\n   */\n  constructor(block: BlockSvg, info: RenderInfo) {\n    this.block_ = block;\n    this.info_ = info;\n    this.topLeft_ = block.getRelativeToSurfaceXY();\n\n    /** The renderer's constant provider. */\n    this.constants_ = info.getRenderer().getConstants();\n  }\n\n  /**\n   * Draw the block to the workspace. Here \"drawing\" means setting SVG path\n   * elements and moving fields, icons, and connections on the screen.\n   *\n   * The pieces of the paths are pushed into arrays of \"steps\", which are then\n   * joined with spaces and set directly on the block.  This guarantees that\n   * the steps are separated by spaces for improved readability, but isn't\n   * required.\n   *\n   * @internal\n   */\n  draw() {\n    this.hideHiddenIcons_();\n    this.drawOutline_();\n    this.drawInternals_();\n\n    this.block_.pathObject.setPath(this.outlinePath_ + '\\n' + this.inlinePath_);\n    if (this.info_.RTL) {\n      this.block_.pathObject.flipRTL();\n    }\n    if (debug.isDebuggerEnabled()) {\n      this.block_.renderingDebugger.drawDebug(this.block_, this.info_);\n    }\n    this.recordSizeOnBlock_();\n  }\n\n  /**\n   * Save sizing information back to the block\n   * Most of the rendering information can be thrown away at the end of the\n   * render. Anything that needs to be kept around should be set in this\n   * function.\n   */\n  protected recordSizeOnBlock_() {\n    // This is used when the block is reporting its size to anyone else.\n    // The dark path adds to the size of the block in both X and Y.\n    this.block_.height = this.info_.height;\n    this.block_.width = this.info_.widthWithChildren;\n  }\n\n  /** Hide icons that were marked as hidden. */\n  protected hideHiddenIcons_() {\n    for (let i = 0, iconInfo; iconInfo = this.info_.hiddenIcons[i]; i++) {\n      iconInfo.icon.iconGroup_.setAttribute('display', 'none');\n    }\n  }\n\n  /** Create the outline of the block.  This is a single continuous path. */\n  protected drawOutline_() {\n    this.drawTop_();\n    for (let r = 1; r < this.info_.rows.length - 1; r++) {\n      const row = this.info_.rows[r];\n      if (row.hasJaggedEdge) {\n        this.drawJaggedEdge_(row);\n      } else if (row.hasStatement) {\n        this.drawStatementInput_(row);\n      } else if (row.hasExternalInput) {\n        this.drawValueInput_(row);\n      } else {\n        this.drawRightSideRow_(row);\n      }\n    }\n    this.drawBottom_();\n    this.drawLeft_();\n  }\n\n  /**\n   * Add steps for the top corner of the block, taking into account\n   * details such as hats and rounded corners.\n   */\n  protected drawTop_() {\n    const topRow = this.info_.topRow;\n    const elements = topRow.elements;\n\n    this.positionPreviousConnection_();\n    this.outlinePath_ += svgPaths.moveBy(topRow.xPos, this.info_.startY);\n    for (let i = 0, elem; elem = elements[i]; i++) {\n      if (Types.isLeftRoundedCorner(elem)) {\n        this.outlinePath_ += this.constants_.OUTSIDE_CORNERS.topLeft;\n      } else if (Types.isRightRoundedCorner(elem)) {\n        this.outlinePath_ += this.constants_.OUTSIDE_CORNERS.topRight;\n      } else if (\n          Types.isPreviousConnection(elem) && elem instanceof Connection) {\n        this.outlinePath_ +=\n            ((elem as PreviousConnection).shape as Notch).pathLeft;\n        // AnyDuringMigration because:  Property 'isHat' does not exist on type\n        // 'typeof Types'.\n      } else if ((Types as AnyDuringMigration).isHat(elem)) {\n        this.outlinePath_ += this.constants_.START_HAT.path;\n      } else if (Types.isSpacer(elem)) {\n        this.outlinePath_ += svgPaths.lineOnAxis('h', elem.width);\n      }\n    }\n    // No branch for a square corner, because it's a no-op.\n    this.outlinePath_ += svgPaths.lineOnAxis('v', topRow.height);\n  }\n\n  /**\n   * Add steps for the jagged edge of a row on a collapsed block.\n   *\n   * @param row The row to draw the side of.\n   */\n  protected drawJaggedEdge_(row: Row) {\n    const remainder = row.height - this.constants_.JAGGED_TEETH.height;\n    this.outlinePath_ +=\n        this.constants_.JAGGED_TEETH.path + svgPaths.lineOnAxis('v', remainder);\n  }\n\n  /**\n   * Add steps for an external value input, rendered as a notch in the side\n   * of the block.\n   *\n   * @param row The row that this input belongs to.\n   */\n  protected drawValueInput_(row: Row) {\n    const input = row.getLastInput() as ExternalValueInput | InlineInput;\n    this.positionExternalValueConnection_(row);\n\n    // AnyDuringMigration because:  Property 'pathDown' does not exist on type\n    // 'Shape'. AnyDuringMigration because:  Property 'pathDown' does not exist\n    // on type 'Shape'. AnyDuringMigration because:  Property 'pathDown' does\n    // not exist on type 'Shape'.\n    const pathDown =\n        typeof (input.shape as AnyDuringMigration).pathDown === 'function' ?\n        ((input.shape as AnyDuringMigration).pathDown as (p1: number) =>\n             AnyDuringMigration)(input.height) :\n        (input.shape as AnyDuringMigration).pathDown;\n\n    this.outlinePath_ += svgPaths.lineOnAxis('H', input.xPos + input.width) +\n        pathDown +\n        svgPaths.lineOnAxis('v', row.height - input.connectionHeight);\n  }\n\n  /**\n   * Add steps for a statement input.\n   *\n   * @param row The row that this input belongs to.\n   */\n  protected drawStatementInput_(row: Row) {\n    const input = row.getLastInput();\n    // Where to start drawing the notch, which is on the right side in LTR.\n    const x = input.xPos + input.notchOffset + (input.shape as Notch).width;\n\n    const innerTopLeftCorner = (input.shape as Notch).pathRight +\n        svgPaths.lineOnAxis(\n            'h', -(input.notchOffset - this.constants_.INSIDE_CORNERS.width)) +\n        this.constants_.INSIDE_CORNERS.pathTop;\n\n    const innerHeight = row.height - 2 * this.constants_.INSIDE_CORNERS.height;\n\n    this.outlinePath_ += svgPaths.lineOnAxis('H', x) + innerTopLeftCorner +\n        svgPaths.lineOnAxis('v', innerHeight) +\n        this.constants_.INSIDE_CORNERS.pathBottom +\n        svgPaths.lineOnAxis('H', row.xPos + row.width);\n\n    this.positionStatementInputConnection_(row);\n  }\n\n  /**\n   * Add steps for the right side of a row that does not have value or\n   * statement input connections.\n   *\n   * @param row The row to draw the side of.\n   */\n  protected drawRightSideRow_(row: Row) {\n    this.outlinePath_ += svgPaths.lineOnAxis('V', row.yPos + row.height);\n  }\n\n  /**\n   * Add steps for the bottom edge of a block, possibly including a notch\n   * for the next connection.\n   */\n  protected drawBottom_() {\n    const bottomRow = this.info_.bottomRow;\n    const elems = bottomRow.elements;\n    this.positionNextConnection_();\n\n    let rightCornerYOffset = 0;\n    let outlinePath = '';\n    for (let i = elems.length - 1, elem; elem = elems[i]; i--) {\n      if (Types.isNextConnection(elem) && elem instanceof Connection) {\n        outlinePath += (elem.shape as Notch).pathRight;\n      } else if (Types.isLeftSquareCorner(elem)) {\n        outlinePath += svgPaths.lineOnAxis('H', bottomRow.xPos);\n      } else if (Types.isLeftRoundedCorner(elem)) {\n        outlinePath += this.constants_.OUTSIDE_CORNERS.bottomLeft;\n      } else if (Types.isRightRoundedCorner(elem)) {\n        outlinePath += this.constants_.OUTSIDE_CORNERS.bottomRight;\n        rightCornerYOffset = this.constants_.OUTSIDE_CORNERS.rightHeight;\n      } else if (Types.isSpacer(elem)) {\n        outlinePath += svgPaths.lineOnAxis('h', elem.width * -1);\n      }\n    }\n\n    this.outlinePath_ +=\n        svgPaths.lineOnAxis('V', bottomRow.baseline - rightCornerYOffset);\n    this.outlinePath_ += outlinePath;\n  }\n\n  /**\n   * Add steps for the left side of the block, which may include an output\n   * connection\n   */\n  protected drawLeft_() {\n    const outputConnection = this.info_.outputConnection;\n    this.positionOutputConnection_();\n\n    if (outputConnection) {\n      const tabBottom =\n          outputConnection.connectionOffsetY + outputConnection.height;\n      const pathUp = typeof outputConnection.shape.pathUp === 'function' ?\n          (outputConnection.shape.pathUp as (p1: number) =>\n               AnyDuringMigration)(outputConnection.height) :\n          outputConnection.shape.pathUp;\n\n      // Draw a line up to the bottom of the tab.\n      this.outlinePath_ += svgPaths.lineOnAxis('V', tabBottom) + pathUp;\n    }\n    // Close off the path.  This draws a vertical line up to the start of the\n    // block's path, which may be either a rounded or a sharp corner.\n    this.outlinePath_ += 'z';\n  }\n\n  /**\n   * Draw the internals of the block: inline inputs, fields, and icons.  These\n   * do not depend on the outer path for placement.\n   */\n  protected drawInternals_() {\n    for (let i = 0, row; row = this.info_.rows[i]; i++) {\n      for (let j = 0, elem; elem = row.elements[j]; j++) {\n        if (Types.isInlineInput(elem)) {\n          this.drawInlineInput_(elem as InlineInput);\n        } else if (Types.isIcon(elem) || Types.isField(elem)) {\n          this.layoutField_(elem as Field | Icon);\n        }\n      }\n    }\n  }\n\n  /**\n   * Push a field or icon's new position to its SVG root.\n   *\n   * @param fieldInfo The rendering information for the field or icon.\n   */\n  protected layoutField_(fieldInfo: Icon|Field) {\n    let svgGroup;\n    if (Types.isField(fieldInfo)) {\n      // AnyDuringMigration because:  Property 'field' does not exist on type\n      // 'Icon | Field'.\n      svgGroup = (fieldInfo as AnyDuringMigration).field.getSvgRoot();\n    } else if (Types.isIcon(fieldInfo)) {\n      // AnyDuringMigration because:  Property 'icon' does not exist on type\n      // 'Icon | Field'.\n      svgGroup = (fieldInfo as AnyDuringMigration).icon.iconGroup_;\n    }\n\n    const yPos = fieldInfo.centerline - fieldInfo.height / 2;\n    let xPos = fieldInfo.xPos;\n    let scale = '';\n    if (this.info_.RTL) {\n      xPos = -(xPos + fieldInfo.width);\n      // AnyDuringMigration because:  Property 'flipRtl' does not exist on type\n      // 'Icon | Field'.\n      if ((fieldInfo as AnyDuringMigration).flipRtl) {\n        xPos += fieldInfo.width;\n        scale = 'scale(-1 1)';\n      }\n    }\n    if (Types.isIcon(fieldInfo)) {\n      svgGroup.setAttribute('display', 'block');\n      svgGroup.setAttribute(\n          'transform', 'translate(' + xPos + ',' + yPos + ')');\n      // AnyDuringMigration because:  Property 'icon' does not exist on type\n      // 'Icon | Field'.\n      (fieldInfo as AnyDuringMigration).icon.computeIconLocation();\n    } else {\n      svgGroup.setAttribute(\n          'transform', 'translate(' + xPos + ',' + yPos + ')' + scale);\n    }\n\n    if (this.info_.isInsertionMarker) {\n      // Fields and icons are invisible on insertion marker.  They still have to\n      // be rendered so that the block can be sized correctly.\n      svgGroup.setAttribute('display', 'none');\n    }\n  }\n\n  /**\n   * Add steps for an inline input.\n   *\n   * @param input The information about the input to render.\n   */\n  protected drawInlineInput_(input: InlineInput) {\n    const width = input.width;\n    const height = input.height;\n    const yPos = input.centerline - height / 2;\n\n    const connectionTop = input.connectionOffsetY;\n    const connectionBottom = input.connectionHeight + connectionTop;\n    const connectionRight = input.xPos + input.connectionWidth;\n\n    this.inlinePath_ += svgPaths.moveTo(connectionRight, yPos) +\n        svgPaths.lineOnAxis('v', connectionTop) +\n        (input.shape as PuzzleTab).pathDown +\n        svgPaths.lineOnAxis('v', height - connectionBottom) +\n        svgPaths.lineOnAxis('h', width - input.connectionWidth) +\n        svgPaths.lineOnAxis('v', -height) + 'z';\n\n    this.positionInlineInputConnection_(input);\n  }\n\n  /**\n   * Position the connection on an inline value input, taking into account\n   * RTL and the small gap between the parent block and child block which lets\n   * the parent block's dark path show through.\n   *\n   * @param input The information about the input that the connection is on.\n   */\n  protected positionInlineInputConnection_(input: InlineInput) {\n    const yPos = input.centerline - input.height / 2;\n    // Move the connection.\n    if (input.connectionModel) {\n      // xPos already contains info about startX\n      let connX = input.xPos + input.connectionWidth + input.connectionOffsetX;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(\n          connX, yPos + input.connectionOffsetY);\n    }\n  }\n\n  /**\n   * Position the connection on a statement input, taking into account\n   * RTL and the small gap between the parent block and child block which lets\n   * the parent block's dark path show through.\n   *\n   * @param row The row that the connection is on.\n   */\n  protected positionStatementInputConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input.connectionModel) {\n      let connX = row.xPos + row.statementEdge + input.notchOffset;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(connX, row.yPos);\n    }\n  }\n\n  /**\n   * Position the connection on an external value input, taking into account\n   * RTL and the small gap between the parent block and child block which lets\n   * the parent block's dark path show through.\n   *\n   * @param row The row that the connection is on.\n   */\n  protected positionExternalValueConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input.connectionModel) {\n      let connX = row.xPos + row.width;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(connX, row.yPos);\n    }\n  }\n\n  /** Position the previous connection on a block. */\n  protected positionPreviousConnection_() {\n    const topRow = this.info_.topRow;\n    if (topRow.connection) {\n      const x = topRow.xPos + topRow.notchOffset;\n      const connX = this.info_.RTL ? -x : x;\n      topRow.connection.connectionModel.setOffsetInBlock(connX, 0);\n    }\n  }\n\n  /** Position the next connection on a block. */\n  protected positionNextConnection_() {\n    const bottomRow = this.info_.bottomRow;\n\n    if (bottomRow.connection) {\n      const connInfo = bottomRow.connection;\n      const x = connInfo.xPos;  // Already contains info about startX.\n      const connX = this.info_.RTL ? -x : x;\n      connInfo.connectionModel.setOffsetInBlock(connX, bottomRow.baseline);\n    }\n  }\n\n  /** Position the output connection on a block. */\n  protected positionOutputConnection_() {\n    if (this.info_.outputConnection) {\n      const x =\n          this.info_.startX + this.info_.outputConnection.connectionOffsetX;\n      const connX = this.info_.RTL ? -x : x;\n      this.block_.outputConnection.setOffsetInBlock(\n          connX, this.info_.outputConnection.connectionOffsetY);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for graphically rendering a block as SVG.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.RenderInfo');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {Align, Input} from '../../input.js';\nimport {inputTypes} from '../../input_types.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {Measurable} from '../measurables/base.js';\nimport {BottomRow} from '../measurables/bottom_row.js';\nimport {ExternalValueInput} from '../measurables/external_value_input.js';\nimport {Field} from '../measurables/field.js';\nimport {Hat} from '../measurables/hat.js';\nimport {Icon} from '../measurables/icon.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport {InlineInput} from '../measurables/inline_input.js';\nimport {InputRow} from '../measurables/input_row.js';\nimport {JaggedEdge} from '../measurables/jagged_edge.js';\nimport {NextConnection} from '../measurables/next_connection.js';\nimport {OutputConnection} from '../measurables/output_connection.js';\nimport {PreviousConnection} from '../measurables/previous_connection.js';\nimport {RoundCorner} from '../measurables/round_corner.js';\nimport type {Row} from '../measurables/row.js';\nimport {SpacerRow} from '../measurables/spacer_row.js';\nimport {SquareCorner} from '../measurables/square_corner.js';\nimport {StatementInput} from '../measurables/statement_input.js';\nimport {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport type {Renderer} from './renderer.js';\n\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n *\n * @alias Blockly.blockRendering.RenderInfo\n */\nexport class RenderInfo {\n  block_: AnyDuringMigration;\n  protected constants_: ConstantProvider;\n  outputConnection: OutputConnection;\n  isInline: boolean;\n  isCollapsed: boolean;\n  isInsertionMarker: boolean;\n  RTL: boolean;\n\n  /** The block renderer in use. */\n  protected readonly renderer_: Renderer;\n\n  /** The height of the rendered block, including child blocks. */\n  height = 0;\n\n  /** The width of the rendered block, including child blocks. */\n  widthWithChildren = 0;\n\n  /**\n   * The width of the rendered block, excluding child blocks.  This is the\n   * right edge of the block when rendered LTR.\n   */\n  width = 0;\n  statementEdge = 0;\n\n  /** An array of Row objects containing sizing information. */\n  rows: Row[] = [];\n\n  /** An array of input rows on the block. */\n  inputRows: InputRow[] = [];\n\n  /** An array of measurable objects containing hidden icons. */\n  hiddenIcons: Icon[] = [];\n  topRow: TopRow;\n  bottomRow: BottomRow;\n\n  // The position of the start point for drawing, relative to the block's\n  // location.\n  startX = 0;\n  startY = 0;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   * @internal\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    this.renderer_ = renderer;\n\n    this.block_ = block;\n\n    /** The renderer's constant provider. */\n    this.constants_ = this.renderer_.getConstants();\n\n    /**\n     * A measurable representing the output connection if the block has one.\n     * Otherwise null.\n     */\n    // AnyDuringMigration because:  Type 'OutputConnection | null' is not\n    // assignable to type 'OutputConnection'.\n    this.outputConnection =\n        (!block.outputConnection ?\n             null :\n             new OutputConnection(this.constants_, (block.outputConnection))) as\n        AnyDuringMigration;\n\n    /**\n     * Whether the block should be rendered as a single line, either because\n     * it's inline or because it has been collapsed.\n     */\n    this.isInline = block.getInputsInline() && !block.isCollapsed();\n\n    /** Whether the block is collapsed. */\n    this.isCollapsed = block.isCollapsed();\n\n    /**\n     * Whether the block is an insertion marker.  Insertion markers are the same\n     * shape as normal blocks, but don't show fields.\n     */\n    this.isInsertionMarker = block.isInsertionMarker();\n\n    /** True if the block should be rendered right-to-left. */\n    this.RTL = block.RTL;\n\n    /**\n     * An object with rendering information about the top row of the block.\n     */\n    this.topRow = new TopRow(this.constants_);\n\n    /**\n     * An object with rendering information about the bottom row of the block.\n     */\n    this.bottomRow = new BottomRow(this.constants_);\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   * @internal\n   */\n  getRenderer(): Renderer {\n    return this.renderer_;\n  }\n\n  /**\n   * Populate and return an object containing all sizing information needed to\n   * draw this block.\n   *\n   * This measure pass does not propagate changes to the block (although fields\n   * may choose to rerender when getSize() is called).  However, calling it\n   * repeatedly may be expensive.\n   *\n   * @internal\n   */\n  measure() {\n    this.createRows_();\n    this.addElemSpacing_();\n    this.addRowSpacing_();\n    this.computeBounds_();\n    this.alignRowElements_();\n    this.finalize_();\n  }\n\n  /**\n   * Create rows of Measurable objects representing all renderable parts of the\n   * block.\n   */\n  protected createRows_() {\n    this.populateTopRow_();\n    this.rows.push(this.topRow);\n    let activeRow = new InputRow(this.constants_);\n    this.inputRows.push(activeRow);\n\n    // Icons always go on the first row, before anything else.\n    const icons = this.block_.getIcons();\n    for (let i = 0, icon; icon = icons[i]; i++) {\n      const iconInfo = new Icon(this.constants_, icon);\n      if (this.isCollapsed && icon.collapseHidden) {\n        this.hiddenIcons.push(iconInfo);\n      } else {\n        activeRow.elements.push(iconInfo);\n      }\n    }\n\n    let lastInput = null;\n    // Loop across all of the inputs on the block, creating objects for anything\n    // that needs to be rendered and breaking the block up into visual rows.\n    for (let i = 0, input; input = this.block_.inputList[i]; i++) {\n      if (!input.isVisible()) {\n        continue;\n      }\n      if (this.shouldStartNewRow_(input, lastInput)) {\n        // Finish this row and create a new one.\n        this.rows.push(activeRow);\n        activeRow = new InputRow(this.constants_);\n        this.inputRows.push(activeRow);\n      }\n\n      // All of the fields in an input go on the same row.\n      for (let j = 0, field; field = input.fieldRow[j]; j++) {\n        activeRow.elements.push(new Field(this.constants_, field, input));\n      }\n      this.addInput_(input, activeRow);\n      lastInput = input;\n    }\n\n    if (this.isCollapsed) {\n      activeRow.hasJaggedEdge = true;\n      activeRow.elements.push(new JaggedEdge(this.constants_));\n    }\n\n    if (activeRow.elements.length || activeRow.hasDummyInput) {\n      this.rows.push(activeRow);\n    }\n    this.populateBottomRow_();\n    this.rows.push(this.bottomRow);\n  }\n\n  /**\n   * Create all non-spacer elements that belong on the top row.\n   *\n   * @internal\n   */\n  populateTopRow_() {\n    const hasPrevious = !!this.block_.previousConnection;\n    const hasHat = (this.block_.hat ? this.block_.hat === 'cap' :\n                                      this.constants_.ADD_START_HATS) &&\n        !this.outputConnection && !hasPrevious;\n\n    let cornerClass = this.topRow.hasLeftSquareCorner(this.block_) ?\n        SquareCorner :\n        RoundCorner;\n    this.topRow.elements.push(new cornerClass(this.constants_));\n\n    if (hasHat) {\n      const hat = new Hat(this.constants_);\n      this.topRow.elements.push(hat);\n      this.topRow.capline = hat.ascenderHeight;\n    } else if (hasPrevious) {\n      this.topRow.hasPreviousConnection = true;\n      this.topRow.connection = new PreviousConnection(\n          this.constants_,\n          (this.block_.previousConnection as RenderedConnection));\n      this.topRow.elements.push(this.topRow.connection);\n    }\n\n    const precedesStatement = this.block_.inputList.length &&\n        this.block_.inputList[0].type === inputTypes.STATEMENT;\n\n    // This is the minimum height for the row. If one of its elements has a\n    // greater height it will be overwritten in the compute pass.\n    if (precedesStatement && !this.block_.isCollapsed()) {\n      this.topRow.minHeight =\n          this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT;\n    } else {\n      this.topRow.minHeight = this.constants_.TOP_ROW_MIN_HEIGHT;\n    }\n\n    cornerClass = this.topRow.hasRightSquareCorner(this.block_) ? SquareCorner :\n                                                                  RoundCorner;\n    this.topRow.elements.push(new cornerClass(this.constants_, 'right'));\n  }\n\n  /**\n   * Create all non-spacer elements that belong on the bottom row.\n   *\n   * @internal\n   */\n  populateBottomRow_() {\n    this.bottomRow.hasNextConnection = !!this.block_.nextConnection;\n\n    const followsStatement = this.block_.inputList.length &&\n        this.block_.inputList[this.block_.inputList.length - 1].type ===\n            inputTypes.STATEMENT;\n\n    // This is the minimum height for the row. If one of its elements has a\n    // greater height it will be overwritten in the compute pass.\n    if (followsStatement) {\n      this.bottomRow.minHeight =\n          this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT;\n    } else {\n      this.bottomRow.minHeight = this.constants_.BOTTOM_ROW_MIN_HEIGHT;\n    }\n\n    const leftSquareCorner = this.bottomRow.hasLeftSquareCorner(this.block_);\n\n    if (leftSquareCorner) {\n      this.bottomRow.elements.push(new SquareCorner(this.constants_));\n    } else {\n      this.bottomRow.elements.push(new RoundCorner(this.constants_));\n    }\n\n    if (this.bottomRow.hasNextConnection) {\n      this.bottomRow.connection = new NextConnection(\n          this.constants_, (this.block_.nextConnection as RenderedConnection));\n      this.bottomRow.elements.push(this.bottomRow.connection);\n    }\n\n    const rightSquareCorner = this.bottomRow.hasRightSquareCorner(this.block_);\n\n    if (rightSquareCorner) {\n      this.bottomRow.elements.push(new SquareCorner(this.constants_, 'right'));\n    } else {\n      this.bottomRow.elements.push(new RoundCorner(this.constants_, 'right'));\n    }\n  }\n\n  /**\n   * Add an input element to the active row, if needed, and record the type of\n   * the input on the row.\n   *\n   * @param input The input to record information about.\n   * @param activeRow The row that is currently being populated.\n   */\n  protected addInput_(input: Input, activeRow: Row) {\n    // Non-dummy inputs have visual representations onscreen.\n    if (this.isInline && input.type === inputTypes.VALUE) {\n      activeRow.elements.push(new InlineInput(this.constants_, input));\n      activeRow.hasInlineInput = true;\n    } else if (input.type === inputTypes.STATEMENT) {\n      activeRow.elements.push(new StatementInput(this.constants_, input));\n      activeRow.hasStatement = true;\n    } else if (input.type === inputTypes.VALUE) {\n      activeRow.elements.push(new ExternalValueInput(this.constants_, input));\n      activeRow.hasExternalInput = true;\n    } else if (input.type === inputTypes.DUMMY) {\n      // Dummy inputs have no visual representation, but the information is\n      // still important.\n      activeRow.minHeight = Math.max(\n          activeRow.minHeight,\n          input.getSourceBlock() && input.getSourceBlock()!.isShadow() ?\n              this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT :\n              this.constants_.DUMMY_INPUT_MIN_HEIGHT);\n      activeRow.hasDummyInput = true;\n    }\n    if (activeRow.align === null) {\n      activeRow.align = input.align;\n    }\n  }\n\n  /**\n   * Decide whether to start a new row between the two Blockly.Inputs.\n   *\n   * @param input The first input to consider\n   * @param lastInput The input that follows.\n   * @returns True if the next input should be rendered on a new row.\n   */\n  protected shouldStartNewRow_(input: Input, lastInput: Input): boolean {\n    // If this is the first input, just add to the existing row.\n    // That row is either empty or has some icons in it.\n    if (!lastInput) {\n      return false;\n    }\n    // A statement input or an input following one always gets a new row.\n    if (input.type === inputTypes.STATEMENT ||\n        lastInput.type === inputTypes.STATEMENT) {\n      return true;\n    }\n    // Value and dummy inputs get new row if inputs are not inlined.\n    if (input.type === inputTypes.VALUE || input.type === inputTypes.DUMMY) {\n      return !this.isInline;\n    }\n    return false;\n  }\n\n  /** Add horizontal spacing between and around elements within each row. */\n  protected addElemSpacing_() {\n    for (let i = 0, row; row = this.rows[i]; i++) {\n      const oldElems = row.elements;\n      row.elements = [];\n      // No spacing needed before the corner on the top row or the bottom row.\n      if (row.startsWithElemSpacer()) {\n        // There's a spacer before the first element in the row.\n        row.elements.push(new InRowSpacer(\n            this.constants_, this.getInRowSpacing_(null, oldElems[0])));\n      }\n      if (!oldElems.length) {\n        continue;\n      }\n      for (let e = 0; e < oldElems.length - 1; e++) {\n        row.elements.push(oldElems[e]);\n        const spacing = this.getInRowSpacing_(oldElems[e], oldElems[e + 1]);\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n      row.elements.push(oldElems[oldElems.length - 1]);\n      if (row.endsWithElemSpacer()) {\n        // There's a spacer after the last element in the row.\n        row.elements.push(new InRowSpacer(\n            this.constants_,\n            this.getInRowSpacing_(oldElems[oldElems.length - 1], null)));\n      }\n    }\n  }\n\n  /**\n   * Calculate the width of a spacer element in a row based on the previous and\n   * next elements in that row.  For instance, extra padding is added between\n   * two editable fields.\n   *\n   * @param prev The element before the spacer.\n   * @param next The element after the spacer.\n   * @returns The size of the spacing between the two elements.\n   */\n  protected getInRowSpacing_(prev: Measurable|null, next: Measurable|null):\n      number {\n    if (!prev) {\n      // Statement input padding.\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n    }\n    // Between inputs and the end of the row.\n    if (prev && Types.isInput(prev) && !next) {\n      // AnyDuringMigration because:  Property 'isExternalInput' does not exist\n      // on type 'typeof Types'.\n      if ((Types as AnyDuringMigration).isExternalInput(prev)) {\n        return this.constants_.NO_PADDING;\n      } else if (Types.isInlineInput(prev)) {\n        return this.constants_.LARGE_PADDING;\n      } else if (Types.isStatementInput(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n\n    // Spacing between a square corner and a previous or next connection\n    if (prev && Types.isLeftSquareCorner(prev) && next) {\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset;\n      }\n    }\n\n    // Spacing between a rounded corner and a previous or next connection.\n    if (prev && Types.isLeftRoundedCorner(prev) && next) {\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset - this.constants_.CORNER_RADIUS;\n      }\n    }\n\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  /**\n   * Figure out where the right edge of the block and right edge of statement\n   * inputs should be placed.\n   */\n  protected computeBounds_() {\n    let widestStatementRowFields = 0;\n    let blockWidth = 0;\n    let widestRowWithConnectedBlocks = 0;\n    for (let i = 0, row; row = this.rows[i]; i++) {\n      row.measure();\n      blockWidth = Math.max(blockWidth, row.width);\n      if (row.hasStatement) {\n        const statementInput = row.getLastInput();\n        const innerWidth = row.width - statementInput.width;\n        widestStatementRowFields =\n            Math.max(widestStatementRowFields, innerWidth);\n      }\n      widestRowWithConnectedBlocks =\n          Math.max(widestRowWithConnectedBlocks, row.widthWithConnectedBlocks);\n    }\n\n    this.statementEdge = widestStatementRowFields;\n    this.width = blockWidth;\n\n    for (let i = 0, row; row = this.rows[i]; i++) {\n      if (row.hasStatement) {\n        row.statementEdge = this.statementEdge;\n      }\n    }\n\n    this.widthWithChildren = Math.max(blockWidth, widestRowWithConnectedBlocks);\n\n    if (this.outputConnection) {\n      this.startX = this.outputConnection.width;\n      this.width += this.outputConnection.width;\n      this.widthWithChildren += this.outputConnection.width;\n    }\n  }\n\n  /**\n   * Extra spacing may be necessary to make sure that the right sides of all\n   * rows line up.  This can only be calculated after a first pass to calculate\n   * the sizes of all rows.\n   */\n  protected alignRowElements_() {\n    for (let i = 0, row; row = this.rows[i]; i++) {\n      if (row.hasStatement) {\n        this.alignStatementRow_(row as InputRow);\n      } else {\n        const currentWidth = row.width;\n        const desiredWidth = this.getDesiredRowWidth_(row);\n        const missingSpace = desiredWidth - currentWidth;\n        if (missingSpace > 0) {\n          this.addAlignmentPadding_(row, missingSpace);\n        }\n        // AnyDuringMigration because:  Property 'isTopOrBottomRow' does not\n        // exist on type 'typeof Types'.\n        if ((Types as AnyDuringMigration).isTopOrBottomRow(row)) {\n          row.widthWithConnectedBlocks = row.width;\n        }\n      }\n    }\n  }\n\n  /**\n   * Calculate the desired width of an input row.\n   *\n   * @param _row The input row.\n   * @returns The desired width of the input row.\n   */\n  protected getDesiredRowWidth_(_row: Row): number {\n    return this.width - this.startX;\n  }\n\n  /**\n   * Modify the given row to add the given amount of padding around its fields.\n   * The exact location of the padding is based on the alignment property of the\n   * last input in the field.\n   *\n   * @param row The row to add padding to.\n   * @param missingSpace How much padding to add.\n   */\n  protected addAlignmentPadding_(row: Row, missingSpace: number) {\n    const firstSpacer = row.getFirstSpacer();\n    const lastSpacer = row.getLastSpacer();\n    if (row.hasExternalInput || row.hasStatement) {\n      row.widthWithConnectedBlocks += missingSpace;\n    }\n\n    // Decide where the extra padding goes.\n    if (row.align === Align.LEFT) {\n      // Add padding to the end of the row.\n      lastSpacer.width += missingSpace;\n    } else if (row.align === Align.CENTRE) {\n      // Split the padding between the beginning and end of the row.\n      firstSpacer.width += missingSpace / 2;\n      lastSpacer.width += missingSpace / 2;\n    } else if (row.align === Align.RIGHT) {\n      // Add padding at the beginning of the row.\n      firstSpacer.width += missingSpace;\n    } else {\n      // Default to left-aligning.\n      lastSpacer.width += missingSpace;\n    }\n    row.width += missingSpace;\n  }\n\n  /**\n   * Align the elements of a statement row based on computed bounds.\n   * Unlike other types of rows, statement rows add space in multiple places.\n   *\n   * @param row The statement row to resize.\n   */\n  protected alignStatementRow_(row: InputRow) {\n    const statementInput = row.getLastInput();\n    let currentWidth = row.width - statementInput.width;\n    let desiredWidth = this.statementEdge;\n    // Add padding before the statement input.\n    const missingSpace = desiredWidth - currentWidth;\n    if (missingSpace > 0) {\n      this.addAlignmentPadding_(row, missingSpace);\n    }\n    // Also widen the statement input to reach to the right side of the\n    // block. Note that this does not add padding.\n    currentWidth = row.width;\n    desiredWidth = this.getDesiredRowWidth_(row);\n    statementInput.width += desiredWidth - currentWidth;\n    statementInput.height = Math.max(statementInput.height, row.height);\n    row.width += desiredWidth - currentWidth;\n    row.widthWithConnectedBlocks =\n        Math.max(row.width, this.statementEdge + row.connectedBlockWidths);\n  }\n\n  /** Add spacers between rows and set their sizes. */\n  protected addRowSpacing_() {\n    const oldRows = this.rows;\n    this.rows = [];\n\n    for (let r = 0; r < oldRows.length; r++) {\n      this.rows.push(oldRows[r]);\n      if (r !== oldRows.length - 1) {\n        this.rows.push(this.makeSpacerRow_(oldRows[r], oldRows[r + 1]));\n      }\n    }\n  }\n\n  /**\n   * Create a spacer row to go between prev and next, and set its size.\n   *\n   * @param prev The previous row.\n   * @param next The next row.\n   * @returns The newly created spacer row.\n   */\n  protected makeSpacerRow_(prev: Row, next: Row): SpacerRow {\n    const height = this.getSpacerRowHeight_(prev, next);\n    const width = this.getSpacerRowWidth_(prev, next);\n    const spacer = new SpacerRow(this.constants_, height, width);\n    if (prev.hasStatement) {\n      spacer.followsStatement = true;\n    }\n    if (next.hasStatement) {\n      spacer.precedesStatement = true;\n    }\n    return spacer;\n  }\n\n  /**\n   * Calculate the width of a spacer row.\n   *\n   * @param _prev The row before the spacer.\n   * @param _next The row after the spacer.\n   * @returns The desired width of the spacer row between these two rows.\n   */\n  protected getSpacerRowWidth_(_prev: Row, _next: Row): number {\n    return this.width - this.startX;\n  }\n\n  /**\n   * Calculate the height of a spacer row.\n   *\n   * @param _prev The row before the spacer.\n   * @param _next The row after the spacer.\n   * @returns The desired height of the spacer row between these two rows.\n   */\n  protected getSpacerRowHeight_(_prev: Row, _next: Row): number {\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  /**\n   * Calculate the centerline of an element in a rendered row.\n   * This base implementation puts the centerline at the middle of the row\n   * vertically, with no special cases.  You will likely need extra logic to\n   * handle (at minimum) top and bottom rows.\n   *\n   * @param row The row containing the element.\n   * @param elem The element to place.\n   * @returns The desired centerline of the given element, as an offset from the\n   *     top left of the block.\n   */\n  protected getElemCenterline_(row: Row, elem: Measurable): number {\n    if (Types.isSpacer(elem)) {\n      return row.yPos + elem.height / 2;\n    }\n    if (Types.isBottomRow(row)) {\n      const bottomRow = row as BottomRow;\n      const baseline =\n          bottomRow.yPos + bottomRow.height - bottomRow.descenderHeight;\n      if (Types.isNextConnection(elem)) {\n        return baseline + elem.height / 2;\n      }\n      return baseline - elem.height / 2;\n    }\n    if (Types.isTopRow(row)) {\n      const topRow = row as TopRow;\n      // AnyDuringMigration because:  Property 'isHat' does not exist on type\n      // 'typeof Types'.\n      if ((Types as AnyDuringMigration).isHat(elem)) {\n        return topRow.capline - elem.height / 2;\n      }\n      return topRow.capline + elem.height / 2;\n    }\n    return row.yPos + row.height / 2;\n  }\n\n  /**\n   * Record final position information on elements on the given row, for use in\n   * drawing.  At minimum this records xPos and centerline on each element.\n   *\n   * @param row The row containing the elements.\n   */\n  protected recordElemPositions_(row: Row) {\n    let xCursor = row.xPos;\n    for (let j = 0, elem; elem = row.elements[j]; j++) {\n      // Now that row heights are finalized, make spacers use the row height.\n      if (Types.isSpacer(elem)) {\n        elem.height = row.height;\n      }\n      elem.xPos = xCursor;\n      elem.centerline = this.getElemCenterline_(row, elem);\n      xCursor += elem.width;\n    }\n  }\n\n  /**\n   * Make any final changes to the rendering information object.  In particular,\n   * store the y position of each row, and record the height of the full block.\n   */\n  protected finalize_() {\n    // Performance note: this could be combined with the draw pass, if the time\n    // that this takes is excessive.  But it shouldn't be, because it only\n    // accesses and sets properties that already exist on the objects.\n    let widestRowWithConnectedBlocks = 0;\n    let yCursor = 0;\n    for (let i = 0, row; row = this.rows[i]; i++) {\n      row.yPos = yCursor;\n      row.xPos = this.startX;\n      yCursor += row.height;\n\n      widestRowWithConnectedBlocks =\n          Math.max(widestRowWithConnectedBlocks, row.widthWithConnectedBlocks);\n      this.recordElemPositions_(row);\n    }\n    if (this.outputConnection && this.block_.nextConnection &&\n        this.block_.nextConnection.isConnected()) {\n      // Include width of connected block in value to stack width measurement.\n      widestRowWithConnectedBlocks = Math.max(\n          widestRowWithConnectedBlocks,\n          this.block_.nextConnection.targetBlock().getHeightWidth().width);\n    }\n\n    this.widthWithChildren = widestRowWithConnectedBlocks + this.startX;\n\n    this.height = yCursor;\n    this.startY = this.topRow.capline;\n    this.bottomRow.baseline = yCursor - this.bottomRow.descenderHeight;\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of a marker move.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.MarkerMove');\n\nimport type {Block} from '../block.js';\nimport {ASTNode} from '../keyboard_nav/ast_node.js';\nimport * as registry from '../registry.js';\nimport type {Workspace} from '../workspace.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a marker move event.\n *\n * @alias Blockly.Events.MarkerMove\n */\nexport class MarkerMove extends UiBase {\n  blockId: string|null;\n  oldNode?: ASTNode|null;\n  newNode?: ASTNode;\n  isCursor?: boolean;\n  override type: string;\n\n  /**\n   * @param opt_block The affected block. Null if current node is of type\n   *     workspace. Undefined for a blank event.\n   * @param isCursor Whether this is a cursor event. Undefined for a blank\n   *     event.\n   * @param opt_oldNode The old node the marker used to be on.\n   *    Undefined for a blank event.\n   * @param opt_newNode The new node the marker is now on.\n   *    Undefined for a blank event.\n   */\n  constructor(\n      opt_block?: Block|null, isCursor?: boolean, opt_oldNode?: ASTNode|null,\n      opt_newNode?: ASTNode) {\n    let workspaceId = opt_block ? opt_block.workspace.id : undefined;\n    if (opt_newNode && opt_newNode.getType() === ASTNode.types.WORKSPACE) {\n      workspaceId = (opt_newNode.getLocation() as Workspace).id;\n    }\n    super(workspaceId);\n\n    /** The workspace identifier for this event. */\n    this.blockId = opt_block ? opt_block.id : null;\n\n    /** The old node the marker used to be on. */\n    this.oldNode = opt_oldNode;\n\n    /** The new node the  marker is now on. */\n    this.newNode = opt_newNode;\n\n    /** Whether this is a cursor event. */\n    this.isCursor = isCursor;\n\n    /** Type of this event. */\n    this.type = eventUtils.MARKER_MOVE;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['isCursor'] = this.isCursor;\n    json['blockId'] = this.blockId;\n    json['oldNode'] = this.oldNode;\n    json['newNode'] = this.newNode;\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.isCursor = json['isCursor'];\n    this.blockId = json['blockId'];\n    this.oldNode = json['oldNode'];\n    this.newNode = json['newNode'];\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.MARKER_MOVE, MarkerMove);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for graphically rendering a marker as SVG.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.MarkerSvg');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport '../../events/events_marker_move.js';\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Connection} from '../../connection.js';\nimport {ConnectionType} from '../../connection_type.js';\nimport * as eventUtils from '../../events/utils.js';\nimport type {Field} from '../../field.js';\nimport type {IASTNodeLocationSvg} from '../../interfaces/i_ast_node_location_svg.js';\nimport {ASTNode} from '../../keyboard_nav/ast_node.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\n\nimport type {ConstantProvider, Notch, PuzzleTab} from './constants.js';\n\n\n/** The name of the CSS class for a cursor. */\nconst CURSOR_CLASS = 'blocklyCursor';\n\n/** The name of the CSS class for a marker. */\nconst MARKER_CLASS = 'blocklyMarker';\n\n/**\n * What we multiply the height by to get the height of the marker.\n * Only used for the block and block connections.\n */\nconst HEIGHT_MULTIPLIER = 3 / 4;\n\n/**\n * Class for a marker.\n *\n * @alias Blockly.blockRendering.MarkerSvg\n */\nexport class MarkerSvg {\n  /**\n   * The workspace, field, or block that the marker SVG element should be\n   * attached to.\n   */\n  private parent_: IASTNodeLocationSvg|null = null;\n\n  /** The current SVG element for the marker. */\n  currentMarkerSvg: Element|null = null;\n  colour_: string;\n\n  /** The root SVG group containing the marker. */\n  protected markerSvg_: SVGGElement|null = null;\n  protected svgGroup_: SVGGElement|null = null;\n\n  protected markerBlock_: SVGPathElement|null = null;\n\n  protected markerInput_: SVGPathElement|null = null;\n  protected markerSvgLine_: SVGRectElement|null = null;\n\n  protected markerSvgRect_: SVGRectElement|null = null;\n\n  /** The constants necessary to draw the marker. */\n  protected constants_: ConstantProvider;\n\n  /**\n   * @param workspace The workspace the marker belongs to.\n   * @param constants The constants for the renderer.\n   * @param marker The marker to draw.\n   */\n  constructor(\n      private readonly workspace: WorkspaceSvg, constants: ConstantProvider,\n      private readonly marker: Marker) {\n    this.constants_ = constants;\n\n    const defaultColour = this.isCursor() ? this.constants_.CURSOR_COLOUR :\n                                            this.constants_.MARKER_COLOUR;\n\n    /** The colour of the marker. */\n    this.colour_ = marker.colour || defaultColour;\n  }\n\n  /**\n   * Return the root node of the SVG or null if none exists.\n   *\n   * @returns The root SVG node.\n   */\n  getSvgRoot(): SVGElement {\n    // AnyDuringMigration because:  Type 'SVGGElement | null' is not assignable\n    // to type 'SVGElement'.\n    return this.svgGroup_ as AnyDuringMigration;\n  }\n\n  /**\n   * Get the marker.\n   *\n   * @returns The marker to draw for.\n   */\n  getMarker(): Marker {\n    return this.marker;\n  }\n\n  /**\n   * True if the marker should be drawn as a cursor, false otherwise.\n   * A cursor is drawn as a flashing line. A marker is drawn as a solid line.\n   *\n   * @returns True if the marker is a cursor, false otherwise.\n   */\n  isCursor(): boolean {\n    return this.marker.type === 'cursor';\n  }\n\n  /**\n   * Create the DOM element for the marker.\n   *\n   * @returns The marker controls SVG group.\n   * @internal\n   */\n  createDom(): SVGElement {\n    const className = this.isCursor() ? CURSOR_CLASS : MARKER_CLASS;\n\n    this.svgGroup_ = dom.createSvgElement(Svg.G, {'class': className});\n\n    this.createDomInternal_();\n    return this.svgGroup_;\n  }\n\n  /**\n   * Attaches the SVG root of the marker to the SVG group of the parent.\n   *\n   * @param newParent The workspace, field, or block that the marker SVG element\n   *     should be attached to.\n   */\n  protected setParent_(newParent: IASTNodeLocationSvg) {\n    if (!this.isCursor()) {\n      if (this.parent_) {\n        this.parent_.setMarkerSvg(null);\n      }\n      newParent.setMarkerSvg(this.getSvgRoot());\n    } else {\n      if (this.parent_) {\n        this.parent_.setCursorSvg(null);\n      }\n      newParent.setCursorSvg(this.getSvgRoot());\n    }\n    this.parent_ = newParent;\n  }\n\n  /**\n   * Update the marker.\n   *\n   * @param oldNode The previous node the marker was on or null.\n   * @param curNode The node that we want to draw the marker for.\n   */\n  draw(oldNode: ASTNode, curNode: ASTNode) {\n    if (!curNode) {\n      this.hide();\n      return;\n    }\n\n    this.constants_ = this.workspace.getRenderer().getConstants();\n\n    const defaultColour = this.isCursor() ? this.constants_.CURSOR_COLOUR :\n                                            this.constants_.MARKER_COLOUR;\n    this.colour_ = this.marker.colour || defaultColour;\n    this.applyColour_(curNode);\n\n    this.showAtLocation_(curNode);\n\n    this.fireMarkerEvent_(oldNode, curNode);\n\n    // Ensures the marker will be visible immediately after the move.\n    const animate = this.currentMarkerSvg!.childNodes[0];\n    if (animate !== undefined) {\n      animate instanceof SVGAnimationElement && animate.beginElement();\n    }\n  }\n\n  /**\n   * Update the marker's visible state based on the type of curNode..\n   *\n   * @param curNode The node that we want to draw the marker for.\n   */\n  protected showAtLocation_(curNode: ASTNode) {\n    const curNodeAsConnection = curNode.getLocation() as Connection;\n    const connectionType = curNodeAsConnection.type;\n    if (curNode.getType() === ASTNode.types.BLOCK) {\n      this.showWithBlock_(curNode);\n    } else if (curNode.getType() === ASTNode.types.OUTPUT) {\n      this.showWithOutput_(curNode);\n    } else if (connectionType === ConnectionType.INPUT_VALUE) {\n      this.showWithInput_(curNode);\n    } else if (connectionType === ConnectionType.NEXT_STATEMENT) {\n      this.showWithNext_(curNode);\n    } else if (curNode.getType() === ASTNode.types.PREVIOUS) {\n      this.showWithPrevious_(curNode);\n    } else if (curNode.getType() === ASTNode.types.FIELD) {\n      this.showWithField_(curNode);\n    } else if (curNode.getType() === ASTNode.types.WORKSPACE) {\n      this.showWithCoordinates_(curNode);\n    } else if (curNode.getType() === ASTNode.types.STACK) {\n      this.showWithStack_(curNode);\n    }\n  }\n\n  /**************************\n   * Display\n   **************************/\n\n  /**\n   * Show the marker as a combination of the previous connection and block,\n   * the output connection and block, or just the block.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  private showWithBlockPrevOutput_(curNode: ASTNode) {\n    const block = curNode.getSourceBlock() as BlockSvg;\n    const width = block.width;\n    const height = block.height;\n    const markerHeight = height * HEIGHT_MULTIPLIER;\n    const markerOffset = this.constants_.CURSOR_BLOCK_PADDING;\n\n    if (block.previousConnection) {\n      const connectionShape =\n          this.constants_.shapeFor(block.previousConnection) as Notch |\n          PuzzleTab;\n      this.positionPrevious_(\n          width, markerOffset, markerHeight, connectionShape);\n    } else if (block.outputConnection) {\n      const connectionShape =\n          this.constants_.shapeFor(block.outputConnection) as Notch | PuzzleTab;\n      this.positionOutput_(width, height, connectionShape);\n    } else {\n      this.positionBlock_(width, markerOffset, markerHeight);\n    }\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a block.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithBlock_(curNode: ASTNode) {\n    this.showWithBlockPrevOutput_(curNode);\n  }\n\n  /**\n   * Position and display the marker for a previous connection.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithPrevious_(curNode: ASTNode) {\n    this.showWithBlockPrevOutput_(curNode);\n  }\n\n  /**\n   * Position and display the marker for an output connection.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithOutput_(curNode: ASTNode) {\n    this.showWithBlockPrevOutput_(curNode);\n  }\n\n  /**\n   * Position and display the marker for a workspace coordinate.\n   * This is a horizontal line.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithCoordinates_(curNode: ASTNode) {\n    const wsCoordinate = curNode.getWsCoordinate();\n    let x = wsCoordinate.x;\n    const y = wsCoordinate.y;\n\n    if (this.workspace.RTL) {\n      x -= this.constants_.CURSOR_WS_WIDTH;\n    }\n\n    this.positionLine_(x, y, this.constants_.CURSOR_WS_WIDTH);\n    this.setParent_(this.workspace);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a field.\n   * This is a box around the field.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithField_(curNode: ASTNode) {\n    const field = curNode.getLocation() as Field;\n    const width = field.getSize().width;\n    const height = field.getSize().height;\n\n    this.positionRect_(0, 0, width, height);\n    this.setParent_(field);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for an input.\n   * This is a puzzle piece.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithInput_(curNode: ASTNode) {\n    const connection = curNode.getLocation() as RenderedConnection;\n    const sourceBlock = (connection.getSourceBlock());\n\n    this.positionInput_(connection);\n    this.setParent_(sourceBlock);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a next connection.\n   * This is a horizontal line.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithNext_(curNode: ASTNode) {\n    const connection = curNode.getLocation() as RenderedConnection;\n    const targetBlock = (connection.getSourceBlock());\n    let x = 0;\n    const y = connection.getOffsetInBlock().y;\n    const width = targetBlock.getHeightWidth().width;\n    if (this.workspace.RTL) {\n      x = -width;\n    }\n    this.positionLine_(x, y, width);\n    this.setParent_(targetBlock);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a stack.\n   * This is a box with extra padding around the entire stack of blocks.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithStack_(curNode: ASTNode) {\n    const block = curNode.getLocation() as BlockSvg;\n\n    // Gets the height and width of entire stack.\n    const heightWidth = block.getHeightWidth();\n\n    // Add padding so that being on a stack looks different than being on a\n    // block.\n    const width = heightWidth.width + this.constants_.CURSOR_STACK_PADDING;\n    const height = heightWidth.height + this.constants_.CURSOR_STACK_PADDING;\n\n    // Shift the rectangle slightly to upper left so padding is equal on all\n    // sides.\n    const xPadding = -this.constants_.CURSOR_STACK_PADDING / 2;\n    const yPadding = -this.constants_.CURSOR_STACK_PADDING / 2;\n\n    let x = xPadding;\n    const y = yPadding;\n\n    if (this.workspace.RTL) {\n      x = -(width + xPadding);\n    }\n    this.positionRect_(x, y, width, height);\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  /** Show the current marker. */\n  protected showCurrent_() {\n    this.hide();\n    // AnyDuringMigration because:  Property 'style' does not exist on type\n    // 'Element'.\n    (this.currentMarkerSvg as AnyDuringMigration)!.style.display = '';\n  }\n\n  /**************************\n   * Position\n   **************************/\n\n  /**\n   * Position the marker for a block.\n   * Displays an outline of the top half of a rectangle around a block.\n   *\n   * @param width The width of the block.\n   * @param markerOffset The extra padding for around the block.\n   * @param markerHeight The height of the marker.\n   */\n  protected positionBlock_(\n      width: number, markerOffset: number, markerHeight: number) {\n    const markerPath = svgPaths.moveBy(-markerOffset, markerHeight) +\n        svgPaths.lineOnAxis('V', -markerOffset) +\n        svgPaths.lineOnAxis('H', width + markerOffset * 2) +\n        svgPaths.lineOnAxis('V', markerHeight);\n    this.markerBlock_!.setAttribute('d', markerPath);\n    if (this.workspace.RTL) {\n      // AnyDuringMigration because:  Argument of type 'SVGPathElement | null'\n      // is not assignable to parameter of type 'SVGElement'.\n      this.flipRtl_(this.markerBlock_ as AnyDuringMigration);\n    }\n    this.currentMarkerSvg = this.markerBlock_;\n  }\n\n  /**\n   * Position the marker for an input connection.\n   * Displays a filled in puzzle piece.\n   *\n   * @param connection The connection to position marker around.\n   */\n  protected positionInput_(connection: RenderedConnection) {\n    const x = connection.getOffsetInBlock().x;\n    const y = connection.getOffsetInBlock().y;\n\n    const path = svgPaths.moveTo(0, 0) +\n        (this.constants_.shapeFor(connection) as PuzzleTab).pathDown;\n\n    this.markerInput_!.setAttribute('d', path);\n    this.markerInput_!.setAttribute(\n        'transform',\n        'translate(' + x + ',' + y + ')' +\n            (this.workspace.RTL ? ' scale(-1 1)' : ''));\n    this.currentMarkerSvg = this.markerInput_;\n  }\n\n  /**\n   * Move and show the marker at the specified coordinate in workspace units.\n   * Displays a horizontal line.\n   *\n   * @param x The new x, in workspace units.\n   * @param y The new y, in workspace units.\n   * @param width The new width, in workspace units.\n   */\n  protected positionLine_(x: number, y: number, width: number) {\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.markerSvgLine_!.setAttribute('x', x as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.markerSvgLine_!.setAttribute('y', y as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.markerSvgLine_!.setAttribute('width', width as AnyDuringMigration);\n    this.currentMarkerSvg = this.markerSvgLine_;\n  }\n\n  /**\n   * Position the marker for an output connection.\n   * Displays a puzzle outline and the top and bottom path.\n   *\n   * @param width The width of the block.\n   * @param height The height of the block.\n   * @param connectionShape The shape object for the connection.\n   */\n  protected positionOutput_(\n      width: number, height: number, connectionShape: Notch|PuzzleTab) {\n    // AnyDuringMigration because:  Property 'pathDown' does not exist on type\n    // 'Notch | PuzzleTab'.\n    const markerPath = svgPaths.moveBy(width, 0) +\n        svgPaths.lineOnAxis('h', -(width - connectionShape.width)) +\n        svgPaths.lineOnAxis('v', this.constants_.TAB_OFFSET_FROM_TOP) +\n        (connectionShape as AnyDuringMigration).pathDown +\n        svgPaths.lineOnAxis('V', height) + svgPaths.lineOnAxis('H', width);\n    this.markerBlock_!.setAttribute('d', markerPath);\n    if (this.workspace.RTL) {\n      // AnyDuringMigration because:  Argument of type 'SVGPathElement | null'\n      // is not assignable to parameter of type 'SVGElement'.\n      this.flipRtl_(this.markerBlock_ as AnyDuringMigration);\n    }\n    this.currentMarkerSvg = this.markerBlock_;\n  }\n\n  /**\n   * Position the marker for a previous connection.\n   * Displays a half rectangle with a notch in the top to represent the previous\n   * connection.\n   *\n   * @param width The width of the block.\n   * @param markerOffset The offset of the marker from around the block.\n   * @param markerHeight The height of the marker.\n   * @param connectionShape The shape object for the connection.\n   */\n  protected positionPrevious_(\n      width: number, markerOffset: number, markerHeight: number,\n      connectionShape: Notch|PuzzleTab) {\n    // AnyDuringMigration because:  Property 'pathLeft' does not exist on type\n    // 'Notch | PuzzleTab'.\n    const markerPath = svgPaths.moveBy(-markerOffset, markerHeight) +\n        svgPaths.lineOnAxis('V', -markerOffset) +\n        svgPaths.lineOnAxis('H', this.constants_.NOTCH_OFFSET_LEFT) +\n        (connectionShape as AnyDuringMigration).pathLeft +\n        svgPaths.lineOnAxis('H', width + markerOffset * 2) +\n        svgPaths.lineOnAxis('V', markerHeight);\n    this.markerBlock_!.setAttribute('d', markerPath);\n    if (this.workspace.RTL) {\n      // AnyDuringMigration because:  Argument of type 'SVGPathElement | null'\n      // is not assignable to parameter of type 'SVGElement'.\n      this.flipRtl_(this.markerBlock_ as AnyDuringMigration);\n    }\n    this.currentMarkerSvg = this.markerBlock_;\n  }\n\n  /**\n   * Move and show the marker at the specified coordinate in workspace units.\n   * Displays a filled in rectangle.\n   *\n   * @param x The new x, in workspace units.\n   * @param y The new y, in workspace units.\n   * @param width The new width, in workspace units.\n   * @param height The new height, in workspace units.\n   */\n  protected positionRect_(x: number, y: number, width: number, height: number) {\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.markerSvgRect_!.setAttribute('x', x as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.markerSvgRect_!.setAttribute('y', y as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.markerSvgRect_!.setAttribute('width', width as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.markerSvgRect_!.setAttribute('height', height as AnyDuringMigration);\n    this.currentMarkerSvg = this.markerSvgRect_;\n  }\n\n  /**\n   * Flip the SVG paths in RTL.\n   *\n   * @param markerSvg The marker that we want to flip.\n   */\n  private flipRtl_(markerSvg: SVGElement) {\n    markerSvg.setAttribute('transform', 'scale(-1 1)');\n  }\n\n  /** Hide the marker. */\n  hide() {\n    this.markerSvgLine_!.style.display = 'none';\n    this.markerSvgRect_!.style.display = 'none';\n    this.markerInput_!.style.display = 'none';\n    this.markerBlock_!.style.display = 'none';\n  }\n\n  /**\n   * Fire event for the marker or marker.\n   *\n   * @param oldNode The old node the marker used to be on.\n   * @param curNode The new node the marker is currently on.\n   */\n  private fireMarkerEvent_(oldNode: ASTNode, curNode: ASTNode) {\n    const curBlock = curNode.getSourceBlock();\n    const event = new (eventUtils.get(eventUtils.MARKER_MOVE))(\n        curBlock, this.isCursor(), oldNode, curNode);\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Get the properties to make a marker blink.\n   *\n   * @returns The object holding attributes to make the marker blink.\n   */\n  protected getBlinkProperties_(): AnyDuringMigration {\n    return {\n      'attributeType': 'XML',\n      'attributeName': 'fill',\n      'dur': '1s',\n      'values': this.colour_ + ';transparent;transparent;',\n      'repeatCount': 'indefinite',\n    };\n  }\n\n  /**\n   * Create the marker SVG.\n   *\n   * @returns The SVG node created.\n   */\n  protected createDomInternal_(): Element {\n    /* This markup will be generated and added to the .svgGroup_:\n        <g>\n          <rect width=\"100\" height=\"5\">\n            <animate attributeType=\"XML\" attributeName=\"fill\" dur=\"1s\"\n              values=\"transparent;transparent;#fff;transparent\"\n        repeatCount=\"indefinite\" />\n          </rect>\n        </g>\n        */\n\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'Element | undefined'.\n    this.markerSvg_ = dom.createSvgElement(\n        Svg.G, {\n          'width': this.constants_.CURSOR_WS_WIDTH,\n          'height': this.constants_.WS_CURSOR_HEIGHT,\n        },\n        this.svgGroup_ as AnyDuringMigration);\n\n    // A horizontal line used to represent a workspace coordinate or next\n    // connection.\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'Element | undefined'.\n    this.markerSvgLine_ = dom.createSvgElement(\n        Svg.RECT, {\n          'width': this.constants_.CURSOR_WS_WIDTH,\n          'height': this.constants_.WS_CURSOR_HEIGHT,\n          'style': 'display: none',\n        },\n        this.markerSvg_ as AnyDuringMigration);\n\n    // A filled in rectangle used to represent a stack.\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'Element | undefined'.\n    this.markerSvgRect_ = dom.createSvgElement(\n        Svg.RECT, {\n          'class': 'blocklyVerticalMarker',\n          'rx': 10,\n          'ry': 10,\n          'style': 'display: none',\n        },\n        this.markerSvg_ as AnyDuringMigration);\n\n    // A filled in puzzle piece used to represent an input value.\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'Element | undefined'.\n    this.markerInput_ = dom.createSvgElement(\n        Svg.PATH, {'transform': '', 'style': 'display: none'},\n        this.markerSvg_ as AnyDuringMigration);\n\n    // A path used to represent a previous connection and a block, an output\n    // connection and a block, or a block.\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'Element | undefined'.\n    this.markerBlock_ = dom.createSvgElement(\n        Svg.PATH, {\n          'transform': '',\n          'style': 'display: none',\n          'fill': 'none',\n          'stroke-width': this.constants_.CURSOR_STROKE_WIDTH,\n        },\n        this.markerSvg_ as AnyDuringMigration);\n\n    // Markers and stack markers don't blink.\n    if (this.isCursor()) {\n      const blinkProperties = this.getBlinkProperties_();\n      // AnyDuringMigration because:  Argument of type 'SVGRectElement | null'\n      // is not assignable to parameter of type 'Element | undefined'.\n      dom.createSvgElement(\n          Svg.ANIMATE, blinkProperties,\n          this.markerSvgLine_ as AnyDuringMigration);\n      // AnyDuringMigration because:  Argument of type 'SVGPathElement | null'\n      // is not assignable to parameter of type 'Element | undefined'.\n      dom.createSvgElement(\n          Svg.ANIMATE, blinkProperties,\n          this.markerInput_ as AnyDuringMigration);\n      blinkProperties['attributeName'] = 'stroke';\n      // AnyDuringMigration because:  Argument of type 'SVGPathElement | null'\n      // is not assignable to parameter of type 'Element | undefined'.\n      dom.createSvgElement(\n          Svg.ANIMATE, blinkProperties,\n          this.markerBlock_ as AnyDuringMigration);\n    }\n\n    // AnyDuringMigration because:  Type 'SVGGElement | null' is not assignable\n    // to type 'Element'.\n    return this.markerSvg_ as AnyDuringMigration;\n  }\n\n  /**\n   * Apply the marker's colour.\n   *\n   * @param _curNode The node that we want to draw the marker for.\n   */\n  protected applyColour_(_curNode: ASTNode) {\n    this.markerSvgLine_!.setAttribute('fill', this.colour_);\n    this.markerSvgRect_!.setAttribute('stroke', this.colour_);\n    this.markerInput_!.setAttribute('fill', this.colour_);\n    this.markerBlock_!.setAttribute('stroke', this.colour_);\n\n    if (this.isCursor()) {\n      const values = this.colour_ + ';transparent;transparent;';\n      this.markerSvgLine_!.firstElementChild!.setAttribute('values', values);\n      this.markerInput_!.firstElementChild!.setAttribute('values', values);\n      this.markerBlock_!.firstElementChild!.setAttribute('values', values);\n    }\n  }\n\n  /** Dispose of this marker. */\n  dispose() {\n    if (this.svgGroup_) {\n      dom.removeNode(this.svgGroup_);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object that owns a block's rendering SVG elements.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.PathObject');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Connection} from '../../connection.js';\nimport type {BlockStyle} from '../../theme.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport type {IPathObject} from './i_path_object.js';\n\n\n/**\n * An object that handles creating and setting each of the SVG elements\n * used by the renderer.\n *\n * @alias Blockly.blockRendering.PathObject\n */\nexport class PathObject implements IPathObject {\n  svgRoot: AnyDuringMigration;\n  /** @internal */\n  svgPath: SVGElement;\n\n  /**\n   * Holds the cursors svg element when the cursor is attached to the block.\n   * This is null if there is no cursor on the block.\n   *\n   * @internal\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGElement'.\n  cursorSvg: SVGElement = null as AnyDuringMigration;\n\n  /**\n   * Holds the markers svg element when the marker is attached to the block.\n   * This is null if there is no marker on the block.\n   *\n   * @internal\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGElement'.\n  markerSvg: SVGElement = null as AnyDuringMigration;\n\n  /** @internal */\n  constants: ConstantProvider;\n  /** @internal */\n  style: BlockStyle;\n\n  /**\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @param constants The renderer's constants.\n   * @internal\n   */\n  constructor(\n      root: SVGElement, style: BlockStyle, constants: ConstantProvider) {\n    this.constants = constants;\n    this.style = style;\n    this.svgRoot = root;\n\n    /** The primary path of the block. */\n    this.svgPath =\n        dom.createSvgElement(Svg.PATH, {'class': 'blocklyPath'}, this.svgRoot);\n  }\n\n  /**\n   * Set the path generated by the renderer onto the respective SVG element.\n   *\n   * @param pathString The path.\n   * @internal\n   */\n  setPath(pathString: string) {\n    this.svgPath.setAttribute('d', pathString);\n  }\n\n  /**\n   * Flip the SVG paths in RTL.\n   *\n   * @internal\n   */\n  flipRTL() {\n    // Mirror the block's path.\n    this.svgPath.setAttribute('transform', 'scale(-1 1)');\n  }\n\n  /**\n   * Add the cursor SVG to this block's SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the block SVG\n   *     group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    if (!cursorSvg) {\n      // AnyDuringMigration because:  Type 'null' is not assignable to type\n      // 'SVGElement'.\n      this.cursorSvg = null as AnyDuringMigration;\n      return;\n    }\n\n    this.svgRoot.appendChild(cursorSvg);\n    this.cursorSvg = cursorSvg;\n  }\n\n  /**\n   * Add the marker SVG to this block's SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the block SVG\n   *     group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    if (!markerSvg) {\n      // AnyDuringMigration because:  Type 'null' is not assignable to type\n      // 'SVGElement'.\n      this.markerSvg = null as AnyDuringMigration;\n      return;\n    }\n\n    if (this.cursorSvg) {\n      this.svgRoot.insertBefore(markerSvg, this.cursorSvg);\n    } else {\n      this.svgRoot.appendChild(markerSvg);\n    }\n    this.markerSvg = markerSvg;\n  }\n\n  /**\n   * Apply the stored colours to the block's path, taking into account whether\n   * the paths belong to a shadow block.\n   *\n   * @param block The source block.\n   * @internal\n   */\n  applyColour(block: BlockSvg) {\n    this.svgPath.setAttribute('stroke', this.style.colourTertiary);\n    this.svgPath.setAttribute('fill', this.style.colourPrimary);\n\n    this.updateShadow_(block.isShadow());\n    this.updateDisabled_(!block.isEnabled() || block.getInheritedDisabled());\n  }\n\n  /**\n   * Set the style.\n   *\n   * @param blockStyle The block style to use.\n   * @internal\n   */\n  setStyle(blockStyle: BlockStyle) {\n    this.style = blockStyle;\n  }\n\n  /**\n   * Add or remove the given CSS class on the path object's root SVG element.\n   *\n   * @param className The name of the class to add or remove\n   * @param add True if the class should be added.  False if it should be\n   *     removed.\n   */\n  protected setClass_(className: string, add: boolean) {\n    if (add) {\n      dom.addClass(this.svgRoot as Element, className);\n    } else {\n      dom.removeClass(this.svgRoot as Element, className);\n    }\n  }\n\n  /**\n   * Set whether the block shows a highlight or not.  Block highlighting is\n   * often used to visually mark blocks currently being executed.\n   *\n   * @param enable True if highlighted.\n   * @internal\n   */\n  updateHighlighted(enable: boolean) {\n    if (enable) {\n      this.svgPath.setAttribute(\n          'filter', 'url(#' + this.constants.embossFilterId + ')');\n    } else {\n      this.svgPath.setAttribute('filter', 'none');\n    }\n  }\n\n  /**\n   * Updates the look of the block to reflect a shadow state.\n   *\n   * @param shadow True if the block is a shadow block.\n   */\n  protected updateShadow_(shadow: boolean) {\n    if (shadow) {\n      this.svgPath.setAttribute('stroke', 'none');\n      this.svgPath.setAttribute('fill', this.style.colourSecondary);\n    }\n  }\n\n  /**\n   * Updates the look of the block to reflect a disabled state.\n   *\n   * @param disabled True if disabled.\n   */\n  protected updateDisabled_(disabled: boolean) {\n    this.setClass_('blocklyDisabled', disabled);\n    if (disabled) {\n      this.svgPath.setAttribute(\n          'fill', 'url(#' + this.constants.disabledPatternId + ')');\n    }\n  }\n\n  /**\n   * Add or remove styling showing that a block is selected.\n   *\n   * @param enable True if selection is enabled, false otherwise.\n   * @internal\n   */\n  updateSelected(enable: boolean) {\n    this.setClass_('blocklySelected', enable);\n  }\n\n  /**\n   * Add or remove styling showing that a block is dragged over a delete area.\n   *\n   * @param enable True if the block is being dragged over a delete area, false\n   *     otherwise.\n   * @internal\n   */\n  updateDraggingDelete(enable: boolean) {\n    this.setClass_('blocklyDraggingDelete', enable);\n  }\n\n  /**\n   * Add or remove styling showing that a block is an insertion marker.\n   *\n   * @param enable True if the block is an insertion marker, false otherwise.\n   * @internal\n   */\n  updateInsertionMarker(enable: boolean) {\n    this.setClass_('blocklyInsertionMarker', enable);\n  }\n\n  /**\n   * Add or remove styling showing that a block is movable.\n   *\n   * @param enable True if the block is movable, false otherwise.\n   * @internal\n   */\n  updateMovable(enable: boolean) {\n    this.setClass_('blocklyDraggable', enable);\n  }\n\n  /**\n   * Add or remove styling that shows that if the dragging block is dropped,\n   * this block will be replaced.  If a shadow block, it will disappear.\n   * Otherwise it will bump.\n   *\n   * @param enable True if styling should be added.\n   * @internal\n   */\n  updateReplacementFade(enable: boolean) {\n    this.setClass_('blocklyReplaceable', enable);\n  }\n\n  /**\n   * Add or remove styling that shows that if the dragging block is dropped,\n   * this block will be connected to the input.\n   *\n   * @param _conn The connection on the input to highlight.\n   * @param _enable True if styling should be added.\n   * @internal\n   */\n  updateShapeForInputHighlight(_conn: Connection, _enable: boolean) {}\n}\n// NOP\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class that controls updates to connections during drags.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.InsertionMarkerManager');\n\nimport * as blockAnimations from './block_animations.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {config} from './config.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as constants from './constants.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IDeleteArea} from './interfaces/i_delete_area.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {RenderedConnection} from './rendered_connection.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/** Represents a nearby valid connection. */\ninterface CandidateConnection {\n  closest: RenderedConnection|null;\n  local: RenderedConnection|null;\n  radius: number;\n}\n\n/**\n * An error message to throw if the block created by createMarkerBlock_ is\n * missing any components.\n */\nconst DUPLICATE_BLOCK_ERROR = 'The insertion marker ' +\n    'manager tried to create a marker but the result is missing %1. If ' +\n    'you are using a mutator, make sure your domToMutation method is ' +\n    'properly defined.';\n\n/**\n * Class that controls updates to connections during drags.  It is primarily\n * responsible for finding the closest eligible connection and highlighting or\n * unhighlighting it as needed during a drag.\n *\n * @alias Blockly.InsertionMarkerManager\n */\nexport class InsertionMarkerManager {\n  private readonly topBlock_: BlockSvg;\n  private readonly workspace_: WorkspaceSvg;\n\n  /**\n   * The last connection on the stack, if it's not the last connection on the\n   * first block.\n   * Set in initAvailableConnections, if at all.\n   */\n  private lastOnStack_: RenderedConnection|null = null;\n\n  /**\n   * The insertion marker corresponding to the last block in the stack, if\n   * that's not the same as the first block in the stack.\n   * Set in initAvailableConnections, if at all\n   */\n  private lastMarker_: BlockSvg|null = null;\n  private firstMarker_: BlockSvg;\n\n  /**\n   * The connection that this block would connect to if released immediately.\n   * Updated on every mouse move.\n   * This is not on any of the blocks that are being dragged.\n   */\n  private closestConnection_: RenderedConnection|null = null;\n\n  /**\n   * The connection that would connect to this.closestConnection_ if this\n   * block were released immediately. Updated on every mouse move. This is on\n   * the top block that is being dragged or the last block in the dragging\n   * stack.\n   */\n  private localConnection_: RenderedConnection|null = null;\n\n  /**\n   * Whether the block would be deleted if it were dropped immediately.\n   * Updated on every mouse move.\n   */\n  private wouldDeleteBlock_ = false;\n\n  /**\n   * Connection on the insertion marker block that corresponds to\n   * this.localConnection_ on the currently dragged block.\n   */\n  private markerConnection_: RenderedConnection|null = null;\n\n  /** The block that currently has an input being highlighted, or null. */\n  private highlightedBlock_: BlockSvg|null = null;\n\n  /** The block being faded to indicate replacement, or null. */\n  private fadedBlock_: BlockSvg|null = null;\n  private availableConnections_: RenderedConnection[];\n\n  /** @param block The top block in the stack being dragged. */\n  constructor(block: BlockSvg) {\n    common.setSelected(block);\n\n    /**\n     * The top block in the stack being dragged.\n     * Does not change during a drag.\n     */\n    this.topBlock_ = block;\n\n    /**\n     * The workspace on which these connections are being dragged.\n     * Does not change during a drag.\n     */\n    this.workspace_ = block.workspace;\n\n    /**\n     * The insertion marker that shows up between blocks to show where a block\n     * would go if dropped immediately.\n     */\n    this.firstMarker_ = this.createMarkerBlock_(this.topBlock_);\n\n    /**\n     * The connections on the dragging blocks that are available to connect to\n     * other blocks.  This includes all open connections on the top block, as\n     * well as the last connection on the block stack. Does not change during a\n     * drag.\n     */\n    this.availableConnections_ = this.initAvailableConnections_();\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @internal\n   */\n  dispose() {\n    this.availableConnections_.length = 0;\n\n    eventUtils.disable();\n    try {\n      if (this.firstMarker_) {\n        this.firstMarker_.dispose();\n      }\n      if (this.lastMarker_) {\n        this.lastMarker_.dispose();\n      }\n    } finally {\n      eventUtils.enable();\n    }\n  }\n\n  /**\n   * Update the available connections for the top block. These connections can\n   * change if a block is unplugged and the stack is healed.\n   *\n   * @internal\n   */\n  updateAvailableConnections() {\n    this.availableConnections_ = this.initAvailableConnections_();\n  }\n\n  /**\n   * Return whether the block would be deleted if dropped immediately, based on\n   * information from the most recent move event.\n   *\n   * @returns True if the block would be deleted if dropped immediately.\n   * @internal\n   */\n  wouldDeleteBlock(): boolean {\n    return this.wouldDeleteBlock_;\n  }\n\n  /**\n   * Return whether the block would be connected if dropped immediately, based\n   * on information from the most recent move event.\n   *\n   * @returns True if the block would be connected if dropped immediately.\n   * @internal\n   */\n  wouldConnectBlock(): boolean {\n    return !!this.closestConnection_;\n  }\n\n  /**\n   * Connect to the closest connection and render the results.\n   * This should be called at the end of a drag.\n   *\n   * @internal\n   */\n  applyConnections() {\n    if (!this.closestConnection_) return;\n    if (!this.localConnection_) {\n      throw new Error(\n          'Cannot apply connections because there is no local connection');\n    }\n    // Don't fire events for insertion markers.\n    eventUtils.disable();\n    this.hidePreview_();\n    eventUtils.enable();\n    // Connect two blocks together.\n    this.localConnection_.connect(this.closestConnection_);\n    if (this.topBlock_.rendered) {\n      // Trigger a connection animation.\n      // Determine which connection is inferior (lower in the source stack).\n      const inferiorConnection = this.localConnection_.isSuperior() ?\n          this.closestConnection_ :\n          this.localConnection_;\n      blockAnimations.connectionUiEffect(inferiorConnection.getSourceBlock());\n      // Bring the just-edited stack to the front.\n      const rootBlock = this.topBlock_.getRootBlock();\n      rootBlock.bringToFront();\n    }\n  }\n\n  /**\n   * Update connections based on the most recent move location.\n   *\n   * @param dxy Position relative to drag start, in workspace units.\n   * @param dragTarget The drag target that the block is currently over.\n   * @internal\n   */\n  update(dxy: Coordinate, dragTarget: IDragTarget|null) {\n    const candidate = this.getCandidate_(dxy);\n\n    this.wouldDeleteBlock_ = this.shouldDelete_(candidate, dragTarget);\n\n    const shouldUpdate =\n        this.wouldDeleteBlock_ || this.shouldUpdatePreviews_(candidate, dxy);\n\n    if (shouldUpdate) {\n      // Don't fire events for insertion marker creation or movement.\n      eventUtils.disable();\n      this.maybeHidePreview_(candidate);\n      this.maybeShowPreview_(candidate);\n      eventUtils.enable();\n    }\n  }\n\n  /**\n   * Create an insertion marker that represents the given block.\n   *\n   * @param sourceBlock The block that the insertion marker will represent.\n   * @returns The insertion marker that represents the given block.\n   */\n  private createMarkerBlock_(sourceBlock: BlockSvg): BlockSvg {\n    const imType = sourceBlock.type;\n\n    eventUtils.disable();\n    let result: BlockSvg;\n    try {\n      result = this.workspace_.newBlock(imType);\n      result.setInsertionMarker(true);\n      if (sourceBlock.saveExtraState) {\n        const state = sourceBlock.saveExtraState();\n        if (state && result.loadExtraState) {\n          result.loadExtraState(state);\n        }\n      } else if (sourceBlock.mutationToDom) {\n        const oldMutationDom = sourceBlock.mutationToDom();\n        if (oldMutationDom && result.domToMutation) {\n          result.domToMutation(oldMutationDom);\n        }\n      }\n      // Copy field values from the other block.  These values may impact the\n      // rendered size of the insertion marker.  Note that we do not care about\n      // child blocks here.\n      for (let i = 0; i < sourceBlock.inputList.length; i++) {\n        const sourceInput = sourceBlock.inputList[i];\n        if (sourceInput.name === constants.COLLAPSED_INPUT_NAME) {\n          continue;  // Ignore the collapsed input.\n        }\n        const resultInput = result.inputList[i];\n        if (!resultInput) {\n          throw new Error(DUPLICATE_BLOCK_ERROR.replace('%1', 'an input'));\n        }\n        for (let j = 0; j < sourceInput.fieldRow.length; j++) {\n          const sourceField = sourceInput.fieldRow[j];\n          const resultField = resultInput.fieldRow[j];\n          if (!resultField) {\n            throw new Error(DUPLICATE_BLOCK_ERROR.replace('%1', 'a field'));\n          }\n          resultField.setValue(sourceField.getValue());\n        }\n      }\n\n      result.setCollapsed(sourceBlock.isCollapsed());\n      result.setInputsInline(sourceBlock.getInputsInline());\n\n      result.initSvg();\n      result.getSvgRoot().setAttribute('visibility', 'hidden');\n    } finally {\n      eventUtils.enable();\n    }\n\n    return result;\n  }\n\n  /**\n   * Populate the list of available connections on this block stack.  This\n   * should only be called once, at the beginning of a drag. If the stack has\n   * more than one block, this function will populate lastOnStack_ and create\n   * the corresponding insertion marker.\n   *\n   * @returns A list of available connections.\n   */\n  private initAvailableConnections_(): RenderedConnection[] {\n    const available = this.topBlock_.getConnections_(false);\n    // Also check the last connection on this stack\n    const lastOnStack = this.topBlock_.lastConnectionInStack(true);\n    if (lastOnStack && lastOnStack !== this.topBlock_.nextConnection) {\n      available.push(lastOnStack);\n      this.lastOnStack_ = lastOnStack;\n      if (this.lastMarker_) {\n        eventUtils.disable();\n        try {\n          this.lastMarker_.dispose();\n        } finally {\n          eventUtils.enable();\n        }\n      }\n      this.lastMarker_ = this.createMarkerBlock_(lastOnStack.getSourceBlock());\n    }\n    return available;\n  }\n\n  /**\n   * Whether the previews (insertion marker and replacement marker) should be\n   * updated based on the closest candidate and the current drag distance.\n   *\n   * @param candidate An object containing a local connection, a closest\n   *     connection, and a radius.  Returned by getCandidate_.\n   * @param dxy Position relative to drag start, in workspace units.\n   * @returns Whether the preview should be updated.\n   */\n  private shouldUpdatePreviews_(\n      candidate: CandidateConnection, dxy: Coordinate): boolean {\n    const candidateLocal = candidate.local;\n    const candidateClosest = candidate.closest;\n    const radius = candidate.radius;\n\n    // Found a connection!\n    if (candidateLocal && candidateClosest) {\n      // We're already showing an insertion marker.\n      // Decide whether the new connection has higher priority.\n      if (this.localConnection_ && this.closestConnection_) {\n        // The connection was the same as the current connection.\n        if (this.closestConnection_ === candidateClosest &&\n            this.localConnection_ === candidateLocal) {\n          return false;\n        }\n        const xDiff =\n            this.localConnection_.x + dxy.x - this.closestConnection_.x;\n        const yDiff =\n            this.localConnection_.y + dxy.y - this.closestConnection_.y;\n        const curDistance = Math.sqrt(xDiff * xDiff + yDiff * yDiff);\n        // Slightly prefer the existing preview over a new preview.\n        return !(\n            candidateClosest &&\n            radius > curDistance - config.currentConnectionPreference);\n      } else if (!this.localConnection_ && !this.closestConnection_) {\n        // We weren't showing a preview before, but we should now.\n        return true;\n      } else {\n        console.error(\n            'Only one of localConnection_ and closestConnection_ was set.');\n      }\n    } else {  // No connection found.\n      // Only need to update if we were showing a preview before.\n      return !!(this.localConnection_ && this.closestConnection_);\n    }\n\n    console.error(\n        'Returning true from shouldUpdatePreviews, but it\\'s not clear why.');\n    return true;\n  }\n\n  /**\n   * Find the nearest valid connection, which may be the same as the current\n   * closest connection.\n   *\n   * @param dxy Position relative to drag start, in workspace units.\n   * @returns An object containing a local connection, a closest connection, and\n   *     a radius.\n   */\n  private getCandidate_(dxy: Coordinate): CandidateConnection {\n    let radius = this.getStartRadius_();\n    let candidateClosest = null;\n    let candidateLocal = null;\n\n    // It's possible that a block has added or removed connections during a\n    // drag, (e.g. in a drag/move event handler), so let's update the available\n    // connections. Note that this will be called on every move while dragging,\n    // so it might cause slowness, especially if the block stack is large.  If\n    // so, maybe it could be made more efficient. Also note that we won't update\n    // the connections if we've already connected the insertion marker to a\n    // block.\n    if (!this.markerConnection_ || !this.markerConnection_.isConnected()) {\n      this.updateAvailableConnections();\n    }\n\n    for (let i = 0; i < this.availableConnections_.length; i++) {\n      const myConnection = this.availableConnections_[i];\n      const neighbour = myConnection.closest(radius, dxy);\n      if (neighbour.connection) {\n        candidateClosest = neighbour.connection;\n        candidateLocal = myConnection;\n        radius = neighbour.radius;\n      }\n    }\n    return {closest: candidateClosest, local: candidateLocal, radius};\n  }\n\n  /**\n   * Decide the radius at which to start searching for the closest connection.\n   *\n   * @returns The radius at which to start the search for the closest\n   *     connection.\n   */\n  private getStartRadius_(): number {\n    // If there is already a connection highlighted,\n    // increase the radius we check for making new connections.\n    // Why? When a connection is highlighted, blocks move around when the\n    // insertion marker is created, which could cause the connection became out\n    // of range. By increasing radiusConnection when a connection already\n    // exists, we never \"lose\" the connection from the offset.\n    if (this.closestConnection_ && this.localConnection_) {\n      return config.connectingSnapRadius;\n    }\n    return config.snapRadius;\n  }\n\n  /**\n   * Whether ending the drag would delete the block.\n   *\n   * @param candidate An object containing a local connection, a closest\n   *     connection, and a radius.\n   * @param dragTarget The drag target that the block is currently over.\n   * @returns Whether dropping the block immediately would delete the block.\n   */\n  private shouldDelete_(\n      candidate: CandidateConnection, dragTarget: IDragTarget|null): boolean {\n    if (dragTarget) {\n      const componentManager = this.workspace_.getComponentManager();\n      const isDeleteArea = componentManager.hasCapability(\n          dragTarget.id, ComponentManager.Capability.DELETE_AREA);\n      if (isDeleteArea) {\n        return (dragTarget as IDeleteArea)\n            .wouldDelete(this.topBlock_, candidate && !!candidate.closest);\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Show an insertion marker or replacement highlighting during a drag, if\n   * needed.\n   * At the beginning of this function, this.localConnection_ and\n   * this.closestConnection_ should both be null.\n   *\n   * @param candidate An object containing a local connection, a closest\n   *     connection, and a radius.\n   */\n  private maybeShowPreview_(candidate: CandidateConnection) {\n    // Nope, don't add a marker.\n    if (this.wouldDeleteBlock_) {\n      return;\n    }\n    const closest = candidate.closest;\n    const local = candidate.local;\n\n    // Nothing to connect to.\n    if (!closest) {\n      return;\n    }\n\n    // Something went wrong and we're trying to connect to an invalid\n    // connection.\n    if (closest === this.closestConnection_ ||\n        closest.getSourceBlock().isInsertionMarker()) {\n      console.log('Trying to connect to an insertion marker');\n      return;\n    }\n    // Add an insertion marker or replacement marker.\n    this.closestConnection_ = closest;\n    this.localConnection_ = local;\n    this.showPreview_();\n  }\n\n  /**\n   * A preview should be shown.  This function figures out if it should be a\n   * block highlight or an insertion marker, and shows the appropriate one.\n   */\n  private showPreview_() {\n    if (!this.closestConnection_) {\n      throw new Error(\n          'Cannot show the preview because there is no closest connection');\n    }\n    if (!this.localConnection_) {\n      throw new Error(\n          'Cannot show the preview because there is no local connection');\n    }\n    const closest = this.closestConnection_;\n    const renderer = this.workspace_.getRenderer();\n    const method = renderer.getConnectionPreviewMethod(\n        closest, this.localConnection_, this.topBlock_);\n\n    switch (method) {\n      case InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:\n        this.showInsertionInputOutline_();\n        break;\n      case InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:\n        this.showInsertionMarker_();\n        break;\n      case InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:\n        this.showReplacementFade_();\n        break;\n    }\n\n    // Optionally highlight the actual connection, as a nod to previous\n    // behaviour.\n    if (closest && renderer.shouldHighlightConnection(closest)) {\n      closest.highlight();\n    }\n  }\n\n  /**\n   * Show an insertion marker or replacement highlighting during a drag, if\n   * needed.\n   * At the end of this function, this.localConnection_ and\n   * this.closestConnection_ should both be null.\n   *\n   * @param candidate An object containing a local connection, a closest\n   *     connection, and a radius.\n   */\n  private maybeHidePreview_(candidate: CandidateConnection) {\n    // If there's no new preview, remove the old one but don't bother deleting\n    // it. We might need it later, and this saves disposing of it and recreating\n    // it.\n    if (!candidate.closest) {\n      this.hidePreview_();\n    } else {\n      // If there's a new preview and there was an preview before, and either\n      // connection has changed, remove the old preview.\n      const hadPreview = this.closestConnection_ && this.localConnection_;\n      const closestChanged = this.closestConnection_ !== candidate.closest;\n      const localChanged = this.localConnection_ !== candidate.local;\n\n      // Also hide if we had a preview before but now we're going to delete\n      // instead.\n      if (hadPreview &&\n          (closestChanged || localChanged || this.wouldDeleteBlock_)) {\n        this.hidePreview_();\n      }\n    }\n\n    // Either way, clear out old state.\n    this.markerConnection_ = null;\n    this.closestConnection_ = null;\n    this.localConnection_ = null;\n  }\n\n  /**\n   * A preview should be hidden.  This function figures out if it is a block\n   *  highlight or an insertion marker, and hides the appropriate one.\n   */\n  private hidePreview_() {\n    if (this.closestConnection_ && this.closestConnection_.targetBlock() &&\n        this.workspace_.getRenderer().shouldHighlightConnection(\n            this.closestConnection_)) {\n      this.closestConnection_.unhighlight();\n    }\n    if (this.fadedBlock_) {\n      this.hideReplacementFade_();\n    } else if (this.highlightedBlock_) {\n      this.hideInsertionInputOutline_();\n    } else if (this.markerConnection_) {\n      this.hideInsertionMarker_();\n    }\n  }\n\n  /**\n   * Shows an insertion marker connected to the appropriate blocks (based on\n   * manager state).\n   */\n  private showInsertionMarker_() {\n    if (!this.localConnection_) {\n      throw new Error(\n          'Cannot show the insertion marker because there is no local ' +\n          'connection');\n    }\n    if (!this.closestConnection_) {\n      throw new Error(\n          'Cannot show the insertion marker because there is no closest ' +\n          'connection');\n    }\n    const local = this.localConnection_;\n    const closest = this.closestConnection_;\n\n    const isLastInStack = this.lastOnStack_ && local === this.lastOnStack_;\n    let insertionMarker = isLastInStack ? this.lastMarker_ : this.firstMarker_;\n    if (!insertionMarker) {\n      throw new Error(\n          'Cannot show the insertion marker because there is no insertion ' +\n          'marker block');\n    }\n    let imConn;\n    try {\n      imConn =\n          insertionMarker.getMatchingConnection(local.getSourceBlock(), local);\n    } catch (e) {\n      // It's possible that the number of connections on the local block has\n      // changed since the insertion marker was originally created.  Let's\n      // recreate the insertion marker and try again. In theory we could\n      // probably recreate the marker block (e.g. in getCandidate_), which is\n      // called more often during the drag, but creating a block that often\n      // might be too slow, so we only do it if necessary.\n      this.firstMarker_ = this.createMarkerBlock_(this.topBlock_);\n      insertionMarker = isLastInStack ? this.lastMarker_ : this.firstMarker_;\n      if (!insertionMarker) {\n        throw new Error(\n            'Cannot show the insertion marker because there is no insertion ' +\n            'marker block');\n      }\n      imConn =\n          insertionMarker.getMatchingConnection(local.getSourceBlock(), local);\n    }\n\n    if (!imConn) {\n      throw new Error(\n          'Cannot show the insertion marker because there is no ' +\n          'associated connection');\n    }\n\n    if (imConn === this.markerConnection_) {\n      throw new Error(\n          'Made it to showInsertionMarker_ even though the marker isn\\'t ' +\n          'changing');\n    }\n\n    // Render disconnected from everything else so that we have a valid\n    // connection location.\n    insertionMarker.render();\n    insertionMarker.rendered = true;\n    insertionMarker.getSvgRoot().setAttribute('visibility', 'visible');\n\n    if (imConn && closest) {\n      // Position so that the existing block doesn't move.\n      insertionMarker.positionNearConnection(imConn, closest);\n    }\n    if (closest) {\n      // Connect() also renders the insertion marker.\n      imConn.connect(closest);\n    }\n\n    this.markerConnection_ = imConn;\n  }\n\n  /**\n   * Disconnects and hides the current insertion marker. Should return the\n   * blocks to their original state.\n   */\n  private hideInsertionMarker_() {\n    if (!this.markerConnection_) {\n      console.log('No insertion marker connection to disconnect');\n      return;\n    }\n\n    const imConn = this.markerConnection_;\n    const imBlock = imConn.getSourceBlock();\n    const markerNext = imBlock.nextConnection;\n    const markerPrev = imBlock.previousConnection;\n    const markerOutput = imBlock.outputConnection;\n\n    const isFirstInStatementStack =\n        imConn === markerNext && !(markerPrev && markerPrev.targetConnection);\n\n    const isFirstInOutputStack = imConn.type === ConnectionType.INPUT_VALUE &&\n        !(markerOutput && markerOutput.targetConnection);\n    // The insertion marker is the first block in a stack.  Unplug won't do\n    // anything in that case.  Instead, unplug the following block.\n    if (isFirstInStatementStack || isFirstInOutputStack) {\n      imConn.targetBlock()!.unplug(false);\n    } else if (\n        imConn.type === ConnectionType.NEXT_STATEMENT &&\n        imConn !== markerNext) {\n      // Inside of a C-block, first statement connection.\n      const innerConnection = imConn.targetConnection;\n      if (innerConnection) {\n        innerConnection.getSourceBlock().unplug(false);\n      }\n\n      const previousBlockNextConnection =\n          markerPrev ? markerPrev.targetConnection : null;\n\n      imBlock.unplug(true);\n      if (previousBlockNextConnection && innerConnection) {\n        previousBlockNextConnection.connect(innerConnection);\n      }\n    } else {\n      imBlock.unplug(/* healStack */\n                     true);\n    }\n\n    if (imConn.targetConnection) {\n      throw Error(\n          'markerConnection_ still connected at the end of ' +\n          'disconnectInsertionMarker');\n    }\n\n    this.markerConnection_ = null;\n    const svg = imBlock.getSvgRoot();\n    if (svg) {\n      svg.setAttribute('visibility', 'hidden');\n    }\n  }\n\n  /** Shows an outline around the input the closest connection belongs to. */\n  private showInsertionInputOutline_() {\n    if (!this.closestConnection_) {\n      throw new Error(\n          'Cannot show the insertion marker outline because ' +\n          'there is no closest connection');\n    }\n    const closest = this.closestConnection_;\n    this.highlightedBlock_ = closest.getSourceBlock();\n    this.highlightedBlock_.highlightShapeForInput(closest, true);\n  }\n\n  /** Hides any visible input outlines. */\n  private hideInsertionInputOutline_() {\n    if (!this.highlightedBlock_) {\n      throw new Error(\n          'Cannot hide the insertion marker outline because ' +\n          'there is no highlighted block');\n    }\n    if (!this.closestConnection_) {\n      throw new Error(\n          'Cannot hide the insertion marker outline because ' +\n          'there is no closest connection');\n    }\n    this.highlightedBlock_.highlightShapeForInput(\n        this.closestConnection_, false);\n    this.highlightedBlock_ = null;\n  }\n\n  /**\n   * Shows a replacement fade affect on the closest connection's target block\n   * (the block that is currently connected to it).\n   */\n  private showReplacementFade_() {\n    if (!this.closestConnection_) {\n      throw new Error(\n          'Cannot show the replacement fade because there ' +\n          'is no closest connection');\n    }\n    this.fadedBlock_ = this.closestConnection_.targetBlock();\n    if (!this.fadedBlock_) {\n      throw new Error(\n          'Cannot show the replacement fade because the ' +\n          'closest connection does not have a target block');\n    }\n    this.fadedBlock_.fadeForReplacement(true);\n  }\n\n  /** Hides/Removes any visible fade affects. */\n  private hideReplacementFade_() {\n    if (!this.fadedBlock_) {\n      throw new Error(\n          'Cannot hide the replacement because there is no ' +\n          'faded block');\n    }\n    this.fadedBlock_.fadeForReplacement(false);\n    this.fadedBlock_ = null;\n  }\n\n  /**\n   * Get a list of the insertion markers that currently exist.  Drags have 0, 1,\n   * or 2 insertion markers.\n   *\n   * @returns A possibly empty list of insertion marker blocks.\n   * @internal\n   */\n  getInsertionMarkers(): BlockSvg[] {\n    const result = [];\n    if (this.firstMarker_) {\n      result.push(this.firstMarker_);\n    }\n    if (this.lastMarker_) {\n      result.push(this.lastMarker_);\n    }\n    return result;\n  }\n}\n\nexport namespace InsertionMarkerManager {\n  /**\n   * An enum describing different kinds of previews the InsertionMarkerManager\n   * could display.\n   */\n  export enum PREVIEW_TYPE {\n    INSERTION_MARKER = 0,\n    INPUT_OUTLINE = 1,\n    REPLACEMENT_FADE = 2,\n  }\n}\n\nexport type PreviewType = InsertionMarkerManager.PREVIEW_TYPE;\nexport const PreviewType = InsertionMarkerManager.PREVIEW_TYPE;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Base renderer.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Renderer');\n\nimport type {Block} from '../../block.js';\nimport type {BlockSvg} from '../../block_svg.js';\nimport {Connection} from '../../connection.js';\nimport {ConnectionType} from '../../connection_type.js';\nimport {InsertionMarkerManager, PreviewType} from '../../insertion_marker_manager.js';\nimport type {IRegistrable} from '../../interfaces/i_registrable.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {BlockStyle, Theme} from '../../theme.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\n\nimport {ConstantProvider} from './constants.js';\nimport * as debug from './debug.js';\nimport {Debug} from './debugger.js';\nimport {Drawer} from './drawer.js';\nimport type {IPathObject} from './i_path_object.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {PathObject} from './path_object.js';\n\n\n/**\n * The base class for a block renderer.\n *\n * @alias Blockly.blockRendering.Renderer\n */\nexport class Renderer implements IRegistrable {\n  /** The renderer's constant provider. */\n  protected constants_!: ConstantProvider;\n\n  /** @internal */\n  name: string;\n\n  /**\n   * Rendering constant overrides, passed in through options.\n   *\n   * @internal\n   */\n  overrides: object|null = null;\n\n  /**\n   * @param name The renderer name.\n   * @internal\n   */\n  constructor(name: string) {\n    this.name = name;\n  }\n\n  /**\n   * Gets the class name that identifies this renderer.\n   *\n   * @returns The CSS class name.\n   * @internal\n   */\n  getClassName(): string {\n    return this.name + '-renderer';\n  }\n\n  /**\n   * Initialize the renderer.\n   *\n   * @param theme The workspace theme object.\n   * @param opt_rendererOverrides Rendering constant overrides.\n   * @internal\n   */\n  init(\n      theme: Theme, opt_rendererOverrides?: {[rendererConstant: string]: any}) {\n    this.constants_ = this.makeConstants_();\n    if (opt_rendererOverrides) {\n      this.overrides = opt_rendererOverrides;\n      Object.assign(this.constants_, opt_rendererOverrides);\n    }\n    this.constants_.setTheme(theme);\n    this.constants_.init();\n  }\n\n  /**\n   * Create any DOM elements that this renderer needs.\n   *\n   * @param svg The root of the workspace's SVG.\n   * @param theme The workspace theme object.\n   * @internal\n   */\n  createDom(svg: SVGElement, theme: Theme) {\n    this.constants_.createDom(\n        svg, this.name + '-' + theme.name,\n        '.' + this.getClassName() + '.' + theme.getClassName());\n  }\n\n  /**\n   * Refresh the renderer after a theme change.\n   *\n   * @param svg The root of the workspace's SVG.\n   * @param theme The workspace theme object.\n   * @internal\n   */\n  refreshDom(svg: SVGElement, theme: Theme) {\n    const previousConstants = this.getConstants();\n    previousConstants.dispose();\n    this.constants_ = this.makeConstants_();\n    if (this.overrides) {\n      Object.assign(this.constants_, this.overrides);\n    }\n    // Ensure the constant provider's random identifier does not change.\n    this.constants_.randomIdentifier = previousConstants.randomIdentifier;\n    this.constants_.setTheme(theme);\n    this.constants_.init();\n    this.createDom(svg, theme);\n  }\n\n  /**\n   * Dispose of this renderer.\n   * Delete all DOM elements that this renderer and its constants created.\n   *\n   * @internal\n   */\n  dispose() {\n    if (this.constants_) {\n      this.constants_.dispose();\n    }\n  }\n\n  /**\n   * Create a new instance of the renderer's constant provider.\n   *\n   * @returns The constant provider.\n   */\n  protected makeConstants_(): ConstantProvider {\n    return new ConstantProvider();\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n\n  /**\n   * Create a new instance of the renderer's drawer.\n   *\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @returns The drawer.\n   */\n  protected makeDrawer_(block: BlockSvg, info: RenderInfo): Drawer {\n    return new Drawer(block, info);\n  }\n\n  /**\n   * Create a new instance of the renderer's debugger.\n   *\n   * @returns The renderer debugger.\n   * @suppress {strictModuleDepCheck} Debug renderer only included in\n   * playground.\n   */\n  protected makeDebugger_(): Debug {\n    return new Debug(this.getConstants());\n  }\n\n  /**\n   * Create a new instance of the renderer's marker drawer.\n   *\n   * @param workspace The workspace the marker belongs to.\n   * @param marker The marker.\n   * @returns The object in charge of drawing the marker.\n   * @internal\n   */\n  makeMarkerDrawer(workspace: WorkspaceSvg, marker: Marker): MarkerSvg {\n    return new MarkerSvg(workspace, this.getConstants(), marker);\n  }\n\n  /**\n   * Create a new instance of a renderer path object.\n   *\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @returns The renderer path object.\n   * @internal\n   */\n  makePathObject(root: SVGElement, style: BlockStyle): IPathObject {\n    return new PathObject(root, style, (this.constants_));\n  }\n\n  /**\n   * Get the current renderer's constant provider.  We assume that when this is\n   * called, the renderer has already been initialized.\n   *\n   * @returns The constant provider.\n   * @internal\n   */\n  getConstants(): ConstantProvider {\n    return this.constants_;\n  }\n\n  /**\n   * Determine whether or not to highlight a connection.\n   *\n   * @param _conn The connection to determine whether or not to highlight.\n   * @returns True if we should highlight the connection.\n   * @internal\n   */\n  shouldHighlightConnection(_conn: Connection): boolean {\n    return true;\n  }\n\n  /**\n   * Checks if an orphaned block can connect to the \"end\" of the topBlock's\n   * block-clump. If the clump is a row the end is the last input. If the clump\n   * is a stack, the end is the last next connection. If the clump is neither,\n   * then this returns false.\n   *\n   * @param topBlock The top block of the block clump we want to try and connect\n   *     to.\n   * @param orphanBlock The orphan block that wants to find a home.\n   * @param localType The type of the connection being dragged.\n   * @returns Whether there is a home for the orphan or not.\n   * @internal\n   */\n  orphanCanConnectAtEnd(\n      topBlock: BlockSvg, orphanBlock: BlockSvg, localType: number): boolean {\n    const orphanConnection = localType === ConnectionType.OUTPUT_VALUE ?\n        orphanBlock.outputConnection :\n        orphanBlock.previousConnection;\n    return !!Connection.getConnectionForOrphanedConnection(\n        topBlock as Block, orphanConnection as Connection);\n  }\n\n  /**\n   * Chooses a connection preview method based on the available connection, the\n   * current dragged connection, and the block being dragged.\n   *\n   * @param closest The available connection.\n   * @param local The connection currently being dragged.\n   * @param topBlock The block currently being dragged.\n   * @returns The preview type to display.\n   * @internal\n   */\n  getConnectionPreviewMethod(\n      closest: RenderedConnection, local: RenderedConnection,\n      topBlock: BlockSvg): PreviewType {\n    if (local.type === ConnectionType.OUTPUT_VALUE ||\n        local.type === ConnectionType.PREVIOUS_STATEMENT) {\n      if (!closest.isConnected() ||\n          this.orphanCanConnectAtEnd(\n              topBlock, closest.targetBlock() as BlockSvg, local.type)) {\n        return InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER;\n      }\n      return InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE;\n    }\n\n    return InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER;\n  }\n\n  /**\n   * Render the block.\n   *\n   * @param block The block to render.\n   * @internal\n   */\n  render(block: BlockSvg) {\n    if (debug.isDebuggerEnabled() && !block.renderingDebugger) {\n      block.renderingDebugger = this.makeDebugger_();\n    }\n    const info = this.makeRenderInfo_(block);\n    info.measure();\n    this.makeDrawer_(block, info).draw();\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object in charge of storing and updating a workspace theme\n *     and UI components.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ThemeManager');\n\nimport type {Theme} from './theme.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as dom from './utils/dom.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Class for storing and updating a workspace's theme and UI components.\n *\n * @alias Blockly.ThemeManager\n */\nexport class ThemeManager {\n  /** A list of workspaces that are subscribed to this theme. */\n  private subscribedWorkspaces_: Workspace[] = [];\n  private componentDB = new Map<string, Component[]>();\n  owner_: AnyDuringMigration;\n\n  /**\n   * @param workspace The main workspace.\n   * @param theme The workspace theme.\n   * @internal\n   */\n  constructor(private readonly workspace: WorkspaceSvg, private theme: Theme) {}\n\n  /**\n   * Get the workspace theme.\n   *\n   * @returns The workspace theme.\n   * @internal\n   */\n  getTheme(): Theme {\n    return this.theme;\n  }\n\n  /**\n   * Set the workspace theme, and refresh the workspace and all components.\n   *\n   * @param theme The workspace theme.\n   * @internal\n   */\n  setTheme(theme: Theme) {\n    const prevTheme = this.theme;\n    this.theme = theme;\n    // Set the theme name onto the injection div.\n    const injectionDiv = this.workspace.getInjectionDiv();\n    if (injectionDiv) {\n      if (prevTheme) {\n        dom.removeClass(injectionDiv, prevTheme.getClassName());\n      }\n      dom.addClass(injectionDiv, this.theme.getClassName());\n    }\n\n    // Refresh all subscribed workspaces.\n    for (let i = 0, workspace; workspace = this.subscribedWorkspaces_[i]; i++) {\n      (workspace as WorkspaceSvg).refreshTheme();\n    }\n\n    // Refresh all registered Blockly UI components.\n    for (const [key, componentList] of this.componentDB) {\n      for (const component of componentList) {\n        const element = component.element;\n        const propertyName = component.propertyName;\n        const style = this.theme && this.theme.getComponentStyle(key);\n        // AnyDuringMigration because:  Property 'style' does not exist on type\n        // 'Element'.\n        (element as AnyDuringMigration).style[propertyName] = style || '';\n      }\n    }\n\n    for (const workspace of this.subscribedWorkspaces_) {\n      (workspace as WorkspaceSvg).hideChaff();\n    }\n  }\n\n  /**\n   * Subscribe a workspace to changes to the selected theme.  If a new theme is\n   * set, the workspace is called to refresh its blocks.\n   *\n   * @param workspace The workspace to subscribe.\n   * @internal\n   */\n  subscribeWorkspace(workspace: Workspace) {\n    this.subscribedWorkspaces_.push(workspace);\n  }\n\n  /**\n   * Unsubscribe a workspace to changes to the selected theme.\n   *\n   * @param workspace The workspace to unsubscribe.\n   * @internal\n   */\n  unsubscribeWorkspace(workspace: Workspace) {\n    if (!arrayUtils.removeElem(this.subscribedWorkspaces_, workspace)) {\n      throw Error(\n          'Cannot unsubscribe a workspace that hasn\\'t been subscribed.');\n    }\n  }\n\n  /**\n   * Subscribe an element to changes to the selected theme.  If a new theme is\n   * selected, the element's style is refreshed with the new theme's style.\n   *\n   * @param element The element to subscribe.\n   * @param componentName The name used to identify the component. This must be\n   *     the same name used to configure the style in the Theme object.\n   * @param propertyName The inline style property name to update.\n   * @internal\n   */\n  subscribe(element: Element, componentName: string, propertyName: string) {\n    if (!this.componentDB.has(componentName)) {\n      this.componentDB.set(componentName, []);\n    }\n\n    // Add the element to our component map.\n    this.componentDB.get(componentName)!.push({element, propertyName});\n\n    // Initialize the element with its corresponding theme style.\n    const style = this.theme && this.theme.getComponentStyle(componentName);\n    // AnyDuringMigration because:  Property 'style' does not exist on type\n    // 'Element'.\n    (element as AnyDuringMigration).style[propertyName] = style || '';\n  }\n\n  /**\n   * Unsubscribe an element to changes to the selected theme.\n   *\n   * @param element The element to unsubscribe.\n   * @internal\n   */\n  unsubscribe(element: Element) {\n    if (!element) {\n      return;\n    }\n    // Go through all component, and remove any references to this element.\n    for (const [componentName, elements] of this.componentDB) {\n      for (let i = elements.length - 1; i >= 0; i--) {\n        if (elements[i].element === element) {\n          elements.splice(i, 1);\n        }\n      }\n      // Clean up the component map entry if the list is empty.\n      if (!elements.length) {\n        this.componentDB.delete(componentName);\n      }\n    }\n  }\n\n  /**\n   * Dispose of this theme manager.\n   *\n   * @suppress {checkTypes}\n   * @internal\n   */\n  dispose() {\n    this.owner_ = null;\n    // AnyDuringMigration because:  Type 'null' is not assignable to type\n    // 'Theme'.\n    this.theme = null as AnyDuringMigration;\n    // AnyDuringMigration because:  Type 'null' is not assignable to type\n    // 'Workspace[]'.\n    this.subscribedWorkspaces_ = null as AnyDuringMigration;\n    this.componentDB.clear();\n  }\n}\n\nexport namespace ThemeManager {\n  /** The type for a Blockly UI Component. */\n  export interface Component {\n    element: Element;\n    propertyName: string;\n  }\n}\n\nexport type Component = ThemeManager.Component;\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class extends Gesture to support pinch to zoom\n * for both pointer and touch events.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.TouchGesture');\n\nimport * as browserEvents from './browser_events.js';\nimport {Gesture} from './gesture.js';\nimport * as Touch from './touch.js';\nimport {Coordinate} from './utils/coordinate.js';\n\n/*\n * Note: In this file \"start\" refers to touchstart, mousedown, and pointerstart\n * events.  \"End\" refers to touchend, mouseup, and pointerend events.\n */\n\n/** A multiplier used to convert the gesture scale to a zoom in delta. */\nconst ZOOM_IN_MULTIPLIER = 5;\n\n/** A multiplier used to convert the gesture scale to a zoom out delta. */\nconst ZOOM_OUT_MULTIPLIER = 6;\n\n/**\n * Class for one gesture.\n *\n * @alias Blockly.TouchGesture\n */\nexport class TouchGesture extends Gesture {\n  /** Boolean for whether or not this gesture is a multi-touch gesture. */\n  private isMultiTouch_ = false;\n\n  /** A map of cached points used for tracking multi-touch gestures. */\n  private cachedPoints = new Map<string, Coordinate|null>();\n\n  /**\n   * This is the ratio between the starting distance between the touch points\n   * and the most recent distance between the touch points.\n   * Scales between 0 and 1 mean the most recent zoom was a zoom out.\n   * Scales above 1.0 mean the most recent zoom was a zoom in.\n   */\n  private previousScale_ = 0;\n\n  /** The starting distance between two touch points. */\n  private startDistance_ = 0;\n\n  /**\n   * A handle to use to unbind the second touch start or pointer down listener\n   * at the end of a drag.\n   * Opaque data returned from Blockly.bindEventWithChecks_.\n   */\n  private onStartWrapper_: browserEvents.Data|null = null;\n\n  /** Boolean for whether or not the workspace supports pinch-zoom. */\n  private isPinchZoomEnabled_: boolean|null = null;\n  override onMoveWrapper_: AnyDuringMigration;\n  override onUpWrapper_: AnyDuringMigration;\n\n  /**\n   * Start a gesture: update the workspace to indicate that a gesture is in\n   * progress and bind mousemove and mouseup handlers.\n   *\n   * @param e A mouse down, touch start or pointer down event.\n   * @internal\n   */\n  override doStart(e: MouseEvent) {\n    this.isPinchZoomEnabled_ = this.startWorkspace_.options.zoomOptions &&\n        this.startWorkspace_.options.zoomOptions.pinch;\n    super.doStart(e);\n    if (!this.isEnding_ && Touch.isTouchEvent(e)) {\n      this.handleTouchStart(e);\n    }\n  }\n\n  /**\n   * Bind gesture events.\n   * Overriding the gesture definition of this function, binding the same\n   * functions for onMoveWrapper_ and onUpWrapper_ but passing\n   * opt_noCaptureIdentifier.\n   * In addition, binding a second mouse down event to detect multi-touch\n   * events.\n   *\n   * @param e A mouse down or touch start event.\n   * @internal\n   */\n  override bindMouseEvents(e: Event) {\n    this.onStartWrapper_ = browserEvents.conditionalBind(\n        document, 'mousedown', null, this.handleStart.bind(this),\n        /* opt_noCaptureIdentifier */ true);\n    this.onMoveWrapper_ = browserEvents.conditionalBind(\n        document, 'mousemove', null, this.handleMove.bind(this),\n        /* opt_noCaptureIdentifier */ true);\n    this.onUpWrapper_ = browserEvents.conditionalBind(\n        document, 'mouseup', null, this.handleUp.bind(this),\n        /* opt_noCaptureIdentifier */ true);\n\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  /**\n   * Handle a mouse down, touch start, or pointer down event.\n   *\n   * @param e A mouse down, touch start, or pointer down event.\n   * @internal\n   */\n  handleStart(e: Event) {\n    if (this.isDragging()) {\n      // A drag has already started, so this can no longer be a pinch-zoom.\n      return;\n    }\n    if (Touch.isTouchEvent(e)) {\n      this.handleTouchStart(e);\n\n      if (this.isMultiTouch()) {\n        Touch.longStop();\n      }\n    }\n  }\n\n  /**\n   * Handle a mouse move, touch move, or pointer move event.\n   *\n   * @param e A mouse move, touch move, or pointer move event.\n   * @internal\n   */\n  override handleMove(e: MouseEvent) {\n    if (this.isDragging()) {\n      // We are in the middle of a drag, only handle the relevant events\n      if (Touch.shouldHandleEvent(e)) {\n        super.handleMove(e);\n      }\n      return;\n    }\n    if (this.isMultiTouch()) {\n      if (Touch.isTouchEvent(e)) {\n        this.handleTouchMove(e);\n      }\n      Touch.longStop();\n    } else {\n      super.handleMove(e);\n    }\n  }\n\n  /**\n   * Handle a mouse up, touch end, or pointer up event.\n   *\n   * @param e A mouse up, touch end, or pointer up event.\n   * @internal\n   */\n  override handleUp(e: Event) {\n    if (Touch.isTouchEvent(e) && !this.isDragging()) {\n      this.handleTouchEnd(e);\n    }\n    if (!this.isMultiTouch() || this.isDragging()) {\n      if (!Touch.shouldHandleEvent(e)) {\n        return;\n      }\n      super.handleUp(e);\n    } else {\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.dispose();\n    }\n  }\n\n  /**\n   * Whether this gesture is part of a multi-touch gesture.\n   *\n   * @returns Whether this gesture is part of a multi-touch gesture.\n   * @internal\n   */\n  isMultiTouch(): boolean {\n    return this.isMultiTouch_;\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @internal\n   */\n  override dispose() {\n    super.dispose();\n\n    if (this.onStartWrapper_) {\n      browserEvents.unbind(this.onStartWrapper_);\n    }\n  }\n\n  /**\n   * Handle a touch start or pointer down event and keep track of current\n   * pointers.\n   *\n   * @param e A touch start, or pointer down event.\n   * @internal\n   */\n  handleTouchStart(e: Event) {\n    const pointerId = Touch.getTouchIdentifierFromEvent(e);\n    // store the pointerId in the current list of pointers\n    this.cachedPoints.set(pointerId, this.getTouchPoint(e));\n    const pointers = Array.from(this.cachedPoints.keys());\n    // If two pointers are down, store info\n    if (pointers.length === 2) {\n      const point0 = (this.cachedPoints.get(pointers[0]))!;\n      const point1 = (this.cachedPoints.get(pointers[1]))!;\n      this.startDistance_ = Coordinate.distance(point0, point1);\n      this.isMultiTouch_ = true;\n      e.preventDefault();\n    }\n  }\n\n  /**\n   * Handle a touch move or pointer move event and zoom in/out if two pointers\n   * are on the screen.\n   *\n   * @param e A touch move, or pointer move event.\n   * @internal\n   */\n  handleTouchMove(e: MouseEvent) {\n    const pointerId = Touch.getTouchIdentifierFromEvent(e);\n    // Update the cache\n    this.cachedPoints.set(pointerId, this.getTouchPoint(e));\n\n    if (this.isPinchZoomEnabled_ && this.cachedPoints.size === 2) {\n      this.handlePinch_(e);\n    } else {\n      super.handleMove(e);\n    }\n  }\n\n  /**\n   * Handle pinch zoom gesture.\n   *\n   * @param e A touch move, or pointer move event.\n   */\n  private handlePinch_(e: MouseEvent) {\n    const pointers = Array.from(this.cachedPoints.keys());\n    // Calculate the distance between the two pointers\n    const point0 = (this.cachedPoints.get(pointers[0]))!;\n    const point1 = (this.cachedPoints.get(pointers[1]))!;\n    const moveDistance = Coordinate.distance(point0, point1);\n    const scale = moveDistance / this.startDistance_;\n\n    if (this.previousScale_ > 0 && this.previousScale_ < Infinity) {\n      const gestureScale = scale - this.previousScale_;\n      const delta = gestureScale > 0 ? gestureScale * ZOOM_IN_MULTIPLIER :\n                                       gestureScale * ZOOM_OUT_MULTIPLIER;\n      const workspace = this.startWorkspace_;\n      const position = browserEvents.mouseToSvg(\n          e, workspace.getParentSvg(), workspace.getInverseScreenCTM());\n      workspace.zoom(position.x, position.y, delta);\n    }\n    this.previousScale_ = scale;\n    e.preventDefault();\n  }\n\n  /**\n   * Handle a touch end or pointer end event and end the gesture.\n   *\n   * @param e A touch end, or pointer end event.\n   * @internal\n   */\n  handleTouchEnd(e: Event) {\n    const pointerId = Touch.getTouchIdentifierFromEvent(e);\n    if (this.cachedPoints.has(pointerId)) {\n      this.cachedPoints.delete(pointerId);\n    }\n    if (this.cachedPoints.size < 2) {\n      this.cachedPoints.clear();\n      this.previousScale_ = 0;\n    }\n  }\n\n  /**\n   * Helper function returning the current touch point coordinate.\n   *\n   * @param e A touch or pointer event.\n   * @returns The current touch point coordinate\n   * @internal\n   */\n  getTouchPoint(e: Event): Coordinate|null {\n    if (!this.startWorkspace_) {\n      return null;\n    }\n    // TODO(#6097): Make types accurate, possibly by refactoring touch handling.\n    const typelessEvent = e as AnyDuringMigration;\n    return new Coordinate(\n        typelessEvent.changedTouches ? typelessEvent.changedTouches[0].pageX :\n                                       typelessEvent.pageX,\n        typelessEvent.changedTouches ? typelessEvent.changedTouches[0].pageY :\n                                       typelessEvent.pageY);\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object that encapsulates logic for checking whether a\n * potential connection is safe and valid.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ConnectionChecker');\n\nimport * as common from './common.js';\nimport {Connection} from './connection.js';\nimport {ConnectionType} from './connection_type.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport * as internalConstants from './internal_constants.js';\nimport * as registry from './registry.js';\nimport type {RenderedConnection} from './rendered_connection.js';\n\n\n/**\n * Class for connection type checking logic.\n *\n * @alias Blockly.ConnectionChecker\n */\nexport class ConnectionChecker implements IConnectionChecker {\n  /**\n   * Check whether the current connection can connect with the target\n   * connection.\n   *\n   * @param a Connection to check compatibility with.\n   * @param b Connection to check compatibility with.\n   * @param isDragging True if the connection is being made by dragging a block.\n   * @param opt_distance The max allowable distance between the connections for\n   *     drag checks.\n   * @returns Whether the connection is legal.\n   */\n  canConnect(\n      a: Connection|null, b: Connection|null, isDragging: boolean,\n      opt_distance?: number): boolean {\n    return this.canConnectWithReason(a, b, isDragging, opt_distance) ===\n        Connection.CAN_CONNECT;\n  }\n\n  /**\n   * Checks whether the current connection can connect with the target\n   * connection, and return an error code if there are problems.\n   *\n   * @param a Connection to check compatibility with.\n   * @param b Connection to check compatibility with.\n   * @param isDragging True if the connection is being made by dragging a block.\n   * @param opt_distance The max allowable distance between the connections for\n   *     drag checks.\n   * @returns Connection.CAN_CONNECT if the connection is legal, an error code\n   *     otherwise.\n   */\n  canConnectWithReason(\n      a: Connection|null, b: Connection|null, isDragging: boolean,\n      opt_distance?: number): number {\n    const safety = this.doSafetyChecks(a, b);\n    if (safety !== Connection.CAN_CONNECT) {\n      return safety;\n    }\n\n    // If the safety checks passed, both connections are non-null.\n    const connOne = a!;\n    const connTwo = b!;\n    if (!this.doTypeChecks(connOne, connTwo)) {\n      return Connection.REASON_CHECKS_FAILED;\n    }\n\n    if (isDragging &&\n        !this.doDragChecks(\n            a as RenderedConnection, b as RenderedConnection,\n            opt_distance || 0)) {\n      return Connection.REASON_DRAG_CHECKS_FAILED;\n    }\n\n    return Connection.CAN_CONNECT;\n  }\n\n  /**\n   * Helper method that translates a connection error code into a string.\n   *\n   * @param errorCode The error code.\n   * @param a One of the two connections being checked.\n   * @param b The second of the two connections being checked.\n   * @returns A developer-readable error string.\n   */\n  getErrorMessage(errorCode: number, a: Connection|null, b: Connection|null):\n      string {\n    switch (errorCode) {\n      case Connection.REASON_SELF_CONNECTION:\n        return 'Attempted to connect a block to itself.';\n      case Connection.REASON_DIFFERENT_WORKSPACES:\n        // Usually this means one block has been deleted.\n        return 'Blocks not on same workspace.';\n      case Connection.REASON_WRONG_TYPE:\n        return 'Attempt to connect incompatible types.';\n      case Connection.REASON_TARGET_NULL:\n        return 'Target connection is null.';\n      case Connection.REASON_CHECKS_FAILED: {\n        const connOne = a!;\n        const connTwo = b!;\n        let msg = 'Connection checks failed. ';\n        msg += connOne + ' expected ' + connOne.getCheck() + ', found ' +\n            connTwo.getCheck();\n        return msg;\n      }\n      case Connection.REASON_SHADOW_PARENT:\n        return 'Connecting non-shadow to shadow block.';\n      case Connection.REASON_DRAG_CHECKS_FAILED:\n        return 'Drag checks failed.';\n      case Connection.REASON_PREVIOUS_AND_OUTPUT:\n        return 'Block would have an output and a previous connection.';\n      default:\n        return 'Unknown connection failure: this should never happen!';\n    }\n  }\n\n  /**\n   * Check that connecting the given connections is safe, meaning that it would\n   * not break any of Blockly's basic assumptions (e.g. no self connections).\n   *\n   * @param a The first of the connections to check.\n   * @param b The second of the connections to check.\n   * @returns An enum with the reason this connection is safe or unsafe.\n   */\n  doSafetyChecks(a: Connection|null, b: Connection|null): number {\n    if (!a || !b) {\n      return Connection.REASON_TARGET_NULL;\n    }\n    let superiorBlock;\n    let inferiorBlock;\n    let superiorConnection;\n    let inferiorConnection;\n    if (a.isSuperior()) {\n      superiorBlock = a.getSourceBlock();\n      inferiorBlock = b.getSourceBlock();\n      superiorConnection = a;\n      inferiorConnection = b;\n    } else {\n      inferiorBlock = a.getSourceBlock();\n      superiorBlock = b.getSourceBlock();\n      inferiorConnection = a;\n      superiorConnection = b;\n    }\n    if (superiorBlock === inferiorBlock) {\n      return Connection.REASON_SELF_CONNECTION;\n    } else if (\n        inferiorConnection.type !==\n        internalConstants.OPPOSITE_TYPE[superiorConnection.type]) {\n      return Connection.REASON_WRONG_TYPE;\n    } else if (superiorBlock.workspace !== inferiorBlock.workspace) {\n      return Connection.REASON_DIFFERENT_WORKSPACES;\n    } else if (superiorBlock.isShadow() && !inferiorBlock.isShadow()) {\n      return Connection.REASON_SHADOW_PARENT;\n    } else if (\n        inferiorConnection.type === ConnectionType.OUTPUT_VALUE &&\n        inferiorBlock.previousConnection &&\n        inferiorBlock.previousConnection.isConnected()) {\n      return Connection.REASON_PREVIOUS_AND_OUTPUT;\n    } else if (\n        inferiorConnection.type === ConnectionType.PREVIOUS_STATEMENT &&\n        inferiorBlock.outputConnection &&\n        inferiorBlock.outputConnection.isConnected()) {\n      return Connection.REASON_PREVIOUS_AND_OUTPUT;\n    }\n    return Connection.CAN_CONNECT;\n  }\n\n  /**\n   * Check whether this connection is compatible with another connection with\n   * respect to the value type system.  E.g. square_root(\"Hello\") is not\n   * compatible.\n   *\n   * @param a Connection to compare.\n   * @param b Connection to compare against.\n   * @returns True if the connections share a type.\n   */\n  doTypeChecks(a: Connection, b: Connection): boolean {\n    const checkArrayOne = a.getCheck();\n    const checkArrayTwo = b.getCheck();\n\n    if (!checkArrayOne || !checkArrayTwo) {\n      // One or both sides are promiscuous enough that anything will fit.\n      return true;\n    }\n    // Find any intersection in the check lists.\n    for (let i = 0; i < checkArrayOne.length; i++) {\n      if (checkArrayTwo.indexOf(checkArrayOne[i]) !== -1) {\n        return true;\n      }\n    }\n    // No intersection.\n    return false;\n  }\n\n  /**\n   * Check whether this connection can be made by dragging.\n   *\n   * @param a Connection to compare.\n   * @param b Connection to compare against.\n   * @param distance The maximum allowable distance between connections.\n   * @returns True if the connection is allowed during a drag.\n   */\n  doDragChecks(a: RenderedConnection, b: RenderedConnection, distance: number):\n      boolean {\n    if (a.distanceFrom(b) > distance) {\n      return false;\n    }\n\n    // Don't consider insertion markers.\n    if (b.getSourceBlock().isInsertionMarker()) {\n      return false;\n    }\n\n    switch (b.type) {\n      case ConnectionType.PREVIOUS_STATEMENT:\n        return this.canConnectToPrevious_(a, b);\n      case ConnectionType.OUTPUT_VALUE: {\n        // Don't offer to connect an already connected left (male) value plug to\n        // an available right (female) value plug.\n        if (b.isConnected() && !b.targetBlock()!.isInsertionMarker() ||\n            a.isConnected()) {\n          return false;\n        }\n        break;\n      }\n      case ConnectionType.INPUT_VALUE: {\n        // Offering to connect the left (male) of a value block to an already\n        // connected value pair is ok, we'll splice it in.\n        // However, don't offer to splice into an immovable block.\n        if (b.isConnected() && !b.targetBlock()!.isMovable() &&\n            !b.targetBlock()!.isShadow()) {\n          return false;\n        }\n        break;\n      }\n      case ConnectionType.NEXT_STATEMENT: {\n        // Don't let a block with no next connection bump other blocks out of\n        // the stack.  But covering up a shadow block or stack of shadow blocks\n        // is fine.  Similarly, replacing a terminal statement with another\n        // terminal statement is allowed.\n        if (b.isConnected() && !a.getSourceBlock().nextConnection &&\n            !b.targetBlock()!.isShadow() && b.targetBlock()!.nextConnection) {\n          return false;\n        }\n        break;\n      }\n      default:\n        // Unexpected connection type.\n        return false;\n    }\n\n    // Don't let blocks try to connect to themselves or ones they nest.\n    if (common.draggingConnections.indexOf(b) !== -1) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Helper function for drag checking.\n   *\n   * @param a The connection to check, which must be a statement input or next\n   *     connection.\n   * @param b A nearby connection to check, which must be a previous connection.\n   * @returns True if the connection is allowed, false otherwise.\n   */\n  protected canConnectToPrevious_(a: Connection, b: Connection): boolean {\n    if (a.targetConnection) {\n      // This connection is already occupied.\n      // A next connection will never disconnect itself mid-drag.\n      return false;\n    }\n\n    // Don't let blocks try to connect to themselves or ones they nest.\n    if (common.draggingConnections.indexOf(b) !== -1) {\n      return false;\n    }\n\n    if (!b.targetConnection) {\n      return true;\n    }\n\n    const targetBlock = b.targetBlock();\n    // If it is connected to a real block, game over.\n    if (!targetBlock!.isInsertionMarker()) {\n      return false;\n    }\n    // If it's connected to an insertion marker but that insertion marker\n    // is the first block in a stack, it's still fine.  If that insertion\n    // marker is in the middle of a stack, it won't work.\n    return !targetBlock!.getPreviousBlock();\n  }\n}\n\nregistry.register(\n    registry.Type.CONNECTION_CHECKER, registry.DEFAULT, ConnectionChecker);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Classes for all types of variable events.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.VarDelete');\n\nimport * as registry from '../registry.js';\nimport type {VariableModel} from '../variable_model.js';\n\nimport {VarBase} from './events_var_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a variable deletion event.\n *\n * @alias Blockly.Events.VarDelete\n */\nexport class VarDelete extends VarBase {\n  override type: string;\n\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  varType!: string;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  varName!: string;\n\n  /**\n   * @param opt_variable The deleted variable. Undefined for a blank event.\n   */\n  constructor(opt_variable?: VariableModel) {\n    super(opt_variable);\n\n    /** Type of this event. */\n    this.type = eventUtils.VAR_DELETE;\n\n    if (!opt_variable) {\n      return;  // Blank event to be populated by fromJson.\n    }\n    this.varType = opt_variable.type;\n    this.varName = opt_variable.name;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['varType'] = this.varType;\n    json['varName'] = this.varName;\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.varType = json['varType'];\n    this.varName = json['varName'];\n  }\n\n  /**\n   * Run a variable deletion event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (forward) {\n      workspace.deleteVariableById(this.varId);\n    } else {\n      workspace.createVariable(this.varName, this.varType, this.varId);\n    }\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.VAR_DELETE, VarDelete);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a variable rename event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.VarRename');\n\nimport * as registry from '../registry.js';\nimport type {VariableModel} from '../variable_model.js';\n\nimport {VarBase} from './events_var_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a variable rename event.\n *\n * @alias Blockly.Events.VarRename\n */\nexport class VarRename extends VarBase {\n  override type: string;\n\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  oldName!: string;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  newName!: string;\n\n  /**\n   * @param opt_variable The renamed variable. Undefined for a blank event.\n   * @param newName The new name the variable will be changed to.\n   */\n  constructor(opt_variable?: VariableModel, newName?: string) {\n    super(opt_variable);\n\n    /** Type of this event. */\n    this.type = eventUtils.VAR_RENAME;\n\n    if (!opt_variable) {\n      return;  // Blank event to be populated by fromJson.\n    }\n    this.oldName = opt_variable.name;\n    this.newName = typeof newName === 'undefined' ? '' : newName;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['oldName'] = this.oldName;\n    json['newName'] = this.newName;\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.oldName = json['oldName'];\n    this.newName = json['newName'];\n  }\n\n  /**\n   * Run a variable rename event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (forward) {\n      workspace.renameVariableById(this.varId, this.newName);\n    } else {\n      workspace.renameVariableById(this.varId, this.oldName);\n    }\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.VAR_RENAME, VarRename);\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a map of variables and their types.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.VariableMap');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_delete.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_rename.js';\n\nimport type {Block} from './block.js';\nimport * as dialog from './dialog.js';\nimport * as eventUtils from './events/utils.js';\nimport {Msg} from './msg.js';\nimport {Names} from './names.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport {VariableModel} from './variable_model.js';\nimport type {Workspace} from './workspace.js';\n\n\n/**\n * Class for a variable map.  This contains a dictionary data structure with\n * variable types as keys and lists of variables as values.  The list of\n * variables are the type indicated by the key.\n *\n * @alias Blockly.VariableMap\n */\nexport class VariableMap {\n  /**\n   * A map from variable type to list of variable names.  The lists contain\n   * all of the named variables in the workspace, including variables that are\n   * not currently in use.\n   */\n  private variableMap = new Map<string, VariableModel[]>();\n\n  /** @param workspace The workspace this map belongs to. */\n  constructor(public workspace: Workspace) {}\n\n  /** Clear the variable map. */\n  clear() {\n    this.variableMap.clear();\n  }\n  /* Begin functions for renaming variables. */\n  /**\n   * Rename the given variable by updating its name in the variable map.\n   *\n   * @param variable Variable to rename.\n   * @param newName New variable name.\n   * @internal\n   */\n  renameVariable(variable: VariableModel, newName: string) {\n    const type = variable.type;\n    const conflictVar = this.getVariable(newName, type);\n    const blocks = this.workspace.getAllBlocks(false);\n    eventUtils.setGroup(true);\n    try {\n      // The IDs may match if the rename is a simple case change (name1 ->\n      // Name1).\n      if (!conflictVar || conflictVar.getId() === variable.getId()) {\n        this.renameVariableAndUses_(variable, newName, blocks);\n      } else {\n        this.renameVariableWithConflict_(\n            variable, newName, conflictVar, blocks);\n      }\n    } finally {\n      eventUtils.setGroup(false);\n    }\n  }\n\n  /**\n   * Rename a variable by updating its name in the variable map. Identify the\n   * variable to rename with the given ID.\n   *\n   * @param id ID of the variable to rename.\n   * @param newName New variable name.\n   */\n  renameVariableById(id: string, newName: string) {\n    const variable = this.getVariableById(id);\n    if (!variable) {\n      throw Error('Tried to rename a variable that didn\\'t exist. ID: ' + id);\n    }\n\n    this.renameVariable(variable, newName);\n  }\n\n  /**\n   * Update the name of the given variable and refresh all references to it.\n   * The new name must not conflict with any existing variable names.\n   *\n   * @param variable Variable to rename.\n   * @param newName New variable name.\n   * @param blocks The list of all blocks in the workspace.\n   */\n  private renameVariableAndUses_(\n      variable: VariableModel, newName: string, blocks: Block[]) {\n    eventUtils.fire(\n        new (eventUtils.get(eventUtils.VAR_RENAME))(variable, newName));\n    variable.name = newName;\n    for (let i = 0; i < blocks.length; i++) {\n      blocks[i].updateVarName(variable);\n    }\n  }\n\n  /**\n   * Update the name of the given variable to the same name as an existing\n   * variable.  The two variables are coalesced into a single variable with the\n   * ID of the existing variable that was already using newName. Refresh all\n   * references to the variable.\n   *\n   * @param variable Variable to rename.\n   * @param newName New variable name.\n   * @param conflictVar The variable that was already using newName.\n   * @param blocks The list of all blocks in the workspace.\n   */\n  private renameVariableWithConflict_(\n      variable: VariableModel, newName: string, conflictVar: VariableModel,\n      blocks: Block[]) {\n    const type = variable.type;\n    const oldCase = conflictVar.name;\n\n    if (newName !== oldCase) {\n      // Simple rename to change the case and update references.\n      this.renameVariableAndUses_(conflictVar, newName, blocks);\n    }\n\n    // These blocks now refer to a different variable.\n    // These will fire change events.\n    for (let i = 0; i < blocks.length; i++) {\n      blocks[i].renameVarById(variable.getId(), conflictVar.getId());\n    }\n    // Finally delete the original variable, which is now unreferenced.\n    eventUtils.fire(new (eventUtils.get(eventUtils.VAR_DELETE))(variable));\n    // And remove it from the list.\n    arrayUtils.removeElem(this.variableMap.get(type)!, variable);\n  }\n  /* End functions for renaming variables. */\n  /**\n   * Create a variable with a given name, optional type, and optional ID.\n   *\n   * @param name The name of the variable. This must be unique across variables\n   *     and procedures.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   * @returns The newly created variable.\n   */\n  createVariable(name: string, opt_type?: string|null, opt_id?: string|null):\n      VariableModel {\n    let variable = this.getVariable(name, opt_type);\n    if (variable) {\n      if (opt_id && variable.getId() !== opt_id) {\n        throw Error(\n            'Variable \"' + name + '\" is already in use and its id is \"' +\n            variable.getId() + '\" which conflicts with the passed in ' +\n            'id, \"' + opt_id + '\".');\n      }\n      // The variable already exists and has the same ID.\n      return variable;\n    }\n    if (opt_id && this.getVariableById(opt_id)) {\n      throw Error('Variable id, \"' + opt_id + '\", is already in use.');\n    }\n    const id = opt_id || idGenerator.genUid();\n    const type = opt_type || '';\n    variable = new VariableModel(this.workspace, name, type, id);\n\n    const variables = this.variableMap.get(type) || [];\n    variables.push(variable);\n    // Delete the list of variables of this type, and re-add it so that\n    // the most recent addition is at the end.\n    // This is used so the toolbox's set block is set to the most recent\n    // variable.\n    this.variableMap.delete(type);\n    this.variableMap.set(type, variables);\n\n    return variable;\n  }\n  /* Begin functions for variable deletion. */\n  /**\n   * Delete a variable.\n   *\n   * @param variable Variable to delete.\n   */\n  deleteVariable(variable: VariableModel) {\n    const variableId = variable.getId();\n    const variableList = this.variableMap.get(variable.type);\n    if (variableList) {\n      for (let i = 0; i < variableList.length; i++) {\n        const tempVar = variableList[i];\n        if (tempVar.getId() === variableId) {\n          variableList.splice(i, 1);\n          eventUtils.fire(\n              new (eventUtils.get(eventUtils.VAR_DELETE))(variable));\n          return;\n        }\n      }\n    }\n  }\n\n  /**\n   * Delete a variables by the passed in ID and all of its uses from this\n   * workspace. May prompt the user for confirmation.\n   *\n   * @param id ID of variable to delete.\n   */\n  deleteVariableById(id: string) {\n    const variable = this.getVariableById(id);\n    if (variable) {\n      // Check whether this variable is a function parameter before deleting.\n      const variableName = variable.name;\n      const uses = this.getVariableUsesById(id);\n      for (let i = 0, block; block = uses[i]; i++) {\n        if (block.type === 'procedures_defnoreturn' ||\n            block.type === 'procedures_defreturn') {\n          const procedureName = String(block.getFieldValue('NAME'));\n          const deleteText = Msg['CANNOT_DELETE_VARIABLE_PROCEDURE']\n                                 .replace('%1', variableName)\n                                 .replace('%2', procedureName);\n          dialog.alert(deleteText);\n          return;\n        }\n      }\n\n      if (uses.length > 1) {\n        // Confirm before deleting multiple blocks.\n        const confirmText = Msg['DELETE_VARIABLE_CONFIRMATION']\n                                .replace('%1', String(uses.length))\n                                .replace('%2', variableName);\n        dialog.confirm(confirmText, (ok) => {\n          if (ok && variable) {\n            this.deleteVariableInternal(variable, uses);\n          }\n        });\n      } else {\n        // No confirmation necessary for a single block.\n        this.deleteVariableInternal(variable, uses);\n      }\n    } else {\n      console.warn('Can\\'t delete non-existent variable: ' + id);\n    }\n  }\n\n  /**\n   * Deletes a variable and all of its uses from this workspace without asking\n   * the user for confirmation.\n   *\n   * @param variable Variable to delete.\n   * @param uses An array of uses of the variable.\n   * @internal\n   */\n  deleteVariableInternal(variable: VariableModel, uses: Block[]) {\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n    try {\n      for (let i = 0; i < uses.length; i++) {\n        uses[i].dispose(true);\n      }\n      this.deleteVariable(variable);\n    } finally {\n      if (!existingGroup) {\n        eventUtils.setGroup(false);\n      }\n    }\n  }\n  /* End functions for variable deletion. */\n  /**\n   * Find the variable by the given name and type and return it.  Return null if\n   *     it is not found.\n   *\n   * @param name The name to check for.\n   * @param opt_type The type of the variable.  If not provided it defaults to\n   *     the empty string, which is a specific type.\n   * @returns The variable with the given name, or null if it was not found.\n   */\n  getVariable(name: string, opt_type?: string|null): VariableModel|null {\n    const type = opt_type || '';\n    const list = this.variableMap.get(type);\n    if (list) {\n      for (let j = 0, variable; variable = list[j]; j++) {\n        if (Names.equals(variable.name, name)) {\n          return variable;\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Find the variable by the given ID and return it.  Return null if not found.\n   *\n   * @param id The ID to check for.\n   * @returns The variable with the given ID.\n   */\n  getVariableById(id: string): VariableModel|null {\n    for (const [_key, variables] of this.variableMap) {\n      for (const variable of variables) {\n        if (variable.getId() === id) {\n          return variable;\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Get a list containing all of the variables of a specified type. If type is\n   *     null, return list of variables with empty string type.\n   *\n   * @param type Type of the variables to find.\n   * @returns The sought after variables of the passed in type. An empty array\n   *     if none are found.\n   */\n  getVariablesOfType(type: string|null): VariableModel[] {\n    type = type || '';\n    const variableList = this.variableMap.get(type);\n    if (variableList) {\n      return variableList.slice();\n    }\n    return [];\n  }\n\n  /**\n   * Return all variable and potential variable types.  This list always\n   * contains the empty string.\n   *\n   * @param ws The workspace used to look for potential variables. This can be\n   *     different than the workspace stored on this object if the passed in ws\n   *     is a flyout workspace.\n   * @returns List of variable types.\n   * @internal\n   */\n  getVariableTypes(ws: Workspace|null): string[] {\n    const variableTypes = new Set<string>(this.variableMap.keys());\n    if (ws && ws.getPotentialVariableMap()) {\n      for (const key of ws.getPotentialVariableMap()!.variableMap.keys()) {\n        variableTypes.add(key);\n      }\n    }\n    if (!variableTypes.has('')) {\n      variableTypes.add('');\n    }\n    return Array.from(variableTypes.values());\n  }\n\n  /**\n   * Return all variables of all types.\n   *\n   * @returns List of variable models.\n   */\n  getAllVariables(): VariableModel[] {\n    let allVariables: VariableModel[] = [];\n    for (const variables of this.variableMap.values()) {\n      allVariables = allVariables.concat(variables);\n    }\n    return allVariables;\n  }\n\n  /**\n   * Returns all of the variable names of all types.\n   *\n   * @returns All of the variable names of all types.\n   */\n  getAllVariableNames(): string[] {\n    return Array.from(this.variableMap.values())\n        .flat()\n        .map((variable) => variable.name);\n  }\n\n  /**\n   * Find all the uses of a named variable.\n   *\n   * @param id ID of the variable to find.\n   * @returns Array of block usages.\n   */\n  getVariableUsesById(id: string): Block[] {\n    const uses = [];\n    const blocks = this.workspace.getAllBlocks(false);\n    // Iterate through every block and check the name.\n    for (let i = 0; i < blocks.length; i++) {\n      const blockVariables = blocks[i].getVarModels();\n      if (blockVariables) {\n        for (let j = 0; j < blockVariables.length; j++) {\n          if (blockVariables[j].getId() === id) {\n            uses.push(blocks[i]);\n          }\n        }\n      }\n    }\n    return uses;\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a workspace.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Workspace');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './connection_checker.js';\n\nimport type {Block} from './block.js';\nimport type {BlocklyOptions} from './blockly_options.js';\nimport type {ConnectionDB} from './connection_db.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport * as common from './common.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IASTNodeLocation} from './interfaces/i_ast_node_location.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport {Options} from './options.js';\nimport * as registry from './registry.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport * as math from './utils/math.js';\nimport type * as toolbox from './utils/toolbox.js';\nimport {VariableMap} from './variable_map.js';\nimport type {VariableModel} from './variable_model.js';\nimport type {WorkspaceComment} from './workspace_comment.js';\n\n\n/**\n * Class for a workspace.  This is a data structure that contains blocks.\n * There is no UI, and can be created headlessly.\n *\n * @alias Blockly.Workspace\n */\nexport class Workspace implements IASTNodeLocation {\n  /**\n   * Angle away from the horizontal to sweep for blocks.  Order of execution is\n   * generally top to bottom, but a small angle changes the scan to give a bit\n   * of a left to right bias (reversed in RTL).  Units are in degrees. See:\n   * https://tvtropes.org/pmwiki/pmwiki.php/Main/DiagonalBilling\n   */\n  static SCAN_ANGLE = 3;\n  id: string;\n  options: Options;\n  RTL: boolean;\n  horizontalLayout: boolean;\n  toolboxPosition: toolbox.Position;\n\n  /**\n   * Returns `true` if the workspace is visible and `false` if it's headless.\n   */\n  rendered = false;\n\n  /**\n   * Is this workspace the surface for a flyout?\n   *\n   * @internal\n   */\n  internalIsFlyout = false;\n\n  /** Is this workspace the surface for a flyout? */\n  get isFlyout(): boolean {\n    return this.internalIsFlyout;\n  }\n\n  /**\n   * Is this workspace the surface for a mutator?\n   *\n   * @internal\n   */\n  internalIsMutator = false;\n\n  /** Is this workspace the surface for a mutator? */\n  get isMutator(): boolean {\n    return this.internalIsMutator;\n  }\n\n  /**\n   * Returns `true` if the workspace is currently in the process of a bulk\n   * clear.\n   *\n   * @internal\n   */\n  isClearing = false;\n\n  /**\n   * Maximum number of undo events in stack. `0` turns off undo, `Infinity`\n   * sets it to unlimited.\n   */\n  MAX_UNDO = 1024;\n\n  /** Set of databases for rapid lookup of connection locations. */\n  connectionDBList: ConnectionDB[] = [];\n  connectionChecker: IConnectionChecker;\n\n  private readonly topBlocks_: Block[] = [];\n  private readonly topComments_: WorkspaceComment[] = [];\n  private readonly commentDB = new Map<string, WorkspaceComment>();\n  private readonly listeners_: Function[] = [];\n  protected undoStack_: Abstract[] = [];\n  protected redoStack_: Abstract[] = [];\n  private readonly blockDB = new Map<string, Block>();\n  private readonly typedBlocksDB = new Map<string, Block[]>();\n  private variableMap_: VariableMap;\n\n  /**\n   * Blocks in the flyout can refer to variables that don't exist in the main\n   * workspace.  For instance, the \"get item in list\" block refers to an\n   * \"item\" variable regardless of whether the variable has been created yet.\n   * A FieldVariable must always refer to a VariableModel.  We reconcile\n   * these by tracking \"potential\" variables in the flyout.  These variables\n   * become real when references to them are dragged into the main workspace.\n   */\n  private potentialVariableMap_: VariableMap|null = null;\n\n  /** @param opt_options Dictionary of options. */\n  constructor(opt_options?: Options) {\n    this.id = idGenerator.genUid();\n    common.registerWorkspace(this);\n    this.options = opt_options || new Options(({} as BlocklyOptions));\n    this.RTL = !!this.options.RTL;\n    this.horizontalLayout = !!this.options.horizontalLayout;\n    this.toolboxPosition = this.options.toolboxPosition;\n\n    const connectionCheckerClass = registry.getClassFromOptions(\n        registry.Type.CONNECTION_CHECKER, this.options, true);\n    /**\n     * An object that encapsulates logic for safety, type, and dragging checks.\n     */\n    this.connectionChecker = new connectionCheckerClass!(this);\n\n    /**\n     * A map from variable type to list of variable names.  The lists contain\n     * all of the named variables in the workspace, including variables that are\n     * not currently in use.\n     */\n    this.variableMap_ = new VariableMap(this);\n  }\n\n  /**\n   * Dispose of this workspace.\n   * Unlink from all DOM elements to prevent memory leaks.\n   *\n   * @suppress {checkTypes}\n   */\n  dispose() {\n    this.listeners_.length = 0;\n    this.clear();\n    // Remove from workspace database.\n    common.unregisterWorkpace(this);\n  }\n\n  /**\n   * Compare function for sorting objects (blocks, comments, etc) by position;\n   *    top to bottom (with slight LTR or RTL bias).\n   *\n   * @param a The first object to compare.\n   * @param b The second object to compare.\n   * @returns The comparison value. This tells Array.sort() how to change object\n   *     a's index.\n   */\n  private sortObjects_(a: Block|WorkspaceComment, b: Block|WorkspaceComment):\n      number {\n    // AnyDuringMigration because:  Property 'getRelativeToSurfaceXY' does not\n    // exist on type 'Block | WorkspaceComment'.\n    const aXY = (a as AnyDuringMigration).getRelativeToSurfaceXY();\n    // AnyDuringMigration because:  Property 'getRelativeToSurfaceXY' does not\n    // exist on type 'Block | WorkspaceComment'.\n    const bXY = (b as AnyDuringMigration).getRelativeToSurfaceXY();\n    // AnyDuringMigration because:  Property 'offset' does not exist on type\n    // '(a: Block | WorkspaceComment, b: Block | WorkspaceComment) => number'.\n    // AnyDuringMigration because:  Property 'offset' does not exist on type\n    // '(a: Block | WorkspaceComment, b: Block | WorkspaceComment) => number'.\n    return aXY.y +\n        (Workspace.prototype.sortObjects_ as AnyDuringMigration).offset *\n        aXY.x -\n        (bXY.y +\n         (Workspace.prototype.sortObjects_ as AnyDuringMigration).offset *\n             bXY.x);\n  }\n\n  /**\n   * Adds a block to the list of top blocks.\n   *\n   * @param block Block to add.\n   */\n  addTopBlock(block: Block) {\n    this.topBlocks_.push(block);\n  }\n\n  /**\n   * Removes a block from the list of top blocks.\n   *\n   * @param block Block to remove.\n   */\n  removeTopBlock(block: Block) {\n    if (!arrayUtils.removeElem(this.topBlocks_, block)) {\n      throw Error('Block not present in workspace\\'s list of top-most blocks.');\n    }\n  }\n\n  /**\n   * Finds the top-level blocks and returns them.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns The top-level block objects.\n   */\n  getTopBlocks(ordered: boolean): Block[] {\n    // Copy the topBlocks_ list.\n    const blocks = (new Array<Block>()).concat(this.topBlocks_);\n    if (ordered && blocks.length > 1) {\n      // AnyDuringMigration because:  Property 'offset' does not exist on type\n      // '(a: Block | WorkspaceComment, b: Block | WorkspaceComment) => number'.\n      (this.sortObjects_ as AnyDuringMigration).offset =\n          Math.sin(math.toRadians(Workspace.SCAN_ANGLE));\n      if (this.RTL) {\n        // AnyDuringMigration because:  Property 'offset' does not exist on type\n        // '(a: Block | WorkspaceComment, b: Block | WorkspaceComment) =>\n        // number'.\n        (this.sortObjects_ as AnyDuringMigration).offset *= -1;\n      }\n      blocks.sort(this.sortObjects_);\n    }\n    return blocks;\n  }\n\n  /**\n   * Add a block to the list of blocks keyed by type.\n   *\n   * @param block Block to add.\n   */\n  addTypedBlock(block: Block) {\n    if (!this.typedBlocksDB.has(block.type)) {\n      this.typedBlocksDB.set(block.type, []);\n    }\n    this.typedBlocksDB.get(block.type)!.push(block);\n  }\n\n  /**\n   * Remove a block from the list of blocks keyed by type.\n   *\n   * @param block Block to remove.\n   */\n  removeTypedBlock(block: Block) {\n    arrayUtils.removeElem(this.typedBlocksDB.get(block.type)!, block);\n    if (!this.typedBlocksDB.get(block.type)!.length) {\n      this.typedBlocksDB.delete(block.type);\n    }\n  }\n\n  /**\n   * Finds the blocks with the associated type and returns them. Blocks are\n   * optionally sorted by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param type The type of block to search for.\n   * @param ordered Sort the list if true.\n   * @returns The blocks of the given type.\n   */\n  getBlocksByType(type: string, ordered: boolean): Block[] {\n    if (!this.typedBlocksDB.has(type)) {\n      return [];\n    }\n    const blocks = this.typedBlocksDB.get(type)!.slice(0);\n    if (ordered && blocks && blocks.length > 1) {\n      // AnyDuringMigration because:  Property 'offset' does not exist on type\n      // '(a: Block | WorkspaceComment, b: Block | WorkspaceComment) => number'.\n      (this.sortObjects_ as AnyDuringMigration).offset =\n          Math.sin(math.toRadians(Workspace.SCAN_ANGLE));\n      if (this.RTL) {\n        // AnyDuringMigration because:  Property 'offset' does not exist on type\n        // '(a: Block | WorkspaceComment, b: Block | WorkspaceComment) =>\n        // number'.\n        (this.sortObjects_ as AnyDuringMigration).offset *= -1;\n      }\n      blocks.sort(this.sortObjects_);\n    }\n\n    return blocks.filter(function(block: AnyDuringMigration) {\n      return !block.isInsertionMarker();\n    });\n  }\n\n  /**\n   * Adds a comment to the list of top comments.\n   *\n   * @param comment comment to add.\n   * @internal\n   */\n  addTopComment(comment: WorkspaceComment) {\n    this.topComments_.push(comment);\n\n    // Note: If the comment database starts to hold block comments, this may\n    // need to move to a separate function.\n    if (this.commentDB.has(comment.id)) {\n      console.warn(\n          'Overriding an existing comment on this workspace, with id \"' +\n          comment.id + '\"');\n    }\n    this.commentDB.set(comment.id, comment);\n  }\n\n  /**\n   * Removes a comment from the list of top comments.\n   *\n   * @param comment comment to remove.\n   * @internal\n   */\n  removeTopComment(comment: WorkspaceComment) {\n    if (!arrayUtils.removeElem(this.topComments_, comment)) {\n      throw Error(\n          'Comment not present in workspace\\'s list of top-most ' +\n          'comments.');\n    }\n    // Note: If the comment database starts to hold block comments, this may\n    // need to move to a separate function.\n    this.commentDB.delete(comment.id);\n  }\n\n  /**\n   * Finds the top-level comments and returns them.  Comments are optionally\n   * sorted by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns The top-level comment objects.\n   * @internal\n   */\n  getTopComments(ordered: boolean): WorkspaceComment[] {\n    // Copy the topComments_ list.\n    const comments = (new Array<WorkspaceComment>()).concat(this.topComments_);\n    if (ordered && comments.length > 1) {\n      // AnyDuringMigration because:  Property 'offset' does not exist on type\n      // '(a: Block | WorkspaceComment, b: Block | WorkspaceComment) => number'.\n      (this.sortObjects_ as AnyDuringMigration).offset =\n          Math.sin(math.toRadians(Workspace.SCAN_ANGLE));\n      if (this.RTL) {\n        // AnyDuringMigration because:  Property 'offset' does not exist on type\n        // '(a: Block | WorkspaceComment, b: Block | WorkspaceComment) =>\n        // number'.\n        (this.sortObjects_ as AnyDuringMigration).offset *= -1;\n      }\n      comments.sort(this.sortObjects_);\n    }\n    return comments;\n  }\n\n  /**\n   * Find all blocks in workspace.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  getAllBlocks(ordered: boolean): Block[] {\n    let blocks: AnyDuringMigration[];\n    if (ordered) {\n      // Slow, but ordered.\n      const topBlocks = this.getTopBlocks(true);\n      blocks = [];\n      for (let i = 0; i < topBlocks.length; i++) {\n        blocks.push(...topBlocks[i].getDescendants(true));\n      }\n    } else {\n      // Fast, but in no particular order.\n      blocks = this.getTopBlocks(false);\n      for (let i = 0; i < blocks.length; i++) {\n        blocks.push(...blocks[i].getChildren(false));\n      }\n    }\n\n    // Insertion markers exist on the workspace for rendering reasons, but\n    // aren't \"real\" blocks from a developer perspective.\n    const filtered = blocks.filter(function(block) {\n      return !block.isInsertionMarker();\n    });\n\n    return filtered;\n  }\n\n  /** Dispose of all blocks and comments in workspace. */\n  clear() {\n    this.isClearing = true;\n    try {\n      const existingGroup = eventUtils.getGroup();\n      if (!existingGroup) {\n        eventUtils.setGroup(true);\n      }\n      while (this.topBlocks_.length) {\n        this.topBlocks_[0].dispose(false);\n      }\n      while (this.topComments_.length) {\n        this.topComments_[this.topComments_.length - 1].dispose();\n      }\n      if (!existingGroup) {\n        eventUtils.setGroup(false);\n      }\n      this.variableMap_.clear();\n      if (this.potentialVariableMap_) {\n        this.potentialVariableMap_.clear();\n      }\n    } finally {\n      this.isClearing = false;\n    }\n  }\n\n  /* Begin functions that are just pass-throughs to the variable map. */\n  /**\n   * Rename a variable by updating its name in the variable map. Identify the\n   * variable to rename with the given ID.\n   *\n   * @param id ID of the variable to rename.\n   * @param newName New variable name.\n   */\n  renameVariableById(id: string, newName: string) {\n    this.variableMap_.renameVariableById(id, newName);\n  }\n\n  /**\n   * Create a variable with a given name, optional type, and optional ID.\n   *\n   * @param name The name of the variable. This must be unique across variables\n   *     and procedures.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   * @returns The newly created variable.\n   */\n  createVariable(name: string, opt_type?: string|null, opt_id?: string|null):\n      VariableModel {\n    return this.variableMap_.createVariable(name, opt_type, opt_id);\n  }\n\n  /**\n   * Find all the uses of the given variable, which is identified by ID.\n   *\n   * @param id ID of the variable to find.\n   * @returns Array of block usages.\n   */\n  getVariableUsesById(id: string): Block[] {\n    return this.variableMap_.getVariableUsesById(id);\n  }\n\n  /**\n   * Delete a variables by the passed in ID and all of its uses from this\n   * workspace. May prompt the user for confirmation.\n   *\n   * @param id ID of variable to delete.\n   */\n  deleteVariableById(id: string) {\n    this.variableMap_.deleteVariableById(id);\n  }\n\n  /**\n   * Find the variable by the given name and return it. Return null if not\n   * found.\n   *\n   * @param name The name to check for.\n   * @param opt_type The type of the variable.  If not provided it defaults to\n   *     the empty string, which is a specific type.\n   * @returns The variable with the given name.\n   */\n  getVariable(name: string, opt_type?: string): VariableModel|null {\n    // TODO (#1559): Possibly delete this function after resolving #1559.\n    return this.variableMap_.getVariable(name, opt_type);\n  }\n\n  /**\n   * Find the variable by the given ID and return it. Return null if not found.\n   *\n   * @param id The ID to check for.\n   * @returns The variable with the given ID.\n   */\n  getVariableById(id: string): VariableModel|null {\n    return this.variableMap_.getVariableById(id);\n  }\n\n  /**\n   * Find the variable with the specified type. If type is null, return list of\n   *     variables with empty string type.\n   *\n   * @param type Type of the variables to find.\n   * @returns The sought after variables of the passed in type. An empty array\n   *     if none are found.\n   */\n  getVariablesOfType(type: string|null): VariableModel[] {\n    return this.variableMap_.getVariablesOfType(type);\n  }\n\n  /**\n   * Return all variable types.\n   *\n   * @returns List of variable types.\n   * @internal\n   */\n  getVariableTypes(): string[] {\n    return this.variableMap_.getVariableTypes(this);\n  }\n\n  /**\n   * Return all variables of all types.\n   *\n   * @returns List of variable models.\n   */\n  getAllVariables(): VariableModel[] {\n    return this.variableMap_.getAllVariables();\n  }\n\n  /**\n   * Returns all variable names of all types.\n   *\n   * @returns List of all variable names of all types.\n   */\n  getAllVariableNames(): string[] {\n    return this.variableMap_.getAllVariableNames();\n  }\n  /* End functions that are just pass-throughs to the variable map. */\n  /**\n   * Returns the horizontal offset of the workspace.\n   * Intended for LTR/RTL compatibility in XML.\n   * Not relevant for a headless workspace.\n   *\n   * @returns Width.\n   */\n  getWidth(): number {\n    return 0;\n  }\n\n  /* eslint-disable jsdoc/require-returns-check */\n  /* eslint-disable @typescript-eslint/no-unused-vars */\n  /**\n   * Obtain a newly created block.\n   *\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   * @returns The created block.\n   */\n  newBlock(prototypeName: string, opt_id?: string): Block {\n    throw new Error(\n        'The implementation of newBlock should be ' +\n        'monkey-patched in by blockly.ts');\n  }\n  /* eslint-enable */\n\n  /**\n   * The number of blocks that may be added to the workspace before reaching\n   *     the maxBlocks.\n   *\n   * @returns Number of blocks left.\n   */\n  remainingCapacity(): number {\n    if (isNaN(this.options.maxBlocks)) {\n      return Infinity;\n    }\n\n    return this.options.maxBlocks - this.getAllBlocks(false).length;\n  }\n\n  /**\n   * The number of blocks of the given type that may be added to the workspace\n   *    before reaching the maxInstances allowed for that type.\n   *\n   * @param type Type of block to return capacity for.\n   * @returns Number of blocks of type left.\n   */\n  remainingCapacityOfType(type: string): number {\n    if (!this.options.maxInstances) {\n      return Infinity;\n    }\n\n    const maxInstanceOfType = this.options.maxInstances[type] !== undefined ?\n        this.options.maxInstances[type] :\n        Infinity;\n\n    return maxInstanceOfType - this.getBlocksByType(type, false).length;\n  }\n\n  /**\n   * Check if there is remaining capacity for blocks of the given counts to be\n   *    created. If the total number of blocks represented by the map is more\n   * than the total remaining capacity, it returns false. If a type count is\n   * more than the remaining capacity for that type, it returns false.\n   *\n   * @param typeCountsMap A map of types to counts (usually representing blocks\n   *     to be created).\n   * @returns True if there is capacity for the given map, false otherwise.\n   */\n  isCapacityAvailable(typeCountsMap: AnyDuringMigration): boolean {\n    if (!this.hasBlockLimits()) {\n      return true;\n    }\n    let copyableBlocksCount = 0;\n    for (const type in typeCountsMap) {\n      if (typeCountsMap[type] > this.remainingCapacityOfType(type)) {\n        return false;\n      }\n      copyableBlocksCount += typeCountsMap[type];\n    }\n    if (copyableBlocksCount > this.remainingCapacity()) {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Checks if the workspace has any limits on the maximum number of blocks,\n   *    or the maximum number of blocks of specific types.\n   *\n   * @returns True if it has block limits, false otherwise.\n   */\n  hasBlockLimits(): boolean {\n    return this.options.maxBlocks !== Infinity || !!this.options.maxInstances;\n  }\n\n  /**\n   * Gets the undo stack for workplace.\n   *\n   * @returns undo stack\n   * @internal\n   */\n  getUndoStack(): Abstract[] {\n    return this.undoStack_;\n  }\n\n  /**\n   * Gets the redo stack for workplace.\n   *\n   * @returns redo stack\n   * @internal\n   */\n  getRedoStack(): Abstract[] {\n    return this.redoStack_;\n  }\n\n  /**\n   * Undo or redo the previous action.\n   *\n   * @param redo False if undo, true if redo.\n   */\n  undo(redo: boolean) {\n    const inputStack = redo ? this.redoStack_ : this.undoStack_;\n    const outputStack = redo ? this.undoStack_ : this.redoStack_;\n    const inputEvent = inputStack.pop();\n    if (!inputEvent) {\n      return;\n    }\n    let events = [inputEvent];\n    // Do another undo/redo if the next one is of the same group.\n    while (inputStack.length && inputEvent.group &&\n           inputEvent.group === inputStack[inputStack.length - 1].group) {\n      // AnyDuringMigration because:  Argument of type 'Abstract | undefined' is\n      // not assignable to parameter of type 'Abstract'.\n      events.push(inputStack.pop() as AnyDuringMigration);\n    }\n    // Push these popped events on the opposite stack.\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      outputStack.push(event);\n    }\n    events = eventUtils.filter(events, redo);\n    eventUtils.setRecordUndo(false);\n    try {\n      for (let i = 0; i < events.length; i++) {\n        const event = events[i];\n        event.run(redo);\n      }\n    } finally {\n      eventUtils.setRecordUndo(true);\n    }\n  }\n\n  /** Clear the undo/redo stacks. */\n  clearUndo() {\n    this.undoStack_.length = 0;\n    this.redoStack_.length = 0;\n    // Stop any events already in the firing queue from being undoable.\n    eventUtils.clearPendingUndo();\n  }\n\n  /**\n   * When something in this workspace changes, call a function.\n   * Note that there may be a few recent events already on the stack.  Thus the\n   * new change listener might be called with events that occurred a few\n   * milliseconds before the change listener was added.\n   *\n   * @param func Function to call.\n   * @returns Obsolete return value, ignore.\n   */\n  addChangeListener(func: Function): Function {\n    this.listeners_.push(func);\n    return func;\n  }\n\n  /**\n   * Stop listening for this workspace's changes.\n   *\n   * @param func Function to stop calling.\n   */\n  removeChangeListener(func: Function) {\n    arrayUtils.removeElem(this.listeners_, func);\n  }\n\n  /**\n   * Fire a change event.\n   *\n   * @param event Event to fire.\n   */\n  fireChangeListener(event: Abstract) {\n    if (event.recordUndo) {\n      this.undoStack_.push(event);\n      this.redoStack_.length = 0;\n      while (this.undoStack_.length > this.MAX_UNDO && this.MAX_UNDO >= 0) {\n        this.undoStack_.shift();\n      }\n    }\n    for (let i = 0; i < this.listeners_.length; i++) {\n      const func = this.listeners_[i];\n      func(event);\n    }\n  }\n\n  /**\n   * Find the block on this workspace with the specified ID.\n   *\n   * @param id ID of block to find.\n   * @returns The sought after block, or null if not found.\n   */\n  getBlockById(id: string): Block|null {\n    return this.blockDB.get(id) || null;\n  }\n\n  /**\n   * Set a block on this workspace with the specified ID.\n   *\n   * @param id ID of block to set.\n   * @param block The block to set.\n   * @internal\n   */\n  setBlockById(id: string, block: Block) {\n    this.blockDB.set(id, block);\n  }\n\n  /**\n   * Delete a block off this workspace with the specified ID.\n   *\n   * @param id ID of block to delete.\n   * @internal\n   */\n  removeBlockById(id: string) {\n    this.blockDB.delete(id);\n  }\n\n  /**\n   * Find the comment on this workspace with the specified ID.\n   *\n   * @param id ID of comment to find.\n   * @returns The sought after comment, or null if not found.\n   * @internal\n   */\n  getCommentById(id: string): WorkspaceComment|null {\n    return this.commentDB.get(id) ?? null;\n  }\n\n  /**\n   * Checks whether all value and statement inputs in the workspace are filled\n   * with blocks.\n   *\n   * @param opt_shadowBlocksAreFilled An optional argument controlling whether\n   *     shadow blocks are counted as filled. Defaults to true.\n   * @returns True if all inputs are filled, false otherwise.\n   */\n  allInputsFilled(opt_shadowBlocksAreFilled?: boolean): boolean {\n    const blocks = this.getTopBlocks(false);\n    for (let i = 0; i < blocks.length; i++) {\n      const block = blocks[i];\n      if (!block.allInputsFilled(opt_shadowBlocksAreFilled)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Return the variable map that contains \"potential\" variables.\n   * These exist in the flyout but not in the workspace.\n   *\n   * @returns The potential variable map.\n   * @internal\n   */\n  getPotentialVariableMap(): VariableMap|null {\n    return this.potentialVariableMap_;\n  }\n\n  /**\n   * Create and store the potential variable map for this workspace.\n   *\n   * @internal\n   */\n  createPotentialVariableMap() {\n    this.potentialVariableMap_ = new VariableMap(this);\n  }\n\n  /**\n   * Return the map of all variables on the workspace.\n   *\n   * @returns The variable map.\n   */\n  getVariableMap(): VariableMap {\n    return this.variableMap_;\n  }\n\n  /**\n   * Set the map of all variables on the workspace.\n   *\n   * @param variableMap The variable map.\n   * @internal\n   */\n  setVariableMap(variableMap: VariableMap) {\n    this.variableMap_ = variableMap;\n  }\n\n  /**\n   * Find the workspace with the specified ID.\n   *\n   * @param id ID of workspace to find.\n   * @returns The sought after workspace or null if not found.\n   */\n  static getById(id: string): Workspace|null {\n    return common.getWorkspaceById(id);\n  }\n\n  /**\n   * Find all workspaces.\n   *\n   * @returns Array of workspaces.\n   */\n  static getAll(): Workspace[] {\n    return common.getAllWorkspaces();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object in charge of loading, storing, and playing audio for a\n *     workspace.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.WorkspaceAudio');\n\nimport * as userAgent from './utils/useragent.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Prevent a sound from playing if another sound preceded it within this many\n * milliseconds.\n */\nconst SOUND_LIMIT = 100;\n\n/**\n * Class for loading, storing, and playing audio for a workspace.\n *\n * @alias Blockly.WorkspaceAudio\n */\nexport class WorkspaceAudio {\n  /** Database of pre-loaded sounds. */\n  private sounds = new Map<string, HTMLAudioElement>();\n\n  /** Time that the last sound was played. */\n  private lastSound_: Date|null = null;\n\n  /**\n   * @param parentWorkspace The parent of the workspace this audio object\n   *     belongs to, or null.\n   */\n  constructor(private parentWorkspace: WorkspaceSvg) {}\n\n  /**\n   * Dispose of this audio manager.\n   *\n   * @internal\n   */\n  dispose() {\n    this.sounds.clear();\n  }\n\n  /**\n   * Load an audio file.  Cache it, ready for instantaneous playing.\n   *\n   * @param filenames List of file types in decreasing order of preference (i.e.\n   *     increasing size).  E.g. ['media/go.mp3', 'media/go.wav'] Filenames\n   *     include path from Blockly's root.  File extensions matter.\n   * @param name Name of sound.\n   */\n  load(filenames: string[], name: string) {\n    if (!filenames.length) {\n      return;\n    }\n    let audioTest;\n    try {\n      audioTest = new globalThis['Audio']();\n    } catch (e) {\n      // No browser support for Audio.\n      // IE can throw an error even if the Audio object exists.\n      return;\n    }\n    let sound;\n    for (let i = 0; i < filenames.length; i++) {\n      const filename = filenames[i];\n      const ext = filename.match(/\\.(\\w+)$/);\n      if (ext && audioTest.canPlayType('audio/' + ext[1])) {\n        // Found an audio format we can play.\n        sound = new globalThis['Audio'](filename);\n        break;\n      }\n    }\n    if (sound) {\n      this.sounds.set(name, sound);\n    }\n  }\n\n  /**\n   * Preload all the audio files so that they play quickly when asked for.\n   *\n   * @internal\n   */\n  preload() {\n    for (const sound of this.sounds.values()) {\n      sound.volume = 0.01;\n      const playPromise = sound.play();\n      // Edge does not return a promise, so we need to check.\n      if (playPromise !== undefined) {\n        // If we don't wait for the play request to complete before calling\n        // pause() we will get an exception: (DOMException: The play() request\n        // was interrupted) See more:\n        // https://developers.google.com/web/updates/2017/06/play-request-was-interrupted\n        playPromise.then(sound.pause)\n            .catch(\n                // Play without user interaction was prevented.\n                function() {});\n      } else {\n        sound.pause();\n      }\n\n      // iOS can only process one sound at a time.  Trying to load more than one\n      // corrupts the earlier ones.  Just load one and leave the others\n      // uncached.\n      if (userAgent.IPAD || userAgent.IPHONE) {\n        break;\n      }\n    }\n  }\n\n  /**\n   * Play a named sound at specified volume.  If volume is not specified,\n   * use full volume (1).\n   *\n   * @param name Name of sound.\n   * @param opt_volume Volume of sound (0-1).\n   */\n  play(name: string, opt_volume?: number) {\n    const sound = this.sounds.get(name);\n    if (sound) {\n      // Don't play one sound on top of another.\n      const now = new Date();\n      if (this.lastSound_ !== null &&\n          now.getTime() - this.lastSound_.getTime() < SOUND_LIMIT) {\n        return;\n      }\n      this.lastSound_ = now;\n      let mySound;\n      if (userAgent.IPAD || userAgent.ANDROID) {\n        // Creating a new audio node causes lag in Android and iPad.  Android\n        // refetches the file from the server, iPad uses a singleton audio\n        // node which must be deleted and recreated for each new audio tag.\n        mySound = sound;\n      } else {\n        mySound = sound.cloneNode() as HTMLAudioElement;\n      }\n      mySound.volume = opt_volume === undefined ? 1 : opt_volume;\n      mySound.play();\n    } else if (this.parentWorkspace) {\n      // Maybe a workspace on a lower level knows about this sound.\n      this.parentWorkspace.getAudioManager().play(name, opt_volume);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2015 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a zoom icons.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ZoomControls');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_click.js';\n\nimport * as browserEvents from './browser_events.js';\nimport {ComponentManager} from './component_manager.js';\nimport * as Css from './css.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IPositionable} from './interfaces/i_positionable.js';\nimport type {UiMetrics} from './metrics_manager.js';\nimport * as uiPosition from './positionable_helpers.js';\nimport {SPRITE} from './sprites.js';\nimport * as Touch from './touch.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Class for a zoom controls.\n *\n * @alias Blockly.ZoomControls\n */\nexport class ZoomControls implements IPositionable {\n  /**\n   * The unique id for this component that is used to register with the\n   * ComponentManager.\n   */\n  id = 'zoomControls';\n\n  /**\n   * A handle to use to unbind the mouse down event handler for zoom reset\n   *    button. Opaque data returned from browserEvents.conditionalBind.\n   */\n  private onZoomResetWrapper_: browserEvents.Data|null = null;\n\n  /**\n   * A handle to use to unbind the mouse down event handler for zoom in\n   * button. Opaque data returned from browserEvents.conditionalBind.\n   */\n  private onZoomInWrapper_: browserEvents.Data|null = null;\n\n  /**\n   * A handle to use to unbind the mouse down event handler for zoom out\n   * button. Opaque data returned from browserEvents.conditionalBind.\n   */\n  private onZoomOutWrapper_: browserEvents.Data|null = null;\n\n  /** The zoom in svg <g> element. */\n  private zoomInGroup: SVGGElement|null = null;\n\n  /** The zoom out svg <g> element. */\n  private zoomOutGroup: SVGGElement|null = null;\n\n  /** The zoom reset svg <g> element. */\n  private zoomResetGroup: SVGGElement|null = null;\n\n  /** Width of the zoom controls. */\n  private readonly WIDTH_ = 32;\n\n  /** Height of each zoom control. */\n  private readonly HEIGHT_ = 32;\n\n  /** Small spacing used between the zoom in and out control, in pixels. */\n  private readonly SMALL_SPACING_ = 2;\n\n  /**\n   * Large spacing used between the zoom in and reset control, in pixels.\n   */\n  private readonly LARGE_SPACING_ = 11;\n\n  /** Distance between zoom controls and bottom or top edge of workspace. */\n  private readonly MARGIN_VERTICAL_ = 20;\n\n  /** Distance between zoom controls and right or left edge of workspace. */\n  private readonly MARGIN_HORIZONTAL_ = 20;\n\n  /** The SVG group containing the zoom controls. */\n  private svgGroup: SVGElement|null = null;\n\n  /** Left coordinate of the zoom controls. */\n  private left_ = 0;\n\n  /** Top coordinate of the zoom controls. */\n  private top_ = 0;\n\n  /** Whether this has been initialized. */\n  private initialized_ = false;\n\n  /** @param workspace The workspace to sit in. */\n  constructor(private readonly workspace: WorkspaceSvg) {}\n\n  /**\n   * Create the zoom controls.\n   *\n   * @returns The zoom controls SVG group.\n   */\n  createDom(): SVGElement {\n    this.svgGroup = dom.createSvgElement(Svg.G, {});\n\n    // Each filter/pattern needs a unique ID for the case of multiple Blockly\n    // instances on a page.  Browser behaviour becomes undefined otherwise.\n    // https://neil.fraser.name/news/2015/11/01/\n    const rnd = String(Math.random()).substring(2);\n    this.createZoomOutSvg_(rnd);\n    this.createZoomInSvg_(rnd);\n    if (this.workspace.isMovable()) {\n      // If we zoom to the center and the workspace isn't movable we could\n      // loose blocks at the edges of the workspace.\n      this.createZoomResetSvg_(rnd);\n    }\n    return this.svgGroup;\n  }\n\n  /** Initializes the zoom controls. */\n  init() {\n    this.workspace.getComponentManager().addComponent({\n      component: this,\n      weight: 2,\n      capabilities: [ComponentManager.Capability.POSITIONABLE],\n    });\n    this.initialized_ = true;\n  }\n\n  /**\n   * Disposes of this zoom controls.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    this.workspace.getComponentManager().removeComponent('zoomControls');\n    if (this.svgGroup) {\n      dom.removeNode(this.svgGroup);\n    }\n    if (this.onZoomResetWrapper_) {\n      browserEvents.unbind(this.onZoomResetWrapper_);\n    }\n    if (this.onZoomInWrapper_) {\n      browserEvents.unbind(this.onZoomInWrapper_);\n    }\n    if (this.onZoomOutWrapper_) {\n      browserEvents.unbind(this.onZoomOutWrapper_);\n    }\n  }\n\n  /**\n   * Returns the bounding rectangle of the UI element in pixel units relative to\n   * the Blockly injection div.\n   *\n   * @returns The UI elements's bounding box. Null if bounding box should be\n   *     ignored by other UI elements.\n   */\n  getBoundingRectangle(): Rect|null {\n    let height = this.SMALL_SPACING_ + 2 * this.HEIGHT_;\n    if (this.zoomResetGroup) {\n      height += this.LARGE_SPACING_ + this.HEIGHT_;\n    }\n    const bottom = this.top_ + height;\n    const right = this.left_ + this.WIDTH_;\n    return new Rect(this.top_, bottom, this.left_, right);\n  }\n\n  /**\n   * Positions the zoom controls.\n   * It is positioned in the opposite corner to the corner the\n   * categories/toolbox starts at.\n   *\n   * @param metrics The workspace metrics.\n   * @param savedPositions List of rectangles that are already on the workspace.\n   */\n  position(metrics: UiMetrics, savedPositions: Rect[]) {\n    // Not yet initialized.\n    if (!this.initialized_) {\n      return;\n    }\n\n    const cornerPosition =\n        uiPosition.getCornerOppositeToolbox(this.workspace, metrics);\n    let height = this.SMALL_SPACING_ + 2 * this.HEIGHT_;\n    if (this.zoomResetGroup) {\n      height += this.LARGE_SPACING_ + this.HEIGHT_;\n    }\n    const startRect = uiPosition.getStartPositionRect(\n        cornerPosition, new Size(this.WIDTH_, height), this.MARGIN_HORIZONTAL_,\n        this.MARGIN_VERTICAL_, metrics, this.workspace);\n\n    const verticalPosition = cornerPosition.vertical;\n    const bumpDirection = verticalPosition === uiPosition.verticalPosition.TOP ?\n        uiPosition.bumpDirection.DOWN :\n        uiPosition.bumpDirection.UP;\n    const positionRect = uiPosition.bumpPositionRect(\n        startRect, this.MARGIN_VERTICAL_, bumpDirection, savedPositions);\n\n    if (verticalPosition === uiPosition.verticalPosition.TOP) {\n      const zoomInTranslateY = this.SMALL_SPACING_ + this.HEIGHT_;\n      this.zoomInGroup?.setAttribute(\n          'transform', 'translate(0, ' + zoomInTranslateY + ')');\n      if (this.zoomResetGroup) {\n        const zoomResetTranslateY =\n            zoomInTranslateY + this.LARGE_SPACING_ + this.HEIGHT_;\n        this.zoomResetGroup.setAttribute(\n            'transform', 'translate(0, ' + zoomResetTranslateY + ')');\n      }\n    } else {\n      const zoomInTranslateY =\n          this.zoomResetGroup ? this.LARGE_SPACING_ + this.HEIGHT_ : 0;\n      this.zoomInGroup?.setAttribute(\n          'transform', 'translate(0, ' + zoomInTranslateY + ')');\n      const zoomOutTranslateY =\n          zoomInTranslateY + this.SMALL_SPACING_ + this.HEIGHT_;\n      this.zoomOutGroup?.setAttribute(\n          'transform', 'translate(0, ' + zoomOutTranslateY + ')');\n    }\n\n    this.top_ = positionRect.top;\n    this.left_ = positionRect.left;\n    this.svgGroup?.setAttribute(\n        'transform', 'translate(' + this.left_ + ',' + this.top_ + ')');\n  }\n\n  /**\n   * Create the zoom in icon and its event handler.\n   *\n   * @param rnd The random string to use as a suffix in the clip path's ID.\n   *     These IDs must be unique in case there are multiple Blockly instances\n   *     on the same page.\n   */\n  private createZoomOutSvg_(rnd: string) {\n    /* This markup will be generated and added to the .svgGroup:\n        <g class=\"blocklyZoom\">\n          <clipPath id=\"blocklyZoomoutClipPath837493\">\n            <rect width=\"32\" height=\"32></rect>\n          </clipPath>\n          <image width=\"96\" height=\"124\" x=\"-64\" y=\"-92\"\n        xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyZoomoutClipPath837493)\"></image>\n        </g>\n        */\n    this.zoomOutGroup =\n        dom.createSvgElement(Svg.G, {'class': 'blocklyZoom'}, this.svgGroup);\n    const clip = dom.createSvgElement(\n        Svg.CLIPPATH, {'id': 'blocklyZoomoutClipPath' + rnd},\n        this.zoomOutGroup);\n    dom.createSvgElement(\n        Svg.RECT, {\n          'width': 32,\n          'height': 32,\n        },\n        clip);\n    const zoomoutSvg = dom.createSvgElement(\n        Svg.IMAGE, {\n          'width': SPRITE.width,\n          'height': SPRITE.height,\n          'x': -64,\n          'y': -92,\n          'clip-path': 'url(#blocklyZoomoutClipPath' + rnd + ')',\n        },\n        this.zoomOutGroup);\n    zoomoutSvg.setAttributeNS(\n        dom.XLINK_NS, 'xlink:href',\n        this.workspace.options.pathToMedia + SPRITE.url);\n\n    // Attach listener.\n    this.onZoomOutWrapper_ = browserEvents.conditionalBind(\n        this.zoomOutGroup, 'mousedown', null, this.zoom_.bind(this, -1));\n  }\n\n  /**\n   * Create the zoom out icon and its event handler.\n   *\n   * @param rnd The random string to use as a suffix in the clip path's ID.\n   *     These IDs must be unique in case there are multiple Blockly instances\n   *     on the same page.\n   */\n  private createZoomInSvg_(rnd: string) {\n    /* This markup will be generated and added to the .svgGroup:\n        <g class=\"blocklyZoom\">\n          <clipPath id=\"blocklyZoominClipPath837493\">\n            <rect width=\"32\" height=\"32\"></rect>\n          </clipPath>\n          <image width=\"96\" height=\"124\" x=\"-32\" y=\"-92\"\n        xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyZoominClipPath837493)\"></image>\n        </g>\n        */\n    this.zoomInGroup =\n        dom.createSvgElement(Svg.G, {'class': 'blocklyZoom'}, this.svgGroup);\n    const clip = dom.createSvgElement(\n        Svg.CLIPPATH, {'id': 'blocklyZoominClipPath' + rnd}, this.zoomInGroup);\n    dom.createSvgElement(\n        Svg.RECT, {\n          'width': 32,\n          'height': 32,\n        },\n        clip);\n    const zoominSvg = dom.createSvgElement(\n        Svg.IMAGE, {\n          'width': SPRITE.width,\n          'height': SPRITE.height,\n          'x': -32,\n          'y': -92,\n          'clip-path': 'url(#blocklyZoominClipPath' + rnd + ')',\n        },\n        this.zoomInGroup);\n    zoominSvg.setAttributeNS(\n        dom.XLINK_NS, 'xlink:href',\n        this.workspace.options.pathToMedia + SPRITE.url);\n\n    // Attach listener.\n    this.onZoomInWrapper_ = browserEvents.conditionalBind(\n        this.zoomInGroup, 'mousedown', null, this.zoom_.bind(this, 1));\n  }\n\n  /**\n   * Handles a mouse down event on the zoom in or zoom out buttons on the\n   *    workspace.\n   *\n   * @param amount Amount of zooming. Negative amount values zoom out, and\n   *     positive amount values zoom in.\n   * @param e A mouse down event.\n   */\n  private zoom_(amount: number, e: Event) {\n    this.workspace.markFocused();\n    this.workspace.zoomCenter(amount);\n    this.fireZoomEvent_();\n    Touch.clearTouchIdentifier();  // Don't block future drags.\n    e.stopPropagation();           // Don't start a workspace scroll.\n    e.preventDefault();            // Stop double-clicking from selecting text.\n  }\n\n  /**\n   * Create the zoom reset icon and its event handler.\n   *\n   * @param rnd The random string to use as a suffix in the clip path's ID.\n   *     These IDs must be unique in case there are multiple Blockly instances\n   *     on the same page.\n   */\n  private createZoomResetSvg_(rnd: string) {\n    /* This markup will be generated and added to the .svgGroup:\n        <g class=\"blocklyZoom\">\n          <clipPath id=\"blocklyZoomresetClipPath837493\">\n            <rect width=\"32\" height=\"32\"></rect>\n          </clipPath>\n          <image width=\"96\" height=\"124\" x=\"-32\" y=\"-92\"\n        xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyZoomresetClipPath837493)\"></image>\n        </g>\n        */\n    this.zoomResetGroup =\n        dom.createSvgElement(Svg.G, {'class': 'blocklyZoom'}, this.svgGroup);\n    const clip = dom.createSvgElement(\n        Svg.CLIPPATH, {'id': 'blocklyZoomresetClipPath' + rnd},\n        this.zoomResetGroup);\n    dom.createSvgElement(Svg.RECT, {'width': 32, 'height': 32}, clip);\n    const zoomresetSvg = dom.createSvgElement(\n        Svg.IMAGE, {\n          'width': SPRITE.width,\n          'height': SPRITE.height,\n          'y': -92,\n          'clip-path': 'url(#blocklyZoomresetClipPath' + rnd + ')',\n        },\n        this.zoomResetGroup);\n    zoomresetSvg.setAttributeNS(\n        dom.XLINK_NS, 'xlink:href',\n        this.workspace.options.pathToMedia + SPRITE.url);\n\n    // Attach event listeners.\n    this.onZoomResetWrapper_ = browserEvents.conditionalBind(\n        this.zoomResetGroup, 'mousedown', null, this.resetZoom_.bind(this));\n  }\n\n  /**\n   * Handles a mouse down event on the reset zoom button on the workspace.\n   *\n   * @param e A mouse down event.\n   */\n  private resetZoom_(e: Event) {\n    this.workspace.markFocused();\n\n    // zoom is passed amount and computes the new scale using the formula:\n    // targetScale = currentScale * Math.pow(speed, amount)\n    const targetScale = this.workspace.options.zoomOptions.startScale;\n    const currentScale = this.workspace.scale;\n    const speed = this.workspace.options.zoomOptions.scaleSpeed;\n    // To compute amount:\n    // amount = log(speed, (targetScale / currentScale))\n    // Math.log computes natural logarithm (ln), to change the base, use\n    // formula: log(base, value) = ln(value) / ln(base)\n    const amount = Math.log(targetScale / currentScale) / Math.log(speed);\n    this.workspace.beginCanvasTransition();\n    this.workspace.zoomCenter(amount);\n    this.workspace.scrollCenter();\n\n    setTimeout(this.workspace.endCanvasTransition.bind(this.workspace), 500);\n    this.fireZoomEvent_();\n    Touch.clearTouchIdentifier();  // Don't block future drags.\n    e.stopPropagation();           // Don't start a workspace scroll.\n    e.preventDefault();            // Stop double-clicking from selecting text.\n  }\n\n  /** Fires a zoom control UI event. */\n  private fireZoomEvent_() {\n    const uiEvent = new (eventUtils.get(eventUtils.CLICK))(\n        null, this.workspace.id, 'zoom_controls');\n    eventUtils.fire(uiEvent);\n  }\n}\n\n/** CSS for zoom controls.  See css.js for use. */\nCss.register(`\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n`);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Handles serializing variables to plain JavaScript objects, only containing\n * state.\n *\n * @namespace Blockly.serialization.variables\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.serialization.variables');\n\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport type {Workspace} from '../workspace.js';\n\nimport * as priorities from './priorities.js';\nimport * as serializationRegistry from './registry.js';\n\n\n/**\n * Represents the state of a given variable.\n *\n * @alias Blockly.serialization.variables.State\n */\nexport interface State {\n  name: string;\n  id: string;\n  type: string|undefined;\n}\n\n/**\n * Serializer for saving and loading variable state.\n *\n * @alias Blockly.serialization.variables.VariableSerializer\n */\nclass VariableSerializer implements ISerializer {\n  priority: number;\n\n  /* eslint-disable-next-line require-jsdoc */\n  constructor() {\n    /** The priority for deserializing variables. */\n    this.priority = priorities.VARIABLES;\n  }\n\n  /**\n   * Serializes the variables of the given workspace.\n   *\n   * @param workspace The workspace to save the variables of.\n   * @returns The state of the workspace's variables, or null if there are no\n   *     variables.\n   */\n  save(workspace: Workspace): State[]|null {\n    const variableStates = [];\n    for (const variable of workspace.getAllVariables()) {\n      const state = {\n        'name': variable.name,\n        'id': variable.getId(),\n      };\n      if (variable.type) {\n        (state as AnyDuringMigration)['type'] = variable.type;\n      }\n      variableStates.push(state);\n    }\n    // AnyDuringMigration because:  Type '{ name: string; id: string; }[] |\n    // null' is not assignable to type 'State[] | null'.\n    return (variableStates.length ? variableStates : null) as\n        AnyDuringMigration;\n  }\n\n  /**\n   * Deserializes the variable defined by the given state into the given\n   * workspace.\n   *\n   * @param state The state of the variables to deserialize.\n   * @param workspace The workspace to deserialize into.\n   */\n  load(state: State[], workspace: Workspace) {\n    for (const varState of state) {\n      workspace.createVariable(\n          varState['name'], varState['type'], varState['id']);\n    }\n  }\n\n  /**\n   * Disposes of any variables that exist on the workspace.\n   *\n   * @param workspace The workspace to clear the variables of.\n   */\n  clear(workspace: Workspace) {\n    workspace.getVariableMap().clear();\n  }\n}\n\nserializationRegistry.register('variables', new VariableSerializer());\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object that provides constants for rendering blocks in Zelos\n * mode.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.ConstantProvider');\n\nimport {ConnectionType} from '../../connection_type.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {Theme} from '../../theme.js';\nimport * as utilsColour from '../../utils/colour.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport {ConstantProvider as BaseConstantProvider} from '../common/constants.js';\nimport type {Shape} from '../common/constants.js';\n\n\n/** An object containing sizing and path information about inside corners. */\nexport interface InsideCorners {\n  width: number;\n  height: number;\n  pathTop: string;\n  pathBottom: string;\n  rightWidth: number;\n  rightHeight: number;\n  pathTopRight: string;\n  pathBottomRight: string;\n}\n\n/**\n * An object that provides constants for rendering blocks in Zelos mode.\n *\n * @alias Blockly.zelos.ConstantProvider\n */\nexport class ConstantProvider extends BaseConstantProvider {\n  GRID_UNIT = 4;\n  override SMALL_PADDING: AnyDuringMigration;\n  override MEDIUM_PADDING: AnyDuringMigration;\n  override MEDIUM_LARGE_PADDING: AnyDuringMigration;\n  override LARGE_PADDING: AnyDuringMigration;\n  override CORNER_RADIUS: AnyDuringMigration;\n  override NOTCH_WIDTH: AnyDuringMigration;\n  override NOTCH_HEIGHT: AnyDuringMigration;\n  override NOTCH_OFFSET_LEFT: AnyDuringMigration;\n  override STATEMENT_INPUT_NOTCH_OFFSET: AnyDuringMigration;\n  override MIN_BLOCK_WIDTH: AnyDuringMigration;\n  override MIN_BLOCK_HEIGHT: AnyDuringMigration;\n  override EMPTY_STATEMENT_INPUT_HEIGHT: AnyDuringMigration;\n\n  override TAB_OFFSET_FROM_TOP = 0;\n  override TOP_ROW_MIN_HEIGHT: AnyDuringMigration;\n  override TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT: AnyDuringMigration;\n  override BOTTOM_ROW_MIN_HEIGHT: AnyDuringMigration;\n  override BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT: AnyDuringMigration;\n  override STATEMENT_BOTTOM_SPACER: AnyDuringMigration;\n  STATEMENT_INPUT_SPACER_MIN_WIDTH: number;\n  override STATEMENT_INPUT_PADDING_LEFT: AnyDuringMigration;\n  override EMPTY_INLINE_INPUT_PADDING: AnyDuringMigration;\n  override EMPTY_INLINE_INPUT_HEIGHT: AnyDuringMigration;\n  override DUMMY_INPUT_MIN_HEIGHT: AnyDuringMigration;\n  override DUMMY_INPUT_SHADOW_MIN_HEIGHT: AnyDuringMigration;\n  override CURSOR_WS_WIDTH: AnyDuringMigration;\n\n  override CURSOR_COLOUR = '#ffa200';\n\n  /**\n   * Radius of the cursor for input and output connections.\n   *\n   * @internal\n   */\n  CURSOR_RADIUS = 5;\n\n  override JAGGED_TEETH_HEIGHT = 0;\n\n  override JAGGED_TEETH_WIDTH = 0;\n  override START_HAT_HEIGHT = 22;\n\n  override START_HAT_WIDTH = 96;\n\n  override SHAPES = {HEXAGONAL: 1, ROUND: 2, SQUARE: 3, PUZZLE: 4, NOTCH: 5};\n  SHAPE_IN_SHAPE_PADDING: AnyDuringMigration;\n\n  override FULL_BLOCK_FIELDS = true;\n  override FIELD_TEXT_FONTSIZE: AnyDuringMigration;\n\n  override FIELD_TEXT_FONTWEIGHT = 'bold';\n\n  override FIELD_TEXT_FONTFAMILY =\n      '\"Helvetica Neue\", \"Segoe UI\", Helvetica, sans-serif';\n  override FIELD_BORDER_RECT_RADIUS: AnyDuringMigration;\n  override FIELD_BORDER_RECT_X_PADDING: AnyDuringMigration;\n  override FIELD_BORDER_RECT_Y_PADDING: AnyDuringMigration;\n  override FIELD_BORDER_RECT_HEIGHT: AnyDuringMigration;\n  override FIELD_DROPDOWN_BORDER_RECT_HEIGHT: AnyDuringMigration;\n\n  override FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW = true;\n\n  override FIELD_DROPDOWN_COLOURED_DIV = true;\n\n  override FIELD_DROPDOWN_SVG_ARROW = true;\n  override FIELD_DROPDOWN_SVG_ARROW_PADDING: AnyDuringMigration;\n  override FIELD_TEXTINPUT_BOX_SHADOW = true;\n\n  override FIELD_COLOUR_FULL_BLOCK = true;\n  override FIELD_COLOUR_DEFAULT_WIDTH: AnyDuringMigration;\n  override FIELD_COLOUR_DEFAULT_HEIGHT: AnyDuringMigration;\n  override FIELD_CHECKBOX_X_OFFSET: AnyDuringMigration;\n  MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH: number;\n\n  /** The selected glow colour. */\n  SELECTED_GLOW_COLOUR = '#fff200';\n\n  /** The size of the selected glow. */\n  SELECTED_GLOW_SIZE = 0.5;\n\n  /** The replacement glow colour. */\n  REPLACEMENT_GLOW_COLOUR = '#fff200';\n\n  /** The size of the selected glow. */\n  REPLACEMENT_GLOW_SIZE = 2;\n\n  /**\n   * The ID of the selected glow filter, or the empty string if no filter is\n   * set.\n   *\n   * @internal\n   */\n  selectedGlowFilterId = '';\n\n  /**\n   * The <filter> element to use for a selected glow, or null if not set.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGElement'.\n  private selectedGlowFilter_: SVGElement = null as AnyDuringMigration;\n\n  /**\n   * The ID of the replacement glow filter, or the empty string if no filter\n   * is set.\n   *\n   * @internal\n   */\n  replacementGlowFilterId = '';\n\n  /**\n   * The <filter> element to use for a replacement glow, or null if not set.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGElement'.\n  private replacementGlowFilter_: SVGElement = null as AnyDuringMigration;\n\n  /**\n   * The object containing information about the hexagon used for a boolean\n   * reporter block. Null before init is called.\n   */\n  HEXAGONAL: Shape|null = null;\n\n  /**\n   * The object containing information about the hexagon used for a number or\n   * string reporter block. Null before init is called.\n   */\n  ROUNDED: Shape|null = null;\n\n  /**\n   * The object containing information about the hexagon used for a\n   * rectangular reporter block. Null before init is called.\n   */\n  SQUARED: Shape|null = null;\n\n  /** @internal */\n  constructor() {\n    super();\n\n    this.SMALL_PADDING = this.GRID_UNIT;\n\n    this.MEDIUM_PADDING = 2 * this.GRID_UNIT;\n\n    this.MEDIUM_LARGE_PADDING = 3 * this.GRID_UNIT;\n\n    this.LARGE_PADDING = 4 * this.GRID_UNIT;\n\n    this.CORNER_RADIUS = 1 * this.GRID_UNIT;\n\n    this.NOTCH_WIDTH = 9 * this.GRID_UNIT;\n\n    this.NOTCH_HEIGHT = 2 * this.GRID_UNIT;\n\n    this.NOTCH_OFFSET_LEFT = 3 * this.GRID_UNIT;\n\n    this.STATEMENT_INPUT_NOTCH_OFFSET = this.NOTCH_OFFSET_LEFT;\n\n    this.MIN_BLOCK_WIDTH = 2 * this.GRID_UNIT;\n\n    this.MIN_BLOCK_HEIGHT = 12 * this.GRID_UNIT;\n\n    this.EMPTY_STATEMENT_INPUT_HEIGHT = 6 * this.GRID_UNIT;\n\n    this.TOP_ROW_MIN_HEIGHT = this.CORNER_RADIUS;\n\n    this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT = this.LARGE_PADDING;\n\n    this.BOTTOM_ROW_MIN_HEIGHT = this.CORNER_RADIUS;\n\n    this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT = 6 * this.GRID_UNIT;\n\n    this.STATEMENT_BOTTOM_SPACER = -this.NOTCH_HEIGHT;\n\n    /** Minimum statement input spacer width. */\n    this.STATEMENT_INPUT_SPACER_MIN_WIDTH = 40 * this.GRID_UNIT;\n\n    this.STATEMENT_INPUT_PADDING_LEFT = 4 * this.GRID_UNIT;\n\n    this.EMPTY_INLINE_INPUT_PADDING = 4 * this.GRID_UNIT;\n\n    this.EMPTY_INLINE_INPUT_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.DUMMY_INPUT_MIN_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.DUMMY_INPUT_SHADOW_MIN_HEIGHT = 6 * this.GRID_UNIT;\n\n    this.CURSOR_WS_WIDTH = 20 * this.GRID_UNIT;\n\n    /**\n     * Map of output/input shapes and the amount they should cause a block to be\n     * padded. Outer key is the outer shape, inner key is the inner shape.\n     * When a block with the outer shape contains an input block with the inner\n     * shape on its left or right edge, the block elements are aligned such that\n     * the padding specified is reached.\n     *\n     * @internal\n     */\n    this.SHAPE_IN_SHAPE_PADDING = {\n      1: {\n        // Outer shape: hexagon.\n        0: 5 * this.GRID_UNIT,  // Field in hexagon.\n        1: 2 * this.GRID_UNIT,  // Hexagon in hexagon.\n        2: 5 * this.GRID_UNIT,  // Round in hexagon.\n        3: 5 * this.GRID_UNIT,  // Square in hexagon.\n      },\n      2: {\n        // Outer shape: round.\n        0: 3 * this.GRID_UNIT,  // Field in round.\n        1: 3 * this.GRID_UNIT,  // Hexagon in round.\n        2: 1 * this.GRID_UNIT,  // Round in round.\n        3: 2 * this.GRID_UNIT,  // Square in round.\n      },\n      3: {\n        // Outer shape: square.\n        0: 2 * this.GRID_UNIT,  // Field in square.\n        1: 2 * this.GRID_UNIT,  // Hexagon in square.\n        2: 2 * this.GRID_UNIT,  // Round in square.\n        3: 2 * this.GRID_UNIT,  // Square in square.\n      },\n    };\n\n    this.FIELD_TEXT_FONTSIZE = 3 * this.GRID_UNIT;\n\n    this.FIELD_BORDER_RECT_RADIUS = this.CORNER_RADIUS;\n\n    this.FIELD_BORDER_RECT_X_PADDING = 2 * this.GRID_UNIT;\n\n    this.FIELD_BORDER_RECT_Y_PADDING = 1.625 * this.GRID_UNIT;\n\n    this.FIELD_BORDER_RECT_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.FIELD_DROPDOWN_SVG_ARROW_PADDING = this.FIELD_BORDER_RECT_X_PADDING;\n\n    this.FIELD_COLOUR_DEFAULT_WIDTH = 2 * this.GRID_UNIT;\n\n    this.FIELD_COLOUR_DEFAULT_HEIGHT = 4 * this.GRID_UNIT;\n\n    this.FIELD_CHECKBOX_X_OFFSET = 1 * this.GRID_UNIT;\n\n    /** The maximum width of a dynamic connection shape. */\n    this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH = 12 * this.GRID_UNIT;\n  }\n\n  override setFontConstants_(theme: Theme) {\n    super.setFontConstants_(theme);\n\n    this.FIELD_BORDER_RECT_HEIGHT =\n        this.FIELD_TEXT_HEIGHT + this.FIELD_BORDER_RECT_Y_PADDING * 2;\n    this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT = this.FIELD_BORDER_RECT_HEIGHT;\n  }\n\n  override init() {\n    super.init();\n    this.HEXAGONAL = this.makeHexagonal();\n    this.ROUNDED = this.makeRounded();\n    this.SQUARED = this.makeSquared();\n\n    this.STATEMENT_INPUT_NOTCH_OFFSET = this.NOTCH_OFFSET_LEFT +\n        (this.INSIDE_CORNERS as InsideCorners).rightWidth;\n  }\n\n  override setDynamicProperties_(theme: Theme) {\n    super.setDynamicProperties_(theme);\n\n    this.SELECTED_GLOW_COLOUR = theme.getComponentStyle('selectedGlowColour') ||\n        this.SELECTED_GLOW_COLOUR;\n    const selectedGlowSize =\n        Number(theme.getComponentStyle('selectedGlowSize'));\n    this.SELECTED_GLOW_SIZE = selectedGlowSize && !isNaN(selectedGlowSize) ?\n        selectedGlowSize :\n        this.SELECTED_GLOW_SIZE;\n    this.REPLACEMENT_GLOW_COLOUR =\n        theme.getComponentStyle('replacementGlowColour') ||\n        this.REPLACEMENT_GLOW_COLOUR;\n    const replacementGlowSize =\n        Number(theme.getComponentStyle('replacementGlowSize'));\n    this.REPLACEMENT_GLOW_SIZE =\n        replacementGlowSize && !isNaN(replacementGlowSize) ?\n        replacementGlowSize :\n        this.REPLACEMENT_GLOW_SIZE;\n  }\n\n  override dispose() {\n    super.dispose();\n    if (this.selectedGlowFilter_) {\n      dom.removeNode(this.selectedGlowFilter_);\n    }\n    if (this.replacementGlowFilter_) {\n      dom.removeNode(this.replacementGlowFilter_);\n    }\n  }\n\n  override makeStartHat() {\n    const height = this.START_HAT_HEIGHT;\n    const width = this.START_HAT_WIDTH;\n\n    const mainPath = svgPaths.curve('c', [\n      svgPaths.point(25, -height),\n      svgPaths.point(71, -height),\n      svgPaths.point(width, 0),\n    ]);\n    return {height, width, path: mainPath};\n  }\n\n  /**\n   * Create sizing and path information about a hexagonal shape.\n   *\n   * @returns An object containing sizing and path information about a hexagonal\n   *     shape for connections.\n   * @internal\n   */\n  makeHexagonal(): Shape {\n    const maxWidth = this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;\n\n    /**\n     * Make the main path for the hexagonal connection shape out of two lines.\n     * The lines are defined with relative positions and require the block\n     * height. The 'up' and 'down' versions of the paths are the same, but the Y\n     * sign flips.  The 'left' and 'right' versions of the path are also the\n     * same, but the X sign flips.\n     *\n     * @param height The height of the block the connection is on.\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @param right True if the path is for the right side of the block.\n     * @returns A path fragment describing a rounded connection.\n     */\n    function makeMainPath(height: number, up: boolean, right: boolean): string {\n      const halfHeight = height / 2;\n      const width = halfHeight > maxWidth ? maxWidth : halfHeight;\n      const forward = up ? -1 : 1;\n      const direction = right ? -1 : 1;\n      const dy = forward * height / 2;\n      return svgPaths.lineTo(-direction * width, dy) +\n          svgPaths.lineTo(direction * width, dy);\n    }\n\n    return {\n      type: this.SHAPES.HEXAGONAL,\n      isDynamic: true,\n      width(height: number): number {\n        const halfHeight = height / 2;\n        return halfHeight > maxWidth ? maxWidth : halfHeight;\n      },\n      height(height: number): number {\n        return height;\n      },\n      connectionOffsetY(connectionHeight: number): number {\n        return connectionHeight / 2;\n      },\n      connectionOffsetX(connectionWidth: number): number {\n        return -connectionWidth;\n      },\n      pathDown(height: number): string {\n        return makeMainPath(height, false, false);\n      },\n      pathUp(height: number): string {\n        return makeMainPath(height, true, false);\n      },\n      pathRightDown(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n      pathRightUp(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n    };\n  }\n\n  /**\n   * Create sizing and path information about a rounded shape.\n   *\n   * @returns An object containing sizing and path information about a rounded\n   *     shape for connections.\n   * @internal\n   */\n  makeRounded(): Shape {\n    const maxWidth = this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;\n    const maxHeight = maxWidth * 2;\n\n    /**\n     * Make the main path for the rounded connection shape out of two arcs and\n     * a line that joins them.  The arcs are defined with relative positions.\n     * Usually, the height of the block is split between the two arcs. In the\n     * case where the height of the block exceeds the maximum height, a line is\n     * drawn in between the two arcs. The 'up' and 'down' versions of the paths\n     * are the same, but the Y sign flips.  The 'up' and 'right' versions of the\n     * path flip the sweep-flag which moves the arc at negative angles.\n     *\n     * @param blockHeight The height of the block the connection is on.\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @param right True if the path is for the right side of the block.\n     * @returns A path fragment describing a rounded connection.\n     */\n    function makeMainPath(\n        blockHeight: number, up: boolean, right: boolean): string {\n      const remainingHeight =\n          blockHeight > maxHeight ? blockHeight - maxHeight : 0;\n      const height = blockHeight > maxHeight ? maxHeight : blockHeight;\n      const radius = height / 2;\n      return svgPaths.arc(\n                 'a', '0 0,1', radius,\n                 svgPaths.point(\n                     (up ? -1 : 1) * radius, (up ? -1 : 1) * radius)) +\n          svgPaths.lineOnAxis('v', (right ? 1 : -1) * remainingHeight) +\n          svgPaths.arc(\n              'a', '0 0,1', radius,\n              svgPaths.point((up ? 1 : -1) * radius, (up ? -1 : 1) * radius));\n    }\n\n    return {\n      type: this.SHAPES.ROUND,\n      isDynamic: true,\n      width(height: number): number {\n        const halfHeight = height / 2;\n        return halfHeight > maxWidth ? maxWidth : halfHeight;\n      },\n      height(height: number): number {\n        return height;\n      },\n      connectionOffsetY(connectionHeight: number): number {\n        return connectionHeight / 2;\n      },\n      connectionOffsetX(connectionWidth: number): number {\n        return -connectionWidth;\n      },\n      pathDown(height: number): string {\n        return makeMainPath(height, false, false);\n      },\n      pathUp(height: number): string {\n        return makeMainPath(height, true, false);\n      },\n      pathRightDown(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n      pathRightUp(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n    };\n  }\n\n  /**\n   * Create sizing and path information about a squared shape.\n   *\n   * @returns An object containing sizing and path information about a squared\n   *     shape for connections.\n   * @internal\n   */\n  makeSquared(): Shape {\n    const radius = this.CORNER_RADIUS;\n\n    /**\n     * Make the main path for the squared connection shape out of two corners\n     * and a single line in-between (a and v). These are defined in relative\n     * positions and require the height of the block.\n     * The 'left' and 'right' versions of the paths are the same, but the Y sign\n     * flips.  The 'up' and 'down' versions of the path determine where the\n     * corner point is placed and in turn the direction of the corners.\n     *\n     * @param height The height of the block the connection is on.\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @param right True if the path is for the right side of the block.\n     * @returns A path fragment describing a squared connection.\n     */\n    function makeMainPath(height: number, up: boolean, right: boolean): string {\n      const innerHeight = height - radius * 2;\n      return svgPaths.arc(\n                 'a', '0 0,1', radius,\n                 svgPaths.point(\n                     (up ? -1 : 1) * radius, (up ? -1 : 1) * radius)) +\n          svgPaths.lineOnAxis('v', (right ? 1 : -1) * innerHeight) +\n          svgPaths.arc(\n              'a', '0 0,1', radius,\n              svgPaths.point((up ? 1 : -1) * radius, (up ? -1 : 1) * radius));\n    }\n\n    return {\n      type: this.SHAPES.SQUARE,\n      isDynamic: true,\n      width(_height: number): number {\n        return radius;\n      },\n      height(height: number): number {\n        return height;\n      },\n      connectionOffsetY(connectionHeight: number): number {\n        return connectionHeight / 2;\n      },\n      connectionOffsetX(connectionWidth: number): number {\n        return -connectionWidth;\n      },\n      pathDown(height: number): string {\n        return makeMainPath(height, false, false);\n      },\n      pathUp(height: number): string {\n        return makeMainPath(height, true, false);\n      },\n      pathRightDown(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n      pathRightUp(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n    };\n  }\n\n  override shapeFor(connection: RenderedConnection): Shape {\n    let checks = connection.getCheck();\n    if (!checks && connection.targetConnection) {\n      checks = connection.targetConnection.getCheck();\n    }\n    let outputShape;\n    switch (connection.type) {\n      case ConnectionType.INPUT_VALUE:\n      case ConnectionType.OUTPUT_VALUE:\n        outputShape = connection.getSourceBlock().getOutputShape();\n        // If the block has an output shape set, use that instead.\n        if (outputShape !== null) {\n          switch (outputShape) {\n            case this.SHAPES.HEXAGONAL:\n              return this.HEXAGONAL!;\n            case this.SHAPES.ROUND:\n              return this.ROUNDED!;\n            case this.SHAPES.SQUARE:\n              return this.SQUARED!;\n          }\n        }\n        // Includes doesn't work in IE.\n        if (checks && checks.indexOf('Boolean') !== -1) {\n          return this.HEXAGONAL!;\n        }\n        if (checks && checks.indexOf('Number') !== -1) {\n          return this.ROUNDED!;\n        }\n        if (checks && checks.indexOf('String') !== -1) {\n          return this.ROUNDED!;\n        }\n        return this.ROUNDED!;\n      case ConnectionType.PREVIOUS_STATEMENT:\n      case ConnectionType.NEXT_STATEMENT:\n        return this.NOTCH!;\n      default:\n        throw Error('Unknown type');\n    }\n  }\n\n  override makeNotch() {\n    const width = this.NOTCH_WIDTH;\n    const height = this.NOTCH_HEIGHT;\n\n    const innerWidth = width / 3;\n    const curveWidth = innerWidth / 3;\n\n    const halfHeight = height / 2;\n    const quarterHeight = halfHeight / 2;\n\n    /**\n     * Make the main path for the notch.\n     *\n     * @param dir Direction multiplier to apply to horizontal offsets along the\n     *     path. Either 1 or -1.\n     * @returns A path fragment describing a notch.\n     */\n    function makeMainPath(dir: number): string {\n      return svgPaths.curve(\n                 'c',\n                 [\n                   svgPaths.point(dir * curveWidth / 2, 0),\n                   svgPaths.point(dir * curveWidth * 3 / 4, quarterHeight / 2),\n                   svgPaths.point(dir * curveWidth, quarterHeight),\n                 ]) +\n          svgPaths.line([svgPaths.point(dir * curveWidth, halfHeight)]) +\n          svgPaths.curve(\n              'c',\n              [\n                svgPaths.point(dir * curveWidth / 4, quarterHeight / 2),\n                svgPaths.point(dir * curveWidth / 2, quarterHeight),\n                svgPaths.point(dir * curveWidth, quarterHeight),\n              ]) +\n          svgPaths.lineOnAxis('h', dir * innerWidth) +\n          svgPaths.curve(\n              'c',\n              [\n                svgPaths.point(dir * curveWidth / 2, 0),\n                svgPaths.point(dir * curveWidth * 3 / 4, -(quarterHeight / 2)),\n                svgPaths.point(dir * curveWidth, -quarterHeight),\n              ]) +\n          svgPaths.line([svgPaths.point(dir * curveWidth, -halfHeight)]) +\n          svgPaths.curve('c', [\n            svgPaths.point(dir * curveWidth / 4, -(quarterHeight / 2)),\n            svgPaths.point(dir * curveWidth / 2, -quarterHeight),\n            svgPaths.point(dir * curveWidth, -quarterHeight),\n          ]);\n    }\n\n    const pathLeft = makeMainPath(1);\n    const pathRight = makeMainPath(-1);\n\n    return {\n      type: this.SHAPES.NOTCH,\n      width,\n      height,\n      pathLeft,\n      pathRight,\n    };\n  }\n\n  override makeInsideCorners() {\n    const radius = this.CORNER_RADIUS;\n\n    const innerTopLeftCorner =\n        svgPaths.arc('a', '0 0,0', radius, svgPaths.point(-radius, radius));\n\n    const innerTopRightCorner =\n        svgPaths.arc('a', '0 0,1', radius, svgPaths.point(-radius, radius));\n\n    const innerBottomLeftCorner =\n        svgPaths.arc('a', '0 0,0', radius, svgPaths.point(radius, radius));\n\n    const innerBottomRightCorner =\n        svgPaths.arc('a', '0 0,1', radius, svgPaths.point(radius, radius));\n\n    return {\n      width: radius,\n      height: radius,\n      pathTop: innerTopLeftCorner,\n      pathBottom: innerBottomLeftCorner,\n      rightWidth: radius,\n      rightHeight: radius,\n      pathTopRight: innerTopRightCorner,\n      pathBottomRight: innerBottomRightCorner,\n    };\n  }\n\n  override generateSecondaryColour_(colour: string) {\n    return utilsColour.blend('#000', colour, 0.15) || colour;\n  }\n\n  override generateTertiaryColour_(colour: string) {\n    return utilsColour.blend('#000', colour, 0.25) || colour;\n  }\n\n  override createDom(svg: SVGElement, tagName: string, selector: string) {\n    super.createDom(svg, tagName, selector);\n    /*\n        <defs>\n          ... filters go here ...\n        </defs>\n        */\n    const defs = dom.createSvgElement(Svg.DEFS, {}, svg);\n    // Using a dilate distorts the block shape.\n    // Instead use a gaussian blur, and then set all alpha to 1 with a transfer.\n    const selectedGlowFilter = dom.createSvgElement(\n        Svg.FILTER, {\n          'id': 'blocklySelectedGlowFilter' + this.randomIdentifier,\n          'height': '160%',\n          'width': '180%',\n          'y': '-30%',\n          'x': '-40%',\n        },\n        defs);\n    dom.createSvgElement(\n        Svg.FEGAUSSIANBLUR,\n        {'in': 'SourceGraphic', 'stdDeviation': this.SELECTED_GLOW_SIZE},\n        selectedGlowFilter);\n    // Set all gaussian blur pixels to 1 opacity before applying flood\n    const selectedComponentTransfer = dom.createSvgElement(\n        Svg.FECOMPONENTTRANSFER, {'result': 'outBlur'}, selectedGlowFilter);\n    dom.createSvgElement(\n        Svg.FEFUNCA,\n        {'type': 'table', 'tableValues': '0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1'},\n        selectedComponentTransfer);\n    // Color the highlight\n    dom.createSvgElement(\n        Svg.FEFLOOD, {\n          'flood-color': this.SELECTED_GLOW_COLOUR,\n          'flood-opacity': 1,\n          'result': 'outColor',\n        },\n        selectedGlowFilter);\n    dom.createSvgElement(\n        Svg.FECOMPOSITE, {\n          'in': 'outColor',\n          'in2': 'outBlur',\n          'operator': 'in',\n          'result': 'outGlow',\n        },\n        selectedGlowFilter);\n    this.selectedGlowFilterId = selectedGlowFilter.id;\n    this.selectedGlowFilter_ = selectedGlowFilter;\n\n    // Using a dilate distorts the block shape.\n    // Instead use a gaussian blur, and then set all alpha to 1 with a transfer.\n    const replacementGlowFilter = dom.createSvgElement(\n        Svg.FILTER, {\n          'id': 'blocklyReplacementGlowFilter' + this.randomIdentifier,\n          'height': '160%',\n          'width': '180%',\n          'y': '-30%',\n          'x': '-40%',\n        },\n        defs);\n    dom.createSvgElement(\n        Svg.FEGAUSSIANBLUR,\n        {'in': 'SourceGraphic', 'stdDeviation': this.REPLACEMENT_GLOW_SIZE},\n        replacementGlowFilter);\n    // Set all gaussian blur pixels to 1 opacity before applying flood\n    const replacementComponentTransfer = dom.createSvgElement(\n        Svg.FECOMPONENTTRANSFER, {'result': 'outBlur'}, replacementGlowFilter);\n    dom.createSvgElement(\n        Svg.FEFUNCA,\n        {'type': 'table', 'tableValues': '0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1'},\n        replacementComponentTransfer);\n    // Color the highlight\n    dom.createSvgElement(\n        Svg.FEFLOOD, {\n          'flood-color': this.REPLACEMENT_GLOW_COLOUR,\n          'flood-opacity': 1,\n          'result': 'outColor',\n        },\n        replacementGlowFilter);\n    dom.createSvgElement(\n        Svg.FECOMPOSITE, {\n          'in': 'outColor',\n          'in2': 'outBlur',\n          'operator': 'in',\n          'result': 'outGlow',\n        },\n        replacementGlowFilter);\n    dom.createSvgElement(\n        Svg.FECOMPOSITE, {\n          'in': 'SourceGraphic',\n          'in2': 'outGlow',\n          'operator': 'over',\n        },\n        replacementGlowFilter);\n    this.replacementGlowFilterId = replacementGlowFilter.id;\n    this.replacementGlowFilter_ = replacementGlowFilter;\n  }\n\n  override getCSS_(selector: string) {\n    return [\n      /* eslint-disable indent */\n      // Text.\n      `${selector} .blocklyText,`,\n      `${selector} .blocklyFlyoutLabelText {`,\n      `font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}` +\n          `pt ${this.FIELD_TEXT_FONTFAMILY};`,\n      `}`,\n\n      // Fields.\n      `${selector} .blocklyText {`,\n      `fill: #fff;`,\n      `}`,\n      `${selector} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,\n      `${selector} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,\n      `fill: ${this.FIELD_BORDER_RECT_COLOUR};`,\n      `}`,\n      `${selector} .blocklyNonEditableText>text,`,\n      `${selector} .blocklyEditableText>text,`,\n      `${selector} .blocklyNonEditableText>g>text,`,\n      `${selector} .blocklyEditableText>g>text {`,\n      `fill: #575E75;`,\n      `}`,\n\n      // Flyout labels.\n      `${selector} .blocklyFlyoutLabelText {`,\n      `fill: #575E75;`,\n      `}`,\n\n      // Bubbles.\n      `${selector} .blocklyText.blocklyBubbleText {`,\n      `fill: #575E75;`,\n      `}`,\n\n      // Editable field hover.\n      `${selector} .blocklyDraggable:not(.blocklyDisabled)`,\n      ` .blocklyEditableText:not(.editing):hover>rect,`,\n      `${selector} .blocklyDraggable:not(.blocklyDisabled)`,\n      ` .blocklyEditableText:not(.editing):hover>.blocklyPath {`,\n      `stroke: #fff;`,\n      `stroke-width: 2;`,\n      `}`,\n\n      // Text field input.\n      `${selector} .blocklyHtmlInput {`,\n      `font-family: ${this.FIELD_TEXT_FONTFAMILY};`,\n      `font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,\n      `color: #575E75;`,\n      `}`,\n\n      // Dropdown field.\n      `${selector} .blocklyDropdownText {`,\n      `fill: #fff !important;`,\n      `}`,\n\n      // Widget and Dropdown Div\n      `${selector}.blocklyWidgetDiv .goog-menuitem,`,\n      `${selector}.blocklyDropDownDiv .goog-menuitem {`,\n      `font-family: ${this.FIELD_TEXT_FONTFAMILY};`,\n      `}`,\n      `${selector}.blocklyDropDownDiv .goog-menuitem-content {`,\n      `color: #fff;`,\n      `}`,\n\n      // Connection highlight.\n      `${selector} .blocklyHighlightedConnectionPath {`,\n      `stroke: ${this.SELECTED_GLOW_COLOUR};`,\n      `}`,\n\n      // Disabled outline paths.\n      `${selector} .blocklyDisabled > .blocklyOutlinePath {`,\n      `fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,\n      `}`,\n\n      // Insertion marker.\n      `${selector} .blocklyInsertionMarker>.blocklyPath {`,\n      `fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,\n      `stroke: none;`,\n      `}`,\n    ];\n  }\n}\n/* eslint-enable indent */\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Zelos renderer.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.Drawer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {BaseShape, DynamicShape, Notch} from '../common/constants.js';\nimport * as debug from '../common/debug.js';\nimport {Drawer as BaseDrawer} from '../common/drawer.js';\nimport type {InlineInput} from '../measurables/inline_input.js';\nimport type {Row} from '../measurables/row.js';\nimport type {SpacerRow} from '../measurables/spacer_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {InsideCorners} from './constants.js';\nimport type {RenderInfo} from './info.js';\nimport type {StatementInput} from './measurables/inputs.js';\nimport type {PathObject} from './path_object.js';\n\n\n/**\n * An object that draws a block based on the given rendering information.\n *\n * @alias Blockly.zelos.Drawer\n */\nexport class Drawer extends BaseDrawer {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override info_!: RenderInfo;\n\n  /**\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @internal\n   */\n  constructor(block: BlockSvg, info: RenderInfo) {\n    // AnyDuringMigration because:  Argument of type\n    // 'import(\"/google/src/cloud/adodson/blockly-ts/../../renderers/zelos/info\").RenderInfo'\n    // is not assignable to parameter of type\n    // 'import(\"/google/src/cloud/adodson/bloc...\n    super(block, info as AnyDuringMigration);\n  }\n\n  override draw() {\n    const pathObject = this.block_.pathObject as PathObject;\n    pathObject.beginDrawing();\n    this.hideHiddenIcons_();\n    this.drawOutline_();\n    this.drawInternals_();\n\n    pathObject.setPath(this.outlinePath_ + '\\n' + this.inlinePath_);\n    if (this.info_.RTL) {\n      pathObject.flipRTL();\n    }\n    if (debug.isDebuggerEnabled()) {\n      this.block_.renderingDebugger.drawDebug(this.block_, this.info_);\n    }\n    this.recordSizeOnBlock_();\n    if (this.info_.outputConnection) {\n      // Store the output connection shape type for parent blocks to use during\n      // rendering.\n      // AnyDuringMigration because:  Type 'number' is not assignable to type\n      // 'null'.\n      pathObject.outputShapeType =\n          this.info_.outputConnection.shape.type as AnyDuringMigration;\n    }\n    pathObject.endDrawing();\n  }\n\n  override drawOutline_() {\n    if (this.info_.outputConnection &&\n        this.info_.outputConnection.isDynamicShape &&\n        !this.info_.hasStatementInput &&\n        !this.info_.bottomRow.hasNextConnection) {\n      this.drawFlatTop_();\n      this.drawRightDynamicConnection_();\n      this.drawFlatBottom_();\n      this.drawLeftDynamicConnection_();\n    } else {\n      super.drawOutline_();\n    }\n  }\n\n  override drawLeft_() {\n    if (this.info_.outputConnection &&\n        this.info_.outputConnection.isDynamicShape) {\n      this.drawLeftDynamicConnection_();\n    } else {\n      super.drawLeft_();\n    }\n  }\n\n  /**\n   * Add steps for the right side of a row that does not have value or\n   * statement input connections.\n   *\n   * @param row The row to draw the side of.\n   */\n  protected override drawRightSideRow_(row: Row) {\n    if (row.height <= 0) {\n      return;\n    }\n    if (Types.isSpacer(row)) {\n      const spacerRow = row as SpacerRow;\n      if (spacerRow.precedesStatement || spacerRow.followsStatement) {\n        const cornerHeight =\n            (this.constants_.INSIDE_CORNERS as InsideCorners).rightHeight;\n        const remainingHeight =\n            spacerRow.height - (spacerRow.precedesStatement ? cornerHeight : 0);\n        this.outlinePath_ +=\n            (spacerRow.followsStatement ?\n                 (this.constants_.INSIDE_CORNERS as InsideCorners)\n                     .pathBottomRight :\n                 '') +\n            (remainingHeight > 0 ?\n                 svgPaths.lineOnAxis('V', spacerRow.yPos + remainingHeight) :\n                 '') +\n            (spacerRow.precedesStatement ?\n                 (this.constants_.INSIDE_CORNERS as InsideCorners)\n                     .pathTopRight :\n                 '');\n        return;\n      }\n    }\n    this.outlinePath_ += svgPaths.lineOnAxis('V', row.yPos + row.height);\n  }\n\n  /**\n   * Add steps to draw the right side of an output with a dynamic connection.\n   */\n  protected drawRightDynamicConnection_() {\n    this.outlinePath_ += (this.info_.outputConnection.shape as DynamicShape)\n                             .pathRightDown(this.info_.outputConnection.height);\n  }\n\n  /**\n   * Add steps to draw the left side of an output with a dynamic connection.\n   */\n  protected drawLeftDynamicConnection_() {\n    this.positionOutputConnection_();\n\n    this.outlinePath_ += (this.info_.outputConnection.shape as DynamicShape)\n                             .pathUp(this.info_.outputConnection.height);\n\n    // Close off the path.  This draws a vertical line up to the start of the\n    // block's path, which may be either a rounded or a sharp corner.\n    this.outlinePath_ += 'z';\n  }\n\n  /** Add steps to draw a flat top row. */\n  protected drawFlatTop_() {\n    const topRow = this.info_.topRow;\n    this.positionPreviousConnection_();\n\n    this.outlinePath_ += svgPaths.moveBy(topRow.xPos, this.info_.startY);\n\n    this.outlinePath_ += svgPaths.lineOnAxis('h', topRow.width);\n  }\n\n  /** Add steps to draw a flat bottom row. */\n  protected drawFlatBottom_() {\n    const bottomRow = this.info_.bottomRow;\n    this.positionNextConnection_();\n\n    this.outlinePath_ += svgPaths.lineOnAxis('V', bottomRow.baseline);\n\n    this.outlinePath_ += svgPaths.lineOnAxis('h', -bottomRow.width);\n  }\n\n  override drawInlineInput_(input: InlineInput) {\n    this.positionInlineInputConnection_(input);\n\n    const inputName = input.input.name;\n    if (input.connectedBlock || this.info_.isInsertionMarker) {\n      return;\n    }\n\n    const width = input.width - input.connectionWidth * 2;\n    const height = input.height;\n    const yPos = input.centerline - height / 2;\n\n    const connectionRight = input.xPos + input.connectionWidth;\n\n    const outlinePath = svgPaths.moveTo(connectionRight, yPos) +\n        svgPaths.lineOnAxis('h', width) +\n        (input.shape as DynamicShape).pathRightDown(input.height) +\n        svgPaths.lineOnAxis('h', -width) +\n        (input.shape as DynamicShape).pathUp(input.height) + 'z';\n    const pathObject = this.block_.pathObject as PathObject;\n    pathObject.setOutlinePath(inputName, outlinePath);\n  }\n\n  override drawStatementInput_(row: Row) {\n    const input = row.getLastInput() as StatementInput;\n    // Where to start drawing the notch, which is on the right side in LTR.\n    const x = input.xPos + input.notchOffset + (input.shape as BaseShape).width;\n\n    const innerTopLeftCorner = (input.shape as Notch).pathRight +\n        svgPaths.lineOnAxis(\n            'h', -(input.notchOffset - this.constants_.INSIDE_CORNERS.width)) +\n        this.constants_.INSIDE_CORNERS.pathTop;\n\n    const innerHeight = row.height - 2 * this.constants_.INSIDE_CORNERS.height;\n\n    const innerBottomLeftCorner = this.constants_.INSIDE_CORNERS.pathBottom +\n        svgPaths.lineOnAxis(\n            'h', input.notchOffset - this.constants_.INSIDE_CORNERS.width) +\n        (input.connectedBottomNextConnection ? '' :\n                                               (input.shape as Notch).pathLeft);\n\n    this.outlinePath_ += svgPaths.lineOnAxis('H', x) + innerTopLeftCorner +\n        svgPaths.lineOnAxis('v', innerHeight) + innerBottomLeftCorner +\n        svgPaths.lineOnAxis('H', row.xPos + row.width);\n\n    this.positionStatementInputConnection_(row);\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Image field.  Used for pictures, icons, etc.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldImage');\n\nimport {FieldConfig, Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport type {Sentinel} from './utils/sentinel.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\n\n\n/**\n * Class for an image on a block.\n *\n * @alias Blockly.FieldImage\n */\nexport class FieldImage extends Field {\n  /**\n   * Vertical padding below the image, which is included in the reported height\n   * of the field.\n   */\n  private static readonly Y_PADDING = 1;\n  protected override size_: Size;\n  private readonly imageHeight_: number;\n\n  /** The function to be called when this field is clicked. */\n  private clickHandler_: ((p1: FieldImage) => AnyDuringMigration)|null = null;\n\n  /** The rendered field's image element. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGImageElement'.\n  private imageElement_: SVGImageElement = null as AnyDuringMigration;\n\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. This field should not.\n   */\n  override readonly EDITABLE = false;\n\n  /**\n   * Used to tell if the field needs to be rendered the next time the block is\n   * rendered. Image fields are statically sized, and only need to be\n   * rendered at initialization.\n   */\n  protected override isDirty_ = false;\n\n  /** Whether to flip this image in RTL. */\n  private flipRtl_ = false;\n\n  /** Alt text of this image. */\n  private altText_ = '';\n  override value_: AnyDuringMigration;\n\n  /**\n   * @param src The URL of the image.\n   *     Also accepts Field.SKIP_SETUP if you wish to skip setup (only used by\n   * subclasses that want to handle configuration and setting the field value\n   * after their own constructors have run).\n   * @param width Width of the image.\n   * @param height Height of the image.\n   * @param opt_alt Optional alt text for when block is collapsed.\n   * @param opt_onClick Optional function to be called when the image is\n   *     clicked. If opt_onClick is defined, opt_alt must also be defined.\n   * @param opt_flipRtl Whether to flip the icon in RTL.\n   * @param opt_config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/image#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n      src: string|Sentinel, width: string|number, height: string|number,\n      opt_alt?: string, opt_onClick?: (p1: FieldImage) => AnyDuringMigration,\n      opt_flipRtl?: boolean, opt_config?: FieldImageConfig) {\n    super(Field.SKIP_SETUP);\n\n    const imageHeight = Number(parsing.replaceMessageReferences(height));\n    const imageWidth = Number(parsing.replaceMessageReferences(width));\n    if (isNaN(imageHeight) || isNaN(imageWidth)) {\n      throw Error(\n          'Height and width values of an image field must cast to' +\n          ' numbers.');\n    }\n    if (imageHeight <= 0 || imageWidth <= 0) {\n      throw Error(\n          'Height and width values of an image field must be greater' +\n          ' than 0.');\n    }\n\n    /** The size of the area rendered by the field. */\n    this.size_ = new Size(imageWidth, imageHeight + FieldImage.Y_PADDING);\n\n    /**\n     * Store the image height, since it is different from the field height.\n     */\n    this.imageHeight_ = imageHeight;\n\n    if (typeof opt_onClick === 'function') {\n      this.clickHandler_ = opt_onClick;\n    }\n\n    if (src === Field.SKIP_SETUP) {\n      return;\n    }\n\n    if (opt_config) {\n      this.configure_(opt_config);\n    } else {\n      this.flipRtl_ = !!opt_flipRtl;\n      this.altText_ = parsing.replaceMessageReferences(opt_alt) || '';\n    }\n    this.setValue(parsing.replaceMessageReferences(src));\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldImageConfig) {\n    super.configure_(config);\n    if (config.flipRtl) this.flipRtl_ = config.flipRtl;\n    if (config.alt) {\n      this.altText_ = parsing.replaceMessageReferences(config.alt);\n    }\n  }\n\n  /**\n   * Create the block UI for this image.\n   *\n   * @internal\n   */\n  override initView() {\n    this.imageElement_ = dom.createSvgElement(\n        Svg.IMAGE, {\n          'height': this.imageHeight_ + 'px',\n          'width': this.size_.width + 'px',\n          'alt': this.altText_,\n        },\n        this.fieldGroup_);\n    this.imageElement_.setAttributeNS(\n        dom.XLINK_NS, 'xlink:href', this.value_ as string);\n\n    if (this.clickHandler_) {\n      this.imageElement_.style.cursor = 'pointer';\n    }\n  }\n\n  override updateSize_() {}\n  // NOP\n\n  /**\n   * Ensure that the input value (the source URL) is a string.\n   *\n   * @param opt_newValue The input value.\n   * @returns A string, or null if invalid.\n   */\n  protected override doClassValidation_(opt_newValue?: AnyDuringMigration):\n      string|null {\n    if (typeof opt_newValue !== 'string') {\n      return null;\n    }\n    return opt_newValue;\n  }\n\n  /**\n   * Update the value of this image field, and update the displayed image.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a string.\n   */\n  protected override doValueUpdate_(newValue: AnyDuringMigration) {\n    this.value_ = newValue;\n    if (this.imageElement_) {\n      this.imageElement_.setAttributeNS(\n          dom.XLINK_NS, 'xlink:href', String(this.value_));\n    }\n  }\n\n  /**\n   * Get whether to flip this image in RTL\n   *\n   * @returns True if we should flip in RTL.\n   */\n  override getFlipRtl(): boolean {\n    return this.flipRtl_;\n  }\n\n  /**\n   * Set the alt text of this image.\n   *\n   * @param alt New alt text.\n   */\n  setAlt(alt: string|null) {\n    if (alt === this.altText_) {\n      return;\n    }\n    this.altText_ = alt || '';\n    if (this.imageElement_) {\n      this.imageElement_.setAttribute('alt', this.altText_);\n    }\n  }\n\n  /**\n   * If field click is called, and click handler defined,\n   * call the handler.\n   */\n  protected override showEditor_() {\n    if (this.clickHandler_) {\n      this.clickHandler_(this);\n    }\n  }\n\n  /**\n   * Set the function that is called when this image  is clicked.\n   *\n   * @param func The function that is called when the image is clicked, or null\n   *     to remove.\n   */\n  setOnClickHandler(func: ((p1: FieldImage) => AnyDuringMigration)|null) {\n    this.clickHandler_ = func;\n  }\n\n  /**\n   * Use the `getText_` developer hook to override the field's text\n   * representation.\n   * Return the image alt text instead.\n   *\n   * @returns The image alt text.\n   */\n  protected override getText_(): string|null {\n    return this.altText_;\n  }\n\n  /**\n   * Construct a FieldImage from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (src, width, height, alt, and\n   *     flipRtl).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldImageFromJsonConfig): FieldImage {\n    if (!options.src || !options.width || !options.height) {\n      throw new Error(\n          'src, width, and height values for an image field are' +\n          'required. The width and height must be non-zero.');\n    }\n    // `this` might be a subclass of FieldImage if that class doesn't override\n    // the static fromJson method.\n    return new this(\n        options.src, options.width, options.height, undefined, undefined,\n        undefined, options);\n  }\n}\n\nfieldRegistry.register('field_image', FieldImage);\n\n(FieldImage.prototype as AnyDuringMigration).DEFAULT_VALUE = '';\n\n/**\n * Config options for the image field.\n */\nexport interface FieldImageConfig extends FieldConfig {\n  flipRtl?: boolean;\n  alt?: string;\n}\n\n/**\n * fromJson config options for the colour field.\n */\nexport interface FieldImageFromJsonConfig extends FieldImageConfig {\n  src?: string;\n  width?: number;\n  height?: number;\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Text input field.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldTextInput');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as dialog from './dialog.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport {FieldConfig, Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {Msg} from './msg.js';\nimport * as aria from './utils/aria.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {KeyCodes} from './utils/keycodes.js';\nimport * as parsing from './utils/parsing.js';\nimport type {Sentinel} from './utils/sentinel.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Class for an editable text field.\n *\n * @alias Blockly.FieldTextInput\n */\nexport class FieldTextInput extends Field {\n  /**\n   * Pixel size of input border radius.\n   * Should match blocklyText's border-radius in CSS.\n   */\n  static BORDERRADIUS = 4;\n\n  /** Allow browser to spellcheck this field. */\n  protected spellcheck_ = true;\n\n  /** The HTML input element. */\n  protected htmlInput_: HTMLInputElement|null = null;\n\n  /** True if the field's value is currently being edited via the UI. */\n  protected isBeingEdited_ = false;\n\n  /**\n   * True if the value currently displayed in the field's editory UI is valid.\n   */\n  protected isTextValid_ = false;\n\n  /** Key down event data. */\n  private onKeyDownWrapper_: browserEvents.Data|null = null;\n\n  /** Key input event data. */\n  private onKeyInputWrapper_: browserEvents.Data|null = null;\n\n  /**\n   * Whether the field should consider the whole parent block to be its click\n   * target.\n   */\n  fullBlockClickTarget_: boolean|null = false;\n\n  /** The workspace that this field belongs to. */\n  protected workspace_: WorkspaceSvg|null = null;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /** Mouse cursor style when over the hotspot that initiates the editor. */\n  override CURSOR = 'text';\n  override clickTarget_: AnyDuringMigration;\n  override value_: AnyDuringMigration;\n  override isDirty_: AnyDuringMigration;\n\n  /**\n   * @param opt_value The initial value of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param opt_validator A function that is called to validate changes to the\n   *     field's value. Takes in a string & returns a validated string, or null\n   *     to abort the change.\n   * @param opt_config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/text-input#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n      opt_value?: string|Sentinel, opt_validator?: Function|null,\n      opt_config?: FieldTextInputConfig) {\n    super(Field.SKIP_SETUP);\n\n    if (opt_value === Field.SKIP_SETUP) {\n      return;\n    }\n    if (opt_config) {\n      this.configure_(opt_config);\n    }\n    this.setValue(opt_value);\n    if (opt_validator) {\n      this.setValidator(opt_validator);\n    }\n  }\n\n  protected override configure_(config: FieldTextInputConfig) {\n    super.configure_(config);\n    if (config.spellcheck !== undefined) {\n      this.spellcheck_ = config.spellcheck;\n    }\n  }\n\n  /** @internal */\n  override initView() {\n    if (this.getConstants()!.FULL_BLOCK_FIELDS) {\n      // Step one: figure out if this is the only field on this block.\n      // Rendering is quite different in that case.\n      let nFields = 0;\n      let nConnections = 0;\n      // Count the number of fields, excluding text fields\n      for (let i = 0, input; input = this.sourceBlock_.inputList[i]; i++) {\n        for (let j = 0; input.fieldRow[j]; j++) {\n          nFields++;\n        }\n        if (input.connection) {\n          nConnections++;\n        }\n      }\n      // The special case is when this is the only non-label field on the block\n      // and it has an output but no inputs.\n      this.fullBlockClickTarget_ =\n          nFields <= 1 && this.sourceBlock_.outputConnection && !nConnections;\n    } else {\n      this.fullBlockClickTarget_ = false;\n    }\n\n    if (this.fullBlockClickTarget_) {\n      this.clickTarget_ = (this.sourceBlock_ as BlockSvg).getSvgRoot();\n    } else {\n      this.createBorderRect_();\n    }\n    this.createTextElement_();\n  }\n\n  /**\n   * Ensure that the input value casts to a valid string.\n   *\n   * @param opt_newValue The input value.\n   * @returns A valid string, or null if invalid.\n   */\n  protected override doClassValidation_(opt_newValue?: AnyDuringMigration):\n      AnyDuringMigration {\n    if (opt_newValue === null || opt_newValue === undefined) {\n      return null;\n    }\n    return String(opt_newValue);\n  }\n\n  /**\n   * Called by setValue if the text input is not valid. If the field is\n   * currently being edited it reverts value of the field to the previous\n   * value while allowing the display text to be handled by the htmlInput_.\n   *\n   * @param _invalidValue The input value that was determined to be invalid.\n   *    This is not used by the text input because its display value is stored\n   * on the htmlInput_.\n   */\n  protected override doValueInvalid_(_invalidValue: AnyDuringMigration) {\n    if (this.isBeingEdited_) {\n      this.isTextValid_ = false;\n      const oldValue = this.value_;\n      // Revert value when the text becomes invalid.\n      this.value_ = this.htmlInput_!.getAttribute('data-untyped-default-value');\n      if (this.sourceBlock_ && eventUtils.isEnabled()) {\n        eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n            this.sourceBlock_, 'field', this.name || null, oldValue,\n            this.value_));\n      }\n    }\n  }\n\n  /**\n   * Called by setValue if the text input is valid. Updates the value of the\n   * field, and updates the text of the field if it is not currently being\n   * edited (i.e. handled by the htmlInput_).\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a string.\n   */\n  protected override doValueUpdate_(newValue: AnyDuringMigration) {\n    this.isTextValid_ = true;\n    this.value_ = newValue;\n    if (!this.isBeingEdited_) {\n      // This should only occur if setValue is triggered programmatically.\n      this.isDirty_ = true;\n    }\n  }\n\n  /**\n   * Updates text field to match the colour/style of the block.\n   *\n   * @internal\n   */\n  override applyColour() {\n    if (this.sourceBlock_ && this.getConstants()!.FULL_BLOCK_FIELDS) {\n      if (this.borderRect_) {\n        this.borderRect_.setAttribute(\n            'stroke', (this.sourceBlock_ as BlockSvg).style.colourTertiary);\n      } else {\n        (this.sourceBlock_ as BlockSvg)\n            .pathObject.svgPath.setAttribute(\n                'fill', this.getConstants()!.FIELD_BORDER_RECT_COLOUR);\n      }\n    }\n  }\n\n  /**\n   * Updates the colour of the htmlInput given the current validity of the\n   * field's value.\n   */\n  protected override render_() {\n    super.render_();\n    // This logic is done in render_ rather than doValueInvalid_ or\n    // doValueUpdate_ so that the code is more centralized.\n    if (this.isBeingEdited_) {\n      this.resizeEditor_();\n      const htmlInput = this.htmlInput_ as HTMLElement;\n      if (!this.isTextValid_) {\n        dom.addClass(htmlInput, 'blocklyInvalidInput');\n        aria.setState(htmlInput, aria.State.INVALID, true);\n      } else {\n        dom.removeClass(htmlInput, 'blocklyInvalidInput');\n        aria.setState(htmlInput, aria.State.INVALID, false);\n      }\n    }\n  }\n\n  /**\n   * Set whether this field is spellchecked by the browser.\n   *\n   * @param check True if checked.\n   */\n  setSpellcheck(check: boolean) {\n    if (check === this.spellcheck_) {\n      return;\n    }\n    this.spellcheck_ = check;\n    if (this.htmlInput_) {\n      // AnyDuringMigration because:  Argument of type 'boolean' is not\n      // assignable to parameter of type 'string'.\n      this.htmlInput_.setAttribute(\n          'spellcheck', this.spellcheck_ as AnyDuringMigration);\n    }\n  }\n\n  /**\n   * Show the inline free-text editor on top of the text.\n   *\n   * @param _opt_e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   * @param opt_quietInput True if editor should be created without focus.\n   *     Defaults to false.\n   */\n  protected override showEditor_(_opt_e?: Event, opt_quietInput?: boolean) {\n    this.workspace_ = (this.sourceBlock_ as BlockSvg).workspace;\n    const quietInput = opt_quietInput || false;\n    if (!quietInput &&\n        (userAgent.MOBILE || userAgent.ANDROID || userAgent.IPAD)) {\n      this.showPromptEditor_();\n    } else {\n      this.showInlineEditor_(quietInput);\n    }\n  }\n\n  /**\n   * Create and show a text input editor that is a prompt (usually a popup).\n   * Mobile browsers have issues with in-line textareas (focus and keyboards).\n   */\n  private showPromptEditor_() {\n    dialog.prompt(\n        Msg['CHANGE_VALUE_TITLE'], this.getText(), (text: string|null) => {\n          // Text is null if user pressed cancel button.\n          if (text !== null) {\n            this.setValue(this.getValueFromEditorText_(text));\n          }\n        });\n  }\n\n  /**\n   * Create and show a text input editor that sits directly over the text input.\n   *\n   * @param quietInput True if editor should be created without focus.\n   */\n  private showInlineEditor_(quietInput: boolean) {\n    WidgetDiv.show(this, this.sourceBlock_.RTL, this.widgetDispose_.bind(this));\n    this.htmlInput_ = this.widgetCreate_() as HTMLInputElement;\n    this.isBeingEdited_ = true;\n\n    if (!quietInput) {\n      (this.htmlInput_ as HTMLElement).focus({\n        preventScroll: true,\n      });\n      this.htmlInput_.select();\n    }\n  }\n\n  /**\n   * Create the text input editor widget.\n   *\n   * @returns The newly created text input editor.\n   */\n  protected widgetCreate_(): HTMLElement {\n    eventUtils.setGroup(true);\n    const div = WidgetDiv.getDiv();\n\n    dom.addClass(this.getClickTarget_(), 'editing');\n\n    const htmlInput = (document.createElement('input'));\n    htmlInput.className = 'blocklyHtmlInput';\n    // AnyDuringMigration because:  Argument of type 'boolean' is not assignable\n    // to parameter of type 'string'.\n    htmlInput.setAttribute(\n        'spellcheck', this.spellcheck_ as AnyDuringMigration);\n    const scale = this.workspace_!.getScale();\n    const fontSize = this.getConstants()!.FIELD_TEXT_FONTSIZE * scale + 'pt';\n    div!.style.fontSize = fontSize;\n    htmlInput.style.fontSize = fontSize;\n    let borderRadius = FieldTextInput.BORDERRADIUS * scale + 'px';\n\n    if (this.fullBlockClickTarget_) {\n      const bBox = this.getScaledBBox();\n\n      // Override border radius.\n      borderRadius = (bBox.bottom - bBox.top) / 2 + 'px';\n      // Pull stroke colour from the existing shadow block\n      const strokeColour = this.sourceBlock_.getParent() ?\n          (this.sourceBlock_.getParent() as BlockSvg).style.colourTertiary :\n          (this.sourceBlock_ as BlockSvg).style.colourTertiary;\n      htmlInput.style.border = 1 * scale + 'px solid ' + strokeColour;\n      div!.style.borderRadius = borderRadius;\n      div!.style.transition = 'box-shadow 0.25s ease 0s';\n      if (this.getConstants()!.FIELD_TEXTINPUT_BOX_SHADOW) {\n        div!.style.boxShadow =\n            'rgba(255, 255, 255, 0.3) 0 0 0 ' + 4 * scale + 'px';\n      }\n    }\n    htmlInput.style.borderRadius = borderRadius;\n\n    div!.appendChild(htmlInput);\n\n    htmlInput.value = htmlInput.defaultValue = this.getEditorText_(this.value_);\n    htmlInput.setAttribute('data-untyped-default-value', this.value_);\n    htmlInput.setAttribute('data-old-value', '');\n\n    this.resizeEditor_();\n\n    this.bindInputEvents_(htmlInput);\n\n    return htmlInput;\n  }\n\n  /**\n   * Closes the editor, saves the results, and disposes of any events or\n   * DOM-references belonging to the editor.\n   */\n  protected widgetDispose_() {\n    // Non-disposal related things that we do when the editor closes.\n    this.isBeingEdited_ = false;\n    this.isTextValid_ = true;\n    // Make sure the field's node matches the field's internal value.\n    this.forceRerender();\n    this.onFinishEditing_(this.value_);\n    eventUtils.setGroup(false);\n\n    // Actual disposal.\n    this.unbindInputEvents_();\n    const style = WidgetDiv.getDiv()!.style;\n    style.width = 'auto';\n    style.height = 'auto';\n    style.fontSize = '';\n    style.transition = '';\n    style.boxShadow = '';\n    this.htmlInput_ = null;\n\n    dom.removeClass(this.getClickTarget_(), 'editing');\n  }\n\n  /**\n   * A callback triggered when the user is done editing the field via the UI.\n   *\n   * @param _value The new value of the field.\n   */\n  onFinishEditing_(_value: AnyDuringMigration) {}\n  // NOP by default.\n  // TODO(#2496): Support people passing a func into the field.\n\n  /**\n   * Bind handlers for user input on the text input field's editor.\n   *\n   * @param htmlInput The htmlInput to which event handlers will be bound.\n   */\n  protected bindInputEvents_(htmlInput: HTMLElement) {\n    // Trap Enter without IME and Esc to hide.\n    this.onKeyDownWrapper_ = browserEvents.conditionalBind(\n        htmlInput, 'keydown', this, this.onHtmlInputKeyDown_);\n    // Resize after every input change.\n    this.onKeyInputWrapper_ = browserEvents.conditionalBind(\n        htmlInput, 'input', this, this.onHtmlInputChange_);\n  }\n\n  /** Unbind handlers for user input and workspace size changes. */\n  protected unbindInputEvents_() {\n    if (this.onKeyDownWrapper_) {\n      browserEvents.unbind(this.onKeyDownWrapper_);\n      this.onKeyDownWrapper_ = null;\n    }\n    if (this.onKeyInputWrapper_) {\n      browserEvents.unbind(this.onKeyInputWrapper_);\n      this.onKeyInputWrapper_ = null;\n    }\n  }\n\n  /**\n   * Handle key down to the editor.\n   *\n   * @param e Keyboard event.\n   */\n  protected onHtmlInputKeyDown_(e: Event) {\n    // AnyDuringMigration because:  Property 'keyCode' does not exist on type\n    // 'Event'.\n    if ((e as AnyDuringMigration).keyCode === KeyCodes.ENTER) {\n      WidgetDiv.hide();\n      dropDownDiv.hideWithoutAnimation();\n      // AnyDuringMigration because:  Property 'keyCode' does not exist on type\n      // 'Event'.\n    } else if ((e as AnyDuringMigration).keyCode === KeyCodes.ESC) {\n      this.setValue(\n          this.htmlInput_!.getAttribute('data-untyped-default-value'));\n      WidgetDiv.hide();\n      dropDownDiv.hideWithoutAnimation();\n      // AnyDuringMigration because:  Property 'keyCode' does not exist on type\n      // 'Event'.\n    } else if ((e as AnyDuringMigration).keyCode === KeyCodes.TAB) {\n      WidgetDiv.hide();\n      dropDownDiv.hideWithoutAnimation();\n      // AnyDuringMigration because:  Property 'shiftKey' does not exist on type\n      // 'Event'. AnyDuringMigration because:  Argument of type 'this' is not\n      // assignable to parameter of type 'Field'.\n      (this.sourceBlock_ as BlockSvg)\n          .tab(this as AnyDuringMigration, !(e as AnyDuringMigration).shiftKey);\n      e.preventDefault();\n    }\n  }\n\n  /**\n   * Handle a change to the editor.\n   *\n   * @param _e Keyboard event.\n   */\n  private onHtmlInputChange_(_e: Event) {\n    const text = this.htmlInput_!.value;\n    if (text !== this.htmlInput_!.getAttribute('data-old-value')) {\n      this.htmlInput_!.setAttribute('data-old-value', text);\n\n      const value = this.getValueFromEditorText_(text);\n      this.setValue(value);\n      this.forceRerender();\n      this.resizeEditor_();\n    }\n  }\n\n  /**\n   * Set the HTML input value and the field's internal value. The difference\n   * between this and `setValue` is that this also updates the HTML input\n   * value whilst editing.\n   *\n   * @param newValue New value.\n   */\n  protected setEditorValue_(newValue: AnyDuringMigration) {\n    this.isDirty_ = true;\n    if (this.isBeingEdited_) {\n      // In the case this method is passed an invalid value, we still\n      // pass it through the transformation method `getEditorText` to deal\n      // with. Otherwise, the internal field's state will be inconsistent\n      // with what's shown to the user.\n      this.htmlInput_!.value = this.getEditorText_(newValue);\n    }\n    this.setValue(newValue);\n  }\n\n  /** Resize the editor to fit the text. */\n  protected resizeEditor_() {\n    const div = WidgetDiv.getDiv();\n    const bBox = this.getScaledBBox();\n    div!.style.width = bBox.right - bBox.left + 'px';\n    div!.style.height = bBox.bottom - bBox.top + 'px';\n\n    // In RTL mode block fields and LTR input fields the left edge moves,\n    // whereas the right edge is fixed.  Reposition the editor.\n    const x = this.sourceBlock_.RTL ? bBox.right - div!.offsetWidth : bBox.left;\n    const xy = new Coordinate(x, bBox.top);\n\n    div!.style.left = xy.x + 'px';\n    div!.style.top = xy.y + 'px';\n  }\n\n  /**\n   * Returns whether or not the field is tab navigable.\n   *\n   * @returns True if the field is tab navigable.\n   */\n  override isTabNavigable(): boolean {\n    return true;\n  }\n\n  /**\n   * Use the `getText_` developer hook to override the field's text\n   * representation. When we're currently editing, return the current HTML value\n   * instead. Otherwise, return null which tells the field to use the default\n   * behaviour (which is a string cast of the field's value).\n   *\n   * @returns The HTML value if we're editing, otherwise null.\n   */\n  protected override getText_(): string|null {\n    if (this.isBeingEdited_ && this.htmlInput_) {\n      // We are currently editing, return the HTML input value instead.\n      return this.htmlInput_.value;\n    }\n    return null;\n  }\n\n  /**\n   * Transform the provided value into a text to show in the HTML input.\n   * Override this method if the field's HTML input representation is different\n   * than the field's value. This should be coupled with an override of\n   * `getValueFromEditorText_`.\n   *\n   * @param value The value stored in this field.\n   * @returns The text to show on the HTML input.\n   */\n  protected getEditorText_(value: AnyDuringMigration): string {\n    return String(value);\n  }\n\n  /**\n   * Transform the text received from the HTML input into a value to store\n   * in this field.\n   * Override this method if the field's HTML input representation is different\n   * than the field's value. This should be coupled with an override of\n   * `getEditorText_`.\n   *\n   * @param text Text received from the HTML input.\n   * @returns The value to store.\n   */\n  protected getValueFromEditorText_(text: string): AnyDuringMigration {\n    return text;\n  }\n\n  /**\n   * Construct a FieldTextInput from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (text, and spellcheck).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldTextInputFromJsonConfig): FieldTextInput {\n    const text = parsing.replaceMessageReferences(options.text);\n    // `this` might be a subclass of FieldTextInput if that class doesn't\n    // override the static fromJson method.\n    return new this(text, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_input', FieldTextInput);\n\n(FieldTextInput.prototype as AnyDuringMigration).DEFAULT_VALUE = '';\n\n/**\n * Config options for the text input field.\n */\nexport interface FieldTextInputConfig extends FieldConfig {\n  spellcheck?: boolean;\n}\n\n/**\n * fromJson config options for the text input field.\n */\nexport interface FieldTextInputFromJsonConfig extends FieldTextInputConfig {\n  text?: string;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object representing the bottom row of a rendered block.\n *\n * @class\n */\nimport * as goog from '../../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.BottomRow');\n\nimport type {BlockSvg} from '../../../block_svg.js';\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {BottomRow as BaseBottomRow} from '../../../renderers/measurables/bottom_row.js';\n\n\n/**\n * An object containing information about what elements are in the bottom row of\n * a block as well as spacing information for the top row.\n * Elements in a bottom row can consist of corners, spacers and next\n * connections.\n *\n * @alias Blockly.zelos.BottomRow\n */\nexport class BottomRow extends BaseBottomRow {\n  /**\n   * @param constants The rendering constants provider.\n   * @internal\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasLeftSquareCorner(block: BlockSvg) {\n    return !!block.outputConnection;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasRightSquareCorner(block: BlockSvg) {\n    return !!block.outputConnection && !block.statementInputCount &&\n        !block.nextConnection;\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Zelos specific objects representing inputs with connections on\n * a rendered block.\n *\n * @class\n */\nimport * as goog from '../../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.StatementInput');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../../input.js';\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {StatementInput as BaseStatementInput} from '../../../renderers/measurables/statement_input.js';\n\n\n/**\n * An object containing information about the space a statement input takes up\n * during rendering.\n *\n * @alias Blockly.zelos.StatementInput\n */\nexport class StatementInput extends BaseStatementInput {\n  connectedBottomNextConnection = false;\n  override height: AnyDuringMigration;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The statement input to measure and store information for.\n   * @internal\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n\n    if (this.connectedBlock) {\n      // Find the bottom-most connected block in the stack.\n      let block = this.connectedBlock;\n      let nextBlock;\n      while (nextBlock = block.getNextBlock()) {\n        block = nextBlock;\n      }\n      if (!block.nextConnection) {\n        this.height = this.connectedBlockHeight;\n        this.connectedBottomNextConnection = true;\n      }\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Zelos specific objects representing elements in a row of a\n * rendered block.\n *\n * @class\n */\nimport * as goog from '../../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.RightConnectionShape');\n\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {Measurable} from '../../../renderers/measurables/base.js';\nimport {Types} from '../../../renderers/measurables/types.js';\n\n\n/**\n * An object containing information about the space a right connection shape\n * takes up during rendering.\n *\n * @alias Blockly.zelos.RightConnectionShape\n */\nexport class RightConnectionShape extends Measurable {\n  // Size is dynamic\n  override height = 0;\n  override width = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @internal\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    // AnyDuringMigration because:  Property 'getType' does not exist on type\n    // 'typeof Types'.\n    this.type |= (Types as AnyDuringMigration).getType('RIGHT_CONNECTION');\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object representing the top row of a rendered block.\n *\n * @class\n */\nimport * as goog from '../../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.TopRow');\n\nimport type {BlockSvg} from '../../../block_svg.js';\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {TopRow as BaseTopRow} from '../../../renderers/measurables/top_row.js';\n\n\n/**\n * An object containing information about what elements are in the top row of a\n * block as well as sizing information for the top row.\n * Elements in a top row can consist of corners, hats, spacers, and previous\n * connections.\n * After this constructor is called, the row will contain all non-spacer\n * elements it needs.\n *\n * @alias Blockly.zelos.TopRow\n */\nexport class TopRow extends BaseTopRow {\n  /**\n   * @param constants The rendering constants provider.\n   * @internal\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasLeftSquareCorner(block: BlockSvg) {\n    const hasHat =\n        (block.hat ? block.hat === 'cap' : this.constants_.ADD_START_HATS) &&\n        !block.outputConnection && !block.previousConnection;\n    return !!block.outputConnection || hasHat;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasRightSquareCorner(block: BlockSvg) {\n    return !!block.outputConnection && !block.statementInputCount &&\n        !block.nextConnection;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Makecode/scratch-style renderer.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.RenderInfo');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {FieldImage} from '../../field_image.js';\nimport {FieldLabel} from '../../field_label.js';\nimport {FieldTextInput} from '../../field_textinput.js';\nimport {Align, Input} from '../../input.js';\nimport {inputTypes} from '../../input_types.js';\nimport {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport type {Measurable} from '../measurables/base.js';\nimport {Field} from '../measurables/field.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport {InputConnection} from '../measurables/input_connection.js';\nimport type {Row} from '../measurables/row.js';\nimport type {SpacerRow} from '../measurables/spacer_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {ConstantProvider, InsideCorners} from './constants.js';\nimport {BottomRow} from './measurables/bottom_row.js';\nimport {StatementInput} from './measurables/inputs.js';\nimport {RightConnectionShape} from './measurables/row_elements.js';\nimport {TopRow} from './measurables/top_row.js';\nimport type {PathObject} from './path_object.js';\nimport type {Renderer} from './renderer.js';\n\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n *\n * @alias Blockly.zelos.RenderInfo\n */\nexport class RenderInfo extends BaseRenderInfo {\n  override topRow: TopRow;\n  override bottomRow: BottomRow;\n  override constants_: ConstantProvider;\n  override renderer_: Renderer;\n\n  override isInline = true;\n  isMultiRow: boolean;\n  hasStatementInput: boolean;\n  rightSide: RightConnectionShape|null;\n  private readonly rightAlignedDummyInputs_: WeakMap<Row, Input>;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   * @internal\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    super(renderer, block);\n\n    this.renderer_ = renderer;\n\n    this.constants_ = this.renderer_.getConstants();\n\n    /**\n     * An object with rendering information about the top row of the block.\n     */\n    this.topRow = new TopRow(this.constants_);\n\n    /**\n     * An object with rendering information about the bottom row of the block.\n     */\n    this.bottomRow = new BottomRow(this.constants_);\n\n    /**\n     * Whether the block should be rendered as a multi-line block, either\n     * because it's not inline or because it has been collapsed.\n     */\n    this.isMultiRow = !block.getInputsInline() || block.isCollapsed();\n\n    /**\n     * Whether or not the block has a statement input in one of its rows.\n     */\n    this.hasStatementInput = block.statementInputCount > 0;\n\n    /**\n     * An object with rendering information about the right connection shape.\n     */\n    this.rightSide = this.outputConnection ?\n        new RightConnectionShape(this.constants_) :\n        null;\n\n    /**\n     * A map of rows to right aligned dummy inputs within those rows. Used to\n     * add padding between left and right aligned inputs.\n     */\n    this.rightAlignedDummyInputs_ = new WeakMap();\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   * @internal\n   */\n  override getRenderer(): Renderer {\n    return this.renderer_ as Renderer;\n  }\n\n  override measure() {\n    // Modifying parent measure method to add `adjustXPosition_`.\n    this.createRows_();\n    this.addElemSpacing_();\n    this.addRowSpacing_();\n    this.adjustXPosition_();\n    this.computeBounds_();\n    this.alignRowElements_();\n    this.finalize_();\n  }\n\n  override shouldStartNewRow_(input: Input, lastInput: Input): boolean {\n    // If this is the first input, just add to the existing row.\n    // That row is either empty or has some icons in it.\n    if (!lastInput) {\n      return false;\n    }\n    // A statement input or an input following one always gets a new row.\n    if (input.type === inputTypes.STATEMENT ||\n        lastInput.type === inputTypes.STATEMENT) {\n      return true;\n    }\n    // Value and dummy inputs get new row if inputs are not inlined.\n    if (input.type === inputTypes.VALUE || input.type === inputTypes.DUMMY) {\n      return !this.isInline || this.isMultiRow;\n    }\n    return false;\n  }\n\n  override getDesiredRowWidth_(row: Row): number {\n    if (row.hasStatement) {\n      const rightCornerWidth =\n          (this.constants_.INSIDE_CORNERS as InsideCorners).rightWidth || 0;\n      return this.width - this.startX - rightCornerWidth;\n    }\n    return super.getDesiredRowWidth_(row);\n  }\n\n  override getInRowSpacing_(prev: Measurable|null, next: Measurable|null):\n      number {\n    if (!prev || !next) {\n      // No need for padding at the beginning or end of the row if the\n      // output shape is dynamic.\n      if (this.outputConnection && this.outputConnection.isDynamicShape &&\n          !this.hasStatementInput && !this.bottomRow.hasNextConnection) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n    if (!prev) {\n      // Statement input padding.\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n    }\n    // Spacing between a rounded corner and a previous or next connection.\n    if (prev && Types.isLeftRoundedCorner(prev) && next) {\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset - this.constants_.CORNER_RADIUS;\n      }\n    }\n    // Spacing between a square corner and a hat.\n    // AnyDuringMigration because:  Property 'isHat' does not exist on type\n    // 'typeof Types'.\n    if (prev && Types.isLeftSquareCorner(prev) && next &&\n        (Types as AnyDuringMigration).isHat(next)) {\n      return this.constants_.NO_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowHeight_(prev: Row, next: Row): number {\n    // If we have an empty block add a spacer to increase the height.\n    if (Types.isTopRow(prev) && Types.isBottomRow(next)) {\n      return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;\n    }\n    const followsStatement = Types.isInputRow(prev) && prev.hasStatement;\n    const precedesStatement = Types.isInputRow(next) && next.hasStatement;\n    if (precedesStatement || followsStatement) {\n      const cornerHeight =\n          (this.constants_.INSIDE_CORNERS as InsideCorners).rightHeight || 0;\n      const height = Math.max(this.constants_.NOTCH_HEIGHT, cornerHeight);\n      return precedesStatement && followsStatement ?\n          Math.max(height, this.constants_.DUMMY_INPUT_MIN_HEIGHT) :\n          height;\n    }\n    // Top and bottom rows act as a spacer so we don't need any extra padding.\n    if (Types.isTopRow(prev)) {\n      const topRow = prev as TopRow;\n      if (!topRow.hasPreviousConnection &&\n          (!this.outputConnection || this.hasStatementInput)) {\n        return Math.abs(\n            this.constants_.NOTCH_HEIGHT - this.constants_.CORNER_RADIUS);\n      }\n      return this.constants_.NO_PADDING;\n    }\n    if (Types.isBottomRow(next)) {\n      const bottomRow = next as BottomRow;\n      if (!this.outputConnection) {\n        const topHeight = Math.max(\n                              this.topRow.minHeight,\n                              Math.max(\n                                  this.constants_.NOTCH_HEIGHT,\n                                  this.constants_.CORNER_RADIUS)) -\n            this.constants_.CORNER_RADIUS;\n        return topHeight;\n      } else if (!bottomRow.hasNextConnection && this.hasStatementInput) {\n        return Math.abs(\n            this.constants_.NOTCH_HEIGHT - this.constants_.CORNER_RADIUS);\n      }\n      return this.constants_.NO_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowWidth_(prev: Row, next: Row): number {\n    const width = this.width - this.startX;\n    if (Types.isInputRow(prev) && prev.hasStatement ||\n        Types.isInputRow(next) && next.hasStatement) {\n      return Math.max(width, this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH);\n    }\n    return width;\n  }\n\n  override getElemCenterline_(row: Row, elem: Measurable): number {\n    if (row.hasStatement && !Types.isSpacer(elem) &&\n        !Types.isStatementInput(elem)) {\n      return row.yPos + this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT / 2;\n    }\n    if (Types.isInlineInput(elem) && elem instanceof InputConnection) {\n      const connectedBlock = elem.connectedBlock;\n      if (connectedBlock && connectedBlock.outputConnection &&\n          connectedBlock.nextConnection) {\n        return row.yPos + connectedBlock.height / 2;\n      }\n    }\n    return super.getElemCenterline_(row, elem);\n  }\n\n  override addInput_(input: Input, activeRow: Row) {\n    // If we have two dummy inputs on the same row, one aligned left and the\n    // other right, keep track of the right aligned dummy input so we can add\n    // padding later.\n    if (input.type === inputTypes.DUMMY && activeRow.hasDummyInput &&\n        activeRow.align === Align.LEFT && input.align === Align.RIGHT) {\n      this.rightAlignedDummyInputs_.set(activeRow, input);\n    } else if (input.type === inputTypes.STATEMENT) {\n      // Handle statements without next connections correctly.\n      activeRow.elements.push(new StatementInput(this.constants_, input));\n      activeRow.hasStatement = true;\n\n      if (activeRow.align === null) {\n        activeRow.align = input.align;\n      }\n      return;\n    }\n    super.addInput_(input, activeRow);\n  }\n\n  override addAlignmentPadding_(row: Row, missingSpace: number) {\n    if (this.rightAlignedDummyInputs_.get(row)) {\n      let alignmentDivider;\n      for (let i = 0; i < row.elements.length; i++) {\n        const elem = row.elements[i];\n        if (Types.isSpacer(elem)) {\n          alignmentDivider = elem;\n        }\n        if (Types.isField(elem) && elem instanceof Field &&\n            elem.parentInput === this.rightAlignedDummyInputs_.get(row)) {\n          break;\n        }\n      }\n      if (alignmentDivider) {\n        alignmentDivider.width += missingSpace;\n        row.width += missingSpace;\n        return;\n      }\n    }\n    super.addAlignmentPadding_(row, missingSpace);\n  }\n\n  /**\n   * Adjust the x position of fields to bump all non-label fields in the first\n   * row past the notch position.  This must be called before `computeBounds`\n   * is called.\n   */\n  protected adjustXPosition_() {\n    const notchTotalWidth =\n        this.constants_.NOTCH_OFFSET_LEFT + this.constants_.NOTCH_WIDTH;\n    let minXPos = notchTotalWidth;\n    // Run through every input row on the block and only apply bump logic to the\n    // first input row (if the block has prev connection) and every input row\n    // that has a prev and next notch.\n    for (let i = 2; i < this.rows.length - 1; i += 2) {\n      const prevSpacer = this.rows[i - 1] as SpacerRow;\n      const row = this.rows[i];\n      const nextSpacer = this.rows[i + 1] as SpacerRow;\n\n      const hasPrevNotch = i === 2 ? !!this.topRow.hasPreviousConnection :\n                                     !!prevSpacer.followsStatement;\n      const hasNextNotch = i + 2 >= this.rows.length - 1 ?\n          !!this.bottomRow.hasNextConnection :\n          !!nextSpacer.precedesStatement;\n\n      if (Types.isInputRow(row) && row.hasStatement) {\n        row.measure();\n        minXPos = row.width - row.getLastInput().width + notchTotalWidth;\n      } else if (\n          hasPrevNotch && (i === 2 || hasNextNotch) && Types.isInputRow(row) &&\n          !row.hasStatement) {\n        let xCursor = row.xPos;\n        let prevInRowSpacer = null;\n        for (let j = 0; j < row.elements.length; j++) {\n          const elem = row.elements[j];\n          if (Types.isSpacer(elem)) {\n            prevInRowSpacer = elem;\n          }\n          if (prevInRowSpacer && (Types.isField(elem) || Types.isInput(elem))) {\n            if (xCursor < minXPos &&\n                !(Types.isField(elem) && elem instanceof Field &&\n                  (elem.field instanceof FieldLabel ||\n                   elem.field instanceof FieldImage))) {\n              const difference = minXPos - xCursor;\n              prevInRowSpacer.width += difference;\n            }\n          }\n          xCursor += elem.width;\n        }\n      }\n    }\n  }\n\n  /**\n   * Finalize the output connection info.  In particular, set the height of the\n   * output connection to match that of the block.  For the right side, add a\n   * right connection shape element and have it match the dimensions of the\n   * output connection.\n   */\n  protected finalizeOutputConnection_() {\n    // Dynamic output connections depend on the height of the block.\n    if (!this.outputConnection || !this.outputConnection.isDynamicShape) {\n      return;\n    }\n    const outputConnectionShape = this.outputConnection.shape;\n    if (!('isDynamic' in outputConnectionShape &&\n          outputConnectionShape.isDynamic)) {\n      return;\n    }\n\n    let yCursor = 0;\n    // Determine the block height.\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      row.yPos = yCursor;\n      yCursor += row.height;\n    }\n    this.height = yCursor;\n\n    // Adjust the height of the output connection.\n    const blockHeight = this.bottomRow.hasNextConnection ?\n        this.height - this.bottomRow.descenderHeight :\n        this.height;\n    const connectionHeight = outputConnectionShape.height(blockHeight);\n    const connectionWidth = outputConnectionShape.width(blockHeight);\n\n    this.outputConnection.height = connectionHeight;\n    this.outputConnection.width = connectionWidth;\n    this.outputConnection.startX = connectionWidth;\n    this.outputConnection.connectionOffsetY =\n        outputConnectionShape.connectionOffsetY(connectionHeight);\n    this.outputConnection.connectionOffsetX =\n        outputConnectionShape.connectionOffsetX(connectionWidth);\n\n    // Add the right connection measurable.\n    // Don't add it if we have a value-to-statement or a value-to-stack block.\n    let rightConnectionWidth = 0;\n    if (!this.hasStatementInput && !this.bottomRow.hasNextConnection) {\n      rightConnectionWidth = connectionWidth;\n      this.rightSide!.height = connectionHeight;\n      this.rightSide!.width = rightConnectionWidth;\n      this.rightSide!.centerline = connectionHeight / 2;\n      this.rightSide!.xPos = this.width + rightConnectionWidth;\n    }\n    this.startX = connectionWidth;\n    this.width += connectionWidth + rightConnectionWidth;\n    this.widthWithChildren += connectionWidth + rightConnectionWidth;\n  }\n\n  /**\n   * Finalize horizontal alignment of elements on the block.  In particular,\n   * reduce the implicit spacing created by the left and right output connection\n   * shapes by adding setting negative spacing onto the leftmost and rightmost\n   * spacers.\n   */\n  protected finalizeHorizontalAlignment_() {\n    if (!this.outputConnection || this.hasStatementInput ||\n        this.bottomRow.hasNextConnection) {\n      return;\n    }\n    let totalNegativeSpacing = 0;\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      if (!Types.isInputRow(row)) {\n        continue;\n      }\n      const firstElem = row.elements[1];\n      const lastElem = row.elements[row.elements.length - 2];\n      let leftNegPadding = this.getNegativeSpacing_(firstElem);\n      let rightNegPadding = this.getNegativeSpacing_(lastElem);\n      totalNegativeSpacing = leftNegPadding + rightNegPadding;\n      const minBlockWidth =\n          this.constants_.MIN_BLOCK_WIDTH + this.outputConnection.width * 2;\n      if (this.width - totalNegativeSpacing < minBlockWidth) {\n        // Maintain a minimum block width, split negative spacing between left\n        // and right edge.\n        totalNegativeSpacing = this.width - minBlockWidth;\n        leftNegPadding = totalNegativeSpacing / 2;\n        rightNegPadding = totalNegativeSpacing / 2;\n      }\n      // Add a negative spacer on the start and end of the block.\n      row.elements.unshift(new InRowSpacer(this.constants_, -leftNegPadding));\n      row.elements.push(new InRowSpacer(this.constants_, -rightNegPadding));\n    }\n    if (totalNegativeSpacing) {\n      this.width -= totalNegativeSpacing;\n      this.widthWithChildren -= totalNegativeSpacing;\n      this.rightSide!.xPos -= totalNegativeSpacing;\n      for (let i = 0; i < this.rows.length; i++) {\n        const row = this.rows[i];\n        // AnyDuringMigration because:  Property 'isTopOrBottomRow' does not\n        // exist on type 'typeof Types'.\n        if ((Types as AnyDuringMigration).isTopOrBottomRow(row)) {\n          row.elements[1].width -= totalNegativeSpacing;\n        }\n        row.width -= totalNegativeSpacing;\n        row.widthWithConnectedBlocks -= totalNegativeSpacing;\n      }\n    }\n  }\n\n  /**\n   * Calculate the spacing to reduce the left and right edges by based on the\n   * outer and inner connection shape.\n   *\n   * @param elem The first or last element on a block.\n   * @returns The amount of spacing to reduce the first or last spacer.\n   */\n  protected getNegativeSpacing_(elem: Measurable): number {\n    if (!elem) {\n      return 0;\n    }\n    const connectionWidth = this.outputConnection.width;\n    const outerShape = this.outputConnection.shape.type;\n    const constants = (this.constants_);\n    if (this.isMultiRow && this.inputRows.length > 1) {\n      switch (outerShape) {\n        case constants.SHAPES.ROUND: {\n          // Special case for multi-row round reporter blocks.\n          const maxWidth = this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;\n          const width = this.height / 2 > maxWidth ? maxWidth : this.height / 2;\n          const topPadding = this.constants_.SMALL_PADDING;\n          const roundPadding =\n              width * (1 - Math.sin(Math.acos((width - topPadding) / width)));\n          return connectionWidth - roundPadding;\n        }\n        default:\n          return 0;\n      }\n    }\n    if (Types.isInlineInput(elem) && elem instanceof InputConnection) {\n      const connectedBlock = elem.connectedBlock;\n      const innerShape = connectedBlock ?\n          (connectedBlock.pathObject as PathObject).outputShapeType :\n          elem.shape.type;\n      if (innerShape == null) {\n        return 0;\n      }\n      // Special case for value to stack / value to statement blocks.\n      if (connectedBlock && connectedBlock.outputConnection &&\n          (connectedBlock.statementInputCount ||\n           connectedBlock.nextConnection)) {\n        return 0;\n      }\n      // Special case for hexagonal output.\n      if (outerShape === constants.SHAPES.HEXAGONAL &&\n          outerShape !== innerShape) {\n        return 0;\n      }\n      return connectionWidth -\n          this.constants_.SHAPE_IN_SHAPE_PADDING[outerShape][innerShape];\n    } else if (Types.isField(elem) && elem instanceof Field) {\n      // Special case for text inputs.\n      if (outerShape === constants.SHAPES.ROUND &&\n          elem.field instanceof FieldTextInput) {\n        return connectionWidth - 2.75 * constants.GRID_UNIT;\n      }\n      return connectionWidth -\n          this.constants_.SHAPE_IN_SHAPE_PADDING[outerShape][0];\n    } else if (Types.isIcon(elem)) {\n      return this.constants_.SMALL_PADDING;\n    }\n    return 0;\n  }\n\n  /**\n   * Finalize vertical alignment of rows on a block.  In particular, reduce the\n   * implicit spacing when a non-shadow block is connected to any of an input\n   * row's inline inputs.\n   */\n  protected finalizeVerticalAlignment_() {\n    if (this.outputConnection) {\n      return;\n    }\n    // Run through every input row on the block and only apply tight nesting\n    // logic to input rows that have a prev and next notch.\n    for (let i = 2; i < this.rows.length - 1; i += 2) {\n      const prevSpacer = this.rows[i - 1] as SpacerRow;\n      const row = this.rows[i];\n      const nextSpacer = this.rows[i + 1] as SpacerRow;\n\n      const firstRow = i === 2;\n      const hasPrevNotch = firstRow ? !!this.topRow.hasPreviousConnection :\n                                      !!prevSpacer.followsStatement;\n      const hasNextNotch = i + 2 >= this.rows.length - 1 ?\n          !!this.bottomRow.hasNextConnection :\n          !!nextSpacer.precedesStatement;\n\n      if (hasPrevNotch) {\n        const elem = row.elements[1];\n        const hasSingleTextOrImageField = row.elements.length === 3 &&\n            elem instanceof Field &&\n            (elem.field instanceof FieldLabel ||\n             elem.field instanceof FieldImage);\n        if (!firstRow && hasSingleTextOrImageField) {\n          // Remove some padding if we have a single image or text field.\n          prevSpacer.height -= this.constants_.SMALL_PADDING;\n          nextSpacer.height -= this.constants_.SMALL_PADDING;\n          row.height -= this.constants_.MEDIUM_PADDING;\n        } else if (!firstRow && !hasNextNotch) {\n          // Add a small padding so the notch doesn't clash with inputs/fields.\n          prevSpacer.height += this.constants_.SMALL_PADDING;\n        } else if (hasNextNotch) {\n          // Determine if the input row has non-shadow connected blocks.\n          let hasNonShadowConnectedBlocks = false;\n          const minVerticalTightNestingHeight = 40;\n          for (let j = 0; j < row.elements.length; j++) {\n            const elem = row.elements[j];\n            if (elem instanceof InputConnection && Types.isInlineInput(elem) &&\n                elem.connectedBlock && !elem.connectedBlock.isShadow() &&\n                elem.connectedBlock.getHeightWidth().height >=\n                    minVerticalTightNestingHeight) {\n              hasNonShadowConnectedBlocks = true;\n              break;\n            }\n          }\n          // Apply tight-nesting if we have both a prev and next notch and the\n          // block has non-shadow connected blocks.\n          if (hasNonShadowConnectedBlocks) {\n            prevSpacer.height -= this.constants_.SMALL_PADDING;\n            nextSpacer.height -= this.constants_.SMALL_PADDING;\n          }\n        }\n      }\n    }\n  }\n\n  override finalize_() {\n    this.finalizeOutputConnection_();\n    this.finalizeHorizontalAlignment_();\n    this.finalizeVerticalAlignment_();\n    super.finalize_();\n\n    if (this.rightSide) {\n      this.widthWithChildren += this.rightSide.width;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for graphically rendering a marker as SVG.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.MarkerSvg');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {ASTNode} from '../../keyboard_nav/ast_node.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\nimport type {ConstantProvider as BaseConstantProvider} from '../common/constants.js';\nimport {MarkerSvg as BaseMarkerSvg} from '../common/marker_svg.js';\n\nimport type {ConstantProvider as ZelosConstantProvider} from './constants.js';\n\n\n/**\n * Class to draw a marker.\n *\n * @alias Blockly.zelos.MarkerSvg\n */\nexport class MarkerSvg extends BaseMarkerSvg {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  constants_!: ZelosConstantProvider;\n\n  private markerCircle_: SVGCircleElement|null = null;\n\n  /**\n   * @param workspace The workspace the marker belongs to.\n   * @param constants The constants for the renderer.\n   * @param marker The marker to draw.\n   */\n  constructor(\n      workspace: WorkspaceSvg, constants: BaseConstantProvider,\n      marker: Marker) {\n    super(workspace, constants, marker);\n  }\n\n  /**\n   * Position and display the marker for an input or an output connection.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  private showWithInputOutput_(curNode: ASTNode) {\n    const block = curNode.getSourceBlock() as BlockSvg;\n    const connection = curNode.getLocation() as RenderedConnection;\n    const offsetInBlock = connection.getOffsetInBlock();\n\n    this.positionCircle_(offsetInBlock.x, offsetInBlock.y);\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  override showWithOutput_(curNode: ASTNode) {\n    this.showWithInputOutput_(curNode);\n  }\n\n  override showWithInput_(curNode: ASTNode) {\n    this.showWithInputOutput_(curNode);\n  }\n\n  /**\n   * Draw a rectangle around the block.\n   *\n   * @param curNode The current node of the marker.\n   */\n  override showWithBlock_(curNode: ASTNode) {\n    const block = curNode.getLocation() as BlockSvg;\n\n    // Gets the height and width of entire stack.\n    const heightWidth = block.getHeightWidth();\n    // Add padding so that being on a stack looks different than being on a\n    // block.\n    this.positionRect_(0, 0, heightWidth.width, heightWidth.height);\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position the circle we use for input and output connections.\n   *\n   * @param x The x position of the circle.\n   * @param y The y position of the circle.\n   */\n  private positionCircle_(x: number, y: number) {\n    this.markerCircle_?.setAttribute('cx', x.toString());\n    this.markerCircle_?.setAttribute('cy', y.toString());\n    this.currentMarkerSvg = this.markerCircle_;\n  }\n\n  override hide() {\n    super.hide();\n    if (this.markerCircle_) {\n      this.markerCircle_.style.display = 'none';\n    }\n  }\n\n  override createDomInternal_() {\n    /* clang-format off */\n    /* This markup will be generated and added to the .svgGroup_:\n        <g>\n          <rect width=\"100\" height=\"5\">\n            <animate attributeType=\"XML\" attributeName=\"fill\" dur=\"1s\"\n              values=\"transparent;transparent;#fff;transparent\" repeatCount=\"indefinite\" />\n          </rect>\n        </g>\n        */\n    /* clang-format on */\n    super.createDomInternal_();\n\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'Element | undefined'.\n    this.markerCircle_ = dom.createSvgElement(\n        Svg.CIRCLE, {\n          'r': this.constants_.CURSOR_RADIUS,\n          'style': 'display: none',\n          'stroke-width': this.constants_.CURSOR_STROKE_WIDTH,\n        },\n        this.markerSvg_!);\n\n    // Markers and stack cursors don't blink.\n    if (this.isCursor()) {\n      const blinkProperties = this.getBlinkProperties_();\n      dom.createSvgElement(Svg.ANIMATE, blinkProperties, this.markerCircle_!);\n    }\n\n    return this.markerSvg_!;\n  }\n\n  override applyColour_(curNode: ASTNode) {\n    super.applyColour_(curNode);\n\n    this.markerCircle_?.setAttribute('fill', this.colour_);\n    this.markerCircle_?.setAttribute('stroke', this.colour_);\n\n    if (this.isCursor()) {\n      const values = this.colour_ + ';transparent;transparent;';\n      this.markerCircle_?.firstElementChild!.setAttribute('values', values);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object that owns a block's rendering SVG elements.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.PathObject');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Connection} from '../../connection.js';\nimport type {BlockStyle} from '../../theme.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport {PathObject as BasePathObject} from '../common/path_object.js';\n\nimport type {ConstantProvider} from './constants.js';\n\n\n/**\n * An object that handles creating and setting each of the SVG elements\n * used by the renderer.\n *\n * @alias Blockly.zelos.PathObject\n */\nexport class PathObject extends BasePathObject {\n  /** The selected path of the block. */\n  private svgPathSelected_: SVGElement|null = null;\n\n  /** The outline paths on the block. */\n  private readonly outlines = new Map<string, SVGElement>();\n\n  /**\n   * A set used to determine which outlines were used during a draw pass.  The\n   * set is initialized with a reference to all the outlines in\n   * `this.outlines`. Every time we use an outline during the draw pass, the\n   * reference is removed from this set.\n   */\n  private remainingOutlines = new Set<string>();\n\n  /**\n   * The type of block's output connection shape.  This is set when a block\n   * with an output connection is drawn.\n   */\n  outputShapeType = null;\n\n  /** @internal */\n  public override constants: ConstantProvider;\n\n  /**\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @param constants The renderer's constants.\n   * @internal\n   */\n  constructor(\n      root: SVGElement, style: BlockStyle, constants: ConstantProvider) {\n    super(root, style, constants);\n\n    this.constants = constants;\n  }\n\n  override setPath(pathString: string) {\n    super.setPath(pathString);\n    if (this.svgPathSelected_) {\n      this.svgPathSelected_.setAttribute('d', pathString);\n    }\n  }\n\n  override applyColour(block: BlockSvg) {\n    super.applyColour(block);\n    // Set shadow stroke colour.\n    const parent = block.getParent();\n    if (block.isShadow() && parent) {\n      this.svgPath.setAttribute('stroke', parent.style.colourTertiary);\n    }\n\n    // Apply colour to outlines.\n    for (const outline of this.outlines.values()) {\n      outline.setAttribute('fill', this.style.colourTertiary);\n    }\n  }\n\n  override flipRTL() {\n    super.flipRTL();\n    // Mirror each input outline path.\n    for (const outline of this.outlines.values()) {\n      outline.setAttribute('transform', 'scale(-1 1)');\n    }\n  }\n\n  override updateSelected(enable: boolean) {\n    this.setClass_('blocklySelected', enable);\n    if (enable) {\n      if (!this.svgPathSelected_) {\n        this.svgPathSelected_ = this.svgPath.cloneNode(true) as SVGElement;\n        this.svgPathSelected_.setAttribute('fill', 'none');\n        this.svgPathSelected_.setAttribute(\n            'filter', 'url(#' + this.constants.selectedGlowFilterId + ')');\n        this.svgRoot.appendChild(this.svgPathSelected_);\n      }\n    } else {\n      if (this.svgPathSelected_) {\n        this.svgRoot.removeChild(this.svgPathSelected_);\n        this.svgPathSelected_ = null;\n      }\n    }\n  }\n\n  override updateReplacementFade(enable: boolean) {\n    this.setClass_('blocklyReplaceable', enable);\n    if (enable) {\n      this.svgPath.setAttribute(\n          'filter', 'url(#' + this.constants.replacementGlowFilterId + ')');\n    } else {\n      this.svgPath.removeAttribute('filter');\n    }\n  }\n\n  override updateShapeForInputHighlight(conn: Connection, enable: boolean) {\n    const name = conn.getParentInput()!.name;\n    const outlinePath = this.getOutlinePath_(name);\n    if (!outlinePath) {\n      return;\n    }\n    if (enable) {\n      outlinePath.setAttribute(\n          'filter', 'url(#' + this.constants.replacementGlowFilterId + ')');\n    } else {\n      outlinePath.removeAttribute('filter');\n    }\n  }\n\n  /**\n   * Method that's called when the drawer is about to draw the block.\n   *\n   * @internal\n   */\n  beginDrawing() {\n    this.remainingOutlines.clear();\n    for (const key of this.outlines.keys()) {\n      this.remainingOutlines.add(key);\n    }\n  }\n\n  /**\n   * Method that's called when the drawer is done drawing.\n   *\n   * @internal\n   */\n  endDrawing() {\n    // Go through all remaining outlines that were not used this draw pass, and\n    // remove them.\n    if (this.remainingOutlines.size) {\n      for (const key of this.remainingOutlines) {\n        this.removeOutlinePath_(key);\n      }\n    }\n    this.remainingOutlines.clear();\n  }\n\n  /**\n   * Set the path generated by the renderer for an outline path on the\n   * respective outline path SVG element.\n   *\n   * @param name The input name.\n   * @param pathString The path.\n   * @internal\n   */\n  setOutlinePath(name: string, pathString: string) {\n    const outline = this.getOutlinePath_(name);\n    outline.setAttribute('d', pathString);\n    outline.setAttribute('fill', this.style.colourTertiary);\n  }\n\n  /**\n   * Create's an outline path for the specified input.\n   *\n   * @param name The input name.\n   * @returns The SVG outline path.\n   */\n  private getOutlinePath_(name: string): SVGElement {\n    if (!this.outlines.has(name)) {\n      this.outlines.set(\n          name,\n          dom.createSvgElement(\n              Svg.PATH, {\n                'class':\n                    'blocklyOutlinePath',  // IE doesn't like paths without the\n                // data definition, set empty\n                // default\n                'd': '',\n              },\n              this.svgRoot));\n    }\n    this.remainingOutlines.delete(name);\n    return this.outlines.get(name)!;\n  }\n\n  /**\n   * Remove an outline path that is associated with the specified input.\n   *\n   * @param name The input name.\n   */\n  private removeOutlinePath_(name: string) {\n    this.outlines.get(name)?.parentNode?.removeChild(this.outlines.get(name)!);\n    this.outlines.delete(name);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Zelos renderer.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.Renderer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Connection} from '../../connection.js';\nimport {ConnectionType} from '../../connection_type.js';\nimport {InsertionMarkerManager} from '../../insertion_marker_manager.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {BlockStyle} from '../../theme.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\nimport * as blockRendering from '../common/block_rendering.js';\nimport type {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport {Renderer as BaseRenderer} from '../common/renderer.js';\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {PathObject} from './path_object.js';\n\n\n/**\n * The zelos renderer.\n *\n * @alias Blockly.zelos.Renderer\n */\nexport class Renderer extends BaseRenderer {\n  protected override constants_!: ConstantProvider;\n\n  /**\n   * @param name The renderer name.\n   * @internal\n   */\n  constructor(name: string) {\n    super(name);\n  }\n\n  /**\n   * Create a new instance of the renderer's constant provider.\n   *\n   * @returns The constant provider.\n   */\n  protected override makeConstants_(): ConstantProvider {\n    return new ConstantProvider();\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected override makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n\n  /**\n   * Create a new instance of the renderer's drawer.\n   *\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @returns The drawer.\n   */\n  protected override makeDrawer_(block: BlockSvg, info: BaseRenderInfo):\n      Drawer {\n    return new Drawer(block, (info as RenderInfo));\n  }\n\n  /**\n   * Create a new instance of the renderer's cursor drawer.\n   *\n   * @param workspace The workspace the cursor belongs to.\n   * @param marker The marker.\n   * @returns The object in charge of drawing the marker.\n   * @internal\n   */\n  override makeMarkerDrawer(workspace: WorkspaceSvg, marker: Marker):\n      MarkerSvg {\n    return new MarkerSvg(workspace, this.getConstants(), marker);\n  }\n\n  /**\n   * Create a new instance of a renderer path object.\n   *\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @returns The renderer path object.\n   * @internal\n   */\n  override makePathObject(root: SVGElement, style: BlockStyle): PathObject {\n    return new PathObject(\n        root, style, (this.getConstants() as ConstantProvider));\n  }\n\n  /**\n   * Get the current renderer's constant provider.  We assume that when this is\n   * called, the renderer has already been initialized.\n   *\n   * @returns The constant provider.\n   */\n  override getConstants(): ConstantProvider {\n    return this.constants_;\n  }\n\n  override shouldHighlightConnection(conn: Connection) {\n    return conn.type !== ConnectionType.INPUT_VALUE &&\n        conn.type !== ConnectionType.OUTPUT_VALUE;\n  }\n\n  override getConnectionPreviewMethod(\n      closest: RenderedConnection, local: RenderedConnection,\n      topBlock: BlockSvg) {\n    if (local.type === ConnectionType.OUTPUT_VALUE) {\n      if (!closest.isConnected()) {\n        return InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE;\n      }\n      // TODO: Returning this is a total hack, because we don't want to show\n      //   a replacement fade, we want to show an outline affect.\n      //   Sadly zelos does not support showing an outline around filled\n      //   inputs, so we have to pretend like the connected block is getting\n      //   replaced.\n      return InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE;\n    }\n\n    return super.getConnectionPreviewMethod(closest, local, topBlock);\n  }\n}\n\nblockRendering.register('zelos', Renderer);\n","/** @file Re-exports of Blockly.zelos.* modules. */\n\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Re-exports of Blockly.zelos.* modules.\n *\n * @namespace Blockly.zelos\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos');\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {BottomRow} from './measurables/bottom_row.js';\nimport {StatementInput} from './measurables/inputs.js';\nimport {RightConnectionShape} from './measurables/row_elements.js';\nimport {TopRow} from './measurables/top_row.js';\nimport {PathObject} from './path_object.js';\nimport {Renderer} from './renderer.js';\n\n\nexport {\n  BottomRow,\n  ConstantProvider,\n  Drawer,\n  MarkerSvg,\n  PathObject,\n  Renderer,\n  RenderInfo,\n  RightConnectionShape,\n  StatementInput,\n  TopRow,\n};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * New (evolving) renderer.\n * Thrasos: spirit of boldness.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.thrasos.RenderInfo');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport type {Measurable} from '../measurables/base.js';\nimport type {BottomRow} from '../measurables/bottom_row.js';\nimport type {Field} from '../measurables/field.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport type {Row} from '../measurables/row.js';\nimport type {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {Renderer} from './renderer.js';\n\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n *\n * @alias Blockly.thrasos.RenderInfo\n */\nexport class RenderInfo extends BaseRenderInfo {\n  override widthWithChildren: AnyDuringMigration;\n  override height: AnyDuringMigration;\n  override startY: AnyDuringMigration;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   * @internal\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    super(renderer, block);\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   * @internal\n   */\n  override getRenderer(): Renderer {\n    // AnyDuringMigration because:  Property 'renderer_' does not exist on type\n    // 'RenderInfo'.\n    return (this as AnyDuringMigration).renderer_ as Renderer;\n  }\n\n  override addElemSpacing_() {\n    let hasExternalInputs = false;\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      if (row.hasExternalInput) {\n        hasExternalInputs = true;\n        break;\n      }\n    }\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      const oldElems = row.elements;\n      row.elements = [];\n      // No spacing needed before the corner on the top row or the bottom row.\n      if (row.startsWithElemSpacer()) {\n        // There's a spacer before the first element in the row.\n        row.elements.push(new InRowSpacer(\n            this.constants_, this.getInRowSpacing_(null, oldElems[0])));\n      }\n      if (!oldElems.length) {\n        continue;\n      }\n      for (let e = 0; e < oldElems.length - 1; e++) {\n        row.elements.push(oldElems[e]);\n        const spacing = this.getInRowSpacing_(oldElems[e], oldElems[e + 1]);\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n      row.elements.push(oldElems[oldElems.length - 1]);\n      if (row.endsWithElemSpacer()) {\n        let spacing =\n            this.getInRowSpacing_(oldElems[oldElems.length - 1], null);\n        if (hasExternalInputs && row.hasDummyInput) {\n          spacing += this.constants_.TAB_WIDTH;\n        }\n        // There's a spacer after the last element in the row.\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n    }\n  }\n\n  override getInRowSpacing_(prev: Measurable|null, next: Measurable|null) {\n    if (!prev) {\n      // Between an editable field and the beginning of the row.\n      if (next && Types.isField(next) && (next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Inline input at the beginning of the row.\n      if (next && Types.isInlineInput(next)) {\n        return this.constants_.MEDIUM_LARGE_PADDING;\n      }\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n      // Anything else at the beginning of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between a non-input and the end of the row.\n    if (!Types.isInput(prev) && !next) {\n      // Between an editable field and the end of the row.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Padding at the end of an icon-only row to make the block shape clearer.\n      if (Types.isIcon(prev)) {\n        return this.constants_.LARGE_PADDING * 2 + 1;\n      }\n      // AnyDuringMigration because:  Property 'isHat' does not exist on type\n      // 'typeof Types'.\n      if ((Types as AnyDuringMigration).isHat(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Establish a minimum width for a block with a previous or next\n      // connection.\n      // AnyDuringMigration because:  Property 'isPreviousOrNextConnection' does\n      // not exist on type 'typeof Types'.\n      if ((Types as AnyDuringMigration).isPreviousOrNextConnection(prev)) {\n        return this.constants_.LARGE_PADDING;\n      }\n      // Between rounded corner and the end of the row.\n      if (Types.isLeftRoundedCorner(prev)) {\n        return this.constants_.MIN_BLOCK_WIDTH;\n      }\n      // Between a jagged edge and the end of the row.\n      if (Types.isJaggedEdge(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Between noneditable fields and icons and the end of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n    // Between inputs and the end of the row.\n    if (Types.isInput(prev) && !next) {\n      // AnyDuringMigration because:  Property 'isExternalInput' does not exist\n      // on type 'typeof Types'.\n      if ((Types as AnyDuringMigration).isExternalInput(prev)) {\n        return this.constants_.NO_PADDING;\n      } else if (Types.isInlineInput(prev)) {\n        return this.constants_.LARGE_PADDING;\n      } else if (Types.isStatementInput(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n\n    // Spacing between a non-input and an input.\n    if (!Types.isInput(prev) && next && Types.isInput(next)) {\n      // Between an editable field and an input.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.SMALL_PADDING;\n          // AnyDuringMigration because:  Property 'isExternalInput' does not\n          // exist on type 'typeof Types'.\n        } else if ((Types as AnyDuringMigration).isExternalInput(next)) {\n          return this.constants_.SMALL_PADDING;\n        }\n      } else {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n          // AnyDuringMigration because:  Property 'isExternalInput' does not\n          // exist on type 'typeof Types'.\n        } else if ((Types as AnyDuringMigration).isExternalInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n        } else if (Types.isStatementInput(next)) {\n          return this.constants_.LARGE_PADDING;\n        }\n      }\n      return this.constants_.LARGE_PADDING - 1;\n    }\n\n    // Spacing between an icon and an icon or field.\n    if (Types.isIcon(prev) && next && !Types.isInput(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between an inline input and a field.\n    if (Types.isInlineInput(prev) && next && Types.isField(next)) {\n      // Editable field after inline input.\n      if ((next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      } else {\n        // Noneditable field after inline input.\n        return this.constants_.LARGE_PADDING;\n      }\n    }\n\n    if (Types.isLeftSquareCorner(prev) && next) {\n      // Spacing between a hat and a corner\n      // AnyDuringMigration because:  Property 'isHat' does not exist on type\n      // 'typeof Types'.\n      if ((Types as AnyDuringMigration).isHat(next)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Spacing between a square corner and a previous or next connection\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset;\n      }\n    }\n    // Spacing between a rounded corner and a previous or next connection.\n    if (Types.isLeftRoundedCorner(prev) && next) {\n      return next.notchOffset - this.constants_.CORNER_RADIUS;\n    }\n\n    // Spacing between two fields of the same editability.\n    if (Types.isField(prev) && next && Types.isField(next) &&\n        (prev as Field).isEditable === (next as Field).isEditable) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between anything and a jagged edge.\n    if (next && Types.isJaggedEdge(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowHeight_(prev: Row, next: Row) {\n    // If we have an empty block add a spacer to increase the height.\n    if (Types.isTopRow(prev) && Types.isBottomRow(next)) {\n      return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;\n    }\n    // Top and bottom rows act as a spacer so we don't need any extra padding.\n    if (Types.isTopRow(prev) || Types.isBottomRow(next)) {\n      return this.constants_.NO_PADDING;\n    }\n    if (prev.hasExternalInput && next.hasExternalInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (!prev.hasStatement && next.hasStatement) {\n      return this.constants_.BETWEEN_STATEMENT_PADDING_Y;\n    }\n    if (prev.hasStatement && next.hasStatement) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (prev.hasDummyInput || next.hasDummyInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getElemCenterline_(row: Row, elem: Measurable) {\n    if (Types.isSpacer(elem)) {\n      return row.yPos + elem.height / 2;\n    }\n    if (Types.isBottomRow(row)) {\n      const bottomRow = row as BottomRow;\n      const baseline =\n          bottomRow.yPos + bottomRow.height - bottomRow.descenderHeight;\n      if (Types.isNextConnection(elem)) {\n        return baseline + elem.height / 2;\n      }\n      return baseline - elem.height / 2;\n    }\n    if (Types.isTopRow(row)) {\n      const topRow = row as TopRow;\n      // AnyDuringMigration because:  Property 'isHat' does not exist on type\n      // 'typeof Types'.\n      if ((Types as AnyDuringMigration).isHat(elem)) {\n        return topRow.capline - elem.height / 2;\n      }\n      return topRow.capline + elem.height / 2;\n    }\n\n    let result = row.yPos;\n    if (Types.isField(elem) && row.hasStatement) {\n      const offset =\n          this.constants_.TALL_INPUT_FIELD_OFFSET_Y + elem.height / 2;\n      result += offset;\n    } else {\n      result += row.height / 2;\n    }\n    return result;\n  }\n\n  override finalize_() {\n    // Performance note: this could be combined with the draw pass, if the time\n    // that this takes is excessive.  But it shouldn't be, because it only\n    // accesses and sets properties that already exist on the objects.\n    let widestRowWithConnectedBlocks = 0;\n    let yCursor = 0;\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      row.yPos = yCursor;\n      row.xPos = this.startX;\n      yCursor += row.height;\n\n      widestRowWithConnectedBlocks =\n          Math.max(widestRowWithConnectedBlocks, row.widthWithConnectedBlocks);\n      // Add padding to the bottom row if block height is less than minimum\n      const heightWithoutHat = yCursor - this.topRow.ascenderHeight;\n      if (row === this.bottomRow &&\n          heightWithoutHat < this.constants_.MIN_BLOCK_HEIGHT) {\n        // But the hat height shouldn't be part of this.\n        const diff = this.constants_.MIN_BLOCK_HEIGHT - heightWithoutHat;\n        this.bottomRow.height += diff;\n        yCursor += diff;\n      }\n      this.recordElemPositions_(row);\n    }\n    if (this.outputConnection && this.block_.nextConnection &&\n        this.block_.nextConnection.isConnected()) {\n      // Include width of connected block in value to stack width measurement.\n      widestRowWithConnectedBlocks = Math.max(\n          widestRowWithConnectedBlocks,\n          this.block_.nextConnection.targetBlock().getHeightWidth().width);\n    }\n\n    this.bottomRow.baseline = yCursor - this.bottomRow.descenderHeight;\n    this.widthWithChildren = widestRowWithConnectedBlocks + this.startX;\n\n    this.height = yCursor;\n    this.startY = this.topRow.capline;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Thrasos renderer.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.thrasos.Renderer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport * as blockRendering from '../common/block_rendering.js';\nimport {Renderer as BaseRenderer} from '../common/renderer.js';\n\nimport {RenderInfo} from './info.js';\n\n\n/**\n * The thrasos renderer.\n *\n * @alias Blockly.thrasos.Renderer\n */\nexport class Renderer extends BaseRenderer {\n  /**\n   * @param name The renderer name.\n   * @internal\n   */\n  constructor(name: string) {\n    super(name);\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected override makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n}\n\nblockRendering.register('thrasos', Renderer);\n","/** @file Re-exports of Blockly.thrasos.* modules. */\n\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Re-exports of Blockly.thrasos.* modules.\n *\n * @namespace Blockly.thrasos\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.thrasos');\n\nimport {RenderInfo} from './info.js';\nimport {Renderer} from './renderer.js';\n\n\nexport {Renderer, RenderInfo};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object that provides constants for rendering blocks in the\n * minimalist renderer.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.minimalist.ConstantProvider');\n\nimport {ConstantProvider as BaseConstantProvider} from '../common/constants.js';\n\n\n/**\n * An object that provides constants for rendering blocks in the sample.\n *\n * @alias Blockly.minimalist.ConstantProvider\n */\nexport class ConstantProvider extends BaseConstantProvider {\n  /** @internal */\n  constructor() {\n    super();\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Minimalist rendering drawer.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.minimalist.Drawer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {Drawer as BaseDrawer} from '../common/drawer.js';\n\nimport type {RenderInfo} from './info.js';\n\n\n/**\n * An object that draws a block based on the given rendering information.\n *\n * @alias Blockly.minimalist.Drawer\n */\nexport class Drawer extends BaseDrawer {\n  /**\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @internal\n   */\n  constructor(block: BlockSvg, info: RenderInfo) {\n    super(block, info);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Minimalist render info object.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.minimalist.RenderInfo');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {RenderInfo as BaseRenderInfo} from '../common/info.js';\n\nimport type {Renderer} from './renderer.js';\n\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n *\n * @alias Blockly.minimalist.RenderInfo\n */\nexport class RenderInfo extends BaseRenderInfo {\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   * @internal\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    super(renderer, block);\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   * @internal\n   */\n  override getRenderer(): Renderer {\n    // AnyDuringMigration because:  Property 'renderer_' does not exist on type\n    // 'RenderInfo'.\n    return (this as AnyDuringMigration).renderer_ as Renderer;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Minimalist renderer.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.minimalist.Renderer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport * as blockRendering from '../common/block_rendering.js';\nimport type {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport {Renderer as BaseRenderer} from '../common/renderer.js';\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {RenderInfo} from './info.js';\n\n\n/**\n * The minimalist renderer.\n *\n * @alias Blockly.minimalist.Renderer\n */\nexport class Renderer extends BaseRenderer {\n  /**\n   * @param name The renderer name.\n   * @internal\n   */\n  constructor(name: string) {\n    super(name);\n  }\n\n  /**\n   * Create a new instance of the renderer's constant provider.\n   *\n   * @returns The constant provider.\n   */\n  protected override makeConstants_(): ConstantProvider {\n    return new ConstantProvider();\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected override makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n\n  /**\n   * Create a new instance of the renderer's drawer.\n   *\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @returns The drawer.\n   */\n  protected override makeDrawer_(block: BlockSvg, info: BaseRenderInfo):\n      Drawer {\n    return new Drawer(block, (info as RenderInfo));\n  }\n}\n\nblockRendering.register('minimalist', Renderer);\n","/** @file Re-exports of Blockly.minimalist.* modules. */\n\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Re-exports of Blockly.minimalist.* modules.\n *\n * @namespace Blockly.minimalist\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.minimalist');\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {RenderInfo} from './info.js';\nimport {Renderer} from './renderer.js';\n\n\nexport {ConstantProvider, Drawer, Renderer, RenderInfo};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object that provides constants for rendering blocks in Geras\n * mode.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.ConstantProvider');\n\nimport {ConstantProvider as BaseConstantProvider} from '../common/constants.js';\n\n\n/**\n * An object that provides constants for rendering blocks in Geras mode.\n *\n * @alias Blockly.geras.ConstantProvider\n */\nexport class ConstantProvider extends BaseConstantProvider {\n  override FIELD_TEXT_BASELINE_CENTER = false;\n\n  // The dark/shadow path in classic rendering is the same as the normal block\n  // path, but translated down one and right one.\n  DARK_PATH_OFFSET = 1;\n\n  /**\n   * The maximum width of a bottom row that follows a statement input and has\n   * inputs inline.\n   */\n  MAX_BOTTOM_WIDTH = 30;\n  override STATEMENT_BOTTOM_SPACER: AnyDuringMigration;\n\n  /** @internal */\n  constructor() {\n    super();\n\n    this.STATEMENT_BOTTOM_SPACER = -this.NOTCH_HEIGHT / 2;\n  }\n\n  override getCSS_(selector: string) {\n    return super.getCSS_(selector).concat([\n      /* eslint-disable indent */\n      /* clang-format off */\n      // Insertion marker.\n      `${selector} .blocklyInsertionMarker>.blocklyPathLight,`,\n      `${selector} .blocklyInsertionMarker>.blocklyPathDark {`,\n      `fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,\n      `stroke: none;`,\n      '}',\n      /* clang-format on */\n      /* eslint-enable indent */\n    ]);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for adding highlights on block, for rendering in\n * compatibility mode.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.Highlighter');\n\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {ConstantProvider} from '../common/constants.js';\nimport type {BottomRow} from '../measurables/bottom_row.js';\nimport type {Row} from '../measurables/row.js';\nimport {SpacerRow} from '../measurables/spacer_row.js';\nimport type {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {HighlightConstantProvider, InsideCorner, JaggedTeeth, Notch, OutsideCorner, PuzzleTab, StartHat} from './highlight_constants.js';\nimport type {RenderInfo} from './info.js';\nimport type {InlineInput} from './measurables/inline_input.js';\n\n\n/**\n * An object that adds highlights to a block based on the given rendering\n * information.\n *\n * Highlighting is interesting because the highlights do not fully enclose the\n * block.  Instead, they are positioned based on a light source in the top left.\n * This means that rendering highlights requires exact information about the\n * position of each part of the block.  The resulting paths are not continuous\n * or closed paths.  The highlights for tabs and notches are loosely based on\n * tab and notch shapes, but are not exactly the same.\n *\n * @alias Blockly.geras.Highlighter\n */\nexport class Highlighter {\n  info_: RenderInfo;\n  steps_ = '';\n  inlineSteps_ = '';\n  RTL_: boolean;\n  constants_: ConstantProvider;\n  highlightConstants_: HighlightConstantProvider;\n  private readonly highlightOffset_: number;\n  outsideCornerPaths_: OutsideCorner;\n  insideCornerPaths_: InsideCorner;\n  puzzleTabPaths_: PuzzleTab;\n  notchPaths_: Notch;\n  startPaths_: StartHat;\n  jaggedTeethPaths_: JaggedTeeth;\n\n  /**\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @internal\n   */\n  constructor(info: RenderInfo) {\n    this.info_ = info;\n\n    this.RTL_ = this.info_.RTL;\n\n    const renderer = (info.getRenderer());\n\n    /** The renderer's constant provider. */\n    this.constants_ = renderer.getConstants();\n\n    this.highlightConstants_ = renderer.getHighlightConstants();\n    /** The offset between the block's main path and highlight path. */\n    this.highlightOffset_ = this.highlightConstants_.OFFSET;\n\n    this.outsideCornerPaths_ = this.highlightConstants_.OUTSIDE_CORNER;\n    this.insideCornerPaths_ = this.highlightConstants_.INSIDE_CORNER;\n    this.puzzleTabPaths_ = this.highlightConstants_.PUZZLE_TAB;\n    this.notchPaths_ = this.highlightConstants_.NOTCH;\n    this.startPaths_ = this.highlightConstants_.START_HAT;\n    this.jaggedTeethPaths_ = this.highlightConstants_.JAGGED_TEETH;\n  }\n\n  /**\n   * Get the steps for the highlight path.\n   *\n   * @returns The steps for the highlight path.\n   * @internal\n   */\n  getPath(): string {\n    return this.steps_ + '\\n' + this.inlineSteps_;\n  }\n\n  /**\n   * Add a highlight to the top corner of a block.\n   *\n   * @param row The top row of the block.\n   * @internal\n   */\n  drawTopCorner(row: TopRow) {\n    this.steps_ += svgPaths.moveBy(row.xPos, this.info_.startY);\n    for (let i = 0, elem; elem = row.elements[i]; i++) {\n      if (Types.isLeftSquareCorner(elem)) {\n        this.steps_ += this.highlightConstants_.START_POINT;\n      } else if (Types.isLeftRoundedCorner(elem)) {\n        this.steps_ += this.outsideCornerPaths_.topLeft(this.RTL_);\n      } else if (Types.isPreviousConnection(elem)) {\n        this.steps_ += this.notchPaths_.pathLeft;\n      } else if (Types.isHat(elem)) {\n        this.steps_ += this.startPaths_.path(this.RTL_);\n      } else if (Types.isSpacer(elem) && elem.width !== 0) {\n        // The end point of the spacer needs to be offset by the highlight\n        // amount. So instead of using the spacer's width for a relative\n        // horizontal, use its width and position for an absolute horizontal\n        // move.\n        this.steps_ += svgPaths.lineOnAxis(\n            'H', elem.xPos + elem.width - this.highlightOffset_);\n      }\n    }\n\n    const right = row.xPos + row.width - this.highlightOffset_;\n    this.steps_ += svgPaths.lineOnAxis('H', right);\n  }\n\n  /**\n   * Add a highlight on a jagged edge for a collapsed block.\n   *\n   * @param row  The row to highlight.\n   * @internal\n   */\n  drawJaggedEdge_(row: Row) {\n    if (this.info_.RTL) {\n      const remainder =\n          row.height - this.jaggedTeethPaths_.height - this.highlightOffset_;\n      this.steps_ +=\n          this.jaggedTeethPaths_.pathLeft + svgPaths.lineOnAxis('v', remainder);\n    }\n  }\n\n  /**\n   * Add a highlight on a value input.\n   *\n   * @param row The row the input belongs to.\n   * @internal\n   */\n  drawValueInput(row: Row) {\n    const input = row.getLastInput() as InlineInput;\n    if (this.RTL_) {\n      const belowTabHeight = row.height - input.connectionHeight;\n\n      this.steps_ +=\n          svgPaths.moveTo(\n              input.xPos + input.width - this.highlightOffset_, row.yPos) +\n          this.puzzleTabPaths_.pathDown(this.RTL_) +\n          svgPaths.lineOnAxis('v', belowTabHeight);\n    } else {\n      this.steps_ += svgPaths.moveTo(input.xPos + input.width, row.yPos) +\n          this.puzzleTabPaths_.pathDown(this.RTL_);\n    }\n  }\n\n  /**\n   * Add a highlight on a statement input.\n   *\n   * @param row The row to highlight.\n   * @internal\n   */\n  drawStatementInput(row: Row) {\n    const input = row.getLastInput();\n    if (this.RTL_) {\n      const innerHeight = row.height - 2 * this.insideCornerPaths_.height;\n      this.steps_ += svgPaths.moveTo(input.xPos, row.yPos) +\n          this.insideCornerPaths_.pathTop(this.RTL_) +\n          svgPaths.lineOnAxis('v', innerHeight) +\n          this.insideCornerPaths_.pathBottom(this.RTL_) +\n          svgPaths.lineTo(\n              row.width - input.xPos - this.insideCornerPaths_.width, 0);\n    } else {\n      this.steps_ += svgPaths.moveTo(input.xPos, row.yPos + row.height) +\n          this.insideCornerPaths_.pathBottom(this.RTL_) +\n          svgPaths.lineTo(\n              row.width - input.xPos - this.insideCornerPaths_.width, 0);\n    }\n  }\n\n  /**\n   * Add a highlight on the right side of a row.\n   *\n   * @param row The row to highlight.\n   * @internal\n   */\n  drawRightSideRow(row: Row) {\n    const rightEdge = row.xPos + row.width - this.highlightOffset_;\n    if (row instanceof SpacerRow && row.followsStatement) {\n      this.steps_ += svgPaths.lineOnAxis('H', rightEdge);\n    }\n    if (this.RTL_) {\n      this.steps_ += svgPaths.lineOnAxis('H', rightEdge);\n      if (row.height > this.highlightOffset_) {\n        this.steps_ += svgPaths.lineOnAxis(\n            'V', row.yPos + row.height - this.highlightOffset_);\n      }\n    }\n  }\n\n  /**\n   * Add a highlight to the bottom row.\n   *\n   * @param row The row to highlight.\n   * @internal\n   */\n  drawBottomRow(row: BottomRow) {\n    // Highlight the vertical edge of the bottom row on the input side.\n    // Highlighting is always from the top left, both in LTR and RTL.\n    if (this.RTL_) {\n      this.steps_ +=\n          svgPaths.lineOnAxis('V', row.baseline - this.highlightOffset_);\n    } else {\n      const cornerElem = this.info_.bottomRow.elements[0];\n      if (Types.isLeftSquareCorner(cornerElem)) {\n        this.steps_ += svgPaths.moveTo(\n            row.xPos + this.highlightOffset_,\n            row.baseline - this.highlightOffset_);\n      } else if (Types.isLeftRoundedCorner(cornerElem)) {\n        this.steps_ += svgPaths.moveTo(row.xPos, row.baseline);\n        this.steps_ += this.outsideCornerPaths_.bottomLeft();\n      }\n    }\n  }\n\n  /**\n   * Draw the highlight on the left side of the block.\n   *\n   * @internal\n   */\n  drawLeft() {\n    const outputConnection = this.info_.outputConnection;\n    if (outputConnection) {\n      const tabBottom =\n          outputConnection.connectionOffsetY + outputConnection.height;\n      // Draw a line up to the bottom of the tab.\n      if (this.RTL_) {\n        this.steps_ += svgPaths.moveTo(this.info_.startX, tabBottom);\n      } else {\n        const left = this.info_.startX + this.highlightOffset_;\n        const bottom = this.info_.bottomRow.baseline - this.highlightOffset_;\n        this.steps_ += svgPaths.moveTo(left, bottom);\n        this.steps_ += svgPaths.lineOnAxis('V', tabBottom);\n      }\n      this.steps_ += this.puzzleTabPaths_.pathUp(this.RTL_);\n    }\n\n    if (!this.RTL_) {\n      const topRow = this.info_.topRow;\n      if (Types.isLeftRoundedCorner(topRow.elements[0])) {\n        this.steps_ +=\n            svgPaths.lineOnAxis('V', this.outsideCornerPaths_.height);\n      } else {\n        this.steps_ +=\n            svgPaths.lineOnAxis('V', topRow.capline + this.highlightOffset_);\n      }\n    }\n  }\n\n  /**\n   * Add a highlight to an inline input.\n   *\n   * @param input The input to highlight.\n   * @internal\n   */\n  drawInlineInput(input: InlineInput) {\n    const offset = this.highlightOffset_;\n\n    // Relative to the block's left.\n    const connectionRight = input.xPos + input.connectionWidth;\n    const yPos = input.centerline - input.height / 2;\n    const bottomHighlightWidth = input.width - input.connectionWidth;\n    const startY = yPos + offset;\n\n    if (this.RTL_) {\n      const aboveTabHeight = input.connectionOffsetY - offset;\n      const belowTabHeight = input.height -\n          (input.connectionOffsetY + input.connectionHeight) + offset;\n\n      const startX = connectionRight - offset;\n\n      this.inlineSteps_ +=\n          svgPaths.moveTo(startX, startY) +           // Right edge above tab.\n          svgPaths.lineOnAxis('v', aboveTabHeight) +  // Back of tab.\n          this.puzzleTabPaths_.pathDown(this.RTL_) +  // Right edge below tab.\n          svgPaths.lineOnAxis('v', belowTabHeight) +  // Bottom.\n          svgPaths.lineOnAxis('h', bottomHighlightWidth);\n    } else {\n      this.inlineSteps_ +=  // Go to top right corner.\n          svgPaths.moveTo(\n              input.xPos + input.width + offset,\n              startY) +  // Highlight right edge, bottom.\n          svgPaths.lineOnAxis('v', input.height) +\n          svgPaths.lineOnAxis(\n              'h', -bottomHighlightWidth) +  // Go to top of tab.\n          svgPaths.moveTo(\n              connectionRight,\n              yPos + input.connectionOffsetY) +  // Short highlight glint at\n          // bottom of tab.\n          this.puzzleTabPaths_.pathDown(this.RTL_);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Renderer that preserves the look and feel of Blockly pre-2019.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.Drawer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport * as debug from '../common/debug.js';\nimport {Drawer as BaseDrawer} from '../common/drawer.js';\nimport type {Row} from '../measurables/row.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport {Highlighter} from './highlighter.js';\nimport type {RenderInfo} from './info.js';\nimport type {InlineInput} from './measurables/inline_input.js';\nimport type {PathObject} from './path_object.js';\n\n\n/**\n * An object that draws a block based on the given rendering information.\n *\n * @alias Blockly.geras.Drawer\n */\nexport class Drawer extends BaseDrawer {\n  highlighter_: AnyDuringMigration;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override constants_!: ConstantProvider;\n\n  /**\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @internal\n   */\n  constructor(block: BlockSvg, info: RenderInfo) {\n    super(block, info);\n    // Unlike Thrasos, Geras has highlights and drop shadows.\n    this.highlighter_ = new Highlighter(info);\n  }\n\n  override draw() {\n    this.hideHiddenIcons_();\n    this.drawOutline_();\n    this.drawInternals_();\n\n    const pathObject = this.block_.pathObject as PathObject;\n    pathObject.setPath(this.outlinePath_ + '\\n' + this.inlinePath_);\n    pathObject.setHighlightPath(this.highlighter_.getPath());\n    if (this.info_.RTL) {\n      pathObject.flipRTL();\n    }\n    if (debug.isDebuggerEnabled()) {\n      this.block_.renderingDebugger.drawDebug(this.block_, this.info_);\n    }\n    this.recordSizeOnBlock_();\n  }\n\n  override drawTop_() {\n    this.highlighter_.drawTopCorner(this.info_.topRow);\n    this.highlighter_.drawRightSideRow(this.info_.topRow);\n\n    super.drawTop_();\n  }\n\n  override drawJaggedEdge_(row: Row) {\n    this.highlighter_.drawJaggedEdge_(row);\n\n    super.drawJaggedEdge_(row);\n  }\n\n  override drawValueInput_(row: Row) {\n    this.highlighter_.drawValueInput(row);\n\n    super.drawValueInput_(row);\n  }\n\n  override drawStatementInput_(row: Row) {\n    this.highlighter_.drawStatementInput(row);\n\n    super.drawStatementInput_(row);\n  }\n\n  override drawRightSideRow_(row: Row) {\n    this.highlighter_.drawRightSideRow(row);\n\n    this.outlinePath_ += svgPaths.lineOnAxis('H', row.xPos + row.width) +\n        svgPaths.lineOnAxis('V', row.yPos + row.height);\n  }\n\n  override drawBottom_() {\n    this.highlighter_.drawBottomRow(this.info_.bottomRow);\n\n    super.drawBottom_();\n  }\n\n  /**\n   * Add steps for the left side of the block, which may include an output\n   * connection\n   */\n  protected override drawLeft_() {\n    this.highlighter_.drawLeft();\n\n    super.drawLeft_();\n  }\n\n  override drawInlineInput_(input: InlineInput) {\n    this.highlighter_.drawInlineInput(input as InlineInput);\n\n    super.drawInlineInput_(input);\n  }\n\n  override positionInlineInputConnection_(input: InlineInput) {\n    const yPos = input.centerline - input.height / 2;\n    // Move the connection.\n    if (input.connectionModel) {\n      // xPos already contains info about startX\n      let connX =\n          input.xPos + input.connectionWidth + this.constants_.DARK_PATH_OFFSET;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(\n          connX,\n          yPos + input.connectionOffsetY + this.constants_.DARK_PATH_OFFSET);\n    }\n  }\n\n  override positionStatementInputConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input.connectionModel) {\n      let connX = row.xPos + row.statementEdge + input.notchOffset;\n      if (this.info_.RTL) {\n        connX *= -1;\n      } else {\n        connX += this.constants_.DARK_PATH_OFFSET;\n      }\n      input.connectionModel.setOffsetInBlock(\n          connX, row.yPos + this.constants_.DARK_PATH_OFFSET);\n    }\n  }\n\n  override positionExternalValueConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input.connectionModel) {\n      let connX = row.xPos + row.width + this.constants_.DARK_PATH_OFFSET;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(connX, row.yPos);\n    }\n  }\n\n  override positionNextConnection_() {\n    const bottomRow = this.info_.bottomRow;\n\n    if (bottomRow.connection) {\n      const connInfo = bottomRow.connection;\n      const x = connInfo.xPos;  // Already contains info about startX.\n      const connX =\n          (this.info_.RTL ? -x : x) + this.constants_.DARK_PATH_OFFSET / 2;\n      connInfo.connectionModel.setOffsetInBlock(\n          connX, bottomRow.baseline + this.constants_.DARK_PATH_OFFSET);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Objects for rendering highlights on blocks.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.HighlightConstantProvider');\n\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\n\n/** An object containing sizing and path information about an outside corner. */\nexport interface OutsideCorner {\n  height: number;\n  topLeft: (p1: boolean) => string;\n  bottomLeft: () => string;\n}\n\n/** An object containing sizing and path information about an inside corner. */\nexport interface InsideCorner {\n  width: number;\n  height: number;\n  pathTop: (p1: boolean) => string;\n  pathBottom: (p1: boolean) => string;\n}\n\n/** An object containing sizing and path information about a start hat. */\nexport interface StartHat {\n  path: (p1: boolean) => string;\n}\n\n/** An object containing sizing and path information about a notch. */\nexport interface Notch {\n  pathLeft: string;\n}\n\n/** An object containing sizing and path information about a puzzle tab. */\nexport interface PuzzleTab {\n  width: number;\n  height: number;\n  pathDown: (p1: boolean) => string;\n  pathUp: (p1: boolean) => string;\n}\n\n/**\n * An object containing sizing and path information about collapsed block\n * indicators.\n */\nexport interface JaggedTeeth {\n  height: number;\n  width: number;\n  pathLeft: string;\n}\n\n/**\n * An object that provides constants for rendering highlights on blocks.\n * Some highlights are simple offsets of the parent paths and can be generated\n * programmatically.  Others, especially on curves, are just made out of piles\n * of constants and are hard to tweak.\n *\n * @alias Blockly.geras.HighlightConstantProvider\n */\nexport class HighlightConstantProvider {\n  constantProvider: ConstantProvider;\n\n  /** The offset between the block's main path and highlight path. */\n  OFFSET = 0.5;\n  START_POINT: string;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  INSIDE_CORNER!: InsideCorner;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  OUTSIDE_CORNER!: OutsideCorner;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  PUZZLE_TAB!: PuzzleTab;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  NOTCH!: Notch;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  JAGGED_TEETH!: JaggedTeeth;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  START_HAT!: StartHat;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @internal\n   */\n  constructor(constants: ConstantProvider) {\n    /** The renderer's constant provider. */\n    this.constantProvider = constants;\n\n    /**\n     * The start point, which is offset in both X and Y, as an SVG path chunk.\n     *\n     * @internal\n     */\n    this.START_POINT = svgPaths.moveBy(this.OFFSET, this.OFFSET);\n  }\n\n  /**\n   * Initialize shape objects based on the constants set in the constructor.\n   *\n   * @internal\n   */\n  init() {\n    /**\n     * An object containing sizing and path information about inside corner\n     * highlights.\n     */\n    this.INSIDE_CORNER = this.makeInsideCorner();\n\n    /**\n     * An object containing sizing and path information about outside corner\n     * highlights.\n     */\n    this.OUTSIDE_CORNER = this.makeOutsideCorner();\n\n    /**\n     * An object containing sizing and path information about puzzle tab\n     * highlights.\n     */\n    this.PUZZLE_TAB = this.makePuzzleTab();\n\n    /**\n     * An object containing sizing and path information about notch highlights.\n     */\n    this.NOTCH = this.makeNotch();\n\n    /**\n     * An object containing sizing and path information about highlights for\n     * collapsed block indicators.\n     */\n    this.JAGGED_TEETH = this.makeJaggedTeeth();\n\n    /**\n     * An object containing sizing and path information about start hat\n     * highlights.\n     */\n    this.START_HAT = this.makeStartHat();\n  }\n\n  /**\n   * @returns An object containing sizing and path information about inside\n   *     corner highlights.\n   * @internal\n   */\n  makeInsideCorner(): InsideCorner {\n    const radius = this.constantProvider.CORNER_RADIUS;\n    const offset = this.OFFSET;\n\n    /**\n     * Distance from shape edge to intersect with a curved corner at 45 degrees.\n     * Applies to highlighting on around the outside of a curve.\n     */\n    const distance45outside = (1 - Math.SQRT1_2) * (radius + offset) - offset;\n\n    const pathTopRtl = svgPaths.moveBy(distance45outside, distance45outside) +\n        svgPaths.arc(\n            'a', '0 0,0', radius,\n            svgPaths.point(\n                -distance45outside - offset, radius - distance45outside));\n\n    const pathBottomRtl = svgPaths.arc(\n        'a', '0 0,0', radius + offset,\n        svgPaths.point(radius + offset, radius + offset));\n\n    const pathBottomLtr =\n        svgPaths.moveBy(distance45outside, -distance45outside) +\n        svgPaths.arc(\n            'a', '0 0,0', radius + offset,\n            svgPaths.point(\n                radius - distance45outside, distance45outside + offset));\n\n    return {\n      width: radius + offset,\n      height: radius,\n      pathTop(rtl) {\n        return rtl ? pathTopRtl : '';\n      },\n      pathBottom(rtl) {\n        return rtl ? pathBottomRtl : pathBottomLtr;\n      },\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about outside\n   *     corner highlights.\n   * @internal\n   */\n  makeOutsideCorner(): OutsideCorner {\n    const radius = this.constantProvider.CORNER_RADIUS;\n    const offset = this.OFFSET;\n\n    /**\n     * Distance from shape edge to intersect with a curved corner at 45 degrees.\n     * Applies to highlighting on around the inside of a curve.\n     */\n    const distance45inside = (1 - Math.SQRT1_2) * (radius - offset) + offset;\n\n    const topLeftStartX = distance45inside;\n    const topLeftStartY = distance45inside;\n    const topLeftCornerHighlightRtl =\n        svgPaths.moveBy(topLeftStartX, topLeftStartY) +\n        svgPaths.arc(\n            'a', '0 0,1', radius - offset,\n            svgPaths.point(radius - topLeftStartX, -topLeftStartY + offset));\n    /**\n     * SVG path for drawing the highlight on the rounded top-left corner.\n     */\n    const topLeftCornerHighlightLtr = svgPaths.moveBy(offset, radius) +\n        svgPaths.arc(\n            'a', '0 0,1', radius - offset,\n            svgPaths.point(radius, -radius + offset));\n\n    const bottomLeftStartX = distance45inside;\n    const bottomLeftStartY = -distance45inside;\n    const bottomLeftPath = svgPaths.moveBy(bottomLeftStartX, bottomLeftStartY) +\n        svgPaths.arc(\n            'a', '0 0,1', radius - offset,\n            svgPaths.point(\n                -bottomLeftStartX + offset, -bottomLeftStartY - radius));\n\n    return {\n      height: radius,\n      topLeft(rtl) {\n        return rtl ? topLeftCornerHighlightRtl : topLeftCornerHighlightLtr;\n      },\n      bottomLeft() {\n        return bottomLeftPath;\n      },\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about puzzle tab\n   *     highlights.\n   * @internal\n   */\n  makePuzzleTab(): PuzzleTab {\n    const width = this.constantProvider.TAB_WIDTH;\n    const height = this.constantProvider.TAB_HEIGHT;\n\n    // This is how much of the vertical block edge is actually drawn by the\n    // puzzle tab.\n    const verticalOverlap = 2.5;\n\n    const highlightRtlUp =\n        svgPaths.moveBy(-2, -height + verticalOverlap + 0.9) +\n        svgPaths.lineTo(width * -0.45, -2.1);\n\n    const highlightRtlDown = svgPaths.lineOnAxis('v', verticalOverlap) +\n        svgPaths.moveBy(-width * 0.97, 2.5) +\n        svgPaths.curve(\n            'q',\n            [\n              svgPaths.point(-width * 0.05, 10),\n              svgPaths.point(width * 0.3, 9.5),\n            ]) +\n        svgPaths.moveBy(width * 0.67, -1.9) +\n        svgPaths.lineOnAxis('v', verticalOverlap);\n\n    const highlightLtrUp = svgPaths.lineOnAxis('v', -1.5) +\n        svgPaths.moveBy(width * -0.92, -0.5) +\n        svgPaths.curve(\n            'q',\n            [svgPaths.point(width * -0.19, -5.5), svgPaths.point(0, -11)]) +\n        svgPaths.moveBy(width * 0.92, 1);\n\n    const highlightLtrDown =\n        svgPaths.moveBy(-5, height - 0.7) + svgPaths.lineTo(width * 0.46, -2.1);\n\n    return {\n      width,\n      height,\n      pathUp(rtl) {\n        return rtl ? highlightRtlUp : highlightLtrUp;\n      },\n      pathDown(rtl) {\n        return rtl ? highlightRtlDown : highlightLtrDown;\n      },\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about notch\n   *     highlights.\n   * @internal\n   */\n  makeNotch(): Notch {\n    // This is only for the previous connection.\n    const pathLeft = svgPaths.lineOnAxis('h', this.OFFSET) +\n        this.constantProvider.NOTCH.pathLeft;\n    return {pathLeft};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about collapsed\n   *     block edge highlights.\n   * @internal\n   */\n  makeJaggedTeeth(): JaggedTeeth {\n    const pathLeft = svgPaths.lineTo(5.1, 2.6) + svgPaths.moveBy(-10.2, 6.8) +\n        svgPaths.lineTo(5.1, 2.6);\n    return {pathLeft, height: 12, width: 10.2};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about start\n   *     highlights.\n   * @internal\n   */\n  makeStartHat(): StartHat {\n    const hatHeight = this.constantProvider.START_HAT.height;\n    const pathRtl = svgPaths.moveBy(25, -8.7) + svgPaths.curve('c', [\n      svgPaths.point(29.7, -6.2),\n      svgPaths.point(57.2, -0.5),\n      svgPaths.point(75, 8.7),\n    ]);\n\n    const pathLtr = svgPaths.curve('c', [\n      svgPaths.point(17.8, -9.2),\n      svgPaths.point(45.3, -14.9),\n      svgPaths.point(75, -8.7),\n    ]) + svgPaths.moveTo(100.5, hatHeight + 0.5);\n    return {\n      path(rtl) {\n        return rtl ? pathRtl : pathLtr;\n      },\n    };\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Objects representing inline inputs with connections on a\n * rendered block.\n *\n * @class\n */\nimport * as goog from '../../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.InlineInput');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../../input.js';\nimport type {ConstantProvider as BaseConstantProvider} from '../../../renderers/common/constants.js';\nimport {InlineInput as BaseInlineInput} from '../../../renderers/measurables/inline_input.js';\nimport type {ConstantProvider as GerasConstantProvider} from '../constants.js';\n\n\n/**\n * An object containing information about the space an inline input takes up\n * during rendering.\n *\n * @alias Blockly.geras.InlineInput\n */\nexport class InlineInput extends BaseInlineInput {\n  override constants_: GerasConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The inline input to measure and store information for.\n   * @internal\n   */\n  constructor(constants: BaseConstantProvider, input: Input) {\n    super(constants, input);\n    this.constants_ = constants as GerasConstantProvider;\n\n    if (this.connectedBlock) {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.width += this.constants_.DARK_PATH_OFFSET;\n      this.height += this.constants_.DARK_PATH_OFFSET;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Objects representing statement inputs with connections on a\n * rendered block.\n *\n * @class\n */\nimport * as goog from '../../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.StatementInput');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../../input.js';\nimport type {ConstantProvider as BaseConstantProvider} from '../../../renderers/common/constants.js';\nimport {StatementInput as BaseStatementInput} from '../../../renderers/measurables/statement_input.js';\nimport type {ConstantProvider as GerasConstantProvider} from '../constants.js';\n\n\n/**\n * An object containing information about the space a statement input takes up\n * during rendering.\n *\n * @alias Blockly.geras.StatementInput\n */\nexport class StatementInput extends BaseStatementInput {\n  override constants_: GerasConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The statement input to measure and store information for.\n   * @internal\n   */\n  constructor(constants: BaseConstantProvider, input: Input) {\n    super(constants, input);\n    this.constants_ = constants as GerasConstantProvider;\n\n    if (this.connectedBlock) {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.height += this.constants_.DARK_PATH_OFFSET;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Old (compatibility) renderer.\n * Geras: spirit of old age.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.RenderInfo');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Input} from '../../input.js';\nimport {inputTypes} from '../../input_types.js';\nimport {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport type {Measurable} from '../measurables/base.js';\nimport type {BottomRow} from '../measurables/bottom_row.js';\nimport {ExternalValueInput} from '../measurables/external_value_input.js';\nimport type {Field} from '../measurables/field.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport type {InputRow} from '../measurables/input_row.js';\nimport type {Row} from '../measurables/row.js';\nimport type {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport {InlineInput} from './measurables/inline_input.js';\nimport {StatementInput} from './measurables/statement_input.js';\nimport type {Renderer} from './renderer.js';\n\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n *\n * @alias Blockly.geras.RenderInfo\n */\nexport class RenderInfo extends BaseRenderInfo {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override constants_!: ConstantProvider;\n\n  protected override readonly renderer_: Renderer;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   * @internal\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    super(renderer, block);\n    this.renderer_ = renderer;\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   * @internal\n   */\n  override getRenderer(): Renderer {\n    return this.renderer_;\n  }\n\n  override populateBottomRow_() {\n    super.populateBottomRow_();\n\n    const followsStatement = this.block_.inputList.length &&\n        this.block_.inputList[this.block_.inputList.length - 1].type ===\n            inputTypes.STATEMENT;\n    // The minimum height of the bottom row is smaller in Geras than in other\n    // renderers, because the dark path adds a pixel.\n    // If one of the row's elements has a greater height this will be\n    // overwritten in the compute pass.\n    if (!followsStatement) {\n      this.bottomRow.minHeight =\n          this.constants_.MEDIUM_PADDING - this.constants_.DARK_PATH_OFFSET;\n    }\n  }\n\n  override addInput_(input: Input, activeRow: Row) {\n    // Non-dummy inputs have visual representations onscreen.\n    if (this.isInline && input.type === inputTypes.VALUE) {\n      activeRow.elements.push(new InlineInput(this.constants_, input));\n      activeRow.hasInlineInput = true;\n    } else if (input.type === inputTypes.STATEMENT) {\n      activeRow.elements.push(new StatementInput(this.constants_, input));\n      activeRow.hasStatement = true;\n    } else if (input.type === inputTypes.VALUE) {\n      activeRow.elements.push(new ExternalValueInput(this.constants_, input));\n      activeRow.hasExternalInput = true;\n    } else if (input.type === inputTypes.DUMMY) {\n      // Dummy inputs have no visual representation, but the information is\n      // still important.\n      activeRow.minHeight =\n          Math.max(activeRow.minHeight, this.constants_.DUMMY_INPUT_MIN_HEIGHT);\n      activeRow.hasDummyInput = true;\n    }\n    // Ignore row alignment if inline.\n    if (!this.isInline && activeRow.align === null) {\n      activeRow.align = input.align;\n    }\n  }\n\n  override addElemSpacing_() {\n    let hasExternalInputs = false;\n    for (let i = 0, row; row = this.rows[i]; i++) {\n      if (row.hasExternalInput) {\n        hasExternalInputs = true;\n      }\n    }\n    for (let i = 0, row; row = this.rows[i]; i++) {\n      const oldElems = row.elements;\n      row.elements = [];\n      // No spacing needed before the corner on the top row or the bottom row.\n      if (row.startsWithElemSpacer()) {\n        // There's a spacer before the first element in the row.\n        row.elements.push(new InRowSpacer(\n            this.constants_, this.getInRowSpacing_(null, oldElems[0])));\n      }\n      if (!oldElems.length) {\n        continue;\n      }\n      for (let e = 0; e < oldElems.length - 1; e++) {\n        row.elements.push(oldElems[e]);\n        const spacing = this.getInRowSpacing_(oldElems[e], oldElems[e + 1]);\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n      row.elements.push(oldElems[oldElems.length - 1]);\n      if (row.endsWithElemSpacer()) {\n        let spacing =\n            this.getInRowSpacing_(oldElems[oldElems.length - 1], null);\n        if (hasExternalInputs && row.hasDummyInput) {\n          spacing += this.constants_.TAB_WIDTH;\n        }\n        // There's a spacer after the last element in the row.\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n    }\n  }\n\n  override getInRowSpacing_(prev: Measurable|null, next: Measurable|null) {\n    if (!prev) {\n      // Between an editable field and the beginning of the row.\n      if (next && Types.isField(next) && (next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Inline input at the beginning of the row.\n      if (next && Types.isInlineInput(next)) {\n        return this.constants_.MEDIUM_LARGE_PADDING;\n      }\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n      // Anything else at the beginning of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between a non-input and the end of the row or a statement input.\n    if (!Types.isInput(prev) && (!next || Types.isStatementInput(next))) {\n      // Between an editable field and the end of the row.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Padding at the end of an icon-only row to make the block shape clearer.\n      if (Types.isIcon(prev)) {\n        return this.constants_.LARGE_PADDING * 2 + 1;\n      }\n      if (Types.isHat(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Establish a minimum width for a block with a previous or next\n      // connection.\n      if (Types.isPreviousOrNextConnection(prev)) {\n        return this.constants_.LARGE_PADDING;\n      }\n      // Between rounded corner and the end of the row.\n      if (Types.isLeftRoundedCorner(prev)) {\n        return this.constants_.MIN_BLOCK_WIDTH;\n      }\n      // Between a jagged edge and the end of the row.\n      if (Types.isJaggedEdge(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Between noneditable fields and icons and the end of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Between inputs and the end of the row.\n    if (Types.isInput(prev) && !next) {\n      if (Types.isExternalInput(prev)) {\n        return this.constants_.NO_PADDING;\n      } else if (Types.isInlineInput(prev)) {\n        return this.constants_.LARGE_PADDING;\n      } else if (Types.isStatementInput(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n\n    // Spacing between a non-input and an input.\n    if (!Types.isInput(prev) && next && Types.isInput(next)) {\n      // Between an editable field and an input.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.SMALL_PADDING;\n        } else if (Types.isExternalInput(next)) {\n          return this.constants_.SMALL_PADDING;\n        }\n      } else {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n        } else if (Types.isExternalInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n        } else if (Types.isStatementInput(next)) {\n          return this.constants_.LARGE_PADDING;\n        }\n      }\n      return this.constants_.LARGE_PADDING - 1;\n    }\n\n    // Spacing between an icon and an icon or field.\n    if (Types.isIcon(prev) && next && !Types.isInput(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n    // Spacing between an inline input and a field.\n    if (Types.isInlineInput(prev) && next && Types.isField(next)) {\n      // Editable field after inline input.\n      if ((next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      } else {\n        // Noneditable field after inline input.\n        return this.constants_.LARGE_PADDING;\n      }\n    }\n\n    if (Types.isLeftSquareCorner(prev) && next) {\n      // Spacing between a hat and a corner\n      if (Types.isHat(next)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Spacing between a square corner and a previous or next connection\n      if (Types.isPreviousConnection(next)) {\n        return next.notchOffset;\n      } else if (Types.isNextConnection(next)) {\n        // Next connections are shifted slightly to the left (in both LTR and\n        // RTL) to make the dark path under the previous connection show\n        // through.\n        const offset =\n            (this.RTL ? 1 : -1) * this.constants_.DARK_PATH_OFFSET / 2;\n        return next.notchOffset + offset;\n      }\n    }\n\n    // Spacing between a rounded corner and a previous or next connection.\n    if (Types.isLeftRoundedCorner(prev) && next) {\n      if (Types.isPreviousConnection(next)) {\n        return next.notchOffset - this.constants_.CORNER_RADIUS;\n      } else if (Types.isNextConnection(next)) {\n        // Next connections are shifted slightly to the left (in both LTR and\n        // RTL) to make the dark path under the previous connection show\n        // through.\n        const offset =\n            (this.RTL ? 1 : -1) * this.constants_.DARK_PATH_OFFSET / 2;\n        return next.notchOffset - this.constants_.CORNER_RADIUS + offset;\n      }\n    }\n\n    // Spacing between two fields of the same editability.\n    if (Types.isField(prev) && next && Types.isField(next) &&\n        (prev as Field).isEditable === (next as Field).isEditable) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between anything and a jagged edge.\n    if (next && Types.isJaggedEdge(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowHeight_(prev: Row, next: Row) {\n    // If we have an empty block add a spacer to increase the height.\n    if (Types.isTopRow(prev) && Types.isBottomRow(next)) {\n      return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;\n    }\n    // Top and bottom rows act as a spacer so we don't need any extra padding.\n    if (Types.isTopRow(prev) || Types.isBottomRow(next)) {\n      return this.constants_.NO_PADDING;\n    }\n    if (prev.hasExternalInput && next.hasExternalInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (!prev.hasStatement && next.hasStatement) {\n      return this.constants_.BETWEEN_STATEMENT_PADDING_Y;\n    }\n    if (prev.hasStatement && next.hasStatement) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (!prev.hasStatement && next.hasDummyInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (prev.hasDummyInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getElemCenterline_(row: Row, elem: Measurable) {\n    if (Types.isSpacer(elem)) {\n      return row.yPos + elem.height / 2;\n    }\n    if (Types.isBottomRow(row)) {\n      const bottomRow = row as BottomRow;\n      const baseline =\n          bottomRow.yPos + bottomRow.height - bottomRow.descenderHeight;\n      if (Types.isNextConnection(elem)) {\n        return baseline + elem.height / 2;\n      }\n      return baseline - elem.height / 2;\n    }\n    if (Types.isTopRow(row)) {\n      const topRow = row as TopRow;\n      if (Types.isHat(elem)) {\n        return topRow.capline - elem.height / 2;\n      }\n      return topRow.capline + elem.height / 2;\n    }\n\n    let result = row.yPos;\n    if (Types.isField(elem) || Types.isIcon(elem)) {\n      result += elem.height / 2;\n      if ((row.hasInlineInput || row.hasStatement) &&\n          elem.height + this.constants_.TALL_INPUT_FIELD_OFFSET_Y <=\n              row.height) {\n        result += this.constants_.TALL_INPUT_FIELD_OFFSET_Y;\n      }\n    } else if (Types.isInlineInput(elem)) {\n      result += elem.height / 2;\n    } else {\n      result += row.height / 2;\n    }\n    return result;\n  }\n\n  override alignRowElements_() {\n    if (!this.isInline) {\n      super.alignRowElements_();\n      return;\n    }\n    // Walk backgrounds through rows on the block, keeping track of the right\n    // input edge.\n    let nextRightEdge = 0;\n    const rowNextRightEdges = new WeakMap();\n    let prevInput = null;\n    for (let i = this.rows.length - 1, row; row = this.rows[i]; i--) {\n      rowNextRightEdges.set(row, nextRightEdge);\n      if (Types.isInputRow(row)) {\n        if (row.hasStatement) {\n          this.alignStatementRow_(row as InputRow);\n        }\n        if (prevInput && prevInput.hasStatement &&\n            row.width < prevInput.width) {\n          rowNextRightEdges.set(row, prevInput.width);\n        } else {\n          nextRightEdge = row.width;\n        }\n        prevInput = row;\n      }\n    }\n    // Walk down each row from the top, comparing the prev and next right input\n    // edges and setting the desired width to the max of the two.\n    let prevRightEdge = 0;\n    for (let i = 0, row; row = this.rows[i]; i++) {\n      if (row.hasStatement) {\n        prevRightEdge = this.getDesiredRowWidth_(row);\n      } else if (Types.isSpacer(row)) {\n        // Set the spacer row to the max of the prev or next input width.\n        row.width = Math.max(prevRightEdge, rowNextRightEdges.get(row));\n      } else {\n        const currentWidth = row.width;\n        const desiredWidth =\n            Math.max(prevRightEdge, rowNextRightEdges.get(row));\n        const missingSpace = desiredWidth - currentWidth;\n        if (missingSpace > 0) {\n          this.addAlignmentPadding_(row, missingSpace);\n        }\n        prevRightEdge = row.width;\n      }\n    }\n  }\n\n  override getDesiredRowWidth_(row: Row) {\n    // Limit the width of a statement row when a block is inline.\n    if (this.isInline && row.hasStatement) {\n      return this.statementEdge + this.constants_.MAX_BOTTOM_WIDTH +\n          this.startX;\n    }\n    return super.getDesiredRowWidth_(row);\n  }\n\n  override finalize_() {\n    // Performance note: this could be combined with the draw pass, if the time\n    // that this takes is excessive.  But it shouldn't be, because it only\n    // accesses and sets properties that already exist on the objects.\n    let widestRowWithConnectedBlocks = 0;\n    let yCursor = 0;\n    for (let i = 0, row; row = this.rows[i]; i++) {\n      row.yPos = yCursor;\n      row.xPos = this.startX;\n      yCursor += row.height;\n\n      widestRowWithConnectedBlocks =\n          Math.max(widestRowWithConnectedBlocks, row.widthWithConnectedBlocks);\n      // Add padding to the bottom row if block height is less than minimum\n      const heightWithoutHat = yCursor - this.topRow.ascenderHeight;\n      if (row === this.bottomRow &&\n          heightWithoutHat < this.constants_.MIN_BLOCK_HEIGHT) {\n        // But the hat height shouldn't be part of this.\n        const diff = this.constants_.MIN_BLOCK_HEIGHT - heightWithoutHat;\n        this.bottomRow.height += diff;\n        yCursor += diff;\n      }\n      this.recordElemPositions_(row);\n    }\n    if (this.outputConnection && this.block_.nextConnection &&\n        this.block_.nextConnection.isConnected()) {\n      // Include width of connected block in value to stack width measurement.\n      widestRowWithConnectedBlocks = Math.max(\n          widestRowWithConnectedBlocks,\n          this.block_.nextConnection.targetBlock().getHeightWidth().width -\n              this.constants_.DARK_PATH_OFFSET);\n    }\n\n    this.bottomRow.baseline = yCursor - this.bottomRow.descenderHeight;\n    this.widthWithChildren = widestRowWithConnectedBlocks + this.startX +\n        this.constants_.DARK_PATH_OFFSET;\n    this.width += this.constants_.DARK_PATH_OFFSET;\n    this.height = yCursor + this.constants_.DARK_PATH_OFFSET;\n    this.startY = this.topRow.capline;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object that owns a block's rendering SVG elements.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.PathObject');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {BlockStyle} from '../../theme.js';\nimport * as colour from '../../utils/colour.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport {PathObject as BasePathObject} from '../common/path_object.js';\n\nimport type {ConstantProvider} from './constants.js';\n\n\n/**\n * An object that handles creating and setting each of the SVG elements\n * used by the renderer.\n *\n * @alias Blockly.geras.PathObject\n */\nexport class PathObject extends BasePathObject {\n  /** @internal */\n  svgPathDark: SVGElement;\n  /** @internal */\n  svgPathLight: SVGElement;\n\n  /**\n   * The colour of the dark path on the block in '#RRGGBB' format.\n   *\n   * @internal\n   */\n  colourDark = '#000000';\n  override style: AnyDuringMigration;\n\n  /**\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @param constants The renderer's constants.\n   * @internal\n   */\n  constructor(\n      root: SVGElement, style: BlockStyle,\n      public override constants: ConstantProvider) {\n    super(root, style, constants);\n\n    /** The dark path of the block. */\n    this.svgPathDark = dom.createSvgElement(\n        Svg.PATH, {'class': 'blocklyPathDark', 'transform': 'translate(1,1)'});\n    // SVG draw order is based on the order of elements (top most = back most)\n    // So we need to insert the dark path before the base path to make sure it\n    // gets drawn first.\n    this.svgRoot.insertBefore(this.svgPathDark, this.svgPath);\n\n    /** The light path of the block. */\n    this.svgPathLight = dom.createSvgElement(\n        Svg.PATH, {'class': 'blocklyPathLight'}, this.svgRoot);\n  }\n\n  override setPath(mainPath: string) {\n    this.svgPath.setAttribute('d', mainPath);\n    this.svgPathDark.setAttribute('d', mainPath);\n  }\n\n  /**\n   * Set the highlight path generated by the renderer onto the SVG element.\n   *\n   * @param highlightPath The highlight path.\n   * @internal\n   */\n  setHighlightPath(highlightPath: string) {\n    this.svgPathLight.setAttribute('d', highlightPath);\n  }\n\n  override flipRTL() {\n    // Mirror the block's path.\n    this.svgPath.setAttribute('transform', 'scale(-1 1)');\n    this.svgPathLight.setAttribute('transform', 'scale(-1 1)');\n    this.svgPathDark.setAttribute('transform', 'translate(1,1) scale(-1 1)');\n  }\n\n  override applyColour(block: BlockSvg) {\n    this.svgPathLight.style.display = '';\n    this.svgPathDark.style.display = '';\n    this.svgPathLight.setAttribute('stroke', this.style.colourTertiary);\n    this.svgPathDark.setAttribute('fill', this.colourDark);\n\n    super.applyColour(block);\n\n    this.svgPath.setAttribute('stroke', 'none');\n  }\n\n  override setStyle(blockStyle: BlockStyle) {\n    this.style = blockStyle;\n    this.colourDark =\n        colour.blend('#000', this.style.colourPrimary, 0.2) || this.colourDark;\n  }\n\n  override updateHighlighted(highlighted: boolean) {\n    if (highlighted) {\n      this.svgPath.setAttribute(\n          'filter', 'url(#' + this.constants.embossFilterId + ')');\n      this.svgPathLight.style.display = 'none';\n    } else {\n      this.svgPath.setAttribute('filter', 'none');\n      this.svgPathLight.style.display = 'inline';\n    }\n  }\n\n  override updateShadow_(shadow: boolean) {\n    if (shadow) {\n      this.svgPathLight.style.display = 'none';\n      this.svgPathDark.setAttribute('fill', this.style.colourSecondary);\n      this.svgPath.setAttribute('stroke', 'none');\n      this.svgPath.setAttribute('fill', this.style.colourSecondary);\n    }\n  }\n\n  override updateDisabled_(disabled: boolean) {\n    super.updateDisabled_(disabled);\n    if (disabled) {\n      this.svgPath.setAttribute('stroke', 'none');\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Geras renderer.\n *\n * @class\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.Renderer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {BlockStyle, Theme} from '../../theme.js';\nimport * as blockRendering from '../common/block_rendering.js';\nimport type {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport {Renderer as BaseRenderer} from '../common/renderer.js';\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {HighlightConstantProvider} from './highlight_constants.js';\nimport {RenderInfo} from './info.js';\nimport {PathObject} from './path_object.js';\n\n\n/**\n * The geras renderer.\n *\n * @alias Blockly.geras.Renderer\n */\nexport class Renderer extends BaseRenderer {\n  /** The renderer's highlight constant provider. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'HighlightConstantProvider'.\n  private highlightConstants_: HighlightConstantProvider =\n      null as AnyDuringMigration;\n\n  /**\n   * @param name The renderer name.\n   * @internal\n   */\n  constructor(name: string) {\n    super(name);\n  }\n\n  /**\n   * Initialize the renderer.  Geras has a highlight provider in addition to\n   * the normal constant provider.\n   *\n   * @internal\n   */\n  override init(\n      theme: Theme, opt_rendererOverrides?: {[rendererConstant: string]: any}) {\n    super.init(theme, opt_rendererOverrides);\n    this.highlightConstants_ = this.makeHighlightConstants_();\n    this.highlightConstants_.init();\n  }\n\n  override refreshDom(svg: SVGElement, theme: Theme) {\n    super.refreshDom(svg, theme);\n    this.getHighlightConstants().init();\n  }\n\n  override makeConstants_() {\n    return new ConstantProvider();\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected override makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n\n  /**\n   * Create a new instance of the renderer's drawer.\n   *\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @returns The drawer.\n   */\n  protected override makeDrawer_(block: BlockSvg, info: BaseRenderInfo):\n      Drawer {\n    return new Drawer(block, (info as RenderInfo));\n  }\n\n  /**\n   * Create a new instance of a renderer path object.\n   *\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @returns The renderer path object.\n   * @internal\n   */\n  override makePathObject(root: SVGElement, style: BlockStyle): PathObject {\n    return new PathObject(\n        root, style, (this.getConstants() as ConstantProvider));\n  }\n\n  /**\n   * Create a new instance of the renderer's highlight constant provider.\n   *\n   * @returns The highlight constant provider.\n   */\n  protected makeHighlightConstants_(): HighlightConstantProvider {\n    return new HighlightConstantProvider((this.getConstants()));\n  }\n\n  /**\n   * Get the renderer's highlight constant provider.  We assume that when this\n   * is called, the renderer has already been initialized.\n   *\n   * @returns The highlight constant provider.\n   * @internal\n   */\n  getHighlightConstants(): HighlightConstantProvider {\n    return this.highlightConstants_;\n  }\n}\n\nblockRendering.register('geras', Renderer);\n","/** @file Re-exports of Blockly.geras.* modules. */\n\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Re-exports of Blockly.geras.* modules.\n *\n * @namespace Blockly.geras\n */\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras');\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {HighlightConstantProvider} from './highlight_constants.js';\nimport {Highlighter} from './highlighter.js';\nimport {RenderInfo} from './info.js';\nimport {InlineInput} from './measurables/inline_input.js';\nimport {StatementInput} from './measurables/statement_input.js';\nimport {PathObject} from './path_object.js';\nimport {Renderer} from './renderer.js';\n\n\nexport {\n  ConstantProvider,\n  Drawer,\n  HighlightConstantProvider,\n  Highlighter,\n  InlineInput,\n  PathObject,\n  Renderer,\n  RenderInfo,\n  StatementInput,\n};\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An SVG that floats on top of the workspace.\n * Blocks are moved into this SVG during a drag, improving performance.\n * The entire SVG is translated using CSS translation instead of SVG so the\n * blocks are never repainted during drag improving performance.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.WorkspaceDragSurfaceSvg');\n\nimport type {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\n\n\n/**\n * Blocks are moved into this SVG during a drag, improving performance.\n * The entire SVG is translated using CSS transforms instead of SVG so the\n * blocks are never repainted during drag improving performance.\n *\n * @alias Blockly.WorkspaceDragSurfaceSvg\n */\nexport class WorkspaceDragSurfaceSvg {\n  /**\n   * The SVG drag surface. Set once by WorkspaceDragSurfaceSvg.createDom.\n   */\n  private SVG!: SVGElement;\n\n  /**\n   * The element to insert the block canvas and bubble canvas after when it\n   * goes back in the DOM at the end of a drag.\n   */\n  private previousSibling: Element|null = null;\n\n  /** @param container Containing element. */\n  constructor(private readonly container: Element) {\n    this.createDom();\n  }\n\n  /** Create the drag surface and inject it into the container. */\n  createDom() {\n    if (this.SVG) {\n      return;  // Already created.\n    }\n    /**\n     * Dom structure when the workspace is being dragged. If there is no drag in\n     * progress, the SVG is empty and display: none.\n     * <svg class=\"blocklyWsDragSurface\" style=transform:translate3d(...)>\n     *   <g class=\"blocklyBlockCanvas\"></g>\n     *   <g class=\"blocklyBubbleCanvas\">/g>\n     * </svg>\n     */\n    this.SVG = dom.createSvgElement(Svg.SVG, {\n      'xmlns': dom.SVG_NS,\n      'xmlns:html': dom.HTML_NS,\n      'xmlns:xlink': dom.XLINK_NS,\n      'version': '1.1',\n      'class': 'blocklyWsDragSurface blocklyOverflowVisible',\n    });\n    this.container.appendChild(this.SVG);\n  }\n\n  /**\n   * Translate the entire drag surface during a drag.\n   * We translate the drag surface instead of the blocks inside the surface\n   * so that the browser avoids repainting the SVG.\n   * Because of this, the drag coordinates must be adjusted by scale.\n   *\n   * @param x X translation for the entire surface\n   * @param y Y translation for the entire surface\n   * @internal\n   */\n  translateSurface(x: number, y: number) {\n    // Make sure the svg exists on a pixel boundary so that it is not fuzzy.\n    const fixedX = Math.round(x);\n    const fixedY = Math.round(y);\n\n    this.SVG.style.display = 'block';\n    dom.setCssTransform(\n        this.SVG, 'translate3d(' + fixedX + 'px, ' + fixedY + 'px, 0)');\n  }\n\n  /**\n   * Reports the surface translation in scaled workspace coordinates.\n   * Use this when finishing a drag to return blocks to the correct position.\n   *\n   * @returns Current translation of the surface\n   * @internal\n   */\n  getSurfaceTranslation(): Coordinate {\n    return svgMath.getRelativeXY((this.SVG));\n  }\n\n  /**\n   * Move the blockCanvas and bubbleCanvas out of the surface SVG and on to\n   * newSurface.\n   *\n   * @param newSurface The element to put the drag surface contents into.\n   * @internal\n   */\n  clearAndHide(newSurface: SVGElement) {\n    if (!newSurface) {\n      throw Error(\n          'Couldn\\'t clear and hide the drag surface: missing new surface.');\n    }\n    const blockCanvas = this.SVG.childNodes[0] as Element;\n    const bubbleCanvas = this.SVG.childNodes[1] as Element;\n    if (!blockCanvas || !bubbleCanvas ||\n        !dom.hasClass(blockCanvas, 'blocklyBlockCanvas') ||\n        !dom.hasClass(bubbleCanvas, 'blocklyBubbleCanvas')) {\n      throw Error(\n          'Couldn\\'t clear and hide the drag surface. A node was missing.');\n    }\n\n    // If there is a previous sibling, put the blockCanvas back right\n    // afterwards, otherwise insert it as the first child node in newSurface.\n    if (this.previousSibling !== null) {\n      dom.insertAfter(blockCanvas, this.previousSibling);\n    } else {\n      newSurface.insertBefore(blockCanvas, newSurface.firstChild);\n    }\n\n    // Reattach the bubble canvas after the blockCanvas.\n    dom.insertAfter(bubbleCanvas, blockCanvas);\n    // Hide the drag surface.\n    this.SVG.style.display = 'none';\n    if (this.SVG.childNodes.length) {\n      throw Error('Drag surface was not cleared.');\n    }\n    dom.setCssTransform(this.SVG, '');\n    this.previousSibling = null;\n  }\n\n  /**\n   * Set the SVG to have the block canvas and bubble canvas in it and then\n   * show the surface.\n   *\n   * @param blockCanvas The block canvas <g> element from the\n   *     workspace.\n   * @param bubbleCanvas The <g> element that contains the\n     bubbles.\n   * @param previousSibling The element to insert the block canvas and\n           bubble canvas after when it goes back in the DOM at the end of a\n     drag.\n   * @param width The width of the workspace SVG element.\n   * @param height The height of the workspace SVG element.\n   * @param scale The scale of the workspace being dragged.\n   * @internal\n   */\n  setContentsAndShow(\n      blockCanvas: SVGElement, bubbleCanvas: SVGElement,\n      previousSibling: Element, width: number, height: number, scale: number) {\n    if (this.SVG.childNodes.length) {\n      throw Error('Already dragging a block.');\n    }\n    this.previousSibling = previousSibling;\n    // Make sure the blocks and bubble canvas are scaled appropriately.\n    blockCanvas.setAttribute(\n        'transform', 'translate(0, 0) scale(' + scale + ')');\n    bubbleCanvas.setAttribute(\n        'transform', 'translate(0, 0) scale(' + scale + ')');\n    this.SVG.setAttribute('width', String(width));\n    this.SVG.setAttribute('height', String(height));\n    this.SVG.appendChild(blockCanvas);\n    this.SVG.appendChild(bubbleCanvas);\n    this.SVG.style.display = 'block';\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A class that manages a surface for dragging blocks.  When a\n * block drag is started, we move the block (and children) to a separate DOM\n * element that we move around using translate3d. At the end of the drag, the\n * blocks are put back in into the SVG they came from. This helps\n * performance by avoiding repainting the entire SVG on every mouse move\n * while dragging blocks.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.BlockDragSurfaceSvg');\n\nimport {Coordinate} from './utils/coordinate.js';\nimport * as deprecation from './utils/deprecation.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\n\n\n/**\n * Class for a drag surface for the currently dragged block. This is a separate\n * SVG that contains only the currently moving block, or nothing.\n *\n * @alias Blockly.BlockDragSurfaceSvg\n */\nexport class BlockDragSurfaceSvg {\n  /** The SVG drag surface. Set once by BlockDragSurfaceSvg.createDom. */\n  private svg_: SVGElement;\n\n  /**\n   * This is where blocks live while they are being dragged if the drag\n   * surface is enabled.\n   */\n  private dragGroup_: SVGElement;\n\n  /**\n   * Cached value for the scale of the drag surface.\n   * Used to set/get the correct translation during and after a drag.\n   */\n  private scale_ = 1;\n\n  /**\n   * Cached value for the translation of the drag surface.\n   * This translation is in pixel units, because the scale is applied to the\n   * drag group rather than the top-level SVG.\n   */\n  private surfaceXY_: Coordinate = new Coordinate(0, 0);\n  private readonly childSurfaceXY_: Coordinate;\n\n  /** @param container Containing element. */\n  constructor(private readonly container: Element) {\n    /**\n     * Cached value for the translation of the child drag surface in pixel\n     * units. Since the child drag surface tracks the translation of the\n     * workspace this is ultimately the translation of the workspace.\n     */\n    this.childSurfaceXY_ = new Coordinate(0, 0);\n\n    this.svg_ = dom.createSvgElement(\n        Svg.SVG, {\n          'xmlns': dom.SVG_NS,\n          'xmlns:html': dom.HTML_NS,\n          'xmlns:xlink': dom.XLINK_NS,\n          'version': '1.1',\n          'class': 'blocklyBlockDragSurface',\n        },\n        this.container);\n    this.dragGroup_ = dom.createSvgElement(Svg.G, {}, this.svg_ as SVGElement);\n  }\n\n  /** Create the drag surface and inject it into the container. */\n  createDom() {\n    // No alternative provided, because now the dom is just automatically\n    // created in the constructor now.\n    deprecation.warn('BlockDragSurfaceSvg createDom', 'June 2022', 'June 2023');\n  }\n\n  /**\n   * Set the SVG blocks on the drag surface's group and show the surface.\n   * Only one block group should be on the drag surface at a time.\n   *\n   * @param blocks Block or group of blocks to place on the drag surface.\n   */\n  setBlocksAndShow(blocks: SVGElement) {\n    if (this.dragGroup_.childNodes.length) {\n      throw Error('Already dragging a block.');\n    }\n    // appendChild removes the blocks from the previous parent\n    this.dragGroup_.appendChild(blocks);\n    this.svg_.style.display = 'block';\n    this.surfaceXY_ = new Coordinate(0, 0);\n  }\n\n  /**\n   * Translate and scale the entire drag surface group to the given position, to\n   * keep in sync with the workspace.\n   *\n   * @param x X translation in pixel coordinates.\n   * @param y Y translation in pixel coordinates.\n   * @param scale Scale of the group.\n   */\n  translateAndScaleGroup(x: number, y: number, scale: number) {\n    this.scale_ = scale;\n    // Make sure the svg exists on a pixel boundary so that it is not fuzzy.\n    const roundX = Math.round(x);\n    const roundY = Math.round(y);\n    this.childSurfaceXY_.x = roundX;\n    this.childSurfaceXY_.y = roundY;\n    this.dragGroup_!.setAttribute(\n        'transform',\n        'translate(' + roundX + ',' + roundY + ') scale(' + scale + ')');\n  }\n\n  /**\n   * Translate the drag surface's SVG based on its internal state.\n   *\n   * @internal\n   */\n  translateSurfaceInternal_() {\n    let x = this.surfaceXY_!.x;\n    let y = this.surfaceXY_!.y;\n    // Make sure the svg exists on a pixel boundary so that it is not fuzzy.\n    x = Math.round(x);\n    y = Math.round(y);\n    this.svg_.style.display = 'block';\n    dom.setCssTransform(this.svg_, 'translate3d(' + x + 'px, ' + y + 'px, 0)');\n  }\n\n  /**\n   * Translates the entire surface by a relative offset.\n   *\n   * @param deltaX Horizontal offset in pixel units.\n   * @param deltaY Vertical offset in pixel units.\n   */\n  translateBy(deltaX: number, deltaY: number) {\n    const x = this.surfaceXY_.x + deltaX;\n    const y = this.surfaceXY_.y + deltaY;\n    this.surfaceXY_ = new Coordinate(x, y);\n    this.translateSurfaceInternal_();\n  }\n\n  /**\n   * Translate the entire drag surface during a drag.\n   * We translate the drag surface instead of the blocks inside the surface\n   * so that the browser avoids repainting the SVG.\n   * Because of this, the drag coordinates must be adjusted by scale.\n   *\n   * @param x X translation for the entire surface.\n   * @param y Y translation for the entire surface.\n   */\n  translateSurface(x: number, y: number) {\n    this.surfaceXY_ = new Coordinate(x * this.scale_, y * this.scale_);\n    this.translateSurfaceInternal_();\n  }\n\n  /**\n   * Reports the surface translation in scaled workspace coordinates.\n   * Use this when finishing a drag to return blocks to the correct position.\n   *\n   * @returns Current translation of the surface.\n   */\n  getSurfaceTranslation(): Coordinate {\n    const xy = svgMath.getRelativeXY(this.svg_ as SVGElement);\n    return new Coordinate(xy.x / this.scale_, xy.y / this.scale_);\n  }\n\n  /**\n   * Provide a reference to the drag group (primarily for\n   * BlockSvg.getRelativeToSurfaceXY).\n   *\n   * @returns Drag surface group element.\n   */\n  getGroup(): SVGElement|null {\n    return this.dragGroup_;\n  }\n\n  /**\n   * Returns the SVG drag surface.\n   *\n   * @returns The SVG drag surface.\n   */\n  getSvgRoot(): SVGElement|null {\n    return this.svg_;\n  }\n\n  /**\n   * Get the current blocks on the drag surface, if any (primarily\n   * for BlockSvg.getRelativeToSurfaceXY).\n   *\n   * @returns Drag surface block DOM element, or null if no blocks exist.\n   */\n  getCurrentBlock(): Element|null {\n    return this.dragGroup_.firstChild as Element;\n  }\n\n  /**\n   * Gets the translation of the child block surface\n   * This surface is in charge of keeping track of how much the workspace has\n   * moved.\n   *\n   * @returns The amount the workspace has been moved.\n   */\n  getWsTranslation(): Coordinate {\n    // Returning a copy so the coordinate can not be changed outside this class.\n    return this.childSurfaceXY_.clone();\n  }\n\n  /**\n   * Clear the group and hide the surface; move the blocks off onto the provided\n   * element.\n   * If the block is being deleted it doesn't need to go back to the original\n   * surface, since it would be removed immediately during dispose.\n   *\n   * @param opt_newSurface Surface the dragging blocks should be moved to, or\n   *     null if the blocks should be removed from this surface without being\n   *     moved to a different surface.\n   */\n  clearAndHide(opt_newSurface?: Element) {\n    const currentBlockElement = this.getCurrentBlock();\n    if (currentBlockElement) {\n      if (opt_newSurface) {\n        // appendChild removes the node from this.dragGroup_\n        opt_newSurface.appendChild(currentBlockElement);\n      } else {\n        this.dragGroup_.removeChild(currentBlockElement);\n      }\n    }\n    this.svg_.style.display = 'none';\n    if (this.dragGroup_.childNodes.length) {\n      throw Error('Drag group was not cleared.');\n    }\n    this.surfaceXY_ = new Coordinate(0, 0);\n  }\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a pair of scrollbars.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ScrollbarPair');\n\nimport * as eventUtils from './events/utils.js';\nimport {Scrollbar} from './scrollbar.js';\nimport * as dom from './utils/dom.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Svg} from './utils/svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Class for a pair of scrollbars.  Horizontal and vertical.\n *\n * @alias Blockly.ScrollbarPair\n */\nexport class ScrollbarPair {\n  hScroll: Scrollbar|null = null;\n  vScroll: Scrollbar|null = null;\n  corner_: SVGRectElement|null = null;\n\n  /** Previously recorded metrics from the workspace. */\n  private oldHostMetrics_: Metrics|null = null;\n\n  /**\n   * @param workspace Workspace to bind the scrollbars to.\n   * @param addHorizontal Whether to add a horizontal scrollbar.\n   *    Defaults to true.\n   * @param addVertical Whether to add a vertical scrollbar. Defaults to true.\n   * @param opt_class A class to be applied to these scrollbars.\n   * @param opt_margin The margin to apply to these scrollbars.\n   */\n  constructor(\n      private workspace: WorkspaceSvg, addHorizontal?: boolean,\n      addVertical?: boolean, opt_class?: string, opt_margin?: number) {\n    addHorizontal = addHorizontal === undefined ? true : addHorizontal;\n    addVertical = addVertical === undefined ? true : addVertical;\n    const isPair = addHorizontal && addVertical;\n\n    if (addHorizontal) {\n      this.hScroll =\n          new Scrollbar(workspace, true, isPair, opt_class, opt_margin);\n    }\n    if (addVertical) {\n      this.vScroll =\n          new Scrollbar(workspace, false, isPair, opt_class, opt_margin);\n    }\n\n    if (isPair) {\n      this.corner_ = dom.createSvgElement(Svg.RECT, {\n        'height': Scrollbar.scrollbarThickness,\n        'width': Scrollbar.scrollbarThickness,\n        'class': 'blocklyScrollbarBackground',\n      });\n      dom.insertAfter(this.corner_, workspace.getBubbleCanvas());\n    }\n  }\n\n  /**\n   * Dispose of this pair of scrollbars.\n   * Unlink from all DOM elements to prevent memory leaks.\n   *\n   * @suppress {checkTypes}\n   */\n  dispose() {\n    dom.removeNode(this.corner_);\n    this.corner_ = null;\n    this.oldHostMetrics_ = null;\n    if (this.hScroll) {\n      this.hScroll.dispose();\n      this.hScroll = null;\n    }\n    if (this.vScroll) {\n      this.vScroll.dispose();\n      this.vScroll = null;\n    }\n  }\n\n  /**\n   * Recalculate both of the scrollbars' locations and lengths.\n   * Also reposition the corner rectangle.\n   */\n  resize() {\n    // Look up the host metrics once, and use for both scrollbars.\n    const hostMetrics = this.workspace.getMetrics();\n    if (!hostMetrics) {\n      // Host element is likely not visible.\n      return;\n    }\n\n    // Only change the scrollbars if there has been a change in metrics.\n    let resizeH = false;\n    let resizeV = false;\n    if (!this.oldHostMetrics_ ||\n        this.oldHostMetrics_.viewWidth !== hostMetrics.viewWidth ||\n        this.oldHostMetrics_.viewHeight !== hostMetrics.viewHeight ||\n        this.oldHostMetrics_.absoluteTop !== hostMetrics.absoluteTop ||\n        this.oldHostMetrics_.absoluteLeft !== hostMetrics.absoluteLeft) {\n      // The window has been resized or repositioned.\n      resizeH = true;\n      resizeV = true;\n    } else {\n      // Has the content been resized or moved?\n      if (!this.oldHostMetrics_ ||\n          this.oldHostMetrics_.scrollWidth !== hostMetrics.scrollWidth ||\n          this.oldHostMetrics_.viewLeft !== hostMetrics.viewLeft ||\n          this.oldHostMetrics_.scrollLeft !== hostMetrics.scrollLeft) {\n        resizeH = true;\n      }\n      if (!this.oldHostMetrics_ ||\n          this.oldHostMetrics_.scrollHeight !== hostMetrics.scrollHeight ||\n          this.oldHostMetrics_.viewTop !== hostMetrics.viewTop ||\n          this.oldHostMetrics_.scrollTop !== hostMetrics.scrollTop) {\n        resizeV = true;\n      }\n    }\n\n    if (resizeH || resizeV) {\n      try {\n        eventUtils.disable();\n        if (this.hScroll && resizeH) {\n          this.hScroll.resize(hostMetrics);\n        }\n        if (this.vScroll && resizeV) {\n          this.vScroll.resize(hostMetrics);\n        }\n      } finally {\n        eventUtils.enable();\n      }\n      this.workspace.maybeFireViewportChangeEvent();\n    }\n\n    if (this.hScroll && this.vScroll) {\n      // Reposition the corner square.\n      if (!this.oldHostMetrics_ ||\n          this.oldHostMetrics_.viewWidth !== hostMetrics.viewWidth ||\n          this.oldHostMetrics_.absoluteLeft !== hostMetrics.absoluteLeft) {\n        this.corner_?.setAttribute('x', String(this.vScroll.position.x));\n      }\n      if (!this.oldHostMetrics_ ||\n          this.oldHostMetrics_.viewHeight !== hostMetrics.viewHeight ||\n          this.oldHostMetrics_.absoluteTop !== hostMetrics.absoluteTop) {\n        this.corner_?.setAttribute('y', String(this.hScroll.position.y));\n      }\n    }\n\n    // Cache the current metrics to potentially short-cut the next resize event.\n    this.oldHostMetrics_ = hostMetrics;\n  }\n\n  /**\n   * Returns whether scrolling horizontally is enabled.\n   *\n   * @returns True if horizontal scroll is enabled.\n   */\n  canScrollHorizontally(): boolean {\n    return !!this.hScroll;\n  }\n\n  /**\n   * Returns whether scrolling vertically is enabled.\n   *\n   * @returns True if vertical scroll is enabled.\n   */\n  canScrollVertically(): boolean {\n    return !!this.vScroll;\n  }\n\n  /**\n   * Record the origin of the workspace that the scrollbar is in, in pixels\n   * relative to the injection div origin. This is for times when the scrollbar\n   * is used in an object whose origin isn't the same as the main workspace\n   * (e.g. in a flyout.)\n   *\n   * @param x The x coordinate of the scrollbar's origin, in CSS pixels.\n   * @param y The y coordinate of the scrollbar's origin, in CSS pixels.\n   * @internal\n   */\n  setOrigin(x: number, y: number) {\n    if (this.hScroll) {\n      this.hScroll.setOrigin(x, y);\n    }\n    if (this.vScroll) {\n      this.vScroll.setOrigin(x, y);\n    }\n  }\n\n  /**\n   * Set the handles of both scrollbars.\n   *\n   * @param x The horizontal content displacement, relative to the view in\n   *     pixels.\n   * @param y The vertical content displacement, relative to the view in pixels.\n   * @param updateMetrics Whether to update metrics on this set call.\n   *    Defaults to true.\n   */\n  set(x: number, y: number, updateMetrics: boolean) {\n    // This function is equivalent to:\n    //   this.hScroll.set(x);\n    //   this.vScroll.set(y);\n    // However, that calls setMetrics twice which causes a chain of\n    // getAttribute->setAttribute->getAttribute resulting in an extra layout\n    // pass. Combining them speeds up rendering.\n    if (this.hScroll) {\n      this.hScroll.set(x, false);\n    }\n    if (this.vScroll) {\n      this.vScroll.set(y, false);\n    }\n\n    if (updateMetrics || updateMetrics === undefined) {\n      // Update metrics.\n      const xyRatio: {x?: number, y?: number} = {};\n      if (this.hScroll) {\n        xyRatio.x = this.hScroll.getRatio_();\n      }\n      if (this.vScroll) {\n        xyRatio.y = this.vScroll.getRatio_();\n      }\n      this.workspace.setMetrics(xyRatio);\n    }\n  }\n\n  /**\n   * Set the handle of the horizontal scrollbar to be at a certain position in\n   *    CSS pixels relative to its parents.\n   *\n   * @param x Horizontal scroll value.\n   */\n  setX(x: number) {\n    if (this.hScroll) {\n      this.hScroll.set(x, true);\n    }\n  }\n\n  /**\n   * Set the handle of the vertical scrollbar to be at a certain position in\n   *    CSS pixels relative to its parents.\n   *\n   * @param y Vertical scroll value.\n   */\n  setY(y: number) {\n    if (this.vScroll) {\n      this.vScroll.set(y, true);\n    }\n  }\n\n  /**\n   * Set whether this scrollbar's container is visible.\n   *\n   * @param visible Whether the container is visible.\n   */\n  setContainerVisible(visible: boolean) {\n    if (this.hScroll) {\n      this.hScroll.setContainerVisible(visible);\n    }\n    if (this.vScroll) {\n      this.vScroll.setContainerVisible(visible);\n    }\n  }\n\n  /**\n   * If any of the scrollbars are visible. Non-paired scrollbars may disappear\n   * when they aren't needed.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    let isVisible = false;\n    if (this.hScroll) {\n      isVisible = this.hScroll.isVisible();\n    }\n    if (this.vScroll) {\n      isVisible = isVisible || this.vScroll.isVisible();\n    }\n    return isVisible;\n  }\n\n  /**\n   * Recalculates the scrollbars' locations within their path and length.\n   * This should be called when the contents of the workspace have changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeContent(hostMetrics: Metrics) {\n    if (this.hScroll) {\n      this.hScroll.resizeContentHorizontal(hostMetrics);\n    }\n    if (this.vScroll) {\n      this.vScroll.resizeContentVertical(hostMetrics);\n    }\n  }\n\n  /**\n   * Recalculates the scrollbars' locations on the screen and path length.\n   * This should be called when the layout or size of the window has changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeView(hostMetrics: Metrics) {\n    if (this.hScroll) {\n      this.hScroll.resizeViewHorizontal(hostMetrics);\n    }\n    if (this.vScroll) {\n      this.vScroll.resizeViewVertical(hostMetrics);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility functions for generating executable code from\n * Blockly code.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Generator');\n\nimport type {Block} from './block.js';\nimport * as common from './common.js';\nimport {Names, NameType} from './names.js';\nimport * as deprecation from './utils/deprecation.js';\nimport type {Workspace} from './workspace.js';\n\n\n/**\n * Class for a code generator that translates the blocks into a language.\n *\n * @unrestricted\n * @alias Blockly.Generator\n */\nexport class Generator {\n  name_: string;\n\n  /**\n   * This is used as a placeholder in functions defined using\n   * Generator.provideFunction_.  It must not be legal code that could\n   * legitimately appear in a function definition (or comment), and it must\n   * not confuse the regular expression parser.\n   */\n  protected FUNCTION_NAME_PLACEHOLDER_ = '{leCUI8hutHZI4480Dc}';\n  FUNCTION_NAME_PLACEHOLDER_REGEXP_: RegExp;\n\n  /**\n   * Arbitrary code to inject into locations that risk causing infinite loops.\n   * Any instances of '%1' will be replaced by the block ID that failed.\n   * E.g. `  checkTimeout(%1);\\n`\n   */\n  INFINITE_LOOP_TRAP: string|null = null;\n\n  /**\n   * Arbitrary code to inject before every statement.\n   * Any instances of '%1' will be replaced by the block ID of the statement.\n   * E.g. `highlight(%1);\\n`\n   */\n  STATEMENT_PREFIX: string|null = null;\n\n  /**\n   * Arbitrary code to inject after every statement.\n   * Any instances of '%1' will be replaced by the block ID of the statement.\n   * E.g. `highlight(%1);\\n`\n   */\n  STATEMENT_SUFFIX: string|null = null;\n\n  /**\n   * The method of indenting.  Defaults to two spaces, but language generators\n   * may override this to increase indent or change to tabs.\n   */\n  INDENT = '  ';\n\n  /**\n   * Maximum length for a comment before wrapping.  Does not account for\n   * indenting level.\n   */\n  COMMENT_WRAP = 60;\n\n  /** List of outer-inner pairings that do NOT require parentheses. */\n  ORDER_OVERRIDES: number[][] = [];\n\n  /**\n   * Whether the init method has been called.\n   * Generators that set this flag to false after creation and true in init\n   * will cause blockToCode to emit a warning if the generator has not been\n   * initialized. If this flag is untouched, it will have no effect.\n   */\n  isInitialized: boolean|null = null;\n\n  /** Comma-separated list of reserved words. */\n  protected RESERVED_WORDS_ = '';\n\n  /** A dictionary of definitions to be printed before the code. */\n  protected definitions_: {[key: string]: string} = Object.create(null);\n\n  /**\n   * A dictionary mapping desired function names in definitions_ to actual\n   * function names (to avoid collisions with user functions).\n   */\n  protected functionNames_: {[key: string]: string} = Object.create(null);\n\n  /** A database of variable and procedure names. */\n  protected nameDB_?: Names = undefined;\n\n  /** @param name Language name of this generator. */\n  constructor(name: string) {\n    this.name_ = name;\n\n    this.FUNCTION_NAME_PLACEHOLDER_REGEXP_ =\n        new RegExp(this.FUNCTION_NAME_PLACEHOLDER_, 'g');\n  }\n\n  /**\n   * Generate code for all blocks in the workspace to the specified language.\n   *\n   * @param workspace Workspace to generate code from.\n   * @returns Generated code.\n   */\n  workspaceToCode(workspace?: Workspace): string {\n    if (!workspace) {\n      // Backwards compatibility from before there could be multiple workspaces.\n      console.warn(\n          'No workspace specified in workspaceToCode call.  Guessing.');\n      workspace = common.getMainWorkspace();\n    }\n    const code = [];\n    this.init(workspace);\n    const blocks = workspace.getTopBlocks(true);\n    for (let i = 0, block; block = blocks[i]; i++) {\n      let line = this.blockToCode(block);\n      if (Array.isArray(line)) {\n        // Value blocks return tuples of code and operator order.\n        // Top-level blocks don't care about operator order.\n        line = line[0];\n      }\n      if (line) {\n        if (block.outputConnection) {\n          // This block is a naked value.  Ask the language's code generator if\n          // it wants to append a semicolon, or something.\n          line = this.scrubNakedValue(line);\n          if (this.STATEMENT_PREFIX && !block.suppressPrefixSuffix) {\n            line = this.injectId(this.STATEMENT_PREFIX, block) + line;\n          }\n          if (this.STATEMENT_SUFFIX && !block.suppressPrefixSuffix) {\n            line = line + this.injectId(this.STATEMENT_SUFFIX, block);\n          }\n        }\n        code.push(line);\n      }\n    }\n    // Blank line between each section.\n    let codeString = code.join('\\n');\n    codeString = this.finish(codeString);\n    // Final scrubbing of whitespace.\n    codeString = codeString.replace(/^\\s+\\n/, '');\n    codeString = codeString.replace(/\\n\\s+$/, '\\n');\n    codeString = codeString.replace(/[ \\t]+\\n/g, '\\n');\n    return codeString;\n  }\n\n  // The following are some helpful functions which can be used by multiple\n\n  // languages.\n\n  /**\n   * Prepend a common prefix onto each line of code.\n   * Intended for indenting code or adding comment markers.\n   *\n   * @param text The lines of code.\n   * @param prefix The common prefix.\n   * @returns The prefixed lines of code.\n   */\n  prefixLines(text: string, prefix: string): string {\n    return prefix + text.replace(/(?!\\n$)\\n/g, '\\n' + prefix);\n  }\n\n  /**\n   * Recursively spider a tree of blocks, returning all their comments.\n   *\n   * @param block The block from which to start spidering.\n   * @returns Concatenated list of comments.\n   */\n  allNestedComments(block: Block): string {\n    const comments = [];\n    const blocks = block.getDescendants(true);\n    for (let i = 0; i < blocks.length; i++) {\n      const comment = blocks[i].getCommentText();\n      if (comment) {\n        comments.push(comment);\n      }\n    }\n    // Append an empty string to create a trailing line break when joined.\n    if (comments.length) {\n      comments.push('');\n    }\n    return comments.join('\\n');\n  }\n\n  /**\n   * Generate code for the specified block (and attached blocks).\n   * The generator must be initialized before calling this function.\n   *\n   * @param block The block to generate code for.\n   * @param opt_thisOnly True to generate code for only this statement.\n   * @returns For statement blocks, the generated code.\n   *     For value blocks, an array containing the generated code and an\n   * operator order value.  Returns '' if block is null.\n   */\n  blockToCode(block: Block|null, opt_thisOnly?: boolean): string\n      |[string, number] {\n    if (this.isInitialized === false) {\n      console.warn(\n          'Generator init was not called before blockToCode was called.');\n    }\n    if (!block) {\n      return '';\n    }\n    if (!block.isEnabled()) {\n      // Skip past this block if it is disabled.\n      return opt_thisOnly ? '' : this.blockToCode(block.getNextBlock());\n    }\n    if (block.isInsertionMarker()) {\n      // Skip past insertion markers.\n      return opt_thisOnly ? '' : this.blockToCode(block.getChildren(false)[0]);\n    }\n\n    const func = (this as any)[block.type];\n    if (typeof func !== 'function') {\n      throw Error(\n          'Language \"' + this.name_ + '\" does not know how to generate ' +\n          'code for block type \"' + block.type + '\".');\n    }\n    // First argument to func.call is the value of 'this' in the generator.\n    // Prior to 24 September 2013 'this' was the only way to access the block.\n    // The current preferred method of accessing the block is through the second\n    // argument to func.call, which becomes the first parameter to the\n    // generator.\n    let code = func.call(block, block);\n    if (Array.isArray(code)) {\n      // Value blocks return tuples of code and operator order.\n      if (!block.outputConnection) {\n        throw TypeError('Expecting string from statement block: ' + block.type);\n      }\n      return [this.scrub_(block, code[0], opt_thisOnly), code[1]];\n    } else if (typeof code === 'string') {\n      if (this.STATEMENT_PREFIX && !block.suppressPrefixSuffix) {\n        code = this.injectId(this.STATEMENT_PREFIX, block) + code;\n      }\n      if (this.STATEMENT_SUFFIX && !block.suppressPrefixSuffix) {\n        code = code + this.injectId(this.STATEMENT_SUFFIX, block);\n      }\n      return this.scrub_(block, code, opt_thisOnly);\n    } else if (code === null) {\n      // Block has handled code generation itself.\n      return '';\n    }\n    throw SyntaxError('Invalid code generated: ' + code);\n  }\n\n  /**\n   * Generate code representing the specified value input.\n   *\n   * @param block The block containing the input.\n   * @param name The name of the input.\n   * @param outerOrder The maximum binding strength (minimum order value) of any\n   *     operators adjacent to \"block\".\n   * @returns Generated code or '' if no blocks are connected or the specified\n   *     input does not exist.\n   */\n  valueToCode(block: Block, name: string, outerOrder: number): string {\n    if (isNaN(outerOrder)) {\n      throw TypeError('Expecting valid order from block: ' + block.type);\n    }\n    const targetBlock = block.getInputTargetBlock(name);\n    if (!targetBlock) {\n      return '';\n    }\n    const tuple = this.blockToCode(targetBlock);\n    if (tuple === '') {\n      // Disabled block.\n      return '';\n    }\n    // Value blocks must return code and order of operations info.\n    // Statement blocks must only return code.\n    if (!Array.isArray(tuple)) {\n      throw TypeError('Expecting tuple from value block: ' + targetBlock.type);\n    }\n    let code = tuple[0];\n    const innerOrder = tuple[1];\n    if (isNaN(innerOrder)) {\n      throw TypeError(\n          'Expecting valid order from value block: ' + targetBlock.type);\n    }\n    if (!code) {\n      return '';\n    }\n\n    // Add parentheses if needed.\n    let parensNeeded = false;\n    const outerOrderClass = Math.floor(outerOrder);\n    const innerOrderClass = Math.floor(innerOrder);\n    if (outerOrderClass <= innerOrderClass) {\n      if (outerOrderClass === innerOrderClass &&\n          (outerOrderClass === 0 || outerOrderClass === 99)) {\n        // Don't generate parens around NONE-NONE and ATOMIC-ATOMIC pairs.\n        // 0 is the atomic order, 99 is the none order.  No parentheses needed.\n        // In all known languages multiple such code blocks are not order\n        // sensitive.  In fact in Python ('a' 'b') 'c' would fail.\n      } else {\n        // The operators outside this code are stronger than the operators\n        // inside this code.  To prevent the code from being pulled apart,\n        // wrap the code in parentheses.\n        parensNeeded = true;\n        // Check for special exceptions.\n        for (let i = 0; i < this.ORDER_OVERRIDES.length; i++) {\n          if (this.ORDER_OVERRIDES[i][0] === outerOrder &&\n              this.ORDER_OVERRIDES[i][1] === innerOrder) {\n            parensNeeded = false;\n            break;\n          }\n        }\n      }\n    }\n    if (parensNeeded) {\n      // Technically, this should be handled on a language-by-language basis.\n      // However all known (sane) languages use parentheses for grouping.\n      code = '(' + code + ')';\n    }\n    return code;\n  }\n\n  /**\n   * Generate a code string representing the blocks attached to the named\n   * statement input. Indent the code.\n   * This is mainly used in generators. When trying to generate code to evaluate\n   * look at using workspaceToCode or blockToCode.\n   *\n   * @param block The block containing the input.\n   * @param name The name of the input.\n   * @returns Generated code or '' if no blocks are connected.\n   */\n  statementToCode(block: Block, name: string): string {\n    const targetBlock = block.getInputTargetBlock(name);\n    let code = this.blockToCode(targetBlock);\n    // Value blocks must return code and order of operations info.\n    // Statement blocks must only return code.\n    if (typeof code !== 'string') {\n      throw TypeError(\n          'Expecting code from statement block: ' +\n          (targetBlock && targetBlock.type));\n    }\n    if (code) {\n      code = this.prefixLines((code), this.INDENT);\n    }\n    return code;\n  }\n\n  /**\n   * Add an infinite loop trap to the contents of a loop.\n   * Add statement suffix at the start of the loop block (right after the loop\n   * statement executes), and a statement prefix to the end of the loop block\n   * (right before the loop statement executes).\n   *\n   * @param branch Code for loop contents.\n   * @param block Enclosing block.\n   * @returns Loop contents, with infinite loop trap added.\n   */\n  addLoopTrap(branch: string, block: Block): string {\n    if (this.INFINITE_LOOP_TRAP) {\n      branch = this.prefixLines(\n                   this.injectId(this.INFINITE_LOOP_TRAP, block), this.INDENT) +\n          branch;\n    }\n    if (this.STATEMENT_SUFFIX && !block.suppressPrefixSuffix) {\n      branch = this.prefixLines(\n                   this.injectId(this.STATEMENT_SUFFIX, block), this.INDENT) +\n          branch;\n    }\n    if (this.STATEMENT_PREFIX && !block.suppressPrefixSuffix) {\n      branch = branch +\n          this.prefixLines(\n              this.injectId(this.STATEMENT_PREFIX, block), this.INDENT);\n    }\n    return branch;\n  }\n\n  /**\n   * Inject a block ID into a message to replace '%1'.\n   * Used for STATEMENT_PREFIX, STATEMENT_SUFFIX, and INFINITE_LOOP_TRAP.\n   *\n   * @param msg Code snippet with '%1'.\n   * @param block Block which has an ID.\n   * @returns Code snippet with ID.\n   */\n  injectId(msg: string, block: Block): string {\n    const id = block.id.replace(/\\$/g, '$$$$');  // Issue 251.\n    return msg.replace(/%1/g, '\\'' + id + '\\'');\n  }\n\n  /**\n   * Add one or more words to the list of reserved words for this language.\n   *\n   * @param words Comma-separated list of words to add to the list.\n   *     No spaces.  Duplicates are ok.\n   */\n  addReservedWords(words: string) {\n    this.RESERVED_WORDS_ += words + ',';\n  }\n\n  /**\n   * Define a developer-defined function (not a user-defined procedure) to be\n   * included in the generated code.  Used for creating private helper\n   * functions. The first time this is called with a given desiredName, the code\n   * is saved and an actual name is generated.  Subsequent calls with the same\n   * desiredName have no effect but have the same return value.\n   *\n   * It is up to the caller to make sure the same desiredName is not\n   * used for different helper functions (e.g. use \"colourRandom\" and\n   * \"listRandom\", not \"random\").  There is no danger of colliding with reserved\n   * words, or user-defined variable or procedure names.\n   *\n   * The code gets output when Generator.finish() is called.\n   *\n   * @param desiredName The desired name of the function (e.g. mathIsPrime).\n   * @param code A list of statements or one multi-line code string.  Use '  '\n   *     for indents (they will be replaced).\n   * @returns The actual name of the new function.  This may differ from\n   *     desiredName if the former has already been taken by the user.\n   */\n  protected provideFunction_(desiredName: string, code: string[]|string):\n      string {\n    if (!this.definitions_[desiredName]) {\n      const functionName =\n          this.nameDB_!.getDistinctName(desiredName, NameType.PROCEDURE);\n      this.functionNames_[desiredName] = functionName;\n      if (Array.isArray(code)) {\n        code = code.join('\\n');\n      }\n      let codeText = code.trim().replace(\n          this.FUNCTION_NAME_PLACEHOLDER_REGEXP_, functionName);\n      // Change all '  ' indents into the desired indent.\n      // To avoid an infinite loop of replacements, change all indents to '\\0'\n      // character first, then replace them all with the indent.\n      // We are assuming that no provided functions contain a literal null char.\n      let oldCodeText;\n      while (oldCodeText !== codeText) {\n        oldCodeText = codeText;\n        codeText = codeText.replace(/^(( {2})*) {2}/gm, '$1\\0');\n      }\n      codeText = codeText.replace(/\\0/g, this.INDENT);\n      this.definitions_[desiredName] = codeText;\n    }\n    return this.functionNames_[desiredName];\n  }\n\n  /**\n   * Hook for code to run before code generation starts.\n   * Subclasses may override this, e.g. to initialise the database of variable\n   * names.\n   *\n   * @param _workspace Workspace to generate code from.\n   */\n  init(_workspace: Workspace) {\n    // Optionally override\n    // Create a dictionary of definitions to be printed before the code.\n    this.definitions_ = Object.create(null);\n    // Create a dictionary mapping desired developer-defined function names in\n    // definitions_ to actual function names (to avoid collisions with\n    // user-defined procedures).\n    this.functionNames_ = Object.create(null);\n  }\n\n  /**\n   * Common tasks for generating code from blocks.  This is called from\n   * blockToCode and is called on every block, not just top level blocks.\n   * Subclasses may override this, e.g. to generate code for statements\n   * following the block, or to handle comments for the specified block and any\n   * connected value blocks.\n   *\n   * @param _block The current block.\n   * @param code The code created for this block.\n   * @param _opt_thisOnly True to generate code for only this statement.\n   * @returns Code with comments and subsequent blocks added.\n   */\n  protected scrub_(_block: Block, code: string, _opt_thisOnly?: boolean):\n      string {\n    // Optionally override\n    return code;\n  }\n\n  /**\n   * Hook for code to run at end of code generation.\n   * Subclasses may override this, e.g. to prepend the generated code with\n   * import statements or variable definitions.\n   *\n   * @param code Generated code.\n   * @returns Completed code.\n   */\n  finish(code: string): string {\n    // Optionally override\n    // Clean up temporary data.\n    this.definitions_ = Object.create(null);\n    this.functionNames_ = Object.create(null);\n    return code;\n  }\n\n  /**\n   * Naked values are top-level blocks with outputs that aren't plugged into\n   * anything.\n   * Subclasses may override this, e.g. if their language does not allow\n   * naked values.\n   *\n   * @param line Line of generated code.\n   * @returns Legal line of code.\n   */\n  scrubNakedValue(line: string): string {\n    // Optionally override\n    return line;\n  }\n}\n\nObject.defineProperties(Generator.prototype, {\n  /**\n   * A database of variable names.\n   *\n   * @name Blockly.Generator.prototype.variableDB_\n   * @deprecated 'variableDB_' was renamed to 'nameDB_' (May 2021).\n   * @suppress {checkTypes}\n   */\n  variableDB_: ({\n    /** @returns Name database. */\n    get(this: Generator): Names |\n        undefined {\n          deprecation.warn(\n              'variableDB_', 'May 2021', 'September 2022', 'nameDB_');\n          return this.nameDB_;\n        },\n    /** @param nameDb New name database. */\n    set(this: Generator, nameDb: Names|undefined) {\n      deprecation.warn('variableDB_', 'May 2021', 'September2022', 'nameDB_');\n      this.nameDB_ = nameDb;\n    },\n  }),\n});\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a button in the flyout.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FlyoutButton');\n\nimport * as browserEvents from './browser_events.js';\nimport * as Css from './css.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport * as style from './utils/style.js';\nimport {Svg} from './utils/svg.js';\nimport type * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Class for a button or label in the flyout.\n *\n * @alias Blockly.FlyoutButton\n */\nexport class FlyoutButton {\n  /** The horizontal margin around the text in the button. */\n  static TEXT_MARGIN_X = 5;\n\n  /** The vertical margin around the text in the button. */\n  static TEXT_MARGIN_Y = 2;\n  private readonly text_: string;\n  private readonly position_: Coordinate;\n  private readonly callbackKey_: string;\n  private readonly cssClass_: string|null;\n\n  /** Mouse up event data. */\n  private onMouseUpWrapper_: browserEvents.Data|null = null;\n  info: toolbox.ButtonOrLabelInfo;\n\n  /** The width of the button's rect. */\n  width = 0;\n\n  /** The height of the button's rect. */\n  height = 0;\n\n  /** The root SVG group for the button or label. */\n  private svgGroup_: SVGGElement|null = null;\n\n  /** The SVG element with the text of the label or button. */\n  private svgText_: SVGTextElement|null = null;\n\n  /**\n   * @param workspace The workspace in which to place this button.\n   * @param targetWorkspace The flyout's target workspace.\n   * @param json The JSON specifying the label/button.\n   * @param isLabel_ Whether this button should be styled as a label.\n   * @internal\n   */\n  constructor(\n      private readonly workspace: WorkspaceSvg,\n      private readonly targetWorkspace: WorkspaceSvg,\n      json: toolbox.ButtonOrLabelInfo, private readonly isLabel_: boolean) {\n    this.text_ = json['text'];\n\n    this.position_ = new Coordinate(0, 0);\n\n    /** The key to the function called when this button is clicked. */\n    this.callbackKey_ =\n        (json as\n         AnyDuringMigration)['callbackKey'] || /* Check the lower case version\n                                                   too to satisfy IE */\n        (json as AnyDuringMigration)['callbackkey'];\n\n    /** If specified, a CSS class to add to this button. */\n    this.cssClass_ = (json as AnyDuringMigration)['web-class'] || null;\n\n    /** The JSON specifying the label / button. */\n    this.info = json;\n  }\n\n  /**\n   * Create the button elements.\n   *\n   * @returns The button's SVG group.\n   */\n  createDom(): SVGElement {\n    let cssClass = this.isLabel_ ? 'blocklyFlyoutLabel' : 'blocklyFlyoutButton';\n    if (this.cssClass_) {\n      cssClass += ' ' + this.cssClass_;\n    }\n\n    this.svgGroup_ = dom.createSvgElement(\n        Svg.G, {'class': cssClass}, this.workspace.getCanvas());\n\n    let shadow;\n    if (!this.isLabel_) {\n      // Shadow rectangle (light source does not mirror in RTL).\n      shadow = dom.createSvgElement(\n          Svg.RECT, {\n            'class': 'blocklyFlyoutButtonShadow',\n            'rx': 4,\n            'ry': 4,\n            'x': 1,\n            'y': 1,\n          },\n          this.svgGroup_!);\n    }\n    // Background rectangle.\n    const rect = dom.createSvgElement(\n        Svg.RECT, {\n          'class': this.isLabel_ ? 'blocklyFlyoutLabelBackground' :\n                                   'blocklyFlyoutButtonBackground',\n          'rx': 4,\n          'ry': 4,\n        },\n        this.svgGroup_!);\n\n    const svgText = dom.createSvgElement(\n        Svg.TEXT, {\n          'class': this.isLabel_ ? 'blocklyFlyoutLabelText' : 'blocklyText',\n          'x': 0,\n          'y': 0,\n          'text-anchor': 'middle',\n        },\n        this.svgGroup_!);\n    let text = parsing.replaceMessageReferences(this.text_);\n    if (this.workspace.RTL) {\n      // Force text to be RTL by adding an RLM.\n      text += '\\u200F';\n    }\n    svgText.textContent = text;\n    if (this.isLabel_) {\n      this.svgText_ = svgText;\n      this.workspace.getThemeManager().subscribe(\n          this.svgText_, 'flyoutForegroundColour', 'fill');\n    }\n\n    const fontSize = style.getComputedStyle(svgText, 'fontSize');\n    const fontWeight = style.getComputedStyle(svgText, 'fontWeight');\n    const fontFamily = style.getComputedStyle(svgText, 'fontFamily');\n    this.width = dom.getFastTextWidthWithSizeString(\n        svgText, fontSize, fontWeight, fontFamily);\n    const fontMetrics =\n        dom.measureFontMetrics(text, fontSize, fontWeight, fontFamily);\n    this.height = fontMetrics.height;\n\n    if (!this.isLabel_) {\n      this.width += 2 * FlyoutButton.TEXT_MARGIN_X;\n      this.height += 2 * FlyoutButton.TEXT_MARGIN_Y;\n      shadow?.setAttribute('width', this.width.toString());\n      shadow?.setAttribute('height', this.height.toString());\n    }\n    rect.setAttribute('width', this.width.toString());\n    rect.setAttribute('height', this.height.toString());\n\n    svgText.setAttribute('x', (this.width / 2).toString());\n    svgText.setAttribute(\n        'y',\n        (this.height / 2 - fontMetrics.height / 2 + fontMetrics.baseline)\n            .toString());\n\n    this.updateTransform_();\n\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'EventTarget'.\n    this.onMouseUpWrapper_ = browserEvents.conditionalBind(\n        this.svgGroup_ as AnyDuringMigration, 'mouseup', this, this.onMouseUp_);\n    return this.svgGroup_!;\n  }\n\n  /** Correctly position the flyout button and make it visible. */\n  show() {\n    this.updateTransform_();\n    this.svgGroup_!.setAttribute('display', 'block');\n  }\n\n  /** Update SVG attributes to match internal state. */\n  private updateTransform_() {\n    this.svgGroup_!.setAttribute(\n        'transform',\n        'translate(' + this.position_.x + ',' + this.position_.y + ')');\n  }\n\n  /**\n   * Move the button to the given x, y coordinates.\n   *\n   * @param x The new x coordinate.\n   * @param y The new y coordinate.\n   */\n  moveTo(x: number, y: number) {\n    this.position_.x = x;\n    this.position_.y = y;\n    this.updateTransform_();\n  }\n\n  /** @returns Whether or not the button is a label. */\n  isLabel(): boolean {\n    return this.isLabel_;\n  }\n\n  /**\n   * Location of the button.\n   *\n   * @returns x, y coordinates.\n   * @internal\n   */\n  getPosition(): Coordinate {\n    return this.position_;\n  }\n\n  /** @returns Text of the button. */\n  getButtonText(): string {\n    return this.text_;\n  }\n\n  /**\n   * Get the button's target workspace.\n   *\n   * @returns The target workspace of the flyout where this button resides.\n   */\n  getTargetWorkspace(): WorkspaceSvg {\n    return this.targetWorkspace;\n  }\n\n  /** Dispose of this button. */\n  dispose() {\n    if (this.onMouseUpWrapper_) {\n      browserEvents.unbind(this.onMouseUpWrapper_);\n    }\n    if (this.svgGroup_) {\n      dom.removeNode(this.svgGroup_);\n    }\n    if (this.svgText_) {\n      this.workspace.getThemeManager().unsubscribe(this.svgText_);\n    }\n  }\n\n  /**\n   * Do something when the button is clicked.\n   *\n   * @param e Mouse up event.\n   */\n  private onMouseUp_(e: Event) {\n    const gesture = this.targetWorkspace.getGesture(e);\n    if (gesture) {\n      gesture.cancel();\n    }\n\n    if (this.isLabel_ && this.callbackKey_) {\n      console.warn(\n          'Labels should not have callbacks. Label text: ' + this.text_);\n    } else if (\n        !this.isLabel_ &&\n        !(this.callbackKey_ &&\n          this.targetWorkspace.getButtonCallback(this.callbackKey_))) {\n      console.warn('Buttons should have callbacks. Button text: ' + this.text_);\n    } else if (!this.isLabel_) {\n      const callback =\n          this.targetWorkspace.getButtonCallback(this.callbackKey_);\n      if (callback) {\n        callback(this);\n      }\n    }\n  }\n}\n\n/** CSS for buttons and labels. See css.js for use. */\nCss.register(`\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n`);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Calculates and reports workspace metrics.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.MetricsManager');\n\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport type {IToolbox} from './interfaces/i_toolbox.js';\nimport * as registry from './registry.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Size} from './utils/size.js';\nimport * as toolboxUtils from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * The manager for all workspace metrics calculations.\n *\n * @alias Blockly.MetricsManager\n */\nexport class MetricsManager implements IMetricsManager {\n  /** The workspace to calculate metrics for. */\n  protected readonly workspace_: WorkspaceSvg;\n\n  /** @param workspace The workspace to calculate metrics for. */\n  constructor(workspace: WorkspaceSvg) {\n    this.workspace_ = workspace;\n  }\n\n  /**\n   * Gets the dimensions of the given workspace component, in pixel coordinates.\n   *\n   * @param elem The element to get the dimensions of, or null.  It should be a\n   *     toolbox or flyout, and should implement getWidth() and getHeight().\n   * @returns An object containing width and height attributes, which will both\n   *     be zero if elem did not exist.\n   */\n  protected getDimensionsPx_(elem: IToolbox|null|IFlyout): Size {\n    let width = 0;\n    let height = 0;\n    if (elem) {\n      width = elem.getWidth();\n      height = elem.getHeight();\n    }\n    return new Size(width, height);\n  }\n\n  /**\n   * Gets the width and the height of the flyout on the workspace in pixel\n   * coordinates. Returns 0 for the width and height if the workspace has a\n   * category toolbox instead of a simple toolbox.\n   *\n   * @param opt_own Whether to only return the workspace's own flyout.\n   * @returns The width and height of the flyout.\n   */\n  getFlyoutMetrics(opt_own?: boolean): ToolboxMetrics {\n    const flyoutDimensions =\n        this.getDimensionsPx_(this.workspace_.getFlyout(opt_own));\n    return {\n      width: flyoutDimensions.width,\n      height: flyoutDimensions.height,\n      position: this.workspace_.toolboxPosition,\n    };\n  }\n\n  /**\n   * Gets the width, height and position of the toolbox on the workspace in\n   * pixel coordinates. Returns 0 for the width and height if the workspace has\n   * a simple toolbox instead of a category toolbox. To get the width and height\n   * of a\n   * simple toolbox @see {@link MetricsManager#getFlyoutMetrics}.\n   *\n   * @returns The object with the width, height and position of the toolbox.\n   */\n  getToolboxMetrics(): ToolboxMetrics {\n    const toolboxDimensions =\n        this.getDimensionsPx_(this.workspace_.getToolbox());\n\n    return {\n      width: toolboxDimensions.width,\n      height: toolboxDimensions.height,\n      position: this.workspace_.toolboxPosition,\n    };\n  }\n\n  /**\n   * Gets the width and height of the workspace's parent SVG element in pixel\n   * coordinates. This area includes the toolbox and the visible workspace area.\n   *\n   * @returns The width and height of the workspace's parent SVG element.\n   */\n  getSvgMetrics(): Size {\n    return this.workspace_.getCachedParentSvgSize();\n  }\n\n  /**\n   * Gets the absolute left and absolute top in pixel coordinates.\n   * This is where the visible workspace starts in relation to the SVG\n   * container.\n   *\n   * @returns The absolute metrics for the workspace.\n   */\n  getAbsoluteMetrics(): AbsoluteMetrics {\n    let absoluteLeft = 0;\n    const toolboxMetrics = this.getToolboxMetrics();\n    const flyoutMetrics = this.getFlyoutMetrics(true);\n    const doesToolboxExist = !!this.workspace_.getToolbox();\n    const doesFlyoutExist = !!this.workspace_.getFlyout(true);\n    const toolboxPosition =\n        doesToolboxExist ? toolboxMetrics.position : flyoutMetrics.position;\n\n    const atLeft = toolboxPosition === toolboxUtils.Position.LEFT;\n    const atTop = toolboxPosition === toolboxUtils.Position.TOP;\n    if (doesToolboxExist && atLeft) {\n      absoluteLeft = toolboxMetrics.width;\n    } else if (doesFlyoutExist && atLeft) {\n      absoluteLeft = flyoutMetrics.width;\n    }\n    let absoluteTop = 0;\n    if (doesToolboxExist && atTop) {\n      absoluteTop = toolboxMetrics.height;\n    } else if (doesFlyoutExist && atTop) {\n      absoluteTop = flyoutMetrics.height;\n    }\n\n    return {\n      top: absoluteTop,\n      left: absoluteLeft,\n    };\n  }\n\n  /**\n   * Gets the metrics for the visible workspace in either pixel or workspace\n   * coordinates. The visible workspace does not include the toolbox or flyout.\n   *\n   * @param opt_getWorkspaceCoordinates True to get the view metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @returns The width, height, top and left of the viewport in either\n   *     workspace coordinates or pixel coordinates.\n   */\n  getViewMetrics(opt_getWorkspaceCoordinates?: boolean): ContainerRegion {\n    const scale = opt_getWorkspaceCoordinates ? this.workspace_.scale : 1;\n    const svgMetrics = this.getSvgMetrics();\n    const toolboxMetrics = this.getToolboxMetrics();\n    const flyoutMetrics = this.getFlyoutMetrics(true);\n    const doesToolboxExist = !!this.workspace_.getToolbox();\n    const toolboxPosition =\n        doesToolboxExist ? toolboxMetrics.position : flyoutMetrics.position;\n\n    if (this.workspace_.getToolbox()) {\n      if (toolboxPosition === toolboxUtils.Position.TOP ||\n          toolboxPosition === toolboxUtils.Position.BOTTOM) {\n        svgMetrics.height -= toolboxMetrics.height;\n      } else if (\n          toolboxPosition === toolboxUtils.Position.LEFT ||\n          toolboxPosition === toolboxUtils.Position.RIGHT) {\n        svgMetrics.width -= toolboxMetrics.width;\n      }\n    } else if (this.workspace_.getFlyout(true)) {\n      if (toolboxPosition === toolboxUtils.Position.TOP ||\n          toolboxPosition === toolboxUtils.Position.BOTTOM) {\n        svgMetrics.height -= flyoutMetrics.height;\n      } else if (\n          toolboxPosition === toolboxUtils.Position.LEFT ||\n          toolboxPosition === toolboxUtils.Position.RIGHT) {\n        svgMetrics.width -= flyoutMetrics.width;\n      }\n    }\n    return {\n      height: svgMetrics.height / scale,\n      width: svgMetrics.width / scale,\n      top: -this.workspace_.scrollY / scale,\n      left: -this.workspace_.scrollX / scale,\n    };\n  }\n\n  /**\n   * Gets content metrics in either pixel or workspace coordinates.\n   * The content area is a rectangle around all the top bounded elements on the\n   * workspace (workspace comments and blocks).\n   *\n   * @param opt_getWorkspaceCoordinates True to get the content metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @returns The metrics for the content container.\n   */\n  getContentMetrics(opt_getWorkspaceCoordinates?: boolean): ContainerRegion {\n    const scale = opt_getWorkspaceCoordinates ? 1 : this.workspace_.scale;\n    // Block bounding box is in workspace coordinates.\n    const blockBox = this.workspace_.getBlocksBoundingBox();\n\n    return {\n      height: (blockBox.bottom - blockBox.top) * scale,\n      width: (blockBox.right - blockBox.left) * scale,\n      top: blockBox.top * scale,\n      left: blockBox.left * scale,\n    };\n  }\n\n  /**\n   * Returns whether the scroll area has fixed edges.\n   *\n   * @returns Whether the scroll area has fixed edges.\n   * @internal\n   */\n  hasFixedEdges(): boolean {\n    // This exists for optimization of bump logic.\n    return !this.workspace_.isMovableHorizontally() ||\n        !this.workspace_.isMovableVertically();\n  }\n\n  /**\n   * Computes the fixed edges of the scroll area.\n   *\n   * @param opt_viewMetrics The view metrics if they have been previously\n   *     computed. Passing in null may cause the view metrics to be computed\n   *     again, if it is needed.\n   * @returns The fixed edges of the scroll area.\n   */\n  protected getComputedFixedEdges_(opt_viewMetrics?: ContainerRegion):\n      FixedEdges {\n    if (!this.hasFixedEdges()) {\n      // Return early if there are no edges.\n      return {};\n    }\n\n    const hScrollEnabled = this.workspace_.isMovableHorizontally();\n    const vScrollEnabled = this.workspace_.isMovableVertically();\n\n    const viewMetrics = opt_viewMetrics || this.getViewMetrics(false);\n\n    const edges = {} as FixedEdges;\n    if (!vScrollEnabled) {\n      edges.top = viewMetrics.top;\n      edges.bottom = viewMetrics.top + viewMetrics.height;\n    }\n    if (!hScrollEnabled) {\n      edges.left = viewMetrics.left;\n      edges.right = viewMetrics.left + viewMetrics.width;\n    }\n    return edges;\n  }\n\n  /**\n   * Returns the content area with added padding.\n   *\n   * @param viewMetrics The view metrics.\n   * @param contentMetrics The content metrics.\n   * @returns The padded content area.\n   */\n  protected getPaddedContent_(\n      viewMetrics: ContainerRegion, contentMetrics: ContainerRegion):\n      {top: number, bottom: number, left: number, right: number} {\n    const contentBottom = contentMetrics.top + contentMetrics.height;\n    const contentRight = contentMetrics.left + contentMetrics.width;\n\n    const viewWidth = viewMetrics.width;\n    const viewHeight = viewMetrics.height;\n    const halfWidth = viewWidth / 2;\n    const halfHeight = viewHeight / 2;\n\n    // Add a padding around the content that is at least half a screen wide.\n    // Ensure padding is wide enough that blocks can scroll over entire screen.\n    const top =\n        Math.min(contentMetrics.top - halfHeight, contentBottom - viewHeight);\n    const left =\n        Math.min(contentMetrics.left - halfWidth, contentRight - viewWidth);\n    const bottom =\n        Math.max(contentBottom + halfHeight, contentMetrics.top + viewHeight);\n    const right =\n        Math.max(contentRight + halfWidth, contentMetrics.left + viewWidth);\n\n    return {top, bottom, left, right};\n  }\n\n  /**\n   * Returns the metrics for the scroll area of the workspace.\n   *\n   * @param opt_getWorkspaceCoordinates True to get the scroll metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @param opt_viewMetrics The view metrics if they have been previously\n   *     computed. Passing in null may cause the view metrics to be computed\n   *     again, if it is needed.\n   * @param opt_contentMetrics The content metrics if they have been previously\n   *     computed. Passing in null may cause the content metrics to be computed\n   *     again, if it is needed.\n   * @returns The metrics for the scroll container.\n   */\n  getScrollMetrics(\n      opt_getWorkspaceCoordinates?: boolean, opt_viewMetrics?: ContainerRegion,\n      opt_contentMetrics?: ContainerRegion): ContainerRegion {\n    const scale = opt_getWorkspaceCoordinates ? this.workspace_.scale : 1;\n    const viewMetrics = opt_viewMetrics || this.getViewMetrics(false);\n    const contentMetrics = opt_contentMetrics || this.getContentMetrics();\n    const fixedEdges = this.getComputedFixedEdges_(viewMetrics);\n\n    // Add padding around content.\n    const paddedContent = this.getPaddedContent_(viewMetrics, contentMetrics);\n\n    // Use combination of fixed bounds and padded content to make scroll area.\n    const top =\n        fixedEdges.top !== undefined ? fixedEdges.top : paddedContent.top;\n    const left =\n        fixedEdges.left !== undefined ? fixedEdges.left : paddedContent.left;\n    const bottom = fixedEdges.bottom !== undefined ? fixedEdges.bottom :\n                                                     paddedContent.bottom;\n    const right =\n        fixedEdges.right !== undefined ? fixedEdges.right : paddedContent.right;\n\n    return {\n      top: top / scale,\n      left: left / scale,\n      width: (right - left) / scale,\n      height: (bottom - top) / scale,\n    };\n  }\n\n  /**\n   * Returns common metrics used by UI elements.\n   *\n   * @returns The UI metrics.\n   */\n  getUiMetrics(): UiMetrics {\n    return {\n      viewMetrics: this.getViewMetrics(),\n      absoluteMetrics: this.getAbsoluteMetrics(),\n      toolboxMetrics: this.getToolboxMetrics(),\n    };\n  }\n\n  /**\n   * Returns an object with all the metrics required to size scrollbars for a\n   * top level workspace.  The following properties are computed:\n   * Coordinate system: pixel coordinates, -left, -up, +right, +down\n   * .viewHeight: Height of the visible portion of the workspace.\n   * .viewWidth: Width of the visible portion of the workspace.\n   * .contentHeight: Height of the content.\n   * .contentWidth: Width of the content.\n   * .scrollHeight: Height of the scroll area.\n   * .scrollWidth: Width of the scroll area.\n   * .svgHeight: Height of the Blockly div (the view + the toolbox,\n   *    simple or otherwise),\n   * .svgWidth: Width of the Blockly div (the view + the toolbox,\n   *    simple or otherwise),\n   * .viewTop: Top-edge of the visible portion of the workspace, relative to\n   *     the workspace origin.\n   * .viewLeft: Left-edge of the visible portion of the workspace, relative to\n   *     the workspace origin.\n   * .contentTop: Top-edge of the content, relative to the workspace origin.\n   * .contentLeft: Left-edge of the content relative to the workspace origin.\n   * .scrollTop: Top-edge of the scroll area, relative to the workspace origin.\n   * .scrollLeft: Left-edge of the scroll area relative to the workspace origin.\n   * .absoluteTop: Top-edge of the visible portion of the workspace, relative\n   *     to the blocklyDiv.\n   * .absoluteLeft: Left-edge of the visible portion of the workspace, relative\n   *     to the blocklyDiv.\n   * .toolboxWidth: Width of the toolbox, if it exists.  Otherwise zero.\n   * .toolboxHeight: Height of the toolbox, if it exists.  Otherwise zero.\n   * .flyoutWidth: Width of the flyout if it is always open.  Otherwise zero.\n   * .flyoutHeight: Height of the flyout if it is always open.  Otherwise zero.\n   * .toolboxPosition: Top, bottom, left or right. Use TOOLBOX_AT constants to\n   *     compare.\n   *\n   * @returns Contains size and position metrics of a top level workspace.\n   */\n  getMetrics(): Metrics {\n    const toolboxMetrics = this.getToolboxMetrics();\n    const flyoutMetrics = this.getFlyoutMetrics(true);\n    const svgMetrics = this.getSvgMetrics();\n    const absoluteMetrics = this.getAbsoluteMetrics();\n    const viewMetrics = this.getViewMetrics();\n    const contentMetrics = this.getContentMetrics();\n    const scrollMetrics =\n        this.getScrollMetrics(false, viewMetrics, contentMetrics);\n\n    return {\n      contentHeight: contentMetrics.height,\n      contentWidth: contentMetrics.width,\n      contentTop: contentMetrics.top,\n      contentLeft: contentMetrics.left,\n\n      scrollHeight: scrollMetrics.height,\n      scrollWidth: scrollMetrics.width,\n      scrollTop: scrollMetrics.top,\n      scrollLeft: scrollMetrics.left,\n\n      viewHeight: viewMetrics.height,\n      viewWidth: viewMetrics.width,\n      viewTop: viewMetrics.top,\n      viewLeft: viewMetrics.left,\n\n      absoluteTop: absoluteMetrics.top,\n      absoluteLeft: absoluteMetrics.left,\n\n      svgHeight: svgMetrics.height,\n      svgWidth: svgMetrics.width,\n\n      toolboxWidth: toolboxMetrics.width,\n      toolboxHeight: toolboxMetrics.height,\n      toolboxPosition: toolboxMetrics.position,\n\n      flyoutWidth: flyoutMetrics.width,\n      flyoutHeight: flyoutMetrics.height,\n    };\n  }\n}\n\nexport namespace MetricsManager {\n  /**\n   * Describes the width, height and location of the toolbox on the main\n   * workspace.\n   */\n  export interface ToolboxMetrics {\n    width: number;\n    height: number;\n    position: toolboxUtils.Position;\n  }\n\n  /** Describes where the viewport starts in relation to the workspace SVG. */\n  export interface AbsoluteMetrics {\n    left: number;\n    top: number;\n  }\n\n  /**\n   * All the measurements needed to describe the size and location of a\n   * container.\n   */\n  export interface ContainerRegion {\n    height: number;\n    width: number;\n    top: number;\n    left: number;\n  }\n\n  /** Describes fixed edges of the workspace. */\n  export interface FixedEdges {\n    top?: number;\n    bottom?: number;\n    left?: number;\n    right?: number;\n  }\n\n  /** Common metrics used for UI elements. */\n  export interface UiMetrics {\n    viewMetrics: ContainerRegion;\n    absoluteMetrics: AbsoluteMetrics;\n    toolboxMetrics: ToolboxMetrics;\n  }\n}\n\nexport type ToolboxMetrics = MetricsManager.ToolboxMetrics;\nexport type AbsoluteMetrics = MetricsManager.AbsoluteMetrics;\nexport type ContainerRegion = MetricsManager.ContainerRegion;\nexport type FixedEdges = MetricsManager.FixedEdges;\nexport type UiMetrics = MetricsManager.UiMetrics;\n\nregistry.register(\n    registry.Type.METRICS_MANAGER, registry.DEFAULT, MetricsManager);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Calculates and reports flyout workspace metrics.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FlyoutMetricsManager');\n\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport {ContainerRegion, MetricsManager} from './metrics_manager.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n\n/**\n * Calculates metrics for a flyout's workspace.\n * The metrics are mainly used to size scrollbars for the flyout.\n *\n * @alias Blockly.FlyoutMetricsManager\n */\nexport class FlyoutMetricsManager extends MetricsManager {\n  /** The flyout that owns the workspace to calculate metrics for. */\n  protected flyout_: IFlyout;\n\n  /**\n   * @param workspace The flyout's workspace.\n   * @param flyout The flyout.\n   */\n  constructor(workspace: WorkspaceSvg, flyout: IFlyout) {\n    super(workspace);\n    this.flyout_ = flyout;\n  }\n\n  /**\n   * Gets the bounding box of the blocks on the flyout's workspace.\n   * This is in workspace coordinates.\n   *\n   * @returns The bounding box of the blocks on the workspace.\n   */\n  private getBoundingBox_(): SVGRect|\n      {height: number, y: number, width: number, x: number} {\n    let blockBoundingBox;\n    try {\n      blockBoundingBox = this.workspace_.getCanvas().getBBox();\n    } catch (e) {\n      // Firefox has trouble with hidden elements (Bug 528969).\n      // 2021 Update: It looks like this was fixed around Firefox 77 released in\n      // 2020.\n      blockBoundingBox = {height: 0, y: 0, width: 0, x: 0};\n    }\n    return blockBoundingBox;\n  }\n\n  override getContentMetrics(opt_getWorkspaceCoordinates?: boolean) {\n    // The bounding box is in workspace coordinates.\n    const blockBoundingBox = this.getBoundingBox_();\n    const scale = opt_getWorkspaceCoordinates ? 1 : this.workspace_.scale;\n\n    return {\n      height: blockBoundingBox.height * scale,\n      width: blockBoundingBox.width * scale,\n      top: blockBoundingBox.y * scale,\n      left: blockBoundingBox.x * scale,\n    };\n  }\n\n  override getScrollMetrics(\n      opt_getWorkspaceCoordinates?: boolean, opt_viewMetrics?: ContainerRegion,\n      opt_contentMetrics?: ContainerRegion) {\n    // AnyDuringMigration because:  Expected 1 arguments, but got 0.\n    const contentMetrics = opt_contentMetrics || this.getContentMetrics();\n    const margin = this.flyout_.MARGIN * this.workspace_.scale;\n    const scale = opt_getWorkspaceCoordinates ? this.workspace_.scale : 1;\n\n    // The left padding isn't just the margin. Some blocks are also offset by\n    // tabWidth so that value and statement blocks line up.\n    // The contentMetrics.left value is equivalent to the variable left padding.\n    const leftPadding = contentMetrics.left;\n\n    return {\n      height: (contentMetrics.height + 2 * margin) / scale,\n      width: (contentMetrics.width + leftPadding + margin) / scale,\n      top: 0,\n      left: 0,\n    };\n  }\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Flyout tray containing blocks which may be created.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Flyout');\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {DeleteArea} from './delete_area.js';\nimport * as eventUtils from './events/utils.js';\nimport {FlyoutButton} from './flyout_button.js';\nimport {FlyoutMetricsManager} from './flyout_metrics_manager.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {Options} from './options.js';\nimport {ScrollbarPair} from './scrollbar_pair.js';\nimport * as blocks from './serialization/blocks.js';\nimport * as Tooltip from './tooltip.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport {Svg} from './utils/svg.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as Variables from './variables.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\nimport * as Xml from './xml.js';\n\n\nenum FlyoutItemType {\n  BLOCK = 'block',\n  BUTTON = 'button',\n}\n\n/**\n * Class for a flyout.\n *\n * @alias Blockly.Flyout\n */\nexport abstract class Flyout extends DeleteArea implements IFlyout {\n  /**\n   * Position the flyout.\n   */\n  abstract position(): void;\n\n  /**\n   * Determine if a drag delta is toward the workspace, based on the position\n   * and orientation of the flyout. This is used in determineDragIntention_ to\n   * determine if a new block should be created or if the flyout should scroll.\n   *\n   * @param currentDragDeltaXY How far the pointer has\n   *     moved from the position at mouse down, in pixel units.\n   * @returns True if the drag is toward the workspace.\n   */\n  abstract isDragTowardWorkspace(currentDragDeltaXY: Coordinate): boolean;\n\n  /**\n   * Sets the translation of the flyout to match the scrollbars.\n   *\n   * @param xyRatio Contains a y property which is a float\n   *     between 0 and 1 specifying the degree of scrolling and a\n   *     similar x property.\n   */\n  protected abstract setMetrics_(xyRatio: {x?: number, y?: number}): void;\n\n  /**\n   * Lay out the blocks in the flyout.\n   *\n   * @param contents The blocks and buttons to lay\n   *     out.\n   * @param gaps The visible gaps between blocks.\n   */\n  protected abstract layout_(contents: FlyoutItem[], gaps: number[]): void;\n\n  /**\n   * Scroll the flyout.\n   *\n   * @param e Mouse wheel scroll event.\n   */\n  protected abstract wheel_(e: WheelEvent): void;\n\n  /**\n   * Compute height of flyout.  Position mat under each block.\n   * For RTL: Lay out the blocks right-aligned.\n   */\n  protected abstract reflowInternal_(): void;\n\n  /**\n   * Calculates the x coordinate for the flyout position.\n   *\n   * @returns X coordinate.\n   */\n  abstract getX(): number;\n\n  /**\n   * Calculates the y coordinate for the flyout position.\n   *\n   * @returns Y coordinate.\n   */\n  abstract getY(): number;\n\n  /**\n   * Scroll the flyout to the beginning of its contents.\n   */\n  abstract scrollToStart(): void;\n\n  /**\n   * The type of a flyout content item.\n   */\n  static FlyoutItemType = FlyoutItemType;\n\n  protected workspace_: WorkspaceSvg;\n  RTL: boolean;\n  /**\n   * Whether the flyout should be laid out horizontally or not.\n   *\n   * @internal\n   */\n  horizontalLayout = false;\n  protected toolboxPosition_: number;\n\n  /**\n   * Opaque data that can be passed to Blockly.unbindEvent_.\n   */\n  private eventWrappers_: browserEvents.Data = [];\n\n  /**\n   * Function that will be registered as a change listener on the workspace\n   * to reflow when blocks in the flyout workspace change.\n   */\n  private reflowWrapper_: Function|null = null;\n\n  /**\n   * Function that disables blocks in the flyout based on max block counts\n   * allowed in the target workspace. Registered as a change listener on the\n   * target workspace.\n   */\n  private filterWrapper_: Function|null = null;\n\n  /**\n   * List of background mats that lurk behind each block to catch clicks\n   * landing in the blocks' lakes and bays.\n   */\n  private mats_: SVGElement[] = [];\n  /**\n   * List of visible buttons.\n   */\n  protected buttons_: FlyoutButton[] = [];\n  /**\n   * List of event listeners.\n   */\n  private listeners_: browserEvents.Data[] = [];\n\n  /**\n   * List of blocks that should always be disabled.\n   */\n  private permanentlyDisabled_: Block[] = [];\n  protected readonly tabWidth_: number;\n\n  /**\n   * The target workspace.\n   *\n   * @internal\n   */\n  targetWorkspace!: WorkspaceSvg;\n  /**\n   * A list of blocks that can be reused.\n   */\n  private recycledBlocks_: BlockSvg[] = [];\n  /**\n   * Does the flyout automatically close when a block is created?\n   */\n  autoClose = true;\n\n  /**\n   * Whether the flyout is visible.\n   */\n  private isVisible_ = false;\n\n  /**\n   * Whether the workspace containing this flyout is visible.\n   */\n  private containerVisible_ = true;\n  protected rectMap_: WeakMap<BlockSvg, SVGElement>;\n\n  /**\n   * Corner radius of the flyout background.\n   */\n  readonly CORNER_RADIUS: number = 8;\n  readonly MARGIN: number;\n  readonly GAP_X: number;\n  readonly GAP_Y: number;\n\n  /**\n   * Top/bottom padding between scrollbar and edge of flyout background.\n   */\n  readonly SCROLLBAR_MARGIN: number = 2.5;\n\n  /**\n   * Width of flyout.\n   */\n  protected width_ = 0;\n\n  /**\n   * Height of flyout.\n   */\n  protected height_ = 0;\n  // clang-format off\n  /**\n   * Range of a drag angle from a flyout considered \"dragging toward\n   * workspace\". Drags that are within the bounds of this many degrees from\n   * the orthogonal line to the flyout edge are considered to be \"drags toward\n   * the workspace\".\n   *\n   * @example\n   *\n   * ```\n   * Flyout                                                 Edge   Workspace\n   * [block] /  <-within this angle, drags \"toward workspace\" |\n   * [block] ---- orthogonal to flyout boundary ----          |\n   * [block] \\                                                |\n   * ```\n   *\n   * The angle is given in degrees from the orthogonal.\n   *\n   * This is used to know when to create a new block and when to scroll the\n   * flyout. Setting it to 360 means that all drags create a new block.\n   */\n  // clang-format on\n  protected dragAngleRange_ = 70;\n\n  /**\n   * The path around the background of the flyout, which will be filled with a\n   * background colour.\n   */\n  protected svgBackground_: SVGPathElement|null = null;\n\n  /**\n   * The root SVG group for the button or label.\n   */\n  protected svgGroup_: SVGGElement|null = null;\n  /**\n   * @param workspaceOptions Dictionary of options for the\n   *     workspace.\n   */\n  constructor(workspaceOptions: Options) {\n    super();\n    workspaceOptions.setMetrics = this.setMetrics_.bind(this);\n\n    this.workspace_ = new WorkspaceSvg(workspaceOptions);\n    this.workspace_.setMetricsManager(\n        new FlyoutMetricsManager(this.workspace_, this));\n\n    this.workspace_.internalIsFlyout = true;\n    // Keep the workspace visibility consistent with the flyout's visibility.\n    this.workspace_.setVisible(this.isVisible_);\n\n    /**\n     * The unique id for this component that is used to register with the\n     * ComponentManager.\n     */\n    this.id = idGenerator.genUid();\n\n    /**\n     * Is RTL vs LTR.\n     */\n    this.RTL = !!workspaceOptions.RTL;\n\n    /**\n     * Position of the toolbox and flyout relative to the workspace.\n     */\n    this.toolboxPosition_ = workspaceOptions.toolboxPosition;\n\n    /**\n     * Width of output tab.\n     */\n    this.tabWidth_ = this.workspace_.getRenderer().getConstants().TAB_WIDTH;\n\n    /**\n     * A map from blocks to the rects which are beneath them to act as input\n     * targets.\n     *\n     * @internal\n     */\n    this.rectMap_ = new WeakMap();\n\n    /**\n     * Margin around the edges of the blocks in the flyout.\n     */\n    this.MARGIN = this.CORNER_RADIUS;\n\n    // TODO: Move GAP_X and GAP_Y to their appropriate files.\n    /**\n     * Gap between items in horizontal flyouts. Can be overridden with the \"sep\"\n     * element.\n     */\n    this.GAP_X = this.MARGIN * 3;\n\n    /**\n     * Gap between items in vertical flyouts. Can be overridden with the \"sep\"\n     * element.\n     */\n    this.GAP_Y = this.MARGIN * 3;\n  }\n\n  /**\n   * Creates the flyout's DOM.  Only needs to be called once.  The flyout can\n   * either exist as its own SVG element or be a g element nested inside a\n   * separate SVG element.\n   *\n   * @param tagName The type of tag to\n   *     put the flyout in. This should be <svg> or <g>.\n   * @returns The flyout's SVG group.\n   */\n  createDom(tagName: string|Svg<SVGSVGElement>|Svg<SVGGElement>): SVGElement {\n    /*\n        <svg | g>\n          <path class=\"blocklyFlyoutBackground\"/>\n          <g class=\"blocklyFlyout\"></g>\n        </ svg | g>\n        */\n    // Setting style to display:none to start. The toolbox and flyout\n    // hide/show code will set up proper visibility and size later.\n    this.svgGroup_ = dom.createSvgElement(\n        tagName, {'class': 'blocklyFlyout', 'style': 'display: none'});\n    this.svgBackground_ = dom.createSvgElement(\n        Svg.PATH, {'class': 'blocklyFlyoutBackground'}, this.svgGroup_);\n    this.svgGroup_.appendChild(this.workspace_.createDom());\n    this.workspace_.getThemeManager().subscribe(\n        this.svgBackground_, 'flyoutBackgroundColour', 'fill');\n    this.workspace_.getThemeManager().subscribe(\n        this.svgBackground_, 'flyoutOpacity', 'fill-opacity');\n    return this.svgGroup_;\n  }\n\n  /**\n   * Initializes the flyout.\n   *\n   * @param targetWorkspace The workspace in which to\n   *     create new blocks.\n   */\n  init(targetWorkspace: WorkspaceSvg) {\n    this.targetWorkspace = targetWorkspace;\n    this.workspace_.targetWorkspace = targetWorkspace;\n\n    this.workspace_.scrollbar = new ScrollbarPair(\n        this.workspace_, this.horizontalLayout, !this.horizontalLayout,\n        'blocklyFlyoutScrollbar', this.SCROLLBAR_MARGIN);\n\n    this.hide();\n\n    Array.prototype.push.apply(\n        this.eventWrappers_,\n        browserEvents.conditionalBind(\n            (this.svgGroup_ as SVGGElement), 'wheel', this, this.wheel_));\n    if (!this.autoClose) {\n      this.filterWrapper_ = this.filterForCapacity_.bind(this);\n      this.targetWorkspace.addChangeListener(this.filterWrapper_);\n    }\n\n    // Dragging the flyout up and down.\n    Array.prototype.push.apply(\n        this.eventWrappers_,\n        browserEvents.conditionalBind(\n            (this.svgBackground_ as SVGPathElement), 'mousedown', this,\n            this.onMouseDown_));\n\n    // A flyout connected to a workspace doesn't have its own current gesture.\n    this.workspace_.getGesture =\n        this.targetWorkspace.getGesture.bind(this.targetWorkspace);\n\n    // Get variables from the main workspace rather than the target workspace.\n    this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap());\n\n    this.workspace_.createPotentialVariableMap();\n\n    targetWorkspace.getComponentManager().addComponent({\n      component: this,\n      weight: 1,\n      capabilities: [\n        ComponentManager.Capability.DELETE_AREA,\n        ComponentManager.Capability.DRAG_TARGET,\n      ],\n    });\n  }\n\n  /**\n   * Dispose of this flyout.\n   * Unlink from all DOM elements to prevent memory leaks.\n   *\n   * @suppress {checkTypes}\n   */\n  dispose() {\n    this.hide();\n    this.workspace_.getComponentManager().removeComponent(this.id);\n    browserEvents.unbind(this.eventWrappers_);\n    if (this.filterWrapper_) {\n      this.targetWorkspace.removeChangeListener(this.filterWrapper_);\n      this.filterWrapper_ = null;\n    }\n    if (this.workspace_) {\n      this.workspace_.getThemeManager().unsubscribe(this.svgBackground_!);\n      this.workspace_.dispose();\n    }\n    if (this.svgGroup_) {\n      dom.removeNode(this.svgGroup_);\n      this.svgGroup_ = null;\n    }\n    this.svgBackground_ = null;\n  }\n\n  /**\n   * Get the width of the flyout.\n   *\n   * @returns The width of the flyout.\n   */\n  getWidth(): number {\n    return this.width_;\n  }\n\n  /**\n   * Get the height of the flyout.\n   *\n   * @returns The width of the flyout.\n   */\n  getHeight(): number {\n    return this.height_;\n  }\n\n  /**\n   * Get the scale (zoom level) of the flyout. By default,\n   * this matches the target workspace scale, but this can be overridden.\n   *\n   * @returns Flyout workspace scale.\n   */\n  getFlyoutScale(): number {\n    return this.targetWorkspace.scale;\n  }\n\n  /**\n   * Get the workspace inside the flyout.\n   *\n   * @returns The workspace inside the flyout.\n   * @internal\n   */\n  getWorkspace(): WorkspaceSvg {\n    return this.workspace_;\n  }\n\n  /**\n   * Is the flyout visible?\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.isVisible_;\n  }\n\n  /**\n   * Set whether the flyout is visible. A value of true does not necessarily\n   * mean that the flyout is shown. It could be hidden because its container is\n   * hidden.\n   *\n   * @param visible True if visible.\n   */\n  setVisible(visible: boolean) {\n    const visibilityChanged = visible !== this.isVisible();\n\n    this.isVisible_ = visible;\n    if (visibilityChanged) {\n      if (!this.autoClose) {\n        // Auto-close flyouts are ignored as drag targets, so only non\n        // auto-close flyouts need to have their drag target updated.\n        this.workspace_.recordDragTargets();\n      }\n      this.updateDisplay_();\n    }\n  }\n\n  /**\n   * Set whether this flyout's container is visible.\n   *\n   * @param visible Whether the container is visible.\n   */\n  setContainerVisible(visible: boolean) {\n    const visibilityChanged = visible !== this.containerVisible_;\n    this.containerVisible_ = visible;\n    if (visibilityChanged) {\n      this.updateDisplay_();\n    }\n  }\n\n  /**\n   * Update the display property of the flyout based whether it thinks it should\n   * be visible and whether its containing workspace is visible.\n   */\n  private updateDisplay_() {\n    let show = true;\n    if (!this.containerVisible_) {\n      show = false;\n    } else {\n      show = this.isVisible();\n    }\n    if (this.svgGroup_) {\n      this.svgGroup_.style.display = show ? 'block' : 'none';\n    }\n    // Update the scrollbar's visibility too since it should mimic the\n    // flyout's visibility.\n    this.workspace_.scrollbar?.setContainerVisible(show);\n  }\n\n  /**\n   * Update the view based on coordinates calculated in position().\n   *\n   * @param width The computed width of the flyout's SVG group\n   * @param height The computed height of the flyout's SVG group.\n   * @param x The computed x origin of the flyout's SVG group.\n   * @param y The computed y origin of the flyout's SVG group.\n   */\n  protected positionAt_(width: number, height: number, x: number, y: number) {\n    this.svgGroup_?.setAttribute('width', width.toString());\n    this.svgGroup_?.setAttribute('height', height.toString());\n    this.workspace_.setCachedParentSvgSize(width, height);\n\n    if (this.svgGroup_?.tagName === 'svg') {\n      const transform = 'translate(' + x + 'px,' + y + 'px)';\n      dom.setCssTransform(this.svgGroup_, transform);\n    } else {\n      // IE and Edge don't support CSS transforms on SVG elements so\n      // it's important to set the transform on the SVG element itself\n      const transform = 'translate(' + x + ',' + y + ')';\n      this.svgGroup_?.setAttribute('transform', transform);\n    }\n\n    // Update the scrollbar (if one exists).\n    const scrollbar = this.workspace_.scrollbar;\n    if (scrollbar) {\n      // Set the scrollbars origin to be the top left of the flyout.\n      scrollbar.setOrigin(x, y);\n      scrollbar.resize();\n      // If origin changed and metrics haven't changed enough to trigger\n      // reposition in resize, we need to call setPosition. See issue #4692.\n      if (scrollbar.hScroll) {\n        scrollbar.hScroll.setPosition(\n            scrollbar.hScroll.position.x, scrollbar.hScroll.position.y);\n      }\n      if (scrollbar.vScroll) {\n        scrollbar.vScroll.setPosition(\n            scrollbar.vScroll.position.x, scrollbar.vScroll.position.y);\n      }\n    }\n  }\n\n  /**\n   * Hide and empty the flyout.\n   */\n  hide() {\n    if (!this.isVisible()) {\n      return;\n    }\n    this.setVisible(false);\n    // Delete all the event listeners.\n    for (let i = 0, listen; listen = this.listeners_[i]; i++) {\n      browserEvents.unbind(listen);\n    }\n    this.listeners_.length = 0;\n    if (this.reflowWrapper_) {\n      this.workspace_.removeChangeListener(this.reflowWrapper_);\n      this.reflowWrapper_ = null;\n    }\n  }\n  // Do NOT delete the blocks here.  Wait until Flyout.show.\n  // https://neil.fraser.name/news/2014/08/09/\n\n  /**\n   * Show and populate the flyout.\n   *\n   * @param flyoutDef Contents to display\n   *     in the flyout. This is either an array of Nodes, a NodeList, a\n   *     toolbox definition, or a string with the name of the dynamic category.\n   */\n  show(flyoutDef: toolbox.FlyoutDefinition|string) {\n    this.workspace_.setResizesEnabled(false);\n    this.hide();\n    this.clearOldBlocks_();\n\n    // Handle dynamic categories, represented by a name instead of a list.\n    if (typeof flyoutDef === 'string') {\n      flyoutDef = this.getDynamicCategoryContents_(flyoutDef);\n    }\n    this.setVisible(true);\n\n    // Parse the Array, Node or NodeList into a a list of flyout items.\n    const parsedContent = toolbox.convertFlyoutDefToJsonArray(flyoutDef);\n    const flyoutInfo = this.createFlyoutInfo_(parsedContent);\n\n    this.layout_(flyoutInfo.contents, flyoutInfo.gaps);\n\n    // IE 11 is an incompetent browser that fails to fire mouseout events.\n    // When the mouse is over the background, deselect all blocks.\n    function deselectAll(this: Flyout) {\n      const topBlocks = this.workspace_.getTopBlocks(false);\n      for (let i = 0, block; block = topBlocks[i]; i++) {\n        block.removeSelect();\n      }\n    }\n\n    this.listeners_.push(browserEvents.conditionalBind(\n        (this.svgBackground_ as SVGPathElement), 'mouseover', this,\n        deselectAll));\n\n    if (this.horizontalLayout) {\n      this.height_ = 0;\n    } else {\n      this.width_ = 0;\n    }\n    this.workspace_.setResizesEnabled(true);\n    this.reflow();\n\n    this.filterForCapacity_();\n\n    // Correctly position the flyout's scrollbar when it opens.\n    this.position();\n\n    this.reflowWrapper_ = this.reflow.bind(this);\n    this.workspace_.addChangeListener(this.reflowWrapper_);\n    this.emptyRecycledBlocks_();\n  }\n\n  /**\n   * Create the contents array and gaps array necessary to create the layout for\n   * the flyout.\n   *\n   * @param parsedContent The array\n   *     of objects to show in the flyout.\n   * @returns The list of contents and gaps needed to lay out the flyout.\n   */\n  private createFlyoutInfo_(parsedContent: toolbox.FlyoutItemInfoArray):\n      {contents: FlyoutItem[], gaps: number[]} {\n    const contents: FlyoutItem[] = [];\n    const gaps: number[] = [];\n    this.permanentlyDisabled_.length = 0;\n    const defaultGap = this.horizontalLayout ? this.GAP_X : this.GAP_Y;\n    for (let i = 0, contentInfo; contentInfo = parsedContent[i]; i++) {\n      if ('custom' in contentInfo) {\n        const customInfo = (contentInfo as toolbox.DynamicCategoryInfo);\n        const categoryName = customInfo['custom'];\n        const flyoutDef = this.getDynamicCategoryContents_(categoryName);\n        const parsedDynamicContent =\n            toolbox.convertFlyoutDefToJsonArray(flyoutDef);\n        // Replace the element at i with the dynamic content it represents.\n        parsedContent.splice.apply(\n            parsedContent, [i, 1, ...parsedDynamicContent]);\n        contentInfo = parsedContent[i];\n      }\n\n      switch (contentInfo['kind'].toUpperCase()) {\n        case 'BLOCK': {\n          const blockInfo = (contentInfo as toolbox.BlockInfo);\n          const block = this.createFlyoutBlock_(blockInfo);\n          contents.push({type: FlyoutItemType.BLOCK, block: block});\n          this.addBlockGap_(blockInfo, gaps, defaultGap);\n          break;\n        }\n        case 'SEP': {\n          const sepInfo = (contentInfo as toolbox.SeparatorInfo);\n          this.addSeparatorGap_(sepInfo, gaps, defaultGap);\n          break;\n        }\n        case 'LABEL': {\n          const labelInfo = (contentInfo as toolbox.LabelInfo);\n          // A label is a button with different styling.\n          const label = this.createButton_(labelInfo, /** isLabel */ true);\n          contents.push({type: FlyoutItemType.BUTTON, button: label});\n          gaps.push(defaultGap);\n          break;\n        }\n        case 'BUTTON': {\n          const buttonInfo = (contentInfo as toolbox.ButtonInfo);\n          const button = this.createButton_(buttonInfo, /** isLabel */ false);\n          contents.push({type: FlyoutItemType.BUTTON, button: button});\n          gaps.push(defaultGap);\n          break;\n        }\n      }\n    }\n    return {contents: contents, gaps: gaps};\n  }\n\n  /**\n   * Gets the flyout definition for the dynamic category.\n   *\n   * @param categoryName The name of the dynamic category.\n   * @returns The definition of the\n   *     flyout in one of its many forms.\n   */\n  private getDynamicCategoryContents_(categoryName: string):\n      toolbox.FlyoutDefinition {\n    // Look up the correct category generation function and call that to get a\n    // valid XML list.\n    const fnToApply =\n        this.workspace_.targetWorkspace!.getToolboxCategoryCallback(\n            categoryName);\n    if (typeof fnToApply !== 'function') {\n      throw TypeError(\n          'Couldn\\'t find a callback function when opening' +\n          ' a toolbox category.');\n    }\n    return fnToApply(this.workspace_.targetWorkspace!);\n  }\n\n  /**\n   * Creates a flyout button or a flyout label.\n   *\n   * @param btnInfo The object holding information about a button or a label.\n   * @param isLabel True if the button is a label, false otherwise.\n   * @returns The object used to display the button in the\n   *    flyout.\n   */\n  private createButton_(btnInfo: toolbox.ButtonOrLabelInfo, isLabel: boolean):\n      FlyoutButton {\n    const curButton = new FlyoutButton(\n        this.workspace_, (this.targetWorkspace as WorkspaceSvg), btnInfo,\n        isLabel);\n    return curButton;\n  }\n\n  /**\n   * Create a block from the xml and permanently disable any blocks that were\n   * defined as disabled.\n   *\n   * @param blockInfo The info of the block.\n   * @returns The block created from the blockInfo.\n   */\n  private createFlyoutBlock_(blockInfo: toolbox.BlockInfo): BlockSvg {\n    let block;\n    if (blockInfo['blockxml']) {\n      const xml = (typeof blockInfo['blockxml'] === 'string' ?\n                       Xml.textToDom(blockInfo['blockxml']) :\n                       blockInfo['blockxml']) as Element;\n      block = this.getRecycledBlock_(xml.getAttribute('type')!);\n      if (!block) {\n        block = Xml.domToBlock(xml, this.workspace_);\n      }\n    } else {\n      block = this.getRecycledBlock_(blockInfo['type']!);\n      if (!block) {\n        if (blockInfo['enabled'] === undefined) {\n          blockInfo['enabled'] = blockInfo['disabled'] !== 'true' &&\n              blockInfo['disabled'] !== true;\n        }\n        block = blocks.append((blockInfo as blocks.State), this.workspace_);\n      }\n    }\n\n    if (!block.isEnabled()) {\n      // Record blocks that were initially disabled.\n      // Do not enable these blocks as a result of capacity filtering.\n      this.permanentlyDisabled_.push(block);\n    }\n    return (block as BlockSvg);\n  }\n\n  /**\n   * Returns a block from the array of recycled blocks with the given type, or\n   * undefined if one cannot be found.\n   *\n   * @param blockType The type of the block to try to recycle.\n   * @returns The recycled block, or undefined if\n   *     one could not be recycled.\n   */\n  private getRecycledBlock_(blockType: string): BlockSvg|undefined {\n    let index = -1;\n    for (let i = 0; i < this.recycledBlocks_.length; i++) {\n      if (this.recycledBlocks_[i].type === blockType) {\n        index = i;\n        break;\n      }\n    }\n    return index === -1 ? undefined : this.recycledBlocks_.splice(index, 1)[0];\n  }\n\n  /**\n   * Adds a gap in the flyout based on block info.\n   *\n   * @param blockInfo Information about a block.\n   * @param gaps The list of gaps between items in the flyout.\n   * @param defaultGap The default gap between one element and the\n   *     next.\n   */\n  private addBlockGap_(\n      blockInfo: toolbox.BlockInfo, gaps: number[], defaultGap: number) {\n    let gap;\n    if (blockInfo['gap']) {\n      gap = parseInt(blockInfo['gap'].toString(), 10);\n    } else if (blockInfo['blockxml']) {\n      const xml = (typeof blockInfo['blockxml'] === 'string' ?\n                       Xml.textToDom(blockInfo['blockxml']) :\n                       blockInfo['blockxml']) as Element;\n      gap = parseInt(xml.getAttribute('gap')!, 10);\n    }\n    gaps.push(!gap || isNaN(gap) ? defaultGap : gap);\n  }\n\n  /**\n   * Add the necessary gap in the flyout for a separator.\n   *\n   * @param sepInfo The object holding\n   *    information about a separator.\n   * @param gaps The list gaps between items in the flyout.\n   * @param defaultGap The default gap between the button and next\n   *     element.\n   */\n  private addSeparatorGap_(\n      sepInfo: toolbox.SeparatorInfo, gaps: number[], defaultGap: number) {\n    // Change the gap between two toolbox elements.\n    // <sep gap=\"36\"></sep>\n    // The default gap is 24, can be set larger or smaller.\n    // This overwrites the gap attribute on the previous element.\n    const newGap = parseInt(sepInfo['gap']!.toString(), 10);\n    // Ignore gaps before the first block.\n    if (!isNaN(newGap) && gaps.length > 0) {\n      gaps[gaps.length - 1] = newGap;\n    } else {\n      gaps.push(defaultGap);\n    }\n  }\n\n  /**\n   * Delete blocks, mats and buttons from a previous showing of the flyout.\n   */\n  private clearOldBlocks_() {\n    // Delete any blocks from a previous showing.\n    const oldBlocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; block = oldBlocks[i]; i++) {\n      if (this.blockIsRecyclable_(block)) {\n        this.recycleBlock_(block);\n      } else {\n        block.dispose(false, false);\n      }\n    }\n    // Delete any mats from a previous showing.\n    for (let j = 0; j < this.mats_.length; j++) {\n      const rect = this.mats_[j];\n      if (rect) {\n        Tooltip.unbindMouseEvents(rect);\n        dom.removeNode(rect);\n      }\n    }\n    this.mats_.length = 0;\n    // Delete any buttons from a previous showing.\n    for (let i = 0, button; button = this.buttons_[i]; i++) {\n      button.dispose();\n    }\n    this.buttons_.length = 0;\n\n    // Clear potential variables from the previous showing.\n    this.workspace_.getPotentialVariableMap()?.clear();\n  }\n\n  /**\n   * Empties all of the recycled blocks, properly disposing of them.\n   */\n  private emptyRecycledBlocks_() {\n    for (let i = 0; i < this.recycledBlocks_.length; i++) {\n      this.recycledBlocks_[i].dispose();\n    }\n    this.recycledBlocks_ = [];\n  }\n\n  /**\n   * Returns whether the given block can be recycled or not.\n   *\n   * @param _block The block to check for recyclability.\n   * @returns True if the block can be recycled. False otherwise.\n   */\n  protected blockIsRecyclable_(_block: BlockSvg): boolean {\n    // By default, recycling is disabled.\n    return false;\n  }\n\n  /**\n   * Puts a previously created block into the recycle bin and moves it to the\n   * top of the workspace. Used during large workspace swaps to limit the number\n   * of new DOM elements we need to create.\n   *\n   * @param block The block to recycle.\n   */\n  private recycleBlock_(block: BlockSvg) {\n    const xy = block.getRelativeToSurfaceXY();\n    block.moveBy(-xy.x, -xy.y);\n    this.recycledBlocks_.push(block);\n  }\n\n  /**\n   * Add listeners to a block that has been added to the flyout.\n   *\n   * @param root The root node of the SVG group the block is in.\n   * @param block The block to add listeners for.\n   * @param rect The invisible rectangle under the block that acts\n   *     as a mat for that block.\n   */\n  protected addBlockListeners_(\n      root: SVGElement, block: BlockSvg, rect: SVGElement) {\n    this.listeners_.push(browserEvents.conditionalBind(\n        root, 'mousedown', null, this.blockMouseDown_(block)));\n    this.listeners_.push(browserEvents.conditionalBind(\n        rect, 'mousedown', null, this.blockMouseDown_(block)));\n    this.listeners_.push(\n        browserEvents.bind(root, 'mouseenter', block, block.addSelect));\n    this.listeners_.push(\n        browserEvents.bind(root, 'mouseleave', block, block.removeSelect));\n    this.listeners_.push(\n        browserEvents.bind(rect, 'mouseenter', block, block.addSelect));\n    this.listeners_.push(\n        browserEvents.bind(rect, 'mouseleave', block, block.removeSelect));\n  }\n\n  /**\n   * Handle a mouse-down on an SVG block in a non-closing flyout.\n   *\n   * @param block The flyout block to copy.\n   * @returns Function to call when block is clicked.\n   */\n  private blockMouseDown_(block: BlockSvg): Function {\n    return (e: MouseEvent) => {\n      const gesture = this.targetWorkspace.getGesture(e);\n      if (gesture) {\n        gesture.setStartBlock(block);\n        gesture.handleFlyoutStart(e, this);\n      }\n    };\n  }\n\n  /**\n   * Mouse down on the flyout background.  Start a vertical scroll drag.\n   *\n   * @param e Mouse down event.\n   */\n  private onMouseDown_(e: MouseEvent) {\n    const gesture = this.targetWorkspace.getGesture(e);\n    if (gesture) {\n      gesture.handleFlyoutStart(e, this);\n    }\n  }\n\n  /**\n   * Does this flyout allow you to create a new instance of the given block?\n   * Used for deciding if a block can be \"dragged out of\" the flyout.\n   *\n   * @param block The block to copy from the flyout.\n   * @returns True if you can create a new instance of the block, false\n   *    otherwise.\n   * @internal\n   */\n  isBlockCreatable(block: BlockSvg): boolean {\n    return block.isEnabled();\n  }\n\n  /**\n   * Create a copy of this block on the workspace.\n   *\n   * @param originalBlock The block to copy from the flyout.\n   * @returns The newly created block.\n   * @throws {Error} if something went wrong with deserialization.\n   * @internal\n   */\n  createBlock(originalBlock: BlockSvg): BlockSvg {\n    let newBlock = null;\n    eventUtils.disable();\n    const variablesBeforeCreation = this.targetWorkspace.getAllVariables();\n    this.targetWorkspace.setResizesEnabled(false);\n    try {\n      newBlock = this.placeNewBlock_(originalBlock);\n    } finally {\n      eventUtils.enable();\n    }\n\n    // Close the flyout.\n    this.targetWorkspace.hideChaff();\n\n    const newVariables = Variables.getAddedVariables(\n        this.targetWorkspace, variablesBeforeCreation);\n\n    if (eventUtils.isEnabled()) {\n      eventUtils.setGroup(true);\n      // Fire a VarCreate event for each (if any) new variable created.\n      for (let i = 0; i < newVariables.length; i++) {\n        const thisVariable = newVariables[i];\n        eventUtils.fire(\n            new (eventUtils.get(eventUtils.VAR_CREATE))(thisVariable));\n      }\n\n      // Block events come after var events, in case they refer to newly created\n      // variables.\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(newBlock));\n    }\n    if (this.autoClose) {\n      this.hide();\n    } else {\n      this.filterForCapacity_();\n    }\n    return newBlock;\n  }\n\n  /**\n   * Initialize the given button: move it to the correct location,\n   * add listeners, etc.\n   *\n   * @param button The button to initialize and place.\n   * @param x The x position of the cursor during this layout pass.\n   * @param y The y position of the cursor during this layout pass.\n   */\n  protected initFlyoutButton_(button: FlyoutButton, x: number, y: number) {\n    const buttonSvg = button.createDom();\n    button.moveTo(x, y);\n    button.show();\n    // Clicking on a flyout button or label is a lot like clicking on the\n    // flyout background.\n    this.listeners_.push(browserEvents.conditionalBind(\n        buttonSvg, 'mousedown', this, this.onMouseDown_));\n\n    this.buttons_.push(button);\n  }\n\n  /**\n   * Create and place a rectangle corresponding to the given block.\n   *\n   * @param block The block to associate the rect to.\n   * @param x The x position of the cursor during this layout pass.\n   * @param y The y position of the cursor during this layout pass.\n   * @param blockHW The height and width of\n   *     the block.\n   * @param index The index into the mats list where this rect should\n   *     be placed.\n   * @returns Newly created SVG element for the rectangle behind\n   *     the block.\n   */\n  protected createRect_(\n      block: BlockSvg, x: number, y: number,\n      blockHW: {height: number, width: number}, index: number): SVGElement {\n    // Create an invisible rectangle under the block to act as a button.  Just\n    // using the block as a button is poor, since blocks have holes in them.\n    const rect = dom.createSvgElement(Svg.RECT, {\n      'fill-opacity': 0,\n      'x': x,\n      'y': y,\n      'height': blockHW.height,\n      'width': blockHW.width,\n    });\n    (rect as AnyDuringMigration).tooltip = block;\n    Tooltip.bindMouseEvents(rect);\n    // Add the rectangles under the blocks, so that the blocks' tooltips work.\n    this.workspace_.getCanvas().insertBefore(rect, block.getSvgRoot());\n\n    this.rectMap_.set(block, rect);\n    this.mats_[index] = rect;\n    return rect;\n  }\n\n  /**\n   * Move a rectangle to sit exactly behind a block, taking into account tabs,\n   * hats, and any other protrusions we invent.\n   *\n   * @param rect The rectangle to move directly behind the block.\n   * @param block The block the rectangle should be behind.\n   */\n  protected moveRectToBlock_(rect: SVGElement, block: BlockSvg) {\n    const blockHW = block.getHeightWidth();\n    rect.setAttribute('width', blockHW.width.toString());\n    rect.setAttribute('height', blockHW.height.toString());\n\n    const blockXY = block.getRelativeToSurfaceXY();\n    rect.setAttribute('y', blockXY.y.toString());\n    rect.setAttribute(\n        'x', (this.RTL ? blockXY.x - blockHW.width : blockXY.x).toString());\n  }\n\n  /**\n   * Filter the blocks on the flyout to disable the ones that are above the\n   * capacity limit.  For instance, if the user may only place two more blocks\n   * on the workspace, an \"a + b\" block that has two shadow blocks would be\n   * disabled.\n   */\n  private filterForCapacity_() {\n    const blocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; block = blocks[i]; i++) {\n      if (this.permanentlyDisabled_.indexOf(block) === -1) {\n        const enable = this.targetWorkspace.isCapacityAvailable(\n            common.getBlockTypeCounts(block));\n        while (block) {\n          block.setEnabled(enable);\n          block = block.getNextBlock();\n        }\n      }\n    }\n  }\n\n  /**\n   * Reflow blocks and their mats.\n   */\n  reflow() {\n    if (this.reflowWrapper_) {\n      this.workspace_.removeChangeListener(this.reflowWrapper_);\n    }\n    this.reflowInternal_();\n    if (this.reflowWrapper_) {\n      this.workspace_.addChangeListener(this.reflowWrapper_);\n    }\n  }\n\n  /**\n   * @returns True if this flyout may be scrolled with a scrollbar or\n   *     by dragging.\n   * @internal\n   */\n  isScrollable(): boolean {\n    return this.workspace_.scrollbar ? this.workspace_.scrollbar.isVisible() :\n                                       false;\n  }\n\n  /**\n   * Copy a block from the flyout to the workspace and position it correctly.\n   *\n   * @param oldBlock The flyout block to copy.\n   * @returns The new block in the main workspace.\n   */\n  private placeNewBlock_(oldBlock: BlockSvg): BlockSvg {\n    const targetWorkspace = this.targetWorkspace;\n    const svgRootOld = oldBlock.getSvgRoot();\n    if (!svgRootOld) {\n      throw Error('oldBlock is not rendered.');\n    }\n\n    // Clone the block.\n    const json = (blocks.save(oldBlock) as blocks.State);\n    // Normallly this resizes leading to weird jumps. Save it for terminateDrag.\n    targetWorkspace.setResizesEnabled(false);\n    const block = (blocks.append(json, targetWorkspace) as BlockSvg);\n\n    this.positionNewBlock_(oldBlock, block);\n\n    return block;\n  }\n\n  /**\n   * Positions a block on the target workspace.\n   *\n   * @param oldBlock The flyout block being copied.\n   * @param block The block to posiiton.\n   */\n  private positionNewBlock_(oldBlock: BlockSvg, block: BlockSvg) {\n    const targetWorkspace = this.targetWorkspace;\n\n    // The offset in pixels between the main workspace's origin and the upper\n    // left corner of the injection div.\n    const mainOffsetPixels = targetWorkspace.getOriginOffsetInPixels();\n\n    // The offset in pixels between the flyout workspace's origin and the upper\n    // left corner of the injection div.\n    const flyoutOffsetPixels = this.workspace_.getOriginOffsetInPixels();\n\n    // The position of the old block in flyout workspace coordinates.\n    const oldBlockPos = oldBlock.getRelativeToSurfaceXY();\n    // The position of the old block in pixels relative to the flyout\n    // workspace's origin.\n    oldBlockPos.scale(this.workspace_.scale);\n\n    // The position of the old block in pixels relative to the upper left corner\n    // of the injection div.\n    const oldBlockOffsetPixels =\n        Coordinate.sum(flyoutOffsetPixels, oldBlockPos);\n\n    // The position of the old block in pixels relative to the origin of the\n    // main workspace.\n    const finalOffset =\n        Coordinate.difference(oldBlockOffsetPixels, mainOffsetPixels);\n    // The position of the old block in main workspace coordinates.\n    finalOffset.scale(1 / targetWorkspace.scale);\n\n    block.moveTo(new Coordinate(finalOffset.x, finalOffset.y));\n  }\n}\n\n/**\n * A flyout content item.\n */\nexport interface FlyoutItem {\n  type: FlyoutItemType;\n  button?: FlyoutButton|undefined;\n  block?: BlockSvg|undefined;\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Layout code for a vertical variant of the flyout.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.VerticalFlyout');\n\nimport * as browserEvents from './browser_events.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {Flyout, FlyoutItem} from './flyout_base.js';\nimport type {FlyoutButton} from './flyout_button.js';\nimport type {Options} from './options.js';\nimport * as registry from './registry.js';\nimport {Scrollbar} from './scrollbar.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport {Rect} from './utils/rect.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as WidgetDiv from './widgetdiv.js';\n\n\n/**\n * Class for a flyout.\n *\n * @alias Blockly.VerticalFlyout\n */\nexport class VerticalFlyout extends Flyout {\n  /** The name of the vertical flyout in the registry. */\n  static registryName = 'verticalFlyout';\n\n  /** @param workspaceOptions Dictionary of options for the workspace. */\n  constructor(workspaceOptions: Options) {\n    super(workspaceOptions);\n  }\n\n  /**\n   * Sets the translation of the flyout to match the scrollbars.\n   *\n   * @param xyRatio Contains a y property which is a float between 0 and 1\n   *     specifying the degree of scrolling and a similar x property.\n   */\n  protected override setMetrics_(xyRatio: {x: number, y: number}) {\n    if (!this.isVisible()) {\n      return;\n    }\n    const metricsManager = this.workspace_.getMetricsManager();\n    const scrollMetrics = metricsManager.getScrollMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n\n    if (typeof xyRatio.y === 'number') {\n      this.workspace_.scrollY =\n          -(scrollMetrics.top +\n            (scrollMetrics.height - viewMetrics.height) * xyRatio.y);\n    }\n    this.workspace_.translate(\n        this.workspace_.scrollX + absoluteMetrics.left,\n        this.workspace_.scrollY + absoluteMetrics.top);\n  }\n\n  /**\n   * Calculates the x coordinate for the flyout position.\n   *\n   * @returns X coordinate.\n   */\n  override getX(): number {\n    if (!this.isVisible()) {\n      return 0;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const toolboxMetrics = metricsManager.getToolboxMetrics();\n    let x = 0;\n\n    // If this flyout is not the trashcan flyout (e.g. toolbox or mutator).\n    // Trashcan flyout is opposite the main flyout.\n    if (this.targetWorkspace!.toolboxPosition === this.toolboxPosition_) {\n      // If there is a category toolbox.\n      // Simple (flyout-only) toolbox.\n      if (this.targetWorkspace!.getToolbox()) {\n        if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n          x = toolboxMetrics.width;\n        } else {\n          x = viewMetrics.width - this.width_;\n        }\n      } else {\n        if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n          x = 0;\n        } else {\n          // The simple flyout does not cover the workspace.\n          x = viewMetrics.width;\n        }\n      }\n    } else {\n      if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n        x = 0;\n      } else {\n        // Because the anchor point of the flyout is on the left, but we want\n        // to align the right edge of the flyout with the right edge of the\n        // blocklyDiv, we calculate the full width of the div minus the width\n        // of the flyout.\n        x = viewMetrics.width + absoluteMetrics.left - this.width_;\n      }\n    }\n\n    return x;\n  }\n\n  /**\n   * Calculates the y coordinate for the flyout position.\n   *\n   * @returns Y coordinate.\n   */\n  override getY(): number {\n    // Y is always 0 since this is a vertical flyout.\n    return 0;\n  }\n\n  /** Move the flyout to the edge of the workspace. */\n  override position() {\n    if (!this.isVisible() || !this.targetWorkspace!.isVisible()) {\n      return;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const targetWorkspaceViewMetrics = metricsManager.getViewMetrics();\n    this.height_ = targetWorkspaceViewMetrics.height;\n\n    const edgeWidth = this.width_ - this.CORNER_RADIUS;\n    const edgeHeight =\n        targetWorkspaceViewMetrics.height - 2 * this.CORNER_RADIUS;\n    this.setBackgroundPath_(edgeWidth, edgeHeight);\n\n    const x = this.getX();\n    const y = this.getY();\n\n    this.positionAt_(this.width_, this.height_, x, y);\n  }\n\n  /**\n   * Create and set the path for the visible boundaries of the flyout.\n   *\n   * @param width The width of the flyout, not including the rounded corners.\n   * @param height The height of the flyout, not including rounded corners.\n   */\n  private setBackgroundPath_(width: number, height: number) {\n    const atRight = this.toolboxPosition_ === toolbox.Position.RIGHT;\n    const totalWidth = width + this.CORNER_RADIUS;\n\n    // Decide whether to start on the left or right.\n    const path: Array<string|number> =\n        ['M ' + (atRight ? totalWidth : 0) + ',0'];\n    // Top.\n    path.push('h', (atRight ? -width : width));\n    // Rounded corner.\n    path.push(\n        'a', this.CORNER_RADIUS, this.CORNER_RADIUS, 0, 0, atRight ? 0 : 1,\n        atRight ? -this.CORNER_RADIUS : this.CORNER_RADIUS, this.CORNER_RADIUS);\n    // Side closest to workspace.\n    path.push('v', Math.max(0, height));\n    // Rounded corner.\n    path.push(\n        'a', this.CORNER_RADIUS, this.CORNER_RADIUS, 0, 0, atRight ? 0 : 1,\n        atRight ? this.CORNER_RADIUS : -this.CORNER_RADIUS, this.CORNER_RADIUS);\n    // Bottom.\n    path.push('h', (atRight ? width : -width));\n    path.push('z');\n    this.svgBackground_!.setAttribute('d', path.join(' '));\n  }\n\n  /** Scroll the flyout to the top. */\n  override scrollToStart() {\n    this.workspace_.scrollbar?.setY(0);\n  }\n\n  /**\n   * Scroll the flyout.\n   *\n   * @param e Mouse wheel scroll event.\n   */\n  protected override wheel_(e: WheelEvent) {\n    const scrollDelta = browserEvents.getScrollDeltaPixels(e);\n\n    if (scrollDelta.y) {\n      const metricsManager = this.workspace_.getMetricsManager();\n      const scrollMetrics = metricsManager.getScrollMetrics();\n      const viewMetrics = metricsManager.getViewMetrics();\n      const pos = viewMetrics.top - scrollMetrics.top + scrollDelta.y;\n\n      this.workspace_.scrollbar?.setY(pos);\n      // When the flyout moves from a wheel event, hide WidgetDiv and\n      // dropDownDiv.\n      WidgetDiv.hide();\n      dropDownDiv.hideWithoutAnimation();\n    }\n    // Don't scroll the page.\n    e.preventDefault();\n    // Don't propagate mousewheel event (zooming).\n    e.stopPropagation();\n  }\n\n  /**\n   * Lay out the blocks in the flyout.\n   *\n   * @param contents The blocks and buttons to lay out.\n   * @param gaps The visible gaps between blocks.\n   */\n  protected override layout_(contents: FlyoutItem[], gaps: number[]) {\n    this.workspace_.scale = this.targetWorkspace!.scale;\n    const margin = this.MARGIN;\n    const cursorX = this.RTL ? margin : margin + this.tabWidth_;\n    let cursorY = margin;\n\n    for (let i = 0, item; item = contents[i]; i++) {\n      if (item.type === 'block') {\n        const block = item.block;\n        const allBlocks = block!.getDescendants(false);\n        for (let j = 0, child; child = allBlocks[j]; j++) {\n          // Mark blocks as being inside a flyout.  This is used to detect and\n          // prevent the closure of the flyout if the user right-clicks on such\n          // a block.\n          child.isInFlyout = true;\n        }\n        block!.render();\n        const root = block!.getSvgRoot();\n        const blockHW = block!.getHeightWidth();\n        const moveX =\n            block!.outputConnection ? cursorX - this.tabWidth_ : cursorX;\n        block!.moveBy(moveX, cursorY);\n\n        const rect = this.createRect_(\n            block!, this.RTL ? moveX - blockHW.width : moveX, cursorY, blockHW,\n            i);\n\n        this.addBlockListeners_(root, block!, rect);\n\n        cursorY += blockHW.height + gaps[i];\n      } else if (item.type === 'button') {\n        const button = item.button as FlyoutButton;\n        this.initFlyoutButton_(button, cursorX, cursorY);\n        cursorY += button.height + gaps[i];\n      }\n    }\n  }\n\n  /**\n   * Determine if a drag delta is toward the workspace, based on the position\n   * and orientation of the flyout. This is used in determineDragIntention_ to\n   * determine if a new block should be created or if the flyout should scroll.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   * @returns True if the drag is toward the workspace.\n   * @internal\n   */\n  override isDragTowardWorkspace(currentDragDeltaXY: Coordinate): boolean {\n    const dx = currentDragDeltaXY.x;\n    const dy = currentDragDeltaXY.y;\n    // Direction goes from -180 to 180, with 0 toward the right and 90 on top.\n    const dragDirection = Math.atan2(dy, dx) / Math.PI * 180;\n\n    const range = this.dragAngleRange_;\n    // Check for left or right dragging.\n    if (dragDirection < range && dragDirection > -range ||\n        (dragDirection < -180 + range || dragDirection > 180 - range)) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect|null {\n    if (!this.svgGroup_ || this.autoClose || !this.isVisible()) {\n      // The bounding rectangle won't compute correctly if the flyout is closed\n      // and auto-close flyouts aren't valid drag targets (or delete areas).\n      return null;\n    }\n\n    const flyoutRect = this.svgGroup_.getBoundingClientRect();\n    // BIG_NUM is offscreen padding so that blocks dragged beyond the shown\n    // flyout area are still deleted.  Must be larger than the largest screen\n    // size, but be smaller than half Number.MAX_SAFE_INTEGER (not available on\n    // IE).\n    const BIG_NUM = 1000000000;\n    const left = flyoutRect.left;\n\n    if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n      const width = flyoutRect.width;\n      return new Rect(-BIG_NUM, BIG_NUM, -BIG_NUM, left + width);\n    } else {  // Right\n      return new Rect(-BIG_NUM, BIG_NUM, left, BIG_NUM);\n    }\n  }\n\n  /**\n   * Compute width of flyout.  toolbox.Position mat under each block.\n   * For RTL: Lay out the blocks and buttons to be right-aligned.\n   */\n  protected override reflowInternal_() {\n    this.workspace_.scale = this.getFlyoutScale();\n    let flyoutWidth = 0;\n    const blocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; block = blocks[i]; i++) {\n      let width = block.getHeightWidth().width;\n      if (block.outputConnection) {\n        width -= this.tabWidth_;\n      }\n      flyoutWidth = Math.max(flyoutWidth, width);\n    }\n    for (let i = 0, button; button = this.buttons_[i]; i++) {\n      flyoutWidth = Math.max(flyoutWidth, button.width);\n    }\n    flyoutWidth += this.MARGIN * 1.5 + this.tabWidth_;\n    flyoutWidth *= this.workspace_.scale;\n    flyoutWidth += Scrollbar.scrollbarThickness;\n\n    if (this.width_ !== flyoutWidth) {\n      for (let i = 0, block; block = blocks[i]; i++) {\n        if (this.RTL) {\n          // With the flyoutWidth known, right-align the blocks.\n          const oldX = block.getRelativeToSurfaceXY().x;\n          let newX = flyoutWidth / this.workspace_.scale - this.MARGIN;\n          if (!block.outputConnection) {\n            newX -= this.tabWidth_;\n          }\n          block.moveBy(newX - oldX, 0);\n        }\n        if (this.rectMap_.has(block)) {\n          this.moveRectToBlock_(this.rectMap_.get(block)!, block);\n        }\n      }\n      if (this.RTL) {\n        // With the flyoutWidth known, right-align the buttons.\n        for (let i = 0, button; button = this.buttons_[i]; i++) {\n          const y = button.getPosition().y;\n          const x = flyoutWidth / this.workspace_.scale - button.width -\n              this.MARGIN - this.tabWidth_;\n          button.moveTo(x, y);\n        }\n      }\n\n      if (this.targetWorkspace!.toolboxPosition === this.toolboxPosition_ &&\n          this.toolboxPosition_ === toolbox.Position.LEFT &&\n          !this.targetWorkspace!.getToolbox()) {\n        // This flyout is a simple toolbox. Reposition the workspace so that\n        // (0,0) is in the correct position relative to the new absolute edge\n        // (ie toolbox edge).\n        this.targetWorkspace!.translate(\n            this.targetWorkspace!.scrollX + flyoutWidth,\n            this.targetWorkspace!.scrollY);\n      }\n      this.width_ = flyoutWidth;\n      this.position();\n      this.targetWorkspace!.recordDragTargets();\n    }\n  }\n}\n\nregistry.register(\n    registry.Type.FLYOUTS_VERTICAL_TOOLBOX, registry.DEFAULT, VerticalFlyout);\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Horizontal flyout tray containing blocks which may be created.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.HorizontalFlyout');\n\nimport * as browserEvents from './browser_events.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {Flyout, FlyoutItem} from './flyout_base.js';\nimport type {FlyoutButton} from './flyout_button.js';\nimport type {Options} from './options.js';\nimport * as registry from './registry.js';\nimport {Scrollbar} from './scrollbar.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport {Rect} from './utils/rect.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as WidgetDiv from './widgetdiv.js';\n\n\n/**\n * Class for a flyout.\n *\n * @alias Blockly.HorizontalFlyout\n */\nexport class HorizontalFlyout extends Flyout {\n  override horizontalLayout = true;\n\n  /** @param workspaceOptions Dictionary of options for the workspace. */\n  constructor(workspaceOptions: Options) {\n    super(workspaceOptions);\n  }\n\n  /**\n   * Sets the translation of the flyout to match the scrollbars.\n   *\n   * @param xyRatio Contains a y property which is a float between 0 and 1\n   *     specifying the degree of scrolling and a similar x property.\n   */\n  protected override setMetrics_(xyRatio: {x: number, y: number}) {\n    if (!this.isVisible()) {\n      return;\n    }\n\n    const metricsManager = this.workspace_.getMetricsManager();\n    const scrollMetrics = metricsManager.getScrollMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n\n    if (typeof xyRatio.x === 'number') {\n      this.workspace_.scrollX =\n          -(scrollMetrics.left +\n            (scrollMetrics.width - viewMetrics.width) * xyRatio.x);\n    }\n\n    this.workspace_.translate(\n        this.workspace_.scrollX + absoluteMetrics.left,\n        this.workspace_.scrollY + absoluteMetrics.top);\n  }\n\n  /**\n   * Calculates the x coordinate for the flyout position.\n   *\n   * @returns X coordinate.\n   */\n  override getX(): number {\n    // X is always 0 since this is a horizontal flyout.\n    return 0;\n  }\n\n  /**\n   * Calculates the y coordinate for the flyout position.\n   *\n   * @returns Y coordinate.\n   */\n  override getY(): number {\n    if (!this.isVisible()) {\n      return 0;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const toolboxMetrics = metricsManager.getToolboxMetrics();\n\n    let y = 0;\n    const atTop = this.toolboxPosition_ === toolbox.Position.TOP;\n    // If this flyout is not the trashcan flyout (e.g. toolbox or mutator).\n    // Trashcan flyout is opposite the main flyout.\n    if (this.targetWorkspace!.toolboxPosition === this.toolboxPosition_) {\n      // If there is a category toolbox.\n      // Simple (flyout-only) toolbox.\n      if (this.targetWorkspace!.getToolbox()) {\n        if (atTop) {\n          y = toolboxMetrics.height;\n        } else {\n          y = viewMetrics.height - this.height_;\n        }\n      } else {\n        if (atTop) {\n          y = 0;\n        } else {\n          // The simple flyout does not cover the workspace.\n          y = viewMetrics.height;\n        }\n      }\n    } else {\n      if (atTop) {\n        y = 0;\n      } else {\n        // Because the anchor point of the flyout is on the top, but we want\n        // to align the bottom edge of the flyout with the bottom edge of the\n        // blocklyDiv, we calculate the full height of the div minus the height\n        // of the flyout.\n        y = viewMetrics.height + absoluteMetrics.top - this.height_;\n      }\n    }\n\n    return y;\n  }\n\n  /** Move the flyout to the edge of the workspace. */\n  override position() {\n    if (!this.isVisible() || !this.targetWorkspace!.isVisible()) {\n      return;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const targetWorkspaceViewMetrics = metricsManager.getViewMetrics();\n    this.width_ = targetWorkspaceViewMetrics.width;\n\n    const edgeWidth = targetWorkspaceViewMetrics.width - 2 * this.CORNER_RADIUS;\n    const edgeHeight = this.height_ - this.CORNER_RADIUS;\n    this.setBackgroundPath_(edgeWidth, edgeHeight);\n\n    const x = this.getX();\n    const y = this.getY();\n\n    this.positionAt_(this.width_, this.height_, x, y);\n  }\n\n  /**\n   * Create and set the path for the visible boundaries of the flyout.\n   *\n   * @param width The width of the flyout, not including the rounded corners.\n   * @param height The height of the flyout, not including rounded corners.\n   */\n  private setBackgroundPath_(width: number, height: number) {\n    const atTop = this.toolboxPosition_ === toolbox.Position.TOP;\n    // Start at top left.\n    const path: (string|number)[] = ['M 0,' + (atTop ? 0 : this.CORNER_RADIUS)];\n\n    if (atTop) {\n      // Top.\n      path.push('h', width + 2 * this.CORNER_RADIUS);\n      // Right.\n      path.push('v', height);\n      // Bottom.\n      path.push(\n          'a', this.CORNER_RADIUS, this.CORNER_RADIUS, 0, 0, 1,\n          -this.CORNER_RADIUS, this.CORNER_RADIUS);\n      path.push('h', -width);\n      // Left.\n      path.push(\n          'a', this.CORNER_RADIUS, this.CORNER_RADIUS, 0, 0, 1,\n          -this.CORNER_RADIUS, -this.CORNER_RADIUS);\n      path.push('z');\n    } else {\n      // Top.\n      path.push(\n          'a', this.CORNER_RADIUS, this.CORNER_RADIUS, 0, 0, 1,\n          this.CORNER_RADIUS, -this.CORNER_RADIUS);\n      path.push('h', width);\n      // Right.\n      path.push(\n          'a', this.CORNER_RADIUS, this.CORNER_RADIUS, 0, 0, 1,\n          this.CORNER_RADIUS, this.CORNER_RADIUS);\n      path.push('v', height);\n      // Bottom.\n      path.push('h', -width - 2 * this.CORNER_RADIUS);\n      // Left.\n      path.push('z');\n    }\n    this.svgBackground_!.setAttribute('d', path.join(' '));\n  }\n\n  /** Scroll the flyout to the top. */\n  override scrollToStart() {\n    this.workspace_.scrollbar?.setX(this.RTL ? Infinity : 0);\n  }\n\n  /**\n   * Scroll the flyout.\n   *\n   * @param e Mouse wheel scroll event.\n   */\n  protected override wheel_(e: WheelEvent) {\n    const scrollDelta = browserEvents.getScrollDeltaPixels(e);\n    const delta = scrollDelta.x || scrollDelta.y;\n\n    if (delta) {\n      const metricsManager = this.workspace_.getMetricsManager();\n      const scrollMetrics = metricsManager.getScrollMetrics();\n      const viewMetrics = metricsManager.getViewMetrics();\n\n      const pos = viewMetrics.left - scrollMetrics.left + delta;\n      this.workspace_.scrollbar?.setX(pos);\n      // When the flyout moves from a wheel event, hide WidgetDiv and\n      // dropDownDiv.\n      WidgetDiv.hide();\n      dropDownDiv.hideWithoutAnimation();\n    }\n    // Don't scroll the page.\n    e.preventDefault();\n    // Don't propagate mousewheel event (zooming).\n    e.stopPropagation();\n  }\n\n  /**\n   * Lay out the blocks in the flyout.\n   *\n   * @param contents The blocks and buttons to lay out.\n   * @param gaps The visible gaps between blocks.\n   */\n  protected override layout_(contents: FlyoutItem[], gaps: number[]) {\n    this.workspace_.scale = this.targetWorkspace!.scale;\n    const margin = this.MARGIN;\n    let cursorX = margin + this.tabWidth_;\n    const cursorY = margin;\n    if (this.RTL) {\n      contents = contents.reverse();\n    }\n\n    for (let i = 0, item; item = contents[i]; i++) {\n      if (item.type === 'block') {\n        const block = item.block;\n        const allBlocks = block!.getDescendants(false);\n        for (let j = 0, child; child = allBlocks[j]; j++) {\n          // Mark blocks as being inside a flyout.  This is used to detect and\n          // prevent the closure of the flyout if the user right-clicks on such\n          // a block.\n          child.isInFlyout = true;\n        }\n        block!.render();\n        const root = block!.getSvgRoot();\n        const blockHW = block!.getHeightWidth();\n        // Figure out where to place the block.\n        const tab = block!.outputConnection ? this.tabWidth_ : 0;\n        let moveX;\n        if (this.RTL) {\n          moveX = cursorX + blockHW.width;\n        } else {\n          moveX = cursorX - tab;\n        }\n        block!.moveBy(moveX, cursorY);\n\n        const rect = this.createRect_(block!, moveX, cursorY, blockHW, i);\n        cursorX += blockHW.width + gaps[i];\n\n        this.addBlockListeners_(root, block!, rect);\n      } else if (item.type === 'button') {\n        const button = item.button as FlyoutButton;\n        this.initFlyoutButton_(button, cursorX, cursorY);\n        cursorX += button.width + gaps[i];\n      }\n    }\n  }\n\n  /**\n   * Determine if a drag delta is toward the workspace, based on the position\n   * and orientation of the flyout. This is used in determineDragIntention_ to\n   * determine if a new block should be created or if the flyout should scroll.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   * @returns True if the drag is toward the workspace.\n   * @internal\n   */\n  override isDragTowardWorkspace(currentDragDeltaXY: Coordinate): boolean {\n    const dx = currentDragDeltaXY.x;\n    const dy = currentDragDeltaXY.y;\n    // Direction goes from -180 to 180, with 0 toward the right and 90 on top.\n    const dragDirection = Math.atan2(dy, dx) / Math.PI * 180;\n\n    const range = this.dragAngleRange_;\n    // Check for up or down dragging.\n    if (dragDirection < 90 + range && dragDirection > 90 - range ||\n        dragDirection > -90 - range && dragDirection < -90 + range) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect|null {\n    if (!this.svgGroup_ || this.autoClose || !this.isVisible()) {\n      // The bounding rectangle won't compute correctly if the flyout is closed\n      // and auto-close flyouts aren't valid drag targets (or delete areas).\n      return null;\n    }\n\n    const flyoutRect = this.svgGroup_.getBoundingClientRect();\n    // BIG_NUM is offscreen padding so that blocks dragged beyond the shown\n    // flyout area are still deleted.  Must be larger than the largest screen\n    // size, but be smaller than half Number.MAX_SAFE_INTEGER (not available on\n    // IE).\n    const BIG_NUM = 1000000000;\n    const top = flyoutRect.top;\n\n    if (this.toolboxPosition_ === toolbox.Position.TOP) {\n      const height = flyoutRect.height;\n      return new Rect(-BIG_NUM, top + height, -BIG_NUM, BIG_NUM);\n    } else {  // Bottom.\n      return new Rect(top, BIG_NUM, -BIG_NUM, BIG_NUM);\n    }\n  }\n\n  /**\n   * Compute height of flyout.  toolbox.Position mat under each block.\n   * For RTL: Lay out the blocks right-aligned.\n   */\n  protected override reflowInternal_() {\n    this.workspace_.scale = this.getFlyoutScale();\n    let flyoutHeight = 0;\n    const blocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; block = blocks[i]; i++) {\n      flyoutHeight = Math.max(flyoutHeight, block.getHeightWidth().height);\n    }\n    const buttons = this.buttons_;\n    for (let i = 0, button; button = buttons[i]; i++) {\n      flyoutHeight = Math.max(flyoutHeight, button.height);\n    }\n    flyoutHeight += this.MARGIN * 1.5;\n    flyoutHeight *= this.workspace_.scale;\n    flyoutHeight += Scrollbar.scrollbarThickness;\n\n    if (this.height_ !== flyoutHeight) {\n      for (let i = 0, block; block = blocks[i]; i++) {\n        if (this.rectMap_.has(block)) {\n          this.moveRectToBlock_(this.rectMap_.get(block)!, block);\n        }\n      }\n\n      if (this.targetWorkspace!.toolboxPosition === this.toolboxPosition_ &&\n          this.toolboxPosition_ === toolbox.Position.TOP &&\n          !this.targetWorkspace!.getToolbox()) {\n        // This flyout is a simple toolbox. Reposition the workspace so that\n        // (0,0) is in the correct position relative to the new absolute edge\n        // (ie toolbox edge).\n        this.targetWorkspace!.translate(\n            this.targetWorkspace!.scrollX,\n            this.targetWorkspace!.scrollY + flyoutHeight);\n      }\n      this.height_ = flyoutHeight;\n      this.position();\n      this.targetWorkspace!.recordDragTargets();\n    }\n  }\n}\n\nregistry.register(\n    registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX, registry.DEFAULT,\n    HorizontalFlyout);\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Variable input field.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldVariable');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport type {Block} from './block.js';\nimport {Field, FieldConfig} from './field.js';\nimport {FieldDropdown} from './field_dropdown.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as internalConstants from './internal_constants.js';\nimport type {Menu} from './menu.js';\nimport type {MenuItem} from './menuitem.js';\nimport {Msg} from './msg.js';\nimport * as parsing from './utils/parsing.js';\nimport type {Sentinel} from './utils/sentinel.js';\nimport {Size} from './utils/size.js';\nimport {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport * as Xml from './xml.js';\n\n\n/**\n * Class for a variable's dropdown field.\n *\n * @alias Blockly.FieldVariable\n */\nexport class FieldVariable extends FieldDropdown {\n  protected override menuGenerator_: AnyDuringMigration[][]|\n      ((this: FieldDropdown) => AnyDuringMigration[][]);\n  defaultVariableName: string;\n\n  /** The type of the default variable for this field. */\n  private defaultType_ = '';\n\n  /**\n   * All of the types of variables that will be available in this field's\n   * dropdown.\n   */\n  variableTypes: string[]|null = [];\n  protected override size_: Size;\n\n  /** The variable model associated with this field. */\n  private variable_: VariableModel|null = null;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /**\n   * @param varName The default name for the variable.\n   *     If null, a unique variable name will be generated.\n   *     Also accepts Field.SKIP_SETUP if you wish to skip setup (only used by\n   * subclasses that want to handle configuration and setting the field value\n   * after their own constructors have run).\n   * @param opt_validator A function that is called to validate changes to the\n   *     field's value. Takes in a variable ID  & returns a validated variable\n   *     ID, or null to abort the change.\n   * @param opt_variableTypes A list of the types of variables to include in the\n   *     dropdown. Will only be used if opt_config is not provided.\n   * @param opt_defaultType The type of variable to create if this field's value\n   *     is not explicitly set.  Defaults to ''. Will only be used if opt_config\n   *     is not provided.\n   * @param opt_config A map of options used to configure the field.\n   *    See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/variable#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n      varName: string|null|Sentinel, opt_validator?: Function,\n      opt_variableTypes?: string[], opt_defaultType?: string,\n      opt_config?: FieldVariableConfig) {\n    super(Field.SKIP_SETUP);\n\n    /**\n     * An array of options for a dropdown list,\n     * or a function which generates these options.\n     */\n    // AnyDuringMigration because:  Type '(this: FieldVariable) => any[][]' is\n    // not assignable to type 'any[][] | ((this: FieldDropdown) => any[][])'.\n    this.menuGenerator_ = FieldVariable.dropdownCreate as AnyDuringMigration;\n\n    /**\n     * The initial variable name passed to this field's constructor, or an\n     * empty string if a name wasn't provided. Used to create the initial\n     * variable.\n     */\n    this.defaultVariableName = typeof varName === 'string' ? varName : '';\n\n    /** The size of the area rendered by the field. */\n    this.size_ = new Size(0, 0);\n\n    if (varName === Field.SKIP_SETUP) {\n      return;\n    }\n\n    if (opt_config) {\n      this.configure_(opt_config);\n    } else {\n      this.setTypes_(opt_variableTypes, opt_defaultType);\n    }\n    if (opt_validator) {\n      this.setValidator(opt_validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldVariableConfig) {\n    super.configure_(config);\n    this.setTypes_(config.variableTypes, config.defaultType);\n  }\n\n  /**\n   * Initialize the model for this field if it has not already been initialized.\n   * If the value has not been set to a variable by the first render, we make up\n   * a variable rather than let the value be invalid.\n   *\n   * @internal\n   */\n  override initModel() {\n    if (this.variable_) {\n      return;  // Initialization already happened.\n    }\n    const variable = Variables.getOrCreateVariablePackage(\n        this.sourceBlock_.workspace, null, this.defaultVariableName,\n        this.defaultType_);\n    // Don't call setValue because we don't want to cause a rerender.\n    this.doValueUpdate_(variable.getId());\n  }\n\n  override shouldAddBorderRect_() {\n    return super.shouldAddBorderRect_() &&\n        (!this.getConstants()!.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW ||\n         this.sourceBlock_.type !== 'variables_get');\n  }\n\n  /**\n   * Initialize this field based on the given XML.\n   *\n   * @param fieldElement The element containing information about the variable\n   *     field's state.\n   */\n  override fromXml(fieldElement: Element) {\n    const id = fieldElement.getAttribute('id');\n    const variableName = fieldElement.textContent;\n    // 'variabletype' should be lowercase, but until July 2019 it was sometimes\n    // recorded as 'variableType'.  Thus we need to check for both.\n    const variableType = fieldElement.getAttribute('variabletype') ||\n        fieldElement.getAttribute('variableType') || '';\n\n    // AnyDuringMigration because:  Argument of type 'string | null' is not\n    // assignable to parameter of type 'string | undefined'.\n    const variable = Variables.getOrCreateVariablePackage(\n        this.sourceBlock_.workspace, id, variableName as AnyDuringMigration,\n        variableType);\n\n    // This should never happen :)\n    if (variableType !== null && variableType !== variable.type) {\n      throw Error(\n          'Serialized variable type with id \\'' + variable.getId() +\n          '\\' had type ' + variable.type + ', and ' +\n          'does not match variable field that references it: ' +\n          Xml.domToText(fieldElement) + '.');\n    }\n\n    this.setValue(variable.getId());\n  }\n\n  /**\n   * Serialize this field to XML.\n   *\n   * @param fieldElement The element to populate with info about the field's\n   *     state.\n   * @returns The element containing info about the field's state.\n   */\n  override toXml(fieldElement: Element): Element {\n    // Make sure the variable is initialized.\n    this.initModel();\n\n    fieldElement.id = this.variable_!.getId();\n    fieldElement.textContent = this.variable_!.name;\n    if (this.variable_!.type) {\n      fieldElement.setAttribute('variabletype', this.variable_!.type);\n    }\n    return fieldElement;\n  }\n\n  /**\n   * Saves this field's value.\n   *\n   * @param doFullSerialization If true, the variable field will serialize the\n   *     full state of the field being referenced (ie ID, name, and type) rather\n   *     than just a reference to it (ie ID).\n   * @returns The state of the variable field.\n   * @internal\n   */\n  override saveState(doFullSerialization?: boolean): AnyDuringMigration {\n    const legacyState = this.saveLegacyState(FieldVariable);\n    if (legacyState !== null) {\n      return legacyState;\n    }\n    // Make sure the variable is initialized.\n    this.initModel();\n    const state = {'id': this.variable_!.getId()};\n    if (doFullSerialization) {\n      (state as AnyDuringMigration)['name'] = this.variable_!.name;\n      (state as AnyDuringMigration)['type'] = this.variable_!.type;\n    }\n    return state;\n  }\n\n  /**\n   * Sets the field's value based on the given state.\n   *\n   * @param state The state of the variable to assign to this variable field.\n   * @internal\n   */\n  override loadState(state: AnyDuringMigration) {\n    if (this.loadLegacyState(FieldVariable, state)) {\n      return;\n    }\n    // This is necessary so that blocks in the flyout can have custom var names.\n    const variable = Variables.getOrCreateVariablePackage(\n        this.sourceBlock_.workspace, state['id'] || null, state['name'],\n        state['type'] || '');\n    this.setValue(variable.getId());\n  }\n\n  /**\n   * Attach this field to a block.\n   *\n   * @param block The block containing this field.\n   */\n  override setSourceBlock(block: Block) {\n    if (block.isShadow()) {\n      throw Error('Variable fields are not allowed to exist on shadow blocks.');\n    }\n    super.setSourceBlock(block);\n  }\n\n  /**\n   * Get the variable's ID.\n   *\n   * @returns Current variable's ID.\n   */\n  override getValue(): string|null {\n    return this.variable_ ? this.variable_.getId() : null;\n  }\n\n  /**\n   * Get the text from this field, which is the selected variable's name.\n   *\n   * @returns The selected variable's name, or the empty string if no variable\n   *     is selected.\n   */\n  override getText(): string {\n    return this.variable_ ? this.variable_.name : '';\n  }\n\n  /**\n   * Get the variable model for the selected variable.\n   * Not guaranteed to be in the variable map on the workspace (e.g. if accessed\n   * after the variable has been deleted).\n   *\n   * @returns The selected variable, or null if none was selected.\n   * @internal\n   */\n  getVariable(): VariableModel|null {\n    return this.variable_;\n  }\n\n  /**\n   * Gets the validation function for this field, or null if not set.\n   * Returns null if the variable is not set, because validators should not\n   * run on the initial setValue call, because the field won't be attached to\n   * a block and workspace at that point.\n   *\n   * @returns Validation function, or null.\n   */\n  override getValidator(): Function|null {\n    // Validators shouldn't operate on the initial setValue call.\n    // Normally this is achieved by calling setValidator after setValue, but\n    // this is not a possibility with variable fields.\n    if (this.variable_) {\n      return this.validator_;\n    }\n    return null;\n  }\n\n  /**\n   * Ensure that the ID belongs to a valid variable of an allowed type.\n   *\n   * @param opt_newValue The ID of the new variable to set.\n   * @returns The validated ID, or null if invalid.\n   */\n  protected override doClassValidation_(opt_newValue?: AnyDuringMigration):\n      string|null {\n    if (opt_newValue === null) {\n      return null;\n    }\n    const newId = opt_newValue as string;\n    const variable = Variables.getVariable(this.sourceBlock_.workspace, newId);\n    if (!variable) {\n      console.warn(\n          'Variable id doesn\\'t point to a real variable! ' +\n          'ID was ' + newId);\n      return null;\n    }\n    // Type Checks.\n    const type = variable.type;\n    if (!this.typeIsAllowed_(type)) {\n      console.warn(\n          'Variable type doesn\\'t match this field!  Type was ' + type);\n      return null;\n    }\n    return newId;\n  }\n\n  /**\n   * Update the value of this variable field, as well as its variable and text.\n   *\n   * The variable ID should be valid at this point, but if a variable field\n   * validator returns a bad ID, this could break.\n   *\n   * @param newId The value to be saved.\n   */\n  protected override doValueUpdate_(newId: AnyDuringMigration) {\n    this.variable_ =\n        Variables.getVariable(this.sourceBlock_.workspace, newId as string);\n    super.doValueUpdate_(newId);\n  }\n\n  /**\n   * Check whether the given variable type is allowed on this field.\n   *\n   * @param type The type to check.\n   * @returns True if the type is in the list of allowed types.\n   */\n  private typeIsAllowed_(type: string): boolean {\n    const typeList = this.getVariableTypes_();\n    if (!typeList) {\n      return true;  // If it's null, all types are valid.\n    }\n    for (let i = 0; i < typeList.length; i++) {\n      if (type === typeList[i]) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Return a list of variable types to include in the dropdown.\n   *\n   * @returns Array of variable types.\n   * @throws {Error} if variableTypes is an empty array.\n   */\n  private getVariableTypes_(): string[] {\n    // TODO (#1513): Try to avoid calling this every time the field is edited.\n    let variableTypes = this.variableTypes;\n    if (variableTypes === null) {\n      // If variableTypes is null, return all variable types.\n      if (this.sourceBlock_ && !this.sourceBlock_.disposed) {\n        return this.sourceBlock_.workspace.getVariableTypes();\n      }\n    }\n    variableTypes = variableTypes || [''];\n    if (variableTypes.length === 0) {\n      // Throw an error if variableTypes is an empty list.\n      const name = this.getText();\n      throw Error(\n          '\\'variableTypes\\' of field variable ' + name + ' was an empty list');\n    }\n    return variableTypes;\n  }\n\n  /**\n   * Parse the optional arguments representing the allowed variable types and\n   * the default variable type.\n   *\n   * @param opt_variableTypes A list of the types of variables to include in the\n   *     dropdown.  If null or undefined, variables of all types will be\n   *     displayed in the dropdown.\n   * @param opt_defaultType The type of the variable to create if this field's\n   *     value is not explicitly set.  Defaults to ''.\n   */\n  private setTypes_(opt_variableTypes?: string[], opt_defaultType?: string) {\n    // If you expected that the default type would be the same as the only entry\n    // in the variable types array, tell the Blockly team by commenting on\n    // #1499.\n    const defaultType = opt_defaultType || '';\n    let variableTypes;\n    // Set the allowable variable types.  Null means all types on the workspace.\n    if (opt_variableTypes === null || opt_variableTypes === undefined) {\n      variableTypes = null;\n    } else if (Array.isArray(opt_variableTypes)) {\n      variableTypes = opt_variableTypes;\n      // Make sure the default type is valid.\n      let isInArray = false;\n      for (let i = 0; i < variableTypes.length; i++) {\n        if (variableTypes[i] === defaultType) {\n          isInArray = true;\n        }\n      }\n      if (!isInArray) {\n        throw Error(\n            'Invalid default type \\'' + defaultType + '\\' in ' +\n            'the definition of a FieldVariable');\n      }\n    } else {\n      throw Error(\n          '\\'variableTypes\\' was not an array in the definition of ' +\n          'a FieldVariable');\n    }\n    // Only update the field once all checks pass.\n    this.defaultType_ = defaultType;\n    this.variableTypes = variableTypes;\n  }\n\n  /**\n   * Refreshes the name of the variable by grabbing the name of the model.\n   * Used when a variable gets renamed, but the ID stays the same. Should only\n   * be called by the block.\n   *\n   * @internal\n   */\n  override refreshVariableName() {\n    this.forceRerender();\n  }\n\n  /**\n   * Handle the selection of an item in the variable dropdown menu.\n   * Special case the 'Rename variable...' and 'Delete variable...' options.\n   * In the rename case, prompt the user for a new name.\n   *\n   * @param menu The Menu component clicked.\n   * @param menuItem The MenuItem selected within menu.\n   */\n  protected override onItemSelected_(menu: Menu, menuItem: MenuItem) {\n    const id = menuItem.getValue();\n    // Handle special cases.\n    if (this.sourceBlock_ && !this.sourceBlock_.disposed) {\n      if (id === internalConstants.RENAME_VARIABLE_ID) {\n        // Rename variable.\n        Variables.renameVariable(\n            this.sourceBlock_.workspace, this.variable_ as VariableModel);\n        return;\n      } else if (id === internalConstants.DELETE_VARIABLE_ID) {\n        // Delete variable.\n        this.sourceBlock_.workspace.deleteVariableById(this.variable_!.getId());\n        return;\n      }\n    }\n    // Handle unspecial case.\n    this.setValue(id);\n  }\n\n  /**\n   * Overrides referencesVariables(), indicating this field refers to a\n   * variable.\n   *\n   * @returns True.\n   * @internal\n   */\n  override referencesVariables(): boolean {\n    return true;\n  }\n\n  /**\n   * Construct a FieldVariable from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (variable, variableTypes, and\n   *     defaultType).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(options: FieldVariableFromJsonConfig):\n      FieldVariable {\n    const varName = parsing.replaceMessageReferences(options.variable);\n    // `this` might be a subclass of FieldVariable if that class doesn't\n    // override the static fromJson method.\n    return new this(varName, undefined, undefined, undefined, options);\n  }\n\n  /**\n   * Return a sorted list of variable names for variable dropdown menus.\n   * Include a special option at the end for creating a new variable name.\n   *\n   * @returns Array of variable names/id tuples.\n   */\n  static dropdownCreate(this: FieldVariable): AnyDuringMigration[][] {\n    if (!this.variable_) {\n      throw Error(\n          'Tried to call dropdownCreate on a variable field with no' +\n          ' variable selected.');\n    }\n    const name = this.getText();\n    let variableModelList: AnyDuringMigration[] = [];\n    if (this.sourceBlock_ && !this.sourceBlock_.disposed) {\n      const variableTypes = this.getVariableTypes_();\n      // Get a copy of the list, so that adding rename and new variable options\n      // doesn't modify the workspace's list.\n      for (let i = 0; i < variableTypes.length; i++) {\n        const variableType = variableTypes[i];\n        const variables =\n            this.sourceBlock_.workspace.getVariablesOfType(variableType);\n        variableModelList = variableModelList.concat(variables);\n      }\n    }\n    variableModelList.sort(VariableModel.compareByName);\n\n    const options = [];\n    for (let i = 0; i < variableModelList.length; i++) {\n      // Set the UUID as the internal representation of the variable.\n      options[i] = [variableModelList[i].name, variableModelList[i].getId()];\n    }\n    options.push(\n        [Msg['RENAME_VARIABLE'], internalConstants.RENAME_VARIABLE_ID]);\n    if (Msg['DELETE_VARIABLE']) {\n      options.push([\n        Msg['DELETE_VARIABLE'].replace('%1', name),\n        internalConstants.DELETE_VARIABLE_ID,\n      ]);\n    }\n\n    return options;\n  }\n}\n\nfieldRegistry.register('field_variable', FieldVariable);\n\n/**\n * Config options for the variable field.\n */\nexport interface FieldVariableConfig extends FieldConfig {\n  variableTypes?: string[];\n  defaultType?: string;\n}\n\n/**\n * fromJson config options for the variable field.\n */\nexport interface FieldVariableFromJsonConfig extends FieldVariableConfig {\n  variable?: string;\n}\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Number input field\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldNumber');\n\nimport {Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {FieldTextInputConfig, FieldTextInput} from './field_textinput.js';\nimport * as aria from './utils/aria.js';\nimport type {Sentinel} from './utils/sentinel.js';\n\n\n/**\n * Class for an editable number field.\n *\n * @alias Blockly.FieldNumber\n */\nexport class FieldNumber extends FieldTextInput {\n  /** The minimum value this number field can contain. */\n  protected min_ = -Infinity;\n\n  /** The maximum value this number field can contain. */\n  protected max_ = Infinity;\n\n  /** The multiple to which this fields value is rounded. */\n  protected precision_ = 0;\n\n  /**\n   * The number of decimal places to allow, or null to allow any number of\n   * decimal digits.\n   */\n  private decimalPlaces_: number|null = null;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /**\n   * @param opt_value The initial value of the field. Should cast to a number.\n   *     Defaults to 0. Also accepts Field.SKIP_SETUP if you wish to skip setup\n   *     (only used by subclasses that want to handle configuration and setting\n   *     the field value after their own constructors have run).\n   * @param opt_min Minimum value. Will only be used if opt_config is not\n   *     provided.\n   * @param opt_max Maximum value. Will only be used if opt_config is not\n   *     provided.\n   * @param opt_precision Precision for value. Will only be used if opt_config\n   *     is not provided.\n   * @param opt_validator A function that is called to validate changes to the\n   *     field's value. Takes in a number & returns a validated number, or null\n   *     to abort the change.\n   * @param opt_config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/number#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n      opt_value?: string|number|Sentinel, opt_min?: string|number|null,\n      opt_max?: string|number|null, opt_precision?: string|number|null,\n      opt_validator?: Function|null, opt_config?: FieldNumberConfig) {\n    // Pass SENTINEL so that we can define properties before value validation.\n    super(Field.SKIP_SETUP);\n\n    if (opt_value === Field.SKIP_SETUP) {\n      return;\n    }\n    if (opt_config) {\n      this.configure_(opt_config);\n    } else {\n      this.setConstraints(opt_min, opt_max, opt_precision);\n    }\n    this.setValue(opt_value);\n    if (opt_validator) {\n      this.setValidator(opt_validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldNumberConfig) {\n    super.configure_(config);\n    this.setMinInternal_(config.min);\n    this.setMaxInternal_(config.max);\n    this.setPrecisionInternal_(config.precision);\n  }\n\n  /**\n   * Set the maximum, minimum and precision constraints on this field.\n   * Any of these properties may be undefined or NaN to be disabled.\n   * Setting precision (usually a power of 10) enforces a minimum step between\n   * values. That is, the user's value will rounded to the closest multiple of\n   * precision. The least significant digit place is inferred from the\n   * precision. Integers values can be enforces by choosing an integer\n   * precision.\n   *\n   * @param min Minimum value.\n   * @param max Maximum value.\n   * @param precision Precision for value.\n   */\n  setConstraints(\n      min: number|string|undefined|null, max: number|string|undefined|null,\n      precision: number|string|undefined|null) {\n    this.setMinInternal_(min);\n    this.setMaxInternal_(max);\n    this.setPrecisionInternal_(precision);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the minimum value this field can contain. Updates the value to\n   * reflect.\n   *\n   * @param min Minimum value.\n   */\n  setMin(min: number|string|undefined|null) {\n    this.setMinInternal_(min);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the minimum value this field can contain. Called internally to avoid\n   * value updates.\n   *\n   * @param min Minimum value.\n   */\n  private setMinInternal_(min: number|string|undefined|null) {\n    if (min == null) {\n      this.min_ = -Infinity;\n    } else {\n      min = Number(min);\n      if (!isNaN(min)) {\n        this.min_ = min;\n      }\n    }\n  }\n\n  /**\n   * Returns the current minimum value this field can contain. Default is\n   * -Infinity.\n   *\n   * @returns The current minimum value this field can contain.\n   */\n  getMin(): number {\n    return this.min_;\n  }\n\n  /**\n   * Sets the maximum value this field can contain. Updates the value to\n   * reflect.\n   *\n   * @param max Maximum value.\n   */\n  setMax(max: number|string|undefined|null) {\n    this.setMaxInternal_(max);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the maximum value this field can contain. Called internally to avoid\n   * value updates.\n   *\n   * @param max Maximum value.\n   */\n  private setMaxInternal_(max: number|string|undefined|null) {\n    if (max == null) {\n      this.max_ = Infinity;\n    } else {\n      max = Number(max);\n      if (!isNaN(max)) {\n        this.max_ = max;\n      }\n    }\n  }\n\n  /**\n   * Returns the current maximum value this field can contain. Default is\n   * Infinity.\n   *\n   * @returns The current maximum value this field can contain.\n   */\n  getMax(): number {\n    return this.max_;\n  }\n\n  /**\n   * Sets the precision of this field's value, i.e. the number to which the\n   * value is rounded. Updates the field to reflect.\n   *\n   * @param precision The number to which the field's value is rounded.\n   */\n  setPrecision(precision: number|string|undefined|null) {\n    this.setPrecisionInternal_(precision);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the precision of this field's value. Called internally to avoid\n   * value updates.\n   *\n   * @param precision The number to which the field's value is rounded.\n   */\n  private setPrecisionInternal_(precision: number|string|undefined|null) {\n    this.precision_ = Number(precision) || 0;\n    let precisionString = String(this.precision_);\n    if (precisionString.indexOf('e') !== -1) {\n      // String() is fast.  But it turns .0000001 into '1e-7'.\n      // Use the much slower toLocaleString to access all the digits.\n      precisionString =\n          this.precision_.toLocaleString('en-US', {maximumFractionDigits: 20});\n    }\n    const decimalIndex = precisionString.indexOf('.');\n    if (decimalIndex === -1) {\n      // If the precision is 0 (float) allow any number of decimals,\n      // otherwise allow none.\n      this.decimalPlaces_ = precision ? 0 : null;\n    } else {\n      this.decimalPlaces_ = precisionString.length - decimalIndex - 1;\n    }\n  }\n\n  /**\n   * Returns the current precision of this field. The precision being the\n   * number to which the field's value is rounded. A precision of 0 means that\n   * the value is not rounded.\n   *\n   * @returns The number to which this field's value is rounded.\n   */\n  getPrecision(): number {\n    return this.precision_;\n  }\n\n  /**\n   * Ensure that the input value is a valid number (must fulfill the\n   * constraints placed on the field).\n   *\n   * @param opt_newValue The input value.\n   * @returns A valid number, or null if invalid.\n   */\n  protected override doClassValidation_(opt_newValue?: AnyDuringMigration):\n      number|null {\n    if (opt_newValue === null) {\n      return null;\n    }\n    // Clean up text.\n    let newValue = String(opt_newValue);\n    // TODO: Handle cases like 'ten', '1.203,14', etc.\n    // 'O' is sometimes mistaken for '0' by inexperienced users.\n    newValue = newValue.replace(/O/ig, '0');\n    // Strip out thousands separators.\n    newValue = newValue.replace(/,/g, '');\n    // Ignore case of 'Infinity'.\n    newValue = newValue.replace(/infinity/i, 'Infinity');\n\n    // Clean up number.\n    let n = Number(newValue || 0);\n    if (isNaN(n)) {\n      // Invalid number.\n      return null;\n    }\n    // Get the value in range.\n    n = Math.min(Math.max(n, this.min_), this.max_);\n    // Round to nearest multiple of precision.\n    if (this.precision_ && isFinite(n)) {\n      n = Math.round(n / this.precision_) * this.precision_;\n    }\n    // Clean up floating point errors.\n    if (this.decimalPlaces_ !== null) {\n      n = Number(n.toFixed(this.decimalPlaces_));\n    }\n    return n;\n  }\n\n  /**\n   * Create the number input editor widget.\n   *\n   * @returns The newly created number input editor.\n   */\n  protected override widgetCreate_(): HTMLElement {\n    const htmlInput = super.widgetCreate_();\n\n    // Set the accessibility state\n    if (this.min_ > -Infinity) {\n      aria.setState(htmlInput, aria.State.VALUEMIN, this.min_);\n    }\n    if (this.max_ < Infinity) {\n      aria.setState(htmlInput, aria.State.VALUEMAX, this.max_);\n    }\n    return htmlInput;\n  }\n\n  /**\n   * Construct a FieldNumber from a JSON arg object.\n   *\n   * @param options A JSON object with options (value, min, max, and precision).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(options: FieldNumberFromJsonConfig): FieldNumber {\n    // `this` might be a subclass of FieldNumber if that class doesn't override\n    // the static fromJson method.\n    return new this(\n        options.value, undefined, undefined, undefined, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_number', FieldNumber);\n\n(FieldNumber.prototype as AnyDuringMigration).DEFAULT_VALUE = 0;\n\n/**\n * Config options for the number field.\n */\nexport interface FieldNumberConfig extends FieldTextInputConfig {\n  min?: number;\n  max?: number;\n  precision?: number;\n}\n\n/**\n * fromJson config options for the number field.\n */\nexport interface FieldNumberFromJsonConfig extends FieldNumberConfig {\n  value?: number;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Text Area field.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldMultilineInput');\n\nimport * as Css from './css.js';\nimport {Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {FieldTextInputConfig, FieldTextInput} from './field_textinput.js';\nimport * as aria from './utils/aria.js';\nimport * as dom from './utils/dom.js';\nimport {KeyCodes} from './utils/keycodes.js';\nimport * as parsing from './utils/parsing.js';\nimport type {Sentinel} from './utils/sentinel.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as WidgetDiv from './widgetdiv.js';\n\n\n/**\n * Class for an editable text area field.\n *\n * @alias Blockly.FieldMultilineInput\n */\nexport class FieldMultilineInput extends FieldTextInput {\n  /**\n   * The SVG group element that will contain a text element for each text row\n   *     when initialized.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGGElement'.\n  textGroup_: SVGGElement = null as AnyDuringMigration;\n\n  /**\n   * Defines the maximum number of lines of field.\n   * If exceeded, scrolling functionality is enabled.\n   */\n  protected maxLines_ = Infinity;\n\n  /** Whether Y overflow is currently occurring. */\n  protected isOverflowedY_ = false;\n\n  /**\n   * @param opt_value The initial content of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param opt_validator An optional function that is called to validate any\n   *     constraints on what the user entered.  Takes the new text as an\n   *     argument and returns either the accepted text, a replacement text, or\n   *     null to abort the change.\n   * @param opt_config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/multiline-text-input#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n      opt_value?: string|Sentinel, opt_validator?: Function,\n      opt_config?: FieldMultilineInputConfig) {\n    super(Field.SKIP_SETUP);\n\n    if (opt_value === Field.SKIP_SETUP) {\n      return;\n    }\n    if (opt_config) {\n      this.configure_(opt_config);\n    }\n    this.setValue(opt_value);\n    if (opt_validator) {\n      this.setValidator(opt_validator);\n    }\n  }\n\n  protected override configure_(config: FieldMultilineInputConfig) {\n    super.configure_(config);\n    if (config.maxLines) this.setMaxLines(config.maxLines);\n  }\n\n  /**\n   * Serializes this field's value to XML. Should only be called by Blockly.Xml.\n   *\n   * @param fieldElement The element to populate with info about the field's\n   *     state.\n   * @returns The element containing info about the field's state.\n   * @internal\n   */\n  override toXml(fieldElement: Element): Element {\n    // Replace '\\n' characters with HTML-escaped equivalent '&#10'. This is\n    // needed so the plain-text representation of the XML produced by\n    // `Blockly.Xml.domToText` will appear on a single line (this is a\n    // limitation of the plain-text format).\n    fieldElement.textContent =\n        (this.getValue() as string).replace(/\\n/g, '&#10;');\n    return fieldElement;\n  }\n\n  /**\n   * Sets the field's value based on the given XML element. Should only be\n   * called by Blockly.Xml.\n   *\n   * @param fieldElement The element containing info about the field's state.\n   * @internal\n   */\n  override fromXml(fieldElement: Element) {\n    this.setValue(fieldElement.textContent!.replace(/&#10;/g, '\\n'));\n  }\n\n  /**\n   * Saves this field's value.\n   *\n   * @returns The state of this field.\n   * @internal\n   */\n  override saveState(): AnyDuringMigration {\n    const legacyState = this.saveLegacyState(FieldMultilineInput);\n    if (legacyState !== null) {\n      return legacyState;\n    }\n    return this.getValue();\n  }\n\n  /**\n   * Sets the field's value based on the given state.\n   *\n   * @param state The state of the variable to assign to this variable field.\n   * @internal\n   */\n  override loadState(state: AnyDuringMigration) {\n    if (this.loadLegacyState(Field, state)) {\n      return;\n    }\n    this.setValue(state);\n  }\n\n  /**\n   * Create the block UI for this field.\n   *\n   * @internal\n   */\n  override initView() {\n    this.createBorderRect_();\n    this.textGroup_ = dom.createSvgElement(\n        Svg.G, {\n          'class': 'blocklyEditableText',\n        },\n        this.fieldGroup_);\n  }\n\n  /**\n   * Get the text from this field as displayed on screen.  May differ from\n   * getText due to ellipsis, and other formatting.\n   *\n   * @returns Currently displayed text.\n   */\n  protected override getDisplayText_(): string {\n    let textLines = this.getText();\n    if (!textLines) {\n      // Prevent the field from disappearing if empty.\n      return Field.NBSP;\n    }\n    const lines = textLines.split('\\n');\n    textLines = '';\n    const displayLinesNumber =\n        this.isOverflowedY_ ? this.maxLines_ : lines.length;\n    for (let i = 0; i < displayLinesNumber; i++) {\n      let text = lines[i];\n      if (text.length > this.maxDisplayLength) {\n        // Truncate displayed string and add an ellipsis ('...').\n        text = text.substring(0, this.maxDisplayLength - 4) + '...';\n      } else if (this.isOverflowedY_ && i === displayLinesNumber - 1) {\n        text = text.substring(0, text.length - 3) + '...';\n      }\n      // Replace whitespace with non-breaking spaces so the text doesn't\n      // collapse.\n      text = text.replace(/\\s/g, Field.NBSP);\n\n      textLines += text;\n      if (i !== displayLinesNumber - 1) {\n        textLines += '\\n';\n      }\n    }\n    if (this.sourceBlock_.RTL) {\n      // The SVG is LTR, force value to be RTL.\n      textLines += '\\u200F';\n    }\n    return textLines;\n  }\n\n  /**\n   * Called by setValue if the text input is valid. Updates the value of the\n   * field, and updates the text of the field if it is not currently being\n   * edited (i.e. handled by the htmlInput_). Is being redefined here to update\n   * overflow state of the field.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a string.\n   */\n  protected override doValueUpdate_(newValue: AnyDuringMigration) {\n    super.doValueUpdate_(newValue);\n    this.isOverflowedY_ = this.value_.split('\\n').length > this.maxLines_;\n  }\n\n  /** Updates the text of the textElement. */\n  protected override render_() {\n    // Remove all text group children.\n    let currentChild;\n    while (currentChild = this.textGroup_.firstChild) {\n      this.textGroup_.removeChild(currentChild);\n    }\n\n    // Add in text elements into the group.\n    const lines = this.getDisplayText_().split('\\n');\n    let y = 0;\n    for (let i = 0; i < lines.length; i++) {\n      const lineHeight = this.getConstants()!.FIELD_TEXT_HEIGHT +\n          this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING;\n      const span = dom.createSvgElement(\n          Svg.TEXT, {\n            'class': 'blocklyText blocklyMultilineText',\n            'x': this.getConstants()!.FIELD_BORDER_RECT_X_PADDING,\n            'y': y + this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING,\n            'dy': this.getConstants()!.FIELD_TEXT_BASELINE,\n          },\n          this.textGroup_);\n      span.appendChild(document.createTextNode(lines[i]));\n      y += lineHeight;\n    }\n\n    if (this.isBeingEdited_) {\n      const htmlInput = this.htmlInput_ as HTMLElement;\n      if (this.isOverflowedY_) {\n        dom.addClass(htmlInput, 'blocklyHtmlTextAreaInputOverflowedY');\n      } else {\n        dom.removeClass(htmlInput, 'blocklyHtmlTextAreaInputOverflowedY');\n      }\n    }\n\n    this.updateSize_();\n\n    if (this.isBeingEdited_) {\n      if (this.sourceBlock_.RTL) {\n        // in RTL, we need to let the browser reflow before resizing\n        // in order to get the correct bounding box of the borderRect\n        // avoiding issue #2777.\n        setTimeout(this.resizeEditor_.bind(this), 0);\n      } else {\n        this.resizeEditor_();\n      }\n      const htmlInput = this.htmlInput_ as HTMLElement;\n      if (!this.isTextValid_) {\n        dom.addClass(htmlInput, 'blocklyInvalidInput');\n        aria.setState(htmlInput, aria.State.INVALID, true);\n      } else {\n        dom.removeClass(htmlInput, 'blocklyInvalidInput');\n        aria.setState(htmlInput, aria.State.INVALID, false);\n      }\n    }\n  }\n\n  /** Updates the size of the field based on the text. */\n  protected override updateSize_() {\n    const nodes = this.textGroup_.childNodes;\n    let totalWidth = 0;\n    let totalHeight = 0;\n    for (let i = 0; i < nodes.length; i++) {\n      const tspan = nodes[i] as SVGTextElement;\n      const textWidth = dom.getTextWidth(tspan);\n      if (textWidth > totalWidth) {\n        totalWidth = textWidth;\n      }\n      totalHeight += this.getConstants()!.FIELD_TEXT_HEIGHT +\n          (i > 0 ? this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING : 0);\n    }\n    if (this.isBeingEdited_) {\n      // The default width is based on the longest line in the display text,\n      // but when it's being edited, width should be calculated based on the\n      // absolute longest line, even if it would be truncated after editing.\n      // Otherwise we would get wrong editor width when there are more\n      // lines than this.maxLines_.\n      const actualEditorLines = this.value_.split('\\n');\n      const dummyTextElement = dom.createSvgElement(\n          Svg.TEXT, {'class': 'blocklyText blocklyMultilineText'});\n      const fontSize = this.getConstants()!.FIELD_TEXT_FONTSIZE;\n      const fontWeight = this.getConstants()!.FIELD_TEXT_FONTWEIGHT;\n      const fontFamily = this.getConstants()!.FIELD_TEXT_FONTFAMILY;\n\n      for (let i = 0; i < actualEditorLines.length; i++) {\n        if (actualEditorLines[i].length > this.maxDisplayLength) {\n          actualEditorLines[i] =\n              actualEditorLines[i].substring(0, this.maxDisplayLength);\n        }\n        dummyTextElement.textContent = actualEditorLines[i];\n        const lineWidth = dom.getFastTextWidth(\n            dummyTextElement, fontSize, fontWeight, fontFamily);\n        if (lineWidth > totalWidth) {\n          totalWidth = lineWidth;\n        }\n      }\n\n      const scrollbarWidth =\n          this.htmlInput_!.offsetWidth - this.htmlInput_!.clientWidth;\n      totalWidth += scrollbarWidth;\n    }\n    if (this.borderRect_) {\n      totalHeight += this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING * 2;\n      totalWidth += this.getConstants()!.FIELD_BORDER_RECT_X_PADDING * 2;\n      // AnyDuringMigration because:  Argument of type 'number' is not\n      // assignable to parameter of type 'string'.\n      this.borderRect_.setAttribute('width', totalWidth as AnyDuringMigration);\n      // AnyDuringMigration because:  Argument of type 'number' is not\n      // assignable to parameter of type 'string'.\n      this.borderRect_.setAttribute(\n          'height', totalHeight as AnyDuringMigration);\n    }\n    this.size_.width = totalWidth;\n    this.size_.height = totalHeight;\n\n    this.positionBorderRect_();\n  }\n\n  /**\n   * Show the inline free-text editor on top of the text.\n   * Overrides the default behaviour to force rerender in order to\n   * correct block size, based on editor text.\n   *\n   * @param _opt_e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   * @param opt_quietInput True if editor should be created without focus.\n   *     Defaults to false.\n   */\n  override showEditor_(_opt_e?: Event, opt_quietInput?: boolean) {\n    super.showEditor_(_opt_e, opt_quietInput);\n    this.forceRerender();\n  }\n\n  /**\n   * Create the text input editor widget.\n   *\n   * @returns The newly created text input editor.\n   */\n  protected override widgetCreate_(): HTMLTextAreaElement {\n    const div = WidgetDiv.getDiv();\n    const scale = this.workspace_!.getScale();\n\n    const htmlInput = (document.createElement('textarea'));\n    htmlInput.className = 'blocklyHtmlInput blocklyHtmlTextAreaInput';\n    // AnyDuringMigration because:  Argument of type 'boolean' is not assignable\n    // to parameter of type 'string'.\n    htmlInput.setAttribute(\n        'spellcheck', this.spellcheck_ as AnyDuringMigration);\n    const fontSize = this.getConstants()!.FIELD_TEXT_FONTSIZE * scale + 'pt';\n    div!.style.fontSize = fontSize;\n    htmlInput.style.fontSize = fontSize;\n    const borderRadius = FieldTextInput.BORDERRADIUS * scale + 'px';\n    htmlInput.style.borderRadius = borderRadius;\n    const paddingX = this.getConstants()!.FIELD_BORDER_RECT_X_PADDING * scale;\n    const paddingY =\n        this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING * scale / 2;\n    htmlInput.style.padding = paddingY + 'px ' + paddingX + 'px ' + paddingY +\n        'px ' + paddingX + 'px';\n    const lineHeight = this.getConstants()!.FIELD_TEXT_HEIGHT +\n        this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING;\n    htmlInput.style.lineHeight = lineHeight * scale + 'px';\n\n    div!.appendChild(htmlInput);\n\n    htmlInput.value = htmlInput.defaultValue = this.getEditorText_(this.value_);\n    htmlInput.setAttribute('data-untyped-default-value', this.value_);\n    htmlInput.setAttribute('data-old-value', '');\n    if (userAgent.GECKO) {\n      // In FF, ensure the browser reflows before resizing to avoid issue #2777.\n      setTimeout(this.resizeEditor_.bind(this), 0);\n    } else {\n      this.resizeEditor_();\n    }\n\n    this.bindInputEvents_(htmlInput);\n\n    return htmlInput;\n  }\n\n  /**\n   * Sets the maxLines config for this field.\n   *\n   * @param maxLines Defines the maximum number of lines allowed, before\n   *     scrolling functionality is enabled.\n   */\n  setMaxLines(maxLines: number) {\n    if (typeof maxLines === 'number' && maxLines > 0 &&\n        maxLines !== this.maxLines_) {\n      this.maxLines_ = maxLines;\n      this.forceRerender();\n    }\n  }\n\n  /**\n   * Returns the maxLines config of this field.\n   *\n   * @returns The maxLines config value.\n   */\n  getMaxLines(): number {\n    return this.maxLines_;\n  }\n\n  /**\n   * Handle key down to the editor. Override the text input definition of this\n   * so as to not close the editor when enter is typed in.\n   *\n   * @param e Keyboard event.\n   */\n  protected override onHtmlInputKeyDown_(e: Event) {\n    // AnyDuringMigration because:  Property 'keyCode' does not exist on type\n    // 'Event'.\n    if ((e as AnyDuringMigration).keyCode !== KeyCodes.ENTER) {\n      super.onHtmlInputKeyDown_(e);\n    }\n  }\n\n  /**\n   * Construct a FieldMultilineInput from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (text, and spellcheck).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(options: FieldMultilineInputFromJsonConfig):\n      FieldMultilineInput {\n    const text = parsing.replaceMessageReferences(options.text);\n    // `this` might be a subclass of FieldMultilineInput if that class doesn't\n    // override the static fromJson method.\n    return new this(text, undefined, options);\n  }\n}\n\n/** CSS for multiline field.  See css.js for use. */\nCss.register(`\n.blocklyHtmlTextAreaInput {\n  font-family: monospace;\n  resize: none;\n  overflow: hidden;\n  height: 100%;\n  text-align: left;\n}\n\n.blocklyHtmlTextAreaInputOverflowedY {\n  overflow-y: scroll;\n}\n`);\n\nfieldRegistry.register('field_multilinetext', FieldMultilineInput);\n\n/**\n * Config options for the multiline input field.\n */\nexport interface FieldMultilineInputConfig extends FieldTextInputConfig {\n  maxLines?: number;\n}\n\n/**\n * fromJson config options for the multiline input field.\n */\nexport interface FieldMultilineInputFromJsonConfig extends\n    FieldMultilineInputConfig {\n  text?: string;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Non-editable, serializable text field. Behaves like a\n *    normal label but is serialized to XML. It may only be\n *    edited programmatically.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldLabelSerializable');\n\nimport {FieldLabelConfig, FieldLabelFromJsonConfig, FieldLabel} from './field_label.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as parsing from './utils/parsing.js';\n\n\n/**\n * Class for a non-editable, serializable text field.\n *\n * @alias Blockly.FieldLabelSerializable\n */\nexport class FieldLabelSerializable extends FieldLabel {\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. This field should not.\n   */\n  override EDITABLE = false;\n\n  /**\n   * Serializable fields are saved by the XML renderer, non-serializable\n   * fields are not.  This field should be serialized, but only edited\n   * programmatically.\n   */\n  override SERIALIZABLE = true;\n\n  /**\n   * @param opt_value The initial value of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined.\n   * @param opt_class Optional CSS class for the field's text.\n   * @param opt_config A map of options used to configure the field.\n   *    See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/label-serializable#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n      opt_value?: string, opt_class?: string, opt_config?: FieldLabelConfig) {\n    super(String(opt_value ?? ''), opt_class, opt_config);\n  }\n\n  /**\n   * Construct a FieldLabelSerializable from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (text, and class).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(options: FieldLabelFromJsonConfig):\n      FieldLabelSerializable {\n    const text = parsing.replaceMessageReferences(options.text);\n    // `this` might be a subclass of FieldLabelSerializable if that class\n    // doesn't override the static fromJson method.\n    return new this(text, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_label_serializable', FieldLabelSerializable);\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Colour input field.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldColour');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as Css from './css.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {FieldConfig, Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as aria from './utils/aria.js';\nimport * as colour from './utils/colour.js';\nimport * as dom from './utils/dom.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport {KeyCodes} from './utils/keycodes.js';\nimport type {Sentinel} from './utils/sentinel.js';\nimport {Size} from './utils/size.js';\n\n\n/**\n * Class for a colour input field.\n *\n * @alias Blockly.FieldColour\n */\nexport class FieldColour extends Field {\n  /**\n   * An array of colour strings for the palette.\n   * Copied from goog.ui.ColorPicker.SIMPLE_GRID_COLORS\n   * All colour pickers use this unless overridden with setColours.\n   */\n  static COLOURS: string[] = [\n    // grays\n    '#ffffff', '#cccccc', '#c0c0c0', '#999999',\n    '#666666', '#333333', '#000000',  // reds\n    '#ffcccc', '#ff6666', '#ff0000', '#cc0000',\n    '#990000', '#660000', '#330000',  // oranges\n    '#ffcc99', '#ff9966', '#ff9900', '#ff6600',\n    '#cc6600', '#993300', '#663300',  // yellows\n    '#ffff99', '#ffff66', '#ffcc66', '#ffcc33',\n    '#cc9933', '#996633', '#663333',  // olives\n    '#ffffcc', '#ffff33', '#ffff00', '#ffcc00',\n    '#999900', '#666600', '#333300',  // greens\n    '#99ff99', '#66ff99', '#33ff33', '#33cc00',\n    '#009900', '#006600', '#003300',  // turquoises\n    '#99ffff', '#33ffff', '#66cccc', '#00cccc',\n    '#339999', '#336666', '#003333',  // blues\n    '#ccffff', '#66ffff', '#33ccff', '#3366ff',\n    '#3333ff', '#000099', '#000066',  // purples\n    '#ccccff', '#9999ff', '#6666cc', '#6633ff',\n    '#6600cc', '#333399', '#330099',  // violets\n    '#ffccff', '#ff99ff', '#cc66cc', '#cc33cc',\n    '#993399', '#663366', '#330033',\n  ];\n\n  /**\n   * An array of tooltip strings for the palette.  If not the same length as\n   * COLOURS, the colour's hex code will be used for any missing titles.\n   * All colour pickers use this unless overridden with setColours.\n   */\n  static TITLES: string[] = [];\n\n  /**\n   * Number of columns in the palette.\n   * All colour pickers use this unless overridden with setColumns.\n   */\n  static COLUMNS = 7;\n\n  /** The field's colour picker element. */\n  private picker_: Element|null = null;\n\n  /** Index of the currently highlighted element. */\n  private highlightedIndex_: number|null = null;\n\n  /** Mouse click event data. */\n  private onClickWrapper_: browserEvents.Data|null = null;\n\n  /** Mouse move event data. */\n  private onMouseMoveWrapper_: browserEvents.Data|null = null;\n\n  /** Mouse enter event data. */\n  private onMouseEnterWrapper_: browserEvents.Data|null = null;\n\n  /** Mouse leave event data. */\n  private onMouseLeaveWrapper_: browserEvents.Data|null = null;\n\n  /** Key down event data. */\n  private onKeyDownWrapper_: browserEvents.Data|null = null;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /** Mouse cursor style when over the hotspot that initiates the editor. */\n  override CURSOR = 'default';\n\n  /**\n   * Used to tell if the field needs to be rendered the next time the block is\n   * rendered. Colour fields are statically sized, and only need to be\n   * rendered at initialization.\n   */\n  protected override isDirty_ = false;\n\n  /** Array of colours used by this field.  If null, use the global list. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'string[]'.\n  private colours_: string[] = null as AnyDuringMigration;\n\n  /**\n   * Array of colour tooltips used by this field.  If null, use the global\n   * list.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'string[]'.\n  private titles_: string[] = null as AnyDuringMigration;\n\n  /**\n   * Number of colour columns used by this field.  If 0, use the global\n   * setting. By default use the global constants for columns.\n   */\n  private columns_ = 0;\n  override size_: AnyDuringMigration;\n  override clickTarget_: AnyDuringMigration;\n  override value_: AnyDuringMigration;\n\n  /**\n   * @param opt_value The initial value of the field. Should be in '#rrggbb'\n   *     format. Defaults to the first value in the default colour array. Also\n   *     accepts Field.SKIP_SETUP if you wish to skip setup (only used by\n   *     subclasses that want to handle configuration and setting the field\n   *     value after their own constructors have run).\n   * @param opt_validator A function that is called to validate changes to the\n   *     field's value. Takes in a colour string & returns a validated colour\n   *     string ('#rrggbb' format), or null to abort the change.Blockly.\n   * @param opt_config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/colour}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n      opt_value?: string|Sentinel, opt_validator?: Function,\n      opt_config?: FieldColourConfig) {\n    super(Field.SKIP_SETUP);\n\n    if (opt_value === Field.SKIP_SETUP) {\n      return;\n    }\n    if (opt_config) {\n      this.configure_(opt_config);\n    }\n    this.setValue(opt_value);\n    if (opt_validator) {\n      this.setValidator(opt_validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldColourConfig) {\n    super.configure_(config);\n    if (config.colourOptions) this.colours_ = config.colourOptions;\n    if (config.colourTitles) this.titles_ = config.colourTitles;\n    if (config.columns) this.columns_ = config.columns;\n  }\n\n  /**\n   * Create the block UI for this colour field.\n   *\n   * @internal\n   */\n  override initView() {\n    this.size_ = new Size(\n        this.getConstants()!.FIELD_COLOUR_DEFAULT_WIDTH,\n        this.getConstants()!.FIELD_COLOUR_DEFAULT_HEIGHT);\n    if (!this.getConstants()!.FIELD_COLOUR_FULL_BLOCK) {\n      this.createBorderRect_();\n      this.borderRect_.style['fillOpacity'] = '1';\n    } else if (this.sourceBlock_ instanceof BlockSvg) {\n      this.clickTarget_ = this.sourceBlock_.getSvgRoot();\n    }\n  }\n\n  override applyColour() {\n    if (!this.getConstants()!.FIELD_COLOUR_FULL_BLOCK) {\n      if (this.borderRect_) {\n        this.borderRect_.style.fill = this.getValue() as string;\n      }\n    } else if (this.sourceBlock_ instanceof BlockSvg) {\n      this.sourceBlock_.pathObject.svgPath.setAttribute(\n          'fill', this.getValue() as string);\n      this.sourceBlock_.pathObject.svgPath.setAttribute('stroke', '#fff');\n    }\n  }\n\n  /**\n   * Ensure that the input value is a valid colour.\n   *\n   * @param opt_newValue The input value.\n   * @returns A valid colour, or null if invalid.\n   */\n  protected override doClassValidation_(opt_newValue?: AnyDuringMigration):\n      string|null {\n    if (typeof opt_newValue !== 'string') {\n      return null;\n    }\n    return colour.parse(opt_newValue);\n  }\n\n  /**\n   * Update the value of this colour field, and update the displayed colour.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a colour in '#rrggbb' format.\n   */\n  protected override doValueUpdate_(newValue: AnyDuringMigration) {\n    this.value_ = newValue;\n    if (this.borderRect_) {\n      this.borderRect_.style.fill = newValue as string;\n    } else if (\n        this.sourceBlock_ && this.sourceBlock_.rendered &&\n        this.sourceBlock_ instanceof BlockSvg) {\n      this.sourceBlock_.pathObject.svgPath.setAttribute(\n          'fill', newValue as string);\n      this.sourceBlock_.pathObject.svgPath.setAttribute('stroke', '#fff');\n    }\n  }\n\n  /**\n   * Get the text for this field.  Used when the block is collapsed.\n   *\n   * @returns Text representing the value of this field.\n   */\n  override getText(): string {\n    let colour = this.value_ as string;\n    // Try to use #rgb format if possible, rather than #rrggbb.\n    if (/^#(.)\\1(.)\\2(.)\\3$/.test(colour)) {\n      colour = '#' + colour[1] + colour[3] + colour[5];\n    }\n    return colour;\n  }\n\n  /**\n   * Set a custom colour grid for this field.\n   *\n   * @param colours Array of colours for this block, or null to use default\n   *     (FieldColour.COLOURS).\n   * @param opt_titles Optional array of colour tooltips, or null to use default\n   *     (FieldColour.TITLES).\n   * @returns Returns itself (for method chaining).\n   */\n  setColours(colours: string[], opt_titles?: string[]): FieldColour {\n    this.colours_ = colours;\n    if (opt_titles) {\n      this.titles_ = opt_titles;\n    }\n    return this;\n  }\n\n  /**\n   * Set a custom grid size for this field.\n   *\n   * @param columns Number of columns for this block, or 0 to use default\n   *     (FieldColour.COLUMNS).\n   * @returns Returns itself (for method chaining).\n   */\n  setColumns(columns: number): FieldColour {\n    this.columns_ = columns;\n    return this;\n  }\n\n  /** Create and show the colour field's editor. */\n  protected override showEditor_() {\n    this.dropdownCreate_();\n    // AnyDuringMigration because:  Argument of type 'Element | null' is not\n    // assignable to parameter of type 'Node'.\n    dropDownDiv.getContentDiv().appendChild(this.picker_ as AnyDuringMigration);\n\n    dropDownDiv.showPositionedByField(this, this.dropdownDispose_.bind(this));\n\n    // Focus so we can start receiving keyboard events.\n    // AnyDuringMigration because:  Property 'focus' does not exist on type\n    // 'Element'.\n    (this.picker_ as AnyDuringMigration)!.focus({preventScroll: true});\n  }\n\n  /**\n   * Handle a click on a colour cell.\n   *\n   * @param e Mouse event.\n   */\n  private onClick_(e: MouseEvent) {\n    const cell = e.target as Element;\n    const colour = cell && cell.getAttribute('data-colour');\n    if (colour !== null) {\n      this.setValue(colour);\n      dropDownDiv.hideIfOwner(this);\n    }\n  }\n\n  /**\n   * Handle a key down event. Navigate around the grid with the\n   * arrow keys. Enter selects the highlighted colour.\n   *\n   * @param e Keyboard event.\n   */\n  private onKeyDown_(e: KeyboardEvent) {\n    let handled = false;\n    if (e.keyCode === KeyCodes.UP) {\n      this.moveHighlightBy_(0, -1);\n      handled = true;\n    } else if (e.keyCode === KeyCodes.DOWN) {\n      this.moveHighlightBy_(0, 1);\n      handled = true;\n    } else if (e.keyCode === KeyCodes.LEFT) {\n      this.moveHighlightBy_(-1, 0);\n      handled = true;\n    } else if (e.keyCode === KeyCodes.RIGHT) {\n      this.moveHighlightBy_(1, 0);\n      handled = true;\n    } else if (e.keyCode === KeyCodes.ENTER) {\n      // Select the highlighted colour.\n      const highlighted = this.getHighlighted_();\n      if (highlighted) {\n        const colour = highlighted && highlighted.getAttribute('data-colour');\n        if (colour !== null) {\n          this.setValue(colour);\n        }\n      }\n      dropDownDiv.hideWithoutAnimation();\n      handled = true;\n    }\n    if (handled) {\n      e.stopPropagation();\n    }\n  }\n\n  /**\n   * Move the currently highlighted position by dx and dy.\n   *\n   * @param dx Change of x\n   * @param dy Change of y\n   */\n  private moveHighlightBy_(dx: number, dy: number) {\n    if (!this.highlightedIndex_) {\n      return;\n    }\n\n    const colours = this.colours_ || FieldColour.COLOURS;\n    const columns = this.columns_ || FieldColour.COLUMNS;\n\n    // Get the current x and y coordinates\n    let x = this.highlightedIndex_ % columns;\n    let y = Math.floor(this.highlightedIndex_ / columns);\n\n    // Add the offset\n    x += dx;\n    y += dy;\n\n    if (dx < 0) {\n      // Move left one grid cell, even in RTL.\n      // Loop back to the end of the previous row if we have room.\n      if (x < 0 && y > 0) {\n        x = columns - 1;\n        y--;\n      } else if (x < 0) {\n        x = 0;\n      }\n    } else if (dx > 0) {\n      // Move right one grid cell, even in RTL.\n      // Loop to the start of the next row, if there's room.\n      if (x > columns - 1 && y < Math.floor(colours.length / columns) - 1) {\n        x = 0;\n        y++;\n      } else if (x > columns - 1) {\n        x--;\n      }\n    } else if (dy < 0) {\n      // Move up one grid cell, stop at the top.\n      if (y < 0) {\n        y = 0;\n      }\n    } else if (dy > 0) {\n      // Move down one grid cell, stop at the bottom.\n      if (y > Math.floor(colours.length / columns) - 1) {\n        y = Math.floor(colours.length / columns) - 1;\n      }\n    }\n\n    // Move the highlight to the new coordinates.\n    const cell = this.picker_!.childNodes[y].childNodes[x] as Element;\n    const index = y * columns + x;\n    this.setHighlightedCell_(cell, index);\n  }\n\n  /**\n   * Handle a mouse move event. Highlight the hovered colour.\n   *\n   * @param e Mouse event.\n   */\n  private onMouseMove_(e: MouseEvent) {\n    const cell = e.target as Element;\n    const index = cell && Number(cell.getAttribute('data-index'));\n    if (index !== null && index !== this.highlightedIndex_) {\n      this.setHighlightedCell_(cell, index);\n    }\n  }\n\n  /** Handle a mouse enter event. Focus the picker. */\n  private onMouseEnter_() {\n    // AnyDuringMigration because:  Property 'focus' does not exist on type\n    // 'Element'.\n    (this.picker_ as AnyDuringMigration)!.focus({preventScroll: true});\n  }\n\n  /**\n   * Handle a mouse leave event. Blur the picker and unhighlight\n   * the currently highlighted colour.\n   */\n  private onMouseLeave_() {\n    // AnyDuringMigration because:  Property 'blur' does not exist on type\n    // 'Element'.\n    (this.picker_ as AnyDuringMigration)!.blur();\n    const highlighted = this.getHighlighted_();\n    if (highlighted) {\n      dom.removeClass(highlighted, 'blocklyColourHighlighted');\n    }\n  }\n\n  /**\n   * Returns the currently highlighted item (if any).\n   *\n   * @returns Highlighted item (null if none).\n   */\n  private getHighlighted_(): HTMLElement|null {\n    if (!this.highlightedIndex_) {\n      return null;\n    }\n\n    const columns = this.columns_ || FieldColour.COLUMNS;\n    const x = this.highlightedIndex_ % columns;\n    const y = Math.floor(this.highlightedIndex_ / columns);\n    const row = this.picker_!.childNodes[y];\n    if (!row) {\n      return null;\n    }\n    const col = row.childNodes[x] as HTMLElement;\n    return col;\n  }\n\n  /**\n   * Update the currently highlighted cell.\n   *\n   * @param cell the new cell to highlight\n   * @param index the index of the new cell\n   */\n  private setHighlightedCell_(cell: Element, index: number) {\n    // Unhighlight the current item.\n    const highlighted = this.getHighlighted_();\n    if (highlighted) {\n      dom.removeClass(highlighted, 'blocklyColourHighlighted');\n    }\n    // Highlight new item.\n    dom.addClass(cell, 'blocklyColourHighlighted');\n    // Set new highlighted index.\n    this.highlightedIndex_ = index;\n\n    // Update accessibility roles.\n    // AnyDuringMigration because:  Argument of type 'string | null' is not\n    // assignable to parameter of type 'string | number | boolean | string[]'.\n    aria.setState(\n        this.picker_ as Element, aria.State.ACTIVEDESCENDANT,\n        cell.getAttribute('id') as AnyDuringMigration);\n  }\n\n  /** Create a colour picker dropdown editor. */\n  private dropdownCreate_() {\n    const columns = this.columns_ || FieldColour.COLUMNS;\n    const colours = this.colours_ || FieldColour.COLOURS;\n    const titles = this.titles_ || FieldColour.TITLES;\n    const selectedColour = this.getValue();\n    // Create the palette.\n    const table = (document.createElement('table'));\n    table.className = 'blocklyColourTable';\n    table.tabIndex = 0;\n    table.dir = 'ltr';\n    aria.setRole(table, aria.Role.GRID);\n    aria.setState(table, aria.State.EXPANDED, true);\n    aria.setState(\n        table, aria.State.ROWCOUNT, Math.floor(colours.length / columns));\n    aria.setState(table, aria.State.COLCOUNT, columns);\n    let row: Element;\n    for (let i = 0; i < colours.length; i++) {\n      if (i % columns === 0) {\n        row = document.createElement('tr');\n        aria.setRole(row, aria.Role.ROW);\n        table.appendChild(row);\n      }\n      const cell = (document.createElement('td'));\n      row!.appendChild(cell);\n      // This becomes the value, if clicked.\n      cell.setAttribute('data-colour', colours[i]);\n      cell.title = titles[i] || colours[i];\n      cell.id = idGenerator.getNextUniqueId();\n      // AnyDuringMigration because:  Argument of type 'number' is not\n      // assignable to parameter of type 'string'.\n      cell.setAttribute('data-index', i as AnyDuringMigration);\n      aria.setRole(cell, aria.Role.GRIDCELL);\n      aria.setState(cell, aria.State.LABEL, colours[i]);\n      aria.setState(cell, aria.State.SELECTED, colours[i] === selectedColour);\n      cell.style.backgroundColor = colours[i];\n      if (colours[i] === selectedColour) {\n        cell.className = 'blocklyColourSelected';\n        this.highlightedIndex_ = i;\n      }\n    }\n\n    // Configure event handler on the table to listen for any event in a cell.\n    this.onClickWrapper_ = browserEvents.conditionalBind(\n        table, 'click', this, this.onClick_, true);\n    this.onMouseMoveWrapper_ = browserEvents.conditionalBind(\n        table, 'mousemove', this, this.onMouseMove_, true);\n    this.onMouseEnterWrapper_ = browserEvents.conditionalBind(\n        table, 'mouseenter', this, this.onMouseEnter_, true);\n    this.onMouseLeaveWrapper_ = browserEvents.conditionalBind(\n        table, 'mouseleave', this, this.onMouseLeave_, true);\n    this.onKeyDownWrapper_ =\n        browserEvents.conditionalBind(table, 'keydown', this, this.onKeyDown_);\n\n    this.picker_ = table;\n  }\n\n  /** Disposes of events and DOM-references belonging to the colour editor. */\n  private dropdownDispose_() {\n    if (this.onClickWrapper_) {\n      browserEvents.unbind(this.onClickWrapper_);\n      this.onClickWrapper_ = null;\n    }\n    if (this.onMouseMoveWrapper_) {\n      browserEvents.unbind(this.onMouseMoveWrapper_);\n      this.onMouseMoveWrapper_ = null;\n    }\n    if (this.onMouseEnterWrapper_) {\n      browserEvents.unbind(this.onMouseEnterWrapper_);\n      this.onMouseEnterWrapper_ = null;\n    }\n    if (this.onMouseLeaveWrapper_) {\n      browserEvents.unbind(this.onMouseLeaveWrapper_);\n      this.onMouseLeaveWrapper_ = null;\n    }\n    if (this.onKeyDownWrapper_) {\n      browserEvents.unbind(this.onKeyDownWrapper_);\n      this.onKeyDownWrapper_ = null;\n    }\n    this.picker_ = null;\n    this.highlightedIndex_ = null;\n  }\n\n  /**\n   * Construct a FieldColour from a JSON arg object.\n   *\n   * @param options A JSON object with options (colour).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldColourFromJsonConfig): FieldColour {\n    // `this` might be a subclass of FieldColour if that class doesn't override\n    // the static fromJson method.\n    return new this(options['colour'], undefined, options);\n  }\n}\n\n/** The default value for this field. */\n// AnyDuringMigration because:  Property 'DEFAULT_VALUE' is protected and only\n// accessible within class 'FieldColour' and its subclasses.\n(FieldColour.prototype as AnyDuringMigration).DEFAULT_VALUE =\n    FieldColour.COLOURS[0];\n\n/** CSS for colour picker.  See css.js for use. */\nCss.register(`\n.blocklyColourTable {\n  border-collapse: collapse;\n  display: block;\n  outline: none;\n  padding: 1px;\n}\n\n.blocklyColourTable>tr>td {\n  border: .5px solid #888;\n  box-sizing: border-box;\n  cursor: pointer;\n  display: inline-block;\n  height: 20px;\n  padding: 0;\n  width: 20px;\n}\n\n.blocklyColourTable>tr>td.blocklyColourHighlighted {\n  border-color: #eee;\n  box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);\n  position: relative;\n}\n\n.blocklyColourSelected, .blocklyColourSelected:hover {\n  border-color: #eee !important;\n  outline: 1px solid #333;\n  position: relative;\n}\n`);\n\nfieldRegistry.register('field_colour', FieldColour);\n\n/**\n * Config options for the colour field.\n */\nexport interface FieldColourConfig extends FieldConfig {\n  colourOptions?: string[];\n  colourTitles?: string[];\n  columns?: number;\n}\n\n/**\n * fromJson config options for the colour field.\n */\nexport interface FieldColourFromJsonConfig extends FieldColourConfig {\n  colour?: string;\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Checkbox field.  Checked or not checked.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldCheckbox');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport {FieldConfig, Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as dom from './utils/dom.js';\nimport type {Sentinel} from './utils/sentinel.js';\n\n\n/**\n * Class for a checkbox field.\n *\n * @alias Blockly.FieldCheckbox\n */\nexport class FieldCheckbox extends Field {\n  /** Default character for the checkmark. */\n  static readonly CHECK_CHAR = '\\u2713';\n  private checkChar_: string;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /**\n   * Mouse cursor style when over the hotspot that initiates editability.\n   */\n  override CURSOR = 'default';\n  override value_: AnyDuringMigration;\n\n  /**\n   * @param opt_value The initial value of the field. Should either be 'TRUE',\n   *     'FALSE' or a boolean. Defaults to 'FALSE'. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param opt_validator  A function that is called to validate changes to the\n   *     field's value. Takes in a value ('TRUE' or 'FALSE') & returns a\n   *     validated value ('TRUE' or 'FALSE'), or null to abort the change.\n   * @param opt_config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/checkbox#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n      opt_value?: string|boolean|Sentinel, opt_validator?: Function,\n      opt_config?: FieldCheckboxConfig) {\n    super(Field.SKIP_SETUP);\n\n    /**\n     * Character for the check mark. Used to apply a different check mark\n     * character to individual fields.\n     */\n    this.checkChar_ = FieldCheckbox.CHECK_CHAR;\n\n    if (opt_value === Field.SKIP_SETUP) {\n      return;\n    }\n    if (opt_config) {\n      this.configure_(opt_config);\n    }\n    this.setValue(opt_value);\n    if (opt_validator) {\n      this.setValidator(opt_validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldCheckboxConfig) {\n    super.configure_(config);\n    if (config.checkCharacter) this.checkChar_ = config.checkCharacter;\n  }\n\n  /**\n   * Saves this field's value.\n   *\n   * @returns The boolean value held by this field.\n   * @internal\n   */\n  override saveState(): AnyDuringMigration {\n    const legacyState = this.saveLegacyState(FieldCheckbox);\n    if (legacyState !== null) {\n      return legacyState;\n    }\n    return this.getValueBoolean();\n  }\n\n  /**\n   * Create the block UI for this checkbox.\n   *\n   * @internal\n   */\n  override initView() {\n    super.initView();\n\n    dom.addClass((this.textElement_), 'blocklyCheckbox');\n    this.textElement_.style.display = this.value_ ? 'block' : 'none';\n  }\n\n  override render_() {\n    if (this.textContent_) {\n      this.textContent_.nodeValue = this.getDisplayText_();\n    }\n    this.updateSize_(this.getConstants()!.FIELD_CHECKBOX_X_OFFSET);\n  }\n\n  override getDisplayText_() {\n    return this.checkChar_;\n  }\n\n  /**\n   * Set the character used for the check mark.\n   *\n   * @param character The character to use for the check mark, or null to use\n   *     the default.\n   */\n  setCheckCharacter(character: string|null) {\n    this.checkChar_ = character || FieldCheckbox.CHECK_CHAR;\n    this.forceRerender();\n  }\n\n  /** Toggle the state of the checkbox on click. */\n  protected override showEditor_() {\n    this.setValue(!this.value_);\n  }\n\n  /**\n   * Ensure that the input value is valid ('TRUE' or 'FALSE').\n   *\n   * @param opt_newValue The input value.\n   * @returns A valid value ('TRUE' or 'FALSE), or null if invalid.\n   */\n  protected override doClassValidation_(opt_newValue?: AnyDuringMigration):\n      string|null {\n    if (opt_newValue === true || opt_newValue === 'TRUE') {\n      return 'TRUE';\n    }\n    if (opt_newValue === false || opt_newValue === 'FALSE') {\n      return 'FALSE';\n    }\n    return null;\n  }\n\n  /**\n   * Update the value of the field, and update the checkElement.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a either 'TRUE' or 'FALSE'.\n   */\n  protected override doValueUpdate_(newValue: AnyDuringMigration) {\n    this.value_ = this.convertValueToBool_(newValue);\n    // Update visual.\n    if (this.textElement_) {\n      this.textElement_.style.display = this.value_ ? 'block' : 'none';\n    }\n  }\n\n  /**\n   * Get the value of this field, either 'TRUE' or 'FALSE'.\n   *\n   * @returns The value of this field.\n   */\n  override getValue(): string {\n    return this.value_ ? 'TRUE' : 'FALSE';\n  }\n\n  /**\n   * Get the boolean value of this field.\n   *\n   * @returns The boolean value of this field.\n   */\n  getValueBoolean(): boolean {\n    return this.value_ as boolean;\n  }\n\n  /**\n   * Get the text of this field. Used when the block is collapsed.\n   *\n   * @returns Text representing the value of this field ('true' or 'false').\n   */\n  override getText(): string {\n    return String(this.convertValueToBool_(this.value_));\n  }\n\n  /**\n   * Convert a value into a pure boolean.\n   *\n   * Converts 'TRUE' to true and 'FALSE' to false correctly, everything else\n   * is cast to a boolean.\n   *\n   * @param value The value to convert.\n   * @returns The converted value.\n   */\n  private convertValueToBool_(value: AnyDuringMigration): boolean {\n    if (typeof value === 'string') {\n      return value === 'TRUE';\n    } else {\n      return !!value;\n    }\n  }\n\n  /**\n   * Construct a FieldCheckbox from a JSON arg object.\n   *\n   * @param options A JSON object with options (checked).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldCheckboxFromJsonConfig): FieldCheckbox {\n    // `this` might be a subclass of FieldCheckbox if that class doesn't\n    // 'override' the static fromJson method.\n    return new this(options.checked, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_checkbox', FieldCheckbox);\n\n(FieldCheckbox.prototype as AnyDuringMigration).DEFAULT_VALUE = false;\n\n/**\n * Config options for the checkbox field.\n */\nexport interface FieldCheckboxConfig extends FieldConfig {\n  checkCharacter?: string;\n}\n\n/**\n * fromJson config options for the checkbox field.\n */\nexport interface FieldCheckboxFromJsonConfig extends FieldCheckboxConfig {\n  checked?: boolean;\n}\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Angle input field.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldAngle');\n\nimport {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as Css from './css.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {FieldTextInputConfig, FieldTextInput} from './field_textinput.js';\nimport * as dom from './utils/dom.js';\nimport {KeyCodes} from './utils/keycodes.js';\nimport * as math from './utils/math.js';\nimport type {Sentinel} from './utils/sentinel.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as WidgetDiv from './widgetdiv.js';\n\n\n/**\n * Class for an editable angle field.\n *\n * @alias Blockly.FieldAngle\n */\nexport class FieldAngle extends FieldTextInput {\n  /** The default value for this field. */\n  // protected override DEFAULT_VALUE = 0;\n\n  /**\n   * The default amount to round angles to when using a mouse or keyboard nav\n   * input. Must be a positive integer to support keyboard navigation.\n   */\n  static readonly ROUND = 15;\n\n  /** Half the width of protractor image. */\n  static readonly HALF = 100 / 2;\n\n  /**\n   * Default property describing which direction makes an angle field's value\n   * increase. Angle increases clockwise (true) or counterclockwise (false).\n   */\n  static readonly CLOCKWISE = false;\n\n  /**\n   * The default offset of 0 degrees (and all angles). Always offsets in the\n   * counterclockwise direction, regardless of the field's clockwise property.\n   * Usually either 0 (0 = right) or 90 (0 = up).\n   */\n  static readonly OFFSET = 0;\n\n  /**\n   * The default maximum angle to allow before wrapping.\n   * Usually either 360 (for 0 to 359.9) or 180 (for -179.9 to 180).\n   */\n  static readonly WRAP = 360;\n\n  /**\n   * Radius of protractor circle.  Slightly smaller than protractor size since\n   * otherwise SVG crops off half the border at the edges.\n   */\n  static readonly RADIUS: number = FieldAngle.HALF - 1;\n  private clockwise_: boolean;\n  private offset_: number;\n  private wrap_: number;\n  private round_: number;\n\n  /** The angle picker's SVG element. */\n  private editor_: SVGElement|null = null;\n\n  /** The angle picker's gauge path depending on the value. */\n  gauge_: SVGElement|null = null;\n\n  /** The angle picker's line drawn representing the value's angle. */\n  line_: SVGElement|null = null;\n\n  /** The degree symbol for this field. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'SVGTSpanElement'.\n  protected symbol_: SVGTSpanElement = null as AnyDuringMigration;\n\n  /** Wrapper click event data. */\n  private clickWrapper_: browserEvents.Data|null = null;\n\n  /** Surface click event data. */\n  private clickSurfaceWrapper_: browserEvents.Data|null = null;\n\n  /** Surface mouse move event data. */\n  private moveSurfaceWrapper_: browserEvents.Data|null = null;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /**\n   * @param opt_value The initial value of the field. Should cast to a number.\n   *     Defaults to 0. Also accepts Field.SKIP_SETUP if you wish to skip setup\n   *     (only used by subclasses that want to handle configuration and setting\n   *     the field value after their own constructors have run).\n   * @param opt_validator A function that is called to validate changes to the\n   *     field's value. Takes in a number & returns a validated number, or null\n   *     to abort the change.\n   * @param opt_config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/angle#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n      opt_value?: string|number|Sentinel, opt_validator?: Function,\n      opt_config?: FieldAngleConfig) {\n    super(Field.SKIP_SETUP);\n\n    /**\n     * Should the angle increase as the angle picker is moved clockwise (true)\n     * or counterclockwise (false)\n     *\n     * @see FieldAngle.CLOCKWISE\n     */\n    this.clockwise_ = FieldAngle.CLOCKWISE;\n\n    /**\n     * The offset of zero degrees (and all other angles).\n     *\n     * @see FieldAngle.OFFSET\n     */\n    this.offset_ = FieldAngle.OFFSET;\n\n    /**\n     * The maximum angle to allow before wrapping.\n     *\n     * @see FieldAngle.WRAP\n     */\n    this.wrap_ = FieldAngle.WRAP;\n\n    /**\n     * The amount to round angles to when using a mouse or keyboard nav input.\n     *\n     * @see FieldAngle.ROUND\n     */\n    this.round_ = FieldAngle.ROUND;\n\n    if (opt_value === Field.SKIP_SETUP) {\n      return;\n    }\n    if (opt_config) {\n      this.configure_(opt_config);\n    }\n    this.setValue(opt_value);\n    if (opt_validator) {\n      this.setValidator(opt_validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldAngleConfig) {\n    super.configure_(config);\n\n    switch (config.mode) {\n      case Mode.COMPASS:\n        this.clockwise_ = true;\n        this.offset_ = 90;\n        break;\n      case Mode.PROTRACTOR:\n        // This is the default mode, so we could do nothing. But just to\n        // future-proof, we'll set it anyway.\n        this.clockwise_ = false;\n        this.offset_ = 0;\n        break;\n    }\n\n    // Allow individual settings to override the mode setting.\n    if (config.clockwise) this.clockwise_ = config.clockwise;\n    if (config.offset) this.offset_ = config.offset;\n    if (config.wrap) this.wrap_ = config.wrap;\n    if (config.round) this.round_ = config.round;\n  }\n\n  /**\n   * Create the block UI for this field.\n   *\n   * @internal\n   */\n  override initView() {\n    super.initView();\n    // Add the degree symbol to the left of the number, even in RTL (issue\n    // #2380)\n    this.symbol_ = dom.createSvgElement(Svg.TSPAN, {});\n    this.symbol_.appendChild(document.createTextNode('\\u00B0'));\n    this.textElement_.appendChild(this.symbol_);\n  }\n\n  /** Updates the graph when the field rerenders. */\n  protected override render_() {\n    super.render_();\n    this.updateGraph_();\n  }\n\n  /**\n   * Create and show the angle field's editor.\n   *\n   * @param opt_e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   */\n  protected override showEditor_(opt_e?: Event) {\n    // Mobile browsers have issues with in-line textareas (focus & keyboards).\n    const noFocus = userAgent.MOBILE || userAgent.ANDROID || userAgent.IPAD;\n    super.showEditor_(opt_e, noFocus);\n\n    this.dropdownCreate_();\n    // AnyDuringMigration because:  Argument of type 'SVGElement | null' is not\n    // assignable to parameter of type 'Node'.\n    dropDownDiv.getContentDiv().appendChild(this.editor_ as AnyDuringMigration);\n\n    if (this.sourceBlock_ instanceof BlockSvg) {\n      dropDownDiv.setColour(\n          this.sourceBlock_.style.colourPrimary,\n          this.sourceBlock_.style.colourTertiary);\n    }\n\n    // AnyDuringMigration because:  Argument of type 'this' is not assignable to\n    // parameter of type 'Field'.\n    dropDownDiv.showPositionedByField(\n        this as AnyDuringMigration, this.dropdownDispose_.bind(this));\n\n    this.updateGraph_();\n  }\n\n  /** Create the angle dropdown editor. */\n  private dropdownCreate_() {\n    const svg = dom.createSvgElement(Svg.SVG, {\n      'xmlns': dom.SVG_NS,\n      'xmlns:html': dom.HTML_NS,\n      'xmlns:xlink': dom.XLINK_NS,\n      'version': '1.1',\n      'height': FieldAngle.HALF * 2 + 'px',\n      'width': FieldAngle.HALF * 2 + 'px',\n      'style': 'touch-action: none',\n    });\n    const circle = dom.createSvgElement(\n        Svg.CIRCLE, {\n          'cx': FieldAngle.HALF,\n          'cy': FieldAngle.HALF,\n          'r': FieldAngle.RADIUS,\n          'class': 'blocklyAngleCircle',\n        },\n        svg);\n    this.gauge_ =\n        dom.createSvgElement(Svg.PATH, {'class': 'blocklyAngleGauge'}, svg);\n    this.line_ = dom.createSvgElement(\n        Svg.LINE, {\n          'x1': FieldAngle.HALF,\n          'y1': FieldAngle.HALF,\n          'class': 'blocklyAngleLine',\n        },\n        svg);\n    // Draw markers around the edge.\n    for (let angle = 0; angle < 360; angle += 15) {\n      dom.createSvgElement(\n          Svg.LINE, {\n            'x1': FieldAngle.HALF + FieldAngle.RADIUS,\n            'y1': FieldAngle.HALF,\n            'x2': FieldAngle.HALF + FieldAngle.RADIUS -\n                (angle % 45 === 0 ? 10 : 5),\n            'y2': FieldAngle.HALF,\n            'class': 'blocklyAngleMarks',\n            'transform': 'rotate(' + angle + ',' + FieldAngle.HALF + ',' +\n                FieldAngle.HALF + ')',\n          },\n          svg);\n    }\n\n    // The angle picker is different from other fields in that it updates on\n    // mousemove even if it's not in the middle of a drag.  In future we may\n    // change this behaviour.\n    this.clickWrapper_ =\n        browserEvents.conditionalBind(svg, 'click', this, this.hide_);\n    // On touch devices, the picker's value is only updated with a drag. Add\n    // a click handler on the drag surface to update the value if the surface\n    // is clicked.\n    this.clickSurfaceWrapper_ = browserEvents.conditionalBind(\n        circle, 'click', this, this.onMouseMove_, true, true);\n    this.moveSurfaceWrapper_ = browserEvents.conditionalBind(\n        circle, 'mousemove', this, this.onMouseMove_, true, true);\n    this.editor_ = svg;\n  }\n\n  /** Disposes of events and DOM-references belonging to the angle editor. */\n  private dropdownDispose_() {\n    if (this.clickWrapper_) {\n      browserEvents.unbind(this.clickWrapper_);\n      this.clickWrapper_ = null;\n    }\n    if (this.clickSurfaceWrapper_) {\n      browserEvents.unbind(this.clickSurfaceWrapper_);\n      this.clickSurfaceWrapper_ = null;\n    }\n    if (this.moveSurfaceWrapper_) {\n      browserEvents.unbind(this.moveSurfaceWrapper_);\n      this.moveSurfaceWrapper_ = null;\n    }\n    this.gauge_ = null;\n    this.line_ = null;\n  }\n\n  /** Hide the editor. */\n  private hide_() {\n    dropDownDiv.hideIfOwner(this);\n    WidgetDiv.hide();\n  }\n\n  /**\n   * Set the angle to match the mouse's position.\n   *\n   * @param e Mouse move event.\n   */\n  protected onMouseMove_(e: Event) {\n    // Calculate angle.\n    const bBox = this.gauge_!.ownerSVGElement!.getBoundingClientRect();\n    // AnyDuringMigration because:  Property 'clientX' does not exist on type\n    // 'Event'.\n    const dx = (e as AnyDuringMigration).clientX - bBox.left - FieldAngle.HALF;\n    // AnyDuringMigration because:  Property 'clientY' does not exist on type\n    // 'Event'.\n    const dy = (e as AnyDuringMigration).clientY - bBox.top - FieldAngle.HALF;\n    let angle = Math.atan(-dy / dx);\n    if (isNaN(angle)) {\n      // This shouldn't happen, but let's not let this error propagate further.\n      return;\n    }\n    angle = math.toDegrees(angle);\n    // 0: East, 90: North, 180: West, 270: South.\n    if (dx < 0) {\n      angle += 180;\n    } else if (dy > 0) {\n      angle += 360;\n    }\n\n    // Do offsetting.\n    if (this.clockwise_) {\n      angle = this.offset_ + 360 - angle;\n    } else {\n      angle = 360 - (this.offset_ - angle);\n    }\n\n    this.displayMouseOrKeyboardValue_(angle);\n  }\n\n  /**\n   * Handles and displays values that are input via mouse or arrow key input.\n   * These values need to be rounded and wrapped before being displayed so\n   * that the text input's value is appropriate.\n   *\n   * @param angle New angle.\n   */\n  private displayMouseOrKeyboardValue_(angle: number) {\n    if (this.round_) {\n      angle = Math.round(angle / this.round_) * this.round_;\n    }\n    angle = this.wrapValue_(angle);\n    if (angle !== this.value_) {\n      this.setEditorValue_(angle);\n    }\n  }\n\n  /** Redraw the graph with the current angle. */\n  private updateGraph_() {\n    if (!this.gauge_) {\n      return;\n    }\n    // Always display the input (i.e. getText) even if it is invalid.\n    let angleDegrees = Number(this.getText()) + this.offset_;\n    angleDegrees %= 360;\n    let angleRadians = math.toRadians(angleDegrees);\n    const path = ['M ', FieldAngle.HALF, ',', FieldAngle.HALF];\n    let x2 = FieldAngle.HALF;\n    let y2 = FieldAngle.HALF;\n    if (!isNaN(angleRadians)) {\n      const clockwiseFlag = Number(this.clockwise_);\n      const angle1 = math.toRadians(this.offset_);\n      const x1 = Math.cos(angle1) * FieldAngle.RADIUS;\n      const y1 = Math.sin(angle1) * -FieldAngle.RADIUS;\n      if (clockwiseFlag) {\n        angleRadians = 2 * angle1 - angleRadians;\n      }\n      x2 += Math.cos(angleRadians) * FieldAngle.RADIUS;\n      y2 -= Math.sin(angleRadians) * FieldAngle.RADIUS;\n      // Don't ask how the flag calculations work.  They just do.\n      let largeFlag =\n          Math.abs(Math.floor((angleRadians - angle1) / Math.PI) % 2);\n      if (clockwiseFlag) {\n        largeFlag = 1 - largeFlag;\n      }\n      path.push(\n          ' l ', x1, ',', y1, ' A ', FieldAngle.RADIUS, ',', FieldAngle.RADIUS,\n          ' 0 ', largeFlag, ' ', clockwiseFlag, ' ', x2, ',', y2, ' z');\n    }\n    this.gauge_.setAttribute('d', path.join(''));\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.line_!.setAttribute('x2', x2 as AnyDuringMigration);\n    // AnyDuringMigration because:  Argument of type 'number' is not assignable\n    // to parameter of type 'string'.\n    this.line_!.setAttribute('y2', y2 as AnyDuringMigration);\n  }\n\n  /**\n   * Handle key down to the editor.\n   *\n   * @param e Keyboard event.\n   */\n  protected override onHtmlInputKeyDown_(e: Event) {\n    super.onHtmlInputKeyDown_(e);\n\n    let multiplier;\n    // AnyDuringMigration because:  Property 'keyCode' does not exist on type\n    // 'Event'.\n    if ((e as AnyDuringMigration).keyCode === KeyCodes.LEFT) {\n      // decrement (increment in RTL)\n      multiplier = this.sourceBlock_.RTL ? 1 : -1;\n      // AnyDuringMigration because:  Property 'keyCode' does not exist on type\n      // 'Event'.\n    } else if ((e as AnyDuringMigration).keyCode === KeyCodes.RIGHT) {\n      // increment (decrement in RTL)\n      multiplier = this.sourceBlock_.RTL ? -1 : 1;\n      // AnyDuringMigration because:  Property 'keyCode' does not exist on type\n      // 'Event'.\n    } else if ((e as AnyDuringMigration).keyCode === KeyCodes.DOWN) {\n      // decrement\n      multiplier = -1;\n      // AnyDuringMigration because:  Property 'keyCode' does not exist on type\n      // 'Event'.\n    } else if ((e as AnyDuringMigration).keyCode === KeyCodes.UP) {\n      // increment\n      multiplier = 1;\n    }\n    if (multiplier) {\n      const value = this.getValue() as number;\n      this.displayMouseOrKeyboardValue_(value + multiplier * this.round_);\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  }\n\n  /**\n   * Ensure that the input value is a valid angle.\n   *\n   * @param opt_newValue The input value.\n   * @returns A valid angle, or null if invalid.\n   */\n  protected override doClassValidation_(opt_newValue?: AnyDuringMigration):\n      number|null {\n    const value = Number(opt_newValue);\n    if (isNaN(value) || !isFinite(value)) {\n      return null;\n    }\n    return this.wrapValue_(value);\n  }\n\n  /**\n   * Wraps the value so that it is in the range (-360 + wrap, wrap).\n   *\n   * @param value The value to wrap.\n   * @returns The wrapped value.\n   */\n  private wrapValue_(value: number): number {\n    value %= 360;\n    if (value < 0) {\n      value += 360;\n    }\n    if (value > this.wrap_) {\n      value -= 360;\n    }\n    return value;\n  }\n\n  /**\n   * Construct a FieldAngle from a JSON arg object.\n   *\n   * @param options A JSON object with options (angle).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(options: FieldAngleFromJsonConfig): FieldAngle {\n    // `this` might be a subclass of FieldAngle if that class doesn't override\n    // the static fromJson method.\n    return new this(options.angle, undefined, options);\n  }\n}\n\n/** CSS for angle field.  See css.js for use. */\nCss.register(`\n.blocklyAngleCircle {\n  stroke: #444;\n  stroke-width: 1;\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyAngleMarks {\n  stroke: #444;\n  stroke-width: 1;\n}\n\n.blocklyAngleGauge {\n  fill: #f88;\n  fill-opacity: .8;\n  pointer-events: none;\n}\n\n.blocklyAngleLine {\n  stroke: #f00;\n  stroke-width: 2;\n  stroke-linecap: round;\n  pointer-events: none;\n}\n`);\n\nfieldRegistry.register('field_angle', FieldAngle);\n\n(FieldAngle.prototype as AnyDuringMigration).DEFAULT_VALUE = 0;\n\n/**\n * The two main modes of the angle field.\n * Compass specifies:\n *   - clockwise: true\n *   - offset: 90\n *   - wrap: 0\n *   - round: 15\n *\n * Protractor specifies:\n *   - clockwise: false\n *   - offset: 0\n *   - wrap: 0\n *   - round: 15\n */\nexport enum Mode {\n  COMPASS = 'compass',\n  PROTRACTOR = 'protractor',\n}\n\n/**\n * Extra configuration options for the angle field.\n */\nexport interface FieldAngleConfig extends FieldTextInputConfig {\n  mode?: Mode;\n  clockwise?: boolean;\n  offset?: number;\n  wrap?: number;\n  round?: number;\n}\n\n/**\n * fromJson configuration options for the angle field.\n */\nexport interface FieldAngleFromJsonConfig extends FieldAngleConfig {\n  angle?: number;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block move event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.BlockMove');\n\nimport type {Block} from '../block.js';\nimport {ConnectionType} from '../connection_type.js';\nimport * as registry from '../registry.js';\nimport {Coordinate} from '../utils/coordinate.js';\n\nimport {BlockBase} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\n\n\ninterface BlockLocation {\n  parentId: string;\n  inputName: string;\n  coordinate: Coordinate|null;\n}  // eslint-disable-line no-unused-vars\n\n/**\n * Class for a block move event.  Created before the move.\n *\n * @alias Blockly.Events.BlockMove\n */\nexport class BlockMove extends BlockBase {\n  override type: string;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  oldParentId!: string;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  oldInputName!: string;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  oldCoordinate!: Coordinate|null;\n\n  newParentId: string|null = null;\n  newInputName: string|null = null;\n  newCoordinate: Coordinate|null = null;\n\n  /** @param opt_block The moved block.  Undefined for a blank event. */\n  constructor(opt_block?: Block) {\n    super(opt_block);\n\n    /** Type of this event. */\n    this.type = eventUtils.BLOCK_MOVE;\n\n    if (!opt_block) {\n      return;\n    }\n    // Blank event to be populated by fromJson.\n    if (opt_block.isShadow()) {\n      // Moving shadow blocks is handled via disconnection.\n      this.recordUndo = false;\n    }\n\n    const location = this.currentLocation_();\n    this.oldParentId = location.parentId;\n    this.oldInputName = location.inputName;\n    this.oldCoordinate = location.coordinate;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    if (this.newParentId) {\n      json['newParentId'] = this.newParentId;\n    }\n    if (this.newInputName) {\n      json['newInputName'] = this.newInputName;\n    }\n    if (this.newCoordinate) {\n      json['newCoordinate'] = Math.round(this.newCoordinate.x) + ',' +\n          Math.round(this.newCoordinate.y);\n    }\n    if (!this.recordUndo) {\n      json['recordUndo'] = this.recordUndo;\n    }\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.newParentId = json['newParentId'];\n    this.newInputName = json['newInputName'];\n    if (json['newCoordinate']) {\n      const xy = json['newCoordinate'].split(',');\n      this.newCoordinate = new Coordinate(Number(xy[0]), Number(xy[1]));\n    }\n    if (json['recordUndo'] !== undefined) {\n      this.recordUndo = json['recordUndo'];\n    }\n  }\n\n  /** Record the block's new location.  Called after the move. */\n  recordNew() {\n    const location = this.currentLocation_();\n    this.newParentId = location.parentId;\n    this.newInputName = location.inputName;\n    this.newCoordinate = location.coordinate;\n  }\n\n  /**\n   * Returns the parentId and input if the block is connected,\n   *   or the XY location if disconnected.\n   *\n   * @returns Collection of location info.\n   */\n  private currentLocation_(): BlockLocation {\n    const workspace = this.getEventWorkspace_();\n    const block = workspace.getBlockById(this.blockId);\n    const location = {} as BlockLocation;\n    const parent = block!.getParent();\n    if (parent) {\n      location.parentId = parent.id;\n      // AnyDuringMigration because:  Argument of type 'Block | null' is not\n      // assignable to parameter of type 'Block'.\n      const input = parent.getInputWithBlock(block as AnyDuringMigration);\n      if (input) {\n        location.inputName = input.name;\n      }\n    } else {\n      location.coordinate = block!.getRelativeToSurfaceXY();\n    }\n    return location;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return this.oldParentId === this.newParentId &&\n        this.oldInputName === this.newInputName &&\n        Coordinate.equals(this.oldCoordinate, this.newCoordinate);\n  }\n\n  /**\n   * Run a move event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    const block = workspace.getBlockById(this.blockId);\n    if (!block) {\n      console.warn('Can\\'t move non-existent block: ' + this.blockId);\n      return;\n    }\n    const parentId = forward ? this.newParentId : this.oldParentId;\n    const inputName = forward ? this.newInputName : this.oldInputName;\n    const coordinate = forward ? this.newCoordinate : this.oldCoordinate;\n    let parentBlock: Block|null;\n    if (parentId) {\n      parentBlock = workspace.getBlockById(parentId);\n      if (!parentBlock) {\n        console.warn('Can\\'t connect to non-existent block: ' + parentId);\n        return;\n      }\n    }\n    if (block.getParent()) {\n      block.unplug();\n    }\n    if (coordinate) {\n      const xy = block.getRelativeToSurfaceXY();\n      block.moveBy(coordinate.x - xy.x, coordinate.y - xy.y);\n    } else {\n      let blockConnection = block.outputConnection;\n      if (!blockConnection ||\n          block.previousConnection && block.previousConnection.isConnected()) {\n        blockConnection = block.previousConnection;\n      }\n      let parentConnection;\n      const connectionType = blockConnection.type;\n      if (inputName) {\n        const input = parentBlock!.getInput(inputName);\n        if (input) {\n          parentConnection = input.connection;\n        }\n      } else if (connectionType === ConnectionType.PREVIOUS_STATEMENT) {\n        parentConnection = parentBlock!.nextConnection;\n      }\n      if (parentConnection) {\n        blockConnection.connect(parentConnection);\n      } else {\n        console.warn('Can\\'t connect to non-existent input: ' + inputName);\n      }\n    }\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.MOVE, BlockMove);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Base class for comment events.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.CommentBase');\n\nimport * as utilsXml from '../utils/xml.js';\nimport type {WorkspaceComment} from '../workspace_comment.js';\nimport * as Xml from '../xml.js';\n\nimport {Abstract as AbstractEvent} from './events_abstract.js';\nimport type {CommentCreate} from './events_comment_create.js';\nimport type {CommentDelete} from './events_comment_delete.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Abstract class for a comment event.\n *\n * @alias Blockly.Events.CommentBase\n */\nexport class CommentBase extends AbstractEvent {\n  override isBlank: boolean;\n  commentId: string;\n  override workspaceId: string;\n\n  /**\n   * @param opt_comment The comment this event corresponds to.  Undefined for a\n   *     blank event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super();\n    /** Whether or not an event is blank. */\n    this.isBlank = typeof opt_comment === 'undefined';\n\n    /** The ID of the comment this event pertains to. */\n    this.commentId = this.isBlank ? '' : opt_comment!.id;\n\n    /** The workspace identifier for this event. */\n    this.workspaceId = this.isBlank ? '' : opt_comment!.workspace.id;\n\n    /**\n     * The event group id for the group this event belongs to. Groups define\n     * events that should be treated as an single action from the user's\n     * perspective, and should be undone together.\n     */\n    this.group = eventUtils.getGroup();\n\n    /** Sets whether the event should be added to the undo stack. */\n    this.recordUndo = eventUtils.getRecordUndo();\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    if (this.commentId) {\n      json['commentId'] = this.commentId;\n    }\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.commentId = json['commentId'];\n  }\n\n  /**\n   * Helper function for Comment[Create|Delete]\n   *\n   * @param event The event to run.\n   * @param create if True then Create, if False then Delete\n   */\n  static CommentCreateDeleteHelper(\n      event: CommentCreate|CommentDelete, create: boolean) {\n    const workspace = event.getEventWorkspace_();\n    if (create) {\n      const xmlElement = utilsXml.createElement('xml');\n      xmlElement.appendChild(event.xml);\n      Xml.domToWorkspace(xmlElement, workspace);\n    } else {\n      const comment = workspace.getCommentById(event.commentId);\n      if (comment) {\n        comment.dispose();\n      } else {\n        // Only complain about root-level block.\n        console.warn(\n            'Can\\'t uncreate non-existent comment: ' + event.commentId);\n      }\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment change event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.CommentChange');\n\nimport * as registry from '../registry.js';\nimport type {WorkspaceComment} from '../workspace_comment.js';\n\nimport {CommentBase} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a comment change event.\n *\n * @alias Blockly.Events.CommentChange\n */\nexport class CommentChange extends CommentBase {\n  override type: string;\n\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  oldContents_!: string;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  newContents_!: string;\n\n  /**\n   * @param opt_comment The comment that is being changed.  Undefined for a\n   *     blank event.\n   * @param opt_oldContents Previous contents of the comment.\n   * @param opt_newContents New contents of the comment.\n   */\n  constructor(\n      opt_comment?: WorkspaceComment, opt_oldContents?: string,\n      opt_newContents?: string) {\n    super(opt_comment);\n\n    /** Type of this event. */\n    this.type = eventUtils.COMMENT_CHANGE;\n\n    if (!opt_comment) {\n      return;  // Blank event to be populated by fromJson.\n    }\n\n    this.oldContents_ =\n        typeof opt_oldContents === 'undefined' ? '' : opt_oldContents;\n    this.newContents_ =\n        typeof opt_newContents === 'undefined' ? '' : opt_newContents;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['oldContents'] = this.oldContents_;\n    json['newContents'] = this.newContents_;\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.oldContents_ = json['oldContents'];\n    this.newContents_ = json['newContents'];\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return this.oldContents_ === this.newContents_;\n  }\n\n  /**\n   * Run a change event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    const comment = workspace.getCommentById(this.commentId);\n    if (!comment) {\n      console.warn('Can\\'t change non-existent comment: ' + this.commentId);\n      return;\n    }\n    const contents = forward ? this.newContents_ : this.oldContents_;\n\n    comment.setContent(contents);\n  }\n}\n\nregistry.register(\n    registry.Type.EVENT, eventUtils.COMMENT_CHANGE, CommentChange);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment creation event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.CommentCreate');\n\nimport * as registry from '../registry.js';\nimport type {WorkspaceComment} from '../workspace_comment.js';\nimport * as Xml from '../xml.js';\n\nimport {CommentBase} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a comment creation event.\n *\n * @alias Blockly.Events.CommentCreate\n */\nexport class CommentCreate extends CommentBase {\n  override type: string;\n\n  xml: AnyDuringMigration;\n\n  /**\n   * @param opt_comment The created comment.\n   *     Undefined for a blank event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super(opt_comment);\n\n    /** Type of this event. */\n    this.type = eventUtils.COMMENT_CREATE;\n\n    if (!opt_comment) {\n      return;\n    }\n    // Blank event to be populated by fromJson.\n    this.xml = opt_comment.toXmlWithXY();\n  }\n\n  // TODO (#1266): \"Full\" and \"minimal\" serialization.\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['xml'] = Xml.domToText(this.xml);\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.xml = Xml.textToDom(json['xml']);\n  }\n\n  /**\n   * Run a creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    CommentBase.CommentCreateDeleteHelper(this, forward);\n  }\n}\n\nregistry.register(\n    registry.Type.EVENT, eventUtils.COMMENT_CREATE, CommentCreate);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment deletion event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.CommentDelete');\n\nimport * as registry from '../registry.js';\nimport type {WorkspaceComment} from '../workspace_comment.js';\n\nimport {CommentBase} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a comment deletion event.\n *\n * @alias Blockly.Events.CommentDelete\n */\nexport class CommentDelete extends CommentBase {\n  override type: string;\n  xml: AnyDuringMigration;\n\n  /**\n   * @param opt_comment The deleted comment.\n   *     Undefined for a blank event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super(opt_comment);\n\n    /** Type of this event. */\n    this.type = eventUtils.COMMENT_DELETE;\n\n    if (!opt_comment) {\n      return;  // Blank event to be populated by fromJson.\n    }\n\n    this.xml = opt_comment.toXmlWithXY();\n  }\n  // TODO (#1266): \"Full\" and \"minimal\" serialization.\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n  }\n\n  /**\n   * Run a creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    CommentBase.CommentCreateDeleteHelper(this, !forward);\n  }\n}\n\nregistry.register(\n    registry.Type.EVENT, eventUtils.COMMENT_DELETE, CommentDelete);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment move event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.CommentMove');\n\nimport * as registry from '../registry.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport type {WorkspaceComment} from '../workspace_comment.js';\n\nimport {CommentBase} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a comment move event.  Created before the move.\n *\n * @alias Blockly.Events.CommentMove\n */\nexport class CommentMove extends CommentBase {\n  override type: string;\n\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  comment_!: WorkspaceComment;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  oldCoordinate_!: Coordinate;\n\n  /** The location after the move, in workspace coordinates. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'Coordinate'.\n  newCoordinate_: Coordinate = null as AnyDuringMigration;\n\n  /**\n   * @param opt_comment The comment that is being moved.  Undefined for a blank\n   *     event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super(opt_comment);\n\n    /** Type of this event. */\n    this.type = eventUtils.COMMENT_MOVE;\n\n    if (!opt_comment) {\n      return;  // Blank event to be populated by fromJson.\n    }\n\n    /**\n     * The comment that is being moved.  Will be cleared after recording the new\n     * location.\n     */\n    this.comment_ = opt_comment;\n\n    /** The location before the move, in workspace coordinates. */\n    this.oldCoordinate_ = opt_comment.getXY();\n  }\n\n  /**\n   * Record the comment's new location.  Called after the move.  Can only be\n   * called once.\n   */\n  recordNew() {\n    if (!this.comment_) {\n      throw Error(\n          'Tried to record the new position of a comment on the ' +\n          'same event twice.');\n    }\n    this.newCoordinate_ = this.comment_.getXY();\n    // AnyDuringMigration because:  Type 'null' is not assignable to type\n    // 'WorkspaceComment'.\n    this.comment_ = null as AnyDuringMigration;\n  }\n\n  /**\n   * Override the location before the move.  Use this if you don't create the\n   * event until the end of the move, but you know the original location.\n   *\n   * @param xy The location before the move, in workspace coordinates.\n   */\n  setOldCoordinate(xy: Coordinate) {\n    this.oldCoordinate_ = xy;\n  }\n\n  // TODO (#1266): \"Full\" and \"minimal\" serialization.\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    if (this.oldCoordinate_) {\n      json['oldCoordinate'] = Math.round(this.oldCoordinate_.x) + ',' +\n          Math.round(this.oldCoordinate_.y);\n    }\n    if (this.newCoordinate_) {\n      json['newCoordinate'] = Math.round(this.newCoordinate_.x) + ',' +\n          Math.round(this.newCoordinate_.y);\n    }\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n\n    if (json['oldCoordinate']) {\n      const xy = json['oldCoordinate'].split(',');\n      this.oldCoordinate_ = new Coordinate(Number(xy[0]), Number(xy[1]));\n    }\n    if (json['newCoordinate']) {\n      const xy = json['newCoordinate'].split(',');\n      this.newCoordinate_ = new Coordinate(Number(xy[0]), Number(xy[1]));\n    }\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return Coordinate.equals(this.oldCoordinate_, this.newCoordinate_);\n  }\n\n  /**\n   * Run a move event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    const comment = workspace.getCommentById(this.commentId);\n    if (!comment) {\n      console.warn('Can\\'t move non-existent comment: ' + this.commentId);\n      return;\n    }\n\n    const target = forward ? this.newCoordinate_ : this.oldCoordinate_;\n    // TODO: Check if the comment is being dragged, and give up if so.\n    const current = comment.getXY();\n    comment.moveBy(target.x - current.x, target.y - current.y);\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.COMMENT_MOVE, CommentMove);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a block drag.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.BlockDrag');\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a block drag event.\n *\n * @alias Blockly.Events.BlockDrag\n */\nexport class BlockDrag extends UiBase {\n  blockId: AnyDuringMigration;\n  isStart?: boolean;\n  blocks?: Block[];\n  override type: string;\n\n  /**\n   * @param opt_block The top block in the stack that is being dragged.\n   *     Undefined for a blank event.\n   * @param opt_isStart Whether this is the start of a block drag.\n   *    Undefined for a blank event.\n   * @param opt_blocks The blocks affected by this drag. Undefined for a blank\n   *     event.\n   */\n  constructor(opt_block?: Block, opt_isStart?: boolean, opt_blocks?: Block[]) {\n    const workspaceId = opt_block ? opt_block.workspace.id : undefined;\n    super(workspaceId);\n    this.blockId = opt_block ? opt_block.id : null;\n\n    /** Whether this is the start of a block drag. */\n    this.isStart = opt_isStart;\n\n    /** The blocks affected by this drag event. */\n    this.blocks = opt_blocks;\n\n    /** Type of this event. */\n    this.type = eventUtils.BLOCK_DRAG;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['isStart'] = this.isStart;\n    json['blockId'] = this.blockId;\n    json['blocks'] = this.blocks;\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.isStart = json['isStart'];\n    this.blockId = json['blockId'];\n    this.blocks = json['blocks'];\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.BLOCK_DRAG, BlockDrag);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * (Deprecated) Events fired as a result of UI actions in\n * Blockly's editor.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.Ui');\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a UI event.\n *\n * @deprecated December 2020. Instead use a more specific UI event.\n * @alias Blockly.Events.Ui\n */\nexport class Ui extends UiBase {\n  blockId: AnyDuringMigration;\n  element: AnyDuringMigration;\n  oldValue: AnyDuringMigration;\n  newValue: AnyDuringMigration;\n  override type: string;\n\n  /**\n   * @param opt_block The affected block.  Null for UI events that do not have\n   *     an associated block.  Undefined for a blank event.\n   * @param opt_element One of 'selected', 'comment', 'mutatorOpen', etc.\n   * @param opt_oldValue Previous value of element.\n   * @param opt_newValue New value of element.\n   */\n  constructor(\n      opt_block?: Block|null, opt_element?: string,\n      opt_oldValue?: AnyDuringMigration, opt_newValue?: AnyDuringMigration) {\n    const workspaceId = opt_block ? opt_block.workspace.id : undefined;\n    super(workspaceId);\n\n    this.blockId = opt_block ? opt_block.id : null;\n    this.element = typeof opt_element === 'undefined' ? '' : opt_element;\n    this.oldValue = typeof opt_oldValue === 'undefined' ? '' : opt_oldValue;\n    this.newValue = typeof opt_newValue === 'undefined' ? '' : opt_newValue;\n\n    /** Type of this event. */\n    this.type = eventUtils.UI;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = super.toJson();\n    json['element'] = this.element;\n    if (this.newValue !== undefined) {\n      json['newValue'] = this.newValue;\n    }\n    if (this.blockId) {\n      json['blockId'] = this.blockId;\n    }\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    super.fromJson(json);\n    this.element = json['element'];\n    this.newValue = json['newValue'];\n    this.blockId = json['blockId'];\n  }\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.UI, Ui);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a finished loading workspace event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.FinishedLoading');\n\nimport * as registry from '../registry.js';\nimport type {Workspace} from '../workspace.js';\n\nimport {Abstract as AbstractEvent} from './events_abstract.js';\nimport * as eventUtils from './utils.js';\n\n\n/**\n * Class for a finished loading event.\n * Used to notify the developer when the workspace has finished loading (i.e\n * domToWorkspace).\n * Finished loading events do not record undo or redo.\n *\n * @alias Blockly.Events.FinishedLoading\n */\nexport class FinishedLoading extends AbstractEvent {\n  override isBlank: boolean;\n  override workspaceId: string;\n\n  // Workspace events do not undo or redo.\n  override recordUndo = false;\n  override type: string;\n  override group: AnyDuringMigration;\n\n  /**\n   * @param opt_workspace The workspace that has finished loading.  Undefined\n   *     for a blank event.\n   */\n  constructor(opt_workspace?: Workspace) {\n    super();\n    /** Whether or not the event is blank (to be populated by fromJson). */\n    this.isBlank = typeof opt_workspace === 'undefined';\n\n    /** The workspace identifier for this event. */\n    this.workspaceId = opt_workspace ? opt_workspace.id : '';\n\n    /** Type of this event. */\n    this.type = eventUtils.FINISHED_LOADING;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): AnyDuringMigration {\n    const json = {\n      'type': this.type,\n    };\n    if (this.group) {\n      (json as AnyDuringMigration)['group'] = this.group;\n    }\n    if (this.workspaceId) {\n      (json as AnyDuringMigration)['workspaceId'] = this.workspaceId;\n    }\n    return json;\n  }\n\n  /**\n   * Decode the JSON event.\n   *\n   * @param json JSON representation.\n   */\n  override fromJson(json: AnyDuringMigration) {\n    this.isBlank = false;\n    this.workspaceId = json['workspaceId'];\n    this.group = json['group'];\n  }\n}\n\nregistry.register(\n    registry.Type.EVENT, eventUtils.FINISHED_LOADING, FinishedLoading);\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of actions in Blockly's editor.\n *\n * @namespace Blockly.Events\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events');\n\n\nimport {Abstract as AbstractEvent} from './events_abstract.js';\nimport {BlockBase} from './events_block_base.js';\nimport {BlockChange} from './events_block_change.js';\nimport {BlockCreate} from './events_block_create.js';\nimport {BlockDelete} from './events_block_delete.js';\nimport {BlockDrag} from './events_block_drag.js';\nimport {BlockMove} from './events_block_move.js';\nimport {BubbleOpen} from './events_bubble_open.js';\nimport {Click} from './events_click.js';\nimport {CommentBase} from './events_comment_base.js';\nimport {CommentChange} from './events_comment_change.js';\nimport {CommentCreate} from './events_comment_create.js';\nimport {CommentDelete} from './events_comment_delete.js';\nimport {CommentMove} from './events_comment_move.js';\nimport {MarkerMove} from './events_marker_move.js';\nimport {Selected} from './events_selected.js';\nimport {ThemeChange} from './events_theme_change.js';\nimport {ToolboxItemSelect} from './events_toolbox_item_select.js';\nimport {TrashcanOpen} from './events_trashcan_open.js';\nimport {Ui} from './events_ui.js';\nimport {UiBase} from './events_ui_base.js';\nimport {VarBase} from './events_var_base.js';\nimport {VarCreate} from './events_var_create.js';\nimport {VarDelete} from './events_var_delete.js';\nimport {VarRename} from './events_var_rename.js';\nimport {ViewportChange} from './events_viewport.js';\nimport * as eventUtils from './utils.js';\nimport {FinishedLoading} from './workspace_events.js';\n\n\n// Events.\nexport const Abstract = AbstractEvent;\nexport {BubbleOpen};\nexport {BlockBase};\nexport {BlockChange};\nexport {BlockCreate};\nexport {BlockDelete};\nexport {BlockDrag};\nexport {BlockMove};\nexport {Click};\nexport {CommentBase};\nexport {CommentChange};\nexport {CommentCreate};\nexport {CommentDelete};\nexport {CommentMove};\nexport {FinishedLoading};\nexport {MarkerMove};\nexport {Selected};\nexport {ThemeChange};\nexport {ToolboxItemSelect};\nexport {TrashcanOpen};\nexport {Ui};\nexport {UiBase};\nexport {VarBase};\nexport {VarCreate};\nexport {VarDelete};\nexport {VarRename};\nexport {ViewportChange};\n\n// Event types.\nexport const BLOCK_CHANGE = eventUtils.BLOCK_CHANGE;\nexport const BLOCK_CREATE = eventUtils.BLOCK_CREATE;\nexport const BLOCK_DELETE = eventUtils.BLOCK_DELETE;\nexport const BLOCK_DRAG = eventUtils.BLOCK_DRAG;\nexport const BLOCK_MOVE = eventUtils.BLOCK_MOVE;\nexport const BUBBLE_OPEN = eventUtils.BUBBLE_OPEN;\nexport type BumpEvent = eventUtils.BumpEvent;\nexport const BUMP_EVENTS = eventUtils.BUMP_EVENTS;\nexport const CHANGE = eventUtils.CHANGE;\nexport const CLICK = eventUtils.CLICK;\nexport const COMMENT_CHANGE = eventUtils.COMMENT_CHANGE;\nexport const COMMENT_CREATE = eventUtils.COMMENT_CREATE;\nexport const COMMENT_DELETE = eventUtils.COMMENT_DELETE;\nexport const COMMENT_MOVE = eventUtils.COMMENT_MOVE;\nexport const CREATE = eventUtils.CREATE;\nexport const DELETE = eventUtils.DELETE;\nexport const FINISHED_LOADING = eventUtils.FINISHED_LOADING;\nexport const MARKER_MOVE = eventUtils.MARKER_MOVE;\nexport const MOVE = eventUtils.MOVE;\nexport const SELECTED = eventUtils.SELECTED;\nexport const THEME_CHANGE = eventUtils.THEME_CHANGE;\nexport const TOOLBOX_ITEM_SELECT = eventUtils.TOOLBOX_ITEM_SELECT;\nexport const TRASHCAN_OPEN = eventUtils.TRASHCAN_OPEN;\nexport const UI = eventUtils.UI;\nexport const VAR_CREATE = eventUtils.VAR_CREATE;\nexport const VAR_DELETE = eventUtils.VAR_DELETE;\nexport const VAR_RENAME = eventUtils.VAR_RENAME;\nexport const VIEWPORT_CHANGE = eventUtils.VIEWPORT_CHANGE;\n\n// Event utils.\nexport const clearPendingUndo = eventUtils.clearPendingUndo;\nexport const disable = eventUtils.disable;\nexport const enable = eventUtils.enable;\nexport const filter = eventUtils.filter;\nexport const fire = eventUtils.fire;\nexport const fromJson = eventUtils.fromJson;\nexport const getDescendantIds = eventUtils.getDescendantIds;\nexport const get = eventUtils.get;\nexport const getGroup = eventUtils.getGroup;\nexport const getRecordUndo = eventUtils.getRecordUndo;\nexport const isEnabled = eventUtils.isEnabled;\nexport const setGroup = eventUtils.setGroup;\nexport const setRecordUndo = eventUtils.setRecordUndo;\nexport const disableOrphans = eventUtils.disableOrphans;\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview The entrypoint for blockly_compressed.js.  Provides\n *     various backwards-compatibility hacks.  Not used when loading\n *     in uncompiled (uncompressed) mode via bootstrap.js.\n */\n'use strict';\n\ngoog.module('Blockly.main');\n\nconst Blockly = goog.require('Blockly');\nconst ContextMenu = goog.require('Blockly.ContextMenu');\nconst Events = goog.require('Blockly.Events');\nconst Msg = goog.require('Blockly.Msg');\nconst Tooltip = goog.require('Blockly.Tooltip');\nconst WidgetDiv = goog.require('Blockly.WidgetDiv');\nconst colour = goog.require('Blockly.utils.colour');\nconst common = goog.require('Blockly.common');\nconst deprecation = goog.require('Blockly.utils.deprecation');\nconst dialog = goog.require('Blockly.dialog');\nconst eventUtils = goog.require('Blockly.Events.utils');\n\n/*\n * Aliased functions and properties that used to be on the Blockly namespace.\n * Everything in this section is deprecated. Both external and internal code\n * should avoid using these functions and use the designated replacements.\n * Everything in this section will be removed in a future version of Blockly.\n */\n\n// Add accessors for properties on Blockly that have now been deprecated.\nObject.defineProperties(Blockly, {\n  /**\n   * Wrapper to window.alert() that app developers may override to\n   * provide alternatives to the modal browser window.\n   * @name Blockly.alert\n   * @type {!function(string, function()=)}\n   * @deprecated Use Blockly.dialog.alert / .setAlert() instead.\n   *     (December 2021)\n   * @suppress {checkTypes}\n   */\n  alert: {\n    set: function(newAlert) {\n      deprecation.warn('Blockly.alert', 'December 2021', 'December 2022');\n      dialog.setAlert(newAlert);\n    },\n    get: function() {\n      deprecation.warn(\n          'Blockly.alert', 'December 2021', 'December 2022',\n          'Blockly.dialog.alert()');\n      return dialog.alert;\n    },\n  },\n  /**\n   * Wrapper to window.confirm() that app developers may override to\n   * provide alternatives to the modal browser window.\n   * @name Blockly.confirm\n   * @type {!function(string, function()=)}\n   * @deprecated Use Blockly.dialog.confirm / .setConfirm() instead.\n   *     (December 2021)\n   * @suppress {checkTypes}\n   */\n  confirm: {\n    set: function(newConfirm) {\n      deprecation.warn('Blockly.confirm', 'December 2021', 'December 2022');\n      dialog.setConfirm(newConfirm);\n    },\n    get: function() {\n      deprecation.warn(\n          'Blockly.confirm', 'December 2021', 'December 2022',\n          'Blockly.dialog.confirm()');\n      return dialog.confirm;\n    },\n  },\n  /**\n   * The main workspace most recently used.\n   * Set by Blockly.WorkspaceSvg.prototype.markFocused\n   * @name Blockly.mainWorkspace\n   * @type {Workspace}\n   * @suppress {checkTypes}\n   */\n  mainWorkspace: {\n    set: function(x) {\n      deprecation.warn(\n          'Blockly.mainWorkspace', 'August 2022', 'September 2022',\n          'Blockly.getMainWorkspace');\n      common.setMainWorkspace(x);\n    },\n    get: function() {\n      deprecation.warn(\n          'Blockly.mainWorkspace', 'August 2022', 'September 2022',\n          'Blockly.getMainWorkspace');\n      return common.getMainWorkspace();\n    },\n  },\n  /**\n   * Wrapper to window.prompt() that app developers may override to\n   * provide alternatives to the modal browser window. Built-in\n   * browser prompts are often used for better text input experience\n   * on mobile device. We strongly recommend testing mobile when\n   * overriding this.\n   * @name Blockly.prompt\n   * @type {!function(string, string, function()=)}\n   * @deprecated Use Blockly.dialog.prompt / .setPrompt() instead.\n   *     (December 2021)\n   * @suppress {checkTypes}\n   */\n  prompt: {\n    set: function(newPrompt) {\n      deprecation.warn('Blockly.prompt', 'December 2021', 'December 2022');\n      dialog.setPrompt(newPrompt);\n    },\n    get: function() {\n      deprecation.warn(\n          'Blockly.prompt', 'December 2021', 'December 2022',\n          'Blockly.dialog.prompt()');\n      return dialog.prompt;\n    },\n  },\n  /**\n   * Currently selected block.\n   * @name Blockly.selected\n   * @type {?ICopyable}\n   * @suppress {checkTypes}\n   */\n  selected: {\n    get: function() {\n      deprecation.warn(\n          'Blockly.selected', 'August 2022', 'September 2022',\n          'Blockly.getSelected');\n      return common.getSelected();\n    },\n    set: function(newSelection) {\n      deprecation.warn(\n          'Blockly.selected', 'August 2022', 'September 2022',\n          'Blockly.getSelected');\n      common.setSelected(newSelection);\n    },\n  },\n  /**\n   * The richness of block colours, regardless of the hue.\n   * Must be in the range of 0 (inclusive) to 1 (exclusive).\n   * @name Blockly.HSV_SATURATION\n   * @type {number}\n   * @suppress {checkTypes}\n   */\n  HSV_SATURATION: {\n    get: function() {\n      return colour.getHsvSaturation();\n    },\n    set: function(newValue) {\n      colour.setHsvSaturation(newValue);\n    },\n  },\n  /**\n   * The intensity of block colours, regardless of the hue.\n   * Must be in the range of 0 (inclusive) to 1 (exclusive).\n   * @name Blockly.HSV_VALUE\n   * @type {number}\n   * @suppress {checkTypes}\n   */\n  HSV_VALUE: {\n    get: function() {\n      return colour.getHsvValue();\n    },\n    set: function(newValue) {\n      colour.setHsvValue(newValue);\n    },\n  },\n});\n\n// Add accessors for properties on Blockly.ContextMenu that have now\n// been deprecated.\nObject.defineProperties(ContextMenu, {\n  /**\n   * Which block is the context menu attached to?\n   * @name Blockly.ContextMenu.currentBlock\n   * @type {Block}\n   * @deprecated Use Blockly.Tooltip.getCurrentBlock() /\n   *     .setCurrentBlock() instead.  (September 2021)\n   * @suppress {checkTypes}\n   */\n  currentBlock: {\n    get: function() {\n      deprecation.warn(\n          'Blockly.ContextMenu.currentBlock', 'September 2021',\n          'September 2022', 'Blockly.Tooltip.getCurrentBlock()');\n      return ContextMenu.getCurrentBlock();\n    },\n    set: function(block) {\n      deprecation.warn(\n          'Blockly.ContextMenu.currentBlock', 'September 2021',\n          'September 2022', 'Blockly.Tooltip.setCurrentBlock(block)');\n      ContextMenu.setCurrentBlock(block);\n    },\n  },\n});\n\n// Add accessors for properties on Blockly.Events that have now been\n// deprecated.\nObject.defineProperties(Events, {\n  /**\n   * Sets whether the next event should be added to the undo stack.\n   * @name Blockly.Evenents.recordUndo\n   * @type {boolean}\n   * @deprecated Use Blockly.Events.getRecordUndo() and\n   *     .setRecordUndo().  (September 2021)\n   * @suppress {checkTypes}\n   */\n  recordUndo: {\n    get: function() {\n      deprecation.warn(\n          'Blockly.Events.recordUndo', 'September 2021', 'September 2022',\n          'Blockly.Events.getRecordUndo()');\n      return eventUtils.getRecordUndo();\n    },\n    set: function(record) {\n      deprecation.warn(\n          'Blockly.Events.recordUndo', 'September 2021', 'September 2022',\n          'Blockly.Events.setRecordUndo()');\n      eventUtils.setRecordUndo(record);\n    },\n  },\n});\n\n\n// Add accessors for properties on Blockly.Tooltip that have now been\n// deprecated.\nObject.defineProperties(Tooltip, {\n  /**\n   * Is a tooltip currently showing?\n   * @name Blockly.Tooltip.visible\n   * @type {boolean}\n   * @deprecated Use Blockly.Tooltip.isVisible() instead.  (September\n   *     2021)\n   * @suppress {checkTypes}\n   */\n  visible: {\n    get: function() {\n      deprecation.warn(\n          'Blockly.Tooltip.visible', 'September 2021', 'September 2022',\n          'Blockly.Tooltip.isVisible()');\n      return Tooltip.isVisible();\n    },\n  },\n  /**\n   * The HTML container.  Set once by createDom.\n   * @name Blockly.Tooltip.DIV\n   * @type {HTMLDivElement}\n   * @deprecated Use Blockly.Tooltip.getDiv() and .setDiv().\n   *     (September 2021)\n   * @suppress {checkTypes}\n   */\n  DIV: {\n    get: function() {\n      deprecation.warn(\n          'Blockly.Tooltip.DIV', 'September 2021', 'September 2022',\n          'Blockly.Tooltip.getDiv()');\n      return Tooltip.getDiv();\n    },\n  },\n});\n\n// Add accessors for properties on Blockly.WidgetDiv that have now been\n// deprecated.\nObject.defineProperties(WidgetDiv, {\n  /**\n   * The HTML container for popup overlays (e.g. editor widgets).\n   * @name Blockly.WidgetDiv.DIV\n   * @type {?Element}\n   * @deprecated Use Blockly.WidgetDiv.getDiv() and .setDiv().\n   *     (September 2021)\n   * @suppress {checkTypes}\n   */\n  DIV: {\n    get: function() {\n      deprecation.warn(\n          'Blockly.WidgetDiv.DIV', 'September 2021', 'September 2022',\n          'Blockly.WidgetDiv.getDiv()');\n      return WidgetDiv.getDiv();\n    },\n  },\n});\n\n// If Blockly is compiled with ADVANCED_COMPILATION and/or loaded as a\n// CJS or ES module there will not be a Blockly global variable\n// created.  This can cause problems because a very common way of\n// loading translations is to use a <script> tag to load one of\n// msg/js/*.js, which consists of lines like:\n//\n// Blockly.Msg[\"ADD_COMMENT\"] = \"Add Comment\";\n// Blockly.Msg[\"CLEAN_UP\"] = \"Clean up Blocks\";\n//\n// This obviously only works if Blockly.Msg is the Msg export from the\n// Blockly.Msg module - so make sure it is, but only if there is not\n// yet a Blockly global variable.\nif (!('Blockly' in globalThis)) {\n  globalThis['Blockly'] = {'Msg': Msg};\n}\n"]}