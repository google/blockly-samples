{"version":3,"sources":["core/registry.ts","core/utils/idgenerator.ts","core/events/utils.ts","core/common.ts","core/touch.ts","core/browser_events.ts","core/utils/array.ts","core/css.ts","core/utils/dom.ts","core/utils/style.ts","core/utils/svg_math.ts","core/utils/xml.ts","core/utils/toolbox.ts","core/positionable_helpers.ts","core/dialog.ts","core/interfaces/i_variable_backed_parameter_model.ts","core/interfaces/i_legacy_procedure_blocks.ts","core/variables.ts","core/render_management.ts","core/serialization/registry.ts","core/serialization/workspace_comments.ts","core/clipboard/registry.ts","core/clipboard/workspace_comment_paster.ts","core/utils/aria.ts","core/interfaces/i_serializable.ts","core/serialization/blocks.ts","core/interfaces/i_has_bubble.ts","core/utils/math.ts","core/dropdowndiv.ts","core/utils/string.ts","core/tooltip.ts","core/utils/colour.ts","core/utils/parsing.ts","core/widgetdiv.ts","core/contextmenu.ts","core/xml.ts","core/block_animations.ts","core/interfaces/i_draggable.ts","core/utils/object.ts","core/interfaces/i_procedure_block.ts","core/interfaces/i_observable.ts","core/field_registry.ts","core/field_dropdown.ts","core/extensions.ts","core/utils/deprecation.ts","core/utils/svg_paths.ts","core/icons/registry.ts","core/procedures.ts","core/renderers/common/constants.ts","core/connection.ts","core/interfaces/i_icon.ts","core/interfaces/i_comment_icon.ts","core/keyboard_nav/ast_node.ts","core/renderers/common/block_rendering.ts","core/variables_dynamic.ts","core/workspace_svg.ts","core/clipboard/block_paster.ts","core/bump_objects.ts","core/interfaces/i_deletable.ts","core/clipboard.ts","core/interfaces/i_copyable.ts","core/shortcut_items.ts","core/serialization/procedures.ts","core/serialization/workspaces.ts","core/inject.ts","core/contextmenu_items.ts","core/interfaces/i_paster.ts","core/interfaces/i_rendered_element.ts","core/interfaces/i_selectable.ts","core/interfaces/i_selectable_toolbox_item.ts","core/blockly.ts","src/com/google/javascript/jscomp/js/base.js","src/com/google/javascript/jscomp/js/util/defines.js","src/com/google/javascript/jscomp/js/util/defineproperty.js","src/com/google/javascript/jscomp/js/util/global.js","src/com/google/javascript/jscomp/js/util/shouldpolyfill.js","src/com/google/javascript/jscomp/js/util/polyfill.js","src/com/google/javascript/jscomp/js/es6/util/setprototypeof.js","src/com/google/javascript/jscomp/js/es6/util/arrayiterator.js","src/com/google/javascript/jscomp/js/es6/util/makeiterator.js","src/com/google/javascript/jscomp/js/es6/generator_engine.js","src/com/google/javascript/jscomp/js/es6/execute_async_generator.js","src/com/google/javascript/jscomp/js/es6/globalthis.js","src/com/google/javascript/jscomp/js/es6/array/includes.js","src/com/google/javascript/jscomp/js/es6/symbol.js","src/com/google/javascript/jscomp/js/es6/util/iteratorfromarray.js","src/com/google/javascript/jscomp/js/es6/array/values.js","src/com/google/javascript/jscomp/js/es6/array/flat.js","src/com/google/javascript/jscomp/js/es6/array/flatmap.js","src/com/google/javascript/jscomp/js/util/owns.js","src/com/google/javascript/jscomp/js/es6/object/entries.js","src/com/google/javascript/jscomp/js/es6/object/values.js","core/blocks.ts","core/events/events_abstract.ts","core/events/events_ui_base.ts","core/events/events_click.ts","core/utils/useragent.ts","core/component_manager.ts","core/utils/coordinate.ts","core/utils/svg.ts","core/utils/rect.ts","core/utils/size.ts","core/scrollbar.ts","core/sprites.ts","core/zoom_controls.ts","core/constants.ts","core/icons/icon_types.ts","core/inputs/input_types.ts","core/msg.ts","core/events/events_var_base.ts","core/events/events_var_create.ts","core/variable_model.ts","core/comments/workspace_comment.ts","core/layers.ts","core/comments/comment_view.ts","core/dragging/comment_drag_strategy.ts","core/serialization/priorities.ts","core/config.ts","core/menu.ts","core/menuitem.ts","core/serialization/exceptions.ts","core/events/events_block_base.ts","core/events/events_block_change.ts","core/marker_manager.ts","core/field.ts","core/contextmenu_registry.ts","core/comments/rendered_workspace_comment.ts","core/events/events_block_create.ts","core/events/events_theme_change.ts","core/events/events_viewport.ts","core/connection_type.ts","core/connection_db.ts","core/workspace_dragger.ts","core/gesture.ts","core/grid.ts","core/theme.ts","core/theme/classic.ts","core/options.ts","core/names.ts","core/observable_procedure_map.ts","core/icons/icon.ts","core/dragging/bubble_drag_strategy.ts","core/bubbles/bubble.ts","core/bubbles/mini_workspace_bubble.ts","core/icons/mutator_icon.ts","core/utils/keycodes.ts","core/utils.ts","core/bubbles/text_bubble.ts","core/bubbles/textinput_bubble.ts","core/icons/comment_icon.ts","core/icons/warning_icon.ts","core/icons/exceptions.ts","core/icons.ts","core/renderers/measurables/types.ts","core/renderers/measurables/base.ts","core/renderers/measurables/row.ts","core/renderers/measurables/bottom_row.ts","core/renderers/measurables/connection.ts","core/renderers/measurables/input_connection.ts","core/renderers/measurables/external_value_input.ts","core/renderers/measurables/field.ts","core/renderers/measurables/hat.ts","core/renderers/measurables/icon.ts","core/renderers/measurables/in_row_spacer.ts","core/renderers/measurables/inline_input.ts","core/renderers/measurables/statement_input.ts","core/renderers/measurables/input_row.ts","core/renderers/measurables/jagged_edge.ts","core/renderers/measurables/next_connection.ts","core/renderers/measurables/output_connection.ts","core/renderers/measurables/previous_connection.ts","core/renderers/measurables/round_corner.ts","core/renderers/measurables/spacer_row.ts","core/renderers/measurables/square_corner.ts","core/renderers/measurables/top_row.ts","core/renderers/common/drawer.ts","core/inputs/align.ts","core/field_label.ts","core/inputs/input.ts","core/inputs/dummy_input.ts","core/inputs/end_row_input.ts","core/inputs/statement_input.ts","core/inputs/value_input.ts","core/renderers/common/info.ts","core/events/events_block_delete.ts","core/block.ts","core/flyout_button.ts","core/events/events_marker_move.ts","core/renderers/common/marker_svg.ts","core/renderers/common/path_object.ts","core/insertion_marker_manager.ts","core/renderers/common/renderer.ts","core/theme_manager.ts","core/internal_constants.ts","core/connection_checker.ts","core/events/events_var_delete.ts","core/events/events_var_rename.ts","core/variable_map.ts","core/workspace.ts","core/workspace_audio.ts","core/layer_manager.ts","core/events/events_trashcan_open.ts","core/events/events_selected.ts","core/keyboard_nav/marker.ts","core/keyboard_nav/cursor.ts","core/keyboard_nav/basic_cursor.ts","core/keyboard_nav/tab_navigate_cursor.ts","core/rendered_connection.ts","core/dragging/block_drag_strategy.ts","core/block_svg.ts","core/drag_target.ts","core/delete_area.ts","core/trashcan.ts","core/shortcut_registry.ts","core/serialization/variables.ts","core/serialization.ts","core/scrollbar_pair.ts","core/metrics_manager.ts","core/main.ts","core/renderers/zelos/constants.ts","core/renderers/zelos/drawer.ts","core/field_image.ts","core/field_input.ts","core/field_textinput.ts","core/renderers/zelos/measurables/bottom_row.ts","core/renderers/zelos/measurables/inputs.ts","core/renderers/zelos/measurables/row_elements.ts","core/renderers/zelos/measurables/top_row.ts","core/renderers/zelos/info.ts","core/renderers/zelos/marker_svg.ts","core/renderers/zelos/path_object.ts","core/renderers/zelos/renderer.ts","core/insertion_marker_previewer.ts","core/inputs.ts","core/generator.ts","core/flyout_metrics_manager.ts","core/flyout_base.ts","core/flyout_vertical.ts","core/flyout_horizontal.ts","core/field_variable.ts","core/field_number.ts","core/field_label_serializable.ts","core/field_checkbox.ts","core/dragging/dragger.ts","core/dragging.ts","core/events/events_block_drag.ts","core/events/events_block_field_intermediate_change.ts","core/events/events_block_move.ts","core/events/events_bubble_open.ts","core/events/events_comment_base.ts","core/events/events_comment_change.ts","core/events/events_comment_create.ts","core/events/events_comment_delete.ts","core/events/events_comment_move.ts","core/events/events_comment_collapse.ts","core/events/events_toolbox_item_select.ts","core/events/workspace_events.ts","core/events/events.ts","core/renderers/zelos/zelos.ts","core/comments.ts","core/bubbles.ts","core/blockly_options.ts","core/renderers/geras/constants.ts","core/renderers/geras/highlighter.ts","core/renderers/geras/drawer.ts","core/renderers/geras/highlight_constants.ts","core/renderers/geras/measurables/inline_input.ts","core/renderers/geras/measurables/statement_input.ts","core/renderers/geras/info.ts","core/renderers/geras/path_object.ts","core/renderers/geras/renderer.ts","core/renderers/geras/geras.ts","core/renderers/thrasos/info.ts","core/renderers/thrasos/renderer.ts","core/renderers/thrasos/thrasos.ts","core/theme/zelos.ts","core/theme/themes.ts","core/toolbox/toolbox_item.ts","core/toolbox/category.ts","core/toolbox/separator.ts","core/toolbox/collapsible_category.ts","core/toolbox/toolbox.ts","core/utils/metrics.ts","core/renderers/common/i_path_object.ts","core/interfaces/i_toolbox_item.ts","core/interfaces/i_toolbox.ts","core/interfaces/i_styleable.ts","core/interfaces/i_serializer.ts","core/interfaces/i_registrable.ts","core/interfaces/i_procedure_model.ts","core/interfaces/i_procedure_map.ts","core/interfaces/i_positionable.ts","core/interfaces/i_parameter_model.ts","core/interfaces/i_movable.ts","core/interfaces/i_metrics_manager.ts","core/interfaces/i_keyboard_accessible.ts","core/interfaces/i_flyout.ts","core/interfaces/i_dragger.ts","core/interfaces/i_drag_target.ts","core/interfaces/i_delete_area.ts","core/interfaces/i_contextmenu.ts","core/interfaces/i_connection_previewer.ts","core/interfaces/i_connection_checker.ts","core/interfaces/i_component.ts","core/interfaces/i_collapsible_toolbox_item.ts","core/interfaces/i_bubble.ts","core/interfaces/i_bounded_element.ts","core/interfaces/i_autohideable.ts","core/interfaces/i_ast_node_location_with_block.ts","core/interfaces/i_ast_node_location_svg.ts","core/interfaces/i_ast_node_location.ts"],"names":["register","validate","unregister","getItem","hasItem","getClass","getObject","getAllItems","getClassFromOptions","getNextUniqueId","genUid","getRecordUndo","fire","fireInternal","fireNow","filter","clearPendingUndo","isEnabled","setGroupInternal","getDescendantIds","fromJson","get","disableOrphans","getWorkspaceById","getAllWorkspaces","registerWorkspace","unregisterWorkpace","getMainWorkspace","setMainWorkspace","getSelected","getParentContainer","setParentContainer","svgResize","getBlockTypeCounts","jsonInitFactory","defineBlocksWithJsonArray","defineBlocksWithJsonArrayInternal","longStart","longStop","clearTouchIdentifier","shouldHandleEvent","getTouchIdentifierFromEvent","checkTouchIdentifier","conditionalBind","bind","unbind","isTargetInput","isRightButton","mouseToSvg","getScrollDeltaPixels","removeElem","inject","createSvgElement","addClass","removeClasses","removeClass","hasClass","removeNode","insertAfter","setCssTransform","startTextWidthCache","stopTextWidthCache","getTextWidth","getFastTextWidth","getFastTextWidthWithSizeString","measureFontMetrics","getSize","getSizeInternal","getSizeWithDisplay","getComputedStyle","getPageOffset","getViewportPageOffset","getBorderBox","scrollIntoContainerView","getContainerOffsetToScrollInto","getRelativeXY","getInjectionDivXY","getViewportBBox","getDocumentScroll","screenToWsCoordinates","wsToScreenCoordinates","injectDependencies","domToText","sanitizeText","convertToolboxDefToJson","validateToolbox","convertFlyoutDefToJsonArray","hasCategories","hasCategoriesInternal","isCategoryCollapsible","convertToToolboxJson","xmlToJsonArray","addAttributes","parseToolboxTree","getStartPositionRect","getCornerOppositeToolbox","bumpPositionRect","alert","setAlert","confirm","confirmInternal","setConfirm","prompt","setPrompt","isVariableBackedParameterModel","isLegacyProcedureDefBlock","isLegacyProcedureCallBlock","flyoutCategory","flyoutCategoryBlocks","generateUniqueName","generateUniqueNameInternal","generateUniqueNameFromOptions","createVariableButtonHandler","promptName","nameUsedWithOtherType","nameUsedWithAnyType","nameUsedWithConflictingParam","checkForConflictingParamWithProcedureModels","checkForConflictingParamWithLegacyProcedures","generateVariableFieldDom","createVariable","getAddedVariables","queueRender","finishQueuedRenders","triggerQueuedRenders","alwaysImmediatelyRender","queueBlock","doRenders","dequeueBlock","shouldRenderRootBlock","renderBlock","save","append","moveCommentToNotConflict","commentOverlapsOtherExactly","setRole","setState","isSerializable","saveAttributes","saveCoords","saveExtraState","saveIcons","saveFields","saveInputBlocks","saveNextBlocks","saveConnection","appendInternal","appendPrivate","checkNewVariables","loadCoords","loadAttributes","loadExtraState","tryToConnectParent","loadIcons","loadFields","loadInputBlocks","loadNextBlocks","loadConnection","initBlock","hasBubble","toRadians","toDegrees","clamp","createDom","setBoundsElement","getOwner","getContentDiv","clearContent","setColour","showPositionedByBlock","showPositionedByField","getScaledBboxOfBlock","getScaledBboxOfField","showPositionedByRect","show","getPositionBelowMetrics","getPositionAboveMetrics","getPositionTopOfPageMetrics","getPositionX","isVisible","hideIfOwner","hide","hideWithoutAnimation","positionInternal","repositionForWindowResize","shortestStringLength","commonWordPrefix","commonWordSuffix","wrapLine","wrapScore","wrapMutate","wrapToText","setCustomTooltip","getCustomTooltip","getDiv","getTooltipOfObject","getTargetObject","bindMouseEvents","unbindMouseEvents","onMouseOver","onMouseOut","onMouseMove","dispose","block","unblock","renderContent","renderDefaultContent","getPosition","getHsvSaturation","setHsvSaturation","getHsvValue","setHsvValue","parse","rgbToHex","hexToRgb","hsvToHex","blend","hueToHex","tokenizeInterpolationInternal","tokenizeInterpolation","replaceMessageReferences","checkMessageReferences","parseBlockColour","testOnly_setDiv","hideIfOwnerIsInWorkspace","positionWithAnchor","calculateX","calculateY","isRepositionable","getCurrentBlock","setCurrentBlock","populate_","position_","createWidget_","haltPropagation","workspaceToDom","saveWorkspaceComment","variablesToDom","blockToDomWithXY","fieldToDom","allFieldsToDom","blockToDom","cloneShadow","domToPrettyText","clearWorkspaceAndLoadFromXml","loadWorkspaceComment","appendDomToWorkspace","domToBlockInternal","domToVariables","mapSupportedXmlTags","applyMutationTagNodes","applyCommentTagNodes","applyDataTagNodes","applyFieldTagNodes","findChildBlocks","applyInputTagNodes","applyNextTagNodes","domToBlockHeadless","domToField","deleteNext","isElement","disposeUiEffect","disposeUiStep","connectionUiEffect","disconnectUiEffect","disconnectUiStep","disconnectUiStop","isDraggable","deepMerge","isProcedureBlock","isObservable","fromJsonInternal","trimOptions","applyTrim","validateOptions","isRegistered","apply","checkNoMutatorProperties","checkXmlHooks","checkJsonHooks","checkMutatorDialog","checkHasFunctionPair","checkHasMutatorProperties","getMutatorProperties","mutatorPropertiesMatch","runAfterPageLoad","checkDropdownOptionsInTable","extensionParentTooltip","warn","point","curve","moveTo","moveBy","lineTo","line","lineOnAxis","arc","allProcedures","procTupleComparator","isLegalName","isNameUsed","updateMutatorFlyout","mutatorOpenListener","mutatorChangeListener","getCallers","blockIsModernCallerFor","isDynamicShape","isPuzzleTab","isNotch","connectReciprocally","getSingleConnection","getConnectionForOrphanedOutput","isIcon","isCommentIcon","getParentConnection","init","stringButtonClickHandler","numberButtonClickHandler","colourButtonClickHandler","resizeSvgContents","moveBlockToNotConflict","blockOverlapsOtherExactly","blockIsInSnapRadius","bumpObjectIntoBounds","bumpIntoBoundsHandler","extractObjectFromEvent","bumpTopObjectsIntoBounds","isDeletable","copyInternal","paste","pasteFromData","duplicateInternal","isCopyable","registerEscape","registerDelete","registerCopy","registerCut","registerPaste","registerUndo","registerRedo","registerDefaultShortcuts","saveProcedure","loadProcedure","load","createMainWorkspace","onKeyDown","bindDocumentEvents","loadSounds","registerCleanup","toggleOption_","registerCollapse","registerExpand","addDeletableBlocks_","getDeletableBlocks_","deleteNext_","registerDeleteAll","registerWorkspaceOptions_","registerDuplicate","registerComment","registerInline","registerCollapseExpandBlock","registerDisable","registerHelp","registerCommentDelete","registerCommentDuplicate","registerCommentCreate","pixelsToWorkspaceCoords","registerBlockOptions_","registerCommentOptions","registerDefaultOptions","isPaster","isRenderedElement","isSelectable","isSelectableToolboxItem","hideChaff","type","name","registryItem","opt_allowOverrides","Type","trim","Error","toLowerCase","caselessName","typeRegistry","typeMap","nameRegistry","nameMap","Object","create","String","FIELD","console","opt_throwIfMissing","msg","opt_cased","casedRegistry","key","keys","options","plugin","plugins","DEFAULT","toString","nextId","internal","setRecordUndo","newValue","recordUndo","event","TEST_ONLY","FIRE_QUEUE","length","requestAnimationFrame","setTimeout","e","push","queue","i","workspaceId","eventWorkspace","fireChangeListener","workspaceIds","Set","map","undoStack","getUndoStack","group","undefined","events","splice","queueIn","forward","slice","reverse","mergedQueue","hash","isNull","isUiEvent","eventType","UI","blockId","join","lastEntry","lastEvent","index","MOVE","moveEvent","newParentId","newInputName","newCoordinate","reason","reasonSet","concat","Array","from","CHANGE","element","VIEWPORT_CHANGE","viewportEvent","viewTop","viewLeft","scale","oldScale","CLICK","BUBBLE_OPEN","unshift","disable","disabled","enable","getGroup","setGroup","state","ids","descendants","getDescendants","descendant","id","json","workspace","eventClass","EVENT","CREATE","getBlockById","initialUndoFlag","parent","getParent","hasDisabledReason","ORPHANED_BLOCK_DISABLED_REASON","children","child","setDisabledReason","outputConnection","previousConnection","isDragging","getNextBlock","WorkspaceDB_","workspaces","mainWorkspace","selected","setSelected","newSelection","SELECTED","unselect","select","parentContainer","newParent","parentWorkspace","svg","getParentSvg","cachedSize","getCachedParentSvgSize","div","parentElement","HTMLElement","width","offsetWidth","height","offsetHeight","setAttribute","setCachedParentSvgSize","resize","opt_stripFollowing","typeCountsMap","nextBlock","indexOf","checkBlock","jsonDef","jsonInit","jsonArray","defineBlocks","createBlockDefinitionsFromJsonArray","blocks","elem","definition","Blocks","gesture","longPid_","handleRightClick","LONGPRESS","clearTimeout","touchIdentifier_","startsWith","PointerEvent","pointerId","identifier","node","thisObject","func","opt_noCaptureIdentifier","wrapFunc","call","bindData","TOUCH_MAP","addEventListener","callback","pop","removeEventListener","target","isContentEditable","getAttribute","HTMLInputElement","HTMLTextAreaElement","ctrlKey","MAC","button","matrix","svgPoint","createSVGPoint","x","clientX","y","clientY","getScreenCTM","inverse","matrixTransform","deltaMode","deltaX","deltaY","LINE_MODE_MULTIPLIER","PAGE_MODE_MULTIPLIER","arr","value","cssContent","injected","content","hasCss","pathToMedia","mediaPath","replace","cssNode","document","createElement","cssTextNode","createTextNode","appendChild","head","insertBefore","firstChild","attrs","opt_parent","createElementNS","SVG_NS","className","classNames","split","every","classList","contains","add","remove","parentNode","removeChild","newNode","refNode","siblingNode","nextSibling","transform","style","cacheReference","cacheWidths","textElement","textContent","baseVal","getComputedTextLength","fontSize","fontWeight","fontFamily","text","canvasContext","computeCanvas","body","getContext","font","measureText","span","display","position","top","left","result","baseline","alignItems","offsetTop","originalDisplay","originalVisibility","visibility","originalPosition","Size","property","styles","window","getPropertyValue","el","pos","Coordinate","box","getBoundingClientRect","documentElement","scrollCoord","pageXOffset","scrollLeft","pageYOffset","scrollTop","parseFloat","right","bottom","Rect","container","opt_center","offset","elementPos","containerPos","containerBorder","relX","relY","elementSize","spaceX","clientWidth","spaceY","clientHeight","Math","min","max","xy","parseInt","r","match","XY_REGEX","Number","includes","styleComponents","XY_STYLE_REGEX","scrollOffset","win","ws","screenCoordinates","screenX","screenY","boundingRect","getInjectionDiv","injectionDiv","clientOffsetPixels","mainOffsetPixels","getOriginOffsetInPixels","difference","finalOffsetPixels","finalOffsetMainWs","workspaceCoordinates","mainOffset","dependencies","DOMParser","XMLSerializer","domParser","xmlSerializer","tagName","NAME_SPACE","textToDom","doc","parseFromString","getElementsByTagName","nodeName","dom","serializeToString","INVALID_CONTROL_CHARS","charCodeAt","toolboxDef","Element","toolboxJson","toolboxKind","toolboxContents","FLYOUT_TOOLBOX_KIND","CATEGORY_TOOLBOX_KIND","flyoutDef","isArray","nodeType","categories","item","toUpperCase","categoryInfo","contents","Node","childNodes","obj","j","attributes","attr","parsedToolboxDef","TypeError","size","horizontalPadding","verticalPadding","metrics","hasVerticalScrollbar","scrollbar","canScrollVertically","horizontal","horizontalPosition","LEFT","absoluteMetrics","RTL","Scrollbar","scrollbarThickness","viewMetrics","vertical","verticalPosition","TOP","canScrollHorizontally","toolboxMetrics","hPosition","Position","horizontalLayout","RIGHT","vPosition","BOTTOM","startRect","margin","bumpDir","savedPositions","otherEl","intersects","bumpDirection","UP","message","opt_callback","alertImplementation","alertFunction","confirmImplementation","confirmFunction","defaultValue","promptImplementation","promptFunction","param","getVariableModel","getProcedureDef","getProcedureCall","renameProcedure","allUsedVarModels","getAllBlocks","variables","blockVariables","getVarModels","variable","getId","values","allDeveloperVariables","getDeveloperVariables","devVars","xmlList","registerButtonCallback","getTargetWorkspace","blockList","variableModelList","getVariablesOfType","mostRecentVariable","sort","VariableModel","compareByName","VAR_LETTER_OPTIONS","charAt","getAllVariableNames","startChar","usedNames","letters","suffix","letterIndex","inUse","potName","opt_type","promptAndCheckWithAlert","defaultName","Msg","existing","renameVariable","promptText","newName","procedure","renameVariableById","defaultText","newVar","allVariables","getVariableMap","getAllVariables","oldName","getProcedureMap","getProcedures","procedures","params","getParameters","procHasOld","some","procHasNew","getName","def","blockHasOld","blockHasNew","variableModel","field","getOrCreateVariablePackage","opt_name","getVariable","potentialVariableMap","getPotentialVariableMap","getVariableById","isFlyout","targetWorkspace","originalVariables","allCurrentVariables","addedVariables","Promise","resolve","afterRendersPromise","afterRendersResolver","animationRequestId","cancelAnimationFrame","JavaFx","dirtyBlocks","eventGroups","set","rootBlocks","b","has","resizeContents","blockOrigin","getRelativeToSurfaceXY","updateComponentLocations","oldGroup","newGroup","bumpNeighbours","delete","getChildren","isDisposed","initialized","renderEfficiently","serializer","SERIALIZER","comment","addCoordinates","saveIds","loc","getWidth","getText","isCollapsed","collapsed","isOwnEditable","editable","isOwnMovable","movable","isOwnDeletable","deletable","prevRecordUndo","newComment","setText","defaultLoc","defaultSize","setSize","setCollapsed","setEditable","setMovable","setDeletable","paster","PASTER","coord","otherCoords","getTopComments","otherComment","c","sum","translate","translateDistance","otherCoord","abs","roleName","ROLE_ATTRIBUTE","stateName","ARIA_PREFIX","saveState","loadState","addInputBlocks","addNextBlocks","doFullSerialization","isInsertionMarker","getDisabledReasons","inputsInline","inputsInlineDefault","data","round","extraState","mutationToDom","icons","icon","getIcons","getType","fields","inputList","input","fieldRow","inputs","connection","connectionState","nextConnection","shadow","getShadowState","targetBlock","isShadow","rendered","parentConnection","existingGroup","variablesBeforeCreation","BLOCK_CREATE","blockSvg","disposed","setConnectionTracking","MissingBlockType","newBlock","setShadow","newVariables","thisVariable","VAR_CREATE","MANUALLY_DISABLED","setInputsInline","domToMutation","getSourceBlock","RealChildOfShadow","inputTypes","VALUE","childConnection","MissingConnection","connect","connected","checker","connectionChecker","BadConnectionCheck","getErrorMessage","canConnectWithReason","iconTypes","iconType","iconState","getIcon","constructor","ICON","UnregisteredIcon","addIcon","fieldName","fieldState","getField","inputName","getInput","setShadowState","initSvg","onLocationChange","initModel","bubbleIsVisible","setBubbleVisible","angleDegrees","PI","angleRadians","lowerBound","number","upperBound","temp","querySelector","arrow","opacity","transition","ANIMATION_TIME","boundsElem","boundsElement","owner","backgroundColour","borderColour","backgroundColor","borderColor","opt_onHide","opt_secondaryYOffset","positionToField","getSvgRoot","scaledHeight","scaledWidth","bBox","getScaledBBox","primaryX","primaryY","secondaryY","sourceBlock","newOwner","rtl","secondaryX","onHide","direction","renderedClassName","getRenderer","getClassName","themeClassName","getTheme","boundsInfo","divSize","xCoords","initialX","divX","initialY","finalX","finalY","PADDING_Y","arrowX","arrowY","ARROW_SIZE","BORDER_SIZE","arrowAtTop","arrowVisible","sourceX","boundsLeft","boundsRight","divWidth","relativeArrowX","horizPadding","ARROW_HORIZONTAL_PADDING","divOwner","opt_withoutAnimation","animateOutTimer","markFocused","getPositionMetrics","floor","array","reduce","a","opt_shortest","wordPrefix","len","letter","substr","wrap","limit","lines","words","score","Infinity","lastText","lineCount","lastScore","wordBreaks","steps","insertedBreaks","lineLengths","linePunctuation","maxLength","pow","bestScore","bestBreaks","mutatedWordBreaks","mutatedScore","isNumber","str","test","customFn","customTooltip","visible","containerDiv","object","tooltip","mouseOverWrapper_","mouseOutWrapper_","blocked","newElement","currentTarget","poisonedElement","mouseOutPid","_e","showPid","dx","lastX","pageX","dy","lastY","pageY","sqrt","RADIUS_OK","HOVER_MS","tip","LIMIT","windowWidth","windowHeight","anchorX","OFFSET_X","anchorY","OFFSET_Y","scrollY","MARGINS","scrollX","hsvSaturation","newSaturation","hsvValue","hex","names","substring","rgb","g","colour","h","s","v","red","green","blue","sextant","remainder","val1","val2","val3","colour1","colour2","factor","hex1","hex2","rgb1","rgb2","hue","parseInterpolationTokens","tokenizeNewlines","tokens","chars","buffer","rawKey","keyUpper","bklyKey","rawValue","prototype","mergedTokens","interpolatedResult","validSoFar","msgTable","m","msgKey","dereferenced","isNaN","errorMsg","newDiv","containerClassName","newDispose","Field","ownerWorkspace","rendererWorkspace","rendererClassName","oldOwner","oldOwnerWorkspace","viewportBBox","anchorBBox","widgetSize","currentBlock","dummyOwner","menu","menu_","focus","Menu","Role","MENU","option","menuItem","MenuItem","setRightToLeft","MENUITEM","addChild","setEnabled","enabled","onAction","actionHandler","scope","menuSize","menuDom","render","preventDefault","stopPropagation","callbackFactory","config","snapRadius","skipId","treeXml","variablesElement","hasChildNodes","getTopBlocks","variableList","opt_noId","DocumentFragment","toXml","fieldDom","mutation","hasAttributes","commentText","getCommentText","IconType","COMMENT","getBubbleSize","pinned","commentElement","dataElement","empty","DUMMY","END_ROW","childBlock","STATEMENT","childShadow","getShadowDom","childElem","NodeType","ELEMENT_NODE","encodeURIComponent","nextElem","nextShadow","cloneNode","textNode","removeAttribute","TEXT_NODE","blob","indent","xml","setResizesEnabled","clear","blockIds","domToWorkspace","newBlockIds","variablesFirst","xmlChild","xmlChildElement","blockX","blockY","FINISHED_LOADING","RenderedWorkspaceComment","WorkspaceComment","w","getBlocksBoundingBox","bbox","farY","topX","newLeftX","newRightX","newY","blockXY","offsetY","ySeparation","offsetX","domToBlock","xmlBlock","topBlock","topBlockSvg","xmlVariables","childNodeMap","next","xmlChildren","shouldCallInitSvg","setCommentText","setBubbleSize","xmlNode","childBlockElement","childShadowElement","prototypeName","childBlockInfo","setShadowDom","isConnected","connectedToParentNext","outerHTML","xmlChildNameMap","inline","disabledReasons","decodeURIComponent","fromXml","svgGroup","getAudioManager","play","clone","getLayerManager","appendToAnimationLayer","cloneRect","Date","rect","start","percent","getTime","getSvgXY","ripple","Svg","CIRCLE","scaleAnimation","ANIMATE","opacityAnimation","beginElement","getHeightWidth","magnitude","atan","DISPLACEMENT","wobblingBlock","DURATION","skew","val","sin","WIGGLES","disconnectPid","getTranslation","isMovable","startDrag","drag","endDrag","revertDrag","source","getProcedureModel","doProcedureUpdate","isProcedureDef","startPublishing","stopPublishing","fieldClass","fieldObject","hasImages","trimmedOptions","label","imageLabel","alt","stringLabels","shortest","prefixLength","suffixLength","prefix","foundError","tuple","error","src","initFn","allExtensions","registerMixin","mixinObj","mixin","registerMutator","opt_helperFn","opt_blockList","errorPrefix","hasMutatorDialog","setMutator","MutatorIcon","isMutator","extensionFn","mutatorProperties","mutationName","properties","compose","decompose","func1","func2","hasXmlHooks","hasJsonHooks","oldProperties","newProperties","fn","readyState","readyStateCheckInterval","setInterval","clearInterval","buildTooltipForDropdown","dropdownName","lookupTable","blockTypesChecked","setTooltip","getFieldValue","dropdown","FieldDropdown","isOptionListDynamic","getOptions","buildTooltipWithFieldText","msgTemplate","tooltipWhenNotConnected","getInputsInline","deprecationDate","deletionDate","opt_use","previousWarnings","command","points","flags","radius","iconConstructor","root","proceduresNoReturn","p","getReturnTypes","pa","getBlocksByType","forEach","proceduresReturn","ta","tb","localeCompare","sensitivity","findLegalName","isInFlyout","opt_exclude","Names","equals","excludeModel","model","rename","UnattachedFieldError","legalName","setName","getValue","procedureBlock","populateProcedures","procedureList","templateName","args","arg","nameField","xmlElement","argBlock","argValue","DEFAULT_ARG","fieldContent","updateToolbox","bubbleType","isOpen","TYPE","getWorkspace","addChangeListener","BLOCK_DELETE","BLOCK_CHANGE","BLOCK_FIELD_INTERMEDIATE_CHANGE","procName","mutateCallers","defBlock","oldRecordUndo","callers","caller","oldMutation","oldMutationDom","newMutationDom","newMutation","getDefinition","shape","isDynamic","pathDown","pathUp","pathLeft","pathRight","first","second","targetConnection","orphanBlock","foundConnection","output","typeChecker","getConnectionChecker","canConnect","startBlock","initView","getWeight","applyColour","hideForInsertionMarker","updateEditable","updateCollapsed","isShownWhenCollapsed","setOffsetInBlock","onClick","topConnection","rendererClass","RENDERER","theme","opt_rendererOverrides","renderer","firstVariable","bumpOffset","otherBlock","getConnections_","closest","bounds","objectMetrics","getBoundingRectangle","newYPosition","leftClamp","rightClamp","newXPosition","metricsManager","getMetricsManager","hasFixedEdges","BUMP_EVENTS","scrollMetricsInWsCoords","getScrollMetrics","wasBumped","BLOCK_MOVE","getRootBlock","COMMENT_CREATE","COMMENT_MOVE","getCommentById","commentId","topBlocks","getTopBoundedElements","toCopy","toCopyData","stashedCopyData","stashedWorkspace","copyData","coordinate","getRootWorkspace","toDuplicate","ShortcutRegistry","registry","escapeAction","ESCAPE","preconditionFn","readOnly","keyCodes","KeyCodes","ESC","deleteShortcut","DELETE","Gesture","inProgress","BlockSvg","checkAndDelete","BACKSPACE","ctrlC","createSerializedKey","C","CTRL","altC","ALT","metaC","META","copyShortcut","COPY","copyWorkspace","copyCoords","ctrlX","X","altX","metaX","cutShortcut","CUT","ctrlV","V","altV","metaV","pasteShortcut","PASTE","getViewMetrics","viewportRect","centerCoords","ctrlZ","Z","altZ","metaZ","undoShortcut","UNDO","undo","ctrlShiftZ","SHIFT","altShiftZ","metaShiftZ","ctrlY","Y","redoShortcut","REDO","proc","parameters","procedureModelClass","parameterModelClass","entries","insertParameter","serializerMap","deserializers","priority","WorkspaceSvg","deserializer","pluginState","opt_options","containerElement","getElementById","ownerDocument","Options","subContainer","tabIndex","State","LABEL","SVG","HTML_NS","XLINK_NS","defs","DEFS","rnd","random","gridPattern","Grid","gridOptions","wsOptions","zoomOptions","startScale","languageTree","flyout","addFlyout","hasTrashcan","addTrashcan","controls","addZoomControls","getThemeManager","subscribe","workspaceResizeHandler","hideComponents","setResizeHandlerWrapper","toolbox","getToolbox","getFlyout","scrollToStart","trashcan","zoomControls_","moveOptions","scrollbars","ScrollbarPair","setMetrics","hasSounds","documentEventsBound","updateInverseScreenCTM","IPAD","unbindSounds","soundBinds","oldSoundBinding","audioMgr","preload","ContextMenuRegistry","undoOption","displayText","scopeType","ScopeType","WORKSPACE","weight","redoOption","getRedoStack","cleanOption","cleanUp","shouldCollapse","timeoutFn","timeoutCounter","ms","DELAY","collapseOption","collapse","expandOption","deleteList","eventGroup","shift","isDeadOrDying","deleteOption","deletableBlocksLength","cancelCurrentGesture","deletableBlocks","ok","duplicateOption","isDuplicatable","BLOCK","commentOption","hasIcon","CommentIcon","comments","isEditable","inlineOption","StatementInput","collapseExpandOption","disableOption","isDisabledForOtherReason","getInheritedDisabled","descendantCount","helpOption","url","helpUrl","showHelp","createOption","pixelCoord","finalOffset","toolboxItem","opt_onlyClosePopups","CONNECTION_CHECKER","CONNECTION_PREVIEWER","CURSOR","INPUT","TOOLBOX","THEME","TOOLBOX_ITEM","FLYOUTS_VERTICAL_TOOLBOX","FLYOUTS_HORIZONTAL_TOOLBOX","METRICS_MANAGER","BLOCK_DRAGGER","$jscomp$tmp$exports$module$name","soup","soupLength","VAR_DELETE","VAR_RENAME","BLOCK_DRAG","MARKER_MOVE","TRASHCAN_OPEN","TOOLBOX_ITEM_SELECT","THEME_CHANGE","COMMENT_DELETE","COMMENT_CHANGE","COMMENT_COLLAPSE","draggingConnections","Abstract","toJson","isBlank","run","_forward","getEventWorkspace_","UiBase","AbstractEvent","opt_workspaceId","Click","opt_block","opt_targetType","targetType","newEvent","ClickTarget","ZOOM_CONTROLS","TOUCH_ENABLED","globalThis","rawUserAgent","isJavaFx","isWebKit","isGecko","isAndroid","isIPad","isIPhone","isMac","isTablet","isMobile","raw","rawUpper","maxTouchPoints","GECKO","ANDROID","IPHONE","MOBILE","Capability","name_","POSITIONABLE","DRAG_TARGET","DELETE_AREA","AUTOHIDEABLE","ComponentManager","componentData","Map","capabilityToComponentIds","addComponent","componentInfo","component","capabilities","stringCapabilities","capability","removeComponent","addCapability","getComponent","hasCapability","removeCapability","getComponents","sorted","componentIds","components","componentDataList","componentDatum","tx","ty","distance","COMMENT_NODE","CLIPPATH","FECOMPOSITE","FECOMPONENTTRANSFER","FEFLOOD","FEFUNCA","FEGAUSSIANBLUR","FEPOINTLIGHT","FESPECULARLIGHTING","FILTER","FOREIGNOBJECT","G","IMAGE","LINE","PATH","PATTERN","POLYGON","RECT","TEXT","TSPAN","getHeight","other","opt_pair","opt_class","opt_margin","oldHostMetrics","ratio","origin","startDragHandle","handlePosition","handleLength","scrollbarLength","startDragMouse","containerVisible","isHandleVisible","onMouseMoveWrapper_","onMouseUpWrapper_","pair","DEFAULT_SCROLLBAR_MARGIN","outerSvg","svgBackground","svgHandle","setInitialThickness","lengthAttribute_","positionAttribute_","onMouseDownBarWrapper_","onMouseDownBar","onMouseDownHandleWrapper_","onMouseDownHandle","unsubscribe","constrainHandleLength","setHandleLength","newLength","constrainHandlePosition","setHandlePosition","newPosition","setScrollbarLength","newSize","setPosition","opt_metrics","hostMetrics","getMetrics","metricsAreEquivalent","resizeHorizontal","resizeVertical","updateMetrics","requiresViewResize","viewWidth","viewHeight","absoluteLeft","absoluteTop","resizeViewHorizontal","resizeContentHorizontal","viewSize","xCoordinate","scrollWidth","setVisible","maxScrollDistance","maxHandleOffset","handleOffset","resizeViewVertical","resizeContentVertical","scrollHeight","setContainerVisible","visibilityChanged","updateDisplay_","setVisibleInternal","mouseXY","getInverseScreenCTM","mouseLocation","handleXY","handleStart","pageLength","onMouseUpHandle","onMouseMoveHandle","currentMouse","getRatio_","setOrigin","DOWN","SPRITE","ZoomControls","boundEvents","zoomResetGroup","zoomOutGroup","zoomInGroup","HEIGHT","WIDTH","SMALL_SPACING","LARGE_SPACING","MARGIN_HORIZONTAL","MARGIN_VERTICAL","createZoomOutSvg","createZoomInSvg","createZoomResetSvg","getComponentManager","cornerPosition","positionRect","zoomInTranslateY","zoomOutTranslateY","clip","zoomoutSvg","setAttributeNS","zoom","zoominSvg","amount","zoomCenter","fireZoomEvent","zoomresetSvg","resetZoom","log","scaleSpeed","beginCanvasTransition","scrollCenter","endCanvasTransition","uiEvent","COLLAPSED_INPUT_NAME","COLLAPSED_FIELD_NAME","MUTATOR","WARNING","CUSTOM","setLocale","locale","k","VarBase","opt_variable","varId","VarCreate","varType","varName","deleteVariableById","opt_id","id_","var1","var2","CATEGORY_NAME","WeakSet","WeakMap","location","disposing","addTopComment","fireCreateEvent","fireDeleteEvent","fireChangeEvent","oldText","newText","fireCollapseEvent","newCollapsed","setReason","recordNew","removeTopComment","BUBBLE","CommentView","textChangeListeners","sizeChangeListeners","disposeListeners","collapseChangeListeners","resizePointerMoveListener","resizePointerUpListener","svgRoot","highlightRect","createHighlightRect","topBarGroup","topBarBackground","deleteIcon","foldoutIcon","textPreview","textPreviewNode","createTopBar","foreignObject","textArea","createTextArea","resizeHandle","createResizeHandle","onFoldoutDown","onDeleteDown","onTextChange","onResizePointerDown","getBBox","topBarSize","deleteSize","foldoutSize","textPreviewSize","resizeSize","calcMinSize","oldSize","updateHighlightRect","updateTopBarSize","updateTextAreaSize","updateDeleteIconPosition","updateFoldoutIconPosition","updateTextPreviewSize","updateResizeHandlePosition","onSizeChange","updateTextPreview","textPreviewWidth","foldoutMargin","calcFoldoutMargin","deleteMargin","calcDeleteMargin","checkVisibility","textPreviewMargin","addSizeChangeListener","listener","removeSizeChangeListener","bringToFront","onResizePointerUp","onResizePointerMove","delta","moveDrag","onCollapse","addOnCollapseListener","removeOnCollapseListener","addTextChangeListener","removeTextChangeListener","truncateText","addDisposeListener","removeDisposeListener","CommentDragStrategy","startLoc","moveToDragLayer","setDragging","newLoc","moveDuringDrag","fireMoveEvent","moveOffDragLayer","snapToGrid","oldCoordinate_","VARIABLES","PROCEDURES","BLOCKS","WORKSPACE_COMMENTS","saveComment","WorkspaceCommentSerializer","commentStates","commentState","WorkspaceCommentPaster","DEFAULT_SNAP_RADIUS","dragRadius","flyoutDragRadius","connectingSnapRadius","currentConnectionPreference","bumpDelay","GRID","GRIDCELL","GROUP","LISTBOX","MENUITEMCHECKBOX","OPTION","PRESENTATION","ROW","TREE","TREEITEM","menuItems","onKeyDownHandler","mouseLeaveHandler","mouseEnterHandler","clickHandler","mouseOverHandler","highlightedItem","openingCoords","handleMouseOver","handleClick","handleMouseEnter","handleMouseLeave","handleKeyEvent","getElement","preventScroll","blur","getMenuItem","menuElem","currentElement","setHighlighted","currentHighlighted","ACTIVEDESCENDANT","highlightNext","highlightHelper","highlightPrevious","highlightFirst","highlightLast","startIndex","oldCoords","newCoords","performAction","shiftKey","metaKey","altKey","highlighted","opt_value","rightToLeft","highlight","checked","checkable","checkbox","contentDom","DISABLED","setCheckable","setChecked","nameDep","DeserializationError","toDevString","childState","saveBlock","BlockSerializer","blockStates","BlockBase","BlockChange","opt_element","opt_oldValue","opt_newValue","oldValue","disabledReason","setValue","oldState","getExtraBlockState_","JSON","stringify","getBoundsInfo","boundPosition","boundSize","clientTop","MarkerManager","cursorSvg_","cursor_","markers","markerSvg_","registerMarker","marker","unregisterMarker","setDrawer","makeMarkerDrawer","setMarkerSvg","getDrawer","getCursor","getMarker","setCursor","cursor","drawer","setCursorSvg","cursorSvg","getBlockCanvas","markerSvg","updateMarkers","keyboardAccessibilityMode","draw","markerIds","markerId","LOCAL_MARKER","validator","DEFAULT_VALUE","constants_","mouseDownWrapper_","textContent_","textElement_","borderRect_","fieldGroup_","tooltip_","validator_","maxDisplayLength","sourceBlock_","enabled_","visible_","isDirty_","suffixField","prefixField","clickTarget_","EDITABLE","SERIALIZABLE","value_","size_","SKIP_SETUP","configure_","setValidator","setSourceBlock","getConstants","bindEvents_","createBorderRect_","createTextElement_","isFullBlockField","FIELD_BORDER_RECT_RADIUS","FIELD_TEXT_BASELINE_CENTER","clickTarget","getClickTarget_","onMouseDown_","fieldElement","_doFullSerialization","legacyState","saveLegacyState","loadLegacyState","callingClass","isClickable","showEditor_","isClickableInFlyout","autoClosingFlyout","isCurrentlyEditable","handler","getValidator","getBorderRect","getTextElement","getTextContent","render_","nodeValue","getDisplayText_","updateSize_","showEditor","constants","xOffset","FIELD_BORDER_RECT_X_PADDING","totalWidth","totalHeight","FIELD_TEXT_HEIGHT","contentWidth","FIELD_TEXT_FONTSIZE","FIELD_TEXT_FONTWEIGHT","FIELD_TEXT_FONTFAMILY","FIELD_BORDER_RECT_HEIGHT","positionTextElement_","positionBorderRect_","halfHeight","FIELD_TEXT_BASELINE","getAbsoluteXY_","_","NBSP","getText_","markDirty","forceRerender","classValidation","doClassValidation_","classValue","processValidation_","localValidation","localValue","doValueUpdate_","validatedValue","doValueInvalid_","_invalidValue","_fireChangeEvent","getGesture","setStartField","newTip","getTooltip","referencesVariables","refreshVariableName","getParentInput","parentInput","idx","fieldRows","getFlipRtl","isTabNavigable","onShortcut","_shortcut","updateMarkers_","_options","Symbol","registry_","reset","getContextMenuOptions","menuOptions","precondition","menuOption","dragStrategy","view","addModelUpdateBindings","startGesture","dragging","handleCommentStart","setDeleteStyle","wouldDelete","showContextMenu","grid","getGrid","shouldSnap","currentXY","alignedXY","alignXY","BlockCreate","allShadowBlocks","shadows","ThemeChange","opt_themeName","themeName","ViewportChange","opt_top","opt_left","opt_scale","opt_oldScale","ConnectionType","INPUT_VALUE","OUTPUT_VALUE","NEXT_STATEMENT","PREVIOUS_STATEMENT","ConnectionDB","connections","addConnection","yPos","calculateIndexForYPos","findIndexOfConnection","conn","bestGuess","pointer","pointerMin","pointerMax","pointerMid","removeConnection","getNeighbours","maxRadius","checkConnection","yIndex","currentX","db","currentY","neighbours","isInYRange","baseY","searchForClosest","dxy","baseX","closestIndex","bestConnection","bestRadius","distanceFrom","dbList","WorkspaceDragger","horizontalScrollEnabled_","isMovableHorizontally","verticalScrollEnabled_","isMovableVertically","startScrollXY_","currentDragDeltaXY","newXY","scroll","ZOOM_IN_MULTIPLIER","ZOOM_OUT_MULTIPLIER","creatorWorkspace","mouseDownXY","startWorkspace_","startComment","startIcon","startField","startBubble","hasExceededDragRadius","workspaceDragger","dragger","isMultiTouch_","isEnding_","gestureHasStarted","calledUpdateIsDragging","cachedPoints","startDistance","previousScale","currentDropdownOwner","isPinchZoomEnabled","mostRecentEvent","clearGesture","updateFromEvent","updateDragDelta","changed","updateIsDragging","currentDragDelta","limitRadius","updateIsDraggingFromFlyout","isBlockCreatable","isScrollable","isDragTowardWorkspace","updateScreenCalculationsIfScrolled","createBlock","updateIsDraggingWorkspace","wsMovable","createDragger","onDragStart","onDrag","draggable","DraggerClass","doStart","pinch","cancel","pointerType","handleTouchStart","handleMove","handleUp","isMultiTouch","handleTouchMove","handleTouchEnd","onDragEnd","isBubbleClick","isCommentClick","isFieldClick","doFieldClick","isIconClick","doIconClick","isBlockClick","doBlockClick","isWorkspaceClick","doWorkspaceClick","getTouchPoint","pointers","point0","point1","handlePinch","moveDistance","gestureScale","bringBlockToFront","handleWsStart","setStartWorkspace","fireWorkspaceClick","handleFlyoutStart","setStartFlyout","handleBlockStart","setStartBlock","handleBubbleStart","bubble","setStartBubble","setStartComment","autoClose","setStartIcon","setTargetBlock","hasStartBubble","hasStartBlock","handleInFlyout","getCurrentDragger","hasStarted","currentGesture_","pattern","spacing","line2","line1","setSpacing","update","getSpacing","setLength","getLength","setSnapToGrid","snap","getPatternId","safeSpacing","half","end","setLineAttributes","x1","x2","y1","y2","Theme","opt_blockStyles","opt_categoryStyles","opt_componentStyles","startHats","blockStyles","categoryStyles","componentStyles","fontStyle","setBlockStyle","blockStyleName","blockStyle","setCategoryStyle","categoryStyleName","categoryStyle","getComponentStyle","componentName","recursiveStyle","setComponentStyle","styleValue","setFontStyle","setStartHats","defineTheme","themeObj","base","defaultBlockStyles","Classic","toolboxJsonDef","hasCollapse","hasComments","hasDisable","rawHasTrashcan","rawHasCollapse","rawHasComments","rawHasDisable","rawHasSounds","maxTrashcanContents","toolboxAtStart","toolboxPosition","endsWith","rawOneBasedIndex","modalInputs","oneBasedIndex","maxBlocks","maxInstances","parseMoveOptions_","hasScrollbars","parseGridOptions_","parseZoomOptions_","parseThemeOptions_","rendererOverrides","move","wheel","maxScale","minScale","reservedWordsList","opt_variablePrefix","dbReverse","variableMap","variablePrefix","reservedWords","setVariableMap","getNameForUserVariable","populateVariables","NameType","VARIABLE","nameOrId","normalizedName","DEVELOPER_VARIABLE","typeDb","safeName","getDistinctName","getUserNames","userNames","encodeURI","name1","name2","PROCEDURE","DEVELOPER_VARIABLE_TYPE","ObservableProcedureMap","existed","Icon","offsetInBlock","workspaceLocation","pointerdownListener","svgBlock","updateSvgRootOffset","menuGenerator","svgArrow","imageElement","selectedMenuItem","generatedOptions","trimmed","menuGenerator_","selectedOption","shouldAddBorderRect_","FIELD_DROPDOWN_SVG_ARROW","createSVGArrow_","createTextArrow_","FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW","ARROW_CHAR","FIELD_DROPDOWN_SVG_ARROW_SIZE","FIELD_DROPDOWN_SVG_ARROW_DATAURI","dropdownCreate","menuElement","FIELD_DROPDOWN_COLOURED_DIV","primaryColour","getColour","colourTertiary","dropdownDispose_","image","Image","handleMenuActionEvent","onItemSelected_","useCache","isValueValid","fill","colourSecondary","colourPrimary","renderSelectedImage","renderSelectedText","imageJson","imageHeight","imageWidth","hasBorder","FIELD_DROPDOWN_BORDER_RECT_HEIGHT","IMAGE_Y_PADDING","xPadding","arrowWidth","positionSVGArrow","textWidth","textPadding","FIELD_DROPDOWN_SVG_ARROW_PADDING","svgArrowSize","CHECKMARK_OVERHANG","MAX_MENU_HEIGHT_VH","IMAGE_Y_OFFSET","BubbleDragStrategy","_a","Bubble","anchor","ownerRect","relativeLeft","relativeTop","getBubbleCanvas","embossGroup","embossFilterId","tail","background","BORDER_WIDTH","contentContainer","onMouseDown","setAnchorLocation","relayout","positionByRect","positionRelativeToAnchor","renderTail","setPositionRelativeToAnchor","MIN_SIZE","optimalLeft","getOptimalRelativeLeft","optimalTop","getOptimalRelativeTop","topPosition","MIN_BLOCK_HEIGHT","startPosition","endPosition","bottomPosition","closerPosition","fartherPosition","topPositionOverlap","getOverlap","startPositionOverlap","closerPositionOverlap","fartherPositionOverlap","mostOverlap","relativeMin","workspaceRect","getWorkspaceViewRect","bubbleRight","bubbleLeft","getScrollbarThickness","relBubbleX","relBubbleY","relAnchorX","relAnchorY","rise","hypotenuse","angle","acos","rightAngle","rightRise","rightRun","cos","thickness","TAIL_THICKNESS","backoffRatio","ANCHOR_RADIUS","baseX1","baseY1","baseX2","baseY2","radians","TAIL_ANGLE","swirlAngle","swirlRise","TAIL_BEND","swirlRun","lastChild","_start","_enable","DOUBLE_BORDER","MiniWorkspaceBubble","workspaceOptions","autoLayout","validateWorkspaceOptions","svgDialog","miniWorkspace","newWorkspaceSvg","internalIsMutator","getCanvas","onWorkspaceChange","updateBubbleSize","addWorkspaceChangeListener","bumpBlocksIntoBounds","MARGIN","currSize","calculateWorkspaceSize","MINIMUM_VIEW_CHANGE","recordDragTargets","workspaceSize","flyoutScrollMetrics","updateBlockStyles","setStyle","getStyleName","flyoutWs","SIZE","WORKSPACE_MARGIN","flyoutBlockTypes","saveConnectionsListener","updateWorkspacePid","rootBlock","miniWorkspaceBubble","WEIGHT","getAnchorLocation","getMiniWorkspaceConfig","getBubbleOwnerRect","createRootBlock","addSaveConnectionsListener","createMiniWorkspaceChangeListener","removeChangeListener","midIcon","flyoutWidth","saveConnections","this.saveConnectionsListener","isIgnorableMutatorEvent","recomposeSourceBlock","oldExtraState","newExtraState","WIN_KEY_FF_LINUX","MAC_ENTER","TAB","NUM_CENTER","ENTER","PAUSE","CAPS_LOCK","SPACE","PAGE_UP","PAGE_DOWN","END","HOME","PLUS_SIGN","PRINT_SCREEN","INSERT","ZERO","ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE","FF_SEMICOLON","FF_EQUALS","FF_DASH","FF_HASH","QUESTION_MARK","AT_SIGN","A","B","D","E","F","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","W","WIN_KEY_RIGHT","CONTEXT_MENU","NUM_ZERO","NUM_ONE","NUM_TWO","NUM_THREE","NUM_FOUR","NUM_FIVE","NUM_SIX","NUM_SEVEN","NUM_EIGHT","NUM_NINE","NUM_MULTIPLY","NUM_PLUS","NUM_MINUS","NUM_PERIOD","NUM_DIVISION","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","NUMLOCK","SCROLL_LOCK","FIRST_MEDIA_KEY","LAST_MEDIA_KEY","SEMICOLON","DASH","EQUALS","COMMA","PERIOD","SLASH","APOSTROPHE","TILDE","SINGLE_QUOTE","OPEN_SQUARE_BRACKET","BACKSLASH","CLOSE_SQUARE_BRACKET","WIN_KEY","MAC_FF_META","MAC_WK_CMD_LEFT","MAC_WK_CMD_RIGHT","WIN_IME","VK_NONAME","PHANTOM","aria","arrayUtils","browserEvents","deprecation","extensions","idGenerator","math","parsing","stringUtils","svgMath","svgPaths","userAgent","TextBubble","paragraph","stringToSvg","createParagraph","spans","createSpans","rightAlignSpans","tspan","maxWidth","TextInputBubble","DEFAULT_SIZE","inputRoot","createEditor","resizeGroup","bindTextAreaEvents","onStartEdit","widthMinusBorder","heightMinusBorder","DEFAULT_BUBBLE_WIDTH","DEFAULT_BUBBLE_HEIGHT","textBubble","textInputBubble","bubbleSize","bubbleVisiblity","anchorLocation","showEditableBubble","showNonEditableBubble","hideBubble","WarningIcon","textMap","addMessage","DuplicateIconType","exceptions","TypesContainer","NONE","HAT","SPACER","BETWEEN_ROW_SPACER","IN_ROW_SPACER","EXTERNAL_VALUE_INPUT","INLINE_INPUT","STATEMENT_INPUT","CONNECTION","PREVIOUS_CONNECTION","NEXT_CONNECTION","OUTPUT_CONNECTION","CORNER","LEFT_SQUARE_CORNER","LEFT_ROUND_CORNER","RIGHT_SQUARE_CORNER","RIGHT_ROUND_CORNER","JAGGED_EDGE","TOP_ROW","BOTTOM_ROW","INPUT_ROW","LEFT_CORNER","RIGHT_CORNER","nextTypeValue_","hasOwnProperty","isField","isHat","isSpacer","isInRowSpacer","isInput","isExternalInput","isInlineInput","isStatementInput","isPreviousConnection","isNextConnection","isPreviousOrNextConnection","isLeftRoundedCorner","isRightRoundedCorner","isLeftSquareCorner","isRightSquareCorner","isCorner","isJaggedEdge","isRow","row","isBetweenRowSpacer","isTopRow","isBottomRow","isTopOrBottomRow","isInputRow","Types","Measurable","centerline","xPos","notchOffset","NOTCH_OFFSET_LEFT","Row","elements","widthWithConnectedBlocks","minWidth","minHeight","hasStatement","hasExternalInput","statementEdge","hasJaggedEdge","hasDummyInput","hasInlineInput","align","getLastInput","measure","startsWithElemSpacer","endsWithElemSpacer","getFirstSpacer","getLastSpacer","BottomRow","hasNextConnection","descenderHeight","hasLeftSquareCorner","hasRightSquareCorner","_block","Connection","connectionModel","shapeFor","isHighlighted","InputConnection","connectionOffsetY","connectionOffsetX","connectedBlock","connectedBlockWidth","connectedBlockHeight","ExternalValueInput","TAB_OFFSET_FROM_TOP","MEDIUM_PADDING","EXTERNAL_VALUE_INPUT_PADDING","connectionHeight","connectionWidth","flipRtl","Hat","START_HAT","ascenderHeight","InRowSpacer","SPACER_DEFAULT_HEIGHT","InlineInput","EMPTY_INLINE_INPUT_HEIGHT","EMPTY_INLINE_INPUT_PADDING","STATEMENT_BOTTOM_SPACER","EMPTY_STATEMENT_INPUT_HEIGHT","STATEMENT_INPUT_NOTCH_OFFSET","InputRow","connectedBlockWidths","JaggedEdge","JAGGED_TEETH","NextConnection","OutputConnection","startX","PreviousConnection","RoundCorner","opt_position","CORNER_RADIUS","SpacerRow","precedesStatement","followsStatement","SquareCorner","NO_PADDING","TopRow","capline","hasPreviousConnection","hasHat","hat","ADD_START_HATS","prevBlock","getPreviousBlock","ConstantProvider","SMALL_PADDING","MEDIUM_LARGE_PADDING","LARGE_PADDING","TAB_HEIGHT","TAB_VERTICAL_OVERLAP","TAB_WIDTH","NOTCH_WIDTH","NOTCH_HEIGHT","MIN_BLOCK_WIDTH","EMPTY_BLOCK_SPACER_HEIGHT","STATEMENT_INPUT_PADDING_LEFT","BETWEEN_STATEMENT_PADDING_Y","START_HAT_HEIGHT","START_HAT_WIDTH","JAGGED_TEETH_HEIGHT","JAGGED_TEETH_WIDTH","FIELD_BORDER_RECT_Y_PADDING","FIELD_BORDER_RECT_COLOUR","FIELD_COLOUR_FULL_BLOCK","FIELD_TEXTINPUT_BOX_SHADOW","FIELD_COLOUR_DEFAULT_WIDTH","embossFilter","disabledPatternId","disabledPattern","debugFilterId","debugFilter","CURSOR_COLOUR","MARKER_COLOUR","CURSOR_WS_WIDTH","WS_CURSOR_HEIGHT","CURSOR_STACK_PADDING","CURSOR_BLOCK_PADDING","CURSOR_STROKE_WIDTH","FULL_BLOCK_FIELDS","INSERTION_MARKER_COLOUR","INSERTION_MARKER_OPACITY","SHAPES","PUZZLE","NOTCH","TALL_INPUT_FIELD_OFFSET_Y","DUMMY_INPUT_SHADOW_MIN_HEIGHT","DUMMY_INPUT_MIN_HEIGHT","TOP_ROW_MIN_HEIGHT","TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT","BOTTOM_ROW_MIN_HEIGHT","BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT","START_POINT","FIELD_COLOUR_DEFAULT_HEIGHT","FIELD_CHECKBOX_X_OFFSET","randomIdentifier","makeJaggedTeeth","makeNotch","makeStartHat","PUZZLE_TAB","makePuzzleTab","INSIDE_CORNERS","makeInsideCorners","OUTSIDE_CORNERS","makeOutsideCorners","setTheme","validatedBlockStyle_","setDynamicProperties_","setFontConstants_","setComponentConstants_","fontMetrics","getBlockStyleForColour","createBlockStyle_","getBlockStyle","valid","assign","parsedColour","generateSecondaryColour_","generateTertiaryColour_","inputColour","mainPath","path","makeMainPath","up","back","control1Y","overlap","control2Y","endPoint1","endPoint2","dir","outerWidth","innerWidth","innerTopLeftCorner","innerBottomLeftCorner","pathTop","pathBottom","topLeft","topRight","bottomLeft","bottomRight","rightHeight","selector","injectCSS_","feSpecularLighting","createDebugFilter","debugComponentTransfer","cssArray","getCSS_","cssNodeId","Drawer","info","inlinePath_","outlinePath_","block_","info_","topLeft_","drawOutline_","drawInternals_","updateConnectionHighlights","pathObject","setPath","flipRTL","recordSizeOnBlock_","widthWithChildren","drawTop_","rows","drawJaggedEdge_","drawStatementInput_","drawValueInput_","drawRightSideRow_","drawBottom_","drawLeft_","topRow","positionPreviousConnection_","startY","positionExternalValueConnection_","innerHeight","positionStatementInputConnection_","bottomRow","elems","positionNextConnection_","rightCornerYOffset","outlinePath","positionOutputConnection_","tabBottom","drawInlineInput_","layoutField_","fieldInfo","connectionTop","connectionBottom","positionInlineInputConnection_","connX","connInfo","drawConnectionHighlightPath","removeConnectionHighlight","measurable","getExpressionConnectionHighlightPath","getStatementConnectionHighlightPath","addConnectionHighlight","getOffsetInBlock","connPath","yLen","xLen","Align","CENTRE","FieldLabel","textClass","class","setClass","cssClass","Input","appendField","insertFieldAt","initField","removeField","opt_quiet","renderList","renderedConnection","startTrackingAll","stopTrackingAll","setCheck","check","setAlign","makeConnection","makeConnection_","DummyInput","EndRowInput","ValueInput","RenderInfo","inputRows","renderer_","isInline","createRows_","addElemSpacing_","addRowSpacing_","computeBounds_","alignRowElements_","finalize_","populateTopRow_","activeRow","iconInfo","lastInput","shouldStartNewRow_","addInput_","populateBottomRow_","hasPrevious","cornerClass","leftSquareCorner","rightSquareCorner","StatementInputMeasurable","currInput","prevInput","oldElems","getInRowSpacing_","prev","widestStatementRowFields","blockWidth","widestRowWithConnectedBlocks","statementInput","alignStatementRow_","currentWidth","missingSpace","getDesiredRowWidth_","desiredWidth","addAlignmentPadding_","_row","firstSpacer","lastSpacer","oldRows","makeSpacerRow_","getSpacerRowHeight_","getSpacerRowWidth_","spacer","_prev","_next","getElemCenterline_","recordElemPositions_","xCursor","yCursor","getMeasureableForConnection","BlockDelete","oldXml","wasShadow","oldJson","shadowDom","shadowState","connect_","parentBlock","disconnectInternal","orphan","stashShadowState","applyShadowState","setParent","orphanConnection","getConnectionForOrphanedConnection","onFailedConnect","isSuperior","setShadowStateInternal","unplug","_otherConnection","otherConnection","disconnect","getParentAndChildConnections","respawnShadow_","createShadowBlock","reconnect","connectionParent","currentParent","onCheckChanged_","getCheck","returnCurrent","_maxLimit","serializeShadow","attemptToConnect","blockShadow","lastConnectionInStack","CAN_CONNECT","REASON_SELF_CONNECTION","REASON_WRONG_TYPE","REASON_TARGET_NULL","REASON_CHECKS_FAILED","REASON_DIFFERENT_WORKSPACES","REASON_SHADOW_PARENT","REASON_DRAG_CHECKS_FAILED","REASON_PREVIOUS_AND_OUTPUT","Block","hue_","colour_","styleName_","suppressPrefixSuffix","contextMenu","parentBlock_","childBlocks_","editable_","movable_","deletable_","collapsed_","isShadow_","outputShape_","isInsertionMarker_","onchangeWrapper_","statementInputCount","setBlockById","xy_","isInMutator","addTopBlock","addTypedBlock","doInit_","onchange","setOnChange","healStack","removeTopBlock","disposeInternal","removeTypedBlock","removeBlockById","destroy","opt_healStack","unplugFromRow_","unplugFromStack_","thisConnection","getOnlyValueConnection_","previousTarget","nextTarget","_all","myConnections","ignoreShadows","getInputWithBlock","getSurroundParent","getTopStackBlock","previous","ordered","childBlocks","hasBlockLimits","isCapacityAvailable","setInsertionMarker","insertionMarker","isSimpleReporter","getMatchingConnection","otherConnections","setHelpUrl","getHue","parsed","onchangeFn","getVars","vars","updateVarName","renameVarById","oldId","newId","setFieldValue","setPreviousStatement","newBoolean","opt_check","setNextStatement","setOutput","setOutputShape","outputShape","getOutputShape","blockChangeEvent","ancestor","opt_maxLength","opt_emptyToken","toTokens","acc","curr","emptyToken","checks","shouldAddParens","appendValueInput","appendInput","appendStatementInput","appendDummyInput","appendEndRowInput","appendInputFromRegistry","inputConstructor","warningPrefix","n","jsonInitStyle_","jsonInitColour_","interpolate_","localizedText","localizedValue","extensionNames","styleError","opt_disableCheck","overwrites","implicitAlign","validateTokens_","interpolateArguments_","fieldStack","isInputKeyword_","inputFromJson_","fieldFromJson_","argsCount","visitedArgsHash","visitedArgsCount","token","newlineInput","stringToFieldJson_","dummyInput","alignmentLookup","alignment","moveInputBefore","refName","inputIndex","refIndex","moveNumberedInputBefore","RangeError","removeInput","getInputTargetBlock","commentConstructor","removeIcon","setWarningText","_text","_opt_id","_mutator","find","allInputsFilled","opt_shadowBlocksAreFilled","FlyoutButton","isFlyoutLabel","onMouseUpWrapper","svgText","callbackKey","BORDER_RADIUS","TEXT_MARGIN_X","TEXT_MARGIN_Y","updateTransform","onMouseUp","isLabel","getButtonText","getButtonCallback","ASTNode","opt_params","wsCoordinate","isConnectionLocation","isConnectionType","processParams","getLocation","getWsCoordinate","isConnection","findNextForInput","curIdx","NAVIGATE_ALL_FIELDS","createFieldNode","createInputNode","findNextForField","fieldIdx","newInput","findPrevForInput","findPrevForField","navigateBetweenStacks","curLocation","curLocationAsBlock","navigateFlyoutContents","curRoot","resultIndex","createStackNode","types","STACK","BUTTON","nextItem","findNextLocationInFlyout","getContents","createButtonNode","flyoutContents","currentLocation","currentIndex","findIndex","findTopASTNodeForBlock","createConnectionNode","createBlockNode","getOutAstNodeForBlock","findFirstFieldOrInput","OUTPUT","PREVIOUS","NEXT","in","out","blockPos","DEFAULT_OFFSET_Y","createWorkspaceNode","createTopNode","astNode","MarkerMove","isCursor","opt_oldNode","opt_newNode","oldNode","CURSOR_CLASS","MARKER_CLASS","HEIGHT_MULTIPLIER","MarkerSvg","markerSvgRect_","markerSvgLine_","markerInput_","markerBlock_","svgGroup_","currentMarkerSvg","defaultColour","createDomInternal_","setParent_","curNode","applyColour_","showAtLocation_","fireMarkerEvent","animate","connectionType","curNodeAsConnection","showWithBlock_","showWithOutput_","showWithInput_","showWithNext_","showWithPrevious_","showWithField_","showWithCoordinates_","showWithStack_","showWithButton_","showWithBlockPrevOutput","markerHeight","markerOffset","connectionShape","positionPrevious_","positionOutput_","positionBlock_","showCurrent_","positionLine_","positionRect_","positionInput_","heightWidth","yPadding","markerPath","curBlock","getBlinkProperties_","blinkProperties","attributeName","_curNode","firstElementChild","PathObject","connectionHighlights","highlightOffsets","svgPath","pathString","updateShadow_","updateDisabled_","setClass_","updateHighlighted","updateSelected","updateDraggingDelete","updateInsertionMarker","updateMovable","updateReplacementFade","updateShapeForInputHighlight","_conn","connectionPath","currentHighlightMatchesNew","newPath","newOffset","currPath","currOffset","InsertionMarkerManager","activeCandidate","lastMarker","lastOnStack","wouldDeleteBlock","fadedBlock","highlightedBlock","markerConnection","firstMarker","createMarkerBlock","availableConnections","initAvailableConnections","disposeInsertionMarker","updateAvailableConnections","wouldConnectBlock","applyConnections","hidePreview","local","inferiorConnection","then","dragTarget","newCandidate","getCandidate","shouldDelete","shouldUpdatePreviews","maybeHidePreview","maybeShowPreview","blockJson","available","activeLocal","activeClosest","xDiff","yDiff","curDistance","getStartRadius","candidate","myConnection","neighbour","componentManager","isDeleteArea","showPreview","getConnectionPreviewMethod","method","PREVIEW_TYPE","INPUT_OUTLINE","showInsertionInputOutline","INSERTION_MARKER","showInsertionMarker","REPLACEMENT_FADE","showReplacementFade","shouldHighlightConnection","localChanged","unhighlight","hideReplacementFade","hideInsertionInputOutline","hideInsertionMarker","isLastInStack","imConn","originalOffsetToTarget","originalOffsetInBlock","imConnConst","positionNearConnection","markerConn","imBlock","markerOutput","markerPrev","highlightShapeForInput","fadeForReplacement","getInsertionMarkers","PreviewType","Renderer","overrides","makeConstants_","refreshDom","previousConstants","makeRenderInfo_","makeDrawer_","makePathObject","orphanCanConnectAtEnd","localType","ThemeManager","subscribedWorkspaces_","componentDB","prevTheme","oldClassName","newClassName","refreshTheme","componentList","propertyName","setProperty","subscribeWorkspace","unsubscribeWorkspace","onCreateVariableButtonClick_String","onCreateVariableButtonClick_Number","onCreateVariableButtonClick_Colour","COLLAPSE_CHARS","OPPOSITE_TYPE","RENAME_VARIABLE_ID","DELETE_VARIABLE_ID","ConnectionChecker","opt_distance","safety","doSafetyChecks","doTypeChecks","doDragChecks","errorCode","superiorBlock","inferiorBlock","superiorConnection","checkArrayOne","checkArrayTwo","canConnectToPrevious_","VarDelete","VarRename","VariableMap","deleteVariable","conflictVar","renameVariableWithConflict_","renameVariableAndUses_","variableId","tempVar","variableName","uses","getVariableUsesById","procedureName","deleteText","confirmText","deleteVariableInternal","list","getVariableTypes","variableTypes","flat","Workspace","internalIsFlyout","isClearing","MAX_UNDO","connectionDBList","topComments","commentDB","listeners","undoStack_","redoStack_","blockDB","typedBlocksDB","procedureMap","connectionCheckerClass","sortObjects_","SCAN_ANGLE","aXY","bXY","filtered","remainingCapacity","remainingCapacityOfType","maxInstanceOfType","copyableBlocksCount","redo","inputStack","outputStack","inputEvent","clearUndo","createPotentialVariableMap","outerWs","getById","getAll","SOUND_LIMIT","WorkspaceAudio","sounds","lastSound_","muted","filenames","audioTest","filename","ext","canPlayType","sound","volume","playPromise","pause","catch","opt_volume","now","mySound","setMuted","getMuted","LayerManager","layers","dragLayer","createDragLayer","animationLayer","createAnimationLayer","blockLayer","createLayer","bubbleLayer","currentTransform","translateLayers","newCoord","newScale","translation","layer","layerNum","getSvgGroup","inserted","sortedLayers","num","sib","hasLayer","getBlockLayer","getBubbleLayer","ZOOM_TO_FIT_MARGIN","resizeHandlerWrapper","resizesEnabled","isVisible_","startScrollY","startScrollX","dragDeltaXY","oldLeft","oldTop","inverseScreenCTM","dummyWheelListener","configureContextMenu","lastRecordedPageScroll","toolbox_","inverseScreenCTMDirty","highlightedBlocks","toolboxCategoryCallbacks","flyoutButtonCallbacks","cachedParentSvg","topBoundedElements","dragTargetAreas","layerManager","MetricsManagerClass","setTopLevelWorkspaceMetrics_","audioManager","markerManager","Variables","registerToolboxCategoryCallback","VariablesDynamic","Procedures","themeManager_","cachedParentSvgSize","getMarkerManager","setMetricsManager","updateBlockStyles_","refreshToolboxSelection","ctm","opt_backgroundClass","svgBackground_","svgBlockCanvas_","svgBubbleCanvas_","this.dummyWheelListener","onMouseWheel_","ToolboxClass","CursorClass","parentSvg","newTrashcan","svgTrashcan","_workspace","svgZoomControls","HorizontalFlyout","VerticalFlyout","opt_own","updateScreenCalculations_","positionables","getUiMetrics","positionable","currScroll","maybeFireViewportChangeEvent","flatMap","highlightBlock","opt_state","refreshSelection","dragTargets","targetArea","getClientRect","clientRect","getDragTarget","canWheelZoom","canWheelMove","scrollDelta","commandKey","PIXELS_PER_ZOOM_STEP","topElements","boundary","topElement","blockBoundary","cursorY","scaleChange","getCTM","center","f","setScale","svgWidth","svgHeight","zoomToFit","workspaceWidth","workspaceHeight","blocksBox","doubleMargin","blocksWidth","blocksHeight","ratioX","ratioY","centerOnBlock","blockOnly","pixelX","multiplier","pixelY","reflow","resizeView","resizeContent","getScale","maxYScroll","maxYDisplacement","maxXDisplacement","addTopBoundedElement","removeTopBoundedElement","reenabled","removeButtonCallback","getToolboxCategoryCallback","removeToolboxCategoryCallback","isStart","onlyClosePopups","autoHideables","autoHideable","autoHide","xyRatio","TrashcanOpen","opt_isOpen","Selected","opt_oldElementId","opt_newElementId","oldElementId","newElementId","Marker","getCurNode","setCurNode","Cursor","BasicCursor","getNextNode_","validNode_","getPreviousNode_","isValid","siblingOrParent","findSiblingOrParent","getRightMostChild","nextNode","registrationName","TabNavigateCursor","BUMP_RANDOMNESS","RenderedConnection","dbOpposite","trackedState","TrackedState","WILL_TRACK","TRACKED","bumpAwayFrom","staticConnection","addSelect","removeSelect","updated","moveToOffset","blockTL","tightenEfficiently","maxLimit","setTracking","doTracking","UNTRACKED","updateDisabled","BlockPaster","typeCounts","blockState","initialCoordinates","bumpIntoBounds","BlockDragStrategy","connectionPreviewer","connectionCandidate","startChildConn","startParentConn","dragOffset","startDraggingShadow","fireDragStartEvent","previewerConstructor","shouldDisconnect","disconnectBlock","fireDragEndEvent","oldCoordinate","updateConnectionPreview","draggingBlock","currCandidate","getConnectionCandidate","currCandidateIsBetter","localIsOutputOrPrevious","neighbourIsConnectedToRealBlock","previewReplacement","previewConnection","currCandiate","currLocal","currNeighbour","localPos","neighbourPos","currDistance","localConns","getLocalConnections","rad","warningTextDb","mutator","eventsInit_","renderIsInProgress_","visuallyDisabled","relativeCoords","createIconPointerDownListener","getColourSecondary","getColourTertiary","oldParent","oldXY","layerManger","eventsEnabled","currLoc","curXY","blockBounds","updateCollapsed_","collapsedInputName","collapsedFieldName","tab","tabCursor","currentNode","nextField","open","generateContextMenu","customContextMenu","updateConnectionLocations","updateIconLocations","updateFieldLocations","adding","timeout","collapsedParent","COLLAPSED_WARNING_ID","removed","wasEnabled","styleObj","track","all","scheduleSnapAndBump","sourceConnection","tightenChildrenEfficiently","nextHeightWidth","tabHeight","setDragStrategy","toFlyoutInfo","kind","toRemove","traverseJson","INLINE","DragTarget","onDragEnter","_dragElement","onDragOver","onDragExit","onDrop","shouldPreventMove","DeleteArea","wouldDelete_","couldDeleteBlock","updateWouldDelete_","Trashcan","isLidOpen","minOpenness","lidTask","svgLid","lidOpen","flyoutWorkspaceOptions","onDelete","BODY_HEIGHT","LID_HEIGHT","SPRITE_LEFT","SPRITE_TOP","blockMouseDownWhenOpenable","click","mouseOver","mouseOut","animateLid","setLidOpen","hasContents","contentsIsOpen","openFlyout","string","blocklyStyle","fireUiEvent","closeFlyout","emptyContents","setMinOpenness","trashRect","MARGIN_HOTSPOT","frames","ANIMATION_FRAMES","setLidAngle","MAX_LID_ANGLE","OPACITY_MIN","OPACITY_MAX","ANIMATION_LENGTH","lidAngle","openAtRight","newMin","closeLid","trashcanOpen","cleanedJson","cleanBlockJson","HAS_BLOCKS_LID_ANGLE","cleanRec","blockInfo","shortcuts","keyMap","shortcut","registeredShortcut","addKeyMapping","allowCollision","shortcutName","removeAllKeyMappings","keyCode","opt_allowCollision","shortcutNames","removeKeyMapping","shortcutIdx","setKeyMap","newKeyMap","getKeyMap","legacyKeyMap","getRegistry","legacyRegistry","serializeKeyEvent_","getShortcutNamesByKeyCode","getKeyCodesByShortcutName","serializedKey","modifier","modifierKeys","getModifierState","checkModifiers_","modifiers","modifierKeyCode","Shift","Control","Alt","Meta","ProcedureSerializer","procState","VariableSerializer","variableStates","varState","priorities","workspaceComments","addHorizontal","addVertical","oldHostMetrics_","corner_","vScroll","hScroll","isPair","resizeH","resizeV","setX","setY","MetricsManager","workspace_","getDimensionsPx_","getFlyoutMetrics","flyoutDimensions","getToolboxMetrics","toolboxDimensions","getSvgMetrics","getAbsoluteMetrics","flyoutMetrics","respectToolbox","respectFlyout","atTop","opt_getWorkspaceCoordinates","svgMetrics","vertToolbox","getContentMetrics","blockBox","getComputedFixedEdges_","opt_viewMetrics","hScrollEnabled","vScrollEnabled","edges","getPaddedContent_","contentMetrics","contentBottom","contentRight","halfWidth","opt_contentMetrics","fixedEdges","paddedContent","scrollMetrics","contentHeight","contentTop","contentLeft","toolboxWidth","toolboxHeight","flyoutHeight","BaseConstantProvider","GRID_UNIT","CURSOR_RADIUS","HEXAGONAL","ROUND","SQUARE","SHAPE_IN_SHAPE_PADDING","SELECTED_GLOW_COLOUR","SELECTED_GLOW_SIZE","REPLACEMENT_GLOW_COLOUR","REPLACEMENT_GLOW_SIZE","selectedGlowFilterId","selectedGlowFilter","replacementGlowFilterId","SQUARED","ROUNDED","replacementGlowFilter","STATEMENT_INPUT_SPACER_MIN_WIDTH","MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH","makeHexagonal","makeRounded","makeSquared","rightWidth","selectedGlowSize","replacementGlowSize","pathRightDown","pathRightUp","blockHeight","remainingHeight","maxHeight","sweep","_height","curveWidth","quarterHeight","innerTopRightCorner","innerBottomRightCorner","pathTopRight","pathBottomRight","selectedComponentTransfer","replacementComponentTransfer","BaseDrawer","beginDrawing","outputShapeType","endDrawing","hasStatementInput","drawFlatTop_","drawRightDynamicConnection_","drawFlatBottom_","drawLeftDynamicConnection_","insideCorners","cornerHeight","bottomRightPath","verticalPath","topRightPath","getInlineInputPath","setOutlinePath","connectedBottomNextConnection","FieldImage","altText","Y_PADDING","setAlt","setOnClickHandler","FieldInput","spellcheck_","htmlInput_","isTextValid_","isBeingEdited_","onKeyInputWrapper_","onKeyDownWrapper_","valueWhenEditorWasOpened_","fullBlockClickTarget_","spellcheck","resizeEditor_","htmlInput","INVALID","setSpellcheck","quietInput","showPromptEditor_","showInlineEditor_","getValueFromEditorText_","onFinishEditing_","widgetDispose_","widgetCreate_","borderRadius","BORDERRADIUS","strokeColour","border","boxShadow","getEditorText_","bindInputEvents_","unbindInputEvents_","_value","onHtmlInputKeyDown_","onHtmlInputChange_","setEditorValue_","bumped","FieldTextInput","BaseBottomRow","BaseStatementInput","RightConnectionShape","BaseTopRow","BaseRenderInfo","isMultiRow","rightSide","rightAlignedDummyInputs","adjustXPosition_","alignmentDivider","notchTotalWidth","minXPos","prevSpacer","nextSpacer","hasPrevNotch","hasNextNotch","prevInRowSpacer","finalizeOutputConnection_","outputConnectionShape","rightConnectionWidth","finalizeHorizontalAlignment_","totalNegativeSpacing","lastElem","leftNegPadding","getNegativeSpacing_","firstElem","rightNegPadding","minBlockWidth","outerShape","innerShape","finalizeVerticalAlignment_","firstRow","hasSingleTextOrImageField","hasNonShadowConnectedBlocks","minVerticalTightNestingHeight","BaseMarkerSvg","markerCircle","showWithInputOutput","positionCircle","BasePathObject","svgPathSelected","outlines","remainingOutlines","outline","getOutlinePath","removeOutlinePath","BaseRenderer","InsertionMarkerPreviewer","draggedBlock","staticConn","draggedConn","replacedBlock","shouldUseMarkerPreview","previewMarker","_draggedConn","ZelosRenderer","dragged","createInsertionMarker","origBlock","orig","origConn","origConns","markerConns","CodeGenerator","forBlock","FUNCTION_NAME_PLACEHOLDER_","STATEMENT_SUFFIX","STATEMENT_PREFIX","INFINITE_LOOP_TRAP","INDENT","COMMENT_WRAP","ORDER_OVERRIDES","isInitialized","RESERVED_WORDS_","definitions_","functionNames_","nameDB_","FUNCTION_NAME_PLACEHOLDER_REGEXP_","RegExp","workspaceToCode","code","blockToCode","scrubNakedValue","injectId","codeString","finish","prefixLines","allNestedComments","opt_thisOnly","scrub_","SyntaxError","valueToCode","outerOrder","ReferenceError","innerOrder","parensNeeded","outerOrderClass","innerOrderClass","statementToCode","addLoopTrap","branch","addReservedWords","provideFunction_","desiredName","functionName","codeText","oldCodeText","getVariableName","getProcedureName","_opt_thisOnly","FlyoutMetricsManager","flyout_","getBoundingBox_","blockBoundingBox","FlyoutItemType","WORKSPACE_AT_BLOCK_CAPACITY_DISABLED_REASON","Flyout","filterWrapper","reflowWrapper","mats","buttons_","permanentlyDisabled","recycledBlocks","SCROLLBAR_MARGIN","height_","width_","dragAngleRange_","setMetrics_","toolboxPosition_","tabWidth_","rectMap_","GAP_X","GAP_Y","wheel_","filterForCapacity","getFlyoutScale","setAutoClose","updateDisplay","setContents","positionAt_","listen","clearOldBlocks","getDynamicCategoryContents","parsedContent","flyoutInfo","createFlyoutInfo","layout_","gaps","emptyRecycledBlocks","defaultGap","categoryName","parsedDynamicContent","dynamicContents","dynamicGaps","createFlyoutBlock","addBlockGap","addSeparatorGap","createButton","fnToApply","btnInfo","curButton","getRecycledBlock","blockType","gap","sepInfo","newGap","oldBlocks","blockIsRecyclable_","recycleBlock","addBlockListeners_","blockMouseDown","originalBlock","placeNewBlock","initFlyoutButton_","buttonSvg","createRect_","blockHW","moveRectToBlock_","reflowInternal_","oldBlock","svgRootOld","serializeBlock","positionNewBlock","flyoutOffsetPixels","oldBlockPos","oldBlockOffsetPixels","getX","getY","targetWorkspaceViewMetrics","setBackgroundPath","atRight","cursorX","allBlocks","moveX","dragDirection","atan2","range","flyoutRect","BIG_NUM","oldX","newX","registryName","buttons","FieldVariable","defaultType","defaultVariableName","setTypes","variableType","typeIsAllowed","typeList","isInArray","FieldNumber","precision","min_","max_","precision_","decimalPlaces","setConstraints","setMinInternal","setMaxInternal","setPrecisionInternal","setMin","getMin","setMax","getMax","setPrecision","precisionString","toLocaleString","maximumFractionDigits","decimalIndex","getPrecision","isFinite","toFixed","VALUEMIN","VALUEMAX","FieldLabelSerializable","FieldCheckbox","checkChar","CHECK_CHAR","checkCharacter","getValueBoolean","setCheckCharacter","character","convertValueToBool_","Dragger","totalDelta","moveDraggable","getRoot","wouldDeleteDraggable","updateDragTarget","newDragTarget","pixelsToWorkspaceUnits","rootDraggable","origGroup","shouldReturnToStart","BlockDrag","opt_isStart","opt_blocks","BlockFieldIntermediateChange","BlockMove","currentLocation_","oldParentId","parentId","oldInputName","blockConnection","BubbleOpen","opt_bubbleType","BubbleType","CommentBase","opt_comment","CommentCreateDeleteHelper","CommentChange","opt_oldContents","opt_newContents","oldContents_","newContents_","CommentCreate","CommentDelete","CommentMove","comment_","newCoordinate_","setOldCoordinate","CommentCollapse","ToolboxItemSelect","opt_oldItem","opt_newItem","oldItem","newItem","FinishedLoading","opt_workspace","DARK_PATH_OFFSET","MAX_BOTTOM_WIDTH","Highlighter","inlineSteps_","steps_","RTL_","highlightConstants_","getHighlightConstants","highlightOffset","OFFSET","outsideCornerPaths_","OUTSIDE_CORNER","insideCornerPaths_","INSIDE_CORNER","puzzleTabPaths_","notchPaths_","startPaths_","jaggedTeethPaths_","getPath","drawTopCorner","drawValueInput","belowTabHeight","drawStatementInput","drawRightSideRow","rightEdge","drawBottomRow","cornerElem","drawLeft","drawInlineInput","connectionRight","bottomHighlightWidth","aboveTabHeight","highlighter_","setHighlightPath","HighlightConstantProvider","constantProvider","makeInsideCorner","makeOutsideCorner","distance45outside","SQRT1_2","pathTopRtl","pathBottomRtl","pathBottomLtr","distance45inside","topLeftCornerHighlightRtl","topLeftCornerHighlightLtr","bottomLeftStartY","bottomLeftPath","highlightRtlUp","highlightRtlDown","verticalOverlap","highlightLtrUp","highlightLtrDown","hatHeight","pathRtl","pathLtr","BaseInlineInput","hasExternalInputs","nextRightEdge","rowNextRightEdges","prevRightEdge","heightWithoutHat","diff","colourDark","svgPathDark","svgPathLight","highlightPath","highlightConstants","makeHighlightConstants_","Zelos","ToolboxItem","toolboxItemDef","parentToolbox","level_","parent_","getLevel","toolboxItemDef_","parentToolbox_","getClickTarget","isCollapsible","setVisible_","_isVisible","ToolboxCategory","categoryDef","labelDom_","iconDom_","rowContents_","rowDiv_","htmlDiv_","isDisabled_","isHidden_","flyoutItems_","cssConfig_","makeDefaultCssConfig_","parseCategoryDef_","parseContents_","createDom_","flyoutItem","itemDef","getColour_","createContainer_","LEVEL","createRowContainer_","pointerEvents","createRowContentsContainer_","createIconDom_","createLabelDom_","LABELLEDBY","addColourBorder_","rowDiv","nestedPadding","paddingRight","paddingLeft","contentsContainer","toolboxIcon","isHorizontal","toolboxLabel","borderWidth","borderRight","borderLeft","styleName","getColourfromStyle_","parseColour_","colourValue","openIcon_","iconDiv","closedIconClass","closeIcon_","openIconClass","getSelectedItem","clearSelection","allAncestorsExpanded_","category","isExpanded","isSelected","defaultBackgroundColour","setDisabled","isDisabled","updateFlyoutContents","newDefinition","custom","categorystyle","cssconfig","hidden","ToolboxSeparator","separatorDef","CollapsibleToolboxCategory","subcategoriesDiv_","expanded_","toolboxItems_","cssConfig","prevIsFlyoutItem","createToolboxItem_","ToolboxItemClass","setExpanded","subCategories","getChildToolboxItems","createSubCategoriesDom_","EXPANDED","subcategories","newCategory","newCategoryDiv","handleToolboxItemResize","childToolboxItems","toggleExpanded","Toolbox","contentsDiv_","HtmlDiv","contents_","previouslySelectedItem_","selectedItem_","boundEvents_","toolboxDef_","horizontalLayout_","contentMap_","createFlyout_","themeManager","createContentsContainer_","attachEvents_","toolboxContainer","flexDirection","clickEvent","onClick_","keyDownEvent","onKeyDown_","itemId","getToolboxItemById","setSelectedItem","handled","selectNext_","selectPrevious_","selectParent_","selectChild_","FlyoutClass","renderContents_","fragment","createDocumentFragment","addToolboxItem_","toolboxItemDom","getToolboxItems","addStyle","removeStyle","toolboxRect","updateCursorDeleteStyle_","getPreviouslySelectedItem","workspaceMetrics","toolboxDiv","childAsCategory","shouldDeselectItem_","deselectItem_","shouldSelectItem_","selectItem_","updateFlyout_","fireSelectEvent_","selectItemByPosition","oldElement","collapsibleItem","nextItemIdx","prevItemIdx","prevItem","VERSION","TOOLBOX_AT_TOP","TOOLBOX_AT_BOTTOM","TOOLBOX_AT_LEFT","TOOLBOX_AT_RIGHT","VARIABLE_CATEGORY_NAME","VARIABLE_DYNAMIC_CATEGORY_NAME","PROCEDURE_CATEGORY_NAME","Workspace.prototype.newBlock","WorkspaceSvg.prototype.newBlock","Workspace.prototype.newComment","WorkspaceSvg.prototype.newComment","WorkspaceSvg.newTrashcan","MiniWorkspaceBubble.prototype.newWorkspaceSvg","Names.prototype.populateProcedures","flattenedProcedures","DropDownDiv","dropDownDiv","ContextMenu","ContextMenuItems","Css","Events","Extensions","ShortcutItems","Themes","Tooltip","Touch","WidgetDiv","Xml","blockAnimations","blockRendering","bubbles","bumpObjects","clipboard","common","dialog","fieldRegistry","geras","renderManagement","serialization","thrasos","uiPosition","utils","zelos"],"mappings":"A;;;;;;;;;;;;;AA8HMA,IAAAA,wCAAAA,CAqENC,wCArEMD,CAsFAE,0CAtFAF,CAqHNG,uCArHMH,CAqJAI,uCArJAJ,CAyKAK,wCAzKAL,CA6LAM,yCA7LAN,CA+MAO,2CA/MAP,CAoPAQ,mDApPAR,CCrEAS,wDDqEAT,CC3DAU,+CD2DAV,CEnFAW,iDFmFAX;AEqGAY,wCFrGAZ,CE4GNa,gDF5GMb,CEkINc,2CFlIMd,CE+LAe,0CF/LAf,CE+RAgB,oDF/RAhB,CEyTAiB,6CFzTAjB,CEmVNkB,oDFnVMlB,CEkWAmB,oDFlWAnB,CEmXAoB,4CFnXApB,CEmYAqB,uCFnYArB,CEmZAsB,kDFnZAtB;AGpGAuB,8CHoGAvB,CG3FAwB,8CH2FAxB,CG9EAyB,+CH8EAzB,CGrEA0B,gDHqEA1B,CGpDA2B,8CHoDA3B,CG3CA4B,8CH2CA5B,CG/BA6B,yCH+BA7B,CGOA8B,gDHPA9B,CGmBA+B,gDHnBA/B,CGgCAgC,uCHhCAhC,CGyEAiC,gDHzEAjC;AGwGNkC,6CHxGMlC,CGoHAmC,uDHpHAnC,CG2HNoC,+DH3HMpC,CI9DAqC,sCJ8DArC,CI9CAsC,qCJ8CAtC,CIlCAuC,iDJkCAvC,CIrBAwC,8CJqBAxC,CIJAyC,wDJIAzC,CIUA0C,iDJVA1C,CKhFA2C,qDLgFA3C;AK/BA4C,0CL+BA5C,CKQA6C,4CLRA7C,CK0BA8C,mDL1BA9C,CK8DA+C,mDL9DA/C,CKgFAgD,gDLhFAhD,CKqGAiD,0DLrGAjD,CM9GAkD,6CN8GAlD,CO7GAA,mCP6GAA,CO3FAmD,iCP2FAnD,CQ1EAoD,iDR0EApD,CQlDAqD,yCRkDArD;AQnCAsD,8CRmCAtD,CQtBAuD,4CRsBAvD,CQNAwD,yCRMAxD,CQKAyD,2CRLAzD,CQgBA0D,4CRhBA1D,CQqCA2D,gDRrCA3D,CQiDA4D,oDRjDA5D,CQ4DA6D,mDR5DA7D,CQyEA8D,6CRzEA9D,CQiHA+D,iDRjHA/D,CQ4IAgE,+DR5IAhE;AQmMAiE,mDRnMAjE,CS3GAkE,0CT2GAlE,CSpGNmE,kDToGMnE,CSnENoE,qDTmEMpE,CSlDAqE,mDTkDArE,CSjCAsE,gDTiCAtE,CSVAuE,wDTUAvE,CSKAwE,+CTLAxE,CS2BAyE,0DT3BAzE,CSmDA0E,iETnDA1E;AUxFA2E,mDVwFA3E,CU1CA4E,uDV0CA5E,CUlBA6E,qDVkBA7E,CUDA8E,uDVCA9E,CUgBA+E,2DVhBA/E,CU0DAgF,2DV1DAhF,CWrEAiF,mDXqEAjF,CW6BAkF,0CX7BAlF,CWiCNmF,6CXjCMnF,CYoDAoF,4DZpDApF;AY6ENqF,oDZ7EMrF,CY6GAsF,gEZ7GAtF,CYgJAuF,kDZhJAvF,CYuJNwF,0DZvJMxF,CY8KAyF,0DZ9KAzF,CYiMN0F,yDZjMM1F,CYgNN2F,mDZhNM3F,CY2PN4F,kDZ3PM5F,CYiRA6F,qDZjRA7F;AaxDA8F,gEbwDA9F,CaEA+F,oEbFA/F,Ca+BAgG,4Db/BAhG,CctFAiG,mCdsFAjG,Cc5EAkG,sCd4EAlG,CcjEAmG,qCdiEAnG,Cc1DNoG,6Cd0DMpG,CchDAqG,wCdgDArG,CchCAsG,oCdgCAtG,CclBAuG,uCdkBAvG,Ce5GAwG,kGf4GAxG;AgBjGAyG,qFhBiGAzG,CgBpFA0G,sFhBoFA1G,CiBpCA2G,+CjBoCA3G,CiBbA4G,qDjBaA5G,CiB0CA6G,mDjB1CA7G,CiBiDN8G,2DjBjDM9G,CiBiEA+G,8DjBjEA/G,CiBsHAgH,4DjBtHAhH;AiBgOAiH,2CjBhOAjH,CiB4PNkH,sDjB5PMlH,CiBmRAmH,oDjBnRAnH,CiB8SAoH,6DjB9SApH,CiB4TNqH,4EjB5TMrH,CiBsVNsH,6EjBtVMtH,CiBgXAuH,yDjBhXAvH,CiBodNwH,+CjBpdMxH,CiB2fAyH,kDjB3fAzH;AkB/EA0H,oDlB+EA1H,CkBvDA2H,4DlBuDA3H,CkBxCA4H,6DlBwCA5H,CkB7BN6H,gElB6BM7H,CkBnBN8H,mDlBmBM9H,CkBHN+H,kDlBGM/H,CkB+BNgI,qDlB/BMhI,CkBiDNiI,8DlBjDMjI,CkB2DNkI,oDlB3DMlI;AmB5GAA,sDnB4GAA,CmBnGAE,wDnBmGAF,CoBjGAmI,4DpBiGAnI,CoBhEAoI,8DpBgEApI,CqB9GAA,kDrB8GAA,CqBlGAE,oDrBkGAF,CsBvENqI,kFtBuEMrI,CsBhDNsI,qFtBgDMtI;AuBPAuI,yCvBOAvI,CuBOAwI,0CvBPAxI,CwBrGAyI,+DxBqGAzI,CyBzCAmI,gDzByCAnI,CyBiCN0I,0DzBjCM1I,CyBmEN2I,sDzBnEM3I,CyBkFN4I,0DzBlFM5I,CyB+GN6I,qDzB/GM7I,CyBqIN8I,sDzBrIM9I,CyB6JN+I,2DzB7JM/I;AyB8LNgJ,0DzB9LMhJ,CyB0NNiJ,0DzB1NMjJ,CyBuPAoI,kDzBvPApI,CyBkRAkJ,0DzBlRAlJ,CyBsVNmJ,yDzBtVMnJ,CyByXNoJ,6DzBzXMpJ,CyBmZNqJ,sDzBnZMrJ,CyBmaNsJ,0DzBnaMtJ,CyBycNuJ,0DzBzcMvJ;AyB2dNwJ,8DzB3dMxJ,CyBihBNyJ,qDzBjhBMzJ,CyB4iBN0J,sDzB5iBM1J,CyBskBN2J,2DzBtkBM3J,CyB4lBN4J,0DzB5lBM5J,CyB6mBN6J,0DzB7mBM7J,CyBooBN8J,qDzBpoBM9J,C0B/GA+J,wD1B+GA/J,C2B/GAgK,2C3B+GAhK;A2BpGAiK,2C3BoGAjK,C2BxFAkK,uC3BwFAlK,C4BbHmK,4C5BaGnK,C4ByBHoK,mD5BzBGpK,C4BgCHqK,2C5BhCGrK,C4ByCHsK,gD5BzCGtK,C4B8CNuK,+C5B9CMvK,C4ByDHwK,4C5BzDGxK,C4B0EHyK,wD5B1EGzK,C4BmGH0K,wD5BnGG1K,C4BiHN2K,uD5BjHM3K;A4BgIN4K,uD5BhIM5K,C4B2IN6K,uD5B3IM7K,C4B0MH8K,uC5B1MG9K,C4ByTN+K,0D5BzTM/K,C4BiWNgL,0D5BjWMhL,C4B0YNiL,8D5B1YMjL,C4BybHkL,+C5BzbGlL,C4B0dHmL,4C5B1dGnL,C4BseHoL,8C5BteGpL,C4BsfNqL,uC5BtfMrL;A4BsgBNsL,uD5BtgBMtL,C4B2iBNuL,mD5B3iBMvL,C4B+mBHwL,4D5B/mBGxL,C6BhHAyL,wD7BgHAzL,C6B/FA0L,oD7B+FA1L,C6BvDA2L,oD7BuDA3L,C6BDN4L,4C7BCM5L,C6BkDN6L,6C7BlDM7L,C6B2GN8L,8C7B3GM9L,C6B+IN+L,8C7B/IM/L;A8BlFAgM,+C9BkFAhM,C8BzEAiM,+C9ByEAjM,C8B7DAmL,wC9B6DAnL,C8BSAkM,qC9BTAlM,C8BmBAmM,iD9BnBAnM,C8ByCNoM,8C9BzCMpM,C8B2DAmK,wC9B3DAnK,C8B2EAqM,8C9B3EArM,C8BqGAsM,gD9BrGAtM,C8BqHNuM,0C9BrHMvM,C8B2INwM,yC9B3IMxM,C8BmKNyM,0C9BnKMzM;A8B2MA0M,sC9B3MA1M,C8BoNAqL,mC9BpNArL,C8BuOA2M,oC9BvOA3M,C8BkPA4M,sC9BlPA5M,C8BuPN6M,4C9BvPM7M,C8BoQN8M,mD9BpQM9M,C8BuRN+M,0C9BvRM/M,C8B2TN8K,mC9B3TM9K,C+B1GAgN,oD/B0GAhN,C+B/FAiN,oD/B+FAjN,C+B/EAkN,+C/B+EAlN,C+BpEAmN,+C/BoEAnN;A+BpDAoN,yC/BoDApN,C+BdAqN,4C/BcArN,C+BCAsN,4C/BDAtN,C+BuBAuN,4C/BvBAvN,C+BoFAwN,yC/BpFAxN,C+BwIAyN,4C/BxIAzN,CgCtGN0N,kEhCsGM1N,CgCiEA2N,0DhCjEA3N,CgC8EA4N,6DhC9EA5N,CgCoGA6N,2DhCpGA7N;AgCkIA8N,qDhClIA9N,CiCrFAkM,uCjCqFAlM,CiC3EA+N,gDjC2EA/N,CiCjEAmK,0CjCiEAnK,CiC3CA8K,qCjC2CA9K,CiCTAqL,qCjCSArL,CiCsBAmL,0CjCtBAnL,CiCgCAoL,4CjChCApL,CiC4CAgO,yDjC5CAhO,CiC0DNuL,iDjC1DMvL,CiCgFAiO,mDjChFAjO;AiC6GNkO,2CjC7GMlO,CiC+INmO,2CjC/IMnO,CiCqKNoO,iDjCrKMpO,CiC6KAwL,0DjC7KAxL,CkCrFAqO,kDlCqFArO,CkC5EAsO,kDlC4EAtO,CkC3DA8K,uClC2DA9K,CkC5BNuO,4ClC4BMvO,CkCkBNwO,4ClClBMxO,CkCqDNyO,gDlCrDMzO,CkC2EN0O,kDlC3EM1O;AkCoFAqL,uClCpFArL,CkC4FA0M,0ClC5FA1M,CmC1FA2O,yCnC0FA3O,CmCpEA4O,+CnCoEA5O,CmCtCA6O,yCnCsCA7O,CmCfA8O,2CnCeA9O,CmCqBN+O,qCnCrBM/O,CmCqCNgP,yCnCrCMhP,CmC0DAiP,qCnC1DAjP,CmCiMNkP,sCnCjMMlP,CmCmPAkF,oCnCnPAlF,CmCgQAmP,0CnChQAnP,CmCkSAoP,uDnClSApP;AmC0XAqP,+CnC1XArP,CmCgaAsP,+CnChaAtP,CmC6eAuP,6CnC7eAvP,CmC+iBAwP,yCnC/iBAxP,CmC4kBNyP,8CnC5kBMzP,CmCkoBN0P,gDnCloBM1P,CmCwpBN2P,+CnCxpBM3P,CmCkrBN4P,4CnClrBM5P,CmC+rBN6P,6CnC/rBM7P,CmCitBN8P,0CnCjtBM9P,CmC2uBN+P,6CnC3uBM/P;AmCwxBNgQ,4CnCxxBMhQ,CmCm0BNiQ,6CnCn0BMjQ,CmCu7BNkQ,qCnCv7BMlQ,CmCw8BAmQ,qCnCx8BAnQ,CmCk9BNoQ,oCnCl9BMpQ,CoC9FAqQ,uDpC8FArQ,CoC3DNsQ,qDpC2DMtQ,CoC/BAuQ,0DpC+BAvQ,CoCoCAwQ,0DpCpCAxQ,CoC8DNyQ,wDpC9DMzQ,CoCwFA0Q,wDpCxFA1Q;AqChEA2Q,yDrCgEA3Q,CsC/GA4Q,6CtC+GA5Q,CuC5GA6Q,oEvC4GA7Q,CwCzGA8Q,2DxCyGA9Q,CyCjEAA,8CzCiEAA,CyCxDAE,gDzCwDAF,CyChCN+Q,sDzCgCM/Q,C0CkmBNgR,iD1ClmBMhR,C0C+pBNiR,+C1C/pBMjR,C0CgrBNkR,qD1ChrBMlR;A2CpBAE,4C3CoBAF,C2CJAmR,8C3CIAnR,C2CSAoR,uC3CTApR,C2CmDNqR,0D3CnDMrR,C2C2ENsR,+C3C3EMtR,C2CgGNuR,gD3ChGMvR,C2CqHNwR,oD3CrHMxR,C2C4INyR,sD3C5IMzR,C2CkKN0R,2D3ClKM1R,C2C0LN2R,sD3C1LM3R;A2C4NN4R,wD3C5NM5R,C2CmPA6R,kD3CnPA7R,C2C2SN8R,6D3C3SM9R,C2CgWN+R,wD3ChWM/R,C4CxGAgS,6C5CwGAhS,C6C5GAiS,4C7C4GAjS,C6C3FAkS,4C7C2FAlS,C6C7EAmS,6C7C6EAnS,C6C/DAoS,6C7C+DApS,C6CjDAqS,6C7CiDArS;A6CnCAsS,2C7CmCAtS,C6ClBAuS,iD7CkBAvS,C6CDAwS,0C7CCAxS,C8C5GAA,8C9C4GAA,C8ChGAE,gD9CgGAF,C+C/DAyS,+C/C+DAzS,C+ClBN0S,qD/CkBM1S,C+CsBN2S,6C/CtBM3S,C+CuCA4S,4C/CvCA5S,C+C0GA2G,gD/C1GA3G,C+CqMN6S,qD/CrMM7S;A+CqOA8S,qD/CrOA9S,C+CoQN+S,uD/CpQM/S,C+CyRAgT,4C/CzRAhT,C+CuSNiT,wD/CvSMjT,CgD5BAkT,gEhD4BAlT,CgDvBAmT,6DhDuBAnT,CgDfAoT,yDhDeApT,CiD6lBNqT,qDjD7lBMrT,CiD8mBNsT,qDjD9mBMtT;AiD6oBNuT,gEjD7oBMvT,CkD7BAwT,+ClD6BAxT,CmDlGAyT,8DnDkGAzT,CoDwuBN0T,gEpDxuBM1T,CqD/EAA,gErD+EAA,CqDtEAE,kErDsEAF,CqDxDA2T,4DrDwDA3T,CsD/FN4T,iEtD+FM5T,CsDhFN6T,iEtDgFM7T;AsDjEN8T,iEtDiEM9T,CsDhDA2G,uDtDgDA3G,CsDTA4G,6DtDSA5G,CuD0wEA+T,sDvD1wEA/T,CwDtDAgU,oExDsDAhU,CwDhBNiU,uExDgBMjU,CwDANkU,iExDAMlU,CyD9FNmU,wDzD8FMnU;AyDnCAoU,yDzDmCApU,CyDwBNqU,0DzDxBMrU,CyDoDAsU,4DzDpDAtU,C0DnGAuU,yD1DmGAvU,C2DvGNwU,6C3DuGMxU,C2DlEAyU,sC3DkEAzU,C2D9CN0U,8C3D8CM1U,C2DhCN2U,kD3DgCM3U,C4DlGA4U,uD5DkGA5U,C6DxFA6U,oD7DwFA7U;A6DpEA8U,oD7DoEA9U,C6D3BA+U,kD7D2BA/U,C6DqBAgV,iD7DrBAhV,C6DgFAiV,mD7DhFAjV,C6DgIAkV,kD7DhIAlV,C6DgKAmV,kD7DhKAnV,C6DyMAoV,8D7DzMApV,C8DtDAqV,6D9DsDArV,C8D5CAsV,6D9D4CAtV,C+DxGAmI,oD/DwGAnI;A+DlFAuV,oD/DkFAvV,CgE3FAmD,oChE2FAnD,CgErCNmK,uChEqCMnK,CgEiBNwV,iDhEjBMxV,CgE4EN2T,kChE5EM3T,CgEqKNyV,uChErKMzV,CgEuMN0V,gDhEvMM1V,CgE4ON2V,wChE5OM3V,CiEhGAkV,qDjEgGAlV,CiExEAmV,qDjEwEAnV,CiEhDA4V,wDjEgDA5V;AiEnBN6V,sDjEmBM7V,CiEOA8V,yDjEPA9V,CiEyCA+V,uDjEzCA/V,CiE8ENgW,4DjE9EM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","file":"blockly_compressed.js","sourcesContent":["/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.registry\n\nimport type {Abstract} from './events/events_abstract.js';\nimport type {Field} from './field.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport type {IIcon} from './interfaces/i_icon.js';\nimport type {Input} from './inputs/input.js';\nimport type {ISerializer} from './interfaces/i_serializer.js';\nimport type {IToolbox} from './interfaces/i_toolbox.js';\nimport type {Cursor} from './keyboard_nav/cursor.js';\nimport type {Options} from './options.js';\nimport type {Renderer} from './renderers/common/renderer.js';\nimport type {Theme} from './theme.js';\nimport type {ToolboxItem} from './toolbox/toolbox_item.js';\nimport type {IPaster} from './interfaces/i_paster.js';\nimport type {ICopyData, ICopyable} from './interfaces/i_copyable.js';\nimport type {IConnectionPreviewer} from './interfaces/i_connection_previewer.js';\nimport type {IDragger} from './interfaces/i_dragger.js';\n\n/**\n * A map of maps. With the keys being the type and name of the class we are\n * registering and the value being the constructor function.\n * e.g. {'field': {'field_angle': Blockly.FieldAngle}}\n */\nconst typeMap: {\n  [key: string]: {\n    [key: string]: (new () => AnyDuringMigration) | AnyDuringMigration;\n  };\n} = Object.create(null);\nexport const TEST_ONLY = {typeMap};\n\n/**\n * A map of maps. With the keys being the type and caseless name of the class we\n * are registring, and the value being the most recent cased name for that\n * registration.\n */\nconst nameMap: {[key: string]: {[key: string]: string}} = Object.create(null);\n\n/**\n * The string used to register the default class for a type of plugin.\n */\nexport const DEFAULT = 'default';\n\n/**\n * A name with the type of the element stored in the generic.\n */\nexport class Type<_T> {\n  /** @param name The name of the registry type. */\n  constructor(private readonly name: string) {}\n\n  /**\n   * Returns the name of the type.\n   *\n   * @returns The name.\n   */\n  toString(): string {\n    return this.name;\n  }\n\n  static CONNECTION_CHECKER = new Type<IConnectionChecker>('connectionChecker');\n\n  static CONNECTION_PREVIEWER = new Type<IConnectionPreviewer>(\n    'connectionPreviewer',\n  );\n\n  static CURSOR = new Type<Cursor>('cursor');\n\n  static EVENT = new Type<Abstract>('event');\n\n  static FIELD = new Type<Field>('field');\n\n  static INPUT = new Type<Input>('input');\n\n  static RENDERER = new Type<Renderer>('renderer');\n\n  static TOOLBOX = new Type<IToolbox>('toolbox');\n\n  static THEME = new Type<Theme>('theme');\n\n  static TOOLBOX_ITEM = new Type<ToolboxItem>('toolboxItem');\n\n  static FLYOUTS_VERTICAL_TOOLBOX = new Type<IFlyout>('flyoutsVerticalToolbox');\n\n  static FLYOUTS_HORIZONTAL_TOOLBOX = new Type<IFlyout>(\n    'flyoutsHorizontalToolbox',\n  );\n\n  static METRICS_MANAGER = new Type<IMetricsManager>('metricsManager');\n\n  /**\n   * Type for an IDragger. Formerly behavior was mostly covered by\n   * BlockDraggeers, which is why the name is inaccurate.\n   */\n  static BLOCK_DRAGGER = new Type<IDragger>('blockDragger');\n\n  /** @internal */\n  static SERIALIZER = new Type<ISerializer>('serializer');\n\n  /** @internal */\n  static ICON = new Type<IIcon>('icon');\n\n  /** @internal */\n  static PASTER = new Type<IPaster<ICopyData, ICopyable<ICopyData>>>('paster');\n}\n\n/**\n * Registers a class based on a type and name.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @param registryItem The class or object to register.\n * @param opt_allowOverrides True to prevent an error when overriding an already\n *     registered item.\n * @throws {Error} if the type or name is empty, a name with the given type has\n *     already been registered, or if the given class or object is not valid for\n *     its type.\n */\nexport function register<T>(\n  type: string | Type<T>,\n  name: string,\n  registryItem:\n    | (new (...p1: AnyDuringMigration[]) => T)\n    | null\n    | AnyDuringMigration,\n  opt_allowOverrides?: boolean,\n): void {\n  if (\n    (!(type instanceof Type) && typeof type !== 'string') ||\n    `${type}`.trim() === ''\n  ) {\n    throw Error(\n      'Invalid type \"' +\n        type +\n        '\". The type must be a' +\n        ' non-empty string or a Blockly.registry.Type.',\n    );\n  }\n  type = `${type}`.toLowerCase();\n\n  if (typeof name !== 'string' || name.trim() === '') {\n    throw Error(\n      'Invalid name \"' + name + '\". The name must be a' + ' non-empty string.',\n    );\n  }\n  const caselessName = name.toLowerCase();\n  if (!registryItem) {\n    throw Error('Can not register a null value');\n  }\n  let typeRegistry = typeMap[type];\n  let nameRegistry = nameMap[type];\n  // If the type registry has not been created, create it.\n  if (!typeRegistry) {\n    typeRegistry = typeMap[type] = Object.create(null);\n    nameRegistry = nameMap[type] = Object.create(null);\n  }\n\n  // Validate that the given class has all the required properties.\n  validate(type, registryItem);\n\n  // Don't throw an error if opt_allowOverrides is true,\n  // or if we're trying to register the same item.\n  if (\n    !opt_allowOverrides &&\n    typeRegistry[caselessName] &&\n    typeRegistry[caselessName] !== registryItem\n  ) {\n    throw Error(\n      'Name \"' +\n        caselessName +\n        '\" with type \"' +\n        type +\n        '\" already registered.',\n    );\n  }\n  typeRegistry[caselessName] = registryItem;\n  nameRegistry[caselessName] = name;\n}\n\n/**\n * Checks the given registry item for properties that are required based on the\n * type.\n *\n * @param type The type of the plugin. (e.g. Field, Renderer)\n * @param registryItem A class or object that we are checking for the required\n *     properties.\n */\nfunction validate(type: string, registryItem: Function | AnyDuringMigration) {\n  switch (type) {\n    case String(Type.FIELD):\n      if (typeof registryItem.fromJson !== 'function') {\n        throw Error('Type \"' + type + '\" must have a fromJson function');\n      }\n      break;\n  }\n}\n\n/**\n * Unregisters the registry item with the given type and name.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n */\nexport function unregister<T>(type: string | Type<T>, name: string) {\n  type = `${type}`.toLowerCase();\n  name = name.toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry || !typeRegistry[name]) {\n    console.warn(\n      'Unable to unregister [' +\n        name +\n        '][' +\n        type +\n        '] from the ' +\n        'registry.',\n    );\n    return;\n  }\n  delete typeMap[type][name];\n  delete nameMap[type][name];\n}\n\n/**\n * Gets the registry item for the given name and type. This can be either a\n * class or an object.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the plugin.\n * @returns The class or object with the given name and type or null if none\n *     exists.\n */\nfunction getItem<T>(\n  type: string | Type<T>,\n  name: string,\n  opt_throwIfMissing?: boolean,\n): (new (...p1: AnyDuringMigration[]) => T) | null | AnyDuringMigration {\n  type = `${type}`.toLowerCase();\n  name = name.toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry || !typeRegistry[name]) {\n    const msg = 'Unable to find [' + name + '][' + type + '] in the registry.';\n    if (opt_throwIfMissing) {\n      throw new Error(\n        msg + ' You must require or register a ' + type + ' plugin.',\n      );\n    } else {\n      console.warn(msg);\n    }\n    return null;\n  }\n  return typeRegistry[name];\n}\n\n/**\n * Returns whether or not the registry contains an item with the given type and\n * name.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @returns True if the registry has an item with the given type and name, false\n *     otherwise.\n */\nexport function hasItem<T>(type: string | Type<T>, name: string): boolean {\n  type = `${type}`.toLowerCase();\n  name = name.toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry) {\n    return false;\n  }\n  return !!typeRegistry[name];\n}\n\n/**\n * Gets the class for the given name and type.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the plugin.\n * @returns The class with the given name and type or null if none exists.\n */\nexport function getClass<T>(\n  type: string | Type<T>,\n  name: string,\n  opt_throwIfMissing?: boolean,\n): (new (...p1: AnyDuringMigration[]) => T) | null {\n  return getItem(type, name, opt_throwIfMissing) as\n    | (new (...p1: AnyDuringMigration[]) => T)\n    | null;\n}\n\n/**\n * Gets the object for the given name and type.\n *\n * @param type The type of the plugin.\n *     (e.g. Category)\n * @param name The plugin's name. (Ex. logic_category)\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the object.\n * @returns The object with the given name and type or null if none exists.\n */\nexport function getObject<T>(\n  type: string | Type<T>,\n  name: string,\n  opt_throwIfMissing?: boolean,\n): T | null {\n  return getItem(type, name, opt_throwIfMissing) as T;\n}\n\n/**\n * Returns a map of items registered with the given type.\n *\n * @param type The type of the plugin. (e.g. Category)\n * @param opt_cased Whether or not to return a map with cased keys (rather than\n *     caseless keys). False by default.\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the object. False by default.\n * @returns A map of objects with the given type, or null if none exists.\n */\nexport function getAllItems<T>(\n  type: string | Type<T>,\n  opt_cased?: boolean,\n  opt_throwIfMissing?: boolean,\n): {[key: string]: T | null | (new (...p1: AnyDuringMigration[]) => T)} | null {\n  type = `${type}`.toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry) {\n    const msg = `Unable to find [${type}] in the registry.`;\n    if (opt_throwIfMissing) {\n      throw new Error(`${msg} You must require or register a ${type} plugin.`);\n    } else {\n      console.warn(msg);\n    }\n    return null;\n  }\n  if (!opt_cased) {\n    return typeRegistry;\n  }\n  const nameRegistry = nameMap[type];\n  const casedRegistry = Object.create(null);\n  for (const key of Object.keys(typeRegistry)) {\n    casedRegistry[nameRegistry[key]] = typeRegistry[key];\n  }\n  return casedRegistry;\n}\n\n/**\n * Gets the class from Blockly options for the given type.\n * This is used for plugins that override a built in feature. (e.g. Toolbox)\n *\n * @param type The type of the plugin.\n * @param options The option object to check for the given plugin.\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the plugin.\n * @returns The class for the plugin.\n */\nexport function getClassFromOptions<T>(\n  type: Type<T>,\n  options: Options,\n  opt_throwIfMissing?: boolean,\n): (new (...p1: AnyDuringMigration[]) => T) | null {\n  const plugin = options.plugins[String(type)] || DEFAULT;\n\n  // If the user passed in a plugin class instead of a registered plugin name.\n  if (typeof plugin === 'function') {\n    return plugin;\n  }\n  return getClass(type, plugin, opt_throwIfMissing);\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.idGenerator\n\n/**\n * Legal characters for the universally unique IDs.  Should be all on\n * a US keyboard.  No characters that conflict with XML or JSON.\n * Requests to remove additional 'problematic' characters from this\n * soup will be denied.  That's your failure to properly escape in\n * your own environment.  Issues #251, #625, #682, #1304.\n */\nconst soup =\n  '!#$%()*+,-./:;=?@[]^_`{|}~' +\n  'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\n/**\n * Namespace object for internal implementations we want to be able to\n * stub in tests. Do not use externally.\n *\n * @internal\n */\nconst internal = {\n  /**\n   * Generate a random unique ID.  This should be globally unique.\n   * 87 characters ^ 20 length is greater than 128 bits (better than a UUID).\n   *\n   * @returns A globally unique ID string.\n   */\n  genUid: () => {\n    const length = 20;\n    const soupLength = soup.length;\n    const id = [];\n    for (let i = 0; i < length; i++) {\n      id[i] = soup.charAt(Math.random() * soupLength);\n    }\n    return id.join('');\n  },\n};\nexport const TEST_ONLY = internal;\n\n/** Next unique ID to use. */\nlet nextId = 0;\n\n/**\n * Generate the next unique element IDs.\n * IDs are compatible with the HTML4 'id' attribute restrictions:\n * Use only ASCII letters, digits, '_', '-' and '.'\n *\n * For UUIDs use genUid (below) instead; this ID generator should\n * primarily be used for IDs that end up in the DOM.\n *\n * @returns The next unique identifier.\n */\nexport function getNextUniqueId(): string {\n  return 'blockly-' + (nextId++).toString(36);\n}\n\n/**\n * Generate a random unique ID.\n *\n * @see internal.genUid\n * @returns A globally unique ID string.\n */\nexport function genUid(): string {\n  return internal.genUid();\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Events.utils\n\nimport type {Block} from '../block.js';\nimport * as common from '../common.js';\nimport * as registry from '../registry.js';\nimport * as idGenerator from '../utils/idgenerator.js';\nimport type {Workspace} from '../workspace.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\nimport type {Abstract} from './events_abstract.js';\nimport type {BlockChange} from './events_block_change.js';\nimport type {BlockCreate} from './events_block_create.js';\nimport type {BlockMove} from './events_block_move.js';\nimport type {CommentCreate} from './events_comment_create.js';\nimport type {CommentMove} from './events_comment_move.js';\nimport type {ViewportChange} from './events_viewport.js';\n\n/** Group ID for new events.  Grouped events are indivisible. */\nlet group = '';\n\n/** Sets whether the next event should be added to the undo stack. */\nlet recordUndo = true;\n\n/**\n * Sets whether events should be added to the undo stack.\n *\n * @param newValue True if events should be added to the undo stack.\n */\nexport function setRecordUndo(newValue: boolean) {\n  recordUndo = newValue;\n}\n\n/**\n * Returns whether or not events will be added to the undo stack.\n *\n * @returns True if events will be added to the undo stack.\n */\nexport function getRecordUndo(): boolean {\n  return recordUndo;\n}\n\n/** Allow change events to be created and fired. */\nlet disabled = 0;\n\n/**\n * Name of event that creates a block. Will be deprecated for BLOCK_CREATE.\n */\nexport const CREATE = 'create';\n\n/**\n * Name of event that creates a block.\n */\nexport const BLOCK_CREATE = CREATE;\n\n/**\n * Name of event that deletes a block. Will be deprecated for BLOCK_DELETE.\n */\nexport const DELETE = 'delete';\n\n/**\n * Name of event that deletes a block.\n */\nexport const BLOCK_DELETE = DELETE;\n\n/**\n * Name of event that changes a block. Will be deprecated for BLOCK_CHANGE.\n */\nexport const CHANGE = 'change';\n\n/**\n * Name of event that changes a block.\n */\nexport const BLOCK_CHANGE = CHANGE;\n\n/**\n * Name of event representing an in-progress change to a field of a block, which\n * is expected to be followed by a block change event.\n */\nexport const BLOCK_FIELD_INTERMEDIATE_CHANGE =\n  'block_field_intermediate_change';\n\n/**\n * Name of event that moves a block. Will be deprecated for BLOCK_MOVE.\n */\nexport const MOVE = 'move';\n\n/**\n * Name of event that moves a block.\n */\nexport const BLOCK_MOVE = MOVE;\n\n/**\n * Name of event that creates a variable.\n */\nexport const VAR_CREATE = 'var_create';\n\n/**\n * Name of event that deletes a variable.\n */\nexport const VAR_DELETE = 'var_delete';\n\n/**\n * Name of event that renames a variable.\n */\nexport const VAR_RENAME = 'var_rename';\n\n/**\n * Name of generic event that records a UI change.\n */\nexport const UI = 'ui';\n\n/**\n * Name of event that record a block drags a block.\n */\nexport const BLOCK_DRAG = 'drag';\n\n/**\n * Name of event that records a change in selected element.\n */\nexport const SELECTED = 'selected';\n\n/**\n * Name of event that records a click.\n */\nexport const CLICK = 'click';\n\n/**\n * Name of event that records a marker move.\n */\nexport const MARKER_MOVE = 'marker_move';\n\n/**\n * Name of event that records a bubble open.\n */\nexport const BUBBLE_OPEN = 'bubble_open';\n\n/**\n * Name of event that records a trashcan open.\n */\nexport const TRASHCAN_OPEN = 'trashcan_open';\n\n/**\n * Name of event that records a toolbox item select.\n */\nexport const TOOLBOX_ITEM_SELECT = 'toolbox_item_select';\n\n/**\n * Name of event that records a theme change.\n */\nexport const THEME_CHANGE = 'theme_change';\n\n/**\n * Name of event that records a viewport change.\n */\nexport const VIEWPORT_CHANGE = 'viewport_change';\n\n/**\n * Name of event that creates a comment.\n */\nexport const COMMENT_CREATE = 'comment_create';\n\n/**\n * Name of event that deletes a comment.\n */\nexport const COMMENT_DELETE = 'comment_delete';\n\n/**\n * Name of event that changes a comment.\n */\nexport const COMMENT_CHANGE = 'comment_change';\n\n/**\n * Name of event that moves a comment.\n */\nexport const COMMENT_MOVE = 'comment_move';\n\n/** Type of event that moves a comment. */\nexport const COMMENT_COLLAPSE = 'comment_collapse';\n\n/**\n * Name of event that records a workspace load.\n */\nexport const FINISHED_LOADING = 'finished_loading';\n\n/**\n * The language-neutral ID for when the reason why a block is disabled is\n * because the block is not descended from a root block.\n */\nconst ORPHANED_BLOCK_DISABLED_REASON = 'ORPHANED_BLOCK';\n\n/**\n * Type of events that cause objects to be bumped back into the visible\n * portion of the workspace.\n *\n * Not to be confused with bumping so that disconnected connections do not\n * appear connected.\n */\nexport type BumpEvent = BlockCreate | BlockMove | CommentCreate | CommentMove;\n\n/**\n * List of events that cause objects to be bumped back into the visible\n * portion of the workspace.\n *\n * Not to be confused with bumping so that disconnected connections do not\n * appear connected.\n */\nexport const BUMP_EVENTS: string[] = [\n  BLOCK_CREATE,\n  BLOCK_MOVE,\n  COMMENT_CREATE,\n  COMMENT_MOVE,\n];\n\n/** List of events queued for firing. */\nconst FIRE_QUEUE: Abstract[] = [];\n\n/**\n * Create a custom event and fire it.\n *\n * @param event Custom data for event.\n */\nexport function fire(event: Abstract) {\n  TEST_ONLY.fireInternal(event);\n}\n\n/**\n * Private version of fireInternal for stubbing in tests.\n */\nfunction fireInternal(event: Abstract) {\n  if (!isEnabled()) {\n    return;\n  }\n  if (!FIRE_QUEUE.length) {\n    // First event added; schedule a firing of the event queue.\n    try {\n      // If we are in a browser context, we want to make sure that the event\n      // fires after blocks have been rerendered this frame.\n      requestAnimationFrame(() => {\n        setTimeout(fireNow, 0);\n      });\n    } catch (e) {\n      // Otherwise we just want to delay so events can be coallesced.\n      // requestAnimationFrame will error triggering this.\n      setTimeout(fireNow, 0);\n    }\n  }\n  FIRE_QUEUE.push(event);\n}\n\n/** Fire all queued events. */\nfunction fireNow() {\n  const queue = filter(FIRE_QUEUE, true);\n  FIRE_QUEUE.length = 0;\n  for (let i = 0, event; (event = queue[i]); i++) {\n    if (!event.workspaceId) {\n      continue;\n    }\n    const eventWorkspace = common.getWorkspaceById(event.workspaceId);\n    if (eventWorkspace) {\n      eventWorkspace.fireChangeListener(event);\n    }\n  }\n\n  // Post-filter the undo stack to squash and remove any events that result in\n  // a null event\n\n  // 1. Determine which workspaces will need to have their undo stacks validated\n  const workspaceIds = new Set(queue.map((e) => e.workspaceId));\n  for (const workspaceId of workspaceIds) {\n    // Only process valid workspaces\n    if (!workspaceId) {\n      continue;\n    }\n    const eventWorkspace = common.getWorkspaceById(workspaceId);\n    if (!eventWorkspace) {\n      continue;\n    }\n\n    // Find the last contiguous group of events on the stack\n    const undoStack = eventWorkspace.getUndoStack();\n    let i;\n    let group: string | undefined = undefined;\n    for (i = undoStack.length; i > 0; i--) {\n      const event = undoStack[i - 1];\n      if (event.group === '') {\n        break;\n      } else if (group === undefined) {\n        group = event.group;\n      } else if (event.group !== group) {\n        break;\n      }\n    }\n    if (!group || i == undoStack.length - 1) {\n      // Need a group of two or more events on the stack. Nothing to do here.\n      continue;\n    }\n\n    // Extract the event group, filter, and add back to the undo stack\n    let events = undoStack.splice(i, undoStack.length - i);\n    events = filter(events, true);\n    undoStack.push(...events);\n  }\n}\n\n/**\n * Filter the queued events and merge duplicates.\n *\n * @param queueIn Array of events.\n * @param forward True if forward (redo), false if backward (undo).\n * @returns Array of filtered events.\n */\nexport function filter(queueIn: Abstract[], forward: boolean): Abstract[] {\n  let queue = queueIn.slice();\n  // Shallow copy of queue.\n  if (!forward) {\n    // Undo is merged in reverse order.\n    queue.reverse();\n  }\n  const mergedQueue = [];\n  const hash = Object.create(null);\n  // Merge duplicates.\n  for (let i = 0, event; (event = queue[i]); i++) {\n    if (!event.isNull()) {\n      // Treat all UI events as the same type in hash table.\n      const eventType = event.isUiEvent ? UI : event.type;\n      // TODO(#5927): Check whether `blockId` exists before accessing it.\n      const blockId = (event as AnyDuringMigration).blockId;\n      const key = [eventType, blockId, event.workspaceId].join(' ');\n\n      const lastEntry = hash[key];\n      const lastEvent = lastEntry ? lastEntry.event : null;\n      if (!lastEntry) {\n        // Each item in the hash table has the event and the index of that event\n        // in the input array.  This lets us make sure we only merge adjacent\n        // move events.\n        hash[key] = {event, index: i};\n        mergedQueue.push(event);\n      } else if (event.type === MOVE && lastEntry.index === i - 1) {\n        const moveEvent = event as BlockMove;\n        // Merge move events.\n        lastEvent.newParentId = moveEvent.newParentId;\n        lastEvent.newInputName = moveEvent.newInputName;\n        lastEvent.newCoordinate = moveEvent.newCoordinate;\n        if (moveEvent.reason) {\n          if (lastEvent.reason) {\n            // Concatenate reasons without duplicates.\n            const reasonSet = new Set(\n              moveEvent.reason.concat(lastEvent.reason),\n            );\n            lastEvent.reason = Array.from(reasonSet);\n          } else {\n            lastEvent.reason = moveEvent.reason;\n          }\n        }\n        lastEntry.index = i;\n      } else if (\n        event.type === CHANGE &&\n        (event as BlockChange).element === lastEvent.element &&\n        (event as BlockChange).name === lastEvent.name\n      ) {\n        const changeEvent = event as BlockChange;\n        // Merge change events.\n        lastEvent.newValue = changeEvent.newValue;\n      } else if (event.type === VIEWPORT_CHANGE) {\n        const viewportEvent = event as ViewportChange;\n        // Merge viewport change events.\n        lastEvent.viewTop = viewportEvent.viewTop;\n        lastEvent.viewLeft = viewportEvent.viewLeft;\n        lastEvent.scale = viewportEvent.scale;\n        lastEvent.oldScale = viewportEvent.oldScale;\n      } else if (event.type === CLICK && lastEvent.type === BUBBLE_OPEN) {\n        // Drop click events caused by opening/closing bubbles.\n      } else {\n        // Collision: newer events should merge into this event to maintain\n        // order.\n        hash[key] = {event, index: i};\n        mergedQueue.push(event);\n      }\n    }\n  }\n  // Filter out any events that have become null due to merging.\n  queue = mergedQueue.filter(function (e) {\n    return !e.isNull();\n  });\n  if (!forward) {\n    // Restore undo order.\n    queue.reverse();\n  }\n  // Move mutation events to the top of the queue.\n  // Intentionally skip first event.\n  for (let i = 1, event; (event = queue[i]); i++) {\n    // AnyDuringMigration because:  Property 'element' does not exist on type\n    // 'Abstract'.\n    if (\n      event.type === CHANGE &&\n      (event as AnyDuringMigration).element === 'mutation'\n    ) {\n      queue.unshift(queue.splice(i, 1)[0]);\n    }\n  }\n  return queue;\n}\n\n/**\n * Modify pending undo events so that when they are fired they don't land\n * in the undo stack.  Called by Workspace.clearUndo.\n */\nexport function clearPendingUndo() {\n  for (let i = 0, event; (event = FIRE_QUEUE[i]); i++) {\n    event.recordUndo = false;\n  }\n}\n\n/**\n * Stop sending events.  Every call to this function MUST also call enable.\n */\nexport function disable() {\n  disabled++;\n}\n\n/**\n * Start sending events.  Unless events were already disabled when the\n * corresponding call to disable was made.\n */\nexport function enable() {\n  disabled--;\n}\n\n/**\n * Returns whether events may be fired or not.\n *\n * @returns True if enabled.\n */\nexport function isEnabled(): boolean {\n  return disabled === 0;\n}\n\n/**\n * Current group.\n *\n * @returns ID string.\n */\nexport function getGroup(): string {\n  return group;\n}\n\n/**\n * Start or stop a group.\n *\n * @param state True to start new group, false to end group.\n *   String to set group explicitly.\n */\nexport function setGroup(state: boolean | string) {\n  TEST_ONLY.setGroupInternal(state);\n}\n\n/**\n * Private version of setGroup for stubbing in tests.\n */\nfunction setGroupInternal(state: boolean | string) {\n  if (typeof state === 'boolean') {\n    group = state ? idGenerator.genUid() : '';\n  } else {\n    group = state;\n  }\n}\n\n/**\n * Compute a list of the IDs of the specified block and all its descendants.\n *\n * @param block The root block.\n * @returns List of block IDs.\n * @internal\n */\nexport function getDescendantIds(block: Block): string[] {\n  const ids = [];\n  const descendants = block.getDescendants(false);\n  for (let i = 0, descendant; (descendant = descendants[i]); i++) {\n    ids[i] = descendant.id;\n  }\n  return ids;\n}\n\n/**\n * Decode the JSON into an event.\n *\n * @param json JSON representation.\n * @param workspace Target workspace for event.\n * @returns The event represented by the JSON.\n * @throws {Error} if an event type is not found in the registry.\n */\nexport function fromJson(\n  json: AnyDuringMigration,\n  workspace: Workspace,\n): Abstract {\n  const eventClass = get(json['type']);\n  if (!eventClass) throw Error('Unknown event type.');\n\n  return (eventClass as any).fromJson(json, workspace);\n}\n\n/**\n * Gets the class for a specific event type from the registry.\n *\n * @param eventType The type of the event to get.\n * @returns The event class with the given type.\n */\nexport function get(\n  eventType: string,\n): new (...p1: AnyDuringMigration[]) => Abstract {\n  const event = registry.getClass(registry.Type.EVENT, eventType);\n  if (!event) {\n    throw new Error(`Event type ${eventType} not found in registry.`);\n  }\n  return event;\n}\n\n/**\n * Set if a block is disabled depending on whether it is properly connected.\n * Use this on applications where all blocks should be connected to a top block.\n *\n * @param event Custom data for event.\n */\nexport function disableOrphans(event: Abstract) {\n  if (event.type === MOVE || event.type === CREATE) {\n    const blockEvent = event as BlockMove | BlockCreate;\n    if (!blockEvent.workspaceId) {\n      return;\n    }\n    const eventWorkspace = common.getWorkspaceById(\n      blockEvent.workspaceId,\n    ) as WorkspaceSvg;\n    if (!blockEvent.blockId) {\n      throw new Error('Encountered a blockEvent without a proper blockId');\n    }\n    let block = eventWorkspace.getBlockById(blockEvent.blockId);\n    if (block) {\n      // Changing blocks as part of this event shouldn't be undoable.\n      const initialUndoFlag = recordUndo;\n      try {\n        recordUndo = false;\n        const parent = block.getParent();\n        if (\n          parent &&\n          !parent.hasDisabledReason(ORPHANED_BLOCK_DISABLED_REASON)\n        ) {\n          const children = block.getDescendants(false);\n          for (let i = 0, child; (child = children[i]); i++) {\n            child.setDisabledReason(false, ORPHANED_BLOCK_DISABLED_REASON);\n          }\n        } else if (\n          (block.outputConnection || block.previousConnection) &&\n          !eventWorkspace.isDragging()\n        ) {\n          do {\n            block.setDisabledReason(true, ORPHANED_BLOCK_DISABLED_REASON);\n            block = block.getNextBlock();\n          } while (block);\n        }\n      } finally {\n        recordUndo = initialUndoFlag;\n      }\n    }\n  }\n}\n\nexport const TEST_ONLY = {\n  FIRE_QUEUE,\n  fireNow,\n  fireInternal,\n  setGroupInternal,\n};\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.common\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Block} from './block.js';\nimport {ISelectable} from './blockly.js';\nimport {BlockDefinition, Blocks} from './blocks.js';\nimport type {Connection} from './connection.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as eventUtils from './events/utils.js';\n\n/** Database of all workspaces. */\nconst WorkspaceDB_ = Object.create(null);\n\n/**\n * Find the workspace with the specified ID.\n *\n * @param id ID of workspace to find.\n * @returns The sought after workspace or null if not found.\n */\nexport function getWorkspaceById(id: string): Workspace | null {\n  return WorkspaceDB_[id] || null;\n}\n\n/**\n * Find all workspaces.\n *\n * @returns Array of workspaces.\n */\nexport function getAllWorkspaces(): Workspace[] {\n  const workspaces = [];\n  for (const workspaceId in WorkspaceDB_) {\n    workspaces.push(WorkspaceDB_[workspaceId]);\n  }\n  return workspaces;\n}\n\n/**\n * Register a workspace in the workspace db.\n *\n * @param workspace\n */\nexport function registerWorkspace(workspace: Workspace) {\n  WorkspaceDB_[workspace.id] = workspace;\n}\n\n/**\n * Unregister a workspace from the workspace db.\n *\n * @param workspace\n */\nexport function unregisterWorkpace(workspace: Workspace) {\n  delete WorkspaceDB_[workspace.id];\n}\n\n/**\n * The main workspace most recently used.\n * Set by Blockly.WorkspaceSvg.prototype.markFocused\n */\nlet mainWorkspace: Workspace;\n\n/**\n * Returns the last used top level workspace (based on focus).  Try not to use\n * this function, particularly if there are multiple Blockly instances on a\n * page.\n *\n * @returns The main workspace.\n */\nexport function getMainWorkspace(): Workspace {\n  return mainWorkspace;\n}\n\n/**\n * Sets last used main workspace.\n *\n * @param workspace The most recently used top level workspace.\n */\nexport function setMainWorkspace(workspace: Workspace) {\n  mainWorkspace = workspace;\n}\n\n/**\n * Currently selected copyable object.\n */\nlet selected: ISelectable | null = null;\n\n/**\n * Returns the currently selected copyable object.\n */\nexport function getSelected(): ISelectable | null {\n  return selected;\n}\n\n/**\n * Sets the currently selected block. This function does not visually mark the\n * block as selected or fire the required events. If you wish to\n * programmatically select a block, use `BlockSvg#select`.\n *\n * @param newSelection The newly selected block.\n * @internal\n */\nexport function setSelected(newSelection: ISelectable | null) {\n  if (selected === newSelection) return;\n\n  const event = new (eventUtils.get(eventUtils.SELECTED))(\n    selected?.id ?? null,\n    newSelection?.id ?? null,\n    newSelection?.workspace.id ?? selected?.workspace.id ?? '',\n  );\n  eventUtils.fire(event);\n\n  selected?.unselect();\n  selected = newSelection;\n  selected?.select();\n}\n\n/**\n * Container element in which to render the WidgetDiv, DropDownDiv and Tooltip.\n */\nlet parentContainer: Element | null;\n\n/**\n * Get the container element in which to render the WidgetDiv, DropDownDiv and\n * Tooltip.\n *\n * @returns The parent container.\n */\nexport function getParentContainer(): Element | null {\n  return parentContainer;\n}\n\n/**\n * Set the parent container.  This is the container element that the WidgetDiv,\n * DropDownDiv, and Tooltip are rendered into the first time `Blockly.inject`\n * is called.\n * This method is a NOP if called after the first `Blockly.inject`.\n *\n * @param newParent The container element.\n */\nexport function setParentContainer(newParent: Element) {\n  parentContainer = newParent;\n}\n\n/**\n * Size the SVG image to completely fill its container. Call this when the view\n * actually changes sizes (e.g. on a window resize/device orientation change).\n * See workspace.resizeContents to resize the workspace when the contents\n * change (e.g. when a block is added or removed).\n * Record the height/width of the SVG image.\n *\n * @param workspace Any workspace in the SVG.\n */\nexport function svgResize(workspace: WorkspaceSvg) {\n  let mainWorkspace = workspace;\n  while (mainWorkspace.options.parentWorkspace) {\n    mainWorkspace = mainWorkspace.options.parentWorkspace;\n  }\n  const svg = mainWorkspace.getParentSvg();\n  const cachedSize = mainWorkspace.getCachedParentSvgSize();\n  const div = svg.parentElement;\n  if (!(div instanceof HTMLElement)) {\n    // Workspace deleted, or something.\n    return;\n  }\n\n  const width = div.offsetWidth;\n  const height = div.offsetHeight;\n  if (cachedSize.width !== width) {\n    svg.setAttribute('width', width + 'px');\n    mainWorkspace.setCachedParentSvgSize(width, null);\n  }\n  if (cachedSize.height !== height) {\n    svg.setAttribute('height', height + 'px');\n    mainWorkspace.setCachedParentSvgSize(null, height);\n  }\n  mainWorkspace.resize();\n}\n\n/**\n * All of the connections on blocks that are currently being dragged.\n */\nexport const draggingConnections: Connection[] = [];\n\n/**\n * Get a map of all the block's descendants mapping their type to the number of\n *    children with that type.\n *\n * @param block The block to map.\n * @param opt_stripFollowing Optionally ignore all following\n *    statements (blocks that are not inside a value or statement input\n *    of the block).\n * @returns Map of types to type counts for descendants of the bock.\n */\nexport function getBlockTypeCounts(\n  block: Block,\n  opt_stripFollowing?: boolean,\n): {[key: string]: number} {\n  const typeCountsMap = Object.create(null);\n  const descendants = block.getDescendants(true);\n  if (opt_stripFollowing) {\n    const nextBlock = block.getNextBlock();\n    if (nextBlock) {\n      const index = descendants.indexOf(nextBlock);\n      descendants.splice(index, descendants.length - index);\n    }\n  }\n  for (let i = 0, checkBlock; (checkBlock = descendants[i]); i++) {\n    if (typeCountsMap[checkBlock.type]) {\n      typeCountsMap[checkBlock.type]++;\n    } else {\n      typeCountsMap[checkBlock.type] = 1;\n    }\n  }\n  return typeCountsMap;\n}\n\n/**\n * Helper function for defining a block from JSON.  The resulting function has\n * the correct value of jsonDef at the point in code where jsonInit is called.\n *\n * @param jsonDef The JSON definition of a block.\n * @returns A function that calls jsonInit with the correct value\n *     of jsonDef.\n */\nfunction jsonInitFactory(jsonDef: AnyDuringMigration): () => void {\n  return function (this: Block) {\n    this.jsonInit(jsonDef);\n  };\n}\n\n/**\n * Define blocks from an array of JSON block definitions, as might be generated\n * by the Blockly Developer Tools.\n *\n * @param jsonArray An array of JSON block definitions.\n */\nexport function defineBlocksWithJsonArray(jsonArray: AnyDuringMigration[]) {\n  TEST_ONLY.defineBlocksWithJsonArrayInternal(jsonArray);\n}\n\n/**\n * Private version of defineBlocksWithJsonArray for stubbing in tests.\n */\nfunction defineBlocksWithJsonArrayInternal(jsonArray: AnyDuringMigration[]) {\n  defineBlocks(createBlockDefinitionsFromJsonArray(jsonArray));\n}\n\n/**\n * Define blocks from an array of JSON block definitions, as might be generated\n * by the Blockly Developer Tools.\n *\n * @param jsonArray An array of JSON block definitions.\n * @returns A map of the block\n *     definitions created.\n */\nexport function createBlockDefinitionsFromJsonArray(\n  jsonArray: AnyDuringMigration[],\n): {[key: string]: BlockDefinition} {\n  const blocks: {[key: string]: BlockDefinition} = {};\n  for (let i = 0; i < jsonArray.length; i++) {\n    const elem = jsonArray[i];\n    if (!elem) {\n      console.warn(`Block definition #${i} in JSON array is ${elem}. Skipping`);\n      continue;\n    }\n    const type = elem['type'];\n    if (!type) {\n      console.warn(\n        `Block definition #${i} in JSON array is missing a type attribute. ` +\n          'Skipping.',\n      );\n      continue;\n    }\n    blocks[type] = {init: jsonInitFactory(elem)};\n  }\n  return blocks;\n}\n\n/**\n * Add the specified block definitions to the block definitions\n * dictionary (Blockly.Blocks).\n *\n * @param blocks A map of block\n *     type names to block definitions.\n */\nexport function defineBlocks(blocks: {[key: string]: BlockDefinition}) {\n  // Iterate over own enumerable properties.\n  for (const type of Object.keys(blocks)) {\n    const definition = blocks[type];\n    if (type in Blocks) {\n      console.warn(\n        `Block definition \"${type}\" overwrites previous definition.`,\n      );\n    }\n    Blocks[type] = definition;\n  }\n}\n\nexport const TEST_ONLY = {defineBlocksWithJsonArrayInternal};\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Touch\n\nimport type {Gesture} from './gesture.js';\n\n/** Length in ms for a touch to become a long press. */\nconst LONGPRESS = 750;\n\n/**\n * Whether touch is enabled in the browser.\n * Copied from Closure's goog.events.BrowserFeature.TOUCH_ENABLED\n */\nexport const TOUCH_ENABLED =\n  'ontouchstart' in globalThis ||\n  !!(\n    globalThis['document'] &&\n    document.documentElement &&\n    'ontouchstart' in document.documentElement\n  ) || // IE10 uses non-standard touch events,\n  // so it has a different check.\n  !!(\n    globalThis['navigator'] &&\n    (globalThis['navigator']['maxTouchPoints'] ||\n      (globalThis['navigator'] as any)['msMaxTouchPoints'])\n  );\n\n/** Which touch events are we currently paying attention to? */\nlet touchIdentifier_: string | null = null;\n\n/**\n * The TOUCH_MAP lookup dictionary specifies additional touch events to fire,\n * in conjunction with mouse events.\n */\nexport const TOUCH_MAP: {[key: string]: string[]} = {\n  'mousedown': ['pointerdown'],\n  'mouseenter': ['pointerenter'],\n  'mouseleave': ['pointerleave'],\n  'mousemove': ['pointermove'],\n  'mouseout': ['pointerout'],\n  'mouseover': ['pointerover'],\n  'mouseup': ['pointerup', 'pointercancel'],\n  'touchend': ['pointerup'],\n  'touchcancel': ['pointercancel'],\n};\n\n/** PID of queued long-press task. */\nlet longPid_: AnyDuringMigration = 0;\n\n/**\n * Context menus on touch devices are activated using a long-press.\n * Unfortunately the contextmenu touch event is currently (2015) only supported\n * by Chrome.  This function is fired on any touchstart event, queues a task,\n * which after about a second opens the context menu.  The tasks is killed\n * if the touch event terminates early.\n *\n * @param e Touch start event.\n * @param gesture The gesture that triggered this longStart.\n * @internal\n */\nexport function longStart(e: PointerEvent, gesture: Gesture) {\n  longStop();\n  longPid_ = setTimeout(function () {\n    // Let the gesture route the right-click correctly.\n    if (gesture) {\n      gesture.handleRightClick(e);\n    }\n  }, LONGPRESS);\n}\n\n/**\n * Nope, that's not a long-press.  Either touchend or touchcancel was fired,\n * or a drag hath begun.  Kill the queued long-press task.\n *\n * @internal\n */\nexport function longStop() {\n  if (longPid_) {\n    clearTimeout(longPid_);\n    longPid_ = 0;\n  }\n}\n\n/**\n * Clear the touch identifier that tracks which touch stream to pay attention\n * to.  This ends the current drag/gesture and allows other pointers to be\n * captured.\n */\nexport function clearTouchIdentifier() {\n  touchIdentifier_ = null;\n}\n\n/**\n * Decide whether Blockly should handle or ignore this event.\n * Mouse and touch events require special checks because we only want to deal\n * with one touch stream at a time.  All other events should always be handled.\n *\n * @param e The event to check.\n * @returns True if this event should be passed through to the registered\n *     handler; false if it should be blocked.\n */\nexport function shouldHandleEvent(e: Event): boolean {\n  // Do not replace the startsWith with a check for `instanceof PointerEvent`.\n  // `click` and `contextmenu` are PointerEvents in some browsers,\n  // despite not starting with `pointer`, but we want to always handle them\n  // without worrying about touch identifiers.\n  return (\n    !e.type.startsWith('pointer') ||\n    (e instanceof PointerEvent && checkTouchIdentifier(e))\n  );\n}\n\n/**\n * Get the pointer identifier from the given event.\n *\n * @param e Pointer event.\n * @returns The pointerId of the event.\n */\nexport function getTouchIdentifierFromEvent(e: PointerEvent): string {\n  return `${e.pointerId}`;\n}\n\n/**\n * Check whether the pointer identifier on the event matches the current saved\n * identifier. If the current identifier was unset, save the identifier from\n * the event. This starts a drag/gesture, during which pointer events with\n * other identifiers will be silently ignored.\n *\n * @param e Pointer event.\n * @returns Whether the identifier on the event matches the current saved\n *     identifier.\n */\nexport function checkTouchIdentifier(e: PointerEvent): boolean {\n  const identifier = getTouchIdentifierFromEvent(e);\n\n  if (touchIdentifier_) {\n    // We're already tracking some touch/mouse event.  Is this from the same\n    // source?\n    return touchIdentifier_ === identifier;\n  }\n  if (e.type === 'pointerdown') {\n    // No identifier set yet, and this is the start of a drag.  Set it and\n    // return.\n    touchIdentifier_ = identifier;\n    return true;\n  }\n  // There was no identifier yet, but this wasn't a start event so we're going\n  // to ignore it.  This probably means that another drag finished while this\n  // pointer was down.\n  return false;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.browserEvents\n\nimport * as Touch from './touch.js';\nimport * as userAgent from './utils/useragent.js';\n\n/**\n * Blockly opaque event data used to unbind events when using\n * `bind` and `conditionalBind`.\n */\nexport type Data = [EventTarget, string, (e: Event) => void][];\n\n/**\n * The multiplier for scroll wheel deltas using the line delta mode.\n * See https://developer.mozilla.org/en-US/docs/Web/API/WheelEvent/deltaMode\n * for more information on deltaMode.\n */\nconst LINE_MODE_MULTIPLIER = 40;\n\n/**\n * The multiplier for scroll wheel deltas using the page delta mode.\n * See https://developer.mozilla.org/en-US/docs/Web/API/WheelEvent/deltaMode\n * for more information on deltaMode.\n */\nconst PAGE_MODE_MULTIPLIER = 125;\n\n/**\n * Bind an event handler that can be ignored if it is not part of the active\n * touch stream.\n * Use this for events that either start or continue a multi-part gesture (e.g.\n * mousedown or mousemove, which may be part of a drag or click).\n *\n * @param node Node upon which to listen.\n * @param name Event name to listen to (e.g. 'mousedown').\n * @param thisObject The value of 'this' in the function.\n * @param func Function to call when event is triggered.\n * @param opt_noCaptureIdentifier True if triggering on this event should not\n *     block execution of other event handlers on this touch or other\n *     simultaneous touches.  False by default.\n * @returns Opaque data that can be passed to unbindEvent_.\n */\nexport function conditionalBind(\n  node: EventTarget,\n  name: string,\n  thisObject: Object | null,\n  func: Function,\n  opt_noCaptureIdentifier?: boolean,\n): Data {\n  /**\n   *\n   * @param e\n   */\n  function wrapFunc(e: Event) {\n    const captureIdentifier = !opt_noCaptureIdentifier;\n\n    if (!(captureIdentifier && !Touch.shouldHandleEvent(e))) {\n      if (thisObject) {\n        func.call(thisObject, e);\n      } else {\n        func(e);\n      }\n    }\n  }\n\n  const bindData: Data = [];\n  if (name in Touch.TOUCH_MAP) {\n    for (let i = 0; i < Touch.TOUCH_MAP[name].length; i++) {\n      const type = Touch.TOUCH_MAP[name][i];\n      node.addEventListener(type, wrapFunc, false);\n      bindData.push([node, type, wrapFunc]);\n    }\n  } else {\n    node.addEventListener(name, wrapFunc, false);\n    bindData.push([node, name, wrapFunc]);\n  }\n  return bindData;\n}\n\n/**\n * Bind an event handler that should be called regardless of whether it is part\n * of the active touch stream.\n * Use this for events that are not part of a multi-part gesture (e.g.\n * mouseover for tooltips).\n *\n * @param node Node upon which to listen.\n * @param name Event name to listen to (e.g. 'mousedown').\n * @param thisObject The value of 'this' in the function.\n * @param func Function to call when event is triggered.\n * @returns Opaque data that can be passed to unbindEvent_.\n */\nexport function bind(\n  node: EventTarget,\n  name: string,\n  thisObject: Object | null,\n  func: Function,\n): Data {\n  /**\n   *\n   * @param e\n   */\n  function wrapFunc(e: Event) {\n    if (thisObject) {\n      func.call(thisObject, e);\n    } else {\n      func(e);\n    }\n  }\n\n  const bindData: Data = [];\n  if (name in Touch.TOUCH_MAP) {\n    for (let i = 0; i < Touch.TOUCH_MAP[name].length; i++) {\n      const type = Touch.TOUCH_MAP[name][i];\n      node.addEventListener(type, wrapFunc, false);\n      bindData.push([node, type, wrapFunc]);\n    }\n  } else {\n    node.addEventListener(name, wrapFunc, false);\n    bindData.push([node, name, wrapFunc]);\n  }\n  return bindData;\n}\n\n/**\n * Unbind one or more events event from a function call.\n *\n * @param bindData Opaque data from bindEvent_.\n *     This list is emptied during the course of calling this function.\n * @returns The function call.\n */\nexport function unbind(bindData: Data): (e: Event) => void {\n  // Accessing an element of the last property of the array is unsafe if the\n  // bindData is an empty array. But that should never happen because developers\n  // should only pass Data from bind or conditionalBind.\n  const callback = bindData[bindData.length - 1][2];\n  while (bindData.length) {\n    const [node, name, func] = bindData.pop()!;\n    node.removeEventListener(name, func, false);\n  }\n  return callback;\n}\n\n/**\n * Returns true if this event is targeting a text input widget?\n *\n * @param e An event.\n * @returns True if text input.\n */\nexport function isTargetInput(e: Event): boolean {\n  if (e.target instanceof HTMLElement) {\n    if (\n      e.target.isContentEditable ||\n      e.target.getAttribute('data-is-text-input') === 'true'\n    ) {\n      return true;\n    }\n\n    if (e.target instanceof HTMLInputElement) {\n      const target = e.target;\n      return (\n        target.type === 'text' ||\n        target.type === 'number' ||\n        target.type === 'email' ||\n        target.type === 'password' ||\n        target.type === 'search' ||\n        target.type === 'tel' ||\n        target.type === 'url'\n      );\n    }\n\n    if (e.target instanceof HTMLTextAreaElement) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Returns true this event is a right-click.\n *\n * @param e Mouse event.\n * @returns True if right-click.\n */\nexport function isRightButton(e: MouseEvent): boolean {\n  if (e.ctrlKey && userAgent.MAC) {\n    // Control-clicking on Mac OS X is treated as a right-click.\n    // WebKit on Mac OS X fails to change button to 2 (but Gecko does).\n    return true;\n  }\n  return e.button === 2;\n}\n\n/**\n * Returns the converted coordinates of the given mouse event.\n * The origin (0,0) is the top-left corner of the Blockly SVG.\n *\n * @param e Mouse event.\n * @param svg SVG element.\n * @param matrix Inverted screen CTM to use.\n * @returns Object with .x and .y properties.\n */\nexport function mouseToSvg(\n  e: MouseEvent,\n  svg: SVGSVGElement,\n  matrix: SVGMatrix | null,\n): SVGPoint {\n  const svgPoint = svg.createSVGPoint();\n  svgPoint.x = e.clientX;\n  svgPoint.y = e.clientY;\n\n  if (!matrix) {\n    matrix = svg.getScreenCTM()!.inverse();\n  }\n  return svgPoint.matrixTransform(matrix);\n}\n\n/**\n * Returns the scroll delta of a mouse event in pixel units.\n *\n * @param e Mouse event.\n * @returns Scroll delta object with .x and .y properties.\n */\nexport function getScrollDeltaPixels(e: WheelEvent): {x: number; y: number} {\n  switch (e.deltaMode) {\n    case 0x00: // Pixel mode.\n    default:\n      return {x: e.deltaX, y: e.deltaY};\n    case 0x01: // Line mode.\n      return {\n        x: e.deltaX * LINE_MODE_MULTIPLIER,\n        y: e.deltaY * LINE_MODE_MULTIPLIER,\n      };\n    case 0x02: // Page mode.\n      return {\n        x: e.deltaX * PAGE_MODE_MULTIPLIER,\n        y: e.deltaY * PAGE_MODE_MULTIPLIER,\n      };\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.array\n\n/**\n * Removes the first occurrence of a particular value from an array.\n *\n * @param arr Array from which to remove value.\n * @param value Value to remove.\n * @returns True if an element was removed.\n * @internal\n */\nexport function removeElem<T>(arr: Array<T>, value: T): boolean {\n  const i = arr.indexOf(value);\n  if (i === -1) {\n    return false;\n  }\n  arr.splice(i, 1);\n  return true;\n}\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Css\n\n/** Has CSS already been injected? */\nlet injected = false;\n\n/**\n * Add some CSS to the blob that will be injected later.  Allows optional\n * components such as fields and the toolbox to store separate CSS.\n *\n * @param cssContent Multiline CSS string or an array of single lines of CSS.\n */\nexport function register(cssContent: string) {\n  if (injected) {\n    throw Error('CSS already injected');\n  }\n  content += '\\n' + cssContent;\n}\n\n/**\n * Inject the CSS into the DOM.  This is preferable over using a regular CSS\n * file since:\n * a) It loads synchronously and doesn't force a redraw later.\n * b) It speeds up loading by not blocking on a separate HTTP transfer.\n * c) The CSS content may be made dynamic depending on init options.\n *\n * @param hasCss If false, don't inject CSS (providing CSS becomes the\n *     document's responsibility).\n * @param pathToMedia Path from page to the Blockly media directory.\n */\nexport function inject(hasCss: boolean, pathToMedia: string) {\n  // Only inject the CSS once.\n  if (injected) {\n    return;\n  }\n  injected = true;\n  if (!hasCss) {\n    return;\n  }\n  // Strip off any trailing slash (either Unix or Windows).\n  const mediaPath = pathToMedia.replace(/[\\\\/]$/, '');\n  const cssContent = content.replace(/<<<PATH>>>/g, mediaPath);\n  // Cleanup the collected css content after injecting it to the DOM.\n  content = '';\n\n  // Inject CSS tag at start of head.\n  const cssNode = document.createElement('style');\n  cssNode.id = 'blockly-common-style';\n  const cssTextNode = document.createTextNode(cssContent);\n  cssNode.appendChild(cssTextNode);\n  document.head.insertBefore(cssNode, document.head.firstChild);\n}\n\n/**\n * The CSS content for Blockly.\n */\nlet content = `\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n}\n\n.blocklyNonSelectable {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n  overflow: auto;\n  overflow-x: hidden;\n  position: relative;\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n}\n\n.blocklyDropDownButton {\n  display: inline-block;\n  float: left;\n  padding: 0;\n  margin: 4px;\n  border-radius: 4px;\n  outline: none;\n  border: 1px solid;\n  transition: box-shadow .1s;\n  cursor: pointer;\n}\n\n.blocklyArrowTop {\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyArrowBottom {\n  border-bottom: 1px solid;\n  border-right: 1px solid;\n  border-bottom-right-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyResizeSE {\n  cursor: se-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeSW {\n  cursor: sw-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeLine {\n  stroke: #515A5A;\n  stroke-width: 1;\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n.blocklyDragging {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n  /* Drag surface disables events to not block the toolbox, so we have to\n   * reenable them here for the cursor values to work. */\n  pointer-events: auto;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url(\"<<<PATH>>>/handdelete.cur\"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabled>.blocklyPath {\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyMultilineText {\n  font-family: monospace;\n}\n\n.blocklyNonEditableText>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don't allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyHidden {\n  display: none;\n}\n\n.blocklyFieldDropdown:not(.blocklyHidden) {\n  display: block;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n  height: 100%;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Remove the increase and decrease arrows on the field number editor */\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px \"Helvetica Neue\", Helvetica, sans-serif;\n  outline: none;\n  position: relative;  /* Compatibility with gapi, reset from goog-menu */\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n\n.blocklyBlockDragSurface, .blocklyAnimationLayer {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 80;\n  pointer-events: none;\n}\n`;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.dom\n\nimport type {Svg} from './svg.js';\n\n/**\n * Required name space for SVG elements.\n */\nexport const SVG_NS = 'http://www.w3.org/2000/svg';\n\n/**\n * Required name space for HTML elements.\n */\nexport const HTML_NS = 'http://www.w3.org/1999/xhtml';\n\n/**\n * Required name space for XLINK elements.\n */\nexport const XLINK_NS = 'http://www.w3.org/1999/xlink';\n\n/**\n * Node type constants.\n * https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType\n */\nexport enum NodeType {\n  ELEMENT_NODE = 1,\n  TEXT_NODE = 3,\n  COMMENT_NODE = 8,\n}\n\n/** Temporary cache of text widths. */\nlet cacheWidths: {[key: string]: number} | null = null;\n\n/** Number of current references to cache. */\nlet cacheReference = 0;\n\n/** A HTML canvas context used for computing text width. */\nlet canvasContext: CanvasRenderingContext2D | null = null;\n\n/**\n * Helper method for creating SVG elements.\n *\n * @param name Element's tag name.\n * @param attrs Dictionary of attribute names and values.\n * @param opt_parent Optional parent on which to append the element.\n * @returns if name is a string or a more specific type if it a member of Svg.\n */\nexport function createSvgElement<T extends SVGElement>(\n  name: string | Svg<T>,\n  attrs: {[key: string]: string | number},\n  opt_parent?: Element | null,\n): T {\n  const e = document.createElementNS(SVG_NS, `${name}`) as T;\n  for (const key in attrs) {\n    e.setAttribute(key, `${attrs[key]}`);\n  }\n  if (opt_parent) {\n    opt_parent.appendChild(e);\n  }\n  return e;\n}\n\n/**\n * Add a CSS class to a element.\n *\n * Handles multiple space-separated classes for legacy reasons.\n *\n * @param element DOM element to add class to.\n * @param className Name of class to add.\n * @returns True if class was added, false if already present.\n */\nexport function addClass(element: Element, className: string): boolean {\n  const classNames = className.split(' ');\n  if (classNames.every((name) => element.classList.contains(name))) {\n    return false;\n  }\n  element.classList.add(...classNames);\n  return true;\n}\n\n/**\n * Removes multiple classes from an element.\n *\n * @param element DOM element to remove classes from.\n * @param classNames A string of one or multiple class names for an element.\n */\nexport function removeClasses(element: Element, classNames: string) {\n  element.classList.remove(...classNames.split(' '));\n}\n\n/**\n * Remove a CSS class from a element.\n *\n * Handles multiple space-separated classes for legacy reasons.\n *\n * @param element DOM element to remove class from.\n * @param className Name of class to remove.\n * @returns True if class was removed, false if never present.\n */\nexport function removeClass(element: Element, className: string): boolean {\n  const classNames = className.split(' ');\n  if (classNames.every((name) => !element.classList.contains(name))) {\n    return false;\n  }\n  element.classList.remove(...classNames);\n  return true;\n}\n\n/**\n * Checks if an element has the specified CSS class.\n *\n * @param element DOM element to check.\n * @param className Name of class to check.\n * @returns True if class exists, false otherwise.\n */\nexport function hasClass(element: Element, className: string): boolean {\n  return element.classList.contains(className);\n}\n\n/**\n * Removes a node from its parent. No-op if not attached to a parent.\n *\n * @param node The node to remove.\n * @returns The node removed if removed; else, null.\n */\n// Copied from Closure goog.dom.removeNode\nexport function removeNode(node: Node | null): Node | null {\n  return node && node.parentNode ? node.parentNode.removeChild(node) : null;\n}\n\n/**\n * Insert a node after a reference node.\n * Contrast with node.insertBefore function.\n *\n * @param newNode New element to insert.\n * @param refNode Existing element to precede new node.\n */\nexport function insertAfter(newNode: Element, refNode: Element) {\n  const siblingNode = refNode.nextSibling;\n  const parentNode = refNode.parentNode;\n  if (!parentNode) {\n    throw Error('Reference node has no parent.');\n  }\n  if (siblingNode) {\n    parentNode.insertBefore(newNode, siblingNode);\n  } else {\n    parentNode.appendChild(newNode);\n  }\n}\n\n/**\n * Sets the CSS transform property on an element. This function sets the\n * non-vendor-prefixed and vendor-prefixed versions for backwards compatibility\n * with older browsers. See https://caniuse.com/#feat=transforms2d\n *\n * @param element Element to which the CSS transform will be applied.\n * @param transform The value of the CSS `transform` property.\n */\nexport function setCssTransform(\n  element: HTMLElement | SVGElement,\n  transform: string,\n) {\n  element.style['transform'] = transform;\n  element.style['-webkit-transform' as any] = transform;\n}\n\n/**\n * Start caching text widths. Every call to this function MUST also call\n * stopTextWidthCache. Caches must not survive between execution threads.\n */\nexport function startTextWidthCache() {\n  cacheReference++;\n  if (!cacheWidths) {\n    cacheWidths = Object.create(null);\n  }\n}\n\n/**\n * Stop caching field widths. Unless caching was already on when the\n * corresponding call to startTextWidthCache was made.\n */\nexport function stopTextWidthCache() {\n  cacheReference--;\n  if (!cacheReference) {\n    cacheWidths = null;\n  }\n}\n\n/**\n * Gets the width of a text element, caching it in the process.\n *\n * @param textElement An SVG 'text' element.\n * @returns Width of element.\n */\nexport function getTextWidth(textElement: SVGTextElement): number {\n  const key = textElement.textContent + '\\n' + textElement.className.baseVal;\n  let width;\n  // Return the cached width if it exists.\n  if (cacheWidths) {\n    width = cacheWidths[key];\n    if (width) {\n      return width;\n    }\n  }\n\n  // Attempt to compute fetch the width of the SVG text element.\n  try {\n    width = textElement.getComputedTextLength();\n  } catch (e) {\n    // In other cases where we fail to get the computed text. Instead, use an\n    // approximation and do not cache the result. At some later point in time\n    // when the block is inserted into the visible DOM, this method will be\n    // called again and, at that point in time, will not throw an exception.\n    return textElement.textContent!.length * 8;\n  }\n\n  // Cache the computed width and return.\n  if (cacheWidths) {\n    cacheWidths[key] = width;\n  }\n  return width;\n}\n\n/**\n * Gets the width of a text element using a faster method than `getTextWidth`.\n * This method requires that we know the text element's font family and size in\n * advance. Similar to `getTextWidth`, we cache the width we compute.\n *\n * @param textElement An SVG 'text' element.\n * @param fontSize The font size to use.\n * @param fontWeight The font weight to use.\n * @param fontFamily The font family to use.\n * @returns Width of element.\n */\nexport function getFastTextWidth(\n  textElement: SVGTextElement,\n  fontSize: number,\n  fontWeight: string,\n  fontFamily: string,\n): number {\n  return getFastTextWidthWithSizeString(\n    textElement,\n    fontSize + 'pt',\n    fontWeight,\n    fontFamily,\n  );\n}\n\n/**\n * Gets the width of a text element using a faster method than `getTextWidth`.\n * This method requires that we know the text element's font family and size in\n * advance. Similar to `getTextWidth`, we cache the width we compute.\n * This method is similar to `getFastTextWidth` but expects the font size\n * parameter to be a string.\n *\n * @param textElement An SVG 'text' element.\n * @param fontSize The font size to use.\n * @param fontWeight The font weight to use.\n * @param fontFamily The font family to use.\n * @returns Width of element.\n */\nexport function getFastTextWidthWithSizeString(\n  textElement: SVGTextElement,\n  fontSize: string,\n  fontWeight: string,\n  fontFamily: string,\n): number {\n  const text = textElement.textContent;\n  const key = text + '\\n' + textElement.className.baseVal;\n  let width;\n\n  // Return the cached width if it exists.\n  if (cacheWidths) {\n    width = cacheWidths[key];\n    if (width) {\n      return width;\n    }\n  }\n\n  if (!canvasContext) {\n    // Inject the canvas element used for computing text widths.\n    const computeCanvas = document.createElement('canvas');\n    computeCanvas.className = 'blocklyComputeCanvas';\n    document.body.appendChild(computeCanvas);\n\n    // Initialize the HTML canvas context and set the font.\n    // The context font must match blocklyText's fontsize and font-family\n    // set in CSS.\n    canvasContext = computeCanvas.getContext('2d') as CanvasRenderingContext2D;\n  }\n  // Set the desired font size and family.\n  canvasContext.font = fontWeight + ' ' + fontSize + ' ' + fontFamily;\n\n  // Measure the text width using the helper canvas context.\n  if (text) {\n    width = canvasContext.measureText(text).width;\n  } else {\n    width = 0;\n  }\n\n  // Cache the computed width and return.\n  if (cacheWidths) {\n    cacheWidths[key] = width;\n  }\n  return width;\n}\n\n/**\n * Measure a font's metrics. The height and baseline values.\n *\n * @param text Text to measure the font dimensions of.\n * @param fontSize The font size to use.\n * @param fontWeight The font weight to use.\n * @param fontFamily The font family to use.\n * @returns Font measurements.\n */\nexport function measureFontMetrics(\n  text: string,\n  fontSize: string,\n  fontWeight: string,\n  fontFamily: string,\n): {height: number; baseline: number} {\n  const span = document.createElement('span');\n  span.style.font = fontWeight + ' ' + fontSize + ' ' + fontFamily;\n  span.textContent = text;\n\n  const block = document.createElement('div');\n  block.style.width = '1px';\n  block.style.height = '0';\n\n  const div = document.createElement('div');\n  div.style.display = 'flex';\n  div.style.position = 'fixed';\n  div.style.top = '0';\n  div.style.left = '0';\n  div.appendChild(span);\n  div.appendChild(block);\n\n  document.body.appendChild(div);\n  const result = {\n    height: 0,\n    baseline: 0,\n  };\n  try {\n    div.style.alignItems = 'baseline';\n    result.baseline = block.offsetTop - span.offsetTop;\n    div.style.alignItems = 'flex-end';\n    result.height = block.offsetTop - span.offsetTop;\n  } finally {\n    document.body.removeChild(div);\n  }\n  return result;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.style\n\nimport {Coordinate} from './coordinate.js';\nimport {Rect} from './rect.js';\nimport {Size} from './size.js';\n\n/**\n * Gets the height and width of an element.\n * Similar to Closure's goog.style.getSize\n *\n * @param element Element to get size of.\n * @returns Object with width/height properties.\n */\nexport function getSize(element: Element): Size {\n  return TEST_ONLY.getSizeInternal(element);\n}\n\n/**\n * Private version of getSize for stubbing in tests.\n */\nfunction getSizeInternal(element: Element): Size {\n  if (getComputedStyle(element, 'display') !== 'none') {\n    return getSizeWithDisplay(element);\n  }\n\n  // Evaluate size with a temporary element.\n  // AnyDuringMigration because:  Property 'style' does not exist on type\n  // 'Element'.\n  const style = (element as AnyDuringMigration).style;\n  const originalDisplay = style.display;\n  const originalVisibility = style.visibility;\n  const originalPosition = style.position;\n\n  style.visibility = 'hidden';\n  style.position = 'absolute';\n  style.display = 'inline';\n\n  const offsetWidth = (element as HTMLElement).offsetWidth;\n  const offsetHeight = (element as HTMLElement).offsetHeight;\n\n  style.display = originalDisplay;\n  style.position = originalPosition;\n  style.visibility = originalVisibility;\n\n  return new Size(offsetWidth, offsetHeight);\n}\n\n/**\n * Gets the height and width of an element when the display is not none.\n *\n * @param element Element to get size of.\n * @returns Object with width/height properties.\n */\nfunction getSizeWithDisplay(element: Element): Size {\n  const offsetWidth = (element as HTMLElement).offsetWidth;\n  const offsetHeight = (element as HTMLElement).offsetHeight;\n  return new Size(offsetWidth, offsetHeight);\n}\n\n/**\n * Retrieves a computed style value of a node. It returns empty string\n * if the property requested is an SVG one and it has not been\n * explicitly set (firefox and webkit).\n *\n * Copied from Closure's goog.style.getComputedStyle\n *\n * @param element Element to get style of.\n * @param property Property to get (camel-case).\n * @returns Style value.\n */\nexport function getComputedStyle(element: Element, property: string): string {\n  const styles = window.getComputedStyle(element);\n  // element.style[..] is undefined for browser specific styles\n  // as 'filter'.\n  return (\n    (styles as AnyDuringMigration)[property] ||\n    styles.getPropertyValue(property)\n  );\n}\n\n/**\n * Returns a Coordinate object relative to the top-left of the HTML document.\n * Similar to Closure's goog.style.getPageOffset\n *\n * @param el Element to get the page offset for.\n * @returns The page offset.\n */\nexport function getPageOffset(el: Element): Coordinate {\n  const pos = new Coordinate(0, 0);\n  const box = el.getBoundingClientRect();\n  const documentElement = document.documentElement;\n  // Must add the scroll coordinates in to get the absolute page offset\n  // of element since getBoundingClientRect returns relative coordinates to\n  // the viewport.\n  const scrollCoord = new Coordinate(\n    window.pageXOffset || documentElement.scrollLeft,\n    window.pageYOffset || documentElement.scrollTop,\n  );\n  pos.x = box.left + scrollCoord.x;\n  pos.y = box.top + scrollCoord.y;\n\n  return pos;\n}\n\n/**\n * Calculates the viewport coordinates relative to the document.\n * Similar to Closure's goog.style.getViewportPageOffset\n *\n * @returns The page offset of the viewport.\n */\nexport function getViewportPageOffset(): Coordinate {\n  const body = document.body;\n  const documentElement = document.documentElement;\n  const scrollLeft = body.scrollLeft || documentElement.scrollLeft;\n  const scrollTop = body.scrollTop || documentElement.scrollTop;\n  return new Coordinate(scrollLeft, scrollTop);\n}\n\n/**\n * Gets the computed border widths (on all sides) in pixels\n * Copied from Closure's goog.style.getBorderBox\n *\n * @param element  The element to get the border widths for.\n * @returns The computed border widths.\n */\nexport function getBorderBox(element: Element): Rect {\n  const left = parseFloat(getComputedStyle(element, 'borderLeftWidth'));\n  const right = parseFloat(getComputedStyle(element, 'borderRightWidth'));\n  const top = parseFloat(getComputedStyle(element, 'borderTopWidth'));\n  const bottom = parseFloat(getComputedStyle(element, 'borderBottomWidth'));\n\n  return new Rect(top, bottom, left, right);\n}\n\n/**\n * Changes the scroll position of `container` with the minimum amount so\n * that the content and the borders of the given `element` become visible.\n * If the element is bigger than the container, its top left corner will be\n * aligned as close to the container's top left corner as possible.\n * Copied from Closure's goog.style.scrollIntoContainerView\n *\n * @param element The element to make visible.\n * @param container The container to scroll. If not set, then the document\n *     scroll element will be used.\n * @param opt_center Whether to center the element in the container.\n *     Defaults to false.\n */\nexport function scrollIntoContainerView(\n  element: Element,\n  container: Element,\n  opt_center?: boolean,\n) {\n  const offset = getContainerOffsetToScrollInto(element, container, opt_center);\n  container.scrollLeft = offset.x;\n  container.scrollTop = offset.y;\n}\n\n/**\n * Calculate the scroll position of `container` with the minimum amount so\n * that the content and the borders of the given `element` become visible.\n * If the element is bigger than the container, its top left corner will be\n * aligned as close to the container's top left corner as possible.\n * Copied from Closure's goog.style.getContainerOffsetToScrollInto\n *\n * @param element The element to make visible.\n * @param container The container to scroll. If not set, then the document\n *     scroll element will be used.\n * @param opt_center Whether to center the element in the container.\n *     Defaults to false.\n * @returns The new scroll position of the container.\n */\nexport function getContainerOffsetToScrollInto(\n  element: Element,\n  container: Element,\n  opt_center?: boolean,\n): Coordinate {\n  // Absolute position of the element's border's top left corner.\n  const elementPos = getPageOffset(element);\n  // Absolute position of the container's border's top left corner.\n  const containerPos = getPageOffset(container);\n  const containerBorder = getBorderBox(container);\n  // Relative pos. of the element's border box to the container's content box.\n  const relX = elementPos.x - containerPos.x - containerBorder.left;\n  const relY = elementPos.y - containerPos.y - containerBorder.top;\n  // How much the element can move in the container, i.e. the difference between\n  // the element's bottom-right-most and top-left-most position where it's\n  // fully visible.\n  const elementSize = getSizeWithDisplay(element);\n  const spaceX = container.clientWidth - elementSize.width;\n  const spaceY = container.clientHeight - elementSize.height;\n  let scrollLeft = container.scrollLeft;\n  let scrollTop = container.scrollTop;\n  if (opt_center) {\n    // All browsers round non-integer scroll positions down.\n    scrollLeft += relX - spaceX / 2;\n    scrollTop += relY - spaceY / 2;\n  } else {\n    // This formula was designed to give the correct scroll values in the\n    // following cases:\n    // - element is higher than container (spaceY < 0) => scroll down by relY\n    // - element is not higher that container (spaceY >= 0):\n    //   - it is above container (relY < 0) => scroll up by abs(relY)\n    //   - it is below container (relY > spaceY) => scroll down by relY - spaceY\n    //   - it is in the container => don't scroll\n    scrollLeft += Math.min(relX, Math.max(relX - spaceX, 0));\n    scrollTop += Math.min(relY, Math.max(relY - spaceY, 0));\n  }\n  return new Coordinate(scrollLeft, scrollTop);\n}\n\nexport const TEST_ONLY = {\n  getSizeInternal,\n};\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.svgMath\n\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\nimport {Coordinate} from './coordinate.js';\nimport {Rect} from './rect.js';\nimport * as style from './style.js';\n\n/**\n * Static regex to pull the x,y values out of an SVG translate() directive.\n * Note that Firefox and IE (9,10) return 'translate(12)' instead of\n * 'translate(12, 0)'.\n * Note that IE (9,10) returns 'translate(16 8)' instead of 'translate(16, 8)'.\n * Note that IE has been reported to return scientific notation (0.123456e-42).\n */\nconst XY_REGEX = /translate\\(\\s*([-+\\d.e]+)([ ,]\\s*([-+\\d.e]+)\\s*)?/;\n\n/**\n * Static regex to pull the x,y values out of a translate() or translate3d()\n * style property.\n * Accounts for same exceptions as XY_REGEX.\n */\nconst XY_STYLE_REGEX =\n  /transform:\\s*translate(?:3d)?\\(\\s*([-+\\d.e]+)\\s*px([ ,]\\s*([-+\\d.e]+)\\s*px)?/;\n\n/**\n * Return the coordinates of the top-left corner of this element relative to\n * its parent.  Only for SVG elements and children (e.g. rect, g, path).\n *\n * @param element SVG element to find the coordinates of.\n * @returns Object with .x and .y properties.\n */\nexport function getRelativeXY(element: Element): Coordinate {\n  const xy = new Coordinate(0, 0);\n  // First, check for x and y attributes.\n  // Checking for the existence of x/y properties is faster than getAttribute.\n  // However, x/y contains an SVGAnimatedLength object, so rely on getAttribute\n  // to get the number.\n  const x = (element as any).x && element.getAttribute('x');\n  const y = (element as any).y && element.getAttribute('y');\n  if (x) {\n    xy.x = parseInt(x);\n  }\n  if (y) {\n    xy.y = parseInt(y);\n  }\n  // Second, check for transform=\"translate(...)\" attribute.\n  const transform = element.getAttribute('transform');\n  const r = transform && transform.match(XY_REGEX);\n  if (r) {\n    xy.x += Number(r[1]);\n    if (r[3]) {\n      xy.y += Number(r[3]);\n    }\n  }\n\n  // Then check for style = transform: translate(...) or translate3d(...)\n  const style = element.getAttribute('style');\n  if (style && style.includes('translate')) {\n    const styleComponents = style.match(XY_STYLE_REGEX);\n    if (styleComponents) {\n      xy.x += Number(styleComponents[1]);\n      if (styleComponents[3]) {\n        xy.y += Number(styleComponents[3]);\n      }\n    }\n  }\n  return xy;\n}\n\n/**\n * Return the coordinates of the top-left corner of this element relative to\n * the div Blockly was injected into.\n *\n * @param element SVG element to find the coordinates of. If this is not a child\n *     of the div Blockly was injected into, the behaviour is undefined.\n * @returns Object with .x and .y properties.\n */\nexport function getInjectionDivXY(element: Element): Coordinate {\n  let x = 0;\n  let y = 0;\n  while (element) {\n    const xy = getRelativeXY(element);\n    x += xy.x;\n    y += xy.y;\n    const classes = element.getAttribute('class') || '';\n    if ((' ' + classes + ' ').includes(' injectionDiv ')) {\n      break;\n    }\n    element = element.parentNode as Element;\n  }\n  return new Coordinate(x, y);\n}\n\n/**\n * Get the position of the current viewport in window coordinates.  This takes\n * scroll into account.\n *\n * @returns An object containing window width, height, and scroll position in\n *     window coordinates.\n * @internal\n */\nexport function getViewportBBox(): Rect {\n  // Pixels, in window coordinates.\n  const scrollOffset = style.getViewportPageOffset();\n  return new Rect(\n    scrollOffset.y,\n    document.documentElement.clientHeight + scrollOffset.y,\n    scrollOffset.x,\n    document.documentElement.clientWidth + scrollOffset.x,\n  );\n}\n\n/**\n * Gets the document scroll distance as a coordinate object.\n * Copied from Closure's goog.dom.getDocumentScroll.\n *\n * @returns Object with values 'x' and 'y'.\n */\nexport function getDocumentScroll(): Coordinate {\n  const el = document.documentElement;\n  const win = window;\n  return new Coordinate(\n    win.pageXOffset || el.scrollLeft,\n    win.pageYOffset || el.scrollTop,\n  );\n}\n\n/**\n * Converts screen coordinates to workspace coordinates.\n *\n * @param ws The workspace to find the coordinates on.\n * @param screenCoordinates The screen coordinates to be converted to workspace\n *     coordinates\n * @returns The workspace coordinates.\n */\nexport function screenToWsCoordinates(\n  ws: WorkspaceSvg,\n  screenCoordinates: Coordinate,\n): Coordinate {\n  const screenX = screenCoordinates.x;\n  const screenY = screenCoordinates.y;\n\n  const injectionDiv = ws.getInjectionDiv();\n  // Bounding rect coordinates are in client coordinates, meaning that they\n  // are in pixels relative to the upper left corner of the visible browser\n  // window.  These coordinates change when you scroll the browser window.\n  const boundingRect = injectionDiv.getBoundingClientRect();\n\n  // The client coordinates offset by the injection div's upper left corner.\n  const clientOffsetPixels = new Coordinate(\n    screenX - boundingRect.left,\n    screenY - boundingRect.top,\n  );\n\n  // The offset in pixels between the main workspace's origin and the upper\n  // left corner of the injection div.\n  const mainOffsetPixels = ws.getOriginOffsetInPixels();\n\n  // The position of the new comment in pixels relative to the origin of the\n  // main workspace.\n  const finalOffsetPixels = Coordinate.difference(\n    clientOffsetPixels,\n    mainOffsetPixels,\n  );\n  // The position in main workspace coordinates.\n  const finalOffsetMainWs = finalOffsetPixels.scale(1 / ws.scale);\n  return finalOffsetMainWs;\n}\n\n/**\n * Converts workspace coordinates to screen coordinates.\n *\n * @param ws The workspace to get the coordinates out of.\n * @param workspaceCoordinates  The workspace coordinates to be converted\n *     to screen coordinates.\n * @returns The screen coordinates.\n */\nexport function wsToScreenCoordinates(\n  ws: WorkspaceSvg,\n  workspaceCoordinates: Coordinate,\n): Coordinate {\n  // Fix workspace scale vs browser scale.\n  const screenCoordinates = workspaceCoordinates.scale(ws.scale);\n  const screenX = screenCoordinates.x;\n  const screenY = screenCoordinates.y;\n\n  const injectionDiv = ws.getInjectionDiv();\n  const boundingRect = injectionDiv.getBoundingClientRect();\n  const mainOffset = ws.getOriginOffsetInPixels();\n\n  // Fix workspace origin vs browser origin.\n  return new Coordinate(\n    screenX + boundingRect.left + mainOffset.x,\n    screenY + boundingRect.top + mainOffset.y,\n  );\n}\n\nexport const TEST_ONLY = {\n  XY_REGEX,\n  XY_STYLE_REGEX,\n};\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.xml\n\nlet domParser: DOMParser = {\n  parseFromString: function () {\n    throw new Error(\n      'DOMParser was not found in the global scope and was not properly ' +\n        'injected using injectDependencies',\n    );\n  },\n};\n\nlet xmlSerializer: XMLSerializer = {\n  serializeToString: function () {\n    throw new Error(\n      'XMLSerializer was not foundin the global scope and was not properly ' +\n        'injected using injectDependencies',\n    );\n  },\n};\n\n/**\n * Injected dependencies.  By default these are just (and have the\n * same types as) the corresponding DOM Window properties, but the\n * Node.js wrapper for Blockly (see scripts/package/node/core.js)\n * calls injectDependencies to supply implementations from the jsdom\n * package instead.\n */\nlet {document, DOMParser, XMLSerializer} = globalThis;\nif (DOMParser) domParser = new DOMParser();\nif (XMLSerializer) xmlSerializer = new XMLSerializer();\n\n/**\n * Inject implementations of document, DOMParser and/or XMLSerializer\n * to use instead of the default ones.\n *\n * Used by the Node.js wrapper for Blockly (see\n * scripts/package/node/core.js) to supply implementations from the\n * jsdom package instead.\n *\n * While they may be set individually, it is normally the case that\n * all three will be sourced from the same JSDOM instance.  They MUST\n * at least come from the same copy of the jsdom package.  (Typically\n * this is hard to avoid satsifying this requirement, but it can be\n * inadvertently violated by using webpack to build multiple bundles\n * containing Blockly and jsdom, and then loading more than one into\n * the same JavaScript runtime.  See\n * https://github.com/google/blockly-samples/pull/1452#issuecomment-1364442135\n * for an example of how this happened.)\n *\n * @param dependencies Options object containing dependencies to set.\n */\nexport function injectDependencies(dependencies: {\n  document?: Document;\n  DOMParser?: typeof DOMParser;\n  XMLSerializer?: typeof XMLSerializer;\n}) {\n  ({\n    // Default to existing value if option not supplied.\n    document = document,\n    DOMParser = DOMParser,\n    XMLSerializer = XMLSerializer,\n  } = dependencies);\n\n  domParser = new DOMParser();\n  xmlSerializer = new XMLSerializer();\n}\n\n/**\n * Namespace for Blockly's XML.\n */\nexport const NAME_SPACE = 'https://developers.google.com/blockly/xml';\n\n// eslint-disable-next-line no-control-regex\nconst INVALID_CONTROL_CHARS = /[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F]/g;\n\n/**\n * Create DOM element for XML.\n *\n * @param tagName Name of DOM element.\n * @returns New DOM element.\n */\nexport function createElement(tagName: string): Element {\n  return document.createElementNS(NAME_SPACE, tagName);\n}\n\n/**\n * Create text element for XML.\n *\n * @param text Text content.\n * @returns New DOM text node.\n */\nexport function createTextNode(text: string): Text {\n  return document.createTextNode(text);\n}\n\n/**\n * Converts an XML string into a DOM structure.\n *\n * Control characters should be escaped. (But we will try to best-effort parse\n * unescaped characters.)\n *\n * Note that even when escaped, U+0000 will be parsed as U+FFFD (the\n * \"replacement character\") because U+0000 is never a valid XML character\n * (even in XML 1.1).\n * https://www.w3.org/TR/xml11/#charsets\n *\n * @param text An XML string.\n * @returns A DOM object representing the singular child of the document\n *     element.\n * @throws if the text doesn't parse.\n */\nexport function textToDom(text: string): Element {\n  let doc = domParser.parseFromString(text, 'text/xml');\n  if (\n    doc &&\n    doc.documentElement &&\n    !doc.getElementsByTagName('parsererror').length\n  ) {\n    return doc.documentElement;\n  }\n\n  // Attempt to parse as HTML to deserialize control characters that were\n  // serialized before the serializer did proper escaping.\n  doc = domParser.parseFromString(text, 'text/html');\n  if (\n    doc &&\n    doc.body.firstChild &&\n    doc.body.firstChild.nodeName.toLowerCase() === 'xml'\n  ) {\n    return doc.body.firstChild as Element;\n  }\n\n  throw new Error(`DOMParser was unable to parse: ${text}`);\n}\n\n/**\n * Converts a DOM structure into plain text.\n * Currently the text format is fairly ugly: all one line with no whitespace.\n *\n * Control characters are escaped using their decimal encodings. This includes\n * U+0000 even though it is technically never a valid XML character (even in\n * XML 1.1).\n * https://www.w3.org/TR/xml11/#charsets\n *\n * When decoded U+0000 will be parsed as U+FFFD (the \"replacement character\").\n *\n * @param dom A tree of XML nodes.\n * @returns Text representation.\n */\nexport function domToText(dom: Node): string {\n  return sanitizeText(xmlSerializer.serializeToString(dom));\n}\n\nfunction sanitizeText(text: string) {\n  return text.replace(\n    INVALID_CONTROL_CHARS,\n    (match) => `&#${match.charCodeAt(0)};`,\n  );\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.toolbox\n\nimport type {ConnectionState} from '../serialization/blocks.js';\nimport type {CssConfig as CategoryCssConfig} from '../toolbox/category.js';\nimport type {CssConfig as SeparatorCssConfig} from '../toolbox/separator.js';\nimport * as utilsXml from './xml.js';\n\n/**\n * The information needed to create a block in the toolbox.\n * Note that disabled has a different type for backwards compatibility.\n */\nexport interface BlockInfo {\n  kind: string;\n  blockxml?: string | Node;\n  type?: string;\n  gap?: string | number;\n  disabled?: string | boolean;\n  disabledReasons?: string[];\n  enabled?: boolean;\n  id?: string;\n  x?: number;\n  y?: number;\n  collapsed?: boolean;\n  inline?: boolean;\n  data?: string;\n  extraState?: AnyDuringMigration;\n  icons?: {[key: string]: AnyDuringMigration};\n  fields?: {[key: string]: AnyDuringMigration};\n  inputs?: {[key: string]: ConnectionState};\n  next?: ConnectionState;\n}\n\n/**\n * The information needed to create a separator in the toolbox.\n */\nexport interface SeparatorInfo {\n  kind: string;\n  id: string | undefined;\n  gap: number | undefined;\n  cssconfig: SeparatorCssConfig | undefined;\n}\n\n/**\n * The information needed to create a button in the toolbox.\n */\nexport interface ButtonInfo {\n  kind: string;\n  text: string;\n  callbackkey: string;\n}\n\n/**\n * The information needed to create a label in the toolbox.\n */\nexport interface LabelInfo {\n  kind: string;\n  text: string;\n  id: string | undefined;\n}\n\n/**\n * The information needed to create either a button or a label in the flyout.\n */\nexport type ButtonOrLabelInfo = ButtonInfo | LabelInfo;\n\n/**\n * The information needed to create a category in the toolbox.\n */\nexport interface StaticCategoryInfo {\n  kind: string;\n  name: string;\n  contents: ToolboxItemInfo[];\n  id: string | undefined;\n  categorystyle: string | undefined;\n  colour: string | undefined;\n  cssconfig: CategoryCssConfig | undefined;\n  hidden: string | undefined;\n  expanded?: string | boolean;\n}\n\n/**\n * The information needed to create a custom category.\n */\nexport interface DynamicCategoryInfo {\n  kind: string;\n  custom: string;\n  id: string | undefined;\n  categorystyle: string | undefined;\n  colour: string | undefined;\n  cssconfig: CategoryCssConfig | undefined;\n  hidden: string | undefined;\n  expanded?: string | boolean;\n}\n\n/**\n * The information needed to create either a dynamic or static category.\n */\nexport type CategoryInfo = StaticCategoryInfo | DynamicCategoryInfo;\n\n/**\n * Any information that can be used to create an item in the toolbox.\n */\nexport type ToolboxItemInfo = FlyoutItemInfo | StaticCategoryInfo;\n\n/**\n * All the different types that can be displayed in a flyout.\n */\nexport type FlyoutItemInfo =\n  | BlockInfo\n  | SeparatorInfo\n  | ButtonInfo\n  | LabelInfo\n  | DynamicCategoryInfo;\n\n/**\n * The JSON definition of a toolbox.\n */\nexport interface ToolboxInfo {\n  kind?: string;\n  contents: ToolboxItemInfo[];\n}\n\n/**\n * An array holding flyout items.\n */\nexport type FlyoutItemInfoArray = FlyoutItemInfo[];\n\n/**\n * All of the different types that can create a toolbox.\n */\nexport type ToolboxDefinition = Node | ToolboxInfo | string;\n\n/**\n * All of the different types that can be used to show items in a flyout.\n */\nexport type FlyoutDefinition =\n  | FlyoutItemInfoArray\n  | NodeList\n  | ToolboxInfo\n  | Node[];\n\n/**\n * The name used to identify a toolbox that has category like items.\n * This only needs to be used if a toolbox wants to be treated like a category\n * toolbox but does not actually contain any toolbox items with the kind\n * 'category'.\n */\nconst CATEGORY_TOOLBOX_KIND = 'categoryToolbox';\n\n/**\n * The name used to identify a toolbox that has no categories and is displayed\n * as a simple flyout displaying blocks, buttons, or labels.\n */\nconst FLYOUT_TOOLBOX_KIND = 'flyoutToolbox';\n\n/**\n * Position of the toolbox and/or flyout relative to the workspace.\n */\nexport enum Position {\n  TOP,\n  BOTTOM,\n  LEFT,\n  RIGHT,\n}\n\n/**\n * Converts the toolbox definition into toolbox JSON.\n *\n * @param toolboxDef The definition of the toolbox in one of its many forms.\n * @returns Object holding information for creating a toolbox.\n * @internal\n */\nexport function convertToolboxDefToJson(\n  toolboxDef: ToolboxDefinition | null,\n): ToolboxInfo | null {\n  if (!toolboxDef) {\n    return null;\n  }\n\n  if (toolboxDef instanceof Element || typeof toolboxDef === 'string') {\n    toolboxDef = parseToolboxTree(toolboxDef);\n    // AnyDuringMigration because:  Argument of type 'Node | null' is not\n    // assignable to parameter of type 'Node'.\n    toolboxDef = convertToToolboxJson(toolboxDef as AnyDuringMigration);\n  }\n\n  const toolboxJson = toolboxDef as ToolboxInfo;\n  validateToolbox(toolboxJson);\n  return toolboxJson;\n}\n\n/**\n * Validates the toolbox JSON fields have been set correctly.\n *\n * @param toolboxJson Object holding information for creating a toolbox.\n * @throws {Error} if the toolbox is not the correct format.\n */\nfunction validateToolbox(toolboxJson: ToolboxInfo) {\n  const toolboxKind = toolboxJson['kind'];\n  const toolboxContents = toolboxJson['contents'];\n\n  if (toolboxKind) {\n    if (\n      toolboxKind !== FLYOUT_TOOLBOX_KIND &&\n      toolboxKind !== CATEGORY_TOOLBOX_KIND\n    ) {\n      throw Error(\n        'Invalid toolbox kind ' +\n          toolboxKind +\n          '.' +\n          ' Please supply either ' +\n          FLYOUT_TOOLBOX_KIND +\n          ' or ' +\n          CATEGORY_TOOLBOX_KIND,\n      );\n    }\n  }\n  if (!toolboxContents) {\n    throw Error('Toolbox must have a contents attribute.');\n  }\n}\n\n/**\n * Converts the flyout definition into a list of flyout items.\n *\n * @param flyoutDef The definition of the flyout in one of its many forms.\n * @returns A list of flyout items.\n * @internal\n */\nexport function convertFlyoutDefToJsonArray(\n  flyoutDef: FlyoutDefinition | null,\n): FlyoutItemInfoArray {\n  if (!flyoutDef) {\n    return [];\n  }\n\n  if ((flyoutDef as AnyDuringMigration)['contents']) {\n    return (flyoutDef as AnyDuringMigration)['contents'];\n  }\n  // If it is already in the correct format return the flyoutDef.\n  // AnyDuringMigration because:  Property 'nodeType' does not exist on type\n  // 'Node | FlyoutItemInfo'.\n  if (\n    Array.isArray(flyoutDef) &&\n    flyoutDef.length > 0 &&\n    !(flyoutDef[0] as AnyDuringMigration).nodeType\n  ) {\n    // AnyDuringMigration because:  Type 'FlyoutItemInfoArray | Node[]' is not\n    // assignable to type 'FlyoutItemInfoArray'.\n    return flyoutDef as AnyDuringMigration;\n  }\n\n  // AnyDuringMigration because:  Type 'ToolboxItemInfo[] | FlyoutItemInfoArray'\n  // is not assignable to type 'FlyoutItemInfoArray'.\n  return xmlToJsonArray(flyoutDef as Node[] | NodeList) as AnyDuringMigration;\n}\n\n/**\n * Whether or not the toolbox definition has categories.\n *\n * @param toolboxJson Object holding information for creating a toolbox.\n * @returns True if the toolbox has categories.\n * @internal\n */\nexport function hasCategories(toolboxJson: ToolboxInfo | null): boolean {\n  return TEST_ONLY.hasCategoriesInternal(toolboxJson);\n}\n\n/**\n * Private version of hasCategories for stubbing in tests.\n */\nfunction hasCategoriesInternal(toolboxJson: ToolboxInfo | null): boolean {\n  if (!toolboxJson) {\n    return false;\n  }\n\n  const toolboxKind = toolboxJson['kind'];\n  if (toolboxKind) {\n    return toolboxKind === CATEGORY_TOOLBOX_KIND;\n  }\n\n  const categories = toolboxJson['contents'].filter(function (item) {\n    return item['kind'].toUpperCase() === 'CATEGORY';\n  });\n  return !!categories.length;\n}\n\n/**\n * Whether or not the category is collapsible.\n *\n * @param categoryInfo Object holing information for creating a category.\n * @returns True if the category has subcategories.\n * @internal\n */\nexport function isCategoryCollapsible(categoryInfo: CategoryInfo): boolean {\n  if (!categoryInfo || !(categoryInfo as AnyDuringMigration)['contents']) {\n    return false;\n  }\n\n  const categories = (categoryInfo as AnyDuringMigration)['contents'].filter(\n    function (item: AnyDuringMigration) {\n      return item['kind'].toUpperCase() === 'CATEGORY';\n    },\n  );\n  return !!categories.length;\n}\n\n/**\n * Parses the provided toolbox definition into a consistent format.\n *\n * @param toolboxDef The definition of the toolbox in one of its many forms.\n * @returns Object holding information for creating a toolbox.\n */\nfunction convertToToolboxJson(toolboxDef: Node): ToolboxInfo {\n  const contents = xmlToJsonArray(toolboxDef as Node | Node[]);\n  const toolboxJson = {'contents': contents};\n  if (toolboxDef instanceof Node) {\n    addAttributes(toolboxDef, toolboxJson);\n  }\n  return toolboxJson;\n}\n\n/**\n * Converts the xml for a toolbox to JSON.\n *\n * @param toolboxDef The definition of the toolbox in one of its many forms.\n * @returns A list of objects in the toolbox.\n */\nfunction xmlToJsonArray(\n  toolboxDef: Node | Node[] | NodeList,\n): FlyoutItemInfoArray | ToolboxItemInfo[] {\n  const arr = [];\n  // If it is a node it will have children.\n  // AnyDuringMigration because:  Property 'childNodes' does not exist on type\n  // 'Node | NodeList | Node[]'.\n  let childNodes = (toolboxDef as AnyDuringMigration).childNodes;\n  if (!childNodes) {\n    // Otherwise the toolboxDef is an array or collection.\n    childNodes = toolboxDef;\n  }\n  for (let i = 0, child; (child = childNodes[i]); i++) {\n    if (!child.tagName) {\n      continue;\n    }\n    const obj = {};\n    const tagName = child.tagName.toUpperCase();\n    (obj as AnyDuringMigration)['kind'] = tagName;\n\n    // Store the XML for a block.\n    if (tagName === 'BLOCK') {\n      (obj as AnyDuringMigration)['blockxml'] = child;\n    } else if (child.childNodes && child.childNodes.length > 0) {\n      // Get the contents of a category\n      (obj as AnyDuringMigration)['contents'] = xmlToJsonArray(child);\n    }\n\n    // Add XML attributes to object\n    addAttributes(child, obj);\n    arr.push(obj);\n  }\n  // AnyDuringMigration because:  Type '{}[]' is not assignable to type\n  // 'ToolboxItemInfo[] | FlyoutItemInfoArray'.\n  return arr as AnyDuringMigration;\n}\n\n/**\n * Adds the attributes on the node to the given object.\n *\n * @param node The node to copy the attributes from.\n * @param obj The object to copy the attributes to.\n */\nfunction addAttributes(node: Node, obj: AnyDuringMigration) {\n  // AnyDuringMigration because:  Property 'attributes' does not exist on type\n  // 'Node'.\n  for (let j = 0; j < (node as AnyDuringMigration).attributes.length; j++) {\n    // AnyDuringMigration because:  Property 'attributes' does not exist on type\n    // 'Node'.\n    const attr = (node as AnyDuringMigration).attributes[j];\n    if (attr.nodeName.includes('css-')) {\n      obj['cssconfig'] = obj['cssconfig'] || {};\n      obj['cssconfig'][attr.nodeName.replace('css-', '')] = attr.value;\n    } else {\n      obj[attr.nodeName] = attr.value;\n    }\n  }\n}\n\n/**\n * Parse the provided toolbox tree into a consistent DOM format.\n *\n * @param toolboxDef DOM tree of blocks, or text representation of same.\n * @returns DOM tree of blocks, or null.\n */\nexport function parseToolboxTree(\n  toolboxDef: Element | null | string,\n): Element | null {\n  let parsedToolboxDef: Element | null = null;\n  if (toolboxDef) {\n    if (typeof toolboxDef === 'string') {\n      parsedToolboxDef = utilsXml.textToDom(toolboxDef);\n      if (parsedToolboxDef.nodeName.toLowerCase() !== 'xml') {\n        throw TypeError('Toolbox should be an <xml> document.');\n      }\n    } else if (toolboxDef instanceof Element) {\n      parsedToolboxDef = toolboxDef;\n    }\n  }\n  return parsedToolboxDef;\n}\n\nexport const TEST_ONLY = {\n  hasCategoriesInternal,\n};\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.uiPosition\n\nimport type {UiMetrics} from './metrics_manager.js';\nimport {Scrollbar} from './scrollbar.js';\nimport {Rect} from './utils/rect.js';\nimport type {Size} from './utils/size.js';\nimport * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Enum for vertical positioning.\n *\n * @internal\n */\nexport enum verticalPosition {\n  TOP,\n  BOTTOM,\n}\n\n/**\n * Enum for horizontal positioning.\n *\n * @internal\n */\nexport enum horizontalPosition {\n  LEFT,\n  RIGHT,\n}\n\n/**\n * An object defining a horizontal and vertical positioning.\n *\n * @internal\n */\nexport interface Position {\n  horizontal: horizontalPosition;\n  vertical: verticalPosition;\n}\n\n/**\n * Enum for bump rules to use for dealing with collisions.\n *\n * @internal\n */\nexport enum bumpDirection {\n  UP,\n  DOWN,\n}\n\n/**\n * Returns a rectangle representing reasonable position for where to place a UI\n * element of the specified size given the restraints and locations of the\n * scrollbars. This method does not take into account any already placed UI\n * elements.\n *\n * @param position The starting horizontal and vertical position.\n * @param size the size of the UI element to get a start position for.\n * @param horizontalPadding The horizontal padding to use.\n * @param verticalPadding The vertical padding to use.\n * @param metrics The workspace UI metrics.\n * @param workspace The workspace.\n * @returns The suggested start position.\n * @internal\n */\nexport function getStartPositionRect(\n  position: Position,\n  size: Size,\n  horizontalPadding: number,\n  verticalPadding: number,\n  metrics: UiMetrics,\n  workspace: WorkspaceSvg,\n): Rect {\n  // Horizontal positioning.\n  let left = 0;\n  const hasVerticalScrollbar =\n    workspace.scrollbar && workspace.scrollbar.canScrollVertically();\n  if (position.horizontal === horizontalPosition.LEFT) {\n    left = metrics.absoluteMetrics.left + horizontalPadding;\n    if (hasVerticalScrollbar && workspace.RTL) {\n      left += Scrollbar.scrollbarThickness;\n    }\n  } else {\n    // position.horizontal === horizontalPosition.RIGHT\n    left =\n      metrics.absoluteMetrics.left +\n      metrics.viewMetrics.width -\n      size.width -\n      horizontalPadding;\n    if (hasVerticalScrollbar && !workspace.RTL) {\n      left -= Scrollbar.scrollbarThickness;\n    }\n  }\n  // Vertical positioning.\n  let top = 0;\n  if (position.vertical === verticalPosition.TOP) {\n    top = metrics.absoluteMetrics.top + verticalPadding;\n  } else {\n    // position.vertical === verticalPosition.BOTTOM\n    top =\n      metrics.absoluteMetrics.top +\n      metrics.viewMetrics.height -\n      size.height -\n      verticalPadding;\n    if (workspace.scrollbar && workspace.scrollbar.canScrollHorizontally()) {\n      // The scrollbars are always positioned on the bottom if they exist.\n      top -= Scrollbar.scrollbarThickness;\n    }\n  }\n  return new Rect(top, top + size.height, left, left + size.width);\n}\n\n/**\n * Returns a corner position that is on the opposite side of the workspace from\n * the toolbox.\n * If in horizontal orientation, defaults to the bottom corner. If in vertical\n * orientation, defaults to the right corner.\n *\n * @param workspace The workspace.\n * @param metrics The workspace metrics.\n * @returns The suggested corner position.\n * @internal\n */\nexport function getCornerOppositeToolbox(\n  workspace: WorkspaceSvg,\n  metrics: UiMetrics,\n): Position {\n  const leftCorner =\n    metrics.toolboxMetrics.position !== toolbox.Position.LEFT &&\n    (!workspace.horizontalLayout || workspace.RTL);\n  const topCorner = metrics.toolboxMetrics.position === toolbox.Position.BOTTOM;\n  const hPosition = leftCorner\n    ? horizontalPosition.LEFT\n    : horizontalPosition.RIGHT;\n  const vPosition = topCorner ? verticalPosition.TOP : verticalPosition.BOTTOM;\n  return {horizontal: hPosition, vertical: vPosition};\n}\n\n/**\n * Returns a position Rect based on a starting position that is bumped\n * so that it doesn't intersect with any of the provided savedPositions. This\n * method does not check that the bumped position is still within bounds.\n *\n * @param startRect The starting position to use.\n * @param margin The margin to use between elements when bumping.\n * @param bumpDir The direction to bump if there is a collision with an existing\n *     UI element.\n * @param savedPositions List of rectangles that represent the positions of UI\n *     elements already placed.\n * @returns The suggested position rectangle.\n * @internal\n */\nexport function bumpPositionRect(\n  startRect: Rect,\n  margin: number,\n  bumpDir: bumpDirection,\n  savedPositions: Rect[],\n): Rect {\n  let top = startRect.top;\n  const left = startRect.left;\n  const width = startRect.right - startRect.left;\n  const height = startRect.bottom - startRect.top;\n\n  // Check for collision and bump if needed.\n  let boundingRect = startRect;\n  for (let i = 0; i < savedPositions.length; i++) {\n    const otherEl = savedPositions[i];\n    if (boundingRect.intersects(otherEl)) {\n      if (bumpDir === bumpDirection.UP) {\n        top = otherEl.top - height - margin;\n      } else {\n        // bumpDir === bumpDirection.DOWN\n        top = otherEl.bottom + margin;\n      }\n      // Recheck other savedPositions\n      boundingRect = new Rect(top, top + height, left, left + width);\n      i = -1;\n    }\n  }\n  return boundingRect;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.dialog\n\nlet alertImplementation = function (\n  message: string,\n  opt_callback?: () => void,\n) {\n  window.alert(message);\n  if (opt_callback) {\n    opt_callback();\n  }\n};\n\nlet confirmImplementation = function (\n  message: string,\n  callback: (result: boolean) => void,\n) {\n  callback(window.confirm(message));\n};\n\nlet promptImplementation = function (\n  message: string,\n  defaultValue: string,\n  callback: (result: string | null) => void,\n) {\n  callback(window.prompt(message, defaultValue));\n};\n\n/**\n * Wrapper to window.alert() that app developers may override via setAlert to\n * provide alternatives to the modal browser window.\n *\n * @param message The message to display to the user.\n * @param opt_callback The callback when the alert is dismissed.\n */\nexport function alert(message: string, opt_callback?: () => void) {\n  alertImplementation(message, opt_callback);\n}\n\n/**\n * Sets the function to be run when Blockly.dialog.alert() is called.\n *\n * @param alertFunction The function to be run.\n * @see Blockly.dialog.alert\n */\nexport function setAlert(alertFunction: (p1: string, p2?: () => void) => void) {\n  alertImplementation = alertFunction;\n}\n\n/**\n * Wrapper to window.confirm() that app developers may override via setConfirm\n * to provide alternatives to the modal browser window.\n *\n * @param message The message to display to the user.\n * @param callback The callback for handling user response.\n */\nexport function confirm(message: string, callback: (p1: boolean) => void) {\n  TEST_ONLY.confirmInternal(message, callback);\n}\n\n/**\n * Private version of confirm for stubbing in tests.\n */\nfunction confirmInternal(message: string, callback: (p1: boolean) => void) {\n  confirmImplementation(message, callback);\n}\n\n/**\n * Sets the function to be run when Blockly.dialog.confirm() is called.\n *\n * @param confirmFunction The function to be run.\n * @see Blockly.dialog.confirm\n */\nexport function setConfirm(\n  confirmFunction: (p1: string, p2: (p1: boolean) => void) => void,\n) {\n  confirmImplementation = confirmFunction;\n}\n\n/**\n * Wrapper to window.prompt() that app developers may override via setPrompt to\n * provide alternatives to the modal browser window. Built-in browser prompts\n * are often used for better text input experience on mobile device. We strongly\n * recommend testing mobile when overriding this.\n *\n * @param message The message to display to the user.\n * @param defaultValue The value to initialize the prompt with.\n * @param callback The callback for handling user response.\n */\nexport function prompt(\n  message: string,\n  defaultValue: string,\n  callback: (p1: string | null) => void,\n) {\n  promptImplementation(message, defaultValue, callback);\n}\n\n/**\n * Sets the function to be run when Blockly.dialog.prompt() is called.\n *\n * @param promptFunction The function to be run.\n * @see Blockly.dialog.prompt\n */\nexport function setPrompt(\n  promptFunction: (\n    p1: string,\n    p2: string,\n    p3: (p1: string | null) => void,\n  ) => void,\n) {\n  promptImplementation = promptFunction;\n}\n\nexport const TEST_ONLY = {\n  confirmInternal,\n};\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {VariableModel} from '../variable_model.js';\nimport {IParameterModel} from './i_parameter_model.js';\n\n/** Interface for a parameter model that holds a variable model. */\nexport interface IVariableBackedParameterModel extends IParameterModel {\n  /** Returns the variable model held by this type. */\n  getVariableModel(): VariableModel;\n}\n\n/**\n * Returns whether the given object is a variable holder or not.\n */\nexport function isVariableBackedParameterModel(\n  param: IParameterModel,\n): param is IVariableBackedParameterModel {\n  return (param as any).getVariableModel !== undefined;\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Legacy means of representing a procedure signature. The elements are\n * respectively: name, parameter names, and whether it has a return value.\n */\nexport type ProcedureTuple = [string, string[], boolean];\n\n/**\n * Procedure block type.\n *\n * @internal\n */\nexport interface ProcedureBlock {\n  getProcedureCall: () => string;\n  renameProcedure: (p1: string, p2: string) => void;\n  getProcedureDef: () => ProcedureTuple;\n}\n\n/** @internal */\nexport interface LegacyProcedureDefBlock {\n  getProcedureDef: () => ProcedureTuple;\n}\n\n/** @internal */\nexport function isLegacyProcedureDefBlock(\n  block: Object,\n): block is LegacyProcedureDefBlock {\n  return (block as any).getProcedureDef !== undefined;\n}\n\n/** @internal */\nexport interface LegacyProcedureCallBlock {\n  getProcedureCall: () => string;\n  renameProcedure: (p1: string, p2: string) => void;\n}\n\n/** @internal */\nexport function isLegacyProcedureCallBlock(\n  block: Object,\n): block is LegacyProcedureCallBlock {\n  return (\n    (block as any).getProcedureCall !== undefined &&\n    (block as any).renameProcedure !== undefined\n  );\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Variables\n\nimport {Blocks} from './blocks.js';\nimport * as dialog from './dialog.js';\nimport {isVariableBackedParameterModel} from './interfaces/i_variable_backed_parameter_model.js';\nimport {Msg} from './msg.js';\nimport {isLegacyProcedureDefBlock} from './interfaces/i_legacy_procedure_blocks.js';\nimport * as utilsXml from './utils/xml.js';\nimport {VariableModel} from './variable_model.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n * See also Blockly.Procedures.CATEGORY_NAME and\n * Blockly.VariablesDynamic.CATEGORY_NAME.\n */\nexport const CATEGORY_NAME = 'VARIABLE';\n\n/**\n * Find all user-created variables that are in use in the workspace.\n * For use by generators.\n * To get a list of all variables on a workspace, including unused variables,\n * call Workspace.getAllVariables.\n *\n * @param ws The workspace to search for variables.\n * @returns Array of variable models.\n */\nexport function allUsedVarModels(ws: Workspace): VariableModel[] {\n  const blocks = ws.getAllBlocks(false);\n  const variables = new Set<VariableModel>();\n  // Iterate through every block and add each variable to the set.\n  for (let i = 0; i < blocks.length; i++) {\n    const blockVariables = blocks[i].getVarModels();\n    if (blockVariables) {\n      for (let j = 0; j < blockVariables.length; j++) {\n        const variable = blockVariables[j];\n        const id = variable.getId();\n        if (id) {\n          variables.add(variable);\n        }\n      }\n    }\n  }\n  // Convert the set into a list.\n  return Array.from(variables.values());\n}\n\n/**\n * Find all developer variables used by blocks in the workspace.\n * Developer variables are never shown to the user, but are declared as global\n * variables in the generated code.\n * To declare developer variables, define the getDeveloperVariables function on\n * your block and return a list of variable names.\n * For use by generators.\n *\n * @param workspace The workspace to search.\n * @returns A list of non-duplicated variable names.\n */\nexport function allDeveloperVariables(workspace: Workspace): string[] {\n  const blocks = workspace.getAllBlocks(false);\n  const variables = new Set<string>();\n  for (let i = 0, block; (block = blocks[i]); i++) {\n    const getDeveloperVariables = block.getDeveloperVariables;\n    if (getDeveloperVariables) {\n      const devVars = getDeveloperVariables();\n      for (let j = 0; j < devVars.length; j++) {\n        variables.add(devVars[j]);\n      }\n    }\n  }\n  // Convert the set into a list.\n  return Array.from(variables.values());\n}\n\n/**\n * Construct the elements (blocks and button) required by the flyout for the\n * variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML elements.\n */\nexport function flyoutCategory(workspace: WorkspaceSvg): Element[] {\n  let xmlList = new Array<Element>();\n  const button = document.createElement('button');\n  button.setAttribute('text', '%{BKY_NEW_VARIABLE}');\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE');\n\n  workspace.registerButtonCallback('CREATE_VARIABLE', function (button) {\n    createVariableButtonHandler(button.getTargetWorkspace());\n  });\n\n  xmlList.push(button);\n\n  const blockList = flyoutCategoryBlocks(workspace);\n  xmlList = xmlList.concat(blockList);\n  return xmlList;\n}\n\n/**\n * Construct the blocks required by the flyout for the variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML block elements.\n */\nexport function flyoutCategoryBlocks(workspace: Workspace): Element[] {\n  const variableModelList = workspace.getVariablesOfType('');\n\n  const xmlList = [];\n  if (variableModelList.length > 0) {\n    // New variables are added to the end of the variableModelList.\n    const mostRecentVariable = variableModelList[variableModelList.length - 1];\n    if (Blocks['variables_set']) {\n      const block = utilsXml.createElement('block');\n      block.setAttribute('type', 'variables_set');\n      block.setAttribute('gap', Blocks['math_change'] ? '8' : '24');\n      block.appendChild(generateVariableFieldDom(mostRecentVariable));\n      xmlList.push(block);\n    }\n    if (Blocks['math_change']) {\n      const block = utilsXml.createElement('block');\n      block.setAttribute('type', 'math_change');\n      block.setAttribute('gap', Blocks['variables_get'] ? '20' : '8');\n      block.appendChild(generateVariableFieldDom(mostRecentVariable));\n      const value = utilsXml.textToDom(\n        '<value name=\"DELTA\">' +\n          '<shadow type=\"math_number\">' +\n          '<field name=\"NUM\">1</field>' +\n          '</shadow>' +\n          '</value>',\n      );\n      block.appendChild(value);\n      xmlList.push(block);\n    }\n\n    if (Blocks['variables_get']) {\n      variableModelList.sort(VariableModel.compareByName);\n      for (let i = 0, variable; (variable = variableModelList[i]); i++) {\n        const block = utilsXml.createElement('block');\n        block.setAttribute('type', 'variables_get');\n        block.setAttribute('gap', '8');\n        block.appendChild(generateVariableFieldDom(variable));\n        xmlList.push(block);\n      }\n    }\n  }\n  return xmlList;\n}\n\nexport const VAR_LETTER_OPTIONS = 'ijkmnopqrstuvwxyzabcdefgh';\n\n/**\n * Return a new variable name that is not yet being used. This will try to\n * generate single letter variable names in the range 'i' to 'z' to start with.\n * If no unique name is located it will try 'i' to 'z', 'a' to 'h',\n * then 'i2' to 'z2' etc.  Skip 'l'.\n *\n * @param workspace The workspace to be unique in.\n * @returns New variable name.\n */\nexport function generateUniqueName(workspace: Workspace): string {\n  return TEST_ONLY.generateUniqueNameInternal(workspace);\n}\n\n/**\n * Private version of generateUniqueName for stubbing in tests.\n */\nfunction generateUniqueNameInternal(workspace: Workspace): string {\n  return generateUniqueNameFromOptions(\n    VAR_LETTER_OPTIONS.charAt(0),\n    workspace.getAllVariableNames(),\n  );\n}\n\n/**\n * Returns a unique name that is not present in the usedNames array. This\n * will try to generate single letter names in the range a - z (skip l). It\n * will start with the character passed to startChar.\n *\n * @param startChar The character to start the search at.\n * @param usedNames A list of all of the used names.\n * @returns A unique name that is not present in the usedNames array.\n */\nexport function generateUniqueNameFromOptions(\n  startChar: string,\n  usedNames: string[],\n): string {\n  if (!usedNames.length) {\n    return startChar;\n  }\n\n  const letters = VAR_LETTER_OPTIONS;\n  let suffix = '';\n  let letterIndex = letters.indexOf(startChar);\n  let potName = startChar;\n\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    let inUse = false;\n    for (let i = 0; i < usedNames.length; i++) {\n      if (usedNames[i].toLowerCase() === potName) {\n        inUse = true;\n        break;\n      }\n    }\n    if (!inUse) {\n      break;\n    }\n\n    letterIndex++;\n    if (letterIndex === letters.length) {\n      // Reached the end of the character sequence so back to 'i'.\n      letterIndex = 0;\n      suffix = `${Number(suffix) + 1}`;\n    }\n    potName = letters.charAt(letterIndex) + suffix;\n  }\n  return potName;\n}\n\n/**\n * Handles \"Create Variable\" button in the default variables toolbox category.\n * It will prompt the user for a variable name, including re-prompts if a name\n * is already in use among the workspace's variables.\n *\n * Custom button handlers can delegate to this function, allowing variables\n * types and after-creation processing. More complex customization (e.g.,\n * prompting for variable type) is beyond the scope of this function.\n *\n * @param workspace The workspace on which to create the variable.\n * @param opt_callback A callback. It will be passed an acceptable new variable\n *     name, or null if change is to be aborted (cancel button), or undefined if\n *     an existing variable was chosen.\n * @param opt_type The type of the variable like 'int', 'string', or ''. This\n *     will default to '', which is a specific type.\n */\nexport function createVariableButtonHandler(\n  workspace: Workspace,\n  opt_callback?: (p1?: string | null) => void,\n  opt_type?: string,\n) {\n  const type = opt_type || '';\n  // This function needs to be named so it can be called recursively.\n  function promptAndCheckWithAlert(defaultName: string) {\n    promptName(Msg['NEW_VARIABLE_TITLE'], defaultName, function (text) {\n      if (!text) {\n        // User canceled prompt.\n        if (opt_callback) opt_callback(null);\n        return;\n      }\n\n      const existing = nameUsedWithAnyType(text, workspace);\n      if (!existing) {\n        // No conflict\n        workspace.createVariable(text, type);\n        if (opt_callback) opt_callback(text);\n        return;\n      }\n\n      let msg;\n      if (existing.type === type) {\n        msg = Msg['VARIABLE_ALREADY_EXISTS'].replace('%1', existing.name);\n      } else {\n        msg = Msg['VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE'];\n        msg = msg.replace('%1', existing.name).replace('%2', existing.type);\n      }\n      dialog.alert(msg, function () {\n        promptAndCheckWithAlert(text);\n      });\n    });\n  }\n  promptAndCheckWithAlert('');\n}\n\n/**\n * Opens a prompt that allows the user to enter a new name for a variable.\n * Triggers a rename if the new name is valid. Or re-prompts if there is a\n * collision.\n *\n * @param workspace The workspace on which to rename the variable.\n * @param variable Variable to rename.\n * @param opt_callback A callback. It will be passed an acceptable new variable\n *     name, or null if change is to be aborted (cancel button), or undefined if\n *     an existing variable was chosen.\n */\nexport function renameVariable(\n  workspace: Workspace,\n  variable: VariableModel,\n  opt_callback?: (p1?: string | null) => void,\n) {\n  // This function needs to be named so it can be called recursively.\n  function promptAndCheckWithAlert(defaultName: string) {\n    const promptText = Msg['RENAME_VARIABLE_TITLE'].replace(\n      '%1',\n      variable.name,\n    );\n    promptName(promptText, defaultName, function (newName) {\n      if (!newName) {\n        // User canceled prompt.\n        if (opt_callback) opt_callback(null);\n        return;\n      }\n\n      const existing = nameUsedWithOtherType(newName, variable.type, workspace);\n      const procedure = nameUsedWithConflictingParam(\n        variable.name,\n        newName,\n        workspace,\n      );\n      if (!existing && !procedure) {\n        // No conflict.\n        workspace.renameVariableById(variable.getId(), newName);\n        if (opt_callback) opt_callback(newName);\n        return;\n      }\n\n      let msg = '';\n      if (existing) {\n        msg = Msg['VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE']\n          .replace('%1', existing.name)\n          .replace('%2', existing.type);\n      } else if (procedure) {\n        msg = Msg['VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER']\n          .replace('%1', newName)\n          .replace('%2', procedure);\n      }\n      dialog.alert(msg, function () {\n        promptAndCheckWithAlert(newName);\n      });\n    });\n  }\n  promptAndCheckWithAlert('');\n}\n\n/**\n * Prompt the user for a new variable name.\n *\n * @param promptText The string of the prompt.\n * @param defaultText The default value to show in the prompt's field.\n * @param callback A callback. It will be passed the new variable name, or null\n *     if the user picked something illegal.\n */\nexport function promptName(\n  promptText: string,\n  defaultText: string,\n  callback: (p1: string | null) => void,\n) {\n  dialog.prompt(promptText, defaultText, function (newVar) {\n    // Merge runs of whitespace.  Strip leading and trailing whitespace.\n    // Beyond this, all names are legal.\n    if (newVar) {\n      newVar = newVar.replace(/[\\s\\xa0]+/g, ' ').trim();\n      if (newVar === Msg['RENAME_VARIABLE'] || newVar === Msg['NEW_VARIABLE']) {\n        // Ok, not ALL names are legal...\n        newVar = null;\n      }\n    }\n    callback(newVar);\n  });\n}\n/**\n * Check whether there exists a variable with the given name but a different\n * type.\n *\n * @param name The name to search for.\n * @param type The type to exclude from the search.\n * @param workspace The workspace to search for the variable.\n * @returns The variable with the given name and a different type, or null if\n *     none was found.\n */\nfunction nameUsedWithOtherType(\n  name: string,\n  type: string,\n  workspace: Workspace,\n): VariableModel | null {\n  const allVariables = workspace.getVariableMap().getAllVariables();\n\n  name = name.toLowerCase();\n  for (let i = 0, variable; (variable = allVariables[i]); i++) {\n    if (variable.name.toLowerCase() === name && variable.type !== type) {\n      return variable;\n    }\n  }\n  return null;\n}\n\n/**\n * Check whether there exists a variable with the given name of any type.\n *\n * @param name The name to search for.\n * @param workspace The workspace to search for the variable.\n * @returns The variable with the given name, or null if none was found.\n */\nexport function nameUsedWithAnyType(\n  name: string,\n  workspace: Workspace,\n): VariableModel | null {\n  const allVariables = workspace.getVariableMap().getAllVariables();\n\n  name = name.toLowerCase();\n  for (let i = 0, variable; (variable = allVariables[i]); i++) {\n    if (variable.name.toLowerCase() === name) {\n      return variable;\n    }\n  }\n  return null;\n}\n\n/**\n * Returns the name of the procedure with a conflicting parameter name, or null\n * if one does not exist.\n *\n * This checks the procedure map if it contains models, and the legacy procedure\n * blocks otherwise.\n *\n * @param oldName The old name of the variable.\n * @param newName The proposed name of the variable.\n * @param workspace The workspace to search for conflicting parameters.\n * @internal\n */\nexport function nameUsedWithConflictingParam(\n  oldName: string,\n  newName: string,\n  workspace: Workspace,\n): string | null {\n  return workspace.getProcedureMap().getProcedures().length\n    ? checkForConflictingParamWithProcedureModels(oldName, newName, workspace)\n    : checkForConflictingParamWithLegacyProcedures(oldName, newName, workspace);\n}\n\n/**\n * Returns the name of the procedure model with a conflicting param name, or\n * null if one does not exist.\n */\nfunction checkForConflictingParamWithProcedureModels(\n  oldName: string,\n  newName: string,\n  workspace: Workspace,\n): string | null {\n  oldName = oldName.toLowerCase();\n  newName = newName.toLowerCase();\n\n  const procedures = workspace.getProcedureMap().getProcedures();\n  for (const procedure of procedures) {\n    const params = procedure\n      .getParameters()\n      .filter(isVariableBackedParameterModel)\n      .map((param) => param.getVariableModel().name);\n    if (!params) continue;\n    const procHasOld = params.some((param) => param.toLowerCase() === oldName);\n    const procHasNew = params.some((param) => param.toLowerCase() === newName);\n    if (procHasOld && procHasNew) return procedure.getName();\n  }\n  return null;\n}\n\n/**\n * Returns the name of the procedure block with a conflicting param name, or\n * null if one does not exist.\n */\nfunction checkForConflictingParamWithLegacyProcedures(\n  oldName: string,\n  newName: string,\n  workspace: Workspace,\n): string | null {\n  oldName = oldName.toLowerCase();\n  newName = newName.toLowerCase();\n\n  const blocks = workspace.getAllBlocks(false);\n  for (const block of blocks) {\n    if (!isLegacyProcedureDefBlock(block)) continue;\n    const def = block.getProcedureDef();\n    const params = def[1];\n    const blockHasOld = params.some((param) => param.toLowerCase() === oldName);\n    const blockHasNew = params.some((param) => param.toLowerCase() === newName);\n    if (blockHasOld && blockHasNew) return def[0];\n  }\n  return null;\n}\n\n/**\n * Generate DOM objects representing a variable field.\n *\n * @param variableModel The variable model to represent.\n * @returns The generated DOM.\n */\nexport function generateVariableFieldDom(\n  variableModel: VariableModel,\n): Element {\n  /* Generates the following XML:\n   * <field name=\"VAR\" id=\"goKTKmYJ8DhVHpruv\" variabletype=\"int\">foo</field>\n   */\n  const field = utilsXml.createElement('field');\n  field.setAttribute('name', 'VAR');\n  field.setAttribute('id', variableModel.getId());\n  field.setAttribute('variabletype', variableModel.type);\n  const name = utilsXml.createTextNode(variableModel.name);\n  field.appendChild(name);\n  return field;\n}\n\n/**\n * Helper function to look up or create a variable on the given workspace.\n * If no variable exists, creates and returns it.\n *\n * @param workspace The workspace to search for the variable.  It may be a\n *     flyout workspace or main workspace.\n * @param id The ID to use to look up or create the variable, or null.\n * @param opt_name The string to use to look up or create the variable.\n * @param opt_type The type to use to look up or create the variable.\n * @returns The variable corresponding to the given ID or name + type\n *     combination.\n */\nexport function getOrCreateVariablePackage(\n  workspace: Workspace,\n  id: string | null,\n  opt_name?: string,\n  opt_type?: string,\n): VariableModel {\n  let variable = getVariable(workspace, id, opt_name, opt_type);\n  if (!variable) {\n    variable = createVariable(workspace, id, opt_name, opt_type);\n  }\n  return variable;\n}\n\n/**\n * Look up  a variable on the given workspace.\n * Always looks in the main workspace before looking in the flyout workspace.\n * Always prefers lookup by ID to lookup by name + type.\n *\n * @param workspace The workspace to search for the variable.  It may be a\n *     flyout workspace or main workspace.\n * @param id The ID to use to look up the variable, or null.\n * @param opt_name The string to use to look up the variable.\n *     Only used if lookup by ID fails.\n * @param opt_type The type to use to look up the variable.\n *     Only used if lookup by ID fails.\n * @returns The variable corresponding to the given ID or name + type\n *     combination, or null if not found.\n */\nexport function getVariable(\n  workspace: Workspace,\n  id: string | null,\n  opt_name?: string,\n  opt_type?: string,\n): VariableModel | null {\n  const potentialVariableMap = workspace.getPotentialVariableMap();\n  let variable = null;\n  // Try to just get the variable, by ID if possible.\n  if (id) {\n    // Look in the real variable map before checking the potential variable map.\n    variable = workspace.getVariableById(id);\n    if (!variable && potentialVariableMap) {\n      variable = potentialVariableMap.getVariableById(id);\n    }\n    if (variable) {\n      return variable;\n    }\n  }\n  // If there was no ID, or there was an ID but it didn't match any variables,\n  // look up by name and type.\n  if (opt_name) {\n    if (opt_type === undefined) {\n      throw Error('Tried to look up a variable by name without a type');\n    }\n    // Otherwise look up by name and type.\n    variable = workspace.getVariable(opt_name, opt_type);\n    if (!variable && potentialVariableMap) {\n      variable = potentialVariableMap.getVariable(opt_name, opt_type);\n    }\n  }\n  return variable;\n}\n\n/**\n * Helper function to create a variable on the given workspace.\n *\n * @param workspace The workspace in which to create the variable.  It may be a\n *     flyout workspace or main workspace.\n * @param id The ID to use to create the variable, or null.\n * @param opt_name The string to use to create the variable.\n * @param opt_type The type to use to create the variable.\n * @returns The variable corresponding to the given ID or name + type\n *     combination.\n */\nfunction createVariable(\n  workspace: Workspace,\n  id: string | null,\n  opt_name?: string,\n  opt_type?: string,\n): VariableModel {\n  const potentialVariableMap = workspace.getPotentialVariableMap();\n  // Variables without names get uniquely named for this workspace.\n  if (!opt_name) {\n    const ws = workspace.isFlyout\n      ? (workspace as WorkspaceSvg).targetWorkspace\n      : workspace;\n    opt_name = generateUniqueName(ws!);\n  }\n\n  // Create a potential variable if in the flyout.\n  let variable = null;\n  if (potentialVariableMap) {\n    variable = potentialVariableMap.createVariable(opt_name, opt_type, id);\n  } else {\n    // In the main workspace, create a real variable.\n    variable = workspace.createVariable(opt_name, opt_type, id);\n  }\n  return variable;\n}\n\n/**\n * Helper function to get the list of variables that have been added to the\n * workspace after adding a new block, using the given list of variables that\n * were in the workspace before the new block was added.\n *\n * @param workspace The workspace to inspect.\n * @param originalVariables The array of variables that existed in the workspace\n *     before adding the new block.\n * @returns The new array of variables that were freshly added to the workspace\n *     after creating the new block, or [] if no new variables were added to the\n *     workspace.\n * @internal\n */\nexport function getAddedVariables(\n  workspace: Workspace,\n  originalVariables: VariableModel[],\n): VariableModel[] {\n  const allCurrentVariables = workspace.getAllVariables();\n  const addedVariables = [];\n  if (originalVariables.length !== allCurrentVariables.length) {\n    for (let i = 0; i < allCurrentVariables.length; i++) {\n      const variable = allCurrentVariables[i];\n      // For any variable that is present in allCurrentVariables but not\n      // present in originalVariables, add the variable to addedVariables.\n      if (!originalVariables.includes(variable)) {\n        addedVariables.push(variable);\n      }\n    }\n  }\n  return addedVariables;\n}\n\nexport const TEST_ONLY = {\n  generateUniqueNameInternal,\n};\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {BlockSvg} from './block_svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as eventUtils from './events/utils.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/** The set of all blocks in need of rendering which don't have parents. */\nconst rootBlocks = new Set<BlockSvg>();\n\n/** The set of all blocks in need of rendering. */\nconst dirtyBlocks = new WeakSet<BlockSvg>();\n\n/** A map from queued blocks to the event group from when they were queued. */\nconst eventGroups = new WeakMap<BlockSvg, string>();\n\n/**\n * The promise which resolves after the current set of renders is completed. Or\n * null if there are no queued renders.\n *\n * Stored so that we can return it from afterQueuedRenders.\n */\nlet afterRendersPromise: Promise<void> | null = null;\n\n/** The function to call to resolve the `afterRendersPromise`. */\nlet afterRendersResolver: (() => void) | null = null;\n\n/**\n * The ID of the current animation frame request. Used to cancel the request\n * if necessary.\n */\nlet animationRequestId = 0;\n\n/**\n * Registers that the given block and all of its parents need to be rerendered,\n * and registers a callback to do so after a delay, to allowf or batching.\n *\n * @param block The block to rerender.\n * @returns A promise that resolves after the currently queued renders have been\n *     completed. Used for triggering other behavior that relies on updated\n *     size/position location for the block.\n * @internal\n */\nexport function queueRender(block: BlockSvg): Promise<void> {\n  queueBlock(block);\n\n  if (alwaysImmediatelyRender()) {\n    doRenders();\n    return Promise.resolve();\n  }\n\n  if (!afterRendersPromise) {\n    afterRendersPromise = new Promise((resolve) => {\n      afterRendersResolver = resolve;\n      animationRequestId = window.requestAnimationFrame(() => {\n        doRenders();\n        resolve();\n      });\n    });\n  }\n  return afterRendersPromise;\n}\n\n/**\n * @returns A promise that resolves after the currently queued renders have\n *     been completed.\n */\nexport function finishQueuedRenders(): Promise<void> {\n  // If there are no queued renders, return a resolved promise so `then`\n  // callbacks trigger immediately.\n  return afterRendersPromise ? afterRendersPromise : Promise.resolve();\n}\n\n/**\n * Triggers an immediate render of all queued renders. Should only be used in\n * cases where queueing renders breaks functionality + backwards compatibility\n * (such as rendering icons).\n *\n * @param workspace If provided, only rerender blocks in this workspace.\n *\n * @internal\n */\nexport function triggerQueuedRenders(workspace?: WorkspaceSvg) {\n  if (!workspace) window.cancelAnimationFrame(animationRequestId);\n  doRenders(workspace);\n  if (!workspace && afterRendersResolver) afterRendersResolver();\n}\n\n/**\n * @returns True if we should always trigger an immediate render.\n *     Some platforms don't properly support `requestAnimationFrame`, so to\n *     avoid glitchiness, we give up the performance improvements.\n */\nfunction alwaysImmediatelyRender() {\n  return userAgent.JavaFx;\n}\n\n/**\n * Adds the given block and its parents to the render queue. Adds the root block\n * to the list of root blocks.\n *\n * @param block The block to queue.\n */\nfunction queueBlock(block: BlockSvg) {\n  dirtyBlocks.add(block);\n  eventGroups.set(block, eventUtils.getGroup());\n  const parent = block.getParent();\n  if (parent) {\n    queueBlock(parent);\n  } else {\n    rootBlocks.add(block);\n  }\n}\n\n/**\n * Rerenders all of the blocks in the queue.\n *\n * @param workspace If provided, only rerender blocks in this workspace.\n */\nfunction doRenders(workspace?: WorkspaceSvg) {\n  const workspaces = workspace\n    ? new Set([workspace])\n    : new Set([...rootBlocks].map((block) => block.workspace));\n  const blocks = [...rootBlocks]\n    .filter(shouldRenderRootBlock)\n    .filter((b) => workspaces.has(b.workspace));\n  for (const block of blocks) {\n    renderBlock(block);\n  }\n  for (const workspace of workspaces) {\n    workspace.resizeContents();\n  }\n  for (const block of blocks) {\n    const blockOrigin = block.getRelativeToSurfaceXY();\n    block.updateComponentLocations(blockOrigin);\n  }\n  for (const block of blocks) {\n    const oldGroup = eventUtils.getGroup();\n    const newGroup = eventGroups.get(block);\n    if (newGroup) eventUtils.setGroup(newGroup);\n\n    block.bumpNeighbours();\n\n    eventUtils.setGroup(oldGroup);\n  }\n\n  for (const block of blocks) {\n    dequeueBlock(block);\n  }\n  if (!workspace) afterRendersPromise = null;\n}\n\n/** Removes the given block and children from the render queue. */\nfunction dequeueBlock(block: BlockSvg) {\n  rootBlocks.delete(block);\n  dirtyBlocks.delete(block);\n  eventGroups.delete(block);\n  for (const child of block.getChildren(false)) {\n    dequeueBlock(child);\n  }\n}\n\n/**\n * Returns true if the block should be rendered.\n *\n * No need to render dead blocks.\n *\n * No need to render blocks with parents. A render for the block may have been\n * queued, and the block was connected to a parent, so it is no longer a\n * root block. Rendering will be triggered through the real root block.\n */\nfunction shouldRenderRootBlock(block: BlockSvg): boolean {\n  return !block.isDisposed() && !block.getParent();\n}\n\n/**\n * Recursively renders all of the dirty children of the given block, and\n * then renders the block.\n *\n * @param block The block to rerender.\n */\nfunction renderBlock(block: BlockSvg) {\n  if (!dirtyBlocks.has(block)) return;\n  if (!block.initialized) return;\n  for (const child of block.getChildren(false)) {\n    renderBlock(child);\n  }\n  block.renderEfficiently();\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.serialization.registry\n\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport * as registry from '../registry.js';\n\n/**\n * Registers the given serializer so that it can be used for serialization and\n * deserialization.\n *\n * @param name The name of the serializer to register.\n * @param serializer The serializer to register.\n */\nexport function register(name: string, serializer: ISerializer) {\n  registry.register(registry.Type.SERIALIZER, name, serializer);\n}\n\n/**\n * Unregisters the serializer associated with the given name.\n *\n * @param name The name of the serializer to unregister.\n */\nexport function unregister(name: string) {\n  registry.unregister(registry.Type.SERIALIZER, name);\n}\n","/**\n * @license\n * Copyright 2024 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {ISerializer} from '../interfaces/i_serializer.js';\nimport {Workspace} from '../workspace.js';\nimport * as priorities from './priorities.js';\nimport type {WorkspaceComment} from '../comments/workspace_comment.js';\nimport * as eventUtils from '../events/utils.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as serializationRegistry from './registry.js';\nimport {Size} from '../utils/size.js';\n\nexport interface State {\n  id?: string;\n  text?: string;\n  x?: number;\n  y?: number;\n  width?: number;\n  height?: number;\n  collapsed?: boolean;\n  editable?: boolean;\n  movable?: boolean;\n  deletable?: boolean;\n}\n\n/** Serializes the state of the given comment to JSON. */\nexport function save(\n  comment: WorkspaceComment,\n  {\n    addCoordinates = false,\n    saveIds = true,\n  }: {\n    addCoordinates?: boolean;\n    saveIds?: boolean;\n  } = {},\n): State {\n  const workspace = comment.workspace;\n  const state: State = Object.create(null);\n\n  state.height = comment.getSize().height;\n  state.width = comment.getSize().width;\n\n  if (saveIds) state.id = comment.id;\n  if (addCoordinates) {\n    const loc = comment.getRelativeToSurfaceXY();\n    state.x = workspace.RTL ? workspace.getWidth() - loc.x : loc.x;\n    state.y = loc.y;\n  }\n\n  if (comment.getText()) state.text = comment.getText();\n  if (comment.isCollapsed()) state.collapsed = true;\n  if (!comment.isOwnEditable()) state.editable = false;\n  if (!comment.isOwnMovable()) state.movable = false;\n  if (!comment.isOwnDeletable()) state.deletable = false;\n\n  return state;\n}\n\n/** Appends the comment defined by the given state to the given workspace. */\nexport function append(\n  state: State,\n  workspace: Workspace,\n  {recordUndo = false}: {recordUndo?: boolean} = {},\n): WorkspaceComment {\n  const prevRecordUndo = eventUtils.getRecordUndo();\n  eventUtils.setRecordUndo(recordUndo);\n\n  const comment = workspace.newComment(state.id);\n\n  if (state.text !== undefined) comment.setText(state.text);\n  if (state.x !== undefined || state.y !== undefined) {\n    const defaultLoc = comment.getRelativeToSurfaceXY();\n    let x = state.x ?? defaultLoc.x;\n    x = workspace.RTL ? workspace.getWidth() - x : x;\n    const y = state.y ?? defaultLoc.y;\n    comment.moveTo(new Coordinate(x, y));\n  }\n  if (state.width !== undefined || state.height) {\n    const defaultSize = comment.getSize();\n    comment.setSize(\n      new Size(\n        state.width ?? defaultSize.width,\n        state.height ?? defaultSize.height,\n      ),\n    );\n  }\n  if (state.collapsed !== undefined) comment.setCollapsed(state.collapsed);\n  if (state.editable !== undefined) comment.setEditable(state.editable);\n  if (state.movable !== undefined) comment.setMovable(state.movable);\n  if (state.deletable !== undefined) comment.setDeletable(state.deletable);\n\n  eventUtils.setRecordUndo(prevRecordUndo);\n\n  return comment;\n}\n\n// Alias to disambiguate saving within the serializer.\nconst saveComment = save;\n\n/** Serializer for saving and loading workspace comment state. */\nexport class WorkspaceCommentSerializer implements ISerializer {\n  priority = priorities.WORKSPACE_COMMENTS;\n\n  /**\n   * Returns the state of all workspace comments in the given workspace.\n   */\n  save(workspace: Workspace): State[] | null {\n    const commentStates = [];\n    for (const comment of workspace.getTopComments()) {\n      const state = saveComment(comment as AnyDuringMigration, {\n        addCoordinates: true,\n        saveIds: true,\n      });\n      if (state) commentStates.push(state);\n    }\n    return commentStates.length ? commentStates : null;\n  }\n\n  /**\n   * Deserializes the comments defined by the given state into the given\n   * workspace.\n   */\n  load(state: State[], workspace: Workspace) {\n    for (const commentState of state) {\n      append(commentState, workspace, {recordUndo: eventUtils.getRecordUndo()});\n    }\n  }\n\n  /** Disposes of any comments that exist on the given workspace. */\n  clear(workspace: Workspace) {\n    for (const comment of workspace.getTopComments()) {\n      comment.dispose();\n    }\n  }\n}\n\nserializationRegistry.register(\n  'workspaceComments',\n  new WorkspaceCommentSerializer(),\n);\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {ICopyable, ICopyData} from '../interfaces/i_copyable.js';\nimport type {IPaster} from '../interfaces/i_paster.js';\nimport * as registry from '../registry.js';\n\n/**\n * Registers the given paster so that it cna be used for pasting.\n *\n * @param type The type of the paster to register, e.g. 'block', 'comment', etc.\n * @param paster The paster to register.\n */\nexport function register<U extends ICopyData, T extends ICopyable<U>>(\n  type: string,\n  paster: IPaster<U, T>,\n) {\n  registry.register(registry.Type.PASTER, type, paster);\n}\n\n/**\n * Unregisters the paster associated with the given type.\n *\n * @param type The type of the paster to unregister.\n */\nexport function unregister(type: string) {\n  registry.unregister(registry.Type.PASTER, type);\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IPaster} from '../interfaces/i_paster.js';\nimport {ICopyData} from '../interfaces/i_copyable.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport * as registry from './registry.js';\nimport * as commentSerialiation from '../serialization/workspace_comments.js';\nimport * as eventUtils from '../events/utils.js';\nimport * as common from '../common.js';\nimport {RenderedWorkspaceComment} from '../comments/rendered_workspace_comment.js';\n\nexport class WorkspaceCommentPaster\n  implements IPaster<WorkspaceCommentCopyData, RenderedWorkspaceComment>\n{\n  static TYPE = 'workspace-comment';\n\n  paste(\n    copyData: WorkspaceCommentCopyData,\n    workspace: WorkspaceSvg,\n    coordinate?: Coordinate,\n  ): RenderedWorkspaceComment | null {\n    const state = copyData.commentState;\n\n    if (coordinate) {\n      state['x'] = coordinate.x;\n      state['y'] = coordinate.y;\n    }\n\n    eventUtils.disable();\n    let comment;\n    try {\n      comment = commentSerialiation.append(\n        state,\n        workspace,\n      ) as RenderedWorkspaceComment;\n      moveCommentToNotConflict(comment);\n    } finally {\n      eventUtils.enable();\n    }\n\n    if (!comment) return null;\n\n    if (eventUtils.isEnabled()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.COMMENT_CREATE))(comment));\n    }\n    common.setSelected(comment);\n    return comment;\n  }\n}\n\nfunction moveCommentToNotConflict(comment: RenderedWorkspaceComment) {\n  const workspace = comment.workspace;\n  const translateDistance = 30;\n  const coord = comment.getRelativeToSurfaceXY();\n  const offset = new Coordinate(0, 0);\n  // getRelativeToSurfaceXY is really expensive, so we want to cache this.\n  const otherCoords = workspace\n    .getTopComments(false)\n    .filter((otherComment) => otherComment.id !== comment.id)\n    .map((c) => c.getRelativeToSurfaceXY());\n\n  while (\n    commentOverlapsOtherExactly(Coordinate.sum(coord, offset), otherCoords)\n  ) {\n    offset.translate(\n      workspace.RTL ? -translateDistance : translateDistance,\n      translateDistance,\n    );\n  }\n\n  comment.moveTo(Coordinate.sum(coord, offset));\n}\n\nfunction commentOverlapsOtherExactly(\n  coord: Coordinate,\n  otherCoords: Coordinate[],\n): boolean {\n  return otherCoords.some(\n    (otherCoord) =>\n      Math.abs(otherCoord.x - coord.x) <= 1 &&\n      Math.abs(otherCoord.y - coord.y) <= 1,\n  );\n}\n\nexport interface WorkspaceCommentCopyData extends ICopyData {\n  commentState: commentSerialiation.State;\n}\n\nregistry.register(WorkspaceCommentPaster.TYPE, new WorkspaceCommentPaster());\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.aria\n\n/** ARIA states/properties prefix. */\nconst ARIA_PREFIX = 'aria-';\n\n/** ARIA role attribute. */\nconst ROLE_ATTRIBUTE = 'role';\n\n/**\n * ARIA role values.\n * Copied from Closure's goog.a11y.aria.Role\n */\nexport enum Role {\n  // ARIA role for an interactive control of tabular data.\n  GRID = 'grid',\n\n  // ARIA role for a cell in a grid.\n  GRIDCELL = 'gridcell',\n  // ARIA role for a group of related elements like tree item siblings.\n  GROUP = 'group',\n\n  // ARIA role for a listbox.\n  LISTBOX = 'listbox',\n\n  // ARIA role for a popup menu.\n  MENU = 'menu',\n\n  // ARIA role for menu item elements.\n  MENUITEM = 'menuitem',\n  // ARIA role for a checkbox box element inside a menu.\n  MENUITEMCHECKBOX = 'menuitemcheckbox',\n  // ARIA role for option items that are  children of combobox, listbox, menu,\n  // radiogroup, or tree elements.\n  OPTION = 'option',\n  // ARIA role for ignorable cosmetic elements with no semantic significance.\n  PRESENTATION = 'presentation',\n\n  // ARIA role for a row of cells in a grid.\n  ROW = 'row',\n  // ARIA role for a tree.\n  TREE = 'tree',\n\n  // ARIA role for a tree item that sometimes may be expanded or collapsed.\n  TREEITEM = 'treeitem',\n}\n\n/**\n * ARIA states and properties.\n * Copied from Closure's goog.a11y.aria.State\n */\nexport enum State {\n  // ARIA property for setting the currently active descendant of an element,\n  // for example the selected item in a list box. Value: ID of an element.\n  ACTIVEDESCENDANT = 'activedescendant',\n  // ARIA property defines the total number of columns in a table, grid, or\n  // treegrid.\n  // Value: integer.\n  COLCOUNT = 'colcount',\n  // ARIA state for a disabled item. Value: one of {true, false}.\n  DISABLED = 'disabled',\n\n  // ARIA state for setting whether the element like a tree node is expanded.\n  // Value: one of {true, false, undefined}.\n  EXPANDED = 'expanded',\n\n  // ARIA state indicating that the entered value does not conform. Value:\n  // one of {false, true, 'grammar', 'spelling'}\n  INVALID = 'invalid',\n\n  // ARIA property that provides a label to override any other text, value, or\n  // contents used to describe this element. Value: string.\n  LABEL = 'label',\n  // ARIA property for setting the element which labels another element.\n  // Value: space-separated IDs of elements.\n  LABELLEDBY = 'labelledby',\n\n  // ARIA property for setting the level of an element in the hierarchy.\n  // Value: integer.\n  LEVEL = 'level',\n  // ARIA property indicating if the element is horizontal or vertical.\n  // Value: one of {'vertical', 'horizontal'}.\n  ORIENTATION = 'orientation',\n\n  // ARIA property that defines an element's number of position in a list.\n  // Value: integer.\n  POSINSET = 'posinset',\n\n  // ARIA property defines the total number of rows in a table, grid, or\n  // treegrid.\n  // Value: integer.\n  ROWCOUNT = 'rowcount',\n\n  // ARIA state for setting the currently selected item in the list.\n  // Value: one of {true, false, undefined}.\n  SELECTED = 'selected',\n  // ARIA property defining the number of items in a list. Value: integer.\n  SETSIZE = 'setsize',\n\n  // ARIA property for slider maximum value. Value: number.\n  VALUEMAX = 'valuemax',\n\n  // ARIA property for slider minimum value. Value: number.\n  VALUEMIN = 'valuemin',\n}\n\n/**\n * Sets the role of an element.\n *\n * Similar to Closure's goog.a11y.aria\n *\n * @param element DOM node to set role of.\n * @param roleName Role name.\n */\nexport function setRole(element: Element, roleName: Role) {\n  element.setAttribute(ROLE_ATTRIBUTE, roleName);\n}\n\n/**\n * Sets the state or property of an element.\n * Copied from Closure's goog.a11y.aria\n *\n * @param element DOM node where we set state.\n * @param stateName State attribute being set.\n *     Automatically adds prefix 'aria-' to the state name if the attribute is\n * not an extra attribute.\n * @param value Value for the state attribute.\n */\nexport function setState(\n  element: Element,\n  stateName: State,\n  value: string | boolean | number | string[],\n) {\n  if (Array.isArray(value)) {\n    value = value.join(' ');\n  }\n  const attrStateName = ARIA_PREFIX + stateName;\n  element.setAttribute(attrStateName, `${value}`);\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport interface ISerializable {\n  /**\n   * @param doFullSerialization If true, this signals that any backing data\n   *     structures used by this ISerializable should also be serialized. This\n   *     is used for copy-paste.\n   * @returns a JSON serializable value that records the ISerializable's state.\n   */\n  saveState(doFullSerialization: boolean): any;\n\n  /**\n   * Takes in a JSON serializable value and sets the ISerializable's state\n   * based on that.\n   *\n   * @param state The state to apply to the ISerializable.\n   */\n  loadState(state: any): void;\n}\n\n/** Type guard that checks whether the given object is a ISerializable. */\nexport function isSerializable(obj: any): obj is ISerializable {\n  return obj.saveState !== undefined && obj.loadState !== undefined;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.serialization.blocks\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport type {Connection} from '../connection.js';\nimport {MANUALLY_DISABLED} from '../constants.js';\nimport * as eventUtils from '../events/utils.js';\nimport {inputTypes} from '../inputs/input_types.js';\nimport {isSerializable} from '../interfaces/i_serializable.js';\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport * as registry from '../registry.js';\nimport * as utilsXml from '../utils/xml.js';\nimport type {Workspace} from '../workspace.js';\nimport * as Xml from '../xml.js';\nimport * as renderManagement from '../render_management.js';\n\nimport {\n  BadConnectionCheck,\n  MissingBlockType,\n  MissingConnection,\n  RealChildOfShadow,\n  UnregisteredIcon,\n} from './exceptions.js';\nimport * as priorities from './priorities.js';\nimport * as serializationRegistry from './registry.js';\nimport * as Variables from '../variables.js';\nimport {VariableModel} from '../variable_model.js';\n\n// TODO(#5160): Remove this once lint is fixed.\n/* eslint-disable no-use-before-define */\n\n/**\n * Represents the state of a connection.\n */\nexport interface ConnectionState {\n  shadow?: State;\n  block?: State;\n}\n\n/**\n * Represents the state of a given block.\n */\nexport interface State {\n  type: string;\n  id?: string;\n  x?: number;\n  y?: number;\n  collapsed?: boolean;\n  deletable?: boolean;\n  movable?: boolean;\n  editable?: boolean;\n  enabled?: boolean;\n  disabledReasons?: string[];\n  inline?: boolean;\n  data?: string;\n  extraState?: AnyDuringMigration;\n  icons?: {[key: string]: AnyDuringMigration};\n  fields?: {[key: string]: AnyDuringMigration};\n  inputs?: {[key: string]: ConnectionState};\n  next?: ConnectionState;\n}\n\n/**\n * Returns the state of the given block as a plain JavaScript object.\n *\n * @param block The block to serialize.\n * @param param1 addCoordinates: If true, the coordinates of the block are added\n *     to the serialized state. False by default. addinputBlocks: If true,\n *     children of the block which are connected to inputs will be serialized.\n *     True by default. addNextBlocks: If true, children of the block which are\n *     connected to the block's next connection (if it exists) will be\n *     serialized. True by default. doFullSerialization: If true, fields that\n *     normally just save a reference to some external state (eg variables) will\n *     instead serialize all of the info about that state. This supports\n *     deserializing the block into a workspace where that state doesn't yet\n *     exist. True by default.\n * @returns The serialized state of the block, or null if the block could not be\n *     serialied (eg it was an insertion marker).\n */\nexport function save(\n  block: Block,\n  {\n    addCoordinates = false,\n    addInputBlocks = true,\n    addNextBlocks = true,\n    doFullSerialization = true,\n    saveIds = true,\n  }: {\n    addCoordinates?: boolean;\n    addInputBlocks?: boolean;\n    addNextBlocks?: boolean;\n    doFullSerialization?: boolean;\n    saveIds?: boolean;\n  } = {},\n): State | null {\n  if (block.isInsertionMarker()) {\n    return null;\n  }\n  const state = {\n    'type': block.type,\n    'id': saveIds ? block.id : undefined,\n  };\n\n  if (addCoordinates) {\n    // AnyDuringMigration because:  Argument of type '{ type: string; id:\n    // string; }' is not assignable to parameter of type 'State'.\n    saveCoords(block, state as AnyDuringMigration);\n  }\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveAttributes(block, state as AnyDuringMigration);\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveExtraState(block, state as AnyDuringMigration, doFullSerialization);\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveIcons(block, state as AnyDuringMigration, doFullSerialization);\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveFields(block, state as AnyDuringMigration, doFullSerialization);\n  if (addInputBlocks) {\n    // AnyDuringMigration because:  Argument of type '{ type: string; id:\n    // string; }' is not assignable to parameter of type 'State'.\n    saveInputBlocks(\n      block,\n      state as AnyDuringMigration,\n      doFullSerialization,\n      saveIds,\n    );\n  }\n  if (addNextBlocks) {\n    // AnyDuringMigration because:  Argument of type '{ type: string; id:\n    // string; }' is not assignable to parameter of type 'State'.\n    saveNextBlocks(\n      block,\n      state as AnyDuringMigration,\n      doFullSerialization,\n      saveIds,\n    );\n  }\n\n  // AnyDuringMigration because:  Type '{ type: string; id: string; }' is not\n  // assignable to type 'State'.\n  return state as AnyDuringMigration;\n}\n\n/**\n * Adds attributes to the given state object based on the state of the block.\n * Eg collapsed, disabled, inline, etc.\n *\n * @param block The block to base the attributes on.\n * @param state The state object to append to.\n */\nfunction saveAttributes(block: Block, state: State) {\n  if (block.isCollapsed()) {\n    state['collapsed'] = true;\n  }\n  if (!block.isEnabled()) {\n    state['disabledReasons'] = Array.from(block.getDisabledReasons());\n  }\n  if (!block.isOwnDeletable()) {\n    state['deletable'] = false;\n  }\n  if (!block.isOwnMovable()) {\n    state['movable'] = false;\n  }\n  if (!block.isOwnEditable()) {\n    state['editable'] = false;\n  }\n  if (\n    block.inputsInline !== undefined &&\n    block.inputsInline !== block.inputsInlineDefault\n  ) {\n    state['inline'] = block.inputsInline;\n  }\n  // Data is a nullable string, so we don't need to worry about falsy values.\n  if (block.data) {\n    state['data'] = block.data;\n  }\n}\n\n/**\n * Adds the coordinates of the given block to the given state object.\n *\n * @param block The block to base the coordinates on.\n * @param state The state object to append to.\n */\nfunction saveCoords(block: Block, state: State) {\n  const workspace = block.workspace;\n  const xy = block.getRelativeToSurfaceXY();\n  state['x'] = Math.round(workspace.RTL ? workspace.getWidth() - xy.x : xy.x);\n  state['y'] = Math.round(xy.y);\n}\n\n/**\n * Adds any extra state the block may provide to the given state object.\n *\n * @param block The block to serialize the extra state of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to serialize the full state of the\n *     extra state (rather than possibly saving a reference to some state).\n */\nfunction saveExtraState(\n  block: Block,\n  state: State,\n  doFullSerialization: boolean,\n) {\n  if (block.saveExtraState) {\n    const extraState = block.saveExtraState(doFullSerialization);\n    if (extraState !== null) {\n      state['extraState'] = extraState;\n    }\n  } else if (block.mutationToDom) {\n    const extraState = block.mutationToDom();\n    if (extraState !== null) {\n      state['extraState'] = Xml.domToText(extraState).replace(\n        ' xmlns=\"https://developers.google.com/blockly/xml\"',\n        '',\n      );\n    }\n  }\n}\n\n/**\n * Adds the state of all of the icons on the block to the given state object.\n *\n * @param block The block to serialize the icon state of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to serialize the full state of the\n *     icon (rather than possibly saving a reference to some state).\n */\nfunction saveIcons(block: Block, state: State, doFullSerialization: boolean) {\n  const icons = Object.create(null);\n  for (const icon of block.getIcons()) {\n    if (isSerializable(icon)) {\n      const state = icon.saveState(doFullSerialization);\n      if (state) icons[icon.getType().toString()] = state;\n    }\n  }\n\n  if (Object.keys(icons).length) {\n    state['icons'] = icons;\n  }\n}\n\n/**\n * Adds the state of all of the fields on the block to the given state object.\n *\n * @param block The block to serialize the field state of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to serialize the full state of the\n *     field (rather than possibly saving a reference to some state).\n */\nfunction saveFields(block: Block, state: State, doFullSerialization: boolean) {\n  const fields = Object.create(null);\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    for (let j = 0; j < input.fieldRow.length; j++) {\n      const field = input.fieldRow[j];\n      if (field.isSerializable()) {\n        fields[field.name!] = field.saveState(doFullSerialization);\n      }\n    }\n  }\n  if (Object.keys(fields).length) {\n    state['fields'] = fields;\n  }\n}\n\n/**\n * Adds the state of all of the child blocks of the given block (which are\n * connected to inputs) to the given state object.\n *\n * @param block The block to serialize the input blocks of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to do full serialization.\n */\nfunction saveInputBlocks(\n  block: Block,\n  state: State,\n  doFullSerialization: boolean,\n  saveIds: boolean,\n) {\n  const inputs = Object.create(null);\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    if (!input.connection) continue;\n    const connectionState = saveConnection(\n      input.connection as Connection,\n      doFullSerialization,\n      saveIds,\n    );\n    if (connectionState) {\n      inputs[input.name] = connectionState;\n    }\n  }\n\n  if (Object.keys(inputs).length) {\n    state['inputs'] = inputs;\n  }\n}\n\n/**\n * Adds the state of all of the next blocks of the given block to the given\n * state object.\n *\n * @param block The block to serialize the next blocks of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to do full serialization.\n */\nfunction saveNextBlocks(\n  block: Block,\n  state: State,\n  doFullSerialization: boolean,\n  saveIds: boolean,\n) {\n  if (!block.nextConnection) {\n    return;\n  }\n  const connectionState = saveConnection(\n    block.nextConnection,\n    doFullSerialization,\n    saveIds,\n  );\n  if (connectionState) {\n    state['next'] = connectionState;\n  }\n}\n\n/**\n * Returns the state of the given connection (ie the state of any connected\n * shadow or real blocks).\n *\n * @param connection The connection to serialize the connected blocks of.\n * @returns An object containing the state of any connected shadow block, or any\n *     connected real block.\n * @param doFullSerialization Whether or not to do full serialization.\n */\nfunction saveConnection(\n  connection: Connection,\n  doFullSerialization: boolean,\n  saveIds: boolean,\n): ConnectionState | null {\n  const shadow = connection.getShadowState(true);\n  const child = connection.targetBlock();\n  if (!shadow && !child) {\n    return null;\n  }\n  const state = Object.create(null);\n  if (shadow) {\n    state['shadow'] = shadow;\n  }\n  if (child && !child.isShadow()) {\n    state['block'] = save(child, {doFullSerialization, saveIds});\n  }\n  return state;\n}\n\n/**\n * Loads the block represented by the given state into the given workspace.\n *\n * @param state The state of a block to deserialize into the workspace.\n * @param workspace The workspace to add the block to.\n * @param param1 recordUndo: If true, events triggered by this function will be\n *     undo-able by the user. False by default.\n * @returns The block that was just loaded.\n */\nexport function append(\n  state: State,\n  workspace: Workspace,\n  {recordUndo = false}: {recordUndo?: boolean} = {},\n): Block {\n  const block = appendInternal(state, workspace, {recordUndo});\n  if (workspace.rendered) renderManagement.triggerQueuedRenders();\n  return block;\n}\n\n/**\n * Loads the block represented by the given state into the given workspace.\n * This is defined internally so that the extra parameters don't clutter our\n * external API.\n * But it is exported so that other places within Blockly can call it directly\n * with the extra parameters.\n *\n * @param state The state of a block to deserialize into the workspace.\n * @param workspace The workspace to add the block to.\n * @param param1 parentConnection: If provided, the system will attempt to\n *     connect the block to this connection after it is created. Undefined by\n *     default. isShadow: If true, the block will be set to a shadow block after\n *     it is created. False by default. recordUndo: If true, events triggered by\n *     this function will be undo-able by the user. False by default.\n * @returns The block that was just appended.\n * @internal\n */\nexport function appendInternal(\n  state: State,\n  workspace: Workspace,\n  {\n    parentConnection = undefined,\n    isShadow = false,\n    recordUndo = false,\n  }: {\n    parentConnection?: Connection;\n    isShadow?: boolean;\n    recordUndo?: boolean;\n  } = {},\n): Block {\n  const prevRecordUndo = eventUtils.getRecordUndo();\n  eventUtils.setRecordUndo(recordUndo);\n  const existingGroup = eventUtils.getGroup();\n  if (!existingGroup) {\n    eventUtils.setGroup(true);\n  }\n  eventUtils.disable();\n\n  const variablesBeforeCreation = workspace.getAllVariables();\n  let block;\n  try {\n    block = appendPrivate(state, workspace, {parentConnection, isShadow});\n  } finally {\n    eventUtils.enable();\n  }\n\n  // Fire a VarCreate event for each (if any) new variable created.\n  checkNewVariables(workspace, variablesBeforeCreation);\n\n  if (eventUtils.isEnabled()) {\n    // Block events come after var events, in case they refer to newly created\n    // variables.\n    eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(block));\n  }\n  eventUtils.setGroup(existingGroup);\n  eventUtils.setRecordUndo(prevRecordUndo);\n\n  // Adding connections to the connection db is expensive. This defers that\n  // operation to decrease load time.\n  if (workspace.rendered) {\n    const blockSvg = block as BlockSvg;\n    setTimeout(() => {\n      if (!blockSvg.disposed) {\n        blockSvg.setConnectionTracking(true);\n      }\n    }, 1);\n  }\n\n  return block;\n}\n\n/**\n * Loads the block represented by the given state into the given workspace.\n * This is defined privately so that it can be called recursively without firing\n * eroneous events. Events (and other things we only want to occur on the top\n * block) are handled by appendInternal.\n *\n * @param state The state of a block to deserialize into the workspace.\n * @param workspace The workspace to add the block to.\n * @param param1 parentConnection: If provided, the system will attempt to\n *     connect the block to this connection after it is created. Undefined by\n *     default. isShadow: The block will be set to a shadow block after it is\n *     created. False by default.\n * @returns The block that was just appended.\n */\nfunction appendPrivate(\n  state: State,\n  workspace: Workspace,\n  {\n    parentConnection = undefined,\n    isShadow = false,\n  }: {parentConnection?: Connection; isShadow?: boolean} = {},\n): Block {\n  if (!state['type']) {\n    throw new MissingBlockType(state);\n  }\n\n  const block = workspace.newBlock(state['type'], state['id']);\n  block.setShadow(isShadow);\n  loadCoords(block, state);\n  loadAttributes(block, state);\n  loadExtraState(block, state);\n  tryToConnectParent(parentConnection, block, state);\n  loadIcons(block, state);\n  loadFields(block, state);\n  loadInputBlocks(block, state);\n  loadNextBlocks(block, state);\n  initBlock(block, workspace.rendered);\n\n  return block;\n}\n\n/**\n * Checks the workspace for any new variables that were created during the\n * deserialization of a block and fires a VarCreate event for each.\n *\n * @param workspace The workspace where new variables are being created\n * @param originalVariables The array of variables that existed in the workspace\n *     before adding the new block.\n */\nfunction checkNewVariables(\n  workspace: Workspace,\n  originalVariables: VariableModel[],\n) {\n  if (eventUtils.isEnabled()) {\n    const newVariables = Variables.getAddedVariables(\n      workspace,\n      originalVariables,\n    );\n    // Fire a VarCreate event for each (if any) new variable created.\n    for (let i = 0; i < newVariables.length; i++) {\n      const thisVariable = newVariables[i];\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.VAR_CREATE))(thisVariable),\n      );\n    }\n  }\n}\n\n/**\n * Applies any coordinate information available on the state object to the\n * block.\n *\n * @param block The block to set the position of.\n * @param state The state object to reference.\n */\nfunction loadCoords(block: Block, state: State) {\n  let x = state['x'] === undefined ? 0 : state['x'];\n  const y = state['y'] === undefined ? 0 : state['y'];\n\n  const workspace = block.workspace;\n  x = workspace.RTL ? workspace.getWidth() - x : x;\n\n  block.moveBy(x, y);\n}\n\n/**\n * Applies any attribute information available on the state object to the block.\n *\n * @param block The block to set the attributes of.\n * @param state The state object to reference.\n */\nfunction loadAttributes(block: Block, state: State) {\n  if (state['collapsed']) {\n    block.setCollapsed(true);\n  }\n  if (state['deletable'] === false) {\n    block.setDeletable(false);\n  }\n  if (state['movable'] === false) {\n    block.setMovable(false);\n  }\n  if (state['editable'] === false) {\n    block.setEditable(false);\n  }\n  if (state['enabled'] === false) {\n    // Before May 2024 we just used 'enabled', with no reasons.\n    // Contiune to support this syntax.\n    block.setDisabledReason(true, MANUALLY_DISABLED);\n  }\n  if (Array.isArray(state['disabledReasons'])) {\n    for (const reason of state['disabledReasons']) {\n      block.setDisabledReason(true, reason);\n    }\n  }\n  if (state['inline'] !== undefined) {\n    block.setInputsInline(state['inline']);\n  }\n  if (state['data'] !== undefined) {\n    block.data = state['data'];\n  }\n}\n\n/**\n * Applies any extra state information available on the state object to the\n * block.\n *\n * @param block The block to set the extra state of.\n * @param state The state object to reference.\n */\nfunction loadExtraState(block: Block, state: State) {\n  if (!state['extraState']) {\n    return;\n  }\n  if (block.loadExtraState) {\n    block.loadExtraState(state['extraState']);\n  } else if (block.domToMutation) {\n    block.domToMutation(utilsXml.textToDom(state['extraState']));\n  }\n}\n\n/**\n * Attempts to connect the block to the parent connection, if it exists.\n *\n * @param parentConnection The parent connection to try to connect the block to.\n * @param child The block to try to connect to the parent.\n * @param state The state which defines the given block\n */\nfunction tryToConnectParent(\n  parentConnection: Connection | undefined,\n  child: Block,\n  state: State,\n) {\n  if (!parentConnection) {\n    return;\n  }\n\n  if (parentConnection.getSourceBlock().isShadow() && !child.isShadow()) {\n    throw new RealChildOfShadow(state);\n  }\n\n  let connected = false;\n  let childConnection;\n  if (parentConnection.type === inputTypes.VALUE) {\n    childConnection = child.outputConnection;\n    if (!childConnection) {\n      throw new MissingConnection('output', child, state);\n    }\n    connected = parentConnection.connect(childConnection);\n  } else {\n    // Statement type.\n    childConnection = child.previousConnection;\n    if (!childConnection) {\n      throw new MissingConnection('previous', child, state);\n    }\n    connected = parentConnection.connect(childConnection);\n  }\n\n  if (!connected) {\n    const checker = child.workspace.connectionChecker;\n    throw new BadConnectionCheck(\n      checker.getErrorMessage(\n        checker.canConnectWithReason(childConnection, parentConnection, false),\n        childConnection,\n        parentConnection,\n      ),\n      parentConnection.type === inputTypes.VALUE\n        ? 'output connection'\n        : 'previous connection',\n      child,\n      state,\n    );\n  }\n}\n\n/**\n * Applies icon state to the icons on the block, based on the given state\n * object.\n *\n * @param block The block to set the icon state of.\n * @param state The state object to reference.\n */\nfunction loadIcons(block: Block, state: State) {\n  if (!state['icons']) return;\n\n  const iconTypes = Object.keys(state['icons']);\n  for (const iconType of iconTypes) {\n    const iconState = state['icons'][iconType];\n    let icon = block.getIcon(iconType);\n    if (!icon) {\n      const constructor = registry.getClass(\n        registry.Type.ICON,\n        iconType,\n        false,\n      );\n      if (!constructor) throw new UnregisteredIcon(iconType, block, state);\n      icon = new constructor(block);\n      block.addIcon(icon);\n    }\n    if (isSerializable(icon)) icon.loadState(iconState);\n  }\n}\n\n/**\n * Applies any field information available on the state object to the block.\n *\n * @param block The block to set the field state of.\n * @param state The state object to reference.\n */\nfunction loadFields(block: Block, state: State) {\n  if (!state['fields']) {\n    return;\n  }\n  const keys = Object.keys(state['fields']);\n  for (let i = 0; i < keys.length; i++) {\n    const fieldName = keys[i];\n    const fieldState = state['fields'][fieldName];\n    const field = block.getField(fieldName);\n    if (!field) {\n      console.warn(\n        `Ignoring non-existant field ${fieldName} in block ${block.type}`,\n      );\n      continue;\n    }\n    field.loadState(fieldState);\n  }\n}\n\n/**\n * Creates any child blocks (attached to inputs) defined by the given state\n * and attaches them to the given block.\n *\n * @param block The block to attach input blocks to.\n * @param state The state object to reference.\n */\nfunction loadInputBlocks(block: Block, state: State) {\n  if (!state['inputs']) {\n    return;\n  }\n  const keys = Object.keys(state['inputs']);\n  for (let i = 0; i < keys.length; i++) {\n    const inputName = keys[i];\n    const input = block.getInput(inputName);\n    if (!input || !input.connection) {\n      throw new MissingConnection(inputName, block, state);\n    }\n    loadConnection(input.connection, state['inputs'][inputName]);\n  }\n}\n\n/**\n * Creates any next blocks defined by the given state and attaches them to the\n * given block.\n *\n * @param block The block to attach next blocks to.\n * @param state The state object to reference.\n */\nfunction loadNextBlocks(block: Block, state: State) {\n  if (!state['next']) {\n    return;\n  }\n  if (!block.nextConnection) {\n    throw new MissingConnection('next', block, state);\n  }\n  loadConnection(block.nextConnection, state['next']);\n}\n/**\n * Applies the state defined by connectionState to the given connection, ie\n * assigns shadows and attaches child blocks.\n *\n * @param connection The connection to deserialize the connected blocks of.\n * @param connectionState The object containing the state of any connected\n *     shadow block, or any connected real block.\n */\nfunction loadConnection(\n  connection: Connection,\n  connectionState: ConnectionState,\n) {\n  if (connectionState['shadow']) {\n    connection.setShadowState(connectionState['shadow']);\n  }\n  if (connectionState['block']) {\n    appendPrivate(\n      connectionState['block'],\n      connection.getSourceBlock().workspace,\n      {parentConnection: connection},\n    );\n  }\n}\n\n// TODO(#5146): Remove this from the serialization system.\n/**\n * Initializes the give block, eg init the model, inits the svg, renders, etc.\n *\n * @param block The block to initialize.\n * @param rendered Whether the block is a rendered or headless block.\n */\nfunction initBlock(block: Block, rendered: boolean) {\n  if (rendered) {\n    const blockSvg = block as BlockSvg;\n    // Adding connections to the connection db is expensive. This defers that\n    // operation to decrease load time.\n    blockSvg.setConnectionTracking(false);\n\n    blockSvg.initSvg();\n    blockSvg.queueRender();\n\n    // fixes #6076 JSO deserialization doesn't\n    // set .iconXY_ property so here it will be set\n    for (const icon of blockSvg.getIcons()) {\n      icon.onLocationChange(blockSvg.getRelativeToSurfaceXY());\n    }\n  } else {\n    block.initModel();\n  }\n}\n\n// Alias to disambiguate saving within the serializer.\nconst saveBlock = save;\n\n/**\n * Serializer for saving and loading block state.\n */\nexport class BlockSerializer implements ISerializer {\n  priority: number;\n\n  /* eslint-disable-next-line require-jsdoc */\n  constructor() {\n    /** The priority for deserializing blocks. */\n    this.priority = priorities.BLOCKS;\n  }\n\n  /**\n   * Serializes the blocks of the given workspace.\n   *\n   * @param workspace The workspace to save the blocks of.\n   * @returns The state of the workspace's blocks, or null if there are no\n   *     blocks.\n   */\n  save(\n    workspace: Workspace,\n  ): {languageVersion: number; blocks: State[]} | null {\n    const blockStates = [];\n    for (const block of workspace.getTopBlocks(false)) {\n      const state = saveBlock(block, {\n        addCoordinates: true,\n        doFullSerialization: false,\n      });\n      if (state) {\n        blockStates.push(state);\n      }\n    }\n    if (blockStates.length) {\n      return {\n        'languageVersion': 0, // Currently unused.\n        'blocks': blockStates,\n      };\n    }\n    return null;\n  }\n\n  /**\n   * Deserializes the blocks defined by the given state into the given\n   * workspace.\n   *\n   * @param state The state of the blocks to deserialize.\n   * @param workspace The workspace to deserialize into.\n   */\n  load(\n    state: {languageVersion: number; blocks: State[]},\n    workspace: Workspace,\n  ) {\n    const blockStates = state['blocks'];\n    for (const state of blockStates) {\n      append(state, workspace, {recordUndo: eventUtils.getRecordUndo()});\n    }\n  }\n\n  /**\n   * Disposes of any blocks that exist on the workspace.\n   *\n   * @param workspace The workspace to clear the blocks of.\n   */\n  clear(workspace: Workspace) {\n    // Cannot use workspace.clear() because that also removes variables.\n    for (const block of workspace.getTopBlocks(false)) {\n      block.dispose(false);\n    }\n  }\n}\n\nserializationRegistry.register('blocks', new BlockSerializer());\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport interface IHasBubble {\n  /** @returns True if the bubble is currently open, false otherwise. */\n  bubbleIsVisible(): boolean;\n\n  /** Sets whether the bubble is open or not. */\n  setBubbleVisible(visible: boolean): Promise<void>;\n}\n\n/** Type guard that checks whether the given object is a IHasBubble. */\nexport function hasBubble(obj: any): obj is IHasBubble {\n  return (\n    obj.bubbleIsVisible !== undefined && obj.setBubbleVisible !== undefined\n  );\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.math\n\n/**\n * Converts degrees to radians.\n * Copied from Closure's goog.math.toRadians.\n *\n * @param angleDegrees Angle in degrees.\n * @returns Angle in radians.\n */\nexport function toRadians(angleDegrees: number): number {\n  return (angleDegrees * Math.PI) / 180;\n}\n\n/**\n * Converts radians to degrees.\n * Copied from Closure's goog.math.toDegrees.\n *\n * @param angleRadians Angle in radians.\n * @returns Angle in degrees.\n */\nexport function toDegrees(angleRadians: number): number {\n  return (angleRadians * 180) / Math.PI;\n}\n\n/**\n * Clamp the provided number between the lower bound and the upper bound.\n *\n * @param lowerBound The desired lower bound.\n * @param number The number to clamp.\n * @param upperBound The desired upper bound.\n * @returns The clamped number.\n */\nexport function clamp(\n  lowerBound: number,\n  number: number,\n  upperBound: number,\n): number {\n  if (upperBound < lowerBound) {\n    const temp = upperBound;\n    upperBound = lowerBound;\n    lowerBound = temp;\n  }\n  return Math.max(lowerBound, Math.min(number, upperBound));\n}\n","/**\n * @license\n * Copyright 2016 Massachusetts Institute of Technology\n * All rights reserved.\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A div that floats on top of the workspace, for drop-down menus.\n *\n * @class\n */\n// Former goog.module ID: Blockly.dropDownDiv\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as common from './common.js';\nimport * as dom from './utils/dom.js';\nimport type {Field} from './field.js';\nimport * as math from './utils/math.js';\nimport {Rect} from './utils/rect.js';\nimport type {Size} from './utils/size.js';\nimport * as style from './utils/style.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Arrow size in px. Should match the value in CSS\n * (need to position pre-render).\n */\nexport const ARROW_SIZE = 16;\n\n/**\n * Drop-down border size in px. Should match the value in CSS (need to position\n * the arrow).\n */\nexport const BORDER_SIZE = 1;\n\n/**\n * Amount the arrow must be kept away from the edges of the main drop-down div,\n * in px.\n */\nexport const ARROW_HORIZONTAL_PADDING = 12;\n\n/** Amount drop-downs should be padded away from the source, in px. */\nexport const PADDING_Y = 16;\n\n/** Length of animations in seconds. */\nexport const ANIMATION_TIME = 0.25;\n\n/**\n * Timer for animation out, to be cleared if we need to immediately hide\n * without disrupting new shows.\n */\nlet animateOutTimer: ReturnType<typeof setTimeout> | null = null;\n\n/** Callback for when the drop-down is hidden. */\nlet onHide: Function | null = null;\n\n/** A class name representing the current owner's workspace renderer. */\nlet renderedClassName = '';\n\n/** A class name representing the current owner's workspace theme. */\nlet themeClassName = '';\n\n/** The content element. */\nlet div: HTMLDivElement;\n\n/** The content element. */\nlet content: HTMLDivElement;\n\n/** The arrow element. */\nlet arrow: HTMLDivElement;\n\n/**\n * Drop-downs will appear within the bounds of this element if possible.\n * Set in setBoundsElement.\n */\nlet boundsElement: Element | null = null;\n\n/** The object currently using the drop-down. */\nlet owner: Field | null = null;\n\n/** Whether the dropdown was positioned to a field or the source block. */\nlet positionToField: boolean | null = null;\n\n/**\n * Dropdown bounds info object used to encapsulate sizing information about a\n * bounding element (bounding box and width/height).\n */\nexport interface BoundsInfo {\n  top: number;\n  left: number;\n  bottom: number;\n  right: number;\n  width: number;\n  height: number;\n}\n\n/** Dropdown position metrics. */\nexport interface PositionMetrics {\n  initialX: number;\n  initialY: number;\n  finalX: number;\n  finalY: number;\n  arrowX: number | null;\n  arrowY: number | null;\n  arrowAtTop: boolean | null;\n  arrowVisible: boolean;\n}\n\n/**\n * Create and insert the DOM element for this div.\n *\n * @internal\n */\nexport function createDom() {\n  if (document.querySelector('.blocklyDropDownDiv')) {\n    return; // Already created.\n  }\n  div = document.createElement('div');\n  div.className = 'blocklyDropDownDiv';\n  const parentDiv = common.getParentContainer() || document.body;\n  parentDiv.appendChild(div);\n\n  content = document.createElement('div');\n  content.className = 'blocklyDropDownContent';\n  div.appendChild(content);\n\n  arrow = document.createElement('div');\n  arrow.className = 'blocklyDropDownArrow';\n  div.appendChild(arrow);\n\n  div.style.opacity = '0';\n  // Transition animation for transform: translate() and opacity.\n  div.style.transition =\n    'transform ' + ANIMATION_TIME + 's, ' + 'opacity ' + ANIMATION_TIME + 's';\n\n  // Handle focusin/out events to add a visual indicator when\n  // a child is focused or blurred.\n  div.addEventListener('focusin', function () {\n    dom.addClass(div, 'blocklyFocused');\n  });\n  div.addEventListener('focusout', function () {\n    dom.removeClass(div, 'blocklyFocused');\n  });\n}\n\n/**\n * Set an element to maintain bounds within. Drop-downs will appear\n * within the box of this element if possible.\n *\n * @param boundsElem Element to bind drop-down to.\n */\nexport function setBoundsElement(boundsElem: Element | null) {\n  boundsElement = boundsElem;\n}\n\n/**\n * @returns The field that currently owns this, or null.\n */\nexport function getOwner(): Field | null {\n  return owner;\n}\n\n/**\n * Provide the div for inserting content into the drop-down.\n *\n * @returns Div to populate with content.\n */\nexport function getContentDiv(): Element {\n  return content;\n}\n\n/** Clear the content of the drop-down. */\nexport function clearContent() {\n  content.textContent = '';\n  content.style.width = '';\n}\n\n/**\n * Set the colour for the drop-down.\n *\n * @param backgroundColour Any CSS colour for the background.\n * @param borderColour Any CSS colour for the border.\n */\nexport function setColour(backgroundColour: string, borderColour: string) {\n  div.style.backgroundColor = backgroundColour;\n  div.style.borderColor = borderColour;\n}\n\n/**\n * Shortcut to show and place the drop-down with positioning determined\n * by a particular block. The primary position will be below the block,\n * and the secondary position above the block. Drop-down will be\n * constrained to the block's workspace.\n *\n * @param field The field showing the drop-down.\n * @param block Block to position the drop-down around.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @param opt_secondaryYOffset Optional Y offset for above-block positioning.\n * @returns True if the menu rendered below block; false if above.\n */\nexport function showPositionedByBlock<T>(\n  field: Field<T>,\n  block: BlockSvg,\n  opt_onHide?: Function,\n  opt_secondaryYOffset?: number,\n): boolean {\n  return showPositionedByRect(\n    getScaledBboxOfBlock(block),\n    field as Field,\n    opt_onHide,\n    opt_secondaryYOffset,\n  );\n}\n\n/**\n * Shortcut to show and place the drop-down with positioning determined\n * by a particular field. The primary position will be below the field,\n * and the secondary position above the field. Drop-down will be\n * constrained to the block's workspace.\n *\n * @param field The field to position the dropdown against.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @param opt_secondaryYOffset Optional Y offset for above-block positioning.\n * @returns True if the menu rendered below block; false if above.\n */\nexport function showPositionedByField<T>(\n  field: Field<T>,\n  opt_onHide?: Function,\n  opt_secondaryYOffset?: number,\n): boolean {\n  positionToField = true;\n  return showPositionedByRect(\n    getScaledBboxOfField(field as Field),\n    field as Field,\n    opt_onHide,\n    opt_secondaryYOffset,\n  );\n}\n/**\n * Get the scaled bounding box of a block.\n *\n * @param block The block.\n * @returns The scaled bounding box of the block.\n */\nfunction getScaledBboxOfBlock(block: BlockSvg): Rect {\n  const blockSvg = block.getSvgRoot();\n  const scale = block.workspace.scale;\n  const scaledHeight = block.height * scale;\n  const scaledWidth = block.width * scale;\n  const xy = style.getPageOffset(blockSvg);\n  return new Rect(xy.y, xy.y + scaledHeight, xy.x, xy.x + scaledWidth);\n}\n\n/**\n * Get the scaled bounding box of a field.\n *\n * @param field The field.\n * @returns The scaled bounding box of the field.\n */\nfunction getScaledBboxOfField(field: Field): Rect {\n  const bBox = field.getScaledBBox();\n  return new Rect(bBox.top, bBox.bottom, bBox.left, bBox.right);\n}\n\n/**\n * Helper method to show and place the drop-down with positioning determined\n * by a scaled bounding box.  The primary position will be below the rect,\n * and the secondary position above the rect. Drop-down will be constrained to\n * the block's workspace.\n *\n * @param bBox The scaled bounding box.\n * @param field The field to position the dropdown against.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @param opt_secondaryYOffset Optional Y offset for above-block positioning.\n * @returns True if the menu rendered below block; false if above.\n */\nfunction showPositionedByRect(\n  bBox: Rect,\n  field: Field,\n  opt_onHide?: Function,\n  opt_secondaryYOffset?: number,\n): boolean {\n  // If we can fit it, render below the block.\n  const primaryX = bBox.left + (bBox.right - bBox.left) / 2;\n  const primaryY = bBox.bottom;\n  // If we can't fit it, render above the entire parent block.\n  const secondaryX = primaryX;\n  let secondaryY = bBox.top;\n  if (opt_secondaryYOffset) {\n    secondaryY += opt_secondaryYOffset;\n  }\n  const sourceBlock = field.getSourceBlock() as BlockSvg;\n  // Set bounds to main workspace; show the drop-down.\n  let workspace = sourceBlock.workspace;\n  while (workspace.options.parentWorkspace) {\n    workspace = workspace.options.parentWorkspace;\n  }\n  setBoundsElement(workspace.getParentSvg().parentNode as Element | null);\n  return show(\n    field,\n    sourceBlock.RTL,\n    primaryX,\n    primaryY,\n    secondaryX,\n    secondaryY,\n    opt_onHide,\n  );\n}\n\n/**\n * Show and place the drop-down.\n * The drop-down is placed with an absolute \"origin point\" (x, y) - i.e.,\n * the arrow will point at this origin and box will positioned below or above\n * it.  If we can maintain the container bounds at the primary point, the arrow\n * will point there, and the container will be positioned below it.\n * If we can't maintain the container bounds at the primary point, fall-back to\n * the secondary point and position above.\n *\n * @param newOwner The object showing the drop-down\n * @param rtl Right-to-left (true) or left-to-right (false).\n * @param primaryX Desired origin point x, in absolute px.\n * @param primaryY Desired origin point y, in absolute px.\n * @param secondaryX Secondary/alternative origin point x, in absolute px.\n * @param secondaryY Secondary/alternative origin point y, in absolute px.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @returns True if the menu rendered at the primary origin point.\n * @internal\n */\nexport function show<T>(\n  newOwner: Field<T>,\n  rtl: boolean,\n  primaryX: number,\n  primaryY: number,\n  secondaryX: number,\n  secondaryY: number,\n  opt_onHide?: Function,\n): boolean {\n  owner = newOwner as Field;\n  onHide = opt_onHide || null;\n  // Set direction.\n  div.style.direction = rtl ? 'rtl' : 'ltr';\n\n  const mainWorkspace = common.getMainWorkspace() as WorkspaceSvg;\n  renderedClassName = mainWorkspace.getRenderer().getClassName();\n  themeClassName = mainWorkspace.getTheme().getClassName();\n  if (renderedClassName) {\n    dom.addClass(div, renderedClassName);\n  }\n  if (themeClassName) {\n    dom.addClass(div, themeClassName);\n  }\n\n  // When we change `translate` multiple times in close succession,\n  // Chrome may choose to wait and apply them all at once.\n  // Since we want the translation to initial X, Y to be immediate,\n  // and the translation to final X, Y to be animated,\n  // we saw problems where both would be applied after animation was turned on,\n  // making the dropdown appear to fly in from (0, 0).\n  // Using both `left`, `top` for the initial translation and then `translate`\n  // for the animated transition to final X, Y is a workaround.\n  return positionInternal(primaryX, primaryY, secondaryX, secondaryY);\n}\n\nconst internal = {\n  /**\n   * Get sizing info about the bounding element.\n   *\n   * @returns An object containing size information about the bounding element\n   *     (bounding box and width/height).\n   */\n  getBoundsInfo: function (): BoundsInfo {\n    const boundPosition = style.getPageOffset(boundsElement as Element);\n    const boundSize = style.getSize(boundsElement as Element);\n\n    return {\n      left: boundPosition.x,\n      right: boundPosition.x + boundSize.width,\n      top: boundPosition.y,\n      bottom: boundPosition.y + boundSize.height,\n      width: boundSize.width,\n      height: boundSize.height,\n    };\n  },\n\n  /**\n   * Helper to position the drop-down and the arrow, maintaining bounds.\n   * See explanation of origin points in show.\n   *\n   * @param primaryX Desired origin point x, in absolute px.\n   * @param primaryY Desired origin point y, in absolute px.\n   * @param secondaryX Secondary/alternative origin point x, in absolute px.\n   * @param secondaryY Secondary/alternative origin point y, in absolute px.\n   * @returns Various final metrics, including rendered positions for drop-down\n   *     and arrow.\n   */\n  getPositionMetrics: function (\n    primaryX: number,\n    primaryY: number,\n    secondaryX: number,\n    secondaryY: number,\n  ): PositionMetrics {\n    const boundsInfo = internal.getBoundsInfo();\n    const divSize = style.getSize(div as Element);\n\n    // Can we fit in-bounds below the target?\n    if (primaryY + divSize.height < boundsInfo.bottom) {\n      return getPositionBelowMetrics(primaryX, primaryY, boundsInfo, divSize);\n    }\n    // Can we fit in-bounds above the target?\n    if (secondaryY - divSize.height > boundsInfo.top) {\n      return getPositionAboveMetrics(\n        secondaryX,\n        secondaryY,\n        boundsInfo,\n        divSize,\n      );\n    }\n    // Can we fit outside the workspace bounds (but inside the window)\n    // below?\n    if (primaryY + divSize.height < document.documentElement.clientHeight) {\n      return getPositionBelowMetrics(primaryX, primaryY, boundsInfo, divSize);\n    }\n    // Can we fit outside the workspace bounds (but inside the window)\n    // above?\n    if (secondaryY - divSize.height > document.documentElement.clientTop) {\n      return getPositionAboveMetrics(\n        secondaryX,\n        secondaryY,\n        boundsInfo,\n        divSize,\n      );\n    }\n\n    // Last resort, render at top of page.\n    return getPositionTopOfPageMetrics(primaryX, boundsInfo, divSize);\n  },\n};\n\n/**\n * Get the metrics for positioning the div below the source.\n *\n * @param primaryX Desired origin point x, in absolute px.\n * @param primaryY Desired origin point y, in absolute px.\n * @param boundsInfo An object containing size information about the bounding\n *     element (bounding box and width/height).\n * @param divSize An object containing information about the size of the\n *     DropDownDiv (width & height).\n * @returns Various final metrics, including rendered positions for drop-down\n *     and arrow.\n */\nfunction getPositionBelowMetrics(\n  primaryX: number,\n  primaryY: number,\n  boundsInfo: BoundsInfo,\n  divSize: Size,\n): PositionMetrics {\n  const xCoords = getPositionX(\n    primaryX,\n    boundsInfo.left,\n    boundsInfo.right,\n    divSize.width,\n  );\n\n  const arrowY = -(ARROW_SIZE / 2 + BORDER_SIZE);\n  const finalY = primaryY + PADDING_Y;\n\n  return {\n    initialX: xCoords.divX,\n    initialY: primaryY,\n    finalX: xCoords.divX, // X position remains constant during animation.\n    finalY,\n    arrowX: xCoords.arrowX,\n    arrowY,\n    arrowAtTop: true,\n    arrowVisible: true,\n  };\n}\n\n/**\n * Get the metrics for positioning the div above the source.\n *\n * @param secondaryX Secondary/alternative origin point x, in absolute px.\n * @param secondaryY Secondary/alternative origin point y, in absolute px.\n * @param boundsInfo An object containing size information about the bounding\n *     element (bounding box and width/height).\n * @param divSize An object containing information about the size of the\n *     DropDownDiv (width & height).\n * @returns Various final metrics, including rendered positions for drop-down\n *     and arrow.\n */\nfunction getPositionAboveMetrics(\n  secondaryX: number,\n  secondaryY: number,\n  boundsInfo: BoundsInfo,\n  divSize: Size,\n): PositionMetrics {\n  const xCoords = getPositionX(\n    secondaryX,\n    boundsInfo.left,\n    boundsInfo.right,\n    divSize.width,\n  );\n\n  const arrowY = divSize.height - BORDER_SIZE * 2 - ARROW_SIZE / 2;\n  const finalY = secondaryY - divSize.height - PADDING_Y;\n  const initialY = secondaryY - divSize.height; // No padding on Y.\n\n  return {\n    initialX: xCoords.divX,\n    initialY,\n    finalX: xCoords.divX, // X position remains constant during animation.\n    finalY,\n    arrowX: xCoords.arrowX,\n    arrowY,\n    arrowAtTop: false,\n    arrowVisible: true,\n  };\n}\n\n/**\n * Get the metrics for positioning the div at the top of the page.\n *\n * @param sourceX Desired origin point x, in absolute px.\n * @param boundsInfo An object containing size information about the bounding\n *     element (bounding box and width/height).\n * @param divSize An object containing information about the size of the\n *     DropDownDiv (width & height).\n * @returns Various final metrics, including rendered positions for drop-down\n *     and arrow.\n */\nfunction getPositionTopOfPageMetrics(\n  sourceX: number,\n  boundsInfo: BoundsInfo,\n  divSize: Size,\n): PositionMetrics {\n  const xCoords = getPositionX(\n    sourceX,\n    boundsInfo.left,\n    boundsInfo.right,\n    divSize.width,\n  );\n\n  // No need to provide arrow-specific information because it won't be visible.\n  return {\n    initialX: xCoords.divX,\n    initialY: 0,\n    finalX: xCoords.divX, // X position remains constant during animation.\n    finalY: 0, // Y position remains constant during animation.\n    arrowAtTop: null,\n    arrowX: null,\n    arrowY: null,\n    arrowVisible: false,\n  };\n}\n\n/**\n * Get the x positions for the left side of the DropDownDiv and the arrow,\n * accounting for the bounds of the workspace.\n *\n * @param sourceX Desired origin point x, in absolute px.\n * @param boundsLeft The left edge of the bounding element, in absolute px.\n * @param boundsRight The right edge of the bounding element, in absolute px.\n * @param divWidth The width of the div in px.\n * @returns An object containing metrics for the x positions of the left side of\n *     the DropDownDiv and the arrow.\n * @internal\n */\nexport function getPositionX(\n  sourceX: number,\n  boundsLeft: number,\n  boundsRight: number,\n  divWidth: number,\n): {divX: number; arrowX: number} {\n  let divX = sourceX;\n  // Offset the topLeft coord so that the dropdowndiv is centered.\n  divX -= divWidth / 2;\n  // Fit the dropdowndiv within the bounds of the workspace.\n  divX = math.clamp(boundsLeft, divX, boundsRight - divWidth);\n\n  let arrowX = sourceX;\n  // Offset the arrow coord so that the arrow is centered.\n  arrowX -= ARROW_SIZE / 2;\n  // Convert the arrow position to be relative to the top left of the div.\n  let relativeArrowX = arrowX - divX;\n  const horizPadding = ARROW_HORIZONTAL_PADDING;\n  // Clamp the arrow position so that it stays attached to the dropdowndiv.\n  relativeArrowX = math.clamp(\n    horizPadding,\n    relativeArrowX,\n    divWidth - horizPadding - ARROW_SIZE,\n  );\n\n  return {arrowX: relativeArrowX, divX};\n}\n\n/**\n * Is the container visible?\n *\n * @returns True if visible.\n */\nexport function isVisible(): boolean {\n  return !!owner;\n}\n\n/**\n * Hide the menu only if it is owned by the provided object.\n *\n * @param divOwner Object which must be owning the drop-down to hide.\n * @param opt_withoutAnimation True if we should hide the dropdown without\n *     animating.\n * @returns True if hidden.\n */\nexport function hideIfOwner<T>(\n  divOwner: Field<T>,\n  opt_withoutAnimation?: boolean,\n): boolean {\n  if (owner === divOwner) {\n    if (opt_withoutAnimation) {\n      hideWithoutAnimation();\n    } else {\n      hide();\n    }\n    return true;\n  }\n  return false;\n}\n\n/** Hide the menu, triggering animation. */\nexport function hide() {\n  // Start the animation by setting the translation and fading out.\n  // Reset to (initialX, initialY) - i.e., no translation.\n  div.style.transform = 'translate(0, 0)';\n  div.style.opacity = '0';\n  // Finish animation - reset all values to default.\n  animateOutTimer = setTimeout(function () {\n    hideWithoutAnimation();\n  }, ANIMATION_TIME * 1000);\n  if (onHide) {\n    onHide();\n    onHide = null;\n  }\n}\n\n/** Hide the menu, without animation. */\nexport function hideWithoutAnimation() {\n  if (!isVisible()) {\n    return;\n  }\n  if (animateOutTimer) {\n    clearTimeout(animateOutTimer);\n  }\n\n  // Reset style properties in case this gets called directly\n  // instead of hide() - see discussion on #2551.\n  div.style.transform = '';\n  div.style.left = '';\n  div.style.top = '';\n  div.style.opacity = '0';\n  div.style.display = 'none';\n  div.style.backgroundColor = '';\n  div.style.borderColor = '';\n\n  if (onHide) {\n    onHide();\n    onHide = null;\n  }\n  clearContent();\n  owner = null;\n\n  if (renderedClassName) {\n    dom.removeClass(div, renderedClassName);\n    renderedClassName = '';\n  }\n  if (themeClassName) {\n    dom.removeClass(div, themeClassName);\n    themeClassName = '';\n  }\n  (common.getMainWorkspace() as WorkspaceSvg).markFocused();\n}\n\n/**\n * Set the dropdown div's position.\n *\n * @param primaryX Desired origin point x, in absolute px.\n * @param primaryY Desired origin point y, in absolute px.\n * @param secondaryX Secondary/alternative origin point x, in absolute px.\n * @param secondaryY Secondary/alternative origin point y, in absolute px.\n * @returns True if the menu rendered at the primary origin point.\n */\nfunction positionInternal(\n  primaryX: number,\n  primaryY: number,\n  secondaryX: number,\n  secondaryY: number,\n): boolean {\n  const metrics = internal.getPositionMetrics(\n    primaryX,\n    primaryY,\n    secondaryX,\n    secondaryY,\n  );\n\n  // Update arrow CSS.\n  if (metrics.arrowVisible) {\n    arrow.style.display = '';\n    arrow.style.transform =\n      'translate(' +\n      metrics.arrowX +\n      'px,' +\n      metrics.arrowY +\n      'px) rotate(45deg)';\n    arrow.setAttribute(\n      'class',\n      metrics.arrowAtTop\n        ? 'blocklyDropDownArrow blocklyArrowTop'\n        : 'blocklyDropDownArrow blocklyArrowBottom',\n    );\n  } else {\n    arrow.style.display = 'none';\n  }\n\n  const initialX = Math.floor(metrics.initialX);\n  const initialY = Math.floor(metrics.initialY);\n  const finalX = Math.floor(metrics.finalX);\n  const finalY = Math.floor(metrics.finalY);\n\n  // First apply initial translation.\n  div.style.left = initialX + 'px';\n  div.style.top = initialY + 'px';\n\n  // Show the div.\n  div.style.display = 'block';\n  div.style.opacity = '1';\n  // Add final translate, animated through `transition`.\n  // Coordinates are relative to (initialX, initialY),\n  // where the drop-down is absolutely positioned.\n  const dx = finalX - initialX;\n  const dy = finalY - initialY;\n  div.style.transform = 'translate(' + dx + 'px,' + dy + 'px)';\n\n  return !!metrics.arrowAtTop;\n}\n\n/**\n * Repositions the dropdownDiv on window resize. If it doesn't know how to\n * calculate the new position, it will just hide it instead.\n *\n * @internal\n */\nexport function repositionForWindowResize() {\n  // This condition mainly catches the dropdown div when it is being used as a\n  // dropdown.  It is important not to close it in this case because on Android,\n  // when a field is focused, the soft keyboard opens triggering a window resize\n  // event and we want the dropdown div to stick around so users can type into\n  // it.\n  if (owner) {\n    const block = owner.getSourceBlock() as BlockSvg;\n    const bBox = positionToField\n      ? getScaledBboxOfField(owner)\n      : getScaledBboxOfBlock(block);\n    // If we can fit it, render below the block.\n    const primaryX = bBox.left + (bBox.right - bBox.left) / 2;\n    const primaryY = bBox.bottom;\n    // If we can't fit it, render above the entire parent block.\n    const secondaryX = primaryX;\n    const secondaryY = bBox.top;\n    positionInternal(primaryX, primaryY, secondaryX, secondaryY);\n  } else {\n    hide();\n  }\n}\n\nexport const TEST_ONLY = internal;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.string\n\n/**\n * Given an array of strings, return the length of the shortest one.\n *\n * @param array Array of strings.\n * @returns Length of shortest string.\n */\nexport function shortestStringLength(array: string[]): number {\n  if (!array.length) {\n    return 0;\n  }\n  return array.reduce(function (a, b) {\n    return a.length < b.length ? a : b;\n  }).length;\n}\n\n/**\n * Given an array of strings, return the length of the common prefix.\n * Words may not be split.  Any space after a word is included in the length.\n *\n * @param array Array of strings.\n * @param opt_shortest Length of shortest string.\n * @returns Length of common prefix.\n */\nexport function commonWordPrefix(\n  array: string[],\n  opt_shortest?: number,\n): number {\n  if (!array.length) {\n    return 0;\n  } else if (array.length === 1) {\n    return array[0].length;\n  }\n  let wordPrefix = 0;\n  const max = opt_shortest || shortestStringLength(array);\n  let len;\n  for (len = 0; len < max; len++) {\n    const letter = array[0][len];\n    for (let i = 1; i < array.length; i++) {\n      if (letter !== array[i][len]) {\n        return wordPrefix;\n      }\n    }\n    if (letter === ' ') {\n      wordPrefix = len + 1;\n    }\n  }\n  for (let i = 1; i < array.length; i++) {\n    const letter = array[i][len];\n    if (letter && letter !== ' ') {\n      return wordPrefix;\n    }\n  }\n  return max;\n}\n\n/**\n * Given an array of strings, return the length of the common suffix.\n * Words may not be split.  Any space after a word is included in the length.\n *\n * @param array Array of strings.\n * @param opt_shortest Length of shortest string.\n * @returns Length of common suffix.\n */\nexport function commonWordSuffix(\n  array: string[],\n  opt_shortest?: number,\n): number {\n  if (!array.length) {\n    return 0;\n  } else if (array.length === 1) {\n    return array[0].length;\n  }\n  let wordPrefix = 0;\n  const max = opt_shortest || shortestStringLength(array);\n  let len;\n  for (len = 0; len < max; len++) {\n    const letter = array[0].substr(-len - 1, 1);\n    for (let i = 1; i < array.length; i++) {\n      if (letter !== array[i].substr(-len - 1, 1)) {\n        return wordPrefix;\n      }\n    }\n    if (letter === ' ') {\n      wordPrefix = len + 1;\n    }\n  }\n  for (let i = 1; i < array.length; i++) {\n    const letter = array[i].charAt(array[i].length - len - 1);\n    if (letter && letter !== ' ') {\n      return wordPrefix;\n    }\n  }\n  return max;\n}\n\n/**\n * Wrap text to the specified width.\n *\n * @param text Text to wrap.\n * @param limit Width to wrap each line.\n * @returns Wrapped text.\n */\nexport function wrap(text: string, limit: number): string {\n  const lines = text.split('\\n');\n  for (let i = 0; i < lines.length; i++) {\n    lines[i] = wrapLine(lines[i], limit);\n  }\n  return lines.join('\\n');\n}\n\n/**\n * Wrap single line of text to the specified width.\n *\n * @param text Text to wrap.\n * @param limit Width to wrap each line.\n * @returns Wrapped text.\n */\nfunction wrapLine(text: string, limit: number): string {\n  if (text.length <= limit) {\n    // Short text, no need to wrap.\n    return text;\n  }\n  // Split the text into words.\n  const words = text.trim().split(/\\s+/);\n  // Set limit to be the length of the largest word.\n  for (let i = 0; i < words.length; i++) {\n    if (words[i].length > limit) {\n      limit = words[i].length;\n    }\n  }\n\n  let lastScore;\n  let score = -Infinity;\n  let lastText;\n  let lineCount = 1;\n  do {\n    lastScore = score;\n    lastText = text;\n    // Create a list of booleans representing if a space (false) or\n    // a break (true) appears after each word.\n    let wordBreaks = [];\n    // Seed the list with evenly spaced linebreaks.\n    const steps = words.length / lineCount;\n    let insertedBreaks = 1;\n    for (let i = 0; i < words.length - 1; i++) {\n      if (insertedBreaks < (i + 1.5) / steps) {\n        insertedBreaks++;\n        wordBreaks[i] = true;\n      } else {\n        wordBreaks[i] = false;\n      }\n    }\n    wordBreaks = wrapMutate(words, wordBreaks, limit);\n    score = wrapScore(words, wordBreaks, limit);\n    text = wrapToText(words, wordBreaks);\n    lineCount++;\n  } while (score > lastScore);\n  return lastText;\n}\n\n/**\n * Compute a score for how good the wrapping is.\n *\n * @param words Array of each word.\n * @param wordBreaks Array of line breaks.\n * @param limit Width to wrap each line.\n * @returns Larger the better.\n */\nfunction wrapScore(\n  words: string[],\n  wordBreaks: boolean[],\n  limit: number,\n): number {\n  // If this function becomes a performance liability, add caching.\n  // Compute the length of each line.\n  const lineLengths = [0];\n  const linePunctuation = [];\n  for (let i = 0; i < words.length; i++) {\n    lineLengths[lineLengths.length - 1] += words[i].length;\n    if (wordBreaks[i] === true) {\n      lineLengths.push(0);\n      linePunctuation.push(words[i].charAt(words[i].length - 1));\n    } else if (wordBreaks[i] === false) {\n      lineLengths[lineLengths.length - 1]++;\n    }\n  }\n  const maxLength = Math.max(...lineLengths);\n\n  let score = 0;\n  for (let i = 0; i < lineLengths.length; i++) {\n    // Optimize for width.\n    // -2 points per char over limit (scaled to the power of 1.5).\n    score -= Math.pow(Math.abs(limit - lineLengths[i]), 1.5) * 2;\n    // Optimize for even lines.\n    // -1 point per char smaller than max (scaled to the power of 1.5).\n    score -= Math.pow(maxLength - lineLengths[i], 1.5);\n    // Optimize for structure.\n    // Add score to line endings after punctuation.\n    if ('.?!'.includes(linePunctuation[i])) {\n      score += limit / 3;\n    } else if (',;)]}'.includes(linePunctuation[i])) {\n      score += limit / 4;\n    }\n  }\n  // All else being equal, the last line should not be longer than the\n  // previous line.  For example, this looks wrong:\n  // aaa bbb\n  // ccc ddd eee\n  if (\n    lineLengths.length > 1 &&\n    lineLengths[lineLengths.length - 1] <= lineLengths[lineLengths.length - 2]\n  ) {\n    score += 0.5;\n  }\n  return score;\n}\n/**\n * Mutate the array of line break locations until an optimal solution is found.\n * No line breaks are added or deleted, they are simply moved around.\n *\n * @param words Array of each word.\n * @param wordBreaks Array of line breaks.\n * @param limit Width to wrap each line.\n * @returns New array of optimal line breaks.\n */\nfunction wrapMutate(\n  words: string[],\n  wordBreaks: boolean[],\n  limit: number,\n): boolean[] {\n  let bestScore = wrapScore(words, wordBreaks, limit);\n  let bestBreaks;\n  // Try shifting every line break forward or backward.\n  for (let i = 0; i < wordBreaks.length - 1; i++) {\n    if (wordBreaks[i] === wordBreaks[i + 1]) {\n      continue;\n    }\n    const mutatedWordBreaks = new Array<boolean>().concat(wordBreaks);\n    mutatedWordBreaks[i] = !mutatedWordBreaks[i];\n    mutatedWordBreaks[i + 1] = !mutatedWordBreaks[i + 1];\n    const mutatedScore = wrapScore(words, mutatedWordBreaks, limit);\n    if (mutatedScore > bestScore) {\n      bestScore = mutatedScore;\n      bestBreaks = mutatedWordBreaks;\n    }\n  }\n  if (bestBreaks) {\n    // Found an improvement.  See if it may be improved further.\n    return wrapMutate(words, bestBreaks, limit);\n  }\n  // No improvements found.  Done.\n  return wordBreaks;\n}\n\n/**\n * Reassemble the array of words into text, with the specified line breaks.\n *\n * @param words Array of each word.\n * @param wordBreaks Array of line breaks.\n * @returns Plain text.\n */\nfunction wrapToText(words: string[], wordBreaks: boolean[]): string {\n  const text = [];\n  for (let i = 0; i < words.length; i++) {\n    text.push(words[i]);\n    if (wordBreaks[i] !== undefined) {\n      text.push(wordBreaks[i] ? '\\n' : ' ');\n    }\n  }\n  return text.join('');\n}\n\n/**\n * Is the given string a number (includes negative and decimals).\n *\n * @param str Input string.\n * @returns True if number, false otherwise.\n */\nexport function isNumber(str: string): boolean {\n  return /^\\s*-?\\d+(\\.\\d+)?\\s*$/.test(str);\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Tooltip\n\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\nimport * as blocklyString from './utils/string.js';\n\n/**\n * A type which can define a tooltip.\n * Either a string, an object containing a tooltip property, or a function which\n * returns either a string, or another arbitrarily nested function which\n * eventually unwinds to a string.\n */\nexport type TipInfo =\n  | string\n  | {tooltip: AnyDuringMigration}\n  | (() => TipInfo | string | Function);\n\n/**\n * A function that renders custom tooltip UI.\n * 1st parameter: the div element to render content into.\n * 2nd parameter: the element being moused over (i.e., the element for which the\n * tooltip should be shown).\n */\nexport type CustomTooltip = (p1: Element, p2: Element) => AnyDuringMigration;\n\n/**\n * An optional function that renders custom tooltips into the provided DIV. If\n * this is defined, the function will be called instead of rendering the default\n * tooltip UI.\n */\nlet customTooltip: CustomTooltip | undefined = undefined;\n\n/**\n * Sets a custom function that will be called if present instead of the default\n * tooltip UI.\n *\n * @param customFn A custom tooltip used to render an alternate tooltip UI.\n */\nexport function setCustomTooltip(customFn: CustomTooltip) {\n  customTooltip = customFn;\n}\n\n/**\n * Gets the custom tooltip function.\n *\n * @returns The custom tooltip function, if defined.\n */\nexport function getCustomTooltip(): CustomTooltip | undefined {\n  return customTooltip;\n}\n\n/** Is a tooltip currently showing? */\nlet visible = false;\n\n/**\n * Returns whether or not a tooltip is showing\n *\n * @returns True if a tooltip is showing\n */\nexport function isVisible(): boolean {\n  return visible;\n}\n\n/** Is someone else blocking the tooltip from being shown? */\nlet blocked = false;\n\n/**\n * Maximum width (in characters) of a tooltip.\n */\nexport const LIMIT = 50;\n\n/** PID of suspended thread to clear tooltip on mouse out. */\nlet mouseOutPid: AnyDuringMigration = 0;\n\n/** PID of suspended thread to show the tooltip. */\nlet showPid: AnyDuringMigration = 0;\n\n/**\n * Last observed X location of the mouse pointer (freezes when tooltip appears).\n */\nlet lastX = 0;\n\n/**\n * Last observed Y location of the mouse pointer (freezes when tooltip appears).\n */\nlet lastY = 0;\n\n/** Current element being pointed at. */\nlet element: AnyDuringMigration = null;\n\n/**\n * Once a tooltip has opened for an element, that element is 'poisoned' and\n * cannot respawn a tooltip until the pointer moves over a different element.\n */\nlet poisonedElement: AnyDuringMigration = null;\n\n/**\n * Horizontal offset between mouse cursor and tooltip.\n */\nexport const OFFSET_X = 0;\n\n/**\n * Vertical offset between mouse cursor and tooltip.\n */\nexport const OFFSET_Y = 10;\n\n/**\n * Radius mouse can move before killing tooltip.\n */\nexport const RADIUS_OK = 10;\n\n/**\n * Delay before tooltip appears.\n */\nexport const HOVER_MS = 750;\n\n/**\n * Horizontal padding between tooltip and screen edge.\n */\nexport const MARGINS = 5;\n\n/** The HTML container.  Set once by createDom. */\nlet containerDiv: HTMLDivElement | null = null;\n\n/**\n * Returns the HTML tooltip container.\n *\n * @returns The HTML tooltip container.\n */\nexport function getDiv(): HTMLDivElement | null {\n  return containerDiv;\n}\n\n/**\n * Returns the tooltip text for the given element.\n *\n * @param object The object to get the tooltip text of.\n * @returns The tooltip text of the element.\n */\nexport function getTooltipOfObject(object: AnyDuringMigration | null): string {\n  const obj = getTargetObject(object);\n  if (obj) {\n    let tooltip = obj.tooltip;\n    while (typeof tooltip === 'function') {\n      tooltip = tooltip();\n    }\n    if (typeof tooltip !== 'string') {\n      throw Error('Tooltip function must return a string.');\n    }\n    return tooltip;\n  }\n  return '';\n}\n\n/**\n * Returns the target object that the given object is targeting for its\n * tooltip. Could be the object itself.\n *\n * @param obj The object are trying to find the target tooltip object of.\n * @returns The target tooltip object.\n */\nfunction getTargetObject(\n  obj: object | null,\n): {tooltip: AnyDuringMigration} | null {\n  while (obj && (obj as any).tooltip) {\n    if (\n      typeof (obj as any).tooltip === 'string' ||\n      typeof (obj as any).tooltip === 'function'\n    ) {\n      return obj as {tooltip: string | (() => string)};\n    }\n    obj = (obj as any).tooltip;\n  }\n  return null;\n}\n\n/**\n * Create the tooltip div and inject it onto the page.\n */\nexport function createDom() {\n  if (document.querySelector('.blocklyTooltipDiv')) {\n    return; // Already created.\n  }\n  // Create an HTML container for popup overlays (e.g. editor widgets).\n  containerDiv = document.createElement('div');\n  containerDiv.className = 'blocklyTooltipDiv';\n  const container = common.getParentContainer() || document.body;\n  container.appendChild(containerDiv);\n}\n\n/**\n * Binds the required mouse events onto an SVG element.\n *\n * @param element SVG element onto which tooltip is to be bound.\n */\nexport function bindMouseEvents(element: Element) {\n  // TODO (#6097): Don't stash wrapper info on the DOM.\n  (element as AnyDuringMigration).mouseOverWrapper_ = browserEvents.bind(\n    element,\n    'pointerover',\n    null,\n    onMouseOver,\n  );\n  (element as AnyDuringMigration).mouseOutWrapper_ = browserEvents.bind(\n    element,\n    'pointerout',\n    null,\n    onMouseOut,\n  );\n\n  // Don't use bindEvent_ for mousemove since that would create a\n  // corresponding touch handler, even though this only makes sense in the\n  // context of a mouseover/mouseout.\n  element.addEventListener('pointermove', onMouseMove, false);\n}\n\n/**\n * Unbinds tooltip mouse events from the SVG element.\n *\n * @param element SVG element onto which tooltip is bound.\n */\nexport function unbindMouseEvents(element: Element | null) {\n  if (!element) {\n    return;\n  }\n  // TODO (#6097): Don't stash wrapper info on the DOM.\n  browserEvents.unbind((element as AnyDuringMigration).mouseOverWrapper_);\n  browserEvents.unbind((element as AnyDuringMigration).mouseOutWrapper_);\n  element.removeEventListener('pointermove', onMouseMove);\n}\n\n/**\n * Hide the tooltip if the mouse is over a different object.\n * Initialize the tooltip to potentially appear for this object.\n *\n * @param e Mouse event.\n */\nfunction onMouseOver(e: PointerEvent) {\n  if (blocked) {\n    // Someone doesn't want us to show tooltips.\n    return;\n  }\n  // If the tooltip is an object, treat it as a pointer to the next object in\n  // the chain to look at.  Terminate when a string or function is found.\n  const newElement = getTargetObject(e.currentTarget);\n  if (element !== newElement) {\n    hide();\n    poisonedElement = null;\n    element = newElement;\n  }\n  // Forget about any immediately preceding mouseOut event.\n  clearTimeout(mouseOutPid);\n}\n\n/**\n * Hide the tooltip if the mouse leaves the object and enters the workspace.\n *\n * @param _e Mouse event.\n */\nfunction onMouseOut(_e: PointerEvent) {\n  if (blocked) {\n    // Someone doesn't want us to show tooltips.\n    return;\n  }\n  // Moving from one element to another (overlapping or with no gap) generates\n  // a mouseOut followed instantly by a mouseOver.  Fork off the mouseOut\n  // event and kill it if a mouseOver is received immediately.\n  // This way the task only fully executes if mousing into the void.\n  mouseOutPid = setTimeout(function () {\n    element = null;\n    poisonedElement = null;\n    hide();\n  }, 1);\n  clearTimeout(showPid);\n  showPid = 0;\n}\n\n/**\n * When hovering over an element, schedule a tooltip to be shown.  If a tooltip\n * is already visible, hide it if the mouse strays out of a certain radius.\n *\n * @param e Mouse event.\n */\nfunction onMouseMove(e: Event) {\n  if (!element || !(element as AnyDuringMigration).tooltip) {\n    // No tooltip here to show.\n    return;\n  } else if (blocked) {\n    // Someone doesn't want us to show tooltips.  We are probably handling a\n    // user gesture, such as a click or drag.\n    return;\n  }\n  if (visible) {\n    // Compute the distance between the mouse position when the tooltip was\n    // shown and the current mouse position.  Pythagorean theorem.\n    // AnyDuringMigration because:  Property 'pageX' does not exist on type\n    // 'Event'.\n    const dx = lastX - (e as AnyDuringMigration).pageX;\n    // AnyDuringMigration because:  Property 'pageY' does not exist on type\n    // 'Event'.\n    const dy = lastY - (e as AnyDuringMigration).pageY;\n    if (Math.sqrt(dx * dx + dy * dy) > RADIUS_OK) {\n      hide();\n    }\n  } else if (poisonedElement !== element) {\n    // The mouse moved, clear any previously scheduled tooltip.\n    clearTimeout(showPid);\n    // Maybe this time the mouse will stay put.  Schedule showing of tooltip.\n    // AnyDuringMigration because:  Property 'pageX' does not exist on type\n    // 'Event'.\n    lastX = (e as AnyDuringMigration).pageX;\n    // AnyDuringMigration because:  Property 'pageY' does not exist on type\n    // 'Event'.\n    lastY = (e as AnyDuringMigration).pageY;\n    showPid = setTimeout(show, HOVER_MS);\n  }\n}\n\n/**\n * Dispose of the tooltip.\n *\n * @internal\n */\nexport function dispose() {\n  element = null;\n  poisonedElement = null;\n  hide();\n}\n\n/**\n * Hide the tooltip.\n */\nexport function hide() {\n  if (visible) {\n    visible = false;\n    if (containerDiv) {\n      containerDiv.style.display = 'none';\n    }\n  }\n  if (showPid) {\n    clearTimeout(showPid);\n    showPid = 0;\n  }\n}\n\n/**\n * Hide any in-progress tooltips and block showing new tooltips until the next\n * call to unblock().\n *\n * @internal\n */\nexport function block() {\n  hide();\n  blocked = true;\n}\n\n/**\n * Unblock tooltips: allow them to be scheduled and shown according to their own\n * logic.\n *\n * @internal\n */\nexport function unblock() {\n  blocked = false;\n}\n\n/** Renders the tooltip content into the tooltip div. */\nfunction renderContent() {\n  if (!containerDiv || !element) {\n    // This shouldn't happen, but if it does, we can't render.\n    return;\n  }\n  if (typeof customTooltip === 'function') {\n    customTooltip(containerDiv, element);\n  } else {\n    renderDefaultContent();\n  }\n}\n\n/** Renders the default tooltip UI. */\nfunction renderDefaultContent() {\n  let tip = getTooltipOfObject(element);\n  tip = blocklyString.wrap(tip, LIMIT);\n  // Create new text, line by line.\n  const lines = tip.split('\\n');\n  for (let i = 0; i < lines.length; i++) {\n    const div = document.createElement('div');\n    div.appendChild(document.createTextNode(lines[i]));\n    containerDiv!.appendChild(div);\n  }\n}\n\n/**\n * Gets the coordinates for the tooltip div, taking into account the edges of\n * the screen to prevent showing the tooltip offscreen.\n *\n * @param rtl True if the tooltip should be in right-to-left layout.\n * @returns Coordinates at which the tooltip div should be placed.\n */\nfunction getPosition(rtl: boolean): {x: number; y: number} {\n  // Position the tooltip just below the cursor.\n  const windowWidth = document.documentElement.clientWidth;\n  const windowHeight = document.documentElement.clientHeight;\n\n  let anchorX = lastX;\n  if (rtl) {\n    anchorX -= OFFSET_X + containerDiv!.offsetWidth;\n  } else {\n    anchorX += OFFSET_X;\n  }\n\n  let anchorY = lastY + OFFSET_Y;\n  if (anchorY + containerDiv!.offsetHeight > windowHeight + window.scrollY) {\n    // Falling off the bottom of the screen; shift the tooltip up.\n    anchorY -= containerDiv!.offsetHeight + 2 * OFFSET_Y;\n  }\n\n  if (rtl) {\n    // Prevent falling off left edge in RTL mode.\n    anchorX = Math.max(MARGINS - window.scrollX, anchorX);\n  } else {\n    if (\n      anchorX + containerDiv!.offsetWidth >\n      windowWidth + window.scrollX - 2 * MARGINS\n    ) {\n      // Falling off the right edge of the screen;\n      // clamp the tooltip on the edge.\n      anchorX = windowWidth - containerDiv!.offsetWidth - 2 * MARGINS;\n    }\n  }\n\n  return {x: anchorX, y: anchorY};\n}\n\n/** Create the tooltip and show it. */\nfunction show() {\n  if (blocked) {\n    // Someone doesn't want us to show tooltips.\n    return;\n  }\n  poisonedElement = element;\n  if (!containerDiv) {\n    return;\n  }\n  // Erase all existing text.\n  containerDiv.textContent = '';\n\n  // Add new content.\n  renderContent();\n\n  // Display the tooltip.\n  const rtl = (element as any).RTL;\n  containerDiv.style.direction = rtl ? 'rtl' : 'ltr';\n  containerDiv.style.display = 'block';\n  visible = true;\n\n  const {x, y} = getPosition(rtl);\n  containerDiv.style.left = x + 'px';\n  containerDiv.style.top = y + 'px';\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.colour\n\n/**\n * The richness of block colours, regardless of the hue.\n * Must be in the range of 0 (inclusive) to 1 (exclusive).\n */\nlet hsvSaturation = 0.45;\n\n/**\n * Get the richness of block colours, regardless of the hue.\n *\n * @returns The current richness.\n * @internal\n */\nexport function getHsvSaturation(): number {\n  return hsvSaturation;\n}\n\n/**\n * Set the richness of block colours, regardless of the hue.\n *\n * @param newSaturation The new richness, in the range of  0 (inclusive) to 1\n *     (exclusive)\n * @internal\n */\nexport function setHsvSaturation(newSaturation: number) {\n  hsvSaturation = newSaturation;\n}\n\n/**\n * The intensity of block colours, regardless of the hue.\n * Must be in the range of 0 (inclusive) to 1 (exclusive).\n */\nlet hsvValue = 0.65;\n\n/**\n * Get the intensity of block colours, regardless of the hue.\n *\n * @returns The current intensity.\n * @internal\n */\nexport function getHsvValue(): number {\n  return hsvValue;\n}\n\n/**\n * Set the intensity of block colours, regardless of the hue.\n *\n * @param newValue The new intensity, in the range of  0 (inclusive) to 1\n *     (exclusive)\n * @internal\n */\nexport function setHsvValue(newValue: number) {\n  hsvValue = newValue;\n}\n\n/**\n * Parses a colour from a string.\n * .parse('red') = '#ff0000'\n * .parse('#f00') = '#ff0000'\n * .parse('#ff0000') = '#ff0000'\n * .parse('0xff0000') = '#ff0000'\n * .parse('rgb(255, 0, 0)') = '#ff0000'\n *\n * @param str Colour in some CSS format.\n * @returns A string containing a hex representation of the colour, or null if\n *     can't be parsed.\n */\nexport function parse(str: string | number): string | null {\n  str = `${str}`.toLowerCase().trim();\n  let hex = names[str];\n  if (hex) {\n    // e.g. 'red'\n    return hex;\n  }\n  hex = str.substring(0, 2) === '0x' ? '#' + str.substring(2) : str;\n  hex = hex[0] === '#' ? hex : '#' + hex;\n  if (/^#[0-9a-f]{6}$/.test(hex)) {\n    // e.g. '#00ff88'\n    return hex;\n  }\n  if (/^#[0-9a-f]{3}$/.test(hex)) {\n    // e.g. '#0f8'\n    return ['#', hex[1], hex[1], hex[2], hex[2], hex[3], hex[3]].join('');\n  }\n  const rgb = str.match(/^(?:rgb)?\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/);\n  if (rgb) {\n    // e.g. 'rgb(0, 128, 255)'\n    const r = Number(rgb[1]);\n    const g = Number(rgb[2]);\n    const b = Number(rgb[3]);\n    if (r >= 0 && r < 256 && g >= 0 && g < 256 && b >= 0 && b < 256) {\n      return rgbToHex(r, g, b);\n    }\n  }\n  return null;\n}\n\n/**\n * Converts a colour from RGB to hex representation.\n *\n * @param r Amount of red, int between 0 and 255.\n * @param g Amount of green, int between 0 and 255.\n * @param b Amount of blue, int between 0 and 255.\n * @returns Hex representation of the colour.\n */\nexport function rgbToHex(r: number, g: number, b: number): string {\n  const rgb = (r << 16) | (g << 8) | b;\n  if (r < 0x10) {\n    return '#' + (0x1000000 | rgb).toString(16).substr(1);\n  }\n  return '#' + rgb.toString(16);\n}\n\n/**\n * Converts a colour to RGB.\n *\n * @param colour String representing colour in any colour format ('#ff0000',\n *     'red', '0xff000', etc).\n * @returns RGB representation of the colour.\n */\nexport function hexToRgb(colour: string): number[] {\n  const hex = parse(colour);\n  if (!hex) {\n    return [0, 0, 0];\n  }\n\n  const rgb = parseInt(hex.substr(1), 16);\n  const r = rgb >> 16;\n  const g = (rgb >> 8) & 255;\n  const b = rgb & 255;\n\n  return [r, g, b];\n}\n\n/**\n * Converts an HSV triplet to hex representation.\n *\n * @param h Hue value in [0, 360].\n * @param s Saturation value in [0, 1].\n * @param v Brightness in [0, 255].\n * @returns Hex representation of the colour.\n */\nexport function hsvToHex(h: number, s: number, v: number): string {\n  let red = 0;\n  let green = 0;\n  let blue = 0;\n  if (s === 0) {\n    red = v;\n    green = v;\n    blue = v;\n  } else {\n    const sextant = Math.floor(h / 60);\n    const remainder = h / 60 - sextant;\n    const val1 = v * (1 - s);\n    const val2 = v * (1 - s * remainder);\n    const val3 = v * (1 - s * (1 - remainder));\n    switch (sextant) {\n      case 1:\n        red = val2;\n        green = v;\n        blue = val1;\n        break;\n      case 2:\n        red = val1;\n        green = v;\n        blue = val3;\n        break;\n      case 3:\n        red = val1;\n        green = val2;\n        blue = v;\n        break;\n      case 4:\n        red = val3;\n        green = val1;\n        blue = v;\n        break;\n      case 5:\n        red = v;\n        green = val1;\n        blue = val2;\n        break;\n      case 6:\n      case 0:\n        red = v;\n        green = val3;\n        blue = val1;\n        break;\n    }\n  }\n  return rgbToHex(Math.floor(red), Math.floor(green), Math.floor(blue));\n}\n\n/**\n * Blend two colours together, using the specified factor to indicate the\n * weight given to the first colour.\n *\n * @param colour1 First colour.\n * @param colour2 Second colour.\n * @param factor The weight to be given to colour1 over colour2.\n *     Values should be in the range [0, 1].\n * @returns Combined colour represented in hex.\n */\nexport function blend(\n  colour1: string,\n  colour2: string,\n  factor: number,\n): string | null {\n  const hex1 = parse(colour1);\n  if (!hex1) {\n    return null;\n  }\n  const hex2 = parse(colour2);\n  if (!hex2) {\n    return null;\n  }\n  const rgb1 = hexToRgb(hex1);\n  const rgb2 = hexToRgb(hex2);\n  const r = Math.round(rgb2[0] + factor * (rgb1[0] - rgb2[0]));\n  const g = Math.round(rgb2[1] + factor * (rgb1[1] - rgb2[1]));\n  const b = Math.round(rgb2[2] + factor * (rgb1[2] - rgb2[2]));\n  return rgbToHex(r, g, b);\n}\n\n/**\n * A map that contains the 16 basic colour keywords as defined by W3C:\n * https://www.w3.org/TR/2018/REC-css-color-3-20180619/#html4\n * The keys of this map are the lowercase \"readable\" names of the colours,\n * while the values are the \"hex\" values.\n */\nexport const names: {[key: string]: string} = {\n  'aqua': '#00ffff',\n  'black': '#000000',\n  'blue': '#0000ff',\n  'fuchsia': '#ff00ff',\n  'gray': '#808080',\n  'green': '#008000',\n  'lime': '#00ff00',\n  'maroon': '#800000',\n  'navy': '#000080',\n  'olive': '#808000',\n  'purple': '#800080',\n  'red': '#ff0000',\n  'silver': '#c0c0c0',\n  'teal': '#008080',\n  'white': '#ffffff',\n  'yellow': '#ffff00',\n};\n\n/**\n * Convert a hue (HSV model) into an RGB hex triplet.\n *\n * @param hue Hue on a colour wheel (0-360).\n * @returns RGB code, e.g. '#5ba65b'.\n */\nexport function hueToHex(hue: number): string {\n  return hsvToHex(hue, hsvSaturation, hsvValue * 255);\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.parsing\n\nimport {Msg} from '../msg.js';\n\nimport * as colourUtils from './colour.js';\n\n/**\n * Internal implementation of the message reference and interpolation token\n * parsing used by tokenizeInterpolation() and replaceMessageReferences().\n *\n * @param message Text which might contain string table references and\n *     interpolation tokens.\n * @param parseInterpolationTokens Option to parse numeric interpolation\n *     tokens (%1, %2, ...) when true.\n * @param tokenizeNewlines Split individual newline characters into separate\n *     tokens when true.\n * @returns Array of strings and numbers.\n */\nfunction tokenizeInterpolationInternal(\n  message: string,\n  parseInterpolationTokens: boolean,\n  tokenizeNewlines: boolean,\n): (string | number)[] {\n  const tokens = [];\n  const chars = message.split('');\n  chars.push(''); // End marker.\n  // Parse the message with a finite state machine.\n  // 0 - Base case.\n  // 1 - % found.\n  // 2 - Digit found.\n  // 3 - Message ref found.\n  let state = 0;\n  const buffer = new Array<string>();\n  let number = null;\n  for (let i = 0; i < chars.length; i++) {\n    const c = chars[i];\n    if (state === 0) {\n      // Start escape.\n      if (c === '%') {\n        const text = buffer.join('');\n        if (text) {\n          tokens.push(text);\n        }\n        buffer.length = 0;\n        state = 1;\n      } else if (tokenizeNewlines && c === '\\n') {\n        // Output newline characters as single-character tokens, to be replaced\n        // with endOfRow dummies during interpolation.\n        const text = buffer.join('');\n        if (text) {\n          tokens.push(text);\n        }\n        buffer.length = 0;\n        tokens.push(c);\n      } else {\n        buffer.push(c); // Regular char.\n      }\n    } else if (state === 1) {\n      if (c === '%') {\n        buffer.push(c); // Escaped %: %%\n        state = 0;\n      } else if (parseInterpolationTokens && '0' <= c && c <= '9') {\n        state = 2;\n        number = c;\n        const text = buffer.join('');\n        if (text) {\n          tokens.push(text);\n        }\n        buffer.length = 0;\n      } else if (c === '{') {\n        state = 3;\n      } else {\n        buffer.push('%', c); // Not recognized. Return as literal.\n        state = 0;\n      }\n    } else if (state === 2) {\n      if ('0' <= c && c <= '9') {\n        number += c; // Multi-digit number.\n      } else {\n        tokens.push(parseInt(number ?? '', 10));\n        i--; // Parse this char again.\n        state = 0;\n      }\n    } else if (state === 3) {\n      // String table reference\n      if (c === '') {\n        // Premature end before closing '}'\n        buffer.splice(0, 0, '%{'); // Re-insert leading delimiter\n        i--; // Parse this char again.\n        state = 0; // and parse as string literal.\n      } else if (c !== '}') {\n        buffer.push(c);\n      } else {\n        const rawKey = buffer.join('');\n        if (/[A-Z]\\w*/i.test(rawKey)) {\n          // Strict matching\n          // Found a valid string key. Attempt case insensitive match.\n          const keyUpper = rawKey.toUpperCase();\n\n          // BKY_ is the prefix used to namespace the strings used in\n          // Blockly core files and the predefined blocks in ../blocks/.\n          // These strings are defined in ../msgs/ files.\n          const bklyKey = keyUpper.startsWith('BKY_')\n            ? keyUpper.substring(4)\n            : null;\n          if (bklyKey && bklyKey in Msg) {\n            const rawValue = Msg[bklyKey];\n            if (typeof rawValue === 'string') {\n              // Attempt to dereference substrings, too, appending to the\n              // end.\n              Array.prototype.push.apply(\n                tokens,\n                tokenizeInterpolationInternal(\n                  rawValue,\n                  parseInterpolationTokens,\n                  tokenizeNewlines,\n                ),\n              );\n            } else if (parseInterpolationTokens) {\n              // When parsing interpolation tokens, numbers are special\n              // placeholders (%1, %2, etc). Make sure all other values are\n              // strings.\n              tokens.push(`${rawValue}`);\n            } else {\n              tokens.push(rawValue);\n            }\n          } else {\n            // No entry found in the string table. Pass reference as string.\n            tokens.push('%{' + rawKey + '}');\n          }\n          buffer.length = 0; // Clear the array\n          state = 0;\n        } else {\n          tokens.push('%{' + rawKey + '}');\n          buffer.length = 0;\n          state = 0; // and parse as string literal.\n        }\n      }\n    }\n  }\n  let text = buffer.join('');\n  if (text) {\n    tokens.push(text);\n  }\n\n  // Merge adjacent text tokens into a single string (but if newlines should be\n  // tokenized, don't merge those with adjacent text).\n  const mergedTokens = [];\n  buffer.length = 0;\n  for (let i = 0; i < tokens.length; i++) {\n    if (\n      typeof tokens[i] === 'string' &&\n      !(tokenizeNewlines && tokens[i] === '\\n')\n    ) {\n      buffer.push(tokens[i] as string);\n    } else {\n      text = buffer.join('');\n      if (text) {\n        mergedTokens.push(text);\n      }\n      buffer.length = 0;\n      mergedTokens.push(tokens[i]);\n    }\n  }\n  text = buffer.join('');\n  if (text) {\n    mergedTokens.push(text);\n  }\n  buffer.length = 0;\n\n  return mergedTokens;\n}\n\n/**\n * Parse a string with any number of interpolation tokens (%1, %2, ...).\n * It will also replace string table references (e.g., %{bky_my_msg} and\n * %{BKY_MY_MSG} will both be replaced with the value in\n * Msg['MY_MSG']). Percentage sign characters '%' may be self-escaped\n * (e.g., '%%'). Newline characters will also be output as string tokens\n * containing a single newline character.\n *\n * @param message Text which might contain string table references and\n *     interpolation tokens.\n * @returns Array of strings and numbers.\n */\nexport function tokenizeInterpolation(message: string): (string | number)[] {\n  return tokenizeInterpolationInternal(message, true, true);\n}\n\n/**\n * Replaces string table references in a message, if the message is a string.\n * For example, \"%{bky_my_msg}\" and \"%{BKY_MY_MSG}\" will both be replaced with\n * the value in Msg['MY_MSG'].\n *\n * @param message Message, which may be a string that contains\n *     string table references.\n * @returns String with message references replaced.\n */\nexport function replaceMessageReferences(message: string | any): string {\n  if (typeof message !== 'string') {\n    return message;\n  }\n  const interpolatedResult = tokenizeInterpolationInternal(\n    message,\n    false,\n    false,\n  );\n  // When parseInterpolationTokens and tokenizeNewlines are false,\n  // interpolatedResult should be at most length 1.\n  return interpolatedResult.length ? String(interpolatedResult[0]) : '';\n}\n\n/**\n * Validates that any %{MSG_KEY} references in the message refer to keys of\n * the Msg string table.\n *\n * @param message Text which might contain string table references.\n * @returns True if all message references have matching values.\n *     Otherwise, false.\n */\nexport function checkMessageReferences(message: string): boolean {\n  let validSoFar = true;\n\n  const msgTable = Msg;\n  // TODO (#1169): Implement support for other string tables,\n  // prefixes other than BKY_.\n  const m = message.match(/%{BKY_[A-Z]\\w*}/gi);\n  if (m) {\n    for (let i = 0; i < m.length; i++) {\n      const msgKey = m[i].toUpperCase();\n      if (msgTable[msgKey.slice(6, -1)] === undefined) {\n        console.warn('No message string for ' + m[i] + ' in ' + message);\n        validSoFar = false; // Continue to report other errors.\n      }\n    }\n  }\n\n  return validSoFar;\n}\n\n/**\n * Parse a block colour from a number or string, as provided in a block\n * definition.\n *\n * @param colour HSV hue value (0 to 360), #RRGGBB string,\n *     or a message reference string pointing to one of those two values.\n * @returns An object containing the colour as\n *     a #RRGGBB string, and the hue if the input was an HSV hue value.\n * @throws {Error} If the colour cannot be parsed.\n */\nexport function parseBlockColour(colour: number | string): {\n  hue: number | null;\n  hex: string;\n} {\n  const dereferenced =\n    typeof colour === 'string' ? replaceMessageReferences(colour) : colour;\n\n  const hue = Number(dereferenced);\n  if (!isNaN(hue) && 0 <= hue && hue <= 360) {\n    return {\n      hue: hue,\n      hex: colourUtils.hsvToHex(\n        hue,\n        colourUtils.getHsvSaturation(),\n        colourUtils.getHsvValue() * 255,\n      ),\n    };\n  } else {\n    const hex = colourUtils.parse(dereferenced);\n    if (hex) {\n      // Only store hue if colour is set as a hue.\n      return {hue: null, hex: hex};\n    } else {\n      let errorMsg = 'Invalid colour: \"' + dereferenced + '\"';\n      if (colour !== dereferenced) {\n        errorMsg += ' (from \"' + colour + '\")';\n      }\n      throw Error(errorMsg);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.WidgetDiv\n\nimport * as common from './common.js';\nimport * as dom from './utils/dom.js';\nimport {Field} from './field.js';\nimport type {Rect} from './utils/rect.js';\nimport type {Size} from './utils/size.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/** The object currently using this container. */\nlet owner: unknown = null;\n\n/** The workspace associated with the owner currently using this container. */\nlet ownerWorkspace: WorkspaceSvg | null = null;\n\n/** Optional cleanup function set by whichever object uses the widget. */\nlet dispose: (() => void) | null = null;\n\n/** A class name representing the current owner's workspace container. */\nconst containerClassName = 'blocklyWidgetDiv';\n\n/** A class name representing the current owner's workspace renderer. */\nlet rendererClassName = '';\n\n/** A class name representing the current owner's workspace theme. */\nlet themeClassName = '';\n\n/** The HTML container for popup overlays (e.g. editor widgets). */\nlet containerDiv: HTMLDivElement | null;\n\n/**\n * Returns the HTML container for editor widgets.\n *\n * @returns The editor widget container.\n */\nexport function getDiv(): HTMLDivElement | null {\n  return containerDiv;\n}\n\n/**\n * Allows unit tests to reset the div. Do not use outside of tests.\n *\n * @param newDiv The new value for the DIV field.\n * @internal\n */\nexport function testOnly_setDiv(newDiv: HTMLDivElement | null) {\n  containerDiv = newDiv;\n  if (newDiv === null) {\n    document.querySelector('.' + containerClassName)?.remove();\n  }\n}\n\n/**\n * Create the widget div and inject it onto the page.\n */\nexport function createDom() {\n  const container = common.getParentContainer() || document.body;\n\n  if (document.querySelector('.' + containerClassName)) {\n    containerDiv = document.querySelector('.' + containerClassName);\n  } else {\n    containerDiv = document.createElement('div') as HTMLDivElement;\n    containerDiv.className = containerClassName;\n  }\n\n  container.appendChild(containerDiv!);\n}\n\n/**\n * Initialize and display the widget div.  Close the old one if needed.\n *\n * @param newOwner The object that will be using this container.\n * @param rtl Right-to-left (true) or left-to-right (false).\n * @param newDispose Optional cleanup function to be run when the widget is\n *     closed.\n * @param workspace The workspace associated with the widget owner.\n */\nexport function show(\n  newOwner: unknown,\n  rtl: boolean,\n  newDispose: () => void,\n  workspace?: WorkspaceSvg | null,\n) {\n  hide();\n  owner = newOwner;\n  dispose = newDispose;\n  const div = containerDiv;\n  if (!div) return;\n  div.style.direction = rtl ? 'rtl' : 'ltr';\n  div.style.display = 'block';\n  if (!workspace && newOwner instanceof Field) {\n    // For backward compatibility with plugin fields that do not provide a\n    // workspace to this function, attempt to derive it from the field.\n    workspace = (newOwner as Field).getSourceBlock()?.workspace as WorkspaceSvg;\n  }\n  ownerWorkspace = workspace ?? null;\n  const rendererWorkspace =\n    workspace ?? (common.getMainWorkspace() as WorkspaceSvg);\n  rendererClassName = rendererWorkspace.getRenderer().getClassName();\n  themeClassName = rendererWorkspace.getTheme().getClassName();\n  if (rendererClassName) {\n    dom.addClass(div, rendererClassName);\n  }\n  if (themeClassName) {\n    dom.addClass(div, themeClassName);\n  }\n}\n\n/**\n * Destroy the widget and hide the div.\n */\nexport function hide() {\n  if (!isVisible()) {\n    return;\n  }\n  owner = null;\n\n  const div = containerDiv;\n  if (!div) return;\n  div.style.display = 'none';\n  div.style.left = '';\n  div.style.top = '';\n  dispose && dispose();\n  dispose = null;\n  div.textContent = '';\n\n  if (rendererClassName) {\n    dom.removeClass(div, rendererClassName);\n    rendererClassName = '';\n  }\n  if (themeClassName) {\n    dom.removeClass(div, themeClassName);\n    themeClassName = '';\n  }\n  (common.getMainWorkspace() as WorkspaceSvg).markFocused();\n}\n\n/**\n * Is the container visible?\n *\n * @returns True if visible.\n */\nexport function isVisible(): boolean {\n  return !!owner;\n}\n\n/**\n * Destroy the widget and hide the div if it is being used by the specified\n * object.\n *\n * @param oldOwner The object that was using this container.\n */\nexport function hideIfOwner(oldOwner: unknown) {\n  if (owner === oldOwner) {\n    hide();\n  }\n}\n\n/**\n * Destroy the widget and hide the div if it is being used by an object in the\n * specified workspace, or if it is used by an unknown workspace.\n *\n * @param oldOwnerWorkspace The workspace that was using this container.\n */\nexport function hideIfOwnerIsInWorkspace(oldOwnerWorkspace: WorkspaceSvg) {\n  if (ownerWorkspace === null || ownerWorkspace === oldOwnerWorkspace) {\n    hide();\n  }\n}\n\n/**\n * Set the widget div's position and height.  This function does nothing clever:\n * it will not ensure that your widget div ends up in the visible window.\n *\n * @param x Horizontal location (window coordinates, not body).\n * @param y Vertical location (window coordinates, not body).\n * @param height The height of the widget div (pixels).\n */\nfunction positionInternal(x: number, y: number, height: number) {\n  containerDiv!.style.left = x + 'px';\n  containerDiv!.style.top = y + 'px';\n  containerDiv!.style.height = height + 'px';\n}\n\n/**\n * Position the widget div based on an anchor rectangle.\n * The widget should be placed adjacent to but not overlapping the anchor\n * rectangle.  The preferred position is directly below and aligned to the left\n * (LTR) or right (RTL) side of the anchor.\n *\n * @param viewportBBox The bounding rectangle of the current viewport, in window\n *     coordinates.\n * @param anchorBBox The bounding rectangle of the anchor, in window\n *     coordinates.\n * @param widgetSize The size of the widget that is inside the widget div, in\n *     window coordinates.\n * @param rtl Whether the workspace is in RTL mode.  This determines horizontal\n *     alignment.\n * @internal\n */\nexport function positionWithAnchor(\n  viewportBBox: Rect,\n  anchorBBox: Rect,\n  widgetSize: Size,\n  rtl: boolean,\n) {\n  const y = calculateY(viewportBBox, anchorBBox, widgetSize);\n  const x = calculateX(viewportBBox, anchorBBox, widgetSize, rtl);\n\n  if (y < 0) {\n    positionInternal(x, 0, widgetSize.height + y);\n  } else {\n    positionInternal(x, y, widgetSize.height);\n  }\n}\n\n/**\n * Calculate an x position (in window coordinates) such that the widget will not\n * be offscreen on the right or left.\n *\n * @param viewportBBox The bounding rectangle of the current viewport, in window\n *     coordinates.\n * @param anchorBBox The bounding rectangle of the anchor, in window\n *     coordinates.\n * @param widgetSize The dimensions of the widget inside the widget div.\n * @param rtl Whether the Blockly workspace is in RTL mode.\n * @returns A valid x-coordinate for the top left corner of the widget div, in\n *     window coordinates.\n */\nfunction calculateX(\n  viewportBBox: Rect,\n  anchorBBox: Rect,\n  widgetSize: Size,\n  rtl: boolean,\n): number {\n  if (rtl) {\n    // Try to align the right side of the field and the right side of widget.\n    const widgetLeft = anchorBBox.right - widgetSize.width;\n    // Don't go offscreen left.\n    const x = Math.max(widgetLeft, viewportBBox.left);\n    // But really don't go offscreen right:\n    return Math.min(x, viewportBBox.right - widgetSize.width);\n  } else {\n    // Try to align the left side of the field and the left side of widget.\n    // Don't go offscreen right.\n    const x = Math.min(anchorBBox.left, viewportBBox.right - widgetSize.width);\n    // But left is more important, because that's where the text is.\n    return Math.max(x, viewportBBox.left);\n  }\n}\n\n/**\n * Calculate a y position (in window coordinates) such that the widget will not\n * be offscreen on the top or bottom.\n *\n * @param viewportBBox The bounding rectangle of the current viewport, in window\n *     coordinates.\n * @param anchorBBox The bounding rectangle of the anchor, in window\n *     coordinates.\n * @param widgetSize The dimensions of the widget inside the widget div.\n * @returns A valid y-coordinate for the top left corner of the widget div, in\n *     window coordinates.\n */\nfunction calculateY(\n  viewportBBox: Rect,\n  anchorBBox: Rect,\n  widgetSize: Size,\n): number {\n  // Flip the widget vertically if off the bottom.\n  // The widget could go off the top of the window, but it would also go off\n  // the bottom.  The window is just too small.\n  if (anchorBBox.bottom + widgetSize.height >= viewportBBox.bottom) {\n    // The bottom of the widget is at the top of the field.\n    return anchorBBox.top - widgetSize.height;\n  } else {\n    // The top of the widget is at the bottom of the field.\n    return anchorBBox.bottom;\n  }\n}\n\n/**\n * Determine if the owner is a field for purposes of repositioning.\n * We can't simply check `instanceof Field` as that would introduce a circular\n * dependency.\n */\nfunction isRepositionable(item: any): item is Field {\n  return !!item?.repositionForWindowResize;\n}\n\n/**\n * Reposition the widget div if the owner of it says to.\n * If the owner isn't a field, just give up and hide it.\n */\nexport function repositionForWindowResize(): void {\n  if (!isRepositionable(owner) || !owner.repositionForWindowResize()) {\n    // If the owner is not a Field, or if the owner returns false from the\n    // reposition method, we should hide the widget div. Otherwise, we'll assume\n    // the owner handled any needed resize.\n    hide();\n  }\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.ContextMenu\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport {config} from './config.js';\nimport * as dom from './utils/dom.js';\nimport type {\n  ContextMenuOption,\n  LegacyContextMenuOption,\n} from './contextmenu_registry.js';\nimport * as eventUtils from './events/utils.js';\nimport {Menu} from './menu.js';\nimport {MenuItem} from './menuitem.js';\nimport * as aria from './utils/aria.js';\nimport {Rect} from './utils/rect.js';\nimport * as serializationBlocks from './serialization/blocks.js';\nimport * as svgMath from './utils/svg_math.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as Xml from './xml.js';\nimport * as common from './common.js';\n\n/**\n * Which block is the context menu attached to?\n */\nlet currentBlock: Block | null = null;\n\nconst dummyOwner = {};\n\n/**\n * Gets the block the context menu is currently attached to.\n *\n * @returns The block the context menu is attached to.\n */\nexport function getCurrentBlock(): Block | null {\n  return currentBlock;\n}\n\n/**\n * Sets the block the context menu is currently attached to.\n *\n * @param block The block the context menu is attached to.\n */\nexport function setCurrentBlock(block: Block | null) {\n  currentBlock = block;\n}\n\n/**\n * Menu object.\n */\nlet menu_: Menu | null = null;\n\n/**\n * Construct the menu based on the list of options and show the menu.\n *\n * @param e Mouse event.\n * @param options Array of menu options.\n * @param rtl True if RTL, false if LTR.\n * @param workspace The workspace associated with the context menu, if any.\n */\nexport function show(\n  e: PointerEvent,\n  options: (ContextMenuOption | LegacyContextMenuOption)[],\n  rtl: boolean,\n  workspace?: WorkspaceSvg,\n) {\n  WidgetDiv.show(dummyOwner, rtl, dispose, workspace);\n  if (!options.length) {\n    hide();\n    return;\n  }\n  const menu = populate_(options, rtl, e);\n  menu_ = menu;\n\n  position_(menu, e, rtl);\n  // 1ms delay is required for focusing on context menus because some other\n  // mouse event is still waiting in the queue and clears focus.\n  setTimeout(function () {\n    menu.focus();\n  }, 1);\n  currentBlock = null; // May be set by Blockly.Block.\n}\n\n/**\n * Create the context menu object and populate it with the given options.\n *\n * @param options Array of menu options.\n * @param rtl True if RTL, false if LTR.\n * @param e The event that triggered the context menu to open.\n * @returns The menu that will be shown on right click.\n */\nfunction populate_(\n  options: (ContextMenuOption | LegacyContextMenuOption)[],\n  rtl: boolean,\n  e: PointerEvent,\n): Menu {\n  /* Here's what one option object looks like:\n      {text: 'Make It So',\n       enabled: true,\n       callback: Blockly.MakeItSo}\n    */\n  const menu = new Menu();\n  menu.setRole(aria.Role.MENU);\n  for (let i = 0; i < options.length; i++) {\n    const option = options[i];\n    const menuItem = new MenuItem(option.text);\n    menuItem.setRightToLeft(rtl);\n    menuItem.setRole(aria.Role.MENUITEM);\n    menu.addChild(menuItem);\n    menuItem.setEnabled(option.enabled);\n    if (option.enabled) {\n      const actionHandler = function () {\n        hide();\n        requestAnimationFrame(() => {\n          setTimeout(() => {\n            // If .scope does not exist on the option, then the callback\n            // will not be expecting a scope parameter, so there should be\n            // no problems. Just assume it is a ContextMenuOption and we'll\n            // pass undefined if it's not.\n            option.callback((option as ContextMenuOption).scope, e);\n          }, 0);\n        });\n      };\n      menuItem.onAction(actionHandler, {});\n    }\n  }\n  return menu;\n}\n\n/**\n * Add the menu to the page and position it correctly.\n *\n * @param menu The menu to add and position.\n * @param e Mouse event for the right click that is making the context\n *     menu appear.\n * @param rtl True if RTL, false if LTR.\n */\nfunction position_(menu: Menu, e: Event, rtl: boolean) {\n  // Record windowSize and scrollOffset before adding menu.\n  const viewportBBox = svgMath.getViewportBBox();\n  const mouseEvent = e as MouseEvent;\n  // This one is just a point, but we'll pretend that it's a rect so we can use\n  // some helper functions.\n  const anchorBBox = new Rect(\n    mouseEvent.clientY + viewportBBox.top,\n    mouseEvent.clientY + viewportBBox.top,\n    mouseEvent.clientX + viewportBBox.left,\n    mouseEvent.clientX + viewportBBox.left,\n  );\n\n  createWidget_(menu);\n  const menuSize = menu.getSize();\n\n  if (rtl) {\n    anchorBBox.left += menuSize.width;\n    anchorBBox.right += menuSize.width;\n    viewportBBox.left += menuSize.width;\n    viewportBBox.right += menuSize.width;\n  }\n\n  WidgetDiv.positionWithAnchor(viewportBBox, anchorBBox, menuSize, rtl);\n  // Calling menuDom.focus() has to wait until after the menu has been placed\n  // correctly.  Otherwise it will cause a page scroll to get the misplaced menu\n  // in view.  See issue #1329.\n  menu.focus();\n}\n\n/**\n * Create and render the menu widget inside Blockly's widget div.\n *\n * @param menu The menu to add to the widget div.\n */\nfunction createWidget_(menu: Menu) {\n  const div = WidgetDiv.getDiv();\n  if (!div) {\n    throw Error('Attempting to create a context menu when widget div is null');\n  }\n  const menuDom = menu.render(div);\n  dom.addClass(menuDom, 'blocklyContextMenu');\n  // Prevent system context menu when right-clicking a Blockly context menu.\n  browserEvents.conditionalBind(\n    menuDom as EventTarget,\n    'contextmenu',\n    null,\n    haltPropagation,\n  );\n  // Focus only after the initial render to avoid issue #1329.\n  menu.focus();\n}\n/**\n * Halts the propagation of the event without doing anything else.\n *\n * @param e An event.\n */\nfunction haltPropagation(e: Event) {\n  // This event has been handled.  No need to bubble up to the document.\n  e.preventDefault();\n  e.stopPropagation();\n}\n\n/**\n * Hide the context menu.\n */\nexport function hide() {\n  WidgetDiv.hideIfOwner(dummyOwner);\n  currentBlock = null;\n}\n\n/**\n * Dispose of the menu.\n */\nexport function dispose() {\n  if (menu_) {\n    menu_.dispose();\n    menu_ = null;\n  }\n}\n\n/**\n * Create a callback function that creates and configures a block,\n *   then places the new block next to the original and returns it.\n *\n * @param block Original block.\n * @param state XML or JSON object representation of the new block.\n * @returns Function that creates a block.\n */\nexport function callbackFactory(\n  block: Block,\n  state: Element | serializationBlocks.State,\n): () => BlockSvg {\n  return () => {\n    eventUtils.disable();\n    let newBlock: BlockSvg;\n    try {\n      if (state instanceof Element) {\n        newBlock = Xml.domToBlockInternal(state, block.workspace!) as BlockSvg;\n      } else {\n        newBlock = serializationBlocks.appendInternal(\n          state,\n          block.workspace,\n        ) as BlockSvg;\n      }\n      // Move the new block next to the old block.\n      const xy = block.getRelativeToSurfaceXY();\n      if (block.RTL) {\n        xy.x -= config.snapRadius;\n      } else {\n        xy.x += config.snapRadius;\n      }\n      xy.y += config.snapRadius * 2;\n      newBlock.moveBy(xy.x, xy.y);\n    } finally {\n      eventUtils.enable();\n    }\n    if (eventUtils.isEnabled() && !newBlock.isShadow()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(newBlock));\n    }\n    common.setSelected(newBlock);\n    return newBlock;\n  };\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Xml\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport type {Connection} from './connection.js';\nimport {MANUALLY_DISABLED} from './constants.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Field} from './field.js';\nimport {IconType} from './icons/icon_types.js';\nimport {inputTypes} from './inputs/input_types.js';\nimport * as dom from './utils/dom.js';\nimport {Size} from './utils/size.js';\nimport * as utilsXml from './utils/xml.js';\nimport type {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\nimport * as renderManagement from './render_management.js';\nimport {WorkspaceComment} from './comments/workspace_comment.js';\nimport {RenderedWorkspaceComment} from './comments/rendered_workspace_comment.js';\nimport {Coordinate} from './utils/coordinate.js';\n\n/**\n * Encode a block tree as XML.\n *\n * @param workspace The workspace containing blocks.\n * @param skipId True if the encoder should skip the block IDs. False by\n *     default.\n * @returns XML DOM element.\n */\nexport function workspaceToDom(workspace: Workspace, skipId = false): Element {\n  const treeXml = utilsXml.createElement('xml');\n  const variablesElement = variablesToDom(\n    Variables.allUsedVarModels(workspace),\n  );\n  if (variablesElement.hasChildNodes()) {\n    treeXml.appendChild(variablesElement);\n  }\n  for (const comment of workspace.getTopComments()) {\n    treeXml.appendChild(\n      saveWorkspaceComment(comment as AnyDuringMigration, skipId),\n    );\n  }\n  const blocks = workspace.getTopBlocks(true);\n  for (let i = 0; i < blocks.length; i++) {\n    const block = blocks[i];\n    treeXml.appendChild(blockToDomWithXY(block, skipId));\n  }\n  return treeXml;\n}\n\n/** Serializes the given workspace comment to XML. */\nexport function saveWorkspaceComment(\n  comment: WorkspaceComment,\n  skipId = false,\n): Element {\n  const elem = utilsXml.createElement('comment');\n  if (!skipId) elem.setAttribute('id', comment.id);\n\n  const workspace = comment.workspace;\n  const loc = comment.getRelativeToSurfaceXY();\n  loc.x = workspace.RTL ? workspace.getWidth() - loc.x : loc.x;\n  elem.setAttribute('x', `${loc.x}`);\n  elem.setAttribute('y', `${loc.y}`);\n  elem.setAttribute('w', `${comment.getSize().width}`);\n  elem.setAttribute('h', `${comment.getSize().height}`);\n\n  if (comment.getText()) elem.textContent = comment.getText();\n  if (comment.isCollapsed()) elem.setAttribute('collapsed', 'true');\n  if (!comment.isOwnEditable()) elem.setAttribute('editable', 'false');\n  if (!comment.isOwnMovable()) elem.setAttribute('movable', 'false');\n  if (!comment.isOwnDeletable()) elem.setAttribute('deletable', 'false');\n\n  return elem;\n}\n\n/**\n * Encode a list of variables as XML.\n *\n * @param variableList List of all variable models.\n * @returns Tree of XML elements.\n */\nexport function variablesToDom(variableList: VariableModel[]): Element {\n  const variables = utilsXml.createElement('variables');\n  for (let i = 0; i < variableList.length; i++) {\n    const variable = variableList[i];\n    const element = utilsXml.createElement('variable');\n    element.appendChild(utilsXml.createTextNode(variable.name));\n    if (variable.type) {\n      element.setAttribute('type', variable.type);\n    }\n    element.id = variable.getId();\n    variables.appendChild(element);\n  }\n  return variables;\n}\n\n/**\n * Encode a block subtree as XML with XY coordinates.\n *\n * @param block The root block to encode.\n * @param opt_noId True if the encoder should skip the block ID.\n * @returns Tree of XML elements or an empty document fragment if the block was\n *     an insertion marker.\n */\nexport function blockToDomWithXY(\n  block: Block,\n  opt_noId?: boolean,\n): Element | DocumentFragment {\n  if (block.isInsertionMarker()) {\n    // Skip over insertion markers.\n    block = block.getChildren(false)[0];\n    if (!block) {\n      // Disappears when appended.\n      return new DocumentFragment();\n    }\n  }\n\n  let width = 0; // Not used in LTR.\n  if (block.workspace.RTL) {\n    width = block.workspace.getWidth();\n  }\n\n  const element = blockToDom(block, opt_noId);\n  if (isElement(element)) {\n    const xy = block.getRelativeToSurfaceXY();\n    element.setAttribute(\n      'x',\n      String(Math.round(block.workspace.RTL ? width - xy.x : xy.x)),\n    );\n    element.setAttribute('y', String(Math.round(xy.y)));\n  }\n  return element;\n}\n\n/**\n * Encode a field as XML.\n *\n * @param field The field to encode.\n * @returns XML element, or null if the field did not need to be serialized.\n */\nfunction fieldToDom(field: Field): Element | null {\n  if (field.isSerializable()) {\n    const container = utilsXml.createElement('field');\n    container.setAttribute('name', field.name || '');\n    return field.toXml(container);\n  }\n  return null;\n}\n\n/**\n * Encode all of a block's fields as XML and attach them to the given tree of\n * XML elements.\n *\n * @param block A block with fields to be encoded.\n * @param element The XML element to which the field DOM should be attached.\n */\nfunction allFieldsToDom(block: Block, element: Element) {\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    for (let j = 0; j < input.fieldRow.length; j++) {\n      const field = input.fieldRow[j];\n      const fieldDom = fieldToDom(field);\n      if (fieldDom) {\n        element.appendChild(fieldDom);\n      }\n    }\n  }\n}\n\n/**\n * Encode a block subtree as XML.\n *\n * @param block The root block to encode.\n * @param opt_noId True if the encoder should skip the block ID.\n * @returns Tree of XML elements or an empty document fragment if the block was\n *     an insertion marker.\n */\nexport function blockToDom(\n  block: Block,\n  opt_noId?: boolean,\n): Element | DocumentFragment {\n  // Skip over insertion markers.\n  if (block.isInsertionMarker()) {\n    const child = block.getChildren(false)[0];\n    if (child) {\n      return blockToDom(child);\n    } else {\n      // Disappears when appended.\n      return new DocumentFragment();\n    }\n  }\n\n  const element = utilsXml.createElement(block.isShadow() ? 'shadow' : 'block');\n  element.setAttribute('type', block.type);\n  if (!opt_noId) {\n    element.id = block.id;\n  }\n  if (block.mutationToDom) {\n    // Custom data for an advanced block.\n    const mutation = block.mutationToDom();\n    if (mutation && (mutation.hasChildNodes() || mutation.hasAttributes())) {\n      element.appendChild(mutation);\n    }\n  }\n\n  allFieldsToDom(block, element);\n\n  const commentText = block.getCommentText();\n  if (commentText) {\n    const comment = block.getIcon(IconType.COMMENT)!;\n    const size = comment.getBubbleSize();\n    const pinned = comment.bubbleIsVisible();\n\n    const commentElement = utilsXml.createElement('comment');\n    commentElement.appendChild(utilsXml.createTextNode(commentText));\n    commentElement.setAttribute('pinned', `${pinned}`);\n    commentElement.setAttribute('h', String(size.height));\n    commentElement.setAttribute('w', String(size.width));\n\n    element.appendChild(commentElement);\n  }\n\n  if (block.data) {\n    const dataElement = utilsXml.createElement('data');\n    dataElement.appendChild(utilsXml.createTextNode(block.data));\n    element.appendChild(dataElement);\n  }\n\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    let container: Element;\n    let empty = true;\n    if (input.type === inputTypes.DUMMY || input.type === inputTypes.END_ROW) {\n      continue;\n    } else {\n      const childBlock = input.connection!.targetBlock();\n      if (input.type === inputTypes.VALUE) {\n        container = utilsXml.createElement('value');\n      } else if (input.type === inputTypes.STATEMENT) {\n        container = utilsXml.createElement('statement');\n      }\n      const childShadow = input.connection!.getShadowDom();\n      if (childShadow && (!childBlock || !childBlock.isShadow())) {\n        container!.appendChild(cloneShadow(childShadow, opt_noId));\n      }\n      if (childBlock) {\n        const childElem = blockToDom(childBlock, opt_noId);\n        if (childElem.nodeType === dom.NodeType.ELEMENT_NODE) {\n          container!.appendChild(childElem);\n          empty = false;\n        }\n      }\n    }\n    container!.setAttribute('name', input.name);\n    if (!empty) {\n      element.appendChild(container!);\n    }\n  }\n  if (\n    block.inputsInline !== undefined &&\n    block.inputsInline !== block.inputsInlineDefault\n  ) {\n    element.setAttribute('inline', String(block.inputsInline));\n  }\n  if (block.isCollapsed()) {\n    element.setAttribute('collapsed', 'true');\n  }\n  if (!block.isEnabled()) {\n    // Set the value of the attribute to a comma-separated list of reasons.\n    // Use encodeURIComponent to escape commas in the reasons so that they\n    // won't be confused with separator commas.\n    element.setAttribute(\n      'disabled-reasons',\n      Array.from(block.getDisabledReasons()).map(encodeURIComponent).join(','),\n    );\n  }\n  if (!block.isOwnDeletable()) {\n    element.setAttribute('deletable', 'false');\n  }\n  if (!block.isOwnMovable()) {\n    element.setAttribute('movable', 'false');\n  }\n  if (!block.isOwnEditable()) {\n    element.setAttribute('editable', 'false');\n  }\n\n  const nextBlock = block.getNextBlock();\n  let container: Element;\n  if (nextBlock) {\n    const nextElem = blockToDom(nextBlock, opt_noId);\n    if (nextElem.nodeType === dom.NodeType.ELEMENT_NODE) {\n      container = utilsXml.createElement('next');\n      container.appendChild(nextElem);\n      element.appendChild(container);\n    }\n  }\n  const nextShadow =\n    block.nextConnection && block.nextConnection.getShadowDom();\n  if (nextShadow && (!nextBlock || !nextBlock.isShadow())) {\n    container!.appendChild(cloneShadow(nextShadow, opt_noId));\n  }\n\n  return element;\n}\n\n/**\n * Deeply clone the shadow's DOM so that changes don't back-wash to the block.\n *\n * @param shadow A tree of XML elements.\n * @param opt_noId True if the encoder should skip the block ID.\n * @returns A tree of XML elements.\n */\nfunction cloneShadow(shadow: Element, opt_noId?: boolean): Element {\n  shadow = shadow.cloneNode(true) as Element;\n  // Walk the tree looking for whitespace.  Don't prune whitespace in a tag.\n  let node: Node | null = shadow;\n  let textNode;\n  while (node) {\n    if (opt_noId && node.nodeName === 'shadow') {\n      // Strip off IDs from shadow blocks.  There should never be a 'block' as\n      // a child of a 'shadow', so no need to check that.\n      (node as Element).removeAttribute('id');\n    }\n    if (node.firstChild) {\n      node = node.firstChild;\n    } else {\n      while (node && !node.nextSibling) {\n        textNode = node;\n        node = node.parentNode;\n        if (\n          textNode.nodeType === dom.NodeType.TEXT_NODE &&\n          (textNode as Text).data.trim() === '' &&\n          node?.firstChild !== textNode\n        ) {\n          // Prune whitespace after a tag.\n          dom.removeNode(textNode);\n        }\n      }\n      if (node) {\n        textNode = node;\n        node = node.nextSibling;\n        if (\n          textNode.nodeType === dom.NodeType.TEXT_NODE &&\n          (textNode as Text).data.trim() === ''\n        ) {\n          // Prune whitespace before a tag.\n          dom.removeNode(textNode);\n        }\n      }\n    }\n  }\n  return shadow;\n}\n\n/**\n * Converts a DOM structure into plain text.\n * Currently the text format is fairly ugly: all one line with no whitespace,\n * unless the DOM itself has whitespace built-in.\n *\n * @param dom A tree of XML nodes.\n * @returns Text representation.\n */\nexport function domToText(dom: Node): string {\n  const text = utilsXml.domToText(dom);\n  // Unpack self-closing tags.  These tags fail when embedded in HTML.\n  // <block name=\"foo\"/> -> <block name=\"foo\"></block>\n  return text.replace(/<(\\w+)([^<]*)\\/>/g, '<$1$2></$1>');\n}\n\n/**\n * Converts a DOM structure into properly indented text.\n *\n * @param dom A tree of XML elements.\n * @returns Text representation.\n */\nexport function domToPrettyText(dom: Node): string {\n  // This function is not guaranteed to be correct for all XML.\n  // But it handles the XML that Blockly generates.\n  const blob = domToText(dom);\n  // Place every open and close tag on its own line.\n  const lines = blob.split('<');\n  // Indent every line.\n  let indent = '';\n  for (let i = 1; i < lines.length; i++) {\n    const line = lines[i];\n    if (line[0] === '/') {\n      indent = indent.substring(2);\n    }\n    lines[i] = indent + '<' + line;\n    if (line[0] !== '/' && line.slice(-2) !== '/>') {\n      indent += '  ';\n    }\n  }\n  // Pull simple tags back together.\n  // E.g. <foo></foo>\n  let text = lines.join('\\n');\n  text = text.replace(/(<(\\w+)\\b[^>]*>[^\\n]*)\\n *<\\/\\2>/g, '$1</$2>');\n  // Trim leading blank line.\n  return text.replace(/^\\n/, '');\n}\n\n/**\n * Clear the given workspace then decode an XML DOM and\n * create blocks on the workspace.\n *\n * @param xml XML DOM.\n * @param workspace The workspace.\n * @returns An array containing new block IDs.\n */\nexport function clearWorkspaceAndLoadFromXml(\n  xml: Element,\n  workspace: WorkspaceSvg,\n): string[] {\n  workspace.setResizesEnabled(false);\n  workspace.clear();\n  const blockIds = domToWorkspace(xml, workspace);\n  workspace.setResizesEnabled(true);\n  return blockIds;\n}\n\n/**\n * Decode an XML DOM and create blocks on the workspace.\n *\n * @param xml XML DOM.\n * @param workspace The workspace.\n * @returns An array containing new block IDs.\n */\nexport function domToWorkspace(xml: Element, workspace: Workspace): string[] {\n  let width = 0; // Not used in LTR.\n  if (workspace.RTL) {\n    width = workspace.getWidth();\n  }\n  const newBlockIds = []; // A list of block IDs added by this call.\n  dom.startTextWidthCache();\n  const existingGroup = eventUtils.getGroup();\n  if (!existingGroup) {\n    eventUtils.setGroup(true);\n  }\n\n  // Disable workspace resizes as an optimization.\n  // Assume it is rendered so we can check.\n  if ((workspace as WorkspaceSvg).setResizesEnabled) {\n    (workspace as WorkspaceSvg).setResizesEnabled(false);\n  }\n  let variablesFirst = true;\n  try {\n    for (let i = 0, xmlChild; (xmlChild = xml.childNodes[i]); i++) {\n      const name = xmlChild.nodeName.toLowerCase();\n      const xmlChildElement = xmlChild as Element;\n      if (\n        name === 'block' ||\n        (name === 'shadow' && !eventUtils.getRecordUndo())\n      ) {\n        // Allow top-level shadow blocks if recordUndo is disabled since\n        // that means an undo is in progress.  Such a block is expected\n        // to be moved to a nested destination in the next operation.\n        const block = domToBlockInternal(xmlChildElement, workspace);\n        newBlockIds.push(block.id);\n        const blockX = parseInt(xmlChildElement.getAttribute('x') ?? '10', 10);\n        const blockY = parseInt(xmlChildElement.getAttribute('y') ?? '10', 10);\n        if (!isNaN(blockX) && !isNaN(blockY)) {\n          block.moveBy(workspace.RTL ? width - blockX : blockX, blockY, [\n            'create',\n          ]);\n        }\n        variablesFirst = false;\n      } else if (name === 'shadow') {\n        throw TypeError('Shadow block cannot be a top-level block.');\n      } else if (name === 'comment') {\n        loadWorkspaceComment(xmlChildElement, workspace);\n      } else if (name === 'variables') {\n        if (variablesFirst) {\n          domToVariables(xmlChildElement, workspace);\n        } else {\n          throw Error(\n            \"'variables' tag must exist once before block and \" +\n              'shadow tag elements in the workspace XML, but it was found in ' +\n              'another location.',\n          );\n        }\n        variablesFirst = false;\n      }\n    }\n  } finally {\n    eventUtils.setGroup(existingGroup);\n    if ((workspace as WorkspaceSvg).setResizesEnabled) {\n      (workspace as WorkspaceSvg).setResizesEnabled(true);\n    }\n    if (workspace.rendered) renderManagement.triggerQueuedRenders();\n    dom.stopTextWidthCache();\n  }\n  // Re-enable workspace resizing.\n  eventUtils.fire(new (eventUtils.get(eventUtils.FINISHED_LOADING))(workspace));\n  return newBlockIds;\n}\n\n/** Deserializes the given comment state into the given workspace. */\nexport function loadWorkspaceComment(\n  elem: Element,\n  workspace: Workspace,\n): WorkspaceComment {\n  const id = elem.getAttribute('id') ?? undefined;\n  const comment = workspace.rendered\n    ? new RenderedWorkspaceComment(workspace as WorkspaceSvg, id)\n    : new WorkspaceComment(workspace, id);\n\n  comment.setText(elem.textContent ?? '');\n\n  let x = parseInt(elem.getAttribute('x') ?? '', 10);\n  const y = parseInt(elem.getAttribute('y') ?? '', 10);\n  if (!isNaN(x) && !isNaN(y)) {\n    x = workspace.RTL ? workspace.getWidth() - x : x;\n    comment.moveTo(new Coordinate(x, y));\n  }\n\n  const w = parseInt(elem.getAttribute('w') ?? '', 10);\n  const h = parseInt(elem.getAttribute('h') ?? '', 10);\n  if (!isNaN(w) && !isNaN(h)) comment.setSize(new Size(w, h));\n\n  if (elem.getAttribute('collapsed') === 'true') comment.setCollapsed(true);\n  if (elem.getAttribute('editable') === 'false') comment.setEditable(false);\n  if (elem.getAttribute('movable') === 'false') comment.setMovable(false);\n  if (elem.getAttribute('deletable') === 'false') comment.setDeletable(false);\n\n  return comment;\n}\n\n/**\n * Decode an XML DOM and create blocks on the workspace. Position the new\n * blocks immediately below prior blocks, aligned by their starting edge.\n *\n * @param xml The XML DOM.\n * @param workspace The workspace to add to.\n * @returns An array containing new block IDs.\n */\nexport function appendDomToWorkspace(\n  xml: Element,\n  workspace: WorkspaceSvg,\n): string[] {\n  // First check if we have a WorkspaceSvg, otherwise the blocks have no shape\n  // and the position does not matter.\n  // Assume it is rendered so we can check.\n  if (!(workspace as WorkspaceSvg).getBlocksBoundingBox) {\n    return domToWorkspace(xml, workspace);\n  }\n\n  const bbox = (workspace as WorkspaceSvg).getBlocksBoundingBox();\n  // Load the new blocks into the workspace and get the IDs of the new blocks.\n  const newBlockIds = domToWorkspace(xml, workspace);\n  if (bbox && bbox.top !== bbox.bottom) {\n    // Check if any previous block.\n    let offsetY = 0; // Offset to add to y of the new block.\n    let offsetX = 0;\n    const farY = bbox.bottom; // Bottom position.\n    const topX = workspace.RTL ? bbox.right : bbox.left; // X of bounding box.\n    // Check position of the new blocks.\n    let newLeftX = Infinity; // X of top left corner.\n    let newRightX = -Infinity; // X of top right corner.\n    let newY = Infinity; // Y of top corner.\n    const ySeparation = 10;\n    for (let i = 0; i < newBlockIds.length; i++) {\n      const blockXY = workspace\n        .getBlockById(newBlockIds[i])!\n        .getRelativeToSurfaceXY();\n      if (blockXY.y < newY) {\n        newY = blockXY.y;\n      }\n      if (blockXY.x < newLeftX) {\n        // if we left align also on x\n        newLeftX = blockXY.x;\n      }\n      if (blockXY.x > newRightX) {\n        // if we right align also on x\n        newRightX = blockXY.x;\n      }\n    }\n    offsetY = farY - newY + ySeparation;\n    offsetX = workspace.RTL ? topX - newRightX : topX - newLeftX;\n    for (let i = 0; i < newBlockIds.length; i++) {\n      const block = workspace.getBlockById(newBlockIds[i]);\n      block!.moveBy(offsetX, offsetY, ['create']);\n    }\n  }\n  return newBlockIds;\n}\n\n/**\n * Decode an XML block tag and create a block (and possibly sub blocks) on the\n * workspace.\n *\n * @param xmlBlock XML block element.\n * @param workspace The workspace.\n * @returns The root block created.\n */\nexport function domToBlock(xmlBlock: Element, workspace: Workspace): Block {\n  const block = domToBlockInternal(xmlBlock, workspace);\n  if (workspace.rendered) renderManagement.triggerQueuedRenders();\n  return block;\n}\n\n/**\n * Decode an XML block tag and create a block (and possibly sub blocks) on the\n * workspace.\n *\n * This is defined internally so that it doesn't trigger an immediate render,\n * which we do want to happen for external calls.\n *\n * @param xmlBlock XML block element.\n * @param workspace The workspace.\n * @returns The root block created.\n * @internal\n */\nexport function domToBlockInternal(\n  xmlBlock: Element,\n  workspace: Workspace,\n): Block {\n  // Create top-level block.\n  eventUtils.disable();\n  const variablesBeforeCreation = workspace.getAllVariables();\n  let topBlock;\n  try {\n    topBlock = domToBlockHeadless(xmlBlock, workspace);\n    // Generate list of all blocks.\n    if (workspace.rendered) {\n      const topBlockSvg = topBlock as BlockSvg;\n      const blocks = topBlock.getDescendants(false);\n      topBlockSvg.setConnectionTracking(false);\n      // Render each block.\n      for (let i = blocks.length - 1; i >= 0; i--) {\n        (blocks[i] as BlockSvg).initSvg();\n      }\n      for (let i = blocks.length - 1; i >= 0; i--) {\n        (blocks[i] as BlockSvg).queueRender();\n      }\n      // Populating the connection database may be deferred until after the\n      // blocks have rendered.\n      setTimeout(function () {\n        if (!topBlockSvg.disposed) {\n          topBlockSvg.setConnectionTracking(true);\n        }\n      }, 1);\n      // Allow the scrollbars to resize and move based on the new contents.\n      // TODO(@picklesrus): #387. Remove when domToBlock avoids resizing.\n      (workspace as WorkspaceSvg).resizeContents();\n    } else {\n      const blocks = topBlock.getDescendants(false);\n      for (let i = blocks.length - 1; i >= 0; i--) {\n        blocks[i].initModel();\n      }\n    }\n  } finally {\n    eventUtils.enable();\n  }\n  if (eventUtils.isEnabled()) {\n    const newVariables = Variables.getAddedVariables(\n      workspace,\n      variablesBeforeCreation,\n    );\n    // Fire a VarCreate event for each (if any) new variable created.\n    for (let i = 0; i < newVariables.length; i++) {\n      const thisVariable = newVariables[i];\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.VAR_CREATE))(thisVariable),\n      );\n    }\n    // Block events come after var events, in case they refer to newly created\n    // variables.\n    eventUtils.fire(new (eventUtils.get(eventUtils.CREATE))(topBlock));\n  }\n  return topBlock;\n}\n\n/**\n * Decode an XML list of variables and add the variables to the workspace.\n *\n * @param xmlVariables List of XML variable elements.\n * @param workspace The workspace to which the variable should be added.\n */\nexport function domToVariables(xmlVariables: Element, workspace: Workspace) {\n  for (let i = 0; i < xmlVariables.children.length; i++) {\n    const xmlChild = xmlVariables.children[i];\n    const type = xmlChild.getAttribute('type');\n    const id = xmlChild.getAttribute('id');\n    const name = xmlChild.textContent;\n\n    if (!name) return;\n    workspace.createVariable(name, type, id);\n  }\n}\n\n/** A mapping of nodeName to node for child nodes of xmlBlock. */\ninterface childNodeTagMap {\n  mutation: Element[];\n  comment: Element[];\n  data: Element[];\n  field: Element[];\n  input: Element[];\n  next: Element[];\n}\n\n/**\n * Creates a mapping of childNodes for each supported XML tag for the provided\n * xmlBlock. Logs a warning for any encountered unsupported tags.\n *\n * @param xmlBlock XML block element.\n * @returns The childNode map from nodeName to node.\n */\nfunction mapSupportedXmlTags(xmlBlock: Element): childNodeTagMap {\n  const childNodeMap = {\n    mutation: new Array<Element>(),\n    comment: new Array<Element>(),\n    data: new Array<Element>(),\n    field: new Array<Element>(),\n    input: new Array<Element>(),\n    next: new Array<Element>(),\n  };\n  for (let i = 0; i < xmlBlock.children.length; i++) {\n    const xmlChild = xmlBlock.children[i];\n    if (xmlChild.nodeType === dom.NodeType.TEXT_NODE) {\n      // Ignore any text at the <block> level.  It's all whitespace anyway.\n      continue;\n    }\n    switch (xmlChild.nodeName.toLowerCase()) {\n      case 'mutation':\n        childNodeMap.mutation.push(xmlChild);\n        break;\n      case 'comment':\n        childNodeMap.comment.push(xmlChild);\n        break;\n      case 'data':\n        childNodeMap.data.push(xmlChild);\n        break;\n      case 'title':\n      // Titles were renamed to field in December 2013.\n      // Fall through.\n      case 'field':\n        childNodeMap.field.push(xmlChild);\n        break;\n      case 'value':\n      case 'statement':\n        childNodeMap.input.push(xmlChild);\n        break;\n      case 'next':\n        childNodeMap.next.push(xmlChild);\n        break;\n      default:\n        // Unknown tag; ignore.  Same principle as HTML parsers.\n        console.warn('Ignoring unknown tag: ' + xmlChild.nodeName);\n    }\n  }\n  return childNodeMap;\n}\n\n/**\n * Applies mutation tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n * @returns True if mutation may have added some elements that need\n *     initialization (requiring initSvg call).\n */\nfunction applyMutationTagNodes(xmlChildren: Element[], block: Block): boolean {\n  let shouldCallInitSvg = false;\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    // Custom data for an advanced block.\n    if (block.domToMutation) {\n      block.domToMutation(xmlChild);\n      if ((block as BlockSvg).initSvg) {\n        // Mutation may have added some elements that need initializing.\n        shouldCallInitSvg = true;\n      }\n    }\n  }\n  return shouldCallInitSvg;\n}\n\n/**\n * Applies comment tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n */\nfunction applyCommentTagNodes(xmlChildren: Element[], block: Block) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const text = xmlChild.textContent;\n    const pinned = xmlChild.getAttribute('pinned') === 'true';\n    const width = parseInt(xmlChild.getAttribute('w') ?? '50', 10);\n    const height = parseInt(xmlChild.getAttribute('h') ?? '50', 10);\n\n    block.setCommentText(text);\n    const comment = block.getIcon(IconType.COMMENT)!;\n    if (!isNaN(width) && !isNaN(height)) {\n      comment.setBubbleSize(new Size(width, height));\n    }\n    // Set the pinned state of the bubble.\n    comment.setBubbleVisible(pinned);\n    // Actually show the bubble after the block has been rendered.\n    setTimeout(() => comment.setBubbleVisible(pinned), 1);\n  }\n}\n\n/**\n * Applies data tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n */\nfunction applyDataTagNodes(xmlChildren: Element[], block: Block) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    block.data = xmlChild.textContent;\n  }\n}\n\n/**\n * Applies field tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n */\nfunction applyFieldTagNodes(xmlChildren: Element[], block: Block) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const nodeName = xmlChild.getAttribute('name');\n    if (!nodeName) {\n      console.warn(`Ignoring unnamed field in block ${block.type}`);\n      continue;\n    }\n    domToField(block, nodeName, xmlChild);\n  }\n}\n\n/**\n * Finds any enclosed blocks or shadows within this XML node.\n *\n * @param xmlNode The XML node to extract child block info from.\n * @returns Any found child block.\n */\nfunction findChildBlocks(xmlNode: Element): {\n  childBlockElement: Element | null;\n  childShadowElement: Element | null;\n} {\n  let childBlockElement: Element | null = null;\n  let childShadowElement: Element | null = null;\n  for (let i = 0; i < xmlNode.childNodes.length; i++) {\n    const xmlChild = xmlNode.childNodes[i];\n    if (isElement(xmlChild)) {\n      if (xmlChild.nodeName.toLowerCase() === 'block') {\n        childBlockElement = xmlChild;\n      } else if (xmlChild.nodeName.toLowerCase() === 'shadow') {\n        childShadowElement = xmlChild;\n      }\n    }\n  }\n  return {childBlockElement, childShadowElement};\n}\n/**\n * Applies input child nodes (value or statement) to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param workspace The workspace containing the given block.\n * @param block The block to apply the child nodes on.\n * @param prototypeName The prototype name of the block.\n */\nfunction applyInputTagNodes(\n  xmlChildren: Element[],\n  workspace: Workspace,\n  block: Block,\n  prototypeName: string,\n) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const nodeName = xmlChild.getAttribute('name');\n    const input = nodeName ? block.getInput(nodeName) : null;\n    if (!input) {\n      console.warn(\n        'Ignoring non-existent input ' +\n          nodeName +\n          ' in block ' +\n          prototypeName,\n      );\n      break;\n    }\n    const childBlockInfo = findChildBlocks(xmlChild);\n    if (childBlockInfo.childBlockElement) {\n      if (!input.connection) {\n        throw TypeError('Input connection does not exist.');\n      }\n      domToBlockHeadless(\n        childBlockInfo.childBlockElement,\n        workspace,\n        input.connection,\n        false,\n      );\n    }\n    // Set shadow after so we don't create a shadow we delete immediately.\n    if (childBlockInfo.childShadowElement) {\n      input.connection?.setShadowDom(childBlockInfo.childShadowElement);\n    }\n  }\n}\n\n/**\n * Applies next child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param workspace The workspace containing the given block.\n * @param block The block to apply the child nodes on.\n */\nfunction applyNextTagNodes(\n  xmlChildren: Element[],\n  workspace: Workspace,\n  block: Block,\n) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const childBlockInfo = findChildBlocks(xmlChild);\n    if (childBlockInfo.childBlockElement) {\n      if (!block.nextConnection) {\n        throw TypeError('Next statement does not exist.');\n      }\n      // If there is more than one XML 'next' tag.\n      if (block.nextConnection.isConnected()) {\n        throw TypeError('Next statement is already connected.');\n      }\n      // Create child block.\n      domToBlockHeadless(\n        childBlockInfo.childBlockElement,\n        workspace,\n        block.nextConnection,\n        true,\n      );\n    }\n    // Set shadow after so we don't create a shadow we delete immediately.\n    if (childBlockInfo.childShadowElement && block.nextConnection) {\n      block.nextConnection.setShadowDom(childBlockInfo.childShadowElement);\n    }\n  }\n}\n\n/**\n * Decode an XML block tag and create a block (and possibly sub blocks) on the\n * workspace.\n *\n * @param xmlBlock XML block element.\n * @param workspace The workspace.\n * @param parentConnection The parent connection to connect this block to\n *     after instantiating.\n * @param connectedToParentNext Whether the provided parent connection is a next\n *     connection, rather than output or statement.\n * @returns The root block created.\n */\nfunction domToBlockHeadless(\n  xmlBlock: Element,\n  workspace: Workspace,\n  parentConnection?: Connection,\n  connectedToParentNext?: boolean,\n): Block {\n  let block = null;\n  const prototypeName = xmlBlock.getAttribute('type');\n  if (!prototypeName) {\n    throw TypeError('Block type unspecified: ' + xmlBlock.outerHTML);\n  }\n  const id = xmlBlock.getAttribute('id') ?? undefined;\n  block = workspace.newBlock(prototypeName, id);\n\n  // Preprocess childNodes so tags can be processed in a consistent order.\n  const xmlChildNameMap = mapSupportedXmlTags(xmlBlock);\n\n  const shouldCallInitSvg = applyMutationTagNodes(\n    xmlChildNameMap.mutation,\n    block,\n  );\n  applyCommentTagNodes(xmlChildNameMap.comment, block);\n  applyDataTagNodes(xmlChildNameMap.data, block);\n\n  // Connect parent after processing mutation and before setting fields.\n  if (parentConnection) {\n    if (connectedToParentNext) {\n      if (block.previousConnection) {\n        parentConnection.connect(block.previousConnection);\n      } else {\n        throw TypeError('Next block does not have previous statement.');\n      }\n    } else {\n      if (block.outputConnection) {\n        parentConnection.connect(block.outputConnection);\n      } else if (block.previousConnection) {\n        parentConnection.connect(block.previousConnection);\n      } else {\n        throw TypeError(\n          'Child block does not have output or previous statement.',\n        );\n      }\n    }\n  }\n\n  applyFieldTagNodes(xmlChildNameMap.field, block);\n  applyInputTagNodes(xmlChildNameMap.input, workspace, block, prototypeName);\n  applyNextTagNodes(xmlChildNameMap.next, workspace, block);\n\n  if (shouldCallInitSvg) {\n    // This shouldn't even be called here\n    // (ref: https://github.com/google/blockly/pull/4296#issuecomment-884226021\n    // But the XML serializer/deserializer is iceboxed so I'm not going to fix\n    // it.\n    (block as BlockSvg).initSvg();\n  }\n\n  const inline = xmlBlock.getAttribute('inline');\n  if (inline) {\n    block.setInputsInline(inline === 'true');\n  }\n  const disabled = xmlBlock.getAttribute('disabled');\n  if (disabled) {\n    // Before May 2024 we just used 'disabled', with no reasons.\n    // Contiune to support this syntax.\n    block.setDisabledReason(\n      disabled === 'true' || disabled === 'disabled',\n      MANUALLY_DISABLED,\n    );\n  }\n  const disabledReasons = xmlBlock.getAttribute('disabled-reasons');\n  if (disabledReasons !== null) {\n    for (const reason of disabledReasons.split(',')) {\n      // Use decodeURIComponent to restore characters that were encoded in the\n      // value, such as commas.\n      block.setDisabledReason(true, decodeURIComponent(reason));\n    }\n  }\n  const deletable = xmlBlock.getAttribute('deletable');\n  if (deletable) {\n    block.setDeletable(deletable === 'true');\n  }\n  const movable = xmlBlock.getAttribute('movable');\n  if (movable) {\n    block.setMovable(movable === 'true');\n  }\n  const editable = xmlBlock.getAttribute('editable');\n  if (editable) {\n    block.setEditable(editable === 'true');\n  }\n  const collapsed = xmlBlock.getAttribute('collapsed');\n  if (collapsed) {\n    block.setCollapsed(collapsed === 'true');\n  }\n  if (xmlBlock.nodeName.toLowerCase() === 'shadow') {\n    // Ensure all children are also shadows.\n    const children = block.getChildren(false);\n    for (let i = 0; i < children.length; i++) {\n      const child = children[i];\n      if (!child.isShadow()) {\n        throw TypeError('Shadow block not allowed non-shadow child.');\n      }\n    }\n\n    block.setShadow(true);\n  }\n  return block;\n}\n\n/**\n * Decode an XML field tag and set the value of that field on the given block.\n *\n * @param block The block that is currently being deserialized.\n * @param fieldName The name of the field on the block.\n * @param xml The field tag to decode.\n */\nfunction domToField(block: Block, fieldName: string, xml: Element) {\n  const field = block.getField(fieldName);\n  if (!field) {\n    console.warn(\n      'Ignoring non-existent field ' + fieldName + ' in block ' + block.type,\n    );\n    return;\n  }\n  field.fromXml(xml);\n}\n\n/**\n * Remove any 'next' block (statements in a stack).\n *\n * @param xmlBlock XML block element or an empty DocumentFragment if the block\n *     was an insertion marker.\n */\nexport function deleteNext(xmlBlock: Element | DocumentFragment) {\n  for (let i = 0; i < xmlBlock.childNodes.length; i++) {\n    const child = xmlBlock.childNodes[i];\n    if (child.nodeName.toLowerCase() === 'next') {\n      xmlBlock.removeChild(child);\n      break;\n    }\n  }\n}\n\nfunction isElement(node: Node): node is Element {\n  return node.nodeType === dom.NodeType.ELEMENT_NODE;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockAnimations\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\n\n/** A bounding box for a cloned block. */\ninterface CloneRect {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\n/** PID of disconnect UI animation.  There can only be one at a time. */\nlet disconnectPid: ReturnType<typeof setTimeout> | null = null;\n\n/** The wobbling block.  There can only be one at a time. */\nlet wobblingBlock: BlockSvg | null = null;\n\n/**\n * Play some UI effects (sound, animation) when disposing of a block.\n *\n * @param block The block being disposed of.\n * @internal\n */\nexport function disposeUiEffect(block: BlockSvg) {\n  // Disposing is going to take so long the animation won't play anyway.\n  if (block.getDescendants(false).length > 100) return;\n\n  const workspace = block.workspace;\n  const svgGroup = block.getSvgRoot();\n  workspace.getAudioManager().play('delete');\n\n  const xy = block.getRelativeToSurfaceXY();\n  // Deeply clone the current block.\n  const clone: SVGGElement = svgGroup.cloneNode(true) as SVGGElement;\n  clone.setAttribute('transform', 'translate(' + xy.x + ',' + xy.y + ')');\n  workspace.getLayerManager()?.appendToAnimationLayer({\n    getSvgRoot: () => {\n      return clone;\n    },\n  });\n  const cloneRect = {\n    'x': xy.x,\n    'y': xy.y,\n    'width': block.width,\n    'height': block.height,\n  };\n  disposeUiStep(clone, cloneRect, workspace.RTL, new Date());\n}\n/**\n * Animate a cloned block and eventually dispose of it.\n * This is a class method, not an instance method since the original block has\n * been destroyed and is no longer accessible.\n *\n * @param clone SVG element to animate and dispose of.\n * @param rect Starting rect of the clone.\n * @param rtl True if RTL, false if LTR.\n * @param start Date of animation's start.\n */\nfunction disposeUiStep(\n  clone: Element,\n  rect: CloneRect,\n  rtl: boolean,\n  start: Date,\n) {\n  const ms = new Date().getTime() - start.getTime();\n  const percent = ms / 150;\n  if (percent > 1) {\n    dom.removeNode(clone);\n  } else {\n    const x = rect.x + (((rtl ? -1 : 1) * rect.width) / 2) * percent;\n    const y = rect.y + (rect.height / 2) * percent;\n    const scale = 1 - percent;\n    clone.setAttribute(\n      'transform',\n      'translate(' + x + ',' + y + ')' + ' scale(' + scale + ')',\n    );\n    setTimeout(disposeUiStep, 10, clone, rect, rtl, start);\n  }\n}\n\n/**\n * Play some UI effects (sound, ripple) after a connection has been established.\n *\n * @param block The block being connected.\n * @internal\n */\nexport function connectionUiEffect(block: BlockSvg) {\n  const workspace = block.workspace;\n  const scale = workspace.scale;\n  workspace.getAudioManager().play('click');\n  if (scale < 1) {\n    return; // Too small to care about visual effects.\n  }\n  // Determine the absolute coordinates of the inferior block.\n  const xy = workspace.getSvgXY(block.getSvgRoot());\n  // Offset the coordinates based on the two connection types, fix scale.\n  if (block.outputConnection) {\n    xy.x += (block.RTL ? 3 : -3) * scale;\n    xy.y += 13 * scale;\n  } else if (block.previousConnection) {\n    xy.x += (block.RTL ? -23 : 23) * scale;\n    xy.y += 3 * scale;\n  }\n  const ripple = dom.createSvgElement(\n    Svg.CIRCLE,\n    {\n      'cx': xy.x,\n      'cy': xy.y,\n      'r': 0,\n      'fill': 'none',\n      'stroke': '#888',\n      'stroke-width': 10,\n    },\n    workspace.getParentSvg(),\n  );\n\n  const scaleAnimation = dom.createSvgElement(\n    Svg.ANIMATE,\n    {\n      'id': 'animationCircle',\n      'begin': 'indefinite',\n      'attributeName': 'r',\n      'dur': '150ms',\n      'from': 0,\n      'to': 25 * scale,\n    },\n    ripple,\n  );\n  const opacityAnimation = dom.createSvgElement(\n    Svg.ANIMATE,\n    {\n      'id': 'animationOpacity',\n      'begin': 'indefinite',\n      'attributeName': 'opacity',\n      'dur': '150ms',\n      'from': 1,\n      'to': 0,\n    },\n    ripple,\n  );\n\n  scaleAnimation.beginElement();\n  opacityAnimation.beginElement();\n\n  setTimeout(() => void dom.removeNode(ripple), 150);\n}\n\n/**\n * Play some UI effects (sound, animation) when disconnecting a block.\n *\n * @param block The block being disconnected.\n * @internal\n */\nexport function disconnectUiEffect(block: BlockSvg) {\n  disconnectUiStop();\n  block.workspace.getAudioManager().play('disconnect');\n  if (block.workspace.scale < 1) {\n    return; // Too small to care about visual effects.\n  }\n  // Horizontal distance for bottom of block to wiggle.\n  const DISPLACEMENT = 10;\n  // Scale magnitude of skew to height of block.\n  const height = block.getHeightWidth().height;\n  let magnitude = (Math.atan(DISPLACEMENT / height) / Math.PI) * 180;\n  if (!block.RTL) {\n    magnitude *= -1;\n  }\n  // Start the animation.\n  wobblingBlock = block;\n  disconnectUiStep(block, magnitude, new Date());\n}\n\n/**\n * Animate a brief wiggle of a disconnected block.\n *\n * @param block Block to animate.\n * @param magnitude Maximum degrees skew (reversed for RTL).\n * @param start Date of animation's start.\n */\nfunction disconnectUiStep(block: BlockSvg, magnitude: number, start: Date) {\n  const DURATION = 200; // Milliseconds.\n  const WIGGLES = 3; // Half oscillations.\n\n  const ms = new Date().getTime() - start.getTime();\n  const percent = ms / DURATION;\n\n  let skew = '';\n  if (percent <= 1) {\n    const val = Math.round(\n      Math.sin(percent * Math.PI * WIGGLES) * (1 - percent) * magnitude,\n    );\n    skew = `skewX(${val})`;\n    disconnectPid = setTimeout(disconnectUiStep, 10, block, magnitude, start);\n  }\n\n  block\n    .getSvgRoot()\n    .setAttribute('transform', `${block.getTranslation()} ${skew}`);\n}\n\n/**\n * Stop the disconnect UI animation immediately.\n *\n * @internal\n */\nexport function disconnectUiStop() {\n  if (!wobblingBlock) return;\n  if (disconnectPid) {\n    clearTimeout(disconnectPid);\n    disconnectPid = null;\n  }\n  wobblingBlock\n    .getSvgRoot()\n    .setAttribute('transform', wobblingBlock.getTranslation());\n  wobblingBlock = null;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Coordinate} from '../utils/coordinate';\n\n/**\n * Represents an object that can be dragged.\n */\nexport interface IDraggable extends IDragStrategy {\n  /**\n   * Returns the current location of the draggable in workspace\n   * coordinates.\n   *\n   * @returns Coordinate of current location on workspace.\n   */\n  getRelativeToSurfaceXY(): Coordinate;\n}\n\nexport interface IDragStrategy {\n  /** Returns true iff the element is currently movable. */\n  isMovable(): boolean;\n\n  /**\n   * Handles any drag startup (e.g moving elements to the front of the\n   * workspace).\n   *\n   * @param e PointerEvent that started the drag; can be used to\n   *     check modifier keys, etc.  May be missing when dragging is\n   *     triggered programatically rather than by user.\n   */\n  startDrag(e?: PointerEvent): void;\n\n  /**\n   * Handles moving elements to the new location, and updating any\n   * visuals based on that (e.g connection previews for blocks).\n   *\n   * @param newLoc Workspace coordinate to which the draggable has\n   *     been dragged.\n   * @param e PointerEvent that continued the drag.  Can be\n   *     used to check modifier keys, etc.\n   */\n  drag(newLoc: Coordinate, e?: PointerEvent): void;\n\n  /**\n   * Handles any drag cleanup, including e.g. connecting or deleting\n   * blocks.\n   *\n   * @param newLoc Workspace coordinate at which the drag finished.\n   *     been dragged.\n   * @param e PointerEvent that finished the drag.  Can be\n   *     used to check modifier keys, etc.\n   */\n  endDrag(e?: PointerEvent): void;\n\n  /** Moves the draggable back to where it was at the start of the drag. */\n  revertDrag(): void;\n}\n\n/** Returns whether the given object is an IDraggable or not. */\nexport function isDraggable(obj: any): obj is IDraggable {\n  return (\n    obj.getRelativeToSurfaceXY !== undefined &&\n    obj.isMovable !== undefined &&\n    obj.startDrag !== undefined &&\n    obj.drag !== undefined &&\n    obj.endDrag !== undefined &&\n    obj.revertDrag !== undefined\n  );\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.object\n\n/**\n * Complete a deep merge of all members of a source object with a target object.\n *\n * @param target Target.\n * @param source Source.\n * @returns The resulting object.\n */\nexport function deepMerge(\n  target: AnyDuringMigration,\n  source: AnyDuringMigration,\n): AnyDuringMigration {\n  for (const x in source) {\n    if (source[x] !== null && typeof source[x] === 'object') {\n      target[x] = deepMerge(target[x] || Object.create(null), source[x]);\n    } else {\n      target[x] = source[x];\n    }\n  }\n  return target;\n}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport {IProcedureModel} from './i_procedure_model.js';\n// Former goog.module ID: Blockly.procedures.IProcedureBlock\n\n/** The interface for a block which models a procedure. */\nexport interface IProcedureBlock {\n  getProcedureModel(): IProcedureModel;\n  doProcedureUpdate(): void;\n  isProcedureDef(): boolean;\n}\n\n/** A type guard which checks if the given block is a procedure block. */\nexport function isProcedureBlock(\n  block: Block | IProcedureBlock,\n): block is IProcedureBlock {\n  return (\n    (block as IProcedureBlock).getProcedureModel !== undefined &&\n    (block as IProcedureBlock).doProcedureUpdate !== undefined &&\n    (block as IProcedureBlock).isProcedureDef !== undefined\n  );\n}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object that fires events optionally.\n *\n * @internal\n */\nexport interface IObservable {\n  startPublishing(): void;\n  stopPublishing(): void;\n}\n\n/**\n * Type guard for checking if an object fulfills IObservable.\n *\n * @internal\n */\nexport function isObservable(obj: any): obj is IObservable {\n  return obj.startPublishing !== undefined && obj.stopPublishing !== undefined;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.fieldRegistry\n\nimport type {Field, FieldConfig} from './field.js';\nimport * as registry from './registry.js';\n\n/**\n * When constructing a field from JSON using the registry, the\n * `fromJson` method in this file is called with an options parameter\n * object consisting of the \"type\" which is the name of the field, and\n * other options that are part of the field's config object.\n *\n * These options are then passed to the field's static `fromJson`\n * method. That method accepts an options parameter with a type that usually\n * extends from FieldConfig, and may or may not have a \"type\" attribute (in\n * fact, it shouldn't, because we'd overwrite it as described above!)\n *\n * Unfortunately the registry has no way of knowing the actual Field subclass\n * that will be returned from passing in the name of the field. Therefore it\n * also has no way of knowing that the options object not only implements\n * `FieldConfig`, but it also should satisfy the Config that belongs to that\n * specific class's `fromJson` method.\n *\n * Because of this uncertainty, we just give up on type checking the properties\n * passed to the `fromJson` method, and allow arbitrary string keys with\n * unknown types.\n */\ntype RegistryOptions = FieldConfig & {\n  // The name of the field, e.g. field_dropdown\n  type: string;\n  [key: string]: unknown;\n};\n\n/**\n * Represents the static methods that must be defined on any\n * field that is registered, i.e. the constructor and fromJson methods.\n *\n * Because we don't know which Field subclass will be registered, we\n * are unable to typecheck the parameters of the constructor.\n */\nexport interface RegistrableField {\n  new (...args: any[]): Field;\n  fromJson(options: FieldConfig): Field;\n}\n\n/**\n * Registers a field type.\n * fieldRegistry.fromJson uses this registry to\n * find the appropriate field type.\n *\n * @param type The field type name as used in the JSON definition.\n * @param fieldClass The field class containing a fromJson function that can\n *     construct an instance of the field.\n * @throws {Error} if the type name is empty, the field is already registered,\n *     or the fieldClass is not an object containing a fromJson function.\n */\nexport function register(type: string, fieldClass: RegistrableField) {\n  registry.register(registry.Type.FIELD, type, fieldClass);\n}\n\n/**\n * Unregisters the field registered with the given type.\n *\n * @param type The field type name as used in the JSON definition.\n */\nexport function unregister(type: string) {\n  registry.unregister(registry.Type.FIELD, type);\n}\n\n/**\n * Construct a Field from a JSON arg object.\n * Finds the appropriate registered field by the type name as registered using\n * fieldRegistry.register.\n *\n * @param options A JSON object with a type and options specific to the field\n *     type.\n * @returns The new field instance or null if a field wasn't found with the\n *     given type name\n * @internal\n */\nexport function fromJson<T>(options: RegistryOptions): Field<T> | null {\n  return TEST_ONLY.fromJsonInternal(options);\n}\n\n/**\n * Private version of fromJson for stubbing in tests.\n *\n * @param options\n */\nfunction fromJsonInternal<T>(options: RegistryOptions): Field<T> | null {\n  const fieldObject = registry.getObject(\n    registry.Type.FIELD,\n    options.type,\n  ) as unknown as RegistrableField;\n  if (!fieldObject) {\n    console.warn(\n      'Blockly could not create a field of type ' +\n        options['type'] +\n        '. The field is probably not being registered. This could be because' +\n        ' the file is not loaded, the field does not register itself (Issue' +\n        ' #1584), or the registration is not being reached.',\n    );\n    return null;\n  }\n  return fieldObject.fromJson(options);\n}\n\nexport const TEST_ONLY = {\n  fromJsonInternal,\n};\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Dropdown input field.  Used for editable titles and variables.\n * In the interests of a consistent UI, the toolbox shares some functions and\n * properties with the context menu.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldDropdown\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {\n  Field,\n  FieldConfig,\n  FieldValidator,\n  UnattachedFieldError,\n} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {Menu} from './menu.js';\nimport {MenuItem} from './menuitem.js';\nimport * as style from './utils/style.js';\nimport * as aria from './utils/aria.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport * as utilsString from './utils/string.js';\nimport {Svg} from './utils/svg.js';\n\n/**\n * Class for an editable dropdown field.\n */\nexport class FieldDropdown extends Field<string> {\n  /** Horizontal distance that a checkmark overhangs the dropdown. */\n  static CHECKMARK_OVERHANG = 25;\n\n  /**\n   * Maximum height of the dropdown menu, as a percentage of the viewport\n   * height.\n   */\n  static MAX_MENU_HEIGHT_VH = 0.45;\n\n  static ARROW_CHAR = '';\n\n  /** A reference to the currently selected menu item. */\n  private selectedMenuItem: MenuItem | null = null;\n\n  /** The dropdown menu. */\n  protected menu_: Menu | null = null;\n\n  /**\n   * SVG image element if currently selected option is an image, or null.\n   */\n  private imageElement: SVGImageElement | null = null;\n\n  /** Tspan based arrow element. */\n  private arrow: SVGTSpanElement | null = null;\n\n  /** SVG based arrow element. */\n  private svgArrow: SVGElement | null = null;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /** Mouse cursor style when over the hotspot that initiates the editor. */\n  override CURSOR = 'default';\n\n  protected menuGenerator_?: MenuGenerator;\n\n  /** A cache of the most recently generated options. */\n  private generatedOptions: MenuOption[] | null = null;\n\n  /**\n   * The prefix field label, of common words set after options are trimmed.\n   *\n   * @internal\n   */\n  override prefixField: string | null = null;\n\n  /**\n   * The suffix field label, of common words set after options are trimmed.\n   *\n   * @internal\n   */\n  override suffixField: string | null = null;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  private selectedOption!: MenuOption;\n  override clickTarget_: SVGElement | null = null;\n\n  /**\n   * @param menuGenerator A non-empty array of options for a dropdown list, or a\n   *     function which generates these options. Also accepts Field.SKIP_SETUP\n   *     if you wish to skip setup (only used by subclasses that want to handle\n   *     configuration and setting the field value after their own constructors\n   *     have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a language-neutral dropdown option & returns a\n   *     validated language-neutral dropdown option, or null to abort the\n   *     change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/dropdown#creation}\n   * for a list of properties this parameter supports.\n   * @throws {TypeError} If `menuGenerator` options are incorrectly structured.\n   */\n  constructor(\n    menuGenerator: MenuGenerator,\n    validator?: FieldDropdownValidator,\n    config?: FieldDropdownConfig,\n  );\n  constructor(menuGenerator: typeof Field.SKIP_SETUP);\n  constructor(\n    menuGenerator: MenuGenerator | typeof Field.SKIP_SETUP,\n    validator?: FieldDropdownValidator,\n    config?: FieldDropdownConfig,\n  ) {\n    super(Field.SKIP_SETUP);\n\n    // If we pass SKIP_SETUP, don't do *anything* with the menu generator.\n    if (menuGenerator === Field.SKIP_SETUP) return;\n\n    if (Array.isArray(menuGenerator)) {\n      validateOptions(menuGenerator);\n      const trimmed = trimOptions(menuGenerator);\n      this.menuGenerator_ = trimmed.options;\n      this.prefixField = trimmed.prefix || null;\n      this.suffixField = trimmed.suffix || null;\n    } else {\n      this.menuGenerator_ = menuGenerator;\n    }\n\n    /**\n     * The currently selected option. The field is initialized with the\n     * first option selected.\n     */\n    this.selectedOption = this.getOptions(false)[0];\n\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(this.selectedOption[1]);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Sets the field's value based on the given XML element. Should only be\n   * called by Blockly.Xml.\n   *\n   * @param fieldElement The element containing info about the field's state.\n   * @internal\n   */\n  override fromXml(fieldElement: Element) {\n    if (this.isOptionListDynamic()) {\n      this.getOptions(false);\n    }\n    this.setValue(fieldElement.textContent);\n  }\n\n  /**\n   * Sets the field's value based on the given state.\n   *\n   * @param state The state to apply to the dropdown field.\n   * @internal\n   */\n  override loadState(state: AnyDuringMigration) {\n    if (this.loadLegacyState(FieldDropdown, state)) {\n      return;\n    }\n    if (this.isOptionListDynamic()) {\n      this.getOptions(false);\n    }\n    this.setValue(state);\n  }\n\n  /**\n   * Create the block UI for this dropdown.\n   */\n  override initView() {\n    if (this.shouldAddBorderRect_()) {\n      this.createBorderRect_();\n    } else {\n      this.clickTarget_ = (this.sourceBlock_ as BlockSvg).getSvgRoot();\n    }\n    this.createTextElement_();\n\n    this.imageElement = dom.createSvgElement(Svg.IMAGE, {}, this.fieldGroup_);\n\n    if (this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW) {\n      this.createSVGArrow_();\n    } else {\n      this.createTextArrow_();\n    }\n\n    if (this.borderRect_) {\n      dom.addClass(this.borderRect_, 'blocklyDropdownRect');\n    }\n  }\n\n  /**\n   * Whether or not the dropdown should add a border rect.\n   *\n   * @returns True if the dropdown field should add a border rect.\n   */\n  protected shouldAddBorderRect_(): boolean {\n    return (\n      !this.getConstants()!.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW ||\n      (this.getConstants()!.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW &&\n        !this.getSourceBlock()?.isShadow())\n    );\n  }\n\n  /** Create a tspan based arrow. */\n  protected createTextArrow_() {\n    this.arrow = dom.createSvgElement(Svg.TSPAN, {}, this.textElement_);\n    this.arrow!.appendChild(\n      document.createTextNode(\n        this.getSourceBlock()?.RTL\n          ? FieldDropdown.ARROW_CHAR + ' '\n          : ' ' + FieldDropdown.ARROW_CHAR,\n      ),\n    );\n    if (this.getConstants()!.FIELD_TEXT_BASELINE_CENTER) {\n      this.arrow.setAttribute('dominant-baseline', 'central');\n    }\n    if (this.getSourceBlock()?.RTL) {\n      this.getTextElement().insertBefore(this.arrow, this.textContent_);\n    } else {\n      this.getTextElement().appendChild(this.arrow);\n    }\n  }\n\n  /** Create an SVG based arrow. */\n  protected createSVGArrow_() {\n    this.svgArrow = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'height': this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE + 'px',\n        'width': this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE + 'px',\n      },\n      this.fieldGroup_,\n    );\n    this.svgArrow!.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_DATAURI,\n    );\n  }\n\n  /**\n   * Create a dropdown menu under the text.\n   *\n   * @param e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   */\n  protected override showEditor_(e?: MouseEvent) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    this.dropdownCreate();\n    if (e && typeof e.clientX === 'number') {\n      this.menu_!.openingCoords = new Coordinate(e.clientX, e.clientY);\n    } else {\n      this.menu_!.openingCoords = null;\n    }\n\n    // Remove any pre-existing elements in the dropdown.\n    dropDownDiv.clearContent();\n    // Element gets created in render.\n    const menuElement = this.menu_!.render(dropDownDiv.getContentDiv());\n    dom.addClass(menuElement, 'blocklyDropdownMenu');\n\n    if (this.getConstants()!.FIELD_DROPDOWN_COLOURED_DIV) {\n      const primaryColour = block.getColour();\n      const borderColour = (this.sourceBlock_ as BlockSvg).style.colourTertiary;\n      dropDownDiv.setColour(primaryColour, borderColour);\n    }\n\n    dropDownDiv.showPositionedByField(this, this.dropdownDispose_.bind(this));\n\n    // Focusing needs to be handled after the menu is rendered and positioned.\n    // Otherwise it will cause a page scroll to get the misplaced menu in\n    // view. See issue #1329.\n    this.menu_!.focus();\n\n    if (this.selectedMenuItem) {\n      this.menu_!.setHighlighted(this.selectedMenuItem);\n      style.scrollIntoContainerView(\n        this.selectedMenuItem.getElement()!,\n        dropDownDiv.getContentDiv(),\n        true,\n      );\n    }\n\n    this.applyColour();\n  }\n\n  /** Create the dropdown editor. */\n  private dropdownCreate() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const menu = new Menu();\n    menu.setRole(aria.Role.LISTBOX);\n    this.menu_ = menu;\n\n    const options = this.getOptions(false);\n    this.selectedMenuItem = null;\n    for (let i = 0; i < options.length; i++) {\n      const [label, value] = options[i];\n      const content = (() => {\n        if (typeof label === 'object') {\n          // Convert ImageProperties to an HTMLImageElement.\n          const image = new Image(label['width'], label['height']);\n          image.src = label['src'];\n          image.alt = label['alt'] || '';\n          return image;\n        }\n        return label;\n      })();\n      const menuItem = new MenuItem(content, value);\n      menuItem.setRole(aria.Role.OPTION);\n      menuItem.setRightToLeft(block.RTL);\n      menuItem.setCheckable(true);\n      menu.addChild(menuItem);\n      menuItem.setChecked(value === this.value_);\n      if (value === this.value_) {\n        this.selectedMenuItem = menuItem;\n      }\n      menuItem.onAction(this.handleMenuActionEvent, this);\n    }\n  }\n\n  /**\n   * Disposes of events and DOM-references belonging to the dropdown editor.\n   */\n  protected dropdownDispose_() {\n    if (this.menu_) {\n      this.menu_.dispose();\n    }\n    this.menu_ = null;\n    this.selectedMenuItem = null;\n    this.applyColour();\n  }\n\n  /**\n   * Handle an action in the dropdown menu.\n   *\n   * @param menuItem The MenuItem selected within menu.\n   */\n  private handleMenuActionEvent(menuItem: MenuItem) {\n    dropDownDiv.hideIfOwner(this, true);\n    this.onItemSelected_(this.menu_ as Menu, menuItem);\n  }\n\n  /**\n   * Handle the selection of an item in the dropdown menu.\n   *\n   * @param menu The Menu component clicked.\n   * @param menuItem The MenuItem selected within menu.\n   */\n  protected onItemSelected_(menu: Menu, menuItem: MenuItem) {\n    this.setValue(menuItem.getValue());\n  }\n\n  /**\n   * @returns True if the option list is generated by a function.\n   *     Otherwise false.\n   */\n  isOptionListDynamic(): boolean {\n    return typeof this.menuGenerator_ === 'function';\n  }\n\n  /**\n   * Return a list of the options for this dropdown.\n   *\n   * @param useCache For dynamic options, whether or not to use the cached\n   *     options or to re-generate them.\n   * @returns A non-empty array of option tuples:\n   *     (human-readable text or image, language-neutral name).\n   * @throws {TypeError} If generated options are incorrectly structured.\n   */\n  getOptions(useCache?: boolean): MenuOption[] {\n    if (!this.menuGenerator_) {\n      // A subclass improperly skipped setup without defining the menu\n      // generator.\n      throw TypeError('A menu generator was never defined.');\n    }\n    if (Array.isArray(this.menuGenerator_)) return this.menuGenerator_;\n    if (useCache && this.generatedOptions) return this.generatedOptions;\n\n    this.generatedOptions = this.menuGenerator_();\n    validateOptions(this.generatedOptions);\n    return this.generatedOptions;\n  }\n\n  /**\n   * Ensure that the input value is a valid language-neutral option.\n   *\n   * @param newValue The input value.\n   * @returns A valid language-neutral option, or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue: string,\n  ): string | null | undefined;\n  protected override doClassValidation_(newValue?: string): string | null;\n  protected override doClassValidation_(\n    newValue?: string,\n  ): string | null | undefined {\n    const options = this.getOptions(true);\n    const isValueValid = options.some((option) => option[1] === newValue);\n\n    if (!isValueValid) {\n      if (this.sourceBlock_) {\n        console.warn(\n          \"Cannot set the dropdown's value to an unavailable option.\" +\n            ' Block type: ' +\n            this.sourceBlock_.type +\n            ', Field name: ' +\n            this.name +\n            ', Value: ' +\n            newValue,\n        );\n      }\n      return null;\n    }\n    return newValue;\n  }\n\n  /**\n   * Update the value of this dropdown field.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is one of the valid dropdown options.\n   */\n  protected override doValueUpdate_(newValue: string) {\n    super.doValueUpdate_(newValue);\n    const options = this.getOptions(true);\n    for (let i = 0, option; (option = options[i]); i++) {\n      if (option[1] === this.value_) {\n        this.selectedOption = option;\n      }\n    }\n  }\n\n  /**\n   * Updates the dropdown arrow to match the colour/style of the block.\n   */\n  override applyColour() {\n    const style = (this.sourceBlock_ as BlockSvg).style;\n    if (this.borderRect_) {\n      this.borderRect_.setAttribute('stroke', style.colourTertiary);\n      if (this.menu_) {\n        this.borderRect_.setAttribute('fill', style.colourTertiary);\n      } else {\n        this.borderRect_.setAttribute('fill', 'transparent');\n      }\n    }\n    // Update arrow's colour.\n    if (this.sourceBlock_ && this.arrow) {\n      if (this.sourceBlock_.isShadow()) {\n        this.arrow.style.fill = style.colourSecondary;\n      } else {\n        this.arrow.style.fill = style.colourPrimary;\n      }\n    }\n  }\n\n  /** Draws the border with the correct width. */\n  protected override render_() {\n    // Hide both elements.\n    this.getTextContent().nodeValue = '';\n    this.imageElement!.style.display = 'none';\n\n    // Show correct element.\n    const option = this.selectedOption && this.selectedOption[0];\n    if (option && typeof option === 'object') {\n      this.renderSelectedImage(option);\n    } else {\n      this.renderSelectedText();\n    }\n\n    this.positionBorderRect_();\n  }\n\n  /**\n   * Renders the selected option, which must be an image.\n   *\n   * @param imageJson Selected option that must be an image.\n   */\n  private renderSelectedImage(imageJson: ImageProperties) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    this.imageElement!.style.display = '';\n    this.imageElement!.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      imageJson.src,\n    );\n    this.imageElement!.setAttribute('height', String(imageJson.height));\n    this.imageElement!.setAttribute('width', String(imageJson.width));\n\n    const imageHeight = Number(imageJson.height);\n    const imageWidth = Number(imageJson.width);\n\n    // Height and width include the border rect.\n    const hasBorder = !!this.borderRect_;\n    const height = Math.max(\n      hasBorder ? this.getConstants()!.FIELD_DROPDOWN_BORDER_RECT_HEIGHT : 0,\n      imageHeight + IMAGE_Y_PADDING,\n    );\n    const xPadding = hasBorder\n      ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING\n      : 0;\n    let arrowWidth = 0;\n    if (this.svgArrow) {\n      arrowWidth = this.positionSVGArrow(\n        imageWidth + xPadding,\n        height / 2 - this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE / 2,\n      );\n    } else {\n      arrowWidth = dom.getFastTextWidth(\n        this.arrow as SVGTSpanElement,\n        this.getConstants()!.FIELD_TEXT_FONTSIZE,\n        this.getConstants()!.FIELD_TEXT_FONTWEIGHT,\n        this.getConstants()!.FIELD_TEXT_FONTFAMILY,\n      );\n    }\n    this.size_.width = imageWidth + arrowWidth + xPadding * 2;\n    this.size_.height = height;\n\n    let arrowX = 0;\n    if (block.RTL) {\n      const imageX = xPadding + arrowWidth;\n      this.imageElement!.setAttribute('x', `${imageX}`);\n    } else {\n      arrowX = imageWidth + arrowWidth;\n      this.getTextElement().setAttribute('text-anchor', 'end');\n      this.imageElement!.setAttribute('x', `${xPadding}`);\n    }\n    this.imageElement!.setAttribute('y', String(height / 2 - imageHeight / 2));\n\n    this.positionTextElement_(arrowX + xPadding, imageWidth + arrowWidth);\n  }\n\n  /** Renders the selected option, which must be text. */\n  private renderSelectedText() {\n    // Retrieves the selected option to display through getText_.\n    this.getTextContent().nodeValue = this.getDisplayText_();\n    const textElement = this.getTextElement();\n    dom.addClass(textElement, 'blocklyDropdownText');\n    textElement.setAttribute('text-anchor', 'start');\n\n    // Height and width include the border rect.\n    const hasBorder = !!this.borderRect_;\n    const height = Math.max(\n      hasBorder ? this.getConstants()!.FIELD_DROPDOWN_BORDER_RECT_HEIGHT : 0,\n      this.getConstants()!.FIELD_TEXT_HEIGHT,\n    );\n    const textWidth = dom.getFastTextWidth(\n      this.getTextElement(),\n      this.getConstants()!.FIELD_TEXT_FONTSIZE,\n      this.getConstants()!.FIELD_TEXT_FONTWEIGHT,\n      this.getConstants()!.FIELD_TEXT_FONTFAMILY,\n    );\n    const xPadding = hasBorder\n      ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING\n      : 0;\n    let arrowWidth = 0;\n    if (this.svgArrow) {\n      arrowWidth = this.positionSVGArrow(\n        textWidth + xPadding,\n        height / 2 - this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE / 2,\n      );\n    }\n    this.size_.width = textWidth + arrowWidth + xPadding * 2;\n    this.size_.height = height;\n\n    this.positionTextElement_(xPadding, textWidth);\n  }\n\n  /**\n   * Position a drop-down arrow at the appropriate location at render-time.\n   *\n   * @param x X position the arrow is being rendered at, in px.\n   * @param y Y position the arrow is being rendered at, in px.\n   * @returns Amount of space the arrow is taking up, in px.\n   */\n  private positionSVGArrow(x: number, y: number): number {\n    if (!this.svgArrow) {\n      return 0;\n    }\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const hasBorder = !!this.borderRect_;\n    const xPadding = hasBorder\n      ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING\n      : 0;\n    const textPadding = this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_PADDING;\n    const svgArrowSize = this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE;\n    const arrowX = block.RTL ? xPadding : x + textPadding;\n    this.svgArrow.setAttribute(\n      'transform',\n      'translate(' + arrowX + ',' + y + ')',\n    );\n    return svgArrowSize + textPadding;\n  }\n\n  /**\n   * Use the `getText_` developer hook to override the field's text\n   * representation.  Get the selected option text.  If the selected option is\n   * an image we return the image alt text.\n   *\n   * @returns Selected option text.\n   */\n  protected override getText_(): string | null {\n    if (!this.selectedOption) {\n      return null;\n    }\n    const option = this.selectedOption[0];\n    if (typeof option === 'object') {\n      return option['alt'];\n    }\n    return option;\n  }\n\n  /**\n   * Construct a FieldDropdown from a JSON arg object.\n   *\n   * @param options A JSON object with options (options).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(\n    options: FieldDropdownFromJsonConfig,\n  ): FieldDropdown {\n    if (!options.options) {\n      throw new Error(\n        'options are required for the dropdown field. The ' +\n          'options property must be assigned an array of ' +\n          '[humanReadableValue, languageNeutralValue] tuples.',\n      );\n    }\n    // `this` might be a subclass of FieldDropdown if that class doesn't\n    // override the static fromJson method.\n    return new this(options.options, undefined, options);\n  }\n}\n\n/**\n * Definition of a human-readable image dropdown option.\n */\nexport interface ImageProperties {\n  src: string;\n  alt: string;\n  width: number;\n  height: number;\n}\n\n/**\n * An individual option in the dropdown menu. The first element is the human-\n * readable value (text or image), and the second element is the language-\n * neutral value.\n */\nexport type MenuOption = [string | ImageProperties, string];\n\n/**\n * A function that generates an array of menu options for FieldDropdown\n * or its descendants.\n */\nexport type MenuGeneratorFunction = (this: FieldDropdown) => MenuOption[];\n\n/**\n * Either an array of menu options or a function that generates an array of\n * menu options for FieldDropdown or its descendants.\n */\nexport type MenuGenerator = MenuOption[] | MenuGeneratorFunction;\n\n/**\n * Config options for the dropdown field.\n */\nexport type FieldDropdownConfig = FieldConfig;\n\n/**\n * fromJson config for the dropdown field.\n */\nexport interface FieldDropdownFromJsonConfig extends FieldDropdownConfig {\n  options?: MenuOption[];\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldDropdownValidator = FieldValidator<string>;\n\n/**\n * The y offset from the top of the field to the top of the image, if an image\n * is selected.\n */\nconst IMAGE_Y_OFFSET = 5;\n\n/** The total vertical padding above and below an image. */\nconst IMAGE_Y_PADDING: number = IMAGE_Y_OFFSET * 2;\n\n/**\n * Factor out common words in statically defined options.\n * Create prefix and/or suffix labels.\n */\nfunction trimOptions(options: MenuOption[]): {\n  options: MenuOption[];\n  prefix?: string;\n  suffix?: string;\n} {\n  let hasImages = false;\n  const trimmedOptions = options.map(([label, value]): MenuOption => {\n    if (typeof label === 'string') {\n      return [parsing.replaceMessageReferences(label), value];\n    }\n\n    hasImages = true;\n    // Copy the image properties so they're not influenced by the original.\n    // NOTE: No need to deep copy since image properties are only 1 level deep.\n    const imageLabel =\n      label.alt !== null\n        ? {...label, alt: parsing.replaceMessageReferences(label.alt)}\n        : {...label};\n    return [imageLabel, value];\n  });\n\n  if (hasImages || options.length < 2) return {options: trimmedOptions};\n\n  const stringOptions = trimmedOptions as [string, string][];\n  const stringLabels = stringOptions.map(([label]) => label);\n\n  const shortest = utilsString.shortestStringLength(stringLabels);\n  const prefixLength = utilsString.commonWordPrefix(stringLabels, shortest);\n  const suffixLength = utilsString.commonWordSuffix(stringLabels, shortest);\n\n  if (\n    (!prefixLength && !suffixLength) ||\n    shortest <= prefixLength + suffixLength\n  ) {\n    // One or more strings will entirely vanish if we proceed.  Abort.\n    return {options: stringOptions};\n  }\n\n  const prefix = prefixLength\n    ? stringLabels[0].substring(0, prefixLength - 1)\n    : undefined;\n  const suffix = suffixLength\n    ? stringLabels[0].substr(1 - suffixLength)\n    : undefined;\n  return {\n    options: applyTrim(stringOptions, prefixLength, suffixLength),\n    prefix,\n    suffix,\n  };\n}\n\n/**\n * Use the calculated prefix and suffix lengths to trim all of the options in\n * the given array.\n *\n * @param options Array of option tuples:\n *     (human-readable text or image, language-neutral name).\n * @param prefixLength The length of the common prefix.\n * @param suffixLength The length of the common suffix\n * @returns A new array with all of the option text trimmed.\n */\nfunction applyTrim(\n  options: [string, string][],\n  prefixLength: number,\n  suffixLength: number,\n): MenuOption[] {\n  return options.map(([text, value]) => [\n    text.substring(prefixLength, text.length - suffixLength),\n    value,\n  ]);\n}\n\n/**\n * Validates the data structure to be processed as an options list.\n *\n * @param options The proposed dropdown options.\n * @throws {TypeError} If proposed options are incorrectly structured.\n */\nfunction validateOptions(options: MenuOption[]) {\n  if (!Array.isArray(options)) {\n    throw TypeError('FieldDropdown options must be an array.');\n  }\n  if (!options.length) {\n    throw TypeError('FieldDropdown options must not be an empty array.');\n  }\n  let foundError = false;\n  for (let i = 0; i < options.length; i++) {\n    const tuple = options[i];\n    if (!Array.isArray(tuple)) {\n      foundError = true;\n      console.error(\n        'Invalid option[' +\n          i +\n          ']: Each FieldDropdown option must be an ' +\n          'array. Found: ',\n        tuple,\n      );\n    } else if (typeof tuple[1] !== 'string') {\n      foundError = true;\n      console.error(\n        'Invalid option[' +\n          i +\n          ']: Each FieldDropdown option id must be ' +\n          'a string. Found ' +\n          tuple[1] +\n          ' in: ',\n        tuple,\n      );\n    } else if (\n      tuple[0] &&\n      typeof tuple[0] !== 'string' &&\n      typeof tuple[0].src !== 'string'\n    ) {\n      foundError = true;\n      console.error(\n        'Invalid option[' +\n          i +\n          ']: Each FieldDropdown option must have a ' +\n          'string label or image description. Found' +\n          tuple[0] +\n          ' in: ',\n        tuple,\n      );\n    }\n  }\n  if (foundError) {\n    throw TypeError('Found invalid FieldDropdown options.');\n  }\n}\n\nfieldRegistry.register('field_dropdown', FieldDropdown);\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Extensions\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport {FieldDropdown} from './field_dropdown.js';\nimport {MutatorIcon} from './icons/mutator_icon.js';\nimport * as parsing from './utils/parsing.js';\n\n/** The set of all registered extensions, keyed by extension name/id. */\nconst allExtensions = Object.create(null);\nexport const TEST_ONLY = {allExtensions};\n\n/**\n * Registers a new extension function. Extensions are functions that help\n * initialize blocks, usually adding dynamic behavior such as onchange\n * handlers and mutators. These are applied using Block.applyExtension(), or\n * the JSON \"extensions\" array attribute.\n *\n * @param name The name of this extension.\n * @param initFn The function to initialize an extended block.\n * @throws {Error} if the extension name is empty, the extension is already\n *     registered, or extensionFn is not a function.\n */\nexport function register(name: string, initFn: Function) {\n  if (typeof name !== 'string' || name.trim() === '') {\n    throw Error('Error: Invalid extension name \"' + name + '\"');\n  }\n  if (allExtensions[name]) {\n    throw Error('Error: Extension \"' + name + '\" is already registered.');\n  }\n  if (typeof initFn !== 'function') {\n    throw Error('Error: Extension \"' + name + '\" must be a function');\n  }\n  allExtensions[name] = initFn;\n}\n\n/**\n * Registers a new extension function that adds all key/value of mixinObj.\n *\n * @param name The name of this extension.\n * @param mixinObj The values to mix in.\n * @throws {Error} if the extension name is empty or the extension is already\n *     registered.\n */\nexport function registerMixin(name: string, mixinObj: AnyDuringMigration) {\n  if (!mixinObj || typeof mixinObj !== 'object') {\n    throw Error('Error: Mixin \"' + name + '\" must be a object');\n  }\n  register(name, function (this: Block) {\n    this.mixin(mixinObj);\n  });\n}\n\n/**\n * Registers a new extension function that adds a mutator to the block.\n * At register time this performs some basic sanity checks on the mutator.\n * The wrapper may also add a mutator dialog to the block, if both compose and\n * decompose are defined on the mixin.\n *\n * @param name The name of this mutator extension.\n * @param mixinObj The values to mix in.\n * @param opt_helperFn An optional function to apply after mixing in the object.\n * @param opt_blockList A list of blocks to appear in the flyout of the mutator\n *     dialog.\n * @throws {Error} if the mutation is invalid or can't be applied to the block.\n */\nexport function registerMutator(\n  name: string,\n  mixinObj: AnyDuringMigration,\n  opt_helperFn?: () => AnyDuringMigration,\n  opt_blockList?: string[],\n) {\n  const errorPrefix = 'Error when registering mutator \"' + name + '\": ';\n\n  checkHasMutatorProperties(errorPrefix, mixinObj);\n  const hasMutatorDialog = checkMutatorDialog(mixinObj, errorPrefix);\n\n  if (opt_helperFn && typeof opt_helperFn !== 'function') {\n    throw Error(errorPrefix + 'Extension \"' + name + '\" is not a function');\n  }\n\n  // Sanity checks passed.\n  register(name, function (this: Block) {\n    if (hasMutatorDialog) {\n      this.setMutator(new MutatorIcon(opt_blockList || [], this as BlockSvg));\n    }\n    // Mixin the object.\n    this.mixin(mixinObj);\n\n    if (opt_helperFn) {\n      opt_helperFn.apply(this);\n    }\n  });\n}\n\n/**\n * Unregisters the extension registered with the given name.\n *\n * @param name The name of the extension to unregister.\n */\nexport function unregister(name: string) {\n  if (isRegistered(name)) {\n    delete allExtensions[name];\n  } else {\n    console.warn(\n      'No extension mapping for name \"' + name + '\" found to unregister',\n    );\n  }\n}\n\n/**\n * Returns whether an extension is registered with the given name.\n *\n * @param name The name of the extension to check for.\n * @returns True if the extension is registered.  False if it is not registered.\n */\nexport function isRegistered(name: string): boolean {\n  return !!allExtensions[name];\n}\n\n/**\n * Applies an extension method to a block. This should only be called during\n * block construction.\n *\n * @param name The name of the extension.\n * @param block The block to apply the named extension to.\n * @param isMutator True if this extension defines a mutator.\n * @throws {Error} if the extension is not found.\n */\nexport function apply(name: string, block: Block, isMutator: boolean) {\n  const extensionFn = allExtensions[name];\n  if (typeof extensionFn !== 'function') {\n    throw Error('Error: Extension \"' + name + '\" not found.');\n  }\n  let mutatorProperties;\n  if (isMutator) {\n    // Fail early if the block already has mutation properties.\n    checkNoMutatorProperties(name, block);\n  } else {\n    // Record the old properties so we can make sure they don't change after\n    // applying the extension.\n    mutatorProperties = getMutatorProperties(block);\n  }\n  extensionFn.apply(block);\n\n  if (isMutator) {\n    const errorPrefix = 'Error after applying mutator \"' + name + '\": ';\n    checkHasMutatorProperties(errorPrefix, block);\n  } else {\n    if (\n      !mutatorPropertiesMatch(mutatorProperties as AnyDuringMigration[], block)\n    ) {\n      throw Error(\n        'Error when applying extension \"' +\n          name +\n          '\": ' +\n          'mutation properties changed when applying a non-mutator extension.',\n      );\n    }\n  }\n}\n\n/**\n * Check that the given block does not have any of the four mutator properties\n * defined on it.  This function should be called before applying a mutator\n * extension to a block, to make sure we are not overwriting properties.\n *\n * @param mutationName The name of the mutation to reference in error messages.\n * @param block The block to check.\n * @throws {Error} if any of the properties already exist on the block.\n */\nfunction checkNoMutatorProperties(mutationName: string, block: Block) {\n  const properties = getMutatorProperties(block);\n  if (properties.length) {\n    throw Error(\n      'Error: tried to apply mutation \"' +\n        mutationName +\n        '\" to a block that already has mutator functions.' +\n        '  Block id: ' +\n        block.id,\n    );\n  }\n}\n\n/**\n * Checks if the given object has both the 'mutationToDom' and 'domToMutation'\n * functions.\n *\n * @param object The object to check.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} if the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkXmlHooks(\n  object: AnyDuringMigration,\n  errorPrefix: string,\n): boolean {\n  return checkHasFunctionPair(\n    object.mutationToDom,\n    object.domToMutation,\n    errorPrefix + ' mutationToDom/domToMutation',\n  );\n}\n/**\n * Checks if the given object has both the 'saveExtraState' and 'loadExtraState'\n * functions.\n *\n * @param object The object to check.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} if the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkJsonHooks(\n  object: AnyDuringMigration,\n  errorPrefix: string,\n): boolean {\n  return checkHasFunctionPair(\n    object.saveExtraState,\n    object.loadExtraState,\n    errorPrefix + ' saveExtraState/loadExtraState',\n  );\n}\n\n/**\n * Checks if the given object has both the 'compose' and 'decompose' functions.\n *\n * @param object The object to check.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} if the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkMutatorDialog(\n  object: AnyDuringMigration,\n  errorPrefix: string,\n): boolean {\n  return checkHasFunctionPair(\n    object.compose,\n    object.decompose,\n    errorPrefix + ' compose/decompose',\n  );\n}\n\n/**\n * Checks that both or neither of the given functions exist and that they are\n * indeed functions.\n *\n * @param func1 The first function in the pair.\n * @param func2 The second function in the pair.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} If the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkHasFunctionPair(\n  func1: AnyDuringMigration,\n  func2: AnyDuringMigration,\n  errorPrefix: string,\n): boolean {\n  if (func1 && func2) {\n    if (typeof func1 !== 'function' || typeof func2 !== 'function') {\n      throw Error(errorPrefix + ' must be a function');\n    }\n    return true;\n  } else if (!func1 && !func2) {\n    return false;\n  }\n  throw Error(errorPrefix + 'Must have both or neither functions');\n}\n\n/**\n * Checks that the given object required mutator properties.\n *\n * @param errorPrefix The string to prepend to any error message.\n * @param object The object to inspect.\n */\nfunction checkHasMutatorProperties(\n  errorPrefix: string,\n  object: AnyDuringMigration,\n) {\n  const hasXmlHooks = checkXmlHooks(object, errorPrefix);\n  const hasJsonHooks = checkJsonHooks(object, errorPrefix);\n  if (!hasXmlHooks && !hasJsonHooks) {\n    throw Error(\n      errorPrefix +\n        'Mutations must contain either XML hooks, or JSON hooks, or both',\n    );\n  }\n  // A block with a mutator isn't required to have a mutation dialog, but\n  // it should still have both or neither of compose and decompose.\n  checkMutatorDialog(object, errorPrefix);\n}\n\n/**\n * Get a list of values of mutator properties on the given block.\n *\n * @param block The block to inspect.\n * @returns A list with all of the defined properties, which should be\n *     functions, but may be anything other than undefined.\n */\nfunction getMutatorProperties(block: Block): AnyDuringMigration[] {\n  const result = [];\n  // List each function explicitly by reference to allow for renaming\n  // during compilation.\n  if (block.domToMutation !== undefined) {\n    result.push(block.domToMutation);\n  }\n  if (block.mutationToDom !== undefined) {\n    result.push(block.mutationToDom);\n  }\n  if (block.saveExtraState !== undefined) {\n    result.push(block.saveExtraState);\n  }\n  if (block.loadExtraState !== undefined) {\n    result.push(block.loadExtraState);\n  }\n  if (block.compose !== undefined) {\n    result.push(block.compose);\n  }\n  if (block.decompose !== undefined) {\n    result.push(block.decompose);\n  }\n  return result;\n}\n\n/**\n * Check that the current mutator properties match a list of old mutator\n * properties.  This should be called after applying a non-mutator extension,\n * to verify that the extension didn't change properties it shouldn't.\n *\n * @param oldProperties The old values to compare to.\n * @param block The block to inspect for new values.\n * @returns True if the property lists match.\n */\nfunction mutatorPropertiesMatch(\n  oldProperties: AnyDuringMigration[],\n  block: Block,\n): boolean {\n  const newProperties = getMutatorProperties(block);\n  if (newProperties.length !== oldProperties.length) {\n    return false;\n  }\n  for (let i = 0; i < newProperties.length; i++) {\n    if (oldProperties[i] !== newProperties[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Calls a function after the page has loaded, possibly immediately.\n *\n * @param fn Function to run.\n * @throws Error Will throw if no global document can be found (e.g., Node.js).\n * @internal\n */\nexport function runAfterPageLoad(fn: () => void) {\n  if (typeof document !== 'object') {\n    throw Error('runAfterPageLoad() requires browser document.');\n  }\n  if (document.readyState === 'complete') {\n    fn(); // Page has already loaded. Call immediately.\n  } else {\n    // Poll readyState.\n    const readyStateCheckInterval = setInterval(function () {\n      if (document.readyState === 'complete') {\n        clearInterval(readyStateCheckInterval);\n        fn();\n      }\n    }, 10);\n  }\n}\n\n/**\n * Builds an extension function that will map a dropdown value to a tooltip\n * string.\n *\n * @param dropdownName The name of the field whose value is the key to the\n *     lookup table.\n * @param lookupTable The table of field values to tooltip text.\n * @returns The extension function.\n */\nexport function buildTooltipForDropdown(\n  dropdownName: string,\n  lookupTable: {[key: string]: string},\n): (this: Block) => void {\n  // List of block types already validated, to minimize duplicate warnings.\n  const blockTypesChecked: string[] = [];\n\n  return function (this: Block) {\n    if (!blockTypesChecked.includes(this.type)) {\n      checkDropdownOptionsInTable(this, dropdownName, lookupTable);\n      blockTypesChecked.push(this.type);\n    }\n\n    this.setTooltip(\n      function (this: Block) {\n        const value = String(this.getFieldValue(dropdownName));\n        return parsing.replaceMessageReferences(lookupTable[value]);\n      }.bind(this),\n    );\n  };\n}\n\n/**\n * Checks all options keys are present in the provided string lookup table.\n * Emits console warnings when they are not.\n *\n * @param block The block containing the dropdown\n * @param dropdownName The name of the dropdown\n * @param lookupTable The string lookup table\n */\nfunction checkDropdownOptionsInTable(\n  block: Block,\n  dropdownName: string,\n  lookupTable: {[key: string]: string},\n) {\n  const dropdown = block.getField(dropdownName);\n  if (!(dropdown instanceof FieldDropdown) || dropdown.isOptionListDynamic()) {\n    return;\n  }\n\n  const options = dropdown.getOptions();\n  for (const [, key] of options) {\n    if (lookupTable[key] === undefined) {\n      console.warn(\n        `No tooltip mapping for value ${key} of field ` +\n          `${dropdownName} of block type ${block.type}.`,\n      );\n    }\n  }\n}\n\n/**\n * Builds an extension function that will install a dynamic tooltip. The\n * tooltip message should include the string '%1' and that string will be\n * replaced with the text of the named field.\n *\n * @param msgTemplate The template form to of the message text, with %1\n *     placeholder.\n * @param fieldName The field with the replacement text.\n * @returns The extension function.\n */\nexport function buildTooltipWithFieldText(\n  msgTemplate: string,\n  fieldName: string,\n): (this: Block) => void {\n  return function (this: Block) {\n    this.setTooltip(\n      function (this: Block) {\n        const field = this.getField(fieldName);\n        return parsing\n          .replaceMessageReferences(msgTemplate)\n          .replace('%1', field ? field.getText() : '');\n      }.bind(this),\n    );\n  };\n}\n\n/**\n * Configures the tooltip to mimic the parent block when connected. Otherwise,\n * uses the tooltip text at the time this extension is initialized. This takes\n * advantage of the fact that all other values from JSON are initialized before\n * extensions.\n */\nfunction extensionParentTooltip(this: Block) {\n  const tooltipWhenNotConnected = this.tooltip;\n  this.setTooltip(\n    function (this: Block) {\n      const parent = this.getParent();\n      return (\n        (parent && parent.getInputsInline() && parent.tooltip) ||\n        tooltipWhenNotConnected\n      );\n    }.bind(this),\n  );\n}\nregister('parent_tooltip_when_inline', extensionParentTooltip);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.deprecation\n\n// Set of previously-emitted warnings.\nconst previousWarnings = new Set();\n\n/**\n * Warn developers that a function or property is deprecated.\n *\n * @param name The name of the function or property.\n * @param deprecationDate The date of deprecation. Prefer 'version n.0.0'\n *     format, and fall back to 'month yyyy' or 'quarter yyyy' format.\n * @param deletionDate The date of deletion. Prefer 'version n.0.0'\n *     format, and fall back to 'month yyyy' or 'quarter yyyy' format.\n * @param opt_use The name of a function or property to use instead, if any.\n * @internal\n */\nexport function warn(\n  name: string,\n  deprecationDate: string,\n  deletionDate: string,\n  opt_use?: string,\n) {\n  let msg =\n    name +\n    ' was deprecated in ' +\n    deprecationDate +\n    ' and will be deleted in ' +\n    deletionDate +\n    '.';\n  if (opt_use) {\n    msg += '\\nUse ' + opt_use + ' instead.';\n  }\n\n  // Don't log deprecation warnings multiple times.\n  if (previousWarnings.has(msg)) {\n    return;\n  }\n\n  previousWarnings.add(msg);\n  console.warn(msg);\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.svgPaths\n\n/**\n * Create a string representing the given x, y pair.  It does not matter whether\n * the coordinate is relative or absolute.  The result has leading\n * and trailing spaces, and separates the x and y coordinates with a comma but\n * no space.\n *\n * @param x The x coordinate.\n * @param y The y coordinate.\n * @returns A string of the format ' x,y '\n */\nexport function point(x: number, y: number): string {\n  return ' ' + x + ',' + y + ' ';\n}\n\n/**\n * Draw a cubic or quadratic curve.  See\n * developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d#Cubic_B%C3%A9zier_Curve\n * These coordinates are unitless and hence in the user coordinate system.\n *\n * @param command The command to use.\n *     Should be one of: c, C, s, S, q, Q.\n * @param points  An array containing all of the points to pass to the curve\n *     command, in order.  The points are represented as strings of the format '\n *     x, y '.\n * @returns A string defining one or more Bezier curves.  See the MDN\n *     documentation for exact format.\n */\nexport function curve(command: string, points: string[]): string {\n  return ' ' + command + points.join('');\n}\n\n/**\n * Move the cursor to the given position without drawing a line.\n * The coordinates are absolute.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param x The absolute x coordinate.\n * @param y The absolute y coordinate.\n * @returns A string of the format ' M x,y '\n */\nexport function moveTo(x: number, y: number): string {\n  return ' M ' + x + ',' + y + ' ';\n}\n\n/**\n * Move the cursor to the given position without drawing a line.\n * Coordinates are relative.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param dx The relative x coordinate.\n * @param dy The relative y coordinate.\n * @returns A string of the format ' m dx,dy '\n */\nexport function moveBy(dx: number, dy: number): string {\n  return ' m ' + dx + ',' + dy + ' ';\n}\n\n/**\n * Draw a line from the current point to the end point, which is the current\n * point shifted by dx along the x-axis and dy along the y-axis.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param dx The relative x coordinate.\n * @param dy The relative y coordinate.\n * @returns A string of the format ' l dx,dy '\n */\nexport function lineTo(dx: number, dy: number): string {\n  return ' l ' + dx + ',' + dy + ' ';\n}\n\n/**\n * Draw multiple lines connecting all of the given points in order.  This is\n * equivalent to a series of 'l' commands.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param points An array containing all of the points to draw lines to, in\n *     order.  The points are represented as strings of the format ' dx,dy '.\n * @returns A string of the format ' l (dx,dy)+ '\n */\nexport function line(points: string[]): string {\n  return ' l' + points.join('');\n}\n\n/**\n * Draw a horizontal or vertical line.\n * The first argument specifies the direction and whether the given position is\n * relative or absolute.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d#LineTo_path_commands\n *\n * @param command The command to prepend to the coordinate.  This should be one\n *     of: V, v, H, h.\n * @param val The coordinate to pass to the command.  It may be absolute or\n *     relative.\n * @returns A string of the format ' command val '\n */\nexport function lineOnAxis(command: string, val: number): string {\n  return ' ' + command + ' ' + val + ' ';\n}\n\n/**\n * Draw an elliptical arc curve.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d#Elliptical_Arc_Curve\n *\n * @param command The command string.  Either 'a' or 'A'.\n * @param flags The flag string.  See the MDN documentation for a description\n *     and examples.\n * @param radius The radius of the arc to draw.\n * @param point The point to move the cursor to after drawing the arc, specified\n *     either in absolute or relative coordinates depending on the command.\n * @returns A string of the format 'command radius radius flags point'\n */\nexport function arc(\n  command: string,\n  flags: string,\n  radius: number,\n  point: string,\n): string {\n  return command + ' ' + radius + ' ' + radius + ' ' + flags + point;\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport type {IIcon} from '../interfaces/i_icon.js';\nimport * as registry from '../registry.js';\nimport {IconType} from './icon_types.js';\n\n/**\n * Registers the given icon so that it can be deserialized.\n *\n * @param type The type of the icon to register. This should be the same string\n *     that is returned from its `getType` method.\n * @param iconConstructor The icon class/constructor to register.\n */\nexport function register(\n  type: IconType<IIcon>,\n  iconConstructor: new (block: Block) => IIcon,\n) {\n  registry.register(registry.Type.ICON, type.toString(), iconConstructor);\n}\n\n/**\n * Unregisters the icon associated with the given type.\n *\n * @param type The type of the icon to unregister.\n */\nexport function unregister(type: string) {\n  registry.unregister(registry.Type.ICON, type);\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Procedures\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport {Blocks} from './blocks.js';\nimport * as common from './common.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BubbleOpen} from './events/events_bubble_open.js';\nimport * as eventUtils from './events/utils.js';\nimport {Field, UnattachedFieldError} from './field.js';\nimport {Msg} from './msg.js';\nimport {Names} from './names.js';\nimport {IParameterModel} from './interfaces/i_parameter_model.js';\nimport {IProcedureMap} from './interfaces/i_procedure_map.js';\nimport {IProcedureModel} from './interfaces/i_procedure_model.js';\nimport {\n  IProcedureBlock,\n  isProcedureBlock,\n} from './interfaces/i_procedure_block.js';\nimport {\n  isLegacyProcedureCallBlock,\n  isLegacyProcedureDefBlock,\n  ProcedureBlock,\n  ProcedureTuple,\n} from './interfaces/i_legacy_procedure_blocks.js';\nimport {ObservableProcedureMap} from './observable_procedure_map.js';\nimport * as utilsXml from './utils/xml.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport {MutatorIcon} from './icons.js';\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * procedure blocks.\n * See also Blockly.Variables.CATEGORY_NAME and\n * Blockly.VariablesDynamic.CATEGORY_NAME.\n */\nexport const CATEGORY_NAME = 'PROCEDURE';\n\n/**\n * The default argument for a procedures_mutatorarg block.\n */\nexport const DEFAULT_ARG = 'x';\n\n/**\n * Find all user-created procedure definitions in a workspace.\n *\n * @param root Root workspace.\n * @returns Pair of arrays, the first contains procedures without return\n *     variables, the second with. Each procedure is defined by a three-element\n *     list of name, parameter list, and return value boolean.\n */\nexport function allProcedures(\n  root: Workspace,\n): [ProcedureTuple[], ProcedureTuple[]] {\n  const proceduresNoReturn: ProcedureTuple[] = root\n    .getProcedureMap()\n    .getProcedures()\n    .filter((p) => !p.getReturnTypes())\n    .map((p) => [\n      p.getName(),\n      p.getParameters().map((pa) => pa.getName()),\n      false,\n    ]);\n  root.getBlocksByType('procedures_defnoreturn', false).forEach((b) => {\n    if (!isProcedureBlock(b) && isLegacyProcedureDefBlock(b)) {\n      proceduresNoReturn.push(b.getProcedureDef());\n    }\n  });\n\n  const proceduresReturn: ProcedureTuple[] = root\n    .getProcedureMap()\n    .getProcedures()\n    .filter((p) => !!p.getReturnTypes())\n    .map((p) => [\n      p.getName(),\n      p.getParameters().map((pa) => pa.getName()),\n      true,\n    ]);\n  root.getBlocksByType('procedures_defreturn', false).forEach((b) => {\n    if (!isProcedureBlock(b) && isLegacyProcedureDefBlock(b)) {\n      proceduresReturn.push(b.getProcedureDef());\n    }\n  });\n  proceduresNoReturn.sort(procTupleComparator);\n  proceduresReturn.sort(procTupleComparator);\n  return [proceduresNoReturn, proceduresReturn];\n}\n\n/**\n * Comparison function for case-insensitive sorting of the first element of\n * a tuple.\n *\n * @param ta First tuple.\n * @param tb Second tuple.\n * @returns -1, 0, or 1 to signify greater than, equality, or less than.\n */\nfunction procTupleComparator(ta: ProcedureTuple, tb: ProcedureTuple): number {\n  return ta[0].localeCompare(tb[0], undefined, {sensitivity: 'base'});\n}\n\n/**\n * Ensure two identically-named procedures don't exist.\n * Take the proposed procedure name, and return a legal name i.e. one that\n * is not empty and doesn't collide with other procedures.\n *\n * @param name Proposed procedure name.\n * @param block Block to disambiguate.\n * @returns Non-colliding name.\n */\nexport function findLegalName(name: string, block: Block): string {\n  if (block.isInFlyout) {\n    // Flyouts can have multiple procedures called 'do something'.\n    return name;\n  }\n  name = name || Msg['UNNAMED_KEY'] || 'unnamed';\n  while (!isLegalName(name, block.workspace, block)) {\n    // Collision with another procedure.\n    const r = name.match(/^(.*?)(\\d+)$/);\n    if (!r) {\n      name += '2';\n    } else {\n      name = r[1] + (parseInt(r[2]) + 1);\n    }\n  }\n  return name;\n}\n/**\n * Does this procedure have a legal name?  Illegal names include names of\n * procedures already defined.\n *\n * @param name The questionable name.\n * @param workspace The workspace to scan for collisions.\n * @param opt_exclude Optional block to exclude from comparisons (one doesn't\n *     want to collide with oneself).\n * @returns True if the name is legal.\n */\nfunction isLegalName(\n  name: string,\n  workspace: Workspace,\n  opt_exclude?: Block,\n): boolean {\n  return !isNameUsed(name, workspace, opt_exclude);\n}\n\n/**\n * Return if the given name is already a procedure name.\n *\n * @param name The questionable name.\n * @param workspace The workspace to scan for collisions.\n * @param opt_exclude Optional block to exclude from comparisons (one doesn't\n *     want to collide with oneself).\n * @returns True if the name is used, otherwise return false.\n */\nexport function isNameUsed(\n  name: string,\n  workspace: Workspace,\n  opt_exclude?: Block,\n): boolean {\n  for (const block of workspace.getAllBlocks(false)) {\n    if (block === opt_exclude) continue;\n\n    if (\n      isLegacyProcedureDefBlock(block) &&\n      Names.equals(block.getProcedureDef()[0], name)\n    ) {\n      return true;\n    }\n  }\n\n  const excludeModel =\n    opt_exclude && isProcedureBlock(opt_exclude)\n      ? opt_exclude?.getProcedureModel()\n      : undefined;\n  for (const model of workspace.getProcedureMap().getProcedures()) {\n    if (model === excludeModel) continue;\n    if (Names.equals(model.getName(), name)) return true;\n  }\n  return false;\n}\n\n/**\n * Rename a procedure.  Called by the editable field.\n *\n * @param name The proposed new name.\n * @returns The accepted name.\n */\nexport function rename(this: Field, name: string): string {\n  const block = this.getSourceBlock();\n  if (!block) {\n    throw new UnattachedFieldError();\n  }\n\n  // Strip leading and trailing whitespace.  Beyond this, all names are legal.\n  name = name.trim();\n\n  const legalName = findLegalName(name, block);\n  if (isProcedureBlock(block) && !block.isInsertionMarker()) {\n    block.getProcedureModel().setName(legalName);\n  }\n  const oldName = this.getValue();\n  if (oldName !== name && oldName !== legalName) {\n    // Rename any callers.\n    const blocks = block.workspace.getAllBlocks(false);\n    for (let i = 0; i < blocks.length; i++) {\n      // Assume it is a procedure so we can check.\n      const procedureBlock = blocks[i] as unknown as ProcedureBlock;\n      if (procedureBlock.renameProcedure) {\n        procedureBlock.renameProcedure(oldName as string, legalName);\n      }\n    }\n  }\n  return legalName;\n}\n\n/**\n * Construct the blocks required by the flyout for the procedure category.\n *\n * @param workspace The workspace containing procedures.\n * @returns Array of XML block elements.\n */\nexport function flyoutCategory(workspace: WorkspaceSvg): Element[] {\n  const xmlList = [];\n  if (Blocks['procedures_defnoreturn']) {\n    // <block type=\"procedures_defnoreturn\" gap=\"16\">\n    //     <field name=\"NAME\">do something</field>\n    // </block>\n    const block = utilsXml.createElement('block');\n    block.setAttribute('type', 'procedures_defnoreturn');\n    block.setAttribute('gap', '16');\n    const nameField = utilsXml.createElement('field');\n    nameField.setAttribute('name', 'NAME');\n    nameField.appendChild(\n      utilsXml.createTextNode(Msg['PROCEDURES_DEFNORETURN_PROCEDURE']),\n    );\n    block.appendChild(nameField);\n    xmlList.push(block);\n  }\n  if (Blocks['procedures_defreturn']) {\n    // <block type=\"procedures_defreturn\" gap=\"16\">\n    //     <field name=\"NAME\">do something</field>\n    // </block>\n    const block = utilsXml.createElement('block');\n    block.setAttribute('type', 'procedures_defreturn');\n    block.setAttribute('gap', '16');\n    const nameField = utilsXml.createElement('field');\n    nameField.setAttribute('name', 'NAME');\n    nameField.appendChild(\n      utilsXml.createTextNode(Msg['PROCEDURES_DEFRETURN_PROCEDURE']),\n    );\n    block.appendChild(nameField);\n    xmlList.push(block);\n  }\n  if (Blocks['procedures_ifreturn']) {\n    // <block type=\"procedures_ifreturn\" gap=\"16\"></block>\n    const block = utilsXml.createElement('block');\n    block.setAttribute('type', 'procedures_ifreturn');\n    block.setAttribute('gap', '16');\n    xmlList.push(block);\n  }\n  if (xmlList.length) {\n    // Add slightly larger gap between system blocks and user calls.\n    xmlList[xmlList.length - 1].setAttribute('gap', '24');\n  }\n\n  /**\n   * Add items to xmlList for each listed procedure.\n   *\n   * @param procedureList A list of procedures, each of which is defined by a\n   *     three-element list of name, parameter list, and return value boolean.\n   * @param templateName The type of the block to generate.\n   */\n  function populateProcedures(\n    procedureList: ProcedureTuple[],\n    templateName: string,\n  ) {\n    for (let i = 0; i < procedureList.length; i++) {\n      const name = procedureList[i][0];\n      const args = procedureList[i][1];\n      // <block type=\"procedures_callnoreturn\" gap=\"16\">\n      //   <mutation name=\"do something\">\n      //     <arg name=\"x\"></arg>\n      //   </mutation>\n      // </block>\n      const block = utilsXml.createElement('block');\n      block.setAttribute('type', templateName);\n      block.setAttribute('gap', '16');\n      const mutation = utilsXml.createElement('mutation');\n      mutation.setAttribute('name', name);\n      block.appendChild(mutation);\n      for (let j = 0; j < args.length; j++) {\n        const arg = utilsXml.createElement('arg');\n        arg.setAttribute('name', args[j]);\n        mutation.appendChild(arg);\n      }\n      xmlList.push(block);\n    }\n  }\n\n  const tuple = allProcedures(workspace);\n  populateProcedures(tuple[0], 'procedures_callnoreturn');\n  populateProcedures(tuple[1], 'procedures_callreturn');\n  return xmlList;\n}\n\n/**\n * Updates the procedure mutator's flyout so that the arg block is not a\n * duplicate of another arg.\n *\n * @param workspace The procedure mutator's workspace. This workspace's flyout\n *     is what is being updated.\n */\nfunction updateMutatorFlyout(workspace: WorkspaceSvg) {\n  const usedNames = [];\n  const blocks = workspace.getBlocksByType('procedures_mutatorarg', false);\n  for (let i = 0, block; (block = blocks[i]); i++) {\n    usedNames.push(block.getFieldValue('NAME'));\n  }\n\n  const xmlElement = utilsXml.createElement('xml');\n  const argBlock = utilsXml.createElement('block');\n  argBlock.setAttribute('type', 'procedures_mutatorarg');\n  const nameField = utilsXml.createElement('field');\n  nameField.setAttribute('name', 'NAME');\n  const argValue = Variables.generateUniqueNameFromOptions(\n    DEFAULT_ARG,\n    usedNames,\n  );\n  const fieldContent = utilsXml.createTextNode(argValue);\n\n  nameField.appendChild(fieldContent);\n  argBlock.appendChild(nameField);\n  xmlElement.appendChild(argBlock);\n\n  workspace.updateToolbox(xmlElement);\n}\n\n/**\n * Listens for when a procedure mutator is opened. Then it triggers a flyout\n * update and adds a mutator change listener to the mutator workspace.\n *\n * @param e The event that triggered this listener.\n * @internal\n */\nexport function mutatorOpenListener(e: Abstract) {\n  if (e.type !== eventUtils.BUBBLE_OPEN) {\n    return;\n  }\n  const bubbleEvent = e as BubbleOpen;\n  if (\n    !(bubbleEvent.bubbleType === 'mutator' && bubbleEvent.isOpen) ||\n    !bubbleEvent.blockId\n  ) {\n    return;\n  }\n  const workspaceId = bubbleEvent.workspaceId;\n  const block = common\n    .getWorkspaceById(workspaceId)!\n    .getBlockById(bubbleEvent.blockId) as BlockSvg;\n  const type = block.type;\n  if (type !== 'procedures_defnoreturn' && type !== 'procedures_defreturn') {\n    return;\n  }\n  const workspace = (\n    block.getIcon(MutatorIcon.TYPE) as MutatorIcon\n  ).getWorkspace()!;\n  updateMutatorFlyout(workspace);\n  workspace.addChangeListener(mutatorChangeListener);\n}\n/**\n * Listens for changes in a procedure mutator and triggers flyout updates when\n * necessary.\n *\n * @param e The event that triggered this listener.\n */\nfunction mutatorChangeListener(e: Abstract) {\n  if (\n    e.type !== eventUtils.BLOCK_CREATE &&\n    e.type !== eventUtils.BLOCK_DELETE &&\n    e.type !== eventUtils.BLOCK_CHANGE &&\n    e.type !== eventUtils.BLOCK_FIELD_INTERMEDIATE_CHANGE\n  ) {\n    return;\n  }\n  const workspaceId = e.workspaceId as string;\n  const workspace = common.getWorkspaceById(workspaceId) as WorkspaceSvg;\n  updateMutatorFlyout(workspace);\n}\n\n/**\n * Find all the callers of a named procedure.\n *\n * @param name Name of procedure.\n * @param workspace The workspace to find callers in.\n * @returns Array of caller blocks.\n */\nexport function getCallers(name: string, workspace: Workspace): Block[] {\n  return workspace.getAllBlocks(false).filter((block) => {\n    return (\n      blockIsModernCallerFor(block, name) ||\n      (isLegacyProcedureCallBlock(block) &&\n        Names.equals(block.getProcedureCall(), name))\n    );\n  });\n}\n\n/**\n * @returns True if the given block is a modern-style caller block of the given\n *     procedure name.\n */\nfunction blockIsModernCallerFor(block: Block, procName: string): boolean {\n  return (\n    isProcedureBlock(block) &&\n    !block.isProcedureDef() &&\n    block.getProcedureModel() &&\n    Names.equals(block.getProcedureModel().getName(), procName)\n  );\n}\n\n/**\n * When a procedure definition changes its parameters, find and edit all its\n * callers.\n *\n * @param defBlock Procedure definition block.\n */\nexport function mutateCallers(defBlock: Block) {\n  const oldRecordUndo = eventUtils.getRecordUndo();\n  const procedureBlock = defBlock as unknown as ProcedureBlock;\n  const name = procedureBlock.getProcedureDef()[0];\n  const xmlElement = defBlock.mutationToDom!(true);\n  const callers = getCallers(name, defBlock.workspace);\n  for (let i = 0, caller; (caller = callers[i]); i++) {\n    const oldMutationDom = caller.mutationToDom!();\n    const oldMutation = oldMutationDom && utilsXml.domToText(oldMutationDom);\n    if (caller.domToMutation) {\n      caller.domToMutation(xmlElement);\n    }\n    const newMutationDom = caller.mutationToDom!();\n    const newMutation = newMutationDom && utilsXml.domToText(newMutationDom);\n    if (oldMutation !== newMutation) {\n      // Fire a mutation on every caller block.  But don't record this as an\n      // undo action since it is deterministically tied to the procedure's\n      // definition mutation.\n      eventUtils.setRecordUndo(false);\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          caller,\n          'mutation',\n          null,\n          oldMutation,\n          newMutation,\n        ),\n      );\n      eventUtils.setRecordUndo(oldRecordUndo);\n    }\n  }\n}\n\n/**\n * Find the definition block for the named procedure.\n *\n * @param name Name of procedure.\n * @param workspace The workspace to search.\n * @returns The procedure definition block, or null not found.\n */\nexport function getDefinition(\n  name: string,\n  workspace: Workspace,\n): Block | null {\n  // Do not assume procedure is a top block. Some languages allow nested\n  // procedures. Also do not assume it is one of the built-in blocks. Only\n  // rely on isProcedureDef and getProcedureDef.\n  for (const block of workspace.getAllBlocks(false)) {\n    if (\n      isProcedureBlock(block) &&\n      block.isProcedureDef() &&\n      Names.equals(block.getProcedureModel().getName(), name)\n    ) {\n      return block;\n    }\n    if (\n      isLegacyProcedureDefBlock(block) &&\n      Names.equals(block.getProcedureDef()[0], name)\n    ) {\n      return block;\n    }\n  }\n  return null;\n}\n\nexport {\n  ObservableProcedureMap,\n  IParameterModel,\n  IProcedureBlock,\n  isProcedureBlock,\n  IProcedureMap,\n  IProcedureModel,\n  ProcedureTuple,\n};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.ConstantProvider\n\nimport {ConnectionType} from '../../connection_type.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {BlockStyle, Theme} from '../../theme.js';\nimport * as colour from '../../utils/colour.js';\nimport * as dom from '../../utils/dom.js';\nimport * as parsing from '../../utils/parsing.js';\nimport {Svg} from '../../utils/svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\n\n/** An object containing sizing and path information about outside corners. */\nexport interface OutsideCorners {\n  topLeft: string;\n  topRight: string;\n  bottomRight: string;\n  bottomLeft: string;\n  rightHeight: number;\n}\n\n/** An object containing sizing and path information about inside corners. */\nexport interface InsideCorners {\n  width: number;\n  height: number;\n  pathTop: string;\n  pathBottom: string;\n}\n\n/** An object containing sizing and path information about a start hat. */\nexport interface StartHat {\n  height: number;\n  width: number;\n  path: string;\n}\n\n/** An object containing sizing and path information about a notch. */\nexport interface Notch {\n  type: number;\n  width: number;\n  height: number;\n  pathLeft: string;\n  pathRight: string;\n}\n\n/** An object containing sizing and path information about a puzzle tab. */\nexport interface PuzzleTab {\n  type: number;\n  width: number;\n  height: number;\n  pathDown: string;\n  pathUp: string;\n}\n\n/**\n * An object containing sizing and path information about collapsed block\n * indicators.\n */\nexport interface JaggedTeeth {\n  height: number;\n  width: number;\n  path: string;\n}\n\nexport type BaseShape = {\n  type: number;\n  width: number;\n  height: number;\n};\n\n/** An object containing sizing and type information about a dynamic shape. */\nexport type DynamicShape = {\n  type: number;\n  width: (p1: number) => number;\n  height: (p1: number) => number;\n  isDynamic: true;\n  connectionOffsetY: (p1: number) => number;\n  connectionOffsetX: (p1: number) => number;\n  pathDown: (p1: number) => string;\n  pathUp: (p1: number) => string;\n  pathRightDown: (p1: number) => string;\n  pathRightUp: (p1: number) => string;\n};\n\n/** An object containing sizing and type information about a shape. */\nexport type Shape = BaseShape | DynamicShape;\n\n/**\n * Returns whether the shape is dynamic or not.\n *\n * @param shape The shape to check for dynamic-ness.\n * @returns Whether the shape is a dynamic shape or not.\n */\nexport function isDynamicShape(shape: Shape): shape is DynamicShape {\n  return (shape as DynamicShape).isDynamic;\n}\n\n/** Returns whether the shape is a puzzle tab or not. */\nexport function isPuzzleTab(shape: Shape): shape is PuzzleTab {\n  return (\n    (shape as PuzzleTab).pathDown !== undefined &&\n    (shape as PuzzleTab).pathUp !== undefined\n  );\n}\n\n/** Returns whether the shape is a notch or not. */\nexport function isNotch(shape: Shape): shape is Notch {\n  return (\n    (shape as Notch).pathLeft !== undefined &&\n    (shape as Notch).pathRight !== undefined\n  );\n}\n\n/**\n * An object that provides constants for rendering blocks.\n */\nexport class ConstantProvider {\n  /** The size of an empty spacer. */\n  NO_PADDING = 0;\n\n  /** The size of small padding. */\n  SMALL_PADDING = 3;\n\n  /** The size of medium padding. */\n  MEDIUM_PADDING = 5;\n\n  /** The size of medium-large padding. */\n  MEDIUM_LARGE_PADDING = 8;\n\n  /** The size of large padding. */\n  LARGE_PADDING = 10;\n  TALL_INPUT_FIELD_OFFSET_Y: number;\n\n  /** The height of the puzzle tab used for input and output connections. */\n  TAB_HEIGHT = 15;\n\n  /**\n   * The offset from the top of the block at which a puzzle tab is positioned.\n   */\n  TAB_OFFSET_FROM_TOP = 5;\n\n  /**\n   * Vertical overlap of the puzzle tab, used to make it look more like a\n   * puzzle piece.\n   */\n  TAB_VERTICAL_OVERLAP = 2.5;\n\n  /** The width of the puzzle tab used for input and output connections. */\n  TAB_WIDTH = 8;\n\n  /** The width of the notch used for previous and next connections. */\n  NOTCH_WIDTH = 15;\n\n  /** The height of the notch used for previous and next connections. */\n  NOTCH_HEIGHT = 4;\n\n  /** The minimum width of the block. */\n  MIN_BLOCK_WIDTH = 12;\n  EMPTY_BLOCK_SPACER_HEIGHT = 16;\n  DUMMY_INPUT_MIN_HEIGHT: number;\n  DUMMY_INPUT_SHADOW_MIN_HEIGHT: number;\n\n  /** Rounded corner radius. */\n  CORNER_RADIUS = 8;\n\n  /**\n   * Offset from the left side of a block or the inside of a statement input\n   * to the left side of the notch.\n   */\n  NOTCH_OFFSET_LEFT = 15;\n  STATEMENT_INPUT_NOTCH_OFFSET: number;\n\n  STATEMENT_BOTTOM_SPACER = 0;\n  STATEMENT_INPUT_PADDING_LEFT = 20;\n\n  /** Vertical padding between consecutive statement inputs. */\n  BETWEEN_STATEMENT_PADDING_Y = 4;\n  TOP_ROW_MIN_HEIGHT: number;\n  TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT: number;\n  BOTTOM_ROW_MIN_HEIGHT: number;\n  BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT: number;\n\n  /**\n   * Whether to add a 'hat' on top of all blocks with no previous or output\n   * connections. Can be overridden by 'hat' property on Theme.BlockStyle.\n   */\n  ADD_START_HATS = false;\n\n  /** Height of the top hat. */\n  START_HAT_HEIGHT = 15;\n\n  /** Width of the top hat. */\n  START_HAT_WIDTH = 100;\n\n  SPACER_DEFAULT_HEIGHT = 15;\n\n  MIN_BLOCK_HEIGHT = 24;\n\n  EMPTY_INLINE_INPUT_PADDING = 14.5;\n  EMPTY_INLINE_INPUT_HEIGHT: number;\n\n  EXTERNAL_VALUE_INPUT_PADDING = 2;\n  EMPTY_STATEMENT_INPUT_HEIGHT: number;\n  START_POINT: string;\n\n  /** Height of SVG path for jagged teeth at the end of collapsed blocks. */\n  JAGGED_TEETH_HEIGHT = 12;\n\n  /** Width of SVG path for jagged teeth at the end of collapsed blocks. */\n  JAGGED_TEETH_WIDTH = 6;\n\n  /** Point size of text. */\n  FIELD_TEXT_FONTSIZE = 11;\n\n  /** Text font weight. */\n  FIELD_TEXT_FONTWEIGHT = 'normal';\n\n  /** Text font family. */\n  FIELD_TEXT_FONTFAMILY = 'sans-serif';\n\n  /**\n   * Height of text.  This constant is dynamically set in\n   * `setFontConstants_` to be the height of the text based on the font\n   * used.\n   */\n  FIELD_TEXT_HEIGHT = -1; // Dynamically set.\n\n  /**\n   * Text baseline.  This constant is dynamically set in `setFontConstants_`\n   * to be the baseline of the text based on the font used.\n   */\n  FIELD_TEXT_BASELINE = -1; // Dynamically set.\n\n  /** A field's border rect corner radius. */\n  FIELD_BORDER_RECT_RADIUS = 4;\n\n  /** A field's border rect default height. */\n  FIELD_BORDER_RECT_HEIGHT = 16;\n\n  /** A field's border rect X padding. */\n  FIELD_BORDER_RECT_X_PADDING = 5;\n\n  /** A field's border rect Y padding. */\n  FIELD_BORDER_RECT_Y_PADDING = 3;\n\n  /**\n   * The backing colour of a field's border rect.\n   */\n  FIELD_BORDER_RECT_COLOUR = '#fff';\n  FIELD_TEXT_BASELINE_CENTER: boolean;\n  FIELD_DROPDOWN_BORDER_RECT_HEIGHT: number;\n\n  /**\n   * Whether or not a dropdown field should add a border rect when in a shadow\n   * block.\n   */\n  FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW = false;\n\n  /**\n   * Whether or not a dropdown field's div should be coloured to match the\n   * block colours.\n   */\n  FIELD_DROPDOWN_COLOURED_DIV = false;\n\n  /** Whether or not a dropdown field uses a text or SVG arrow. */\n  FIELD_DROPDOWN_SVG_ARROW = false;\n  FIELD_DROPDOWN_SVG_ARROW_PADDING: number;\n\n  /** A dropdown field's SVG arrow size. */\n  FIELD_DROPDOWN_SVG_ARROW_SIZE = 12;\n  FIELD_DROPDOWN_SVG_ARROW_DATAURI: string;\n\n  /**\n   * Whether or not to show a box shadow around the widget div. This is only a\n   * feature of full block fields.\n   */\n  FIELD_TEXTINPUT_BOX_SHADOW = false;\n\n  /**\n   * Whether or not the colour field should display its colour value on the\n   * entire block.\n   */\n  FIELD_COLOUR_FULL_BLOCK = false;\n\n  /** A colour field's default width. */\n  FIELD_COLOUR_DEFAULT_WIDTH = 26;\n  FIELD_COLOUR_DEFAULT_HEIGHT: number;\n  FIELD_CHECKBOX_X_OFFSET: number;\n  randomIdentifier: string;\n\n  /**\n   * The defs tag that contains all filters and patterns for this Blockly\n   * instance.\n   */\n  private defs: SVGElement | null = null;\n\n  /**\n   * The ID of the emboss filter, or the empty string if no filter is set.\n   */\n  embossFilterId = '';\n\n  /** The <filter> element to use for highlighting, or null if not set. */\n  private embossFilter: SVGElement | null = null;\n\n  /**\n   * The ID of the disabled pattern, or the empty string if no pattern is set.\n   */\n  disabledPatternId = '';\n\n  /**\n   * The <pattern> element to use for disabled blocks, or null if not set.\n   */\n  private disabledPattern: SVGElement | null = null;\n\n  /**\n   * The ID of the debug filter, or the empty string if no pattern is set.\n   */\n  debugFilterId = '';\n\n  /**\n   * The <filter> element to use for a debug highlight, or null if not set.\n   */\n  private debugFilter: SVGElement | null = null;\n\n  /** The <style> element to use for injecting renderer specific CSS. */\n  private cssNode: HTMLStyleElement | null = null;\n\n  /**\n   * Cursor colour.\n   */\n  CURSOR_COLOUR = '#cc0a0a';\n\n  /**\n   * Immovable marker colour.\n   */\n  MARKER_COLOUR = '#4286f4';\n\n  /**\n   * Width of the horizontal cursor.\n   */\n  CURSOR_WS_WIDTH = 100;\n\n  /**\n   * Height of the horizontal cursor.\n   */\n  WS_CURSOR_HEIGHT = 5;\n\n  /**\n   * Padding around a stack.\n   */\n  CURSOR_STACK_PADDING = 10;\n\n  /**\n   * Padding around a block.\n   */\n  CURSOR_BLOCK_PADDING = 2;\n\n  /**\n   * Stroke of the cursor.\n   */\n  CURSOR_STROKE_WIDTH = 4;\n\n  /**\n   * Whether text input and colour fields fill up the entire source block.\n   */\n  FULL_BLOCK_FIELDS = false;\n\n  /**\n   * The main colour of insertion markers, in hex.  The block is rendered a\n   * transparent grey by changing the fill opacity in CSS.\n   */\n  INSERTION_MARKER_COLOUR = '#000000';\n\n  /**\n   * The insertion marker opacity.\n   */\n  INSERTION_MARKER_OPACITY = 0.2;\n\n  SHAPES: {[key: string]: number} = {PUZZLE: 1, NOTCH: 2};\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  JAGGED_TEETH!: JaggedTeeth;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  NOTCH!: Notch;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  START_HAT!: StartHat;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  PUZZLE_TAB!: PuzzleTab;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  INSIDE_CORNERS!: InsideCorners;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  OUTSIDE_CORNERS!: OutsideCorners;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n\n  blockStyles!: {[key: string]: BlockStyle};\n\n  constructor() {\n    /**\n     * Offset from the top of the row for placing fields on inline input rows\n     * and statement input rows.\n     * Matches existing rendering (in 2019).\n     */\n    this.TALL_INPUT_FIELD_OFFSET_Y = this.MEDIUM_PADDING;\n\n    /** The minimum height of a dummy input row. */\n    this.DUMMY_INPUT_MIN_HEIGHT = this.TAB_HEIGHT;\n\n    /** The minimum height of a dummy input row in a shadow block. */\n    this.DUMMY_INPUT_SHADOW_MIN_HEIGHT = this.TAB_HEIGHT;\n\n    /**\n     * Additional offset added to the statement input's width to account for the\n     * notch.\n     */\n    this.STATEMENT_INPUT_NOTCH_OFFSET = this.NOTCH_OFFSET_LEFT;\n\n    /** The top row's minimum height. */\n    this.TOP_ROW_MIN_HEIGHT = this.MEDIUM_PADDING;\n\n    /** The top row's minimum height if it precedes a statement. */\n    this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT = this.LARGE_PADDING;\n\n    /** The bottom row's minimum height. */\n    this.BOTTOM_ROW_MIN_HEIGHT = this.MEDIUM_PADDING;\n\n    /** The bottom row's minimum height if it follows a statement input. */\n    this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT = this.LARGE_PADDING;\n\n    /** The height of an empty inline input. */\n    this.EMPTY_INLINE_INPUT_HEIGHT = this.TAB_HEIGHT + 11;\n\n    /**\n     * The height of an empty statement input.  Note that in the old rendering\n     * this varies slightly depending on whether the block has external or\n     * inline inputs. In the new rendering this is consistent.  It seems\n     * unlikely that the old behaviour was intentional.\n     */\n    this.EMPTY_STATEMENT_INPUT_HEIGHT = this.MIN_BLOCK_HEIGHT;\n\n    this.START_POINT = svgPaths.moveBy(0, 0);\n\n    /**\n     * A field's text element's dominant baseline. Pre-2022 this could be false\n     * for certain browsers.\n     */\n    this.FIELD_TEXT_BASELINE_CENTER = true;\n\n    /** A dropdown field's border rect height. */\n    this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT = this.FIELD_BORDER_RECT_HEIGHT;\n\n    /** A dropdown field's SVG arrow padding. */\n    this.FIELD_DROPDOWN_SVG_ARROW_PADDING = this.FIELD_BORDER_RECT_X_PADDING;\n\n    /** A dropdown field's SVG arrow datauri. */\n    this.FIELD_DROPDOWN_SVG_ARROW_DATAURI =\n      'data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllci' +\n      'AxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaG' +\n      'VpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLW' +\n      'Fycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuND' +\n      'EsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTD' +\n      'AuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNz' +\n      'FDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMC' +\n      'wxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNz' +\n      'lhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYz' +\n      'AuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMz' +\n      'dBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=';\n\n    /** A colour field's default height. */\n    this.FIELD_COLOUR_DEFAULT_HEIGHT = this.FIELD_BORDER_RECT_HEIGHT;\n\n    /** A checkbox field's X offset. */\n    this.FIELD_CHECKBOX_X_OFFSET = this.FIELD_BORDER_RECT_X_PADDING - 3;\n\n    /**\n     * A random identifier used to ensure a unique ID is used for each\n     * filter/pattern for the case of multiple Blockly instances on a page.\n     */\n    this.randomIdentifier = String(Math.random()).substring(2);\n  }\n\n  /**\n   * Initialize shape objects based on the constants set in the constructor.\n   */\n  init() {\n    /**\n     * An object containing sizing and path information about collapsed block\n     * indicators.\n     */\n    this.JAGGED_TEETH = this.makeJaggedTeeth();\n\n    /** An object containing sizing and path information about notches. */\n    this.NOTCH = this.makeNotch();\n\n    /** An object containing sizing and path information about start hats */\n    this.START_HAT = this.makeStartHat();\n\n    /**\n     * An object containing sizing and path information about puzzle tabs.\n     */\n    this.PUZZLE_TAB = this.makePuzzleTab();\n\n    /**\n     * An object containing sizing and path information about inside corners\n     */\n    this.INSIDE_CORNERS = this.makeInsideCorners();\n\n    /**\n     * An object containing sizing and path information about outside corners.\n     */\n    this.OUTSIDE_CORNERS = this.makeOutsideCorners();\n  }\n\n  /**\n   * Refresh constants properties that depend on the theme.\n   *\n   * @param theme The current workspace theme.\n   */\n  setTheme(theme: Theme) {\n    /** The block styles map. */\n    this.blockStyles = Object.create(null);\n\n    const blockStyles = theme.blockStyles;\n    for (const key in blockStyles) {\n      this.blockStyles[key] = this.validatedBlockStyle_(blockStyles[key]);\n    }\n\n    this.setDynamicProperties_(theme);\n  }\n\n  /**\n   * Sets dynamic properties that depend on other values or theme properties.\n   *\n   * @param theme The current workspace theme.\n   */\n  protected setDynamicProperties_(theme: Theme) {\n    this.setFontConstants_(theme);\n    this.setComponentConstants_(theme);\n\n    this.ADD_START_HATS =\n      theme.startHats !== undefined ? theme.startHats : this.ADD_START_HATS;\n  }\n\n  /**\n   * Set constants related to fonts.\n   *\n   * @param theme The current workspace theme.\n   */\n  protected setFontConstants_(theme: Theme) {\n    if (theme.fontStyle && theme.fontStyle['family']) {\n      this.FIELD_TEXT_FONTFAMILY = theme.fontStyle['family'];\n    }\n\n    if (theme.fontStyle && theme.fontStyle['weight']) {\n      this.FIELD_TEXT_FONTWEIGHT = theme.fontStyle['weight'];\n    }\n\n    if (theme.fontStyle && theme.fontStyle['size']) {\n      this.FIELD_TEXT_FONTSIZE = theme.fontStyle['size'];\n    }\n\n    const fontMetrics = dom.measureFontMetrics(\n      'Hg',\n      this.FIELD_TEXT_FONTSIZE + 'pt',\n      this.FIELD_TEXT_FONTWEIGHT,\n      this.FIELD_TEXT_FONTFAMILY,\n    );\n\n    this.FIELD_TEXT_HEIGHT = fontMetrics.height;\n    this.FIELD_TEXT_BASELINE = fontMetrics.baseline;\n  }\n\n  /**\n   * Set constants from a theme's component styles.\n   *\n   * @param theme The current workspace theme.\n   */\n  protected setComponentConstants_(theme: Theme) {\n    this.CURSOR_COLOUR =\n      theme.getComponentStyle('cursorColour') || this.CURSOR_COLOUR;\n    this.MARKER_COLOUR =\n      theme.getComponentStyle('markerColour') || this.MARKER_COLOUR;\n    this.INSERTION_MARKER_COLOUR =\n      theme.getComponentStyle('insertionMarkerColour') ||\n      this.INSERTION_MARKER_COLOUR;\n    this.INSERTION_MARKER_OPACITY =\n      Number(theme.getComponentStyle('insertionMarkerOpacity')) ||\n      this.INSERTION_MARKER_OPACITY;\n  }\n\n  /**\n   * Get or create a block style based on a single colour value.  Generate a\n   * name for the style based on the colour.\n   *\n   * @param colour #RRGGBB colour string.\n   * @returns An object containing the style and an autogenerated name for that\n   *     style.\n   */\n  getBlockStyleForColour(colour: string): {style: BlockStyle; name: string} {\n    const name = 'auto_' + colour;\n    if (!this.blockStyles[name]) {\n      this.blockStyles[name] = this.createBlockStyle_(colour);\n    }\n    return {style: this.blockStyles[name], name};\n  }\n\n  /**\n   * Gets the BlockStyle for the given block style name.\n   *\n   * @param blockStyleName The name of the block style.\n   * @returns The named block style, or a default style if no style with the\n   *     given name was found.\n   */\n  getBlockStyle(blockStyleName: string | null): BlockStyle {\n    return (\n      this.blockStyles[blockStyleName || ''] ||\n      (blockStyleName && blockStyleName.startsWith('auto_')\n        ? this.getBlockStyleForColour(blockStyleName.substring(5)).style\n        : this.createBlockStyle_('#000000'))\n    );\n  }\n\n  /**\n   * Create a block style object based on the given colour.\n   *\n   * @param colour #RRGGBB colour string.\n   * @returns A populated block style based on the given colour.\n   */\n  protected createBlockStyle_(colour: string): BlockStyle {\n    return this.validatedBlockStyle_({'colourPrimary': colour});\n  }\n\n  /**\n   * Get a full block style object based on the input style object.  Populate\n   * any missing values.\n   *\n   * @param blockStyle A full or partial block style object.\n   * @returns A full block style object, with all required properties populated.\n   */\n  protected validatedBlockStyle_(blockStyle: Partial<BlockStyle>): BlockStyle {\n    // Make a new object with all of the same properties.\n    const valid = {} as BlockStyle;\n    if (blockStyle) {\n      Object.assign(valid, blockStyle);\n    }\n    // Validate required properties.\n    const parsedColour = parsing.parseBlockColour(\n      valid['colourPrimary'] || '#000',\n    );\n    valid.colourPrimary = parsedColour.hex;\n    valid.colourSecondary = valid['colourSecondary']\n      ? parsing.parseBlockColour(valid['colourSecondary']).hex\n      : this.generateSecondaryColour_(valid.colourPrimary);\n    valid.colourTertiary = valid['colourTertiary']\n      ? parsing.parseBlockColour(valid['colourTertiary']).hex\n      : this.generateTertiaryColour_(valid.colourPrimary);\n\n    valid.hat = valid['hat'] || '';\n    return valid;\n  }\n\n  /**\n   * Generate a secondary colour from the passed in primary colour.\n   *\n   * @param inputColour Primary colour.\n   * @returns The generated secondary colour.\n   */\n  protected generateSecondaryColour_(inputColour: string): string {\n    return colour.blend('#fff', inputColour, 0.6) || inputColour;\n  }\n\n  /**\n   * Generate a tertiary colour from the passed in primary colour.\n   *\n   * @param inputColour Primary colour.\n   * @returns The generated tertiary colour.\n   */\n  protected generateTertiaryColour_(inputColour: string): string {\n    return colour.blend('#fff', inputColour, 0.3) || inputColour;\n  }\n\n  /**\n   * Dispose of this constants provider.\n   * Delete all DOM elements that this provider created.\n   */\n  dispose() {\n    if (this.embossFilter) {\n      dom.removeNode(this.embossFilter);\n    }\n    if (this.disabledPattern) {\n      dom.removeNode(this.disabledPattern);\n    }\n    if (this.debugFilter) {\n      dom.removeNode(this.debugFilter);\n    }\n    this.cssNode = null;\n  }\n\n  /**\n   * @returns An object containing sizing and path information about collapsed\n   *     block indicators.\n   */\n  protected makeJaggedTeeth(): JaggedTeeth {\n    const height = this.JAGGED_TEETH_HEIGHT;\n    const width = this.JAGGED_TEETH_WIDTH;\n\n    const mainPath = svgPaths.line([\n      svgPaths.point(width, height / 4),\n      svgPaths.point(-width * 2, height / 2),\n      svgPaths.point(width, height / 4),\n    ]);\n    return {height, width, path: mainPath};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about start hats.\n   */\n  protected makeStartHat(): StartHat {\n    const height = this.START_HAT_HEIGHT;\n    const width = this.START_HAT_WIDTH;\n\n    const mainPath = svgPaths.curve('c', [\n      svgPaths.point(30, -height),\n      svgPaths.point(70, -height),\n      svgPaths.point(width, 0),\n    ]);\n    return {height, width, path: mainPath};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about puzzle\n   *     tabs.\n   */\n  protected makePuzzleTab(): PuzzleTab {\n    const width = this.TAB_WIDTH;\n    const height = this.TAB_HEIGHT;\n\n    /**\n     * Make the main path for the puzzle tab made out of a few curves (c and s).\n     * Those curves are defined with relative positions.  The 'up' and 'down'\n     * versions of the paths are the same, but the Y sign flips.  Forward and\n     * back are the signs to use to move the cursor in the direction that the\n     * path is being drawn.\n     *\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @returns A path fragment describing a puzzle tab.\n     */\n    function makeMainPath(up: boolean): string {\n      const forward = up ? -1 : 1;\n      const back = -forward;\n\n      const overlap = 2.5;\n      const halfHeight = height / 2;\n      const control1Y = halfHeight + overlap;\n      const control2Y = halfHeight + 0.5;\n      const control3Y = overlap; // 2.5\n\n      const endPoint1 = svgPaths.point(-width, forward * halfHeight);\n      const endPoint2 = svgPaths.point(width, forward * halfHeight);\n\n      return (\n        svgPaths.curve('c', [\n          svgPaths.point(0, forward * control1Y),\n          svgPaths.point(-width, back * control2Y),\n          endPoint1,\n        ]) +\n        svgPaths.curve('s', [\n          svgPaths.point(width, back * control3Y),\n          endPoint2,\n        ])\n      );\n    }\n\n    // c 0,-10  -8,8  -8,-7.5  s 8,2.5  8,-7.5\n    const pathUp = makeMainPath(true);\n    // c 0,10  -8,-8  -8,7.5  s 8,-2.5  8,7.5\n    const pathDown = makeMainPath(false);\n\n    return {\n      type: this.SHAPES.PUZZLE,\n      width,\n      height,\n      pathDown,\n      pathUp,\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about notches.\n   */\n  protected makeNotch(): Notch {\n    const width = this.NOTCH_WIDTH;\n    const height = this.NOTCH_HEIGHT;\n    const innerWidth = 3;\n    const outerWidth = (width - innerWidth) / 2;\n\n    /**\n     * Make the main path for the notch.\n     *\n     * @param dir Direction multiplier to apply to horizontal offsets along the\n     *     path. Either 1 or -1.\n     * @returns A path fragment describing a notch.\n     */\n    function makeMainPath(dir: number): string {\n      return svgPaths.line([\n        svgPaths.point(dir * outerWidth, height),\n        svgPaths.point(dir * innerWidth, 0),\n        svgPaths.point(dir * outerWidth, -height),\n      ]);\n    }\n    const pathLeft = makeMainPath(1);\n    const pathRight = makeMainPath(-1);\n\n    return {\n      type: this.SHAPES.NOTCH,\n      width,\n      height,\n      pathLeft,\n      pathRight,\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about inside\n   *     corners.\n   */\n  protected makeInsideCorners(): InsideCorners {\n    const radius = this.CORNER_RADIUS;\n\n    const innerTopLeftCorner = svgPaths.arc(\n      'a',\n      '0 0,0',\n      radius,\n      svgPaths.point(-radius, radius),\n    );\n\n    const innerBottomLeftCorner = svgPaths.arc(\n      'a',\n      '0 0,0',\n      radius,\n      svgPaths.point(radius, radius),\n    );\n\n    return {\n      width: radius,\n      height: radius,\n      pathTop: innerTopLeftCorner,\n      pathBottom: innerBottomLeftCorner,\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about outside\n   *     corners.\n   */\n  protected makeOutsideCorners(): OutsideCorners {\n    const radius = this.CORNER_RADIUS;\n    /** SVG path for drawing the rounded top-left corner. */\n    const topLeft =\n      svgPaths.moveBy(0, radius) +\n      svgPaths.arc('a', '0 0,1', radius, svgPaths.point(radius, -radius));\n\n    /** SVG path for drawing the rounded top-right corner. */\n    const topRight = svgPaths.arc(\n      'a',\n      '0 0,1',\n      radius,\n      svgPaths.point(radius, radius),\n    );\n\n    /** SVG path for drawing the rounded bottom-left corner. */\n    const bottomLeft = svgPaths.arc(\n      'a',\n      '0 0,1',\n      radius,\n      svgPaths.point(-radius, -radius),\n    );\n\n    /** SVG path for drawing the rounded bottom-right corner. */\n    const bottomRight = svgPaths.arc(\n      'a',\n      '0 0,1',\n      radius,\n      svgPaths.point(-radius, radius),\n    );\n\n    return {\n      topLeft,\n      topRight,\n      bottomRight,\n      bottomLeft,\n      rightHeight: radius,\n    };\n  }\n\n  /**\n   * Get an object with connection shape and sizing information based on the\n   * type of the connection.\n   *\n   * @param connection The connection to find a shape object for\n   * @returns The shape object for the connection.\n   */\n  shapeFor(connection: RenderedConnection): Shape {\n    switch (connection.type) {\n      case ConnectionType.INPUT_VALUE:\n      case ConnectionType.OUTPUT_VALUE:\n        return this.PUZZLE_TAB;\n      case ConnectionType.PREVIOUS_STATEMENT:\n      case ConnectionType.NEXT_STATEMENT:\n        return this.NOTCH;\n      default:\n        throw Error('Unknown connection type');\n    }\n  }\n\n  /**\n   * Create any DOM elements that this renderer needs (filters, patterns, etc).\n   *\n   * @param svg The root of the workspace's SVG.\n   * @param tagName The name to use for the CSS style tag.\n   * @param selector The CSS selector to use.\n   */\n  createDom(svg: SVGElement, tagName: string, selector: string) {\n    this.injectCSS_(tagName, selector);\n\n    /*\n        <defs>\n          ... filters go here ...\n        </defs>\n        */\n    this.defs = dom.createSvgElement(Svg.DEFS, {}, svg);\n    /*\n          <filter id=\"blocklyEmbossFilter837493\">\n            <feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"1\" result=\"blur\" />\n            <feSpecularLighting in=\"blur\" surfaceScale=\"1\"\n       specularConstant=\"0.5\" specularExponent=\"10\" lighting-color=\"white\"\n                                result=\"specOut\">\n              <fePointLight x=\"-5000\" y=\"-10000\" z=\"20000\" />\n            </feSpecularLighting>\n            <feComposite in=\"specOut\" in2=\"SourceAlpha\" operator=\"in\"\n                         result=\"specOut\" />\n            <feComposite in=\"SourceGraphic\" in2=\"specOut\" operator=\"arithmetic\"\n                         k1=\"0\" k2=\"1\" k3=\"1\" k4=\"0\" />\n          </filter>\n        */\n    const embossFilter = dom.createSvgElement(\n      Svg.FILTER,\n      {'id': 'blocklyEmbossFilter' + this.randomIdentifier},\n      this.defs,\n    );\n    dom.createSvgElement(\n      Svg.FEGAUSSIANBLUR,\n      {'in': 'SourceAlpha', 'stdDeviation': 1, 'result': 'blur'},\n      embossFilter,\n    );\n    const feSpecularLighting = dom.createSvgElement(\n      Svg.FESPECULARLIGHTING,\n      {\n        'in': 'blur',\n        'surfaceScale': 1,\n        'specularConstant': 0.5,\n        'specularExponent': 10,\n        'lighting-color': 'white',\n        'result': 'specOut',\n      },\n      embossFilter,\n    );\n    dom.createSvgElement(\n      Svg.FEPOINTLIGHT,\n      {'x': -5000, 'y': -10000, 'z': 20000},\n      feSpecularLighting,\n    );\n    dom.createSvgElement(\n      Svg.FECOMPOSITE,\n      {\n        'in': 'specOut',\n        'in2': 'SourceAlpha',\n        'operator': 'in',\n        'result': 'specOut',\n      },\n      embossFilter,\n    );\n    dom.createSvgElement(\n      Svg.FECOMPOSITE,\n      {\n        'in': 'SourceGraphic',\n        'in2': 'specOut',\n        'operator': 'arithmetic',\n        'k1': 0,\n        'k2': 1,\n        'k3': 1,\n        'k4': 0,\n      },\n      embossFilter,\n    );\n    this.embossFilterId = embossFilter.id;\n    this.embossFilter = embossFilter;\n\n    /*\n          <pattern id=\"blocklyDisabledPattern837493\"\n       patternUnits=\"userSpaceOnUse\" width=\"10\" height=\"10\"> <rect width=\"10\"\n       height=\"10\" fill=\"#aaa\" /> <path d=\"M 0 0 L 10 10 M 10 0 L 0 10\"\n       stroke=\"#cc0\" />\n          </pattern>\n        */\n    const disabledPattern = dom.createSvgElement(\n      Svg.PATTERN,\n      {\n        'id': 'blocklyDisabledPattern' + this.randomIdentifier,\n        'patternUnits': 'userSpaceOnUse',\n        'width': 10,\n        'height': 10,\n      },\n      this.defs,\n    );\n    dom.createSvgElement(\n      Svg.RECT,\n      {'width': 10, 'height': 10, 'fill': '#aaa'},\n      disabledPattern,\n    );\n    dom.createSvgElement(\n      Svg.PATH,\n      {'d': 'M 0 0 L 10 10 M 10 0 L 0 10', 'stroke': '#cc0'},\n      disabledPattern,\n    );\n    this.disabledPatternId = disabledPattern.id;\n    this.disabledPattern = disabledPattern;\n\n    this.createDebugFilter();\n  }\n\n  /**\n   * Create a filter for highlighting the currently rendering block during\n   * render debugging.\n   */\n  private createDebugFilter() {\n    // Only create the debug filter once.\n    if (!this.debugFilter) {\n      const debugFilter = dom.createSvgElement(\n        Svg.FILTER,\n        {\n          'id': 'blocklyDebugFilter' + this.randomIdentifier,\n          'height': '160%',\n          'width': '180%',\n          'y': '-30%',\n          'x': '-40%',\n        },\n        this.defs,\n      );\n      // Set all gaussian blur pixels to 1 opacity before applying flood\n      const debugComponentTransfer = dom.createSvgElement(\n        Svg.FECOMPONENTTRANSFER,\n        {'result': 'outBlur'},\n        debugFilter,\n      );\n      dom.createSvgElement(\n        Svg.FEFUNCA,\n        {'type': 'table', 'tableValues': '0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1'},\n        debugComponentTransfer,\n      );\n      // Color the highlight\n      dom.createSvgElement(\n        Svg.FEFLOOD,\n        {\n          'flood-color': '#ff0000',\n          'flood-opacity': 0.5,\n          'result': 'outColor',\n        },\n        debugFilter,\n      );\n      dom.createSvgElement(\n        Svg.FECOMPOSITE,\n        {\n          'in': 'outColor',\n          'in2': 'outBlur',\n          'operator': 'in',\n          'result': 'outGlow',\n        },\n        debugFilter,\n      );\n      this.debugFilterId = debugFilter.id;\n      this.debugFilter = debugFilter;\n    }\n  }\n\n  /**\n   * Inject renderer specific CSS into the page.\n   *\n   * @param tagName The name of the style tag to use.\n   * @param selector The CSS selector to use.\n   */\n  protected injectCSS_(tagName: string, selector: string) {\n    const cssArray = this.getCSS_(selector);\n    const cssNodeId = 'blockly-renderer-style-' + tagName;\n    this.cssNode = document.getElementById(cssNodeId) as HTMLStyleElement;\n    const text = cssArray.join('\\n');\n    if (this.cssNode) {\n      // Already injected, update if the theme changed.\n      this.cssNode.firstChild!.textContent = text;\n      return;\n    }\n    // Inject CSS tag at start of head.\n    const cssNode = document.createElement('style');\n    cssNode.id = cssNodeId;\n    const cssTextNode = document.createTextNode(text);\n    cssNode.appendChild(cssTextNode);\n    document.head.insertBefore(cssNode, document.head.firstChild);\n    this.cssNode = cssNode;\n  }\n\n  /**\n   * Get any renderer specific CSS to inject when the renderer is initialized.\n   *\n   * @param selector CSS selector to use.\n   * @returns Array of CSS strings.\n   */\n  protected getCSS_(selector: string): string[] {\n    // prettier-ignore\n    return [\n      // Text.\n      `${selector} .blocklyText, `,\n      `${selector} .blocklyFlyoutLabelText {`,\n        `font: ${this.FIELD_TEXT_FONTWEIGHT} ` +\n            `${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,\n      `}`,\n\n      // Fields.\n      `${selector} .blocklyText {`,\n        `fill: #fff;`,\n      `}`,\n      `${selector} .blocklyNonEditableText>rect,`,\n      `${selector} .blocklyEditableText>rect {`,\n        `fill: ${this.FIELD_BORDER_RECT_COLOUR};`,\n        `fill-opacity: .6;`,\n        `stroke: none;`,\n      `}`,\n      `${selector} .blocklyNonEditableText>text,`,\n      `${selector} .blocklyEditableText>text {`,\n        `fill: #000;`,\n      `}`,\n\n      // Flyout labels.\n      `${selector} .blocklyFlyoutLabelText {`,\n        `fill: #000;`,\n      `}`,\n\n      // Bubbles.\n      `${selector} .blocklyText.blocklyBubbleText {`,\n        `fill: #000;`,\n      `}`,\n\n      // Editable field hover.\n      `${selector} .blocklyEditableText:not(.editing):hover>rect {`,\n        `stroke: #fff;`,\n        `stroke-width: 2;`,\n      `}`,\n\n      // Text field input.\n      `${selector} .blocklyHtmlInput {`,\n        `font-family: ${this.FIELD_TEXT_FONTFAMILY};`,\n        `font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,\n      `}`,\n\n      // Selection highlight.\n      `${selector} .blocklySelected>.blocklyPath {`,\n        `stroke: #fc3;`,\n        `stroke-width: 3px;`,\n      `}`,\n\n      // Connection highlight.\n      `${selector} .blocklyHighlightedConnectionPath {`,\n        `stroke: #fc3;`,\n      `}`,\n\n      // Replaceable highlight.\n      `${selector} .blocklyReplaceable .blocklyPath {`,\n        `fill-opacity: .5;`,\n      `}`,\n      `${selector} .blocklyReplaceable .blocklyPathLight,`,\n      `${selector} .blocklyReplaceable .blocklyPathDark {`,\n        `display: none;`,\n      `}`,\n\n      // Insertion marker.\n      `${selector} .blocklyInsertionMarker>.blocklyPath {`,\n        `fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,\n        `stroke: none;`,\n      `}`,\n    ];\n  }\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Components for creating connections between blocks.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Connection\n\nimport type {Block} from './block.js';\nimport {ConnectionType} from './connection_type.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Input} from './inputs/input.js';\nimport type {IASTNodeLocationWithBlock} from './interfaces/i_ast_node_location_with_block.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport * as blocks from './serialization/blocks.js';\nimport * as Xml from './xml.js';\n\n/**\n * Class for a connection between blocks.\n */\nexport class Connection implements IASTNodeLocationWithBlock {\n  /** Constants for checking whether two connections are compatible. */\n  static CAN_CONNECT = 0;\n  static REASON_SELF_CONNECTION = 1;\n  static REASON_WRONG_TYPE = 2;\n  static REASON_TARGET_NULL = 3;\n  static REASON_CHECKS_FAILED = 4;\n  static REASON_DIFFERENT_WORKSPACES = 5;\n  static REASON_SHADOW_PARENT = 6;\n  static REASON_DRAG_CHECKS_FAILED = 7;\n  static REASON_PREVIOUS_AND_OUTPUT = 8;\n\n  protected sourceBlock_: Block;\n\n  /** Connection this connection connects to.  Null if not connected. */\n  targetConnection: Connection | null = null;\n\n  /**\n   * Has this connection been disposed of?\n   *\n   * @internal\n   */\n  disposed = false;\n\n  /** List of compatible value types.  Null if all types are compatible. */\n  private check: string[] | null = null;\n\n  /** DOM representation of a shadow block, or null if none. */\n  private shadowDom: Element | null = null;\n\n  /**\n   * Horizontal location of this connection.\n   *\n   * @internal\n   */\n  x = 0;\n\n  /**\n   * Vertical location of this connection.\n   *\n   * @internal\n   */\n  y = 0;\n\n  private shadowState: blocks.State | null = null;\n\n  /**\n   * @param source The block establishing this connection.\n   * @param type The type of the connection.\n   */\n  constructor(\n    source: Block,\n    public type: number,\n  ) {\n    this.sourceBlock_ = source;\n  }\n\n  /**\n   * Connect two connections together.  This is the connection on the superior\n   * block.\n   *\n   * @param childConnection Connection on inferior block.\n   */\n  protected connect_(childConnection: Connection) {\n    const INPUT = ConnectionType.INPUT_VALUE;\n    const parentBlock = this.getSourceBlock();\n    const childBlock = childConnection.getSourceBlock();\n\n    // Make sure the childConnection is available.\n    if (childConnection.isConnected()) {\n      childConnection.disconnectInternal(false);\n    }\n\n    // Make sure the parentConnection is available.\n    let orphan;\n    if (this.isConnected()) {\n      const shadowState = this.stashShadowState();\n      const target = this.targetBlock();\n      if (target!.isShadow()) {\n        target!.dispose(false);\n      } else {\n        this.disconnectInternal();\n        orphan = target;\n      }\n      this.applyShadowState(shadowState);\n    }\n\n    // Connect the new connection to the parent.\n    let event;\n    if (eventUtils.isEnabled()) {\n      event = new (eventUtils.get(eventUtils.BLOCK_MOVE))(\n        childBlock,\n      ) as BlockMove;\n      event.setReason(['connect']);\n    }\n    connectReciprocally(this, childConnection);\n    childBlock.setParent(parentBlock);\n    if (event) {\n      event.recordNew();\n      eventUtils.fire(event);\n    }\n\n    // Deal with the orphan if it exists.\n    if (orphan) {\n      const orphanConnection =\n        this.type === INPUT\n          ? orphan.outputConnection\n          : orphan.previousConnection;\n      if (!orphanConnection) return;\n      const connection = Connection.getConnectionForOrphanedConnection(\n        childBlock,\n        orphanConnection,\n      );\n      if (connection) {\n        orphanConnection.connect(connection);\n      } else {\n        orphanConnection.onFailedConnect(this);\n      }\n    }\n  }\n\n  /**\n   * Dispose of this connection and deal with connected blocks.\n   *\n   * @internal\n   */\n  dispose() {\n    // isConnected returns true for shadows and non-shadows.\n    if (this.isConnected()) {\n      if (this.isSuperior()) {\n        // Destroy the attached shadow block & its children (if it exists).\n        this.setShadowStateInternal();\n      }\n\n      const targetBlock = this.targetBlock();\n      if (targetBlock && !targetBlock.isDeadOrDying()) {\n        // Disconnect the attached normal block.\n        targetBlock.unplug();\n      }\n    }\n\n    this.disposed = true;\n  }\n\n  /**\n   * Get the source block for this connection.\n   *\n   * @returns The source block.\n   */\n  getSourceBlock(): Block {\n    return this.sourceBlock_;\n  }\n\n  /**\n   * Does the connection belong to a superior block (higher in the source\n   * stack)?\n   *\n   * @returns True if connection faces down or right.\n   */\n  isSuperior(): boolean {\n    return (\n      this.type === ConnectionType.INPUT_VALUE ||\n      this.type === ConnectionType.NEXT_STATEMENT\n    );\n  }\n\n  /**\n   * Is the connection connected?\n   *\n   * @returns True if connection is connected to another connection.\n   */\n  isConnected(): boolean {\n    return !!this.targetConnection;\n  }\n\n  /**\n   * Get the workspace's connection type checker object.\n   *\n   * @returns The connection type checker for the source block's workspace.\n   * @internal\n   */\n  getConnectionChecker(): IConnectionChecker {\n    return this.sourceBlock_.workspace.connectionChecker;\n  }\n\n  /**\n   * Called when an attempted connection fails. NOP by default (i.e. for\n   * headless workspaces).\n   *\n   * @param _otherConnection Connection that this connection failed to connect\n   *     to.\n   * @internal\n   */\n  onFailedConnect(_otherConnection: Connection) {}\n  // NOP\n\n  /**\n   * Connect this connection to another connection.\n   *\n   * @param otherConnection Connection to connect to.\n   * @returns Whether the blocks are now connected or not.\n   */\n  connect(otherConnection: Connection): boolean {\n    if (this.targetConnection === otherConnection) {\n      // Already connected together.  NOP.\n      return true;\n    }\n\n    const checker = this.getConnectionChecker();\n    if (checker.canConnect(this, otherConnection, false)) {\n      const existingGroup = eventUtils.getGroup();\n      if (!existingGroup) {\n        eventUtils.setGroup(true);\n      }\n      // Determine which block is superior (higher in the source stack).\n      if (this.isSuperior()) {\n        // Superior block.\n        this.connect_(otherConnection);\n      } else {\n        // Inferior block.\n        otherConnection.connect_(this);\n      }\n      eventUtils.setGroup(existingGroup);\n    }\n\n    return this.isConnected();\n  }\n\n  /**\n   * Disconnect this connection.\n   */\n  disconnect() {\n    this.disconnectInternal();\n  }\n\n  /**\n   * Disconnect two blocks that are connected by this connection.\n   *\n   * @param setParent Whether to set the parent of the disconnected block or\n   *     not, defaults to true.\n   *     If you do not set the parent, ensure that a subsequent action does,\n   *     otherwise the view and model will be out of sync.\n   */\n  protected disconnectInternal(setParent = true) {\n    const {parentConnection, childConnection} =\n      this.getParentAndChildConnections();\n    if (!parentConnection || !childConnection) {\n      throw Error('Source connection not connected.');\n    }\n\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n\n    let event;\n    if (eventUtils.isEnabled()) {\n      event = new (eventUtils.get(eventUtils.BLOCK_MOVE))(\n        childConnection.getSourceBlock(),\n      ) as BlockMove;\n      event.setReason(['disconnect']);\n    }\n    const otherConnection = this.targetConnection;\n    if (otherConnection) {\n      otherConnection.targetConnection = null;\n    }\n    this.targetConnection = null;\n    if (setParent) childConnection.getSourceBlock().setParent(null);\n    if (event) {\n      event.recordNew();\n      eventUtils.fire(event);\n    }\n\n    if (!childConnection.getSourceBlock().isShadow()) {\n      // If we were disconnecting a shadow, no need to spawn a new one.\n      parentConnection.respawnShadow_();\n    }\n\n    eventUtils.setGroup(existingGroup);\n  }\n\n  /**\n   * Returns the parent connection (superior) and child connection (inferior)\n   * given this connection and the connection it is connected to.\n   *\n   * @returns The parent connection and child connection, given this connection\n   *     and the connection it is connected to.\n   */\n  protected getParentAndChildConnections(): {\n    parentConnection?: Connection;\n    childConnection?: Connection;\n  } {\n    if (!this.targetConnection) return {};\n    if (this.isSuperior()) {\n      return {\n        parentConnection: this,\n        childConnection: this.targetConnection,\n      };\n    }\n    return {\n      parentConnection: this.targetConnection,\n      childConnection: this,\n    };\n  }\n\n  /**\n   * Respawn the shadow block if there was one connected to the this connection.\n   */\n  protected respawnShadow_() {\n    // Have to keep respawnShadow_ for backwards compatibility.\n    this.createShadowBlock(true);\n  }\n\n  /**\n   * Reconnects this connection to the input with the given name on the given\n   * block. If there is already a connection connected to that input, that\n   * connection is disconnected.\n   *\n   * @param block The block to connect this connection to.\n   * @param inputName The name of the input to connect this connection to.\n   * @returns True if this connection was able to connect, false otherwise.\n   */\n  reconnect(block: Block, inputName: string): boolean {\n    // No need to reconnect if this connection's block is deleted.\n    if (this.getSourceBlock().isDeadOrDying()) return false;\n\n    const connectionParent = block.getInput(inputName)?.connection;\n    const currentParent = this.targetBlock();\n    if (\n      (!currentParent || currentParent === block) &&\n      connectionParent &&\n      connectionParent.targetConnection !== this\n    ) {\n      if (connectionParent.isConnected()) {\n        // There's already something connected here.  Get rid of it.\n        connectionParent.disconnect();\n      }\n      connectionParent.connect(this);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns the block that this connection connects to.\n   *\n   * @returns The connected block or null if none is connected.\n   */\n  targetBlock(): Block | null {\n    if (this.isConnected()) {\n      return this.targetConnection?.getSourceBlock() ?? null;\n    }\n    return null;\n  }\n\n  /**\n   * Function to be called when this connection's compatible types have changed.\n   */\n  protected onCheckChanged_() {\n    // The new value type may not be compatible with the existing connection.\n    if (\n      this.isConnected() &&\n      (!this.targetConnection ||\n        !this.getConnectionChecker().canConnect(\n          this,\n          this.targetConnection,\n          false,\n        ))\n    ) {\n      const child = this.isSuperior() ? this.targetBlock() : this.sourceBlock_;\n      child!.unplug();\n    }\n  }\n\n  /**\n   * Change a connection's compatibility.\n   *\n   * @param check Compatible value type or list of value types. Null if all\n   *     types are compatible.\n   * @returns The connection being modified (to allow chaining).\n   */\n  setCheck(check: string | string[] | null): Connection {\n    if (check) {\n      if (!Array.isArray(check)) {\n        check = [check];\n      }\n      this.check = check;\n      this.onCheckChanged_();\n    } else {\n      this.check = null;\n    }\n    return this;\n  }\n\n  /**\n   * Get a connection's compatibility.\n   *\n   * @returns List of compatible value types.\n   *     Null if all types are compatible.\n   */\n  getCheck(): string[] | null {\n    return this.check;\n  }\n\n  /**\n   * Changes the connection's shadow block.\n   *\n   * @param shadowDom DOM representation of a block or null.\n   */\n  setShadowDom(shadowDom: Element | null) {\n    this.setShadowStateInternal({shadowDom});\n  }\n\n  /**\n   * Returns the xml representation of the connection's shadow block.\n   *\n   * @param returnCurrent If true, and the shadow block is currently attached to\n   *     this connection, this serializes the state of that block and returns it\n   *     (so that field values are correct). Otherwise the saved shadowDom is\n   *     just returned.\n   * @returns Shadow DOM representation of a block or null.\n   */\n  getShadowDom(returnCurrent?: boolean): Element | null {\n    return returnCurrent && this.targetBlock()!.isShadow()\n      ? (Xml.blockToDom(this.targetBlock() as Block) as Element)\n      : this.shadowDom;\n  }\n\n  /**\n   * Changes the connection's shadow block.\n   *\n   * @param shadowState An state represetation of the block or null.\n   */\n  setShadowState(shadowState: blocks.State | null) {\n    this.setShadowStateInternal({shadowState});\n  }\n\n  /**\n   * Returns the serialized object representation of the connection's shadow\n   * block.\n   *\n   * @param returnCurrent If true, and the shadow block is currently attached to\n   *     this connection, this serializes the state of that block and returns it\n   *     (so that field values are correct). Otherwise the saved state is just\n   *     returned.\n   * @returns Serialized object representation of the block, or null.\n   */\n  getShadowState(returnCurrent?: boolean): blocks.State | null {\n    if (returnCurrent && this.targetBlock() && this.targetBlock()!.isShadow()) {\n      return blocks.save(this.targetBlock() as Block);\n    }\n    return this.shadowState;\n  }\n\n  /**\n   * Find all nearby compatible connections to this connection.\n   * Type checking does not apply, since this function is used for bumping.\n   *\n   * Headless configurations (the default) do not have neighboring connection,\n   * and always return an empty list (the default).\n   * {@link RenderedConnection#neighbours} overrides this behavior with a list\n   * computed from the rendered positioning.\n   *\n   * @param _maxLimit The maximum radius to another connection.\n   * @returns List of connections.\n   * @internal\n   */\n  neighbours(_maxLimit: number): Connection[] {\n    return [];\n  }\n\n  /**\n   * Get the parent input of a connection.\n   *\n   * @returns The input that the connection belongs to or null if no parent\n   *     exists.\n   * @internal\n   */\n  getParentInput(): Input | null {\n    let parentInput = null;\n    const inputs = this.sourceBlock_.inputList;\n    for (let i = 0; i < inputs.length; i++) {\n      if (inputs[i].connection === this) {\n        parentInput = inputs[i];\n        break;\n      }\n    }\n    return parentInput;\n  }\n\n  /**\n   * This method returns a string describing this Connection in developer terms\n   * (English only). Intended to on be used in console logs and errors.\n   *\n   * @returns The description.\n   */\n  toString(): string {\n    const block = this.sourceBlock_;\n    if (!block) {\n      return 'Orphan Connection';\n    }\n    let msg;\n    if (block.outputConnection === this) {\n      msg = 'Output Connection of ';\n    } else if (block.previousConnection === this) {\n      msg = 'Previous Connection of ';\n    } else if (block.nextConnection === this) {\n      msg = 'Next Connection of ';\n    } else {\n      let parentInput = null;\n      for (let i = 0, input; (input = block.inputList[i]); i++) {\n        if (input.connection === this) {\n          parentInput = input;\n          break;\n        }\n      }\n      if (parentInput) {\n        msg = 'Input \"' + parentInput.name + '\" connection on ';\n      } else {\n        console.warn('Connection not actually connected to sourceBlock_');\n        return 'Orphan Connection';\n      }\n    }\n    return msg + block.toDevString();\n  }\n\n  /**\n   * Returns the state of the shadowDom_ and shadowState_ properties, then\n   * temporarily sets those properties to null so no shadow respawns.\n   *\n   * @returns The state of both the shadowDom_ and shadowState_ properties.\n   */\n  private stashShadowState(): {\n    shadowDom: Element | null;\n    shadowState: blocks.State | null;\n  } {\n    const shadowDom = this.getShadowDom(true);\n    const shadowState = this.getShadowState(true);\n    // Set to null so it doesn't respawn.\n    this.shadowDom = null;\n    this.shadowState = null;\n    return {shadowDom, shadowState};\n  }\n\n  /**\n   * Reapplies the stashed state of the shadowDom_ and shadowState_ properties.\n   *\n   * @param param0 The state to reapply to the shadowDom_ and shadowState_\n   *     properties.\n   */\n  private applyShadowState({\n    shadowDom,\n    shadowState,\n  }: {\n    shadowDom: Element | null;\n    shadowState: blocks.State | null;\n  }) {\n    this.shadowDom = shadowDom;\n    this.shadowState = shadowState;\n  }\n\n  /**\n   * Sets the state of the shadow of this connection.\n   *\n   * @param param0 The state to set the shadow of this connection to.\n   */\n  private setShadowStateInternal({\n    shadowDom = null,\n    shadowState = null,\n  }: {\n    shadowDom?: Element | null;\n    shadowState?: blocks.State | null;\n  } = {}) {\n    // One or both of these should always be null.\n    // If neither is null, the shadowState will get priority.\n    this.shadowDom = shadowDom;\n    this.shadowState = shadowState;\n\n    if (this.getSourceBlock().isDeadOrDying()) return;\n\n    const target = this.targetBlock();\n    if (!target) {\n      this.respawnShadow_();\n      if (this.targetBlock() && this.targetBlock()!.isShadow()) {\n        this.serializeShadow(this.targetBlock());\n      }\n    } else if (target.isShadow()) {\n      target.dispose(false);\n      this.respawnShadow_();\n      if (this.targetBlock() && this.targetBlock()!.isShadow()) {\n        this.serializeShadow(this.targetBlock());\n      }\n    } else {\n      const shadow = this.createShadowBlock(false);\n      this.serializeShadow(shadow);\n      if (shadow) {\n        shadow.dispose(false);\n      }\n    }\n  }\n\n  /**\n   * Creates a shadow block based on the current shadowState_ or shadowDom_.\n   * shadowState_ gets priority.\n   *\n   * @param attemptToConnect Whether to try to connect the shadow block to this\n   *     connection or not.\n   * @returns The shadow block that was created, or null if both the\n   *     shadowState_ and shadowDom_ are null.\n   */\n  private createShadowBlock(attemptToConnect: boolean): Block | null {\n    const parentBlock = this.getSourceBlock();\n    const shadowState = this.getShadowState();\n    const shadowDom = this.getShadowDom();\n    if (parentBlock.isDeadOrDying() || (!shadowState && !shadowDom)) {\n      return null;\n    }\n\n    let blockShadow;\n    if (shadowState) {\n      blockShadow = blocks.appendInternal(shadowState, parentBlock.workspace, {\n        parentConnection: attemptToConnect ? this : undefined,\n        isShadow: true,\n        recordUndo: false,\n      });\n      return blockShadow;\n    }\n\n    if (shadowDom) {\n      blockShadow = Xml.domToBlockInternal(shadowDom, parentBlock.workspace);\n      if (attemptToConnect) {\n        if (this.type === ConnectionType.INPUT_VALUE) {\n          if (!blockShadow.outputConnection) {\n            throw new Error('Shadow block is missing an output connection');\n          }\n          if (!this.connect(blockShadow.outputConnection)) {\n            throw new Error('Could not connect shadow block to connection');\n          }\n        } else if (this.type === ConnectionType.NEXT_STATEMENT) {\n          if (!blockShadow.previousConnection) {\n            throw new Error('Shadow block is missing previous connection');\n          }\n          if (!this.connect(blockShadow.previousConnection)) {\n            throw new Error('Could not connect shadow block to connection');\n          }\n        } else {\n          throw new Error(\n            'Cannot connect a shadow block to a previous/output connection',\n          );\n        }\n      }\n      return blockShadow;\n    }\n    return null;\n  }\n\n  /**\n   * Saves the given shadow block to both the shadowDom_ and shadowState_\n   * properties, in their respective serialized forms.\n   *\n   * @param shadow The shadow to serialize, or null.\n   */\n  private serializeShadow(shadow: Block | null) {\n    if (!shadow) {\n      return;\n    }\n    this.shadowDom = Xml.blockToDom(shadow) as Element;\n    this.shadowState = blocks.save(shadow);\n  }\n\n  /**\n   * Returns the connection (starting at the startBlock) which will accept\n   * the given connection. This includes compatible connection types and\n   * connection checks.\n   *\n   * @param startBlock The block on which to start the search.\n   * @param orphanConnection The connection that is looking for a home.\n   * @returns The suitable connection point on the chain of blocks, or null.\n   */\n  static getConnectionForOrphanedConnection(\n    startBlock: Block,\n    orphanConnection: Connection,\n  ): Connection | null {\n    if (orphanConnection.type === ConnectionType.OUTPUT_VALUE) {\n      return getConnectionForOrphanedOutput(\n        startBlock,\n        orphanConnection.getSourceBlock(),\n      );\n    }\n    // Otherwise we're dealing with a stack.\n    const connection = startBlock.lastConnectionInStack(true);\n    const checker = orphanConnection.getConnectionChecker();\n    if (connection && checker.canConnect(orphanConnection, connection, false)) {\n      return connection;\n    }\n    return null;\n  }\n}\n\n/**\n * Update two connections to target each other.\n *\n * @param first The first connection to update.\n * @param second The second connection to update.\n */\nfunction connectReciprocally(first: Connection, second: Connection) {\n  if (!first || !second) {\n    throw Error('Cannot connect null connections.');\n  }\n  first.targetConnection = second;\n  second.targetConnection = first;\n}\n/**\n * Returns the single connection on the block that will accept the orphaned\n * block, if one can be found. If the block has multiple compatible connections\n * (even if they are filled) this returns null. If the block has no compatible\n * connections, this returns null.\n *\n * @param block The superior block.\n * @param orphanBlock The inferior block.\n * @returns The suitable connection point on 'block', or null.\n */\nfunction getSingleConnection(\n  block: Block,\n  orphanBlock: Block,\n): Connection | null {\n  let foundConnection = null;\n  const output = orphanBlock.outputConnection;\n  const typeChecker = output?.getConnectionChecker();\n\n  for (let i = 0, input; (input = block.inputList[i]); i++) {\n    const connection = input.connection;\n    if (connection && typeChecker?.canConnect(output, connection, false)) {\n      if (foundConnection) {\n        return null; // More than one connection.\n      }\n      foundConnection = connection;\n    }\n  }\n  return foundConnection;\n}\n\n/**\n * Walks down a row a blocks, at each stage checking if there are any\n * connections that will accept the orphaned block.  If at any point there\n * are zero or multiple eligible connections, returns null.  Otherwise\n * returns the only input on the last block in the chain.\n * Terminates early for shadow blocks.\n *\n * @param startBlock The block on which to start the search.\n * @param orphanBlock The block that is looking for a home.\n * @returns The suitable connection point on the chain of blocks, or null.\n */\nfunction getConnectionForOrphanedOutput(\n  startBlock: Block,\n  orphanBlock: Block,\n): Connection | null {\n  let newBlock: Block | null = startBlock;\n  let connection;\n  while ((connection = getSingleConnection(newBlock, orphanBlock))) {\n    newBlock = connection.targetBlock();\n    if (!newBlock || newBlock.isShadow()) {\n      return connection;\n    }\n  }\n  return null;\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {IconType} from '../icons/icon_types.js';\nimport type {Coordinate} from '../utils/coordinate.js';\nimport type {Size} from '../utils/size.js';\n\nexport interface IIcon {\n  /**\n   * @returns the IconType representing the type of the icon. This value should\n   *     also be used to register the icon via `Blockly.icons.registry.register`.\n   */\n  getType(): IconType<IIcon>;\n\n  /**\n   * Creates the SVG elements for the icon that will live on the block.\n   *\n   * @param pointerdownListener An event listener that must be attached to the\n   *     root SVG element by the implementation of `initView`. Used by Blockly's\n   *     gesture system to properly handle clicks and drags.\n   */\n  initView(pointerdownListener: (e: PointerEvent) => void): void;\n\n  /**\n   * Disposes of any elements of the icon.\n   *\n   * @remarks\n   *\n   * In particular, if this icon is currently showing a bubble, this should be\n   * used to hide it.\n   */\n  dispose(): void;\n\n  /**\n   * @returns the \"weight\" of the icon, which determines the static order which\n   *     icons should be rendered in. More positive numbers are rendered farther\n   *     toward the end of the block.\n   */\n  getWeight(): number;\n\n  /** @returns The dimensions of the icon for use in rendering. */\n  getSize(): Size;\n\n  /** Updates the icon's color when the block's color changes.. */\n  applyColour(): void;\n\n  /** Hides the icon when it is part of an insertion marker. */\n  hideForInsertionMarker(): void;\n\n  /** Updates the icon's editability when the block's editability changes. */\n  updateEditable(): void;\n\n  /**\n   * Updates the icon's collapsed-ness/view when the block's collapsed-ness\n   * changes.\n   */\n  updateCollapsed(): void;\n\n  /**\n   * @returns Whether this icon is shown when the block is collapsed. Used\n   *     to allow renderers to account for padding.\n   */\n  isShownWhenCollapsed(): boolean;\n\n  /**\n   * Notifies the icon where it is relative to its block's top-start, in\n   * workspace units.\n   */\n  setOffsetInBlock(offset: Coordinate): void;\n\n  /**\n   * Notifies the icon that it has changed locations.\n   *\n   * @param blockOrigin The location of this icon's block's top-start corner\n   *     in workspace coordinates.\n   */\n  onLocationChange(blockOrigin: Coordinate): void;\n\n  /**\n   * Notifies the icon that it has been clicked.\n   */\n  onClick(): void;\n\n  /**\n   * Check whether the icon should be clickable while the block is in a flyout.\n   * If this function is not defined, the icon will be clickable in all flyouts.\n   *\n   * @param autoClosingFlyout true if the containing flyout is an auto-closing one.\n   * @returns Whether the icon should be clickable while the block is in a flyout.\n   */\n  isClickableInFlyout?(autoClosingFlyout: boolean): boolean;\n}\n\n/** Type guard that checks whether the given object is an IIcon. */\nexport function isIcon(obj: any): obj is IIcon {\n  return (\n    obj.getType !== undefined &&\n    obj.initView !== undefined &&\n    obj.dispose !== undefined &&\n    obj.getWeight !== undefined &&\n    obj.getSize !== undefined &&\n    obj.applyColour !== undefined &&\n    obj.hideForInsertionMarker !== undefined &&\n    obj.updateEditable !== undefined &&\n    obj.updateCollapsed !== undefined &&\n    obj.isShownWhenCollapsed !== undefined &&\n    obj.setOffsetInBlock !== undefined &&\n    obj.onLocationChange !== undefined &&\n    obj.onClick !== undefined\n  );\n}\n","/**\n * @license\n * Copyright 2024 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IconType} from '../icons/icon_types.js';\nimport {CommentState} from '../icons/comment_icon.js';\nimport {IIcon, isIcon} from './i_icon.js';\nimport {Size} from '../utils/size.js';\nimport {IHasBubble, hasBubble} from './i_has_bubble.js';\nimport {ISerializable, isSerializable} from './i_serializable.js';\n\nexport interface ICommentIcon extends IIcon, IHasBubble, ISerializable {\n  setText(text: string): void;\n\n  getText(): string;\n\n  setBubbleSize(size: Size): void;\n\n  getBubbleSize(): Size;\n\n  saveState(): CommentState;\n\n  loadState(state: CommentState): void;\n}\n\n/** Checks whether the given object is an ICommentIcon. */\nexport function isCommentIcon(obj: Object): obj is ICommentIcon {\n  return (\n    isIcon(obj) &&\n    hasBubble(obj) &&\n    isSerializable(obj) &&\n    (obj as any)['setText'] !== undefined &&\n    (obj as any)['getText'] !== undefined &&\n    (obj as any)['setBubbleSize'] !== undefined &&\n    (obj as any)['getBubbleSize'] !== undefined &&\n    obj.getType() === IconType.COMMENT\n  );\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing an AST node.\n * Used to traverse the Blockly AST.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ASTNode\n\nimport {Block} from '../block.js';\nimport type {Connection} from '../connection.js';\nimport {ConnectionType} from '../connection_type.js';\nimport type {Field} from '../field.js';\nimport type {Input} from '../inputs/input.js';\nimport type {IASTNodeLocation} from '../interfaces/i_ast_node_location.js';\nimport type {IASTNodeLocationWithBlock} from '../interfaces/i_ast_node_location_with_block.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport type {Workspace} from '../workspace.js';\nimport {FlyoutButton} from '../flyout_button.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport {FlyoutItem} from '../flyout_base.js';\n\n/**\n * Class for an AST node.\n * It is recommended that you use one of the createNode methods instead of\n * creating a node directly.\n */\nexport class ASTNode {\n  /**\n   * True to navigate to all fields. False to only navigate to clickable fields.\n   */\n  static NAVIGATE_ALL_FIELDS = false;\n\n  /**\n   * The default y offset to use when moving the cursor from a stack to the\n   * workspace.\n   */\n  private static readonly DEFAULT_OFFSET_Y: number = -20;\n  private readonly type: string;\n  private readonly isConnectionLocation: boolean;\n  private readonly location: IASTNodeLocation;\n\n  /** The coordinate on the workspace. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'Coordinate'.\n  private wsCoordinate: Coordinate = null as AnyDuringMigration;\n\n  /**\n   * @param type The type of the location.\n   *     Must be in ASTNode.types.\n   * @param location The position in the AST.\n   * @param opt_params Optional dictionary of options.\n   */\n  constructor(type: string, location: IASTNodeLocation, opt_params?: Params) {\n    if (!location) {\n      throw Error('Cannot create a node without a location.');\n    }\n\n    /**\n     * The type of the location.\n     * One of ASTNode.types\n     */\n    this.type = type;\n\n    /** Whether the location points to a connection. */\n    this.isConnectionLocation = ASTNode.isConnectionType(type);\n\n    /** The location of the AST node. */\n    this.location = location;\n\n    this.processParams(opt_params || null);\n  }\n\n  /**\n   * Parse the optional parameters.\n   *\n   * @param params The user specified parameters.\n   */\n  private processParams(params: Params | null) {\n    if (!params) {\n      return;\n    }\n    if (params.wsCoordinate) {\n      this.wsCoordinate = params.wsCoordinate;\n    }\n  }\n\n  /**\n   * Gets the value pointed to by this node.\n   * It is the callers responsibility to check the node type to figure out what\n   * type of object they get back from this.\n   *\n   * @returns The current field, connection, workspace, or block the cursor is\n   *     on.\n   */\n  getLocation(): IASTNodeLocation {\n    return this.location;\n  }\n\n  /**\n   * The type of the current location.\n   * One of ASTNode.types\n   *\n   * @returns The type of the location.\n   */\n  getType(): string {\n    return this.type;\n  }\n\n  /**\n   * The coordinate on the workspace.\n   *\n   * @returns The workspace coordinate or null if the location is not a\n   *     workspace.\n   */\n  getWsCoordinate(): Coordinate {\n    return this.wsCoordinate;\n  }\n\n  /**\n   * Whether the node points to a connection.\n   *\n   * @returns [description]\n   * @internal\n   */\n  isConnection(): boolean {\n    return this.isConnectionLocation;\n  }\n\n  /**\n   * Given an input find the next editable field or an input with a non null\n   * connection in the same block. The current location must be an input\n   * connection.\n   *\n   * @returns The AST node holding the next field or connection or null if there\n   *     is no editable field or input connection after the given input.\n   */\n  private findNextForInput(): ASTNode | null {\n    const location = this.location as Connection;\n    const parentInput = location.getParentInput();\n    const block = parentInput!.getSourceBlock();\n    // AnyDuringMigration because:  Argument of type 'Input | null' is not\n    // assignable to parameter of type 'Input'.\n    const curIdx = block!.inputList.indexOf(parentInput as AnyDuringMigration);\n    for (let i = curIdx + 1; i < block!.inputList.length; i++) {\n      const input = block!.inputList[i];\n      const fieldRow = input.fieldRow;\n      for (let j = 0; j < fieldRow.length; j++) {\n        const field = fieldRow[j];\n        if (field.isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(field);\n        }\n      }\n      if (input.connection) {\n        return ASTNode.createInputNode(input);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Given a field find the next editable field or an input with a non null\n   * connection in the same block. The current location must be a field.\n   *\n   * @returns The AST node pointing to the next field or connection or null if\n   *     there is no editable field or input connection after the given input.\n   */\n  private findNextForField(): ASTNode | null {\n    const location = this.location as Field;\n    const input = location.getParentInput();\n    const block = location.getSourceBlock();\n    if (!block) {\n      throw new Error(\n        'The current AST location is not associated with a block',\n      );\n    }\n    const curIdx = block.inputList.indexOf(input);\n    let fieldIdx = input.fieldRow.indexOf(location) + 1;\n    for (let i = curIdx; i < block.inputList.length; i++) {\n      const newInput = block.inputList[i];\n      const fieldRow = newInput.fieldRow;\n      while (fieldIdx < fieldRow.length) {\n        if (fieldRow[fieldIdx].isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(fieldRow[fieldIdx]);\n        }\n        fieldIdx++;\n      }\n      fieldIdx = 0;\n      if (newInput.connection) {\n        return ASTNode.createInputNode(newInput);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Given an input find the previous editable field or an input with a non null\n   * connection in the same block. The current location must be an input\n   * connection.\n   *\n   * @returns The AST node holding the previous field or connection.\n   */\n  private findPrevForInput(): ASTNode | null {\n    const location = this.location as Connection;\n    const parentInput = location.getParentInput();\n    const block = parentInput!.getSourceBlock();\n    // AnyDuringMigration because:  Argument of type 'Input | null' is not\n    // assignable to parameter of type 'Input'.\n    const curIdx = block!.inputList.indexOf(parentInput as AnyDuringMigration);\n    for (let i = curIdx; i >= 0; i--) {\n      const input = block!.inputList[i];\n      if (input.connection && input !== parentInput) {\n        return ASTNode.createInputNode(input);\n      }\n      const fieldRow = input.fieldRow;\n      for (let j = fieldRow.length - 1; j >= 0; j--) {\n        const field = fieldRow[j];\n        if (field.isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(field);\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Given a field find the previous editable field or an input with a non null\n   * connection in the same block. The current location must be a field.\n   *\n   * @returns The AST node holding the previous input or field.\n   */\n  private findPrevForField(): ASTNode | null {\n    const location = this.location as Field;\n    const parentInput = location.getParentInput();\n    const block = location.getSourceBlock();\n    if (!block) {\n      throw new Error(\n        'The current AST location is not associated with a block',\n      );\n    }\n    const curIdx = block.inputList.indexOf(parentInput);\n    let fieldIdx = parentInput.fieldRow.indexOf(location) - 1;\n    for (let i = curIdx; i >= 0; i--) {\n      const input = block.inputList[i];\n      if (input.connection && input !== parentInput) {\n        return ASTNode.createInputNode(input);\n      }\n      const fieldRow = input.fieldRow;\n      while (fieldIdx > -1) {\n        if (fieldRow[fieldIdx].isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(fieldRow[fieldIdx]);\n        }\n        fieldIdx--;\n      }\n      // Reset the fieldIdx to the length of the field row of the previous\n      // input.\n      if (i - 1 >= 0) {\n        fieldIdx = block.inputList[i - 1].fieldRow.length - 1;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Navigate between stacks of blocks on the workspace.\n   *\n   * @param forward True to go forward. False to go backwards.\n   * @returns The first block of the next stack or null if there are no blocks\n   *     on the workspace.\n   */\n  private navigateBetweenStacks(forward: boolean): ASTNode | null {\n    let curLocation = this.getLocation();\n    // TODO(#6097): Use instanceof checks to exit early for values of\n    // curLocation that don't make sense.\n    if ((curLocation as IASTNodeLocationWithBlock).getSourceBlock) {\n      const block = (curLocation as IASTNodeLocationWithBlock).getSourceBlock();\n      if (block) {\n        curLocation = block;\n      }\n    }\n    // TODO(#6097): Use instanceof checks to exit early for values of\n    // curLocation that don't make sense.\n    const curLocationAsBlock = curLocation as Block;\n    if (!curLocationAsBlock || curLocationAsBlock.isDeadOrDying()) {\n      return null;\n    }\n    if (curLocationAsBlock.workspace.isFlyout) {\n      return this.navigateFlyoutContents(forward);\n    }\n    const curRoot = curLocationAsBlock.getRootBlock();\n    const topBlocks = curRoot.workspace.getTopBlocks(true);\n    for (let i = 0; i < topBlocks.length; i++) {\n      const topBlock = topBlocks[i];\n      if (curRoot.id === topBlock.id) {\n        const offset = forward ? 1 : -1;\n        const resultIndex = i + offset;\n        if (resultIndex === -1 || resultIndex === topBlocks.length) {\n          return null;\n        }\n        return ASTNode.createStackNode(topBlocks[resultIndex]);\n      }\n    }\n    throw Error(\n      \"Couldn't find \" + (forward ? 'next' : 'previous') + ' stack?!',\n    );\n  }\n\n  /**\n   * Navigate between buttons and stacks of blocks on the flyout workspace.\n   *\n   * @param forward True to go forward. False to go backwards.\n   * @returns The next button, or next stack's first block, or null\n   */\n  private navigateFlyoutContents(forward: boolean): ASTNode | null {\n    const nodeType = this.getType();\n    let location;\n    let targetWorkspace;\n\n    switch (nodeType) {\n      case ASTNode.types.STACK: {\n        location = this.getLocation() as Block;\n        const workspace = location.workspace as WorkspaceSvg;\n        targetWorkspace = workspace.targetWorkspace as WorkspaceSvg;\n        break;\n      }\n      case ASTNode.types.BUTTON: {\n        location = this.getLocation() as FlyoutButton;\n        targetWorkspace = location.getTargetWorkspace() as WorkspaceSvg;\n        break;\n      }\n      default:\n        return null;\n    }\n\n    const flyout = targetWorkspace.getFlyout();\n    if (!flyout) return null;\n\n    const nextItem = this.findNextLocationInFlyout(\n      flyout.getContents(),\n      location,\n      forward,\n    );\n    if (!nextItem) return null;\n\n    if (nextItem.type === 'button' && nextItem.button) {\n      return ASTNode.createButtonNode(nextItem.button);\n    } else if (nextItem.type === 'block' && nextItem.block) {\n      return ASTNode.createStackNode(nextItem.block);\n    }\n\n    return null;\n  }\n\n  /**\n   * Finds the next (or previous if navigating backward) item in the flyout that should be navigated to.\n   *\n   * @param flyoutContents Contents of the current flyout.\n   * @param currentLocation Current ASTNode location.\n   * @param forward True if we're navigating forward, else false.\n   * @returns The next (or previous) FlyoutItem, or null if there is none.\n   */\n  private findNextLocationInFlyout(\n    flyoutContents: FlyoutItem[],\n    currentLocation: IASTNodeLocation,\n    forward: boolean,\n  ): FlyoutItem | null {\n    const currentIndex = flyoutContents.findIndex((item: FlyoutItem) => {\n      if (currentLocation instanceof Block && item.block === currentLocation) {\n        return true;\n      }\n      if (\n        currentLocation instanceof FlyoutButton &&\n        item.button === currentLocation\n      ) {\n        return true;\n      }\n      return false;\n    });\n\n    if (currentIndex < 0) return null;\n\n    const resultIndex = forward ? currentIndex + 1 : currentIndex - 1;\n    if (resultIndex === -1 || resultIndex === flyoutContents.length) {\n      return null;\n    }\n\n    return flyoutContents[resultIndex];\n  }\n\n  /**\n   * Finds the top most AST node for a given block.\n   * This is either the previous connection, output connection or block\n   * depending on what kind of connections the block has.\n   *\n   * @param block The block that we want to find the top connection on.\n   * @returns The AST node containing the top connection.\n   */\n  private findTopASTNodeForBlock(block: Block): ASTNode | null {\n    const topConnection = getParentConnection(block);\n    if (topConnection) {\n      return ASTNode.createConnectionNode(topConnection);\n    } else {\n      return ASTNode.createBlockNode(block);\n    }\n  }\n\n  /**\n   * Get the AST node pointing to the input that the block is nested under or if\n   * the block is not nested then get the stack AST node.\n   *\n   * @param block The source block of the current location.\n   * @returns The AST node pointing to the input connection or the top block of\n   *     the stack this block is in.\n   */\n  private getOutAstNodeForBlock(block: Block): ASTNode | null {\n    if (!block) {\n      return null;\n    }\n    // If the block doesn't have a previous connection then it is the top of the\n    // substack.\n    const topBlock = block.getTopStackBlock();\n    const topConnection = getParentConnection(topBlock);\n    // If the top connection has a parentInput, create an AST node pointing to\n    // that input.\n    if (\n      topConnection &&\n      topConnection.targetConnection &&\n      topConnection.targetConnection.getParentInput()\n    ) {\n      // AnyDuringMigration because:  Argument of type 'Input | null' is not\n      // assignable to parameter of type 'Input'.\n      return ASTNode.createInputNode(\n        topConnection.targetConnection.getParentInput() as AnyDuringMigration,\n      );\n    } else {\n      // Go to stack level if you are not underneath an input.\n      return ASTNode.createStackNode(topBlock);\n    }\n  }\n\n  /**\n   * Find the first editable field or input with a connection on a given block.\n   *\n   * @param block The source block of the current location.\n   * @returns An AST node pointing to the first field or input.\n   * Null if there are no editable fields or inputs with connections on the\n   * block.\n   */\n  private findFirstFieldOrInput(block: Block): ASTNode | null {\n    const inputs = block.inputList;\n    for (let i = 0; i < inputs.length; i++) {\n      const input = inputs[i];\n      const fieldRow = input.fieldRow;\n      for (let j = 0; j < fieldRow.length; j++) {\n        const field = fieldRow[j];\n        if (field.isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(field);\n        }\n      }\n      if (input.connection) {\n        return ASTNode.createInputNode(input);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Finds the source block of the location of this node.\n   *\n   * @returns The source block of the location, or null if the node is of type\n   *     workspace or button.\n   */\n  getSourceBlock(): Block | null {\n    if (this.getType() === ASTNode.types.BLOCK) {\n      return this.getLocation() as Block;\n    } else if (this.getType() === ASTNode.types.STACK) {\n      return this.getLocation() as Block;\n    } else if (this.getType() === ASTNode.types.WORKSPACE) {\n      return null;\n    } else if (this.getType() === ASTNode.types.BUTTON) {\n      return null;\n    } else {\n      return (this.getLocation() as IASTNodeLocationWithBlock).getSourceBlock();\n    }\n  }\n\n  /**\n   * Find the element to the right of the current element in the AST.\n   *\n   * @returns An AST node that wraps the next field, connection, block, or\n   *     workspace. Or null if there is no node to the right.\n   */\n  next(): ASTNode | null {\n    switch (this.type) {\n      case ASTNode.types.STACK:\n        return this.navigateBetweenStacks(true);\n\n      case ASTNode.types.OUTPUT: {\n        const connection = this.location as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.FIELD:\n        return this.findNextForField();\n\n      case ASTNode.types.INPUT:\n        return this.findNextForInput();\n\n      case ASTNode.types.BLOCK: {\n        const block = this.location as Block;\n        const nextConnection = block.nextConnection;\n        if (!nextConnection) return null;\n        return ASTNode.createConnectionNode(nextConnection);\n      }\n      case ASTNode.types.PREVIOUS: {\n        const connection = this.location as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.NEXT: {\n        const connection = this.location as Connection;\n        const targetConnection = connection.targetConnection;\n        return ASTNode.createConnectionNode(targetConnection!);\n      }\n      case ASTNode.types.BUTTON:\n        return this.navigateFlyoutContents(true);\n    }\n\n    return null;\n  }\n\n  /**\n   * Find the element one level below and all the way to the left of the current\n   * location.\n   *\n   * @returns An AST node that wraps the next field, connection, workspace, or\n   *     block. Or null if there is nothing below this node.\n   */\n  in(): ASTNode | null {\n    switch (this.type) {\n      case ASTNode.types.WORKSPACE: {\n        const workspace = this.location as Workspace;\n        const topBlocks = workspace.getTopBlocks(true);\n        if (topBlocks.length > 0) {\n          return ASTNode.createStackNode(topBlocks[0]);\n        }\n        break;\n      }\n      case ASTNode.types.STACK: {\n        const block = this.location as Block;\n        return this.findTopASTNodeForBlock(block);\n      }\n      case ASTNode.types.BLOCK: {\n        const block = this.location as Block;\n        return this.findFirstFieldOrInput(block);\n      }\n      case ASTNode.types.INPUT: {\n        const connection = this.location as Connection;\n        const targetConnection = connection.targetConnection;\n        return ASTNode.createConnectionNode(targetConnection!);\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Find the element to the left of the current element in the AST.\n   *\n   * @returns An AST node that wraps the previous field, connection, workspace\n   *     or block. Or null if no node exists to the left. null.\n   */\n  prev(): ASTNode | null {\n    switch (this.type) {\n      case ASTNode.types.STACK:\n        return this.navigateBetweenStacks(false);\n\n      case ASTNode.types.OUTPUT:\n        return null;\n\n      case ASTNode.types.FIELD:\n        return this.findPrevForField();\n\n      case ASTNode.types.INPUT:\n        return this.findPrevForInput();\n\n      case ASTNode.types.BLOCK: {\n        const block = this.location as Block;\n        const topConnection = getParentConnection(block);\n        if (!topConnection) return null;\n        return ASTNode.createConnectionNode(topConnection);\n      }\n      case ASTNode.types.PREVIOUS: {\n        const connection = this.location as Connection;\n        const targetConnection = connection.targetConnection;\n        if (targetConnection && !targetConnection.getParentInput()) {\n          return ASTNode.createConnectionNode(targetConnection);\n        }\n        break;\n      }\n      case ASTNode.types.NEXT: {\n        const connection = this.location as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.BUTTON:\n        return this.navigateFlyoutContents(false);\n    }\n\n    return null;\n  }\n\n  /**\n   * Find the next element that is one position above and all the way to the\n   * left of the current location.\n   *\n   * @returns An AST node that wraps the next field, connection, workspace or\n   *     block. Or null if we are at the workspace level.\n   */\n  out(): ASTNode | null {\n    switch (this.type) {\n      case ASTNode.types.STACK: {\n        const block = this.location as Block;\n        const blockPos = block.getRelativeToSurfaceXY();\n        // TODO: Make sure this is in the bounds of the workspace.\n        const wsCoordinate = new Coordinate(\n          blockPos.x,\n          blockPos.y + ASTNode.DEFAULT_OFFSET_Y,\n        );\n        return ASTNode.createWorkspaceNode(block.workspace, wsCoordinate);\n      }\n      case ASTNode.types.OUTPUT: {\n        const connection = this.location as Connection;\n        const target = connection.targetConnection;\n        if (target) {\n          return ASTNode.createConnectionNode(target);\n        }\n        return ASTNode.createStackNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.FIELD: {\n        const field = this.location as Field;\n        const block = field.getSourceBlock();\n        if (!block) {\n          throw new Error(\n            'The current AST location is not associated with a block',\n          );\n        }\n        return ASTNode.createBlockNode(block);\n      }\n      case ASTNode.types.INPUT: {\n        const connection = this.location as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.BLOCK: {\n        const block = this.location as Block;\n        return this.getOutAstNodeForBlock(block);\n      }\n      case ASTNode.types.PREVIOUS: {\n        const connection = this.location as Connection;\n        return this.getOutAstNodeForBlock(connection.getSourceBlock());\n      }\n      case ASTNode.types.NEXT: {\n        const connection = this.location as Connection;\n        return this.getOutAstNodeForBlock(connection.getSourceBlock());\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Whether an AST node of the given type points to a connection.\n   *\n   * @param type The type to check.  One of ASTNode.types.\n   * @returns True if a node of the given type points to a connection.\n   */\n  private static isConnectionType(type: string): boolean {\n    switch (type) {\n      case ASTNode.types.PREVIOUS:\n      case ASTNode.types.NEXT:\n      case ASTNode.types.INPUT:\n      case ASTNode.types.OUTPUT:\n        return true;\n    }\n    return false;\n  }\n\n  /**\n   * Create an AST node pointing to a field.\n   *\n   * @param field The location of the AST node.\n   * @returns An AST node pointing to a field.\n   */\n  static createFieldNode(field: Field): ASTNode | null {\n    if (!field) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.FIELD, field);\n  }\n\n  /**\n   * Creates an AST node pointing to a connection. If the connection has a\n   * parent input then create an AST node of type input that will hold the\n   * connection.\n   *\n   * @param connection This is the connection the node will point to.\n   * @returns An AST node pointing to a connection.\n   */\n  static createConnectionNode(connection: Connection): ASTNode | null {\n    if (!connection) {\n      return null;\n    }\n    const type = connection.type;\n    if (type === ConnectionType.INPUT_VALUE) {\n      // AnyDuringMigration because:  Argument of type 'Input | null' is not\n      // assignable to parameter of type 'Input'.\n      return ASTNode.createInputNode(\n        connection.getParentInput() as AnyDuringMigration,\n      );\n    } else if (\n      type === ConnectionType.NEXT_STATEMENT &&\n      connection.getParentInput()\n    ) {\n      // AnyDuringMigration because:  Argument of type 'Input | null' is not\n      // assignable to parameter of type 'Input'.\n      return ASTNode.createInputNode(\n        connection.getParentInput() as AnyDuringMigration,\n      );\n    } else if (type === ConnectionType.NEXT_STATEMENT) {\n      return new ASTNode(ASTNode.types.NEXT, connection);\n    } else if (type === ConnectionType.OUTPUT_VALUE) {\n      return new ASTNode(ASTNode.types.OUTPUT, connection);\n    } else if (type === ConnectionType.PREVIOUS_STATEMENT) {\n      return new ASTNode(ASTNode.types.PREVIOUS, connection);\n    }\n    return null;\n  }\n\n  /**\n   * Creates an AST node pointing to an input. Stores the input connection as\n   * the location.\n   *\n   * @param input The input used to create an AST node.\n   * @returns An AST node pointing to a input.\n   */\n  static createInputNode(input: Input): ASTNode | null {\n    if (!input || !input.connection) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.INPUT, input.connection);\n  }\n\n  /**\n   * Creates an AST node pointing to a block.\n   *\n   * @param block The block used to create an AST node.\n   * @returns An AST node pointing to a block.\n   */\n  static createBlockNode(block: Block): ASTNode | null {\n    if (!block) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.BLOCK, block);\n  }\n\n  /**\n   * Create an AST node of type stack. A stack, represented by its top block, is\n   *     the set of all blocks connected to a top block, including the top\n   * block.\n   *\n   * @param topBlock A top block has no parent and can be found in the list\n   *     returned by workspace.getTopBlocks().\n   * @returns An AST node of type stack that points to the top block on the\n   *     stack.\n   */\n  static createStackNode(topBlock: Block): ASTNode | null {\n    if (!topBlock) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.STACK, topBlock);\n  }\n\n  /**\n   * Create an AST node of type button. A button in this case refers\n   * specifically to a button in a flyout.\n   *\n   * @param button A top block has no parent and can be found in the list\n   *     returned by workspace.getTopBlocks().\n   * @returns An AST node of type stack that points to the top block on the\n   *     stack.\n   */\n  static createButtonNode(button: FlyoutButton): ASTNode | null {\n    if (!button) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.BUTTON, button);\n  }\n\n  /**\n   * Creates an AST node pointing to a workspace.\n   *\n   * @param workspace The workspace that we are on.\n   * @param wsCoordinate The position on the workspace for this node.\n   * @returns An AST node pointing to a workspace and a position on the\n   *     workspace.\n   */\n  static createWorkspaceNode(\n    workspace: Workspace | null,\n    wsCoordinate: Coordinate | null,\n  ): ASTNode | null {\n    if (!wsCoordinate || !workspace) {\n      return null;\n    }\n    const params = {wsCoordinate};\n    return new ASTNode(ASTNode.types.WORKSPACE, workspace, params);\n  }\n\n  /**\n   * Creates an AST node for the top position on a block.\n   * This is either an output connection, previous connection, or block.\n   *\n   * @param block The block to find the top most AST node on.\n   * @returns The AST node holding the top most position on the block.\n   */\n  static createTopNode(block: Block): ASTNode | null {\n    let astNode;\n    const topConnection = getParentConnection(block);\n    if (topConnection) {\n      astNode = ASTNode.createConnectionNode(topConnection);\n    } else {\n      astNode = ASTNode.createBlockNode(block);\n    }\n    return astNode;\n  }\n}\n\nexport namespace ASTNode {\n  export interface Params {\n    wsCoordinate: Coordinate;\n  }\n\n  export enum types {\n    FIELD = 'field',\n    BLOCK = 'block',\n    INPUT = 'input',\n    OUTPUT = 'output',\n    NEXT = 'next',\n    PREVIOUS = 'previous',\n    STACK = 'stack',\n    WORKSPACE = 'workspace',\n    BUTTON = 'button',\n  }\n}\n\nexport type Params = ASTNode.Params;\n// No need to export ASTNode.types from the module at this time because (1) it\n// wasn't automatically converted by the automatic migration script, (2) the\n// name doesn't follow the styleguide.\n\n/**\n * Gets the parent connection on a block.\n * This is either an output connection, previous connection or undefined.\n * If both connections exist return the one that is actually connected\n * to another block.\n *\n * @param block The block to find the parent connection on.\n * @returns The connection connecting to the parent of the block.\n */\nfunction getParentConnection(block: Block): Connection | null {\n  let topConnection = block.outputConnection;\n  if (\n    !topConnection ||\n    (block.previousConnection && block.previousConnection.isConnected())\n  ) {\n    topConnection = block.previousConnection;\n  }\n  return topConnection;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering\n\nimport * as registry from '../../registry.js';\nimport type {Theme} from '../../theme.js';\nimport {Measurable} from '../measurables/base.js';\nimport {BottomRow} from '../measurables/bottom_row.js';\nimport {Connection} from '../measurables/connection.js';\nimport {ExternalValueInput} from '../measurables/external_value_input.js';\nimport {Field} from '../measurables/field.js';\nimport {Hat} from '../measurables/hat.js';\nimport {Icon} from '../measurables/icon.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport {InlineInput} from '../measurables/inline_input.js';\nimport {InputConnection} from '../measurables/input_connection.js';\nimport {InputRow} from '../measurables/input_row.js';\nimport {JaggedEdge} from '../measurables/jagged_edge.js';\nimport {NextConnection} from '../measurables/next_connection.js';\nimport {OutputConnection} from '../measurables/output_connection.js';\nimport {PreviousConnection} from '../measurables/previous_connection.js';\nimport {RoundCorner} from '../measurables/round_corner.js';\nimport {Row} from '../measurables/row.js';\nimport {SpacerRow} from '../measurables/spacer_row.js';\nimport {SquareCorner} from '../measurables/square_corner.js';\nimport {StatementInput} from '../measurables/statement_input.js';\nimport {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport {Drawer} from './drawer.js';\nimport type {IPathObject} from './i_path_object.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {PathObject} from './path_object.js';\nimport {Renderer} from './renderer.js';\n\n/**\n * Registers a new renderer.\n *\n * @param name The name of the renderer.\n * @param rendererClass The new renderer class to register.\n * @throws {Error} if a renderer with the same name has already been registered.\n */\nexport function register(name: string, rendererClass: Function) {\n  registry.register(registry.Type.RENDERER, name, rendererClass);\n}\n\n/**\n * Unregisters the renderer registered with the given name.\n *\n * @param name The name of the renderer.\n */\nexport function unregister(name: string) {\n  registry.unregister(registry.Type.RENDERER, name);\n}\n\n/**\n * Initialize anything needed for rendering (constants, etc).\n *\n * @param name Name of the renderer to initialize.\n * @param theme The workspace theme object.\n * @param opt_rendererOverrides Rendering constant overrides.\n * @returns The new instance of a renderer.\n *     Already initialized.\n * @internal\n */\nexport function init(\n  name: string,\n  theme: Theme,\n  opt_rendererOverrides?: {[rendererConstant: string]: any},\n): Renderer {\n  const rendererClass = registry.getClass(registry.Type.RENDERER, name);\n  const renderer = new rendererClass!(name);\n  renderer.init(theme, opt_rendererOverrides);\n  return renderer;\n}\nexport {BottomRow};\nexport {Connection};\nexport {Drawer};\nexport {ExternalValueInput};\nexport {Field};\nexport {Hat};\nexport {Icon};\nexport {InRowSpacer};\nexport {InlineInput};\nexport {InputConnection};\nexport {InputRow};\nexport {IPathObject};\nexport {JaggedEdge};\nexport {MarkerSvg};\nexport {Measurable};\nexport {NextConnection};\nexport {OutputConnection};\nexport {PathObject};\nexport {PreviousConnection};\nexport {Renderer};\nexport {RenderInfo};\nexport {RoundCorner};\nexport {Row};\nexport {SpacerRow};\nexport {SquareCorner};\nexport {StatementInput};\nexport {TopRow};\nexport {Types};\n\nexport {\n  OutsideCorners,\n  InsideCorners,\n  StartHat,\n  Notch,\n  PuzzleTab,\n  JaggedTeeth,\n  BaseShape,\n  DynamicShape,\n  ConstantProvider,\n} from './constants.js';\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.VariablesDynamic\n\nimport {Blocks} from './blocks.js';\nimport {Msg} from './msg.js';\nimport * as xml from './utils/xml.js';\nimport {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport type {FlyoutButton} from './flyout_button.js';\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n * See also Blockly.Variables.CATEGORY_NAME and\n * Blockly.Procedures.CATEGORY_NAME.\n */\nexport const CATEGORY_NAME = 'VARIABLE_DYNAMIC';\n\n/**\n * Click handler for a button that creates String variables.\n *\n * @param button\n */\nfunction stringButtonClickHandler(button: FlyoutButton) {\n  Variables.createVariableButtonHandler(\n    button.getTargetWorkspace(),\n    undefined,\n    'String',\n  );\n}\n// eslint-disable-next-line camelcase\nexport const onCreateVariableButtonClick_String = stringButtonClickHandler;\n\n/**\n * Click handler for a button that creates Number variables.\n *\n * @param button\n */\nfunction numberButtonClickHandler(button: FlyoutButton) {\n  Variables.createVariableButtonHandler(\n    button.getTargetWorkspace(),\n    undefined,\n    'Number',\n  );\n}\n// eslint-disable-next-line camelcase\nexport const onCreateVariableButtonClick_Number = numberButtonClickHandler;\n\n/**\n * Click handler for a button that creates Colour variables.\n *\n * @param button\n */\nfunction colourButtonClickHandler(button: FlyoutButton) {\n  Variables.createVariableButtonHandler(\n    button.getTargetWorkspace(),\n    undefined,\n    'Colour',\n  );\n}\n// eslint-disable-next-line camelcase\nexport const onCreateVariableButtonClick_Colour = colourButtonClickHandler;\n\n/**\n * Construct the elements (blocks and button) required by the flyout for the\n * variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML elements.\n */\nexport function flyoutCategory(workspace: WorkspaceSvg): Element[] {\n  let xmlList = new Array<Element>();\n  let button = document.createElement('button');\n  button.setAttribute('text', Msg['NEW_STRING_VARIABLE']);\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE_STRING');\n  xmlList.push(button);\n  button = document.createElement('button');\n  button.setAttribute('text', Msg['NEW_NUMBER_VARIABLE']);\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE_NUMBER');\n  xmlList.push(button);\n  button = document.createElement('button');\n  button.setAttribute('text', Msg['NEW_COLOUR_VARIABLE']);\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE_COLOUR');\n  xmlList.push(button);\n\n  workspace.registerButtonCallback(\n    'CREATE_VARIABLE_STRING',\n    stringButtonClickHandler,\n  );\n  workspace.registerButtonCallback(\n    'CREATE_VARIABLE_NUMBER',\n    numberButtonClickHandler,\n  );\n  workspace.registerButtonCallback(\n    'CREATE_VARIABLE_COLOUR',\n    colourButtonClickHandler,\n  );\n\n  const blockList = flyoutCategoryBlocks(workspace);\n  xmlList = xmlList.concat(blockList);\n  return xmlList;\n}\n\n/**\n * Construct the blocks required by the flyout for the variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML block elements.\n */\nexport function flyoutCategoryBlocks(workspace: Workspace): Element[] {\n  const variableModelList = workspace.getAllVariables();\n\n  const xmlList = [];\n  if (variableModelList.length > 0) {\n    if (Blocks['variables_set_dynamic']) {\n      const firstVariable = variableModelList[variableModelList.length - 1];\n      const block = xml.createElement('block');\n      block.setAttribute('type', 'variables_set_dynamic');\n      block.setAttribute('gap', '24');\n      block.appendChild(Variables.generateVariableFieldDom(firstVariable));\n      xmlList.push(block);\n    }\n    if (Blocks['variables_get_dynamic']) {\n      variableModelList.sort(VariableModel.compareByName);\n      for (let i = 0, variable; (variable = variableModelList[i]); i++) {\n        const block = xml.createElement('block');\n        block.setAttribute('type', 'variables_get_dynamic');\n        block.setAttribute('gap', '8');\n        block.appendChild(Variables.generateVariableFieldDom(variable));\n        xmlList.push(block);\n      }\n    }\n  }\n  return xmlList;\n}\n","/**\n * @license\n * Copyright 2014 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a workspace rendered as SVG.\n *\n * @class\n */\n// Former goog.module ID: Blockly.WorkspaceSvg\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_create.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_theme_change.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_viewport.js';\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {ConnectionDB} from './connection_db.js';\nimport * as ContextMenu from './contextmenu.js';\nimport {ContextMenuRegistry} from './contextmenu_registry.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport type {FlyoutButton} from './flyout_button.js';\nimport {Gesture} from './gesture.js';\nimport {Grid} from './grid.js';\nimport type {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport type {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport type {IToolbox} from './interfaces/i_toolbox.js';\nimport type {Cursor} from './keyboard_nav/cursor.js';\nimport type {Marker} from './keyboard_nav/marker.js';\nimport {MarkerManager} from './marker_manager.js';\nimport {Options} from './options.js';\nimport * as Procedures from './procedures.js';\nimport * as registry from './registry.js';\nimport * as blockRendering from './renderers/common/block_rendering.js';\nimport type {Renderer} from './renderers/common/renderer.js';\nimport type {ScrollbarPair} from './scrollbar_pair.js';\nimport type {Theme} from './theme.js';\nimport {Classic} from './theme/classic.js';\nimport {ThemeManager} from './theme_manager.js';\nimport * as Tooltip from './tooltip.js';\nimport type {Trashcan} from './trashcan.js';\nimport * as arrayUtils from './utils/array.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as userAgent from './utils/useragent.js';\nimport type {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport * as VariablesDynamic from './variables_dynamic.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport {Workspace} from './workspace.js';\nimport {WorkspaceAudio} from './workspace_audio.js';\nimport {WorkspaceComment} from './comments/workspace_comment.js';\nimport {ZoomControls} from './zoom_controls.js';\nimport {ContextMenuOption} from './contextmenu_registry.js';\nimport * as renderManagement from './render_management.js';\nimport {LayerManager} from './layer_manager.js';\nimport {RenderedWorkspaceComment} from './comments/rendered_workspace_comment.js';\n\n/** Margin around the top/bottom/left/right after a zoomToFit call. */\nconst ZOOM_TO_FIT_MARGIN = 20;\n\n/**\n * Class for a workspace.  This is an onscreen area with optional trashcan,\n * scrollbars, bubbles, and dragging.\n */\nexport class WorkspaceSvg extends Workspace implements IASTNodeLocationSvg {\n  /**\n   * A wrapper function called when a resize event occurs.\n   * You can pass the result to `eventHandling.unbind`.\n   */\n  private resizeHandlerWrapper: browserEvents.Data | null = null;\n\n  /**\n   * The render status of an SVG workspace.\n   * Returns `false` for headless workspaces and true for instances of\n   * `WorkspaceSvg`.\n   */\n  override rendered = true;\n\n  /**\n   * Whether the workspace is visible.  False if the workspace has been hidden\n   * by calling `setVisible(false)`.\n   */\n  private isVisible_ = true;\n\n  /**\n   * Whether this workspace has resizes enabled.\n   * Disable during batch operations for a performance improvement.\n   */\n  private resizesEnabled = true;\n\n  /**\n   * Current horizontal scrolling offset in pixel units, relative to the\n   * workspace origin.\n   *\n   * It is useful to think about a view, and a canvas moving beneath that\n   * view. As the canvas moves right, this value becomes more positive, and\n   * the view is now \"seeing\" the left side of the canvas. As the canvas moves\n   * left, this value becomes more negative, and the view is now \"seeing\" the\n   * right side of the canvas.\n   *\n   * The confusing thing about this value is that it does not, and must not\n   * include the absoluteLeft offset. This is because it is used to calculate\n   * the viewLeft value.\n   *\n   * The viewLeft is relative to the workspace origin (although in pixel\n   * units). The workspace origin is the top-left corner of the workspace (at\n   * least when it is enabled). It is shifted from the top-left of the\n   * blocklyDiv so as not to be beneath the toolbox.\n   *\n   * When the workspace is enabled the viewLeft and workspace origin are at\n   * the same X location. As the canvas slides towards the right beneath the\n   * view this value (scrollX) becomes more positive, and the viewLeft becomes\n   * more negative relative to the workspace origin (imagine the workspace\n   * origin as a dot on the canvas sliding to the right as the canvas moves).\n   *\n   * So if the scrollX were to include the absoluteLeft this would in a way\n   * \"unshift\" the workspace origin. This means that the viewLeft would be\n   * representing the left edge of the blocklyDiv, rather than the left edge\n   * of the workspace.\n   */\n  scrollX = 0;\n\n  /**\n   * Current vertical scrolling offset in pixel units, relative to the\n   * workspace origin.\n   *\n   * It is useful to think about a view, and a canvas moving beneath that\n   * view. As the canvas moves down, this value becomes more positive, and the\n   * view is now \"seeing\" the upper part of the canvas. As the canvas moves\n   * up, this value becomes more negative, and the view is \"seeing\" the lower\n   * part of the canvas.\n   *\n   * This confusing thing about this value is that it does not, and must not\n   * include the absoluteTop offset. This is because it is used to calculate\n   * the viewTop value.\n   *\n   * The viewTop is relative to the workspace origin (although in pixel\n   * units). The workspace origin is the top-left corner of the workspace (at\n   * least when it is enabled). It is shifted from the top-left of the\n   * blocklyDiv so as not to be beneath the toolbox.\n   *\n   * When the workspace is enabled the viewTop and workspace origin are at the\n   * same Y location. As the canvas slides towards the bottom this value\n   * (scrollY) becomes more positive, and the viewTop becomes more negative\n   * relative to the workspace origin (image in the workspace origin as a dot\n   * on the canvas sliding downwards as the canvas moves).\n   *\n   * So if the scrollY were to include the absoluteTop this would in a way\n   * \"unshift\" the workspace origin. This means that the viewTop would be\n   * representing the top edge of the blocklyDiv, rather than the top edge of\n   * the workspace.\n   */\n  scrollY = 0;\n\n  /** Horizontal scroll value when scrolling started in pixel units. */\n  startScrollX = 0;\n\n  /** Vertical scroll value when scrolling started in pixel units. */\n  startScrollY = 0;\n\n  /** Distance from mouse to object being dragged. */\n  private dragDeltaXY: Coordinate | null = null;\n\n  /** Current scale. */\n  scale = 1;\n\n  /** Cached scale value. Used to detect changes in viewport. */\n  private oldScale = 1;\n\n  /** Cached viewport top value. Used to detect changes in viewport. */\n  private oldTop = 0;\n\n  /** Cached viewport left value. Used to detect changes in viewport. */\n  private oldLeft = 0;\n\n  /** The workspace's trashcan (if any). */\n  trashcan: Trashcan | null = null;\n\n  /** This workspace's scrollbars, if they exist. */\n  scrollbar: ScrollbarPair | null = null;\n\n  /**\n   * Fixed flyout providing blocks which may be dragged into this workspace.\n   */\n  private flyout: IFlyout | null = null;\n\n  /**\n   * Category-based toolbox providing blocks which may be dragged into this\n   * workspace.\n   */\n  private toolbox_: IToolbox | null = null;\n\n  /**\n   * The current gesture in progress on this workspace, if any.\n   *\n   * @internal\n   */\n  currentGesture_: Gesture | null = null;\n\n  /**\n   * The first parent div with 'injectionDiv' in the name, or null if not set.\n   * Access this with getInjectionDiv.\n   */\n  private injectionDiv: Element | null = null;\n\n  /**\n   * Last known position of the page scroll.\n   * This is used to determine whether we have recalculated screen coordinate\n   * stuff since the page scrolled.\n   */\n  private lastRecordedPageScroll: Coordinate | null = null;\n\n  /**\n   * Developers may define this function to add custom menu options to the\n   * workspace's context menu or edit the workspace-created set of menu\n   * options.\n   *\n   * @param options List of menu options to add to.\n   * @param e The right-click event that triggered the context menu.\n   */\n  configureContextMenu:\n    | ((menuOptions: ContextMenuOption[], e: Event) => void)\n    | null = null;\n\n  /**\n   * A dummy wheel event listener used as a workaround for a Safari scrolling issue.\n   * Set in createDom and used for removal in dispose to ensure proper cleanup.\n   */\n  private dummyWheelListener: (() => void) | null = null;\n\n  /**\n   * In a flyout, the target workspace where blocks should be placed after a\n   * drag. Otherwise null.\n   *\n   * @internal\n   */\n  targetWorkspace: WorkspaceSvg | null = null;\n\n  /** Inverted screen CTM, for use in mouseToSvg. */\n  private inverseScreenCTM: SVGMatrix | null = null;\n\n  /** Inverted screen CTM is dirty, recalculate it. */\n  private inverseScreenCTMDirty = true;\n  private metricsManager: IMetricsManager;\n  /** @internal */\n  getMetrics: () => Metrics;\n  /** @internal */\n  setMetrics: (p1: {x?: number; y?: number}) => void;\n  private readonly componentManager: ComponentManager;\n\n  /**\n   * List of currently highlighted blocks.  Block highlighting is often used\n   * to visually mark blocks currently being executed.\n   */\n  private readonly highlightedBlocks: BlockSvg[] = [];\n  private audioManager: WorkspaceAudio;\n  private grid: Grid | null;\n  private markerManager: MarkerManager;\n\n  /**\n   * Map from function names to callbacks, for deciding what to do when a\n   * custom toolbox category is opened.\n   */\n  private toolboxCategoryCallbacks = new Map<\n    string,\n    (p1: WorkspaceSvg) => toolbox.FlyoutDefinition\n  >();\n\n  /**\n   * Map from function names to callbacks, for deciding what to do when a\n   * button is clicked.\n   */\n  private flyoutButtonCallbacks = new Map<string, (p1: FlyoutButton) => void>();\n  protected themeManager_: ThemeManager;\n  private readonly renderer: Renderer;\n\n  /** Cached parent SVG. */\n  private cachedParentSvg: SVGElement | null = null;\n\n  /** True if keyboard accessibility mode is on, false otherwise. */\n  keyboardAccessibilityMode = false;\n\n  /** The list of top-level bounded elements on the workspace. */\n  private topBoundedElements: IBoundedElement[] = [];\n\n  /** The recorded drag targets. */\n  private dragTargetAreas: Array<{component: IDragTarget; clientRect: Rect}> =\n    [];\n  private readonly cachedParentSvgSize: Size;\n  private layerManager: LayerManager | null = null;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgGroup_!: SVGElement;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgBackground_!: SVGElement;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgBlockCanvas_!: SVGElement;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgBubbleCanvas_!: SVGElement;\n  zoomControls_: ZoomControls | null = null;\n\n  /**\n   * @param options Dictionary of options.\n   */\n  constructor(options: Options) {\n    super(options);\n\n    const MetricsManagerClass = registry.getClassFromOptions(\n      registry.Type.METRICS_MANAGER,\n      options,\n      true,\n    );\n    /** Object in charge of calculating metrics for the workspace. */\n    this.metricsManager = new MetricsManagerClass!(this);\n\n    /** Method to get all the metrics that have to do with a workspace. */\n    this.getMetrics =\n      options.getMetrics ||\n      this.metricsManager.getMetrics.bind(this.metricsManager);\n\n    /** Translates the workspace. */\n    this.setMetrics =\n      options.setMetrics || WorkspaceSvg.setTopLevelWorkspaceMetrics_;\n\n    this.componentManager = new ComponentManager();\n\n    this.connectionDBList = ConnectionDB.init(this.connectionChecker);\n\n    /**\n     * Object in charge of loading, storing, and playing audio for a workspace.\n     */\n    this.audioManager = new WorkspaceAudio(\n      options.parentWorkspace as WorkspaceSvg,\n    );\n\n    /** This workspace's grid object or null. */\n    this.grid = this.options.gridPattern\n      ? new Grid(this.options.gridPattern, options.gridOptions)\n      : null;\n\n    /** Manager in charge of markers and cursors. */\n    this.markerManager = new MarkerManager(this);\n\n    if (Variables && Variables.flyoutCategory) {\n      this.registerToolboxCategoryCallback(\n        Variables.CATEGORY_NAME,\n        Variables.flyoutCategory,\n      );\n    }\n\n    if (VariablesDynamic && VariablesDynamic.flyoutCategory) {\n      this.registerToolboxCategoryCallback(\n        VariablesDynamic.CATEGORY_NAME,\n        VariablesDynamic.flyoutCategory,\n      );\n    }\n\n    if (Procedures && Procedures.flyoutCategory) {\n      this.registerToolboxCategoryCallback(\n        Procedures.CATEGORY_NAME,\n        Procedures.flyoutCategory,\n      );\n      this.addChangeListener(Procedures.mutatorOpenListener);\n    }\n\n    /** Object in charge of storing and updating the workspace theme. */\n    this.themeManager_ = this.options.parentWorkspace\n      ? this.options.parentWorkspace.getThemeManager()\n      : new ThemeManager(this, this.options.theme || Classic);\n    this.themeManager_.subscribeWorkspace(this);\n\n    /** The block renderer used for rendering blocks on this workspace. */\n    this.renderer = blockRendering.init(\n      this.options.renderer || 'geras',\n      this.getTheme(),\n      this.options.rendererOverrides ?? undefined,\n    );\n\n    /**\n     * The cached size of the parent svg element.\n     * Used to compute svg metrics.\n     */\n    this.cachedParentSvgSize = new Size(0, 0);\n  }\n\n  /**\n   * Get the marker manager for this workspace.\n   *\n   * @returns The marker manager.\n   */\n  getMarkerManager(): MarkerManager {\n    return this.markerManager;\n  }\n\n  /**\n   * Gets the metrics manager for this workspace.\n   *\n   * @returns The metrics manager.\n   */\n  getMetricsManager(): IMetricsManager {\n    return this.metricsManager;\n  }\n\n  /**\n   * Sets the metrics manager for the workspace.\n   *\n   * @param metricsManager The metrics manager.\n   * @internal\n   */\n  setMetricsManager(metricsManager: IMetricsManager) {\n    this.metricsManager = metricsManager;\n    this.getMetrics = this.metricsManager.getMetrics.bind(this.metricsManager);\n  }\n\n  /**\n   * Gets the component manager for this workspace.\n   *\n   * @returns The component manager.\n   */\n  getComponentManager(): ComponentManager {\n    return this.componentManager;\n  }\n\n  /**\n   * Add the cursor SVG to this workspaces SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    this.markerManager.setCursorSvg(cursorSvg);\n  }\n\n  /**\n   * Add the marker SVG to this workspaces SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    this.markerManager.setMarkerSvg(markerSvg);\n  }\n\n  /**\n   * Get the marker with the given ID.\n   *\n   * @param id The ID of the marker.\n   * @returns The marker with the given ID or null if no marker with the given\n   *     ID exists.\n   * @internal\n   */\n  getMarker(id: string): Marker | null {\n    if (this.markerManager) {\n      return this.markerManager.getMarker(id);\n    }\n    return null;\n  }\n\n  /**\n   * The cursor for this workspace.\n   *\n   * @returns The cursor for the workspace.\n   */\n  getCursor(): Cursor | null {\n    if (this.markerManager) {\n      return this.markerManager.getCursor();\n    }\n    return null;\n  }\n\n  /**\n   * Get the block renderer attached to this workspace.\n   *\n   * @returns The renderer attached to this workspace.\n   */\n  getRenderer(): Renderer {\n    return this.renderer;\n  }\n\n  /**\n   * Get the theme manager for this workspace.\n   *\n   * @returns The theme manager for this workspace.\n   * @internal\n   */\n  getThemeManager(): ThemeManager {\n    return this.themeManager_;\n  }\n\n  /**\n   * Get the workspace theme object.\n   *\n   * @returns The workspace theme object.\n   */\n  getTheme(): Theme {\n    return this.themeManager_.getTheme();\n  }\n\n  /**\n   * Set the workspace theme object.\n   * If no theme is passed, default to the `Classic` theme.\n   *\n   * @param theme The workspace theme object.\n   */\n  setTheme(theme: Theme) {\n    if (!theme) {\n      theme = Classic as Theme;\n    }\n    this.themeManager_.setTheme(theme);\n  }\n\n  /**\n   * Refresh all blocks on the workspace after a theme update.\n   */\n  refreshTheme() {\n    if (this.svgGroup_) {\n      this.renderer.refreshDom(this.svgGroup_, this.getTheme());\n    }\n\n    // Update all blocks in workspace that have a style name.\n    this.updateBlockStyles_(\n      this.getAllBlocks(false).filter(function (block) {\n        return !!block.getStyleName();\n      }),\n    );\n\n    // Update current toolbox selection.\n    this.refreshToolboxSelection();\n    if (this.toolbox_) {\n      this.toolbox_.refreshTheme();\n    }\n\n    // Re-render if workspace is visible\n    if (this.isVisible()) {\n      this.setVisible(true);\n    }\n\n    const event = new (eventUtils.get(eventUtils.THEME_CHANGE))(\n      this.getTheme().name,\n      this.id,\n    );\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Updates all the blocks with new style.\n   *\n   * @param blocks List of blocks to update the style on.\n   */\n  private updateBlockStyles_(blocks: Block[]) {\n    for (let i = 0, block; (block = blocks[i]); i++) {\n      const blockStyleName = block.getStyleName();\n      if (blockStyleName) {\n        const blockSvg = block as BlockSvg;\n        blockSvg.setStyle(blockStyleName);\n      }\n    }\n  }\n\n  /**\n   * Getter for the inverted screen CTM.\n   *\n   * @returns The matrix to use in mouseToSvg\n   */\n  getInverseScreenCTM(): SVGMatrix | null {\n    // Defer getting the screen CTM until we actually need it, this should\n    // avoid forced reflows from any calls to updateInverseScreenCTM.\n    if (this.inverseScreenCTMDirty) {\n      const ctm = this.getParentSvg().getScreenCTM();\n      if (ctm) {\n        this.inverseScreenCTM = ctm.inverse();\n        this.inverseScreenCTMDirty = false;\n      }\n    }\n\n    return this.inverseScreenCTM;\n  }\n\n  /** Mark the inverse screen CTM as dirty. */\n  updateInverseScreenCTM() {\n    this.inverseScreenCTMDirty = true;\n  }\n\n  /**\n   * Getter for isVisible\n   *\n   * @returns Whether the workspace is visible.\n   *     False if the workspace has been hidden by calling `setVisible(false)`.\n   */\n  isVisible(): boolean {\n    return this.isVisible_;\n  }\n\n  /**\n   * Return the absolute coordinates of the top-left corner of this element,\n   * scales that after canvas SVG element, if it's a descendant.\n   * The origin (0,0) is the top-left corner of the Blockly SVG.\n   *\n   * @param element SVG element to find the coordinates of.\n   * @returns Object with .x and .y properties.\n   * @internal\n   */\n  getSvgXY(element: SVGElement): Coordinate {\n    let x = 0;\n    let y = 0;\n    let scale = 1;\n    if (\n      this.getCanvas().contains(element) ||\n      this.getBubbleCanvas().contains(element)\n    ) {\n      // Before the SVG canvas, scale the coordinates.\n      scale = this.scale;\n    }\n    do {\n      // Loop through this block and every parent.\n      const xy = svgMath.getRelativeXY(element);\n      if (element === this.getCanvas() || element === this.getBubbleCanvas()) {\n        // After the SVG canvas, don't scale the coordinates.\n        scale = 1;\n      }\n      x += xy.x * scale;\n      y += xy.y * scale;\n      element = element.parentNode as SVGElement;\n    } while (\n      element &&\n      element !== this.getParentSvg() &&\n      element !== this.getInjectionDiv()\n    );\n    return new Coordinate(x, y);\n  }\n\n  /**\n   * Gets the size of the workspace's parent SVG element.\n   *\n   * @returns The cached width and height of the workspace's parent SVG element.\n   * @internal\n   */\n  getCachedParentSvgSize(): Size {\n    const size = this.cachedParentSvgSize;\n    return new Size(size.width, size.height);\n  }\n\n  /**\n   * Return the position of the workspace origin relative to the injection div\n   * origin in pixels.\n   * The workspace origin is where a block would render at position (0, 0).\n   * It is not the upper left corner of the workspace SVG.\n   *\n   * @returns Offset in pixels.\n   * @internal\n   */\n  getOriginOffsetInPixels(): Coordinate {\n    return svgMath.getInjectionDivXY(this.getCanvas());\n  }\n\n  /**\n   * Return the injection div that is a parent of this workspace.\n   * Walks the DOM the first time it's called, then returns a cached value.\n   * Note: We assume this is only called after the workspace has been injected\n   * into the DOM.\n   *\n   * @returns The first parent div with 'injectionDiv' in the name.\n   * @internal\n   */\n  getInjectionDiv(): Element {\n    // NB: it would be better to pass this in at createDom, but is more likely\n    // to break existing uses of Blockly.\n    if (!this.injectionDiv) {\n      let element: Element = this.svgGroup_;\n      while (element) {\n        const classes = element.getAttribute('class') || '';\n        if ((' ' + classes + ' ').includes(' injectionDiv ')) {\n          this.injectionDiv = element;\n          break;\n        }\n        element = element.parentNode as Element;\n      }\n    }\n    return this.injectionDiv!;\n  }\n\n  /**\n   * Returns the SVG group for the workspace.\n   *\n   * @returns The SVG group for the workspace.\n   */\n  getSvgGroup(): Element {\n    return this.svgGroup_;\n  }\n\n  /**\n   * Get the SVG block canvas for the workspace.\n   *\n   * @returns The SVG group for the workspace.\n   * @internal\n   */\n  getBlockCanvas(): SVGElement | null {\n    return this.getCanvas();\n  }\n\n  /**\n   * Save resize handler data so we can delete it later in dispose.\n   *\n   * @param handler Data that can be passed to eventHandling.unbind.\n   */\n  setResizeHandlerWrapper(handler: browserEvents.Data) {\n    this.resizeHandlerWrapper = handler;\n  }\n\n  /**\n   * Create the workspace DOM elements.\n   *\n   * @param opt_backgroundClass Either 'blocklyMainBackground' or\n   *     'blocklyMutatorBackground'.\n   * @returns The workspace's SVG group.\n   */\n  createDom(opt_backgroundClass?: string, injectionDiv?: Element): Element {\n    if (!this.injectionDiv) {\n      this.injectionDiv = injectionDiv ?? null;\n    }\n\n    /**\n     * <g class=\"blocklyWorkspace\">\n     *   <rect class=\"blocklyMainBackground\" height=\"100%\" width=\"100%\"></rect>\n     *   [Trashcan and/or flyout may go here]\n     *   <g class=\"blocklyBlockCanvas\"></g>\n     *   <g class=\"blocklyBubbleCanvas\"></g>\n     * </g>\n     */\n    this.svgGroup_ = dom.createSvgElement(Svg.G, {'class': 'blocklyWorkspace'});\n\n    // Note that a <g> alone does not receive mouse events--it must have a\n    // valid target inside it.  If no background class is specified, as in the\n    // flyout, the workspace will not receive mouse events.\n    if (opt_backgroundClass) {\n      this.svgBackground_ = dom.createSvgElement(\n        Svg.RECT,\n        {'height': '100%', 'width': '100%', 'class': opt_backgroundClass},\n        this.svgGroup_,\n      );\n\n      if (opt_backgroundClass === 'blocklyMainBackground' && this.grid) {\n        this.svgBackground_.style.fill =\n          'url(#' + this.grid.getPatternId() + ')';\n      } else {\n        this.themeManager_.subscribe(\n          this.svgBackground_,\n          'workspaceBackgroundColour',\n          'fill',\n        );\n      }\n    }\n\n    this.layerManager = new LayerManager(this);\n    // Assign the canvases for backwards compatibility.\n    this.svgBlockCanvas_ = this.layerManager.getBlockLayer();\n    this.svgBubbleCanvas_ = this.layerManager.getBubbleLayer();\n\n    if (!this.isFlyout) {\n      browserEvents.conditionalBind(\n        this.svgGroup_,\n        'pointerdown',\n        this,\n        this.onMouseDown_,\n        false,\n      );\n      // This no-op works around https://bugs.webkit.org/show_bug.cgi?id=226683,\n      // which otherwise prevents zoom/scroll events from being observed in\n      // Safari. Once that bug is fixed it should be removed.\n      this.dummyWheelListener = () => {};\n      document.body.addEventListener('wheel', this.dummyWheelListener);\n      browserEvents.conditionalBind(\n        this.svgGroup_,\n        'wheel',\n        this,\n        this.onMouseWheel_,\n      );\n    }\n\n    // Determine if there needs to be a category tree, or a simple list of\n    // blocks.  This cannot be changed later, since the UI is very different.\n    if (this.options.hasCategories) {\n      const ToolboxClass = registry.getClassFromOptions(\n        registry.Type.TOOLBOX,\n        this.options,\n        true,\n      );\n      this.toolbox_ = new ToolboxClass!(this);\n    }\n    if (this.grid) {\n      this.grid.update(this.scale);\n    }\n    this.recordDragTargets();\n    const CursorClass = registry.getClassFromOptions(\n      registry.Type.CURSOR,\n      this.options,\n    );\n\n    CursorClass && this.markerManager.setCursor(new CursorClass());\n\n    this.renderer.createDom(this.svgGroup_, this.getTheme());\n    return this.svgGroup_;\n  }\n\n  /**\n   * Dispose of this workspace.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  override dispose() {\n    // Stop rerendering.\n    this.rendered = false;\n    if (this.currentGesture_) {\n      this.currentGesture_.cancel();\n    }\n    if (this.svgGroup_) {\n      dom.removeNode(this.svgGroup_);\n    }\n    if (this.toolbox_) {\n      this.toolbox_.dispose();\n      this.toolbox_ = null;\n    }\n    if (this.flyout) {\n      this.flyout.dispose();\n      this.flyout = null;\n    }\n    if (this.trashcan) {\n      this.trashcan.dispose();\n      this.trashcan = null;\n    }\n    if (this.scrollbar) {\n      this.scrollbar.dispose();\n      this.scrollbar = null;\n    }\n    if (this.zoomControls_) {\n      this.zoomControls_.dispose();\n    }\n\n    if (this.audioManager) {\n      this.audioManager.dispose();\n    }\n\n    if (this.grid) {\n      this.grid = null;\n    }\n\n    this.renderer.dispose();\n\n    if (this.markerManager) {\n      this.markerManager.dispose();\n    }\n\n    super.dispose();\n\n    // Dispose of theme manager after all blocks and mutators are disposed of.\n    if (this.themeManager_) {\n      this.themeManager_.unsubscribeWorkspace(this);\n      this.themeManager_.unsubscribe(this.svgBackground_);\n      if (!this.options.parentWorkspace) {\n        this.themeManager_.dispose();\n      }\n    }\n\n    this.connectionDBList.length = 0;\n\n    this.toolboxCategoryCallbacks.clear();\n    this.flyoutButtonCallbacks.clear();\n\n    if (!this.options.parentWorkspace) {\n      // Top-most workspace.  Dispose of the div that the\n      // SVG is injected into (i.e. injectionDiv).\n      const parentSvg = this.getParentSvg();\n      if (parentSvg && parentSvg.parentNode) {\n        dom.removeNode(parentSvg.parentNode);\n      }\n    }\n    if (this.resizeHandlerWrapper) {\n      browserEvents.unbind(this.resizeHandlerWrapper);\n      this.resizeHandlerWrapper = null;\n    }\n\n    // Remove the dummy wheel listener\n    if (this.dummyWheelListener) {\n      document.body.removeEventListener('wheel', this.dummyWheelListener);\n      this.dummyWheelListener = null;\n    }\n  }\n\n  /**\n   * Add a trashcan.\n   *\n   * @internal\n   */\n  addTrashcan() {\n    this.trashcan = WorkspaceSvg.newTrashcan(this);\n    const svgTrashcan = this.trashcan.createDom();\n    this.svgGroup_.insertBefore(svgTrashcan, this.getCanvas());\n  }\n\n  /**\n   * @param _workspace\n   * @internal\n   */\n  static newTrashcan(_workspace: WorkspaceSvg): Trashcan {\n    throw new Error(\n      'The implementation of newTrashcan should be ' +\n        'monkey-patched in by blockly.ts',\n    );\n  }\n\n  /**\n   * Add zoom controls.\n   *\n   * @internal\n   */\n  addZoomControls() {\n    this.zoomControls_ = new ZoomControls(this);\n    const svgZoomControls = this.zoomControls_.createDom();\n    this.svgGroup_.appendChild(svgZoomControls);\n  }\n\n  /**\n   * Add a flyout element in an element with the given tag name.\n   *\n   * @param tagName What type of tag the flyout belongs in.\n   * @returns The element containing the flyout DOM.\n   * @internal\n   */\n  addFlyout(tagName: string | Svg<SVGSVGElement> | Svg<SVGGElement>): Element {\n    const workspaceOptions = new Options({\n      'parentWorkspace': this,\n      'rtl': this.RTL,\n      'oneBasedIndex': this.options.oneBasedIndex,\n      'horizontalLayout': this.horizontalLayout,\n      'renderer': this.options.renderer,\n      'rendererOverrides': this.options.rendererOverrides,\n      'move': {\n        'scrollbars': true,\n      },\n    } as BlocklyOptions);\n    workspaceOptions.toolboxPosition = this.options.toolboxPosition;\n    if (this.horizontalLayout) {\n      const HorizontalFlyout = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,\n        this.options,\n        true,\n      );\n      this.flyout = new HorizontalFlyout!(workspaceOptions);\n    } else {\n      const VerticalFlyout = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_VERTICAL_TOOLBOX,\n        this.options,\n        true,\n      );\n      this.flyout = new VerticalFlyout!(workspaceOptions);\n    }\n    this.flyout.autoClose = false;\n    this.flyout.getWorkspace().setVisible(true);\n\n    // Return the element so that callers can place it in their desired\n    // spot in the DOM.  For example, mutator flyouts do not go in the same\n    // place as main workspace flyouts.\n    return this.flyout.createDom(tagName);\n  }\n\n  /**\n   * Getter for the flyout associated with this workspace.  This flyout may be\n   * owned by either the toolbox or the workspace, depending on toolbox\n   * configuration.  It will be null if there is no flyout.\n   *\n   * @param opt_own Whether to only return the workspace's own flyout.\n   * @returns The flyout on this workspace.\n   */\n  getFlyout(opt_own?: boolean): IFlyout | null {\n    if (this.flyout || opt_own) {\n      return this.flyout;\n    }\n    if (this.toolbox_) {\n      return this.toolbox_.getFlyout();\n    }\n    return null;\n  }\n\n  /**\n   * Getter for the toolbox associated with this workspace, if one exists.\n   *\n   * @returns The toolbox on this workspace.\n   */\n  getToolbox(): IToolbox | null {\n    return this.toolbox_;\n  }\n\n  /**\n   * Update items that use screen coordinate calculations\n   * because something has changed (e.g. scroll position, window size).\n   */\n  private updateScreenCalculations_() {\n    this.updateInverseScreenCTM();\n    this.recordDragTargets();\n  }\n\n  /**\n   * If enabled, resize the parts of the workspace that change when the\n   * workspace contents (e.g. block positions) change.  This will also scroll\n   * the workspace contents if needed.\n   *\n   * @internal\n   */\n  resizeContents() {\n    if (!this.resizesEnabled || !this.rendered) {\n      return;\n    }\n    if (this.scrollbar) {\n      this.scrollbar.resize();\n    }\n    this.updateInverseScreenCTM();\n  }\n\n  /**\n   * Resize and reposition all of the workspace chrome (toolbox,\n   * trash, scrollbars etc.)\n   * This should be called when something changes that\n   * requires recalculating dimensions and positions of the\n   * trash, zoom, toolbox, etc. (e.g. window resize).\n   */\n  resize() {\n    if (this.toolbox_) {\n      this.toolbox_.position();\n    }\n    if (this.flyout) {\n      this.flyout.position();\n    }\n\n    const positionables = this.componentManager.getComponents(\n      ComponentManager.Capability.POSITIONABLE,\n      true,\n    );\n    const metrics = this.getMetricsManager().getUiMetrics();\n    const savedPositions = [];\n    for (let i = 0, positionable; (positionable = positionables[i]); i++) {\n      positionable.position(metrics, savedPositions);\n      const boundingRect = positionable.getBoundingRectangle();\n      if (boundingRect) {\n        savedPositions.push(boundingRect);\n      }\n    }\n\n    if (this.scrollbar) {\n      this.scrollbar.resize();\n    }\n    this.updateScreenCalculations_();\n  }\n\n  /**\n   * Resizes and repositions workspace chrome if the page has a new\n   * scroll position.\n   *\n   * @internal\n   */\n  updateScreenCalculationsIfScrolled() {\n    /* eslint-disable indent */\n    const currScroll = svgMath.getDocumentScroll();\n    if (!Coordinate.equals(this.lastRecordedPageScroll, currScroll)) {\n      this.lastRecordedPageScroll = currScroll;\n      this.updateScreenCalculations_();\n    }\n  }\n  /* eslint-enable indent */\n\n  /**\n   * @returns The layer manager for this workspace.\n   */\n  getLayerManager(): LayerManager | null {\n    return this.layerManager;\n  }\n\n  /**\n   * Get the SVG element that forms the drawing surface.\n   *\n   * @returns SVG group element.\n   */\n  getCanvas(): SVGGElement {\n    return this.layerManager!.getBlockLayer();\n  }\n\n  /**\n   * Caches the width and height of the workspace's parent SVG element for use\n   * with getSvgMetrics.\n   *\n   * @param width The width of the parent SVG element.\n   * @param height The height of the parent SVG element\n   * @internal\n   */\n  setCachedParentSvgSize(width: number | null, height: number | null) {\n    const svg = this.getParentSvg();\n    if (width != null) {\n      this.cachedParentSvgSize.width = width;\n      // This is set to support the public (but deprecated) Blockly.svgSize\n      // method.\n      svg.setAttribute('data-cached-width', `${width}`);\n    }\n    if (height != null) {\n      this.cachedParentSvgSize.height = height;\n      // This is set to support the public (but deprecated) Blockly.svgSize\n      // method.\n      svg.setAttribute('data-cached-height', `${height}`);\n    }\n  }\n\n  /**\n   * Get the SVG element that forms the bubble surface.\n   *\n   * @returns SVG group element.\n   */\n  getBubbleCanvas(): SVGGElement {\n    return this.layerManager!.getBubbleLayer();\n  }\n\n  /**\n   * Get the SVG element that contains this workspace.\n   * Note: We assume this is only called after the workspace has been injected\n   * into the DOM.\n   *\n   * @returns SVG element.\n   */\n  getParentSvg(): SVGSVGElement {\n    if (!this.cachedParentSvg) {\n      let element = this.svgGroup_;\n      while (element) {\n        if (element.tagName === 'svg') {\n          this.cachedParentSvg = element;\n          break;\n        }\n        element = element.parentNode as SVGSVGElement;\n      }\n    }\n    return this.cachedParentSvg as SVGSVGElement;\n  }\n\n  /**\n   * Fires a viewport event if events are enabled and there is a change in\n   * viewport values.\n   *\n   * @internal\n   */\n  maybeFireViewportChangeEvent() {\n    if (!eventUtils.isEnabled()) {\n      return;\n    }\n    const scale = this.scale;\n    const top = -this.scrollY;\n    const left = -this.scrollX;\n    if (\n      scale === this.oldScale &&\n      Math.abs(top - this.oldTop) < 1 &&\n      Math.abs(left - this.oldLeft) < 1\n    ) {\n      // Ignore sub-pixel changes in top and left. Due to #4192 there are a lot\n      // of negligible changes in viewport top/left.\n      return;\n    }\n    const event = new (eventUtils.get(eventUtils.VIEWPORT_CHANGE))(\n      top,\n      left,\n      scale,\n      this.id,\n      this.oldScale,\n    );\n    this.oldScale = scale;\n    this.oldTop = top;\n    this.oldLeft = left;\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Translate this workspace to new coordinates.\n   *\n   * @param x Horizontal translation, in pixel units relative to the top left of\n   *     the Blockly div.\n   * @param y Vertical translation, in pixel units relative to the top left of\n   *     the Blockly div.\n   */\n  translate(x: number, y: number) {\n    this.layerManager?.translateLayers(new Coordinate(x, y), this.scale);\n    this.grid?.moveTo(x, y);\n    this.maybeFireViewportChangeEvent();\n  }\n\n  /**\n   * Returns the horizontal offset of the workspace.\n   * Intended for LTR/RTL compatibility in XML.\n   *\n   * @returns Width.\n   */\n  override getWidth(): number {\n    const metrics = this.getMetrics();\n    return metrics ? metrics.viewWidth / this.scale : 0;\n  }\n\n  /**\n   * Toggles the visibility of the workspace.\n   * Currently only intended for main workspace.\n   *\n   * @param isVisible True if workspace should be visible.\n   */\n  setVisible(isVisible: boolean) {\n    this.isVisible_ = isVisible;\n    if (!this.svgGroup_) {\n      return;\n    }\n\n    // Tell the scrollbar whether its container is visible so it can\n    // tell when to hide itself.\n    if (this.scrollbar) {\n      this.scrollbar.setContainerVisible(isVisible);\n    }\n\n    // Tell the flyout whether its container is visible so it can\n    // tell when to hide itself.\n    if (this.getFlyout()) {\n      this.getFlyout()!.setContainerVisible(isVisible);\n    }\n\n    this.getParentSvg().style.display = isVisible ? 'block' : 'none';\n    if (this.toolbox_) {\n      // Currently does not support toolboxes in mutators.\n      this.toolbox_.setVisible(isVisible);\n    }\n    if (!isVisible) {\n      this.hideChaff(true);\n    }\n  }\n\n  /**\n   * Render all blocks in workspace.\n   */\n  render() {\n    // Generate list of all blocks.\n    const blocks = this.getAllBlocks(false);\n    // Render each block.\n    for (let i = blocks.length - 1; i >= 0; i--) {\n      blocks[i].queueRender();\n    }\n\n    this.getTopBlocks()\n      .flatMap((block) => block.getDescendants(false))\n      .filter((block) => block.isInsertionMarker())\n      .forEach((block) => block.queueRender());\n\n    renderManagement\n      .finishQueuedRenders()\n      .then(() => void this.markerManager.updateMarkers());\n  }\n\n  /**\n   * Highlight or unhighlight a block in the workspace.  Block highlighting is\n   * often used to visually mark blocks currently being executed.\n   *\n   * @param id ID of block to highlight/unhighlight, or null for no block (used\n   *     to unhighlight all blocks).\n   * @param opt_state If undefined, highlight specified block and automatically\n   *     unhighlight all others.  If true or false, manually\n   *     highlight/unhighlight the specified block.\n   */\n  highlightBlock(id: string | null, opt_state?: boolean) {\n    if (opt_state === undefined) {\n      // Unhighlight all blocks.\n      for (let i = 0, block; (block = this.highlightedBlocks[i]); i++) {\n        block.setHighlighted(false);\n      }\n      this.highlightedBlocks.length = 0;\n    }\n    // Highlight/unhighlight the specified block.\n    const block = id ? this.getBlockById(id) : null;\n    if (block) {\n      const state = opt_state === undefined || opt_state;\n      // Using Set here would be great, but at the cost of IE10 support.\n      if (!state) {\n        arrayUtils.removeElem(this.highlightedBlocks, block);\n      } else if (!this.highlightedBlocks.includes(block)) {\n        this.highlightedBlocks.push(block);\n      }\n      block.setHighlighted(state);\n    }\n  }\n\n  /**\n   * Refresh the toolbox unless there's a drag in progress.\n   *\n   * @internal\n   */\n  refreshToolboxSelection() {\n    const ws = this.isFlyout ? this.targetWorkspace : this;\n    if (ws && !ws.currentGesture_ && ws.toolbox_ && ws.toolbox_.getFlyout()) {\n      ws.toolbox_.refreshSelection();\n    }\n  }\n\n  /**\n   * Rename a variable by updating its name in the variable map.  Update the\n   *     flyout to show the renamed variable immediately.\n   *\n   * @param id ID of the variable to rename.\n   * @param newName New variable name.\n   */\n  override renameVariableById(id: string, newName: string) {\n    super.renameVariableById(id, newName);\n    this.refreshToolboxSelection();\n  }\n\n  /**\n   * Delete a variable by the passed in ID.   Update the flyout to show\n   *     immediately that the variable is deleted.\n   *\n   * @param id ID of variable to delete.\n   */\n  override deleteVariableById(id: string) {\n    super.deleteVariableById(id);\n    this.refreshToolboxSelection();\n  }\n\n  /**\n   * Create a new variable with the given name.  Update the flyout to show the\n   *     new variable immediately.\n   *\n   * @param name The new variable's name.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   * @returns The newly created variable.\n   */\n  override createVariable(\n    name: string,\n    opt_type?: string | null,\n    opt_id?: string | null,\n  ): VariableModel {\n    const newVar = super.createVariable(name, opt_type, opt_id);\n    this.refreshToolboxSelection();\n    return newVar;\n  }\n\n  /** Make a list of all the delete areas for this workspace. */\n  recordDragTargets() {\n    const dragTargets = this.componentManager.getComponents(\n      ComponentManager.Capability.DRAG_TARGET,\n      true,\n    );\n\n    this.dragTargetAreas = [];\n    for (let i = 0, targetArea; (targetArea = dragTargets[i]); i++) {\n      const rect = targetArea.getClientRect();\n      if (rect) {\n        this.dragTargetAreas.push({\n          component: targetArea,\n          clientRect: rect,\n        });\n      }\n    }\n  }\n  /* eslint-disable jsdoc/require-returns-check */\n  /* eslint-disable @typescript-eslint/no-unused-vars */\n  /**\n   * Obtain a newly created block.\n   *\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   * @returns The created block.\n   */\n  override newBlock(prototypeName: string, opt_id?: string): BlockSvg {\n    throw new Error(\n      'The implementation of newBlock should be ' +\n        'monkey-patched in by blockly.ts',\n    );\n  }\n\n  /**\n   * Obtain a newly created comment.\n   *\n   * @param id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   * @returns The created comment.\n   */\n  newComment(id?: string): WorkspaceComment {\n    throw new Error(\n      'The implementation of newComment should be ' +\n        'monkey-patched in by blockly.ts',\n    );\n  }\n  /* eslint-enable */\n\n  /**\n   * Returns the drag target the pointer event is over.\n   *\n   * @param e Pointer move event.\n   * @returns Null if not over a drag target, or the drag target the event is\n   *     over.\n   */\n  getDragTarget(e: PointerEvent): IDragTarget | null {\n    for (let i = 0, targetArea; (targetArea = this.dragTargetAreas[i]); i++) {\n      if (targetArea.clientRect.contains(e.clientX, e.clientY)) {\n        return targetArea.component;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Handle a pointerdown on SVG drawing surface.\n   *\n   * @param e Pointer down event.\n   */\n  private onMouseDown_(e: PointerEvent) {\n    const gesture = this.getGesture(e);\n    if (gesture) {\n      gesture.handleWsStart(e, this);\n    }\n  }\n\n  /**\n   * Start tracking a drag of an object on this workspace.\n   *\n   * @param e Pointer down event.\n   * @param xy Starting location of object.\n   */\n  startDrag(e: PointerEvent, xy: Coordinate) {\n    // Record the starting offset between the bubble's location and the mouse.\n    const point = browserEvents.mouseToSvg(\n      e,\n      this.getParentSvg(),\n      this.getInverseScreenCTM(),\n    );\n    // Fix scale of mouse event.\n    point.x /= this.scale;\n    point.y /= this.scale;\n    this.dragDeltaXY = Coordinate.difference(xy, point);\n  }\n\n  /**\n   * Track a drag of an object on this workspace.\n   *\n   * @param e Pointer move event.\n   * @returns New location of object.\n   */\n  moveDrag(e: PointerEvent): Coordinate {\n    const point = browserEvents.mouseToSvg(\n      e,\n      this.getParentSvg(),\n      this.getInverseScreenCTM(),\n    );\n    // Fix scale of mouse event.\n    point.x /= this.scale;\n    point.y /= this.scale;\n    return Coordinate.sum(this.dragDeltaXY!, point);\n  }\n\n  /**\n   * Is the user currently dragging a block or scrolling the flyout/workspace?\n   *\n   * @returns True if currently dragging or scrolling.\n   */\n  isDragging(): boolean {\n    return this.currentGesture_ !== null && this.currentGesture_.isDragging();\n  }\n\n  /**\n   * Is this workspace draggable?\n   *\n   * @returns True if this workspace may be dragged.\n   */\n  isDraggable(): boolean {\n    return this.options.moveOptions && this.options.moveOptions.drag;\n  }\n\n  /**\n   * Is this workspace movable?\n   *\n   * This means the user can reposition the X Y coordinates of the workspace\n   * through input. This can be through scrollbars, scroll wheel, dragging, or\n   * through zooming with the scroll wheel or pinch (since the zoom is centered\n   * on the mouse position). This does not include zooming with the zoom\n   * controls since the X Y coordinates are decided programmatically.\n   *\n   * @returns True if the workspace is movable, false otherwise.\n   */\n  isMovable(): boolean {\n    return (\n      (this.options.moveOptions && !!this.options.moveOptions.scrollbars) ||\n      (this.options.moveOptions && this.options.moveOptions.wheel) ||\n      (this.options.moveOptions && this.options.moveOptions.drag) ||\n      (this.options.zoomOptions && this.options.zoomOptions.wheel) ||\n      (this.options.zoomOptions && this.options.zoomOptions.pinch)\n    );\n  }\n\n  /**\n   * Is this workspace movable horizontally?\n   *\n   * @returns True if the workspace is movable horizontally, false otherwise.\n   */\n  isMovableHorizontally(): boolean {\n    const hasScrollbars = !!this.scrollbar;\n    return (\n      this.isMovable() &&\n      (!hasScrollbars ||\n        (hasScrollbars && this.scrollbar!.canScrollHorizontally()))\n    );\n  }\n\n  /**\n   * Is this workspace movable vertically?\n   *\n   * @returns True if the workspace is movable vertically, false otherwise.\n   */\n  isMovableVertically(): boolean {\n    const hasScrollbars = !!this.scrollbar;\n    return (\n      this.isMovable() &&\n      (!hasScrollbars ||\n        (hasScrollbars && this.scrollbar!.canScrollVertically()))\n    );\n  }\n\n  /**\n   * Handle a mouse-wheel on SVG drawing surface.\n   *\n   * @param e Mouse wheel event.\n   */\n  private onMouseWheel_(e: WheelEvent) {\n    // Don't scroll or zoom anything if drag is in progress.\n    if (Gesture.inProgress()) {\n      e.preventDefault();\n      e.stopPropagation();\n      return;\n    }\n    const canWheelZoom =\n      this.options.zoomOptions && this.options.zoomOptions.wheel;\n    const canWheelMove =\n      this.options.moveOptions && this.options.moveOptions.wheel;\n    if (!canWheelZoom && !canWheelMove) {\n      return;\n    }\n\n    const scrollDelta = browserEvents.getScrollDeltaPixels(e);\n\n    // Zoom should also be enabled by the command key on Mac devices,\n    // but not super on Unix.\n    let commandKey;\n    if (userAgent.MAC) {\n      commandKey = e.metaKey;\n    }\n\n    if (canWheelZoom && (e.ctrlKey || commandKey || !canWheelMove)) {\n      // Zoom.\n      // The vertical scroll distance that corresponds to a click of a zoom\n      // button.\n      const PIXELS_PER_ZOOM_STEP = 50;\n      const delta = -scrollDelta.y / PIXELS_PER_ZOOM_STEP;\n      const position = browserEvents.mouseToSvg(\n        e,\n        this.getParentSvg(),\n        this.getInverseScreenCTM(),\n      );\n      this.zoom(position.x, position.y, delta);\n    } else {\n      // Scroll.\n      let x = this.scrollX - scrollDelta.x;\n      let y = this.scrollY - scrollDelta.y;\n\n      if (e.shiftKey && !scrollDelta.x) {\n        // Scroll horizontally (based on vertical scroll delta).\n        // This is needed as for some browser/system combinations which do not\n        // set deltaX.\n        x = this.scrollX - scrollDelta.y;\n        y = this.scrollY; // Don't scroll vertically.\n      }\n      this.scroll(x, y);\n    }\n    e.preventDefault();\n  }\n\n  /**\n   * Calculate the bounding box for the blocks on the workspace.\n   * Coordinate system: workspace coordinates.\n   *\n   * @returns Contains the position and size of the bounding box containing the\n   *     blocks on the workspace.\n   */\n  getBlocksBoundingBox(): Rect {\n    const topElements = this.getTopBoundedElements();\n    // There are no blocks, return empty rectangle.\n    if (!topElements.length) {\n      return new Rect(0, 0, 0, 0);\n    }\n\n    // Initialize boundary using the first block.\n    const boundary = topElements[0].getBoundingRectangle();\n\n    // Start at 1 since the 0th block was used for initialization.\n    for (let i = 1; i < topElements.length; i++) {\n      const topElement = topElements[i];\n      if (\n        (topElement as any).isInsertionMarker &&\n        (topElement as any).isInsertionMarker()\n      ) {\n        continue;\n      }\n      const blockBoundary = topElement.getBoundingRectangle();\n      if (blockBoundary.top < boundary.top) {\n        boundary.top = blockBoundary.top;\n      }\n      if (blockBoundary.bottom > boundary.bottom) {\n        boundary.bottom = blockBoundary.bottom;\n      }\n      if (blockBoundary.left < boundary.left) {\n        boundary.left = blockBoundary.left;\n      }\n      if (blockBoundary.right > boundary.right) {\n        boundary.right = blockBoundary.right;\n      }\n    }\n    return boundary;\n  }\n\n  /** Clean up the workspace by ordering all the blocks in a column. */\n  cleanUp() {\n    this.setResizesEnabled(false);\n    eventUtils.setGroup(true);\n    const topBlocks = this.getTopBlocks(true);\n    let cursorY = 0;\n    for (let i = 0, block; (block = topBlocks[i]); i++) {\n      if (!block.isMovable()) {\n        continue;\n      }\n      const xy = block.getRelativeToSurfaceXY();\n      block.moveBy(-xy.x, cursorY - xy.y, ['cleanup']);\n      block.snapToGrid();\n      cursorY =\n        block.getRelativeToSurfaceXY().y +\n        block.getHeightWidth().height +\n        this.renderer.getConstants().MIN_BLOCK_HEIGHT;\n    }\n    eventUtils.setGroup(false);\n    this.setResizesEnabled(true);\n  }\n\n  /**\n   * Show the context menu for the workspace.\n   *\n   * @param e Mouse event.\n   * @internal\n   */\n  showContextMenu(e: PointerEvent) {\n    if (this.options.readOnly || this.isFlyout) {\n      return;\n    }\n    const menuOptions = ContextMenuRegistry.registry.getContextMenuOptions(\n      ContextMenuRegistry.ScopeType.WORKSPACE,\n      {workspace: this},\n    );\n\n    // Allow the developer to add or modify menuOptions.\n    if (this.configureContextMenu) {\n      this.configureContextMenu(menuOptions, e);\n    }\n\n    ContextMenu.show(e, menuOptions, this.RTL, this);\n  }\n\n  /**\n   * Modify the block tree on the existing toolbox.\n   *\n   * @param toolboxDef DOM tree of toolbox contents, string of toolbox contents,\n   *     or JSON representing toolbox definition.\n   */\n  updateToolbox(toolboxDef: toolbox.ToolboxDefinition | null) {\n    const parsedToolboxDef = toolbox.convertToolboxDefToJson(toolboxDef);\n\n    if (!parsedToolboxDef) {\n      if (this.options.languageTree) {\n        throw Error(\"Can't nullify an existing toolbox.\");\n      }\n      return; // No change (null to null).\n    }\n    if (!this.options.languageTree) {\n      throw Error(\"Existing toolbox is null.  Can't create new toolbox.\");\n    }\n\n    if (toolbox.hasCategories(parsedToolboxDef)) {\n      if (!this.toolbox_) {\n        throw Error(\"Existing toolbox has no categories.  Can't change mode.\");\n      }\n      this.options.languageTree = parsedToolboxDef;\n      this.toolbox_.render(parsedToolboxDef);\n    } else {\n      if (!this.flyout) {\n        throw Error(\"Existing toolbox has categories.  Can't change mode.\");\n      }\n      this.options.languageTree = parsedToolboxDef;\n      this.flyout.show(parsedToolboxDef);\n    }\n  }\n\n  /** Mark this workspace as the currently focused main workspace. */\n  markFocused() {\n    if (this.options.parentWorkspace) {\n      this.options.parentWorkspace.markFocused();\n    } else {\n      common.setMainWorkspace(this);\n      // We call e.preventDefault in many event handlers which means we\n      // need to explicitly grab focus (e.g from a textarea) because\n      // the browser will not do it for us.\n      this.getParentSvg().focus({preventScroll: true});\n    }\n  }\n\n  /**\n   * Zooms the workspace in or out relative to/centered on the given (x, y)\n   * coordinate.\n   *\n   * @param x X coordinate of center, in pixel units relative to the top-left\n   *     corner of the parentSVG.\n   * @param y Y coordinate of center, in pixel units relative to the top-left\n   *     corner of the parentSVG.\n   * @param amount Amount of zooming. The formula for the new scale is newScale\n   *     = currentScale * (scaleSpeed^amount). scaleSpeed is set in the\n   *     workspace options. Negative amount values zoom out, and positive amount\n   *     values zoom in.\n   */\n  zoom(x: number, y: number, amount: number) {\n    // Scale factor.\n    const speed = this.options.zoomOptions.scaleSpeed;\n    let scaleChange = Math.pow(speed, amount);\n    const newScale = this.scale * scaleChange;\n    if (this.scale === newScale) {\n      return; // No change in zoom.\n    }\n\n    // Clamp scale within valid range.\n    if (newScale > this.options.zoomOptions.maxScale) {\n      scaleChange = this.options.zoomOptions.maxScale / this.scale;\n    } else if (newScale < this.options.zoomOptions.minScale) {\n      scaleChange = this.options.zoomOptions.minScale / this.scale;\n    }\n\n    // Transform the x/y coordinates from the parentSVG's space into the\n    // canvas' space, so that they are in workspace units relative to the top\n    // left of the visible portion of the workspace.\n    let matrix = this.getCanvas().getCTM();\n    let center = this.getParentSvg().createSVGPoint();\n    center.x = x;\n    center.y = y;\n    center = center.matrixTransform(matrix!.inverse());\n    x = center.x;\n    y = center.y;\n\n    // Find the new scrollX/scrollY so that the center remains in the same\n    // position (relative to the center) after we zoom.\n    // newScale and matrix.a should be identical (within a rounding error).\n    matrix = matrix!\n      .translate(x * (1 - scaleChange), y * (1 - scaleChange))\n      .scale(scaleChange);\n    // scrollX and scrollY are in pixels.\n    // The scrollX and scrollY still need to have absoluteLeft and absoluteTop\n    // subtracted from them, but we'll leave that for setScale so that they're\n    // correctly updated for the new flyout size if we have a simple toolbox.\n    this.scrollX = matrix.e;\n    this.scrollY = matrix.f;\n    this.setScale(newScale);\n  }\n\n  /**\n   * Zooming the blocks centered in the center of view with zooming in or out.\n   *\n   * @param type Type of zooming (-1 zooming out and 1 zooming in).\n   */\n  zoomCenter(type: number) {\n    const metrics = this.getMetrics();\n    let x;\n    let y;\n    if (this.flyout) {\n      // If you want blocks in the center of the view (visible portion of the\n      // workspace) to stay centered when the size of the view decreases (i.e.\n      // when the size of the flyout increases) you need the center of the\n      // *blockly div* to stay in the same pixel-position.\n      // Note: This only works because of how scrollCenter positions blocks.\n      x = metrics.svgWidth ? metrics.svgWidth / 2 : 0;\n      y = metrics.svgHeight ? metrics.svgHeight / 2 : 0;\n    } else {\n      x = metrics.viewWidth / 2 + metrics.absoluteLeft;\n      y = metrics.viewHeight / 2 + metrics.absoluteTop;\n    }\n    this.zoom(x, y, type);\n  }\n\n  /** Zoom the blocks to fit in the workspace if possible. */\n  zoomToFit() {\n    if (!this.isMovable()) {\n      console.warn(\n        'Tried to move a non-movable workspace. This could result' +\n          ' in blocks becoming inaccessible.',\n      );\n      return;\n    }\n\n    const metrics = this.getMetrics();\n    let workspaceWidth = metrics.viewWidth;\n    let workspaceHeight = metrics.viewHeight;\n    const blocksBox = this.getBlocksBoundingBox();\n    const doubleMargin = ZOOM_TO_FIT_MARGIN * 2;\n    let blocksWidth = blocksBox.right - blocksBox.left + doubleMargin;\n    let blocksHeight = blocksBox.bottom - blocksBox.top + doubleMargin;\n    if (!blocksWidth) {\n      return; // Prevents zooming to infinity.\n    }\n    if (this.flyout) {\n      // We have to add the flyout size to both the workspace size and the\n      // block size because the blocks we want to resize include the blocks in\n      // the flyout, and the area we want to fit them includes the portion of\n      // the workspace that is behind the flyout.\n      if (this.horizontalLayout) {\n        workspaceHeight += this.flyout.getHeight();\n        // Convert from pixels to workspace coordinates.\n        blocksHeight += this.flyout.getHeight() / this.scale;\n      } else {\n        workspaceWidth += this.flyout.getWidth();\n        // Convert from pixels to workspace coordinates.\n        blocksWidth += this.flyout.getWidth() / this.scale;\n      }\n    }\n\n    // Scale Units: (pixels / workspaceUnit)\n    const ratioX = workspaceWidth / blocksWidth;\n    const ratioY = workspaceHeight / blocksHeight;\n    eventUtils.disable();\n    try {\n      this.setScale(Math.min(ratioX, ratioY));\n      this.scrollCenter();\n    } finally {\n      eventUtils.enable();\n    }\n    this.maybeFireViewportChangeEvent();\n  }\n\n  /**\n   * Add a transition class to the block and bubble canvas, to animate any\n   * transform changes.\n   *\n   * @internal\n   */\n  beginCanvasTransition() {\n    dom.addClass(this.getCanvas(), 'blocklyCanvasTransitioning');\n    dom.addClass(this.getBubbleCanvas(), 'blocklyCanvasTransitioning');\n  }\n\n  /**\n   * Remove transition class from the block and bubble canvas.\n   *\n   * @internal\n   */\n  endCanvasTransition() {\n    dom.removeClass(this.getCanvas(), 'blocklyCanvasTransitioning');\n    dom.removeClass(this.getBubbleCanvas(), 'blocklyCanvasTransitioning');\n  }\n\n  /** Center the workspace. */\n  scrollCenter() {\n    if (!this.isMovable()) {\n      console.warn(\n        'Tried to move a non-movable workspace. This could result' +\n          ' in blocks becoming inaccessible.',\n      );\n      return;\n    }\n\n    const metrics = this.getMetrics();\n    let x = (metrics.scrollWidth - metrics.viewWidth) / 2;\n    let y = (metrics.scrollHeight - metrics.viewHeight) / 2;\n\n    // Convert from workspace directions to canvas directions.\n    x = -x - metrics.scrollLeft;\n    y = -y - metrics.scrollTop;\n    this.scroll(x, y);\n  }\n\n  /**\n   * Scroll the workspace to center on the given block. If the block has other\n   * blocks stacked below it, the workspace will be centered on the stack,\n   * unless blockOnly is true.\n   *\n   * @param id ID of block center on.\n   * @param blockOnly True to center only on the block itself, not its stack.\n   */\n  centerOnBlock(id: string | null, blockOnly?: boolean) {\n    if (!this.isMovable()) {\n      console.warn(\n        'Tried to move a non-movable workspace. This could result' +\n          ' in blocks becoming inaccessible.',\n      );\n      return;\n    }\n\n    const block = id ? this.getBlockById(id) : null;\n    if (!block) {\n      return;\n    }\n\n    // XY is in workspace coordinates.\n    const xy = block.getRelativeToSurfaceXY();\n    // Height/width is in workspace units.\n    const heightWidth = blockOnly\n      ? {height: block.height, width: block.width}\n      : block.getHeightWidth();\n\n    // Find the enter of the block in workspace units.\n    const blockCenterY = xy.y + heightWidth.height / 2;\n\n    // In RTL the block's position is the top right of the block, not top left.\n    const multiplier = this.RTL ? -1 : 1;\n    const blockCenterX = xy.x + (multiplier * heightWidth.width) / 2;\n\n    // Workspace scale, used to convert from workspace coordinates to pixels.\n    const scale = this.scale;\n\n    // Center of block in pixels, relative to workspace origin (center 0,0).\n    // Scrolling to here would put the block in the top-left corner of the\n    // visible workspace.\n    const pixelX = blockCenterX * scale;\n    const pixelY = blockCenterY * scale;\n\n    const metrics = this.getMetrics();\n\n    // viewHeight and viewWidth are in pixels.\n    const halfViewWidth = metrics.viewWidth / 2;\n    const halfViewHeight = metrics.viewHeight / 2;\n\n    // Put the block in the center of the visible workspace instead.\n    const scrollToCenterX = pixelX - halfViewWidth;\n    const scrollToCenterY = pixelY - halfViewHeight;\n\n    // Convert from workspace directions to canvas directions.\n    const x = -scrollToCenterX;\n    const y = -scrollToCenterY;\n\n    this.scroll(x, y);\n  }\n\n  /**\n   * Set the workspace's zoom factor.\n   *\n   * @param newScale Zoom factor. Units: (pixels / workspaceUnit).\n   */\n  setScale(newScale: number) {\n    if (\n      this.options.zoomOptions.maxScale &&\n      newScale > this.options.zoomOptions.maxScale\n    ) {\n      newScale = this.options.zoomOptions.maxScale;\n    } else if (\n      this.options.zoomOptions.minScale &&\n      newScale < this.options.zoomOptions.minScale\n    ) {\n      newScale = this.options.zoomOptions.minScale;\n    }\n    this.scale = newScale;\n\n    this.hideChaff(false);\n    // Get the flyout, if any, whether our own or owned by the toolbox.\n    const flyout = this.getFlyout(false);\n    if (flyout && flyout.isVisible()) {\n      flyout.reflow();\n      this.recordDragTargets();\n    }\n    if (this.grid) {\n      this.grid.update(this.scale);\n    }\n\n    // We call scroll instead of scrollbar.resize() so that we can center the\n    // zoom correctly without scrollbars, but scroll does not resize the\n    // scrollbars so we have to call resizeView/resizeContent as well.\n    const metrics = this.getMetrics();\n\n    this.scrollX -= metrics.absoluteLeft;\n    this.scrollY -= metrics.absoluteTop;\n    // The scroll values and the view values are additive inverses of\n    // each other, so when we subtract from one we have to add to the other.\n    metrics.viewLeft += metrics.absoluteLeft;\n    metrics.viewTop += metrics.absoluteTop;\n\n    this.scroll(this.scrollX, this.scrollY);\n    if (this.scrollbar) {\n      if (this.flyout) {\n        this.scrollbar.resizeView(metrics);\n      } else {\n        this.scrollbar.resizeContent(metrics);\n      }\n    }\n  }\n\n  /**\n   * Get the workspace's zoom factor.  If the workspace has a parent, we call\n   * into the parent to get the workspace scale.\n   *\n   * @returns The workspace zoom factor. Units: (pixels / workspaceUnit).\n   */\n  getScale(): number {\n    if (this.options.parentWorkspace) {\n      return this.options.parentWorkspace.getScale();\n    }\n    return this.scale;\n  }\n\n  /**\n   * Scroll the workspace to a specified offset (in pixels), keeping in the\n   * workspace bounds. See comment on workspaceSvg.scrollX for more detail on\n   * the meaning of these values.\n   *\n   * @param x Target X to scroll to.\n   * @param y Target Y to scroll to.\n   */\n  scroll(x: number, y: number) {\n    this.hideChaff(/* opt_onlyClosePopups= */ true);\n\n    // Keep scrolling within the bounds of the content.\n    const metrics = this.getMetrics();\n    // Canvas coordinates (aka scroll coordinates) have inverse directionality\n    // to workspace coordinates so we have to inverse them.\n    x = Math.min(x, -metrics.scrollLeft);\n    y = Math.min(y, -metrics.scrollTop);\n    const maxXDisplacement = Math.max(\n      0,\n      metrics.scrollWidth - metrics.viewWidth,\n    );\n    const maxXScroll = metrics.scrollLeft + maxXDisplacement;\n    const maxYDisplacement = Math.max(\n      0,\n      metrics.scrollHeight - metrics.viewHeight,\n    );\n    const maxYScroll = metrics.scrollTop + maxYDisplacement;\n    x = Math.max(x, -maxXScroll);\n    y = Math.max(y, -maxYScroll);\n    this.scrollX = x;\n    this.scrollY = y;\n\n    if (this.scrollbar) {\n      // The content position (displacement from the content's top-left to the\n      // origin) plus the scroll position (displacement from the view's top-left\n      // to the origin) gives us the distance from the view's top-left to the\n      // content's top-left. Then we negate this so we get the displacement from\n      // the content's top-left to the view's top-left, matching the\n      // directionality of the scrollbars.\n      this.scrollbar.set(\n        -(x + metrics.scrollLeft),\n        -(y + metrics.scrollTop),\n        false,\n      );\n    }\n    // We have to shift the translation so that when the canvas is at 0, 0 the\n    // workspace origin is not underneath the toolbox.\n    x += metrics.absoluteLeft;\n    y += metrics.absoluteTop;\n    this.translate(x, y);\n  }\n\n  /**\n   * Find the block on this workspace with the specified ID.\n   *\n   * @param id ID of block to find.\n   * @returns The sought after block, or null if not found.\n   */\n  override getBlockById(id: string): BlockSvg | null {\n    return super.getBlockById(id) as BlockSvg;\n  }\n\n  /**\n   * Find all blocks in workspace.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  override getAllBlocks(ordered = false): BlockSvg[] {\n    return super.getAllBlocks(ordered) as BlockSvg[];\n  }\n\n  /**\n   * Finds the top-level blocks and returns them.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns The top-level block objects.\n   */\n  override getTopBlocks(ordered = false): BlockSvg[] {\n    return super.getTopBlocks(ordered) as BlockSvg[];\n  }\n\n  /**\n   * Adds a block to the list of top blocks.\n   *\n   * @param block Block to add.\n   */\n  override addTopBlock(block: Block) {\n    this.addTopBoundedElement(block as BlockSvg);\n    super.addTopBlock(block);\n  }\n\n  /**\n   * Removes a block from the list of top blocks.\n   *\n   * @param block Block to remove.\n   */\n  override removeTopBlock(block: Block) {\n    this.removeTopBoundedElement(block as BlockSvg);\n    super.removeTopBlock(block);\n  }\n\n  /**\n   * Adds a comment to the list of top comments.\n   *\n   * @param comment comment to add.\n   */\n  override addTopComment(comment: WorkspaceComment) {\n    this.addTopBoundedElement(comment as RenderedWorkspaceComment);\n    super.addTopComment(comment);\n  }\n\n  /**\n   * Removes a comment from the list of top comments.\n   *\n   * @param comment comment to remove.\n   */\n  override removeTopComment(comment: WorkspaceComment) {\n    this.removeTopBoundedElement(comment as RenderedWorkspaceComment);\n    super.removeTopComment(comment);\n  }\n\n  override getRootWorkspace(): WorkspaceSvg | null {\n    return super.getRootWorkspace() as WorkspaceSvg | null;\n  }\n\n  /**\n   * Adds a bounded element to the list of top bounded elements.\n   *\n   * @param element Bounded element to add.\n   */\n  addTopBoundedElement(element: IBoundedElement) {\n    this.topBoundedElements.push(element);\n  }\n\n  /**\n   * Removes a bounded element from the list of top bounded elements.\n   *\n   * @param element Bounded element to remove.\n   */\n  removeTopBoundedElement(element: IBoundedElement) {\n    arrayUtils.removeElem(this.topBoundedElements, element);\n  }\n\n  /**\n   * Finds the top-level bounded elements and returns them.\n   *\n   * @returns The top-level bounded elements.\n   */\n  getTopBoundedElements(): IBoundedElement[] {\n    return new Array<IBoundedElement>().concat(this.topBoundedElements);\n  }\n\n  /**\n   * Update whether this workspace has resizes enabled.\n   * If enabled, workspace will resize when appropriate.\n   * If disabled, workspace will not resize until re-enabled.\n   * Use to avoid resizing during a batch operation, for performance.\n   *\n   * @param enabled Whether resizes should be enabled.\n   */\n  setResizesEnabled(enabled: boolean) {\n    const reenabled = !this.resizesEnabled && enabled;\n    this.resizesEnabled = enabled;\n    if (reenabled) {\n      // Newly enabled.  Trigger a resize.\n      this.resizeContents();\n    }\n  }\n\n  /**\n   * Dispose of all blocks in workspace, with an optimization to prevent\n   * resizes.\n   */\n  override clear() {\n    this.setResizesEnabled(false);\n    super.clear();\n    this.topBoundedElements = [];\n    this.setResizesEnabled(true);\n  }\n\n  /**\n   * Register a callback function associated with a given key, for clicks on\n   * buttons and labels in the flyout.\n   * For instance, a button specified by the XML\n   * <button text=\"create variable\" callbackKey=\"CREATE_VARIABLE\"></button>\n   * should be matched by a call to\n   * registerButtonCallback(\"CREATE_VARIABLE\", yourCallbackFunction).\n   *\n   * @param key The name to use to look up this function.\n   * @param func The function to call when the given button is clicked.\n   */\n  registerButtonCallback(key: string, func: (p1: FlyoutButton) => void) {\n    if (typeof func !== 'function') {\n      throw TypeError('Button callbacks must be functions.');\n    }\n    this.flyoutButtonCallbacks.set(key, func);\n  }\n\n  /**\n   * Get the callback function associated with a given key, for clicks on\n   * buttons and labels in the flyout.\n   *\n   * @param key The name to use to look up the function.\n   * @returns The function corresponding to the given key for this workspace;\n   *     null if no callback is registered.\n   */\n  getButtonCallback(key: string): ((p1: FlyoutButton) => void) | null {\n    return this.flyoutButtonCallbacks.get(key) ?? null;\n  }\n\n  /**\n   * Remove a callback for a click on a button in the flyout.\n   *\n   * @param key The name associated with the callback function.\n   */\n  removeButtonCallback(key: string) {\n    this.flyoutButtonCallbacks.delete(key);\n  }\n\n  /**\n   * Register a callback function associated with a given key, for populating\n   * custom toolbox categories in this workspace.  See the variable and\n   * procedure categories as an example.\n   *\n   * @param key The name to use to look up this function.\n   * @param func The function to call when the given toolbox category is opened.\n   */\n  registerToolboxCategoryCallback(\n    key: string,\n    func: (p1: WorkspaceSvg) => toolbox.FlyoutDefinition,\n  ) {\n    if (typeof func !== 'function') {\n      throw TypeError('Toolbox category callbacks must be functions.');\n    }\n    this.toolboxCategoryCallbacks.set(key, func);\n  }\n\n  /**\n   * Get the callback function associated with a given key, for populating\n   * custom toolbox categories in this workspace.\n   *\n   * @param key The name to use to look up the function.\n   * @returns The function corresponding to the given key for this workspace, or\n   *     null if no function is registered.\n   */\n  getToolboxCategoryCallback(\n    key: string,\n  ): ((p1: WorkspaceSvg) => toolbox.FlyoutDefinition) | null {\n    return this.toolboxCategoryCallbacks.get(key) || null;\n  }\n\n  /**\n   * Remove a callback for a click on a custom category's name in the toolbox.\n   *\n   * @param key The name associated with the callback function.\n   */\n  removeToolboxCategoryCallback(key: string) {\n    this.toolboxCategoryCallbacks.delete(key);\n  }\n\n  /**\n   * Look up the gesture that is tracking this touch stream on this workspace.\n   * May create a new gesture.\n   *\n   * @param e Pointer event.\n   * @returns The gesture that is tracking this touch stream, or null if no\n   *     valid gesture exists.\n   * @internal\n   */\n  getGesture(e: PointerEvent): Gesture | null {\n    const isStart = e.type === 'pointerdown';\n\n    const gesture = this.currentGesture_;\n    if (gesture) {\n      if (isStart && gesture.hasStarted()) {\n        console.warn('Tried to start the same gesture twice.');\n        // That's funny.  We must have missed a mouse up.\n        // Cancel it, rather than try to retrieve all of the state we need.\n        gesture.cancel();\n        return null;\n      }\n      return gesture;\n    }\n\n    // No gesture existed on this workspace, but this looks like the start of a\n    // new gesture.\n    if (isStart) {\n      this.currentGesture_ = new Gesture(e, this);\n      return this.currentGesture_;\n    }\n    // No gesture existed and this event couldn't be the start of a new gesture.\n    return null;\n  }\n\n  /**\n   * Clear the reference to the current gesture.\n   *\n   * @internal\n   */\n  clearGesture() {\n    this.currentGesture_ = null;\n  }\n\n  /**\n   * Cancel the current gesture, if one exists.\n   *\n   * @internal\n   */\n  cancelCurrentGesture() {\n    if (this.currentGesture_) {\n      this.currentGesture_.cancel();\n    }\n  }\n\n  /**\n   * Get the audio manager for this workspace.\n   *\n   * @returns The audio manager for this workspace.\n   */\n  getAudioManager(): WorkspaceAudio {\n    return this.audioManager;\n  }\n\n  /**\n   * Get the grid object for this workspace, or null if there is none.\n   *\n   * @returns The grid object for this workspace.\n   */\n  getGrid(): Grid | null {\n    return this.grid;\n  }\n\n  /**\n   * Close tooltips, context menus, dropdown selections, etc.\n   *\n   * @param onlyClosePopups Whether only popups should be closed. Defaults to\n   *     false.\n   */\n  hideChaff(onlyClosePopups = false) {\n    Tooltip.hide();\n    WidgetDiv.hideIfOwnerIsInWorkspace(this);\n    dropDownDiv.hideWithoutAnimation();\n\n    this.hideComponents(onlyClosePopups);\n  }\n\n  /**\n   * Hide any autohideable components (like flyout, trashcan, and any\n   * user-registered components).\n   *\n   * @param onlyClosePopups Whether only popups should be closed. Defaults to\n   *     false.\n   */\n  hideComponents(onlyClosePopups = false) {\n    const autoHideables = this.getComponentManager().getComponents(\n      ComponentManager.Capability.AUTOHIDEABLE,\n      true,\n    );\n    autoHideables.forEach((autoHideable) =>\n      autoHideable.autoHide(onlyClosePopups),\n    );\n  }\n\n  /**\n   * Sets the X/Y translations of a top level workspace.\n   *\n   * @param xyRatio Contains an x and/or y property which is a float between 0\n   *     and 1 specifying the degree of scrolling.\n   */\n  private static setTopLevelWorkspaceMetrics_(\n    this: WorkspaceSvg,\n    xyRatio: {x?: number; y?: number},\n  ) {\n    const metrics = this.getMetrics();\n\n    if (typeof xyRatio.x === 'number') {\n      this.scrollX = -(\n        metrics.scrollLeft +\n        (metrics.scrollWidth - metrics.viewWidth) * xyRatio.x\n      );\n    }\n    if (typeof xyRatio.y === 'number') {\n      this.scrollY = -(\n        metrics.scrollTop +\n        (metrics.scrollHeight - metrics.viewHeight) * xyRatio.y\n      );\n    }\n    // We have to shift the translation so that when the canvas is at 0, 0 the\n    // workspace origin is not underneath the toolbox.\n    const x = this.scrollX + metrics.absoluteLeft;\n    const y = this.scrollY + metrics.absoluteTop;\n    // We could call scroll here, but that has extra checks we don't need to do.\n    this.translate(x, y);\n  }\n}\n\n/**\n * Size the workspace when the contents change.  This also updates\n * scrollbars accordingly.\n *\n * @param workspace The workspace to resize.\n * @internal\n */\nexport function resizeSvgContents(workspace: WorkspaceSvg) {\n  workspace.resizeContents();\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {BlockSvg} from '../block_svg.js';\nimport * as registry from './registry.js';\nimport {ICopyData} from '../interfaces/i_copyable.js';\nimport {IPaster} from '../interfaces/i_paster.js';\nimport {State, append} from '../serialization/blocks.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport * as eventUtils from '../events/utils.js';\nimport {config} from '../config.js';\nimport * as common from '../common.js';\n\nexport class BlockPaster implements IPaster<BlockCopyData, BlockSvg> {\n  static TYPE = 'block';\n\n  paste(\n    copyData: BlockCopyData,\n    workspace: WorkspaceSvg,\n    coordinate?: Coordinate,\n  ): BlockSvg | null {\n    if (!workspace.isCapacityAvailable(copyData.typeCounts!)) return null;\n\n    if (coordinate) {\n      copyData.blockState['x'] = coordinate.x;\n      copyData.blockState['y'] = coordinate.y;\n    }\n\n    // After appending the block to the workspace, it will be bumped from its neighbors\n    // However, the algorithm for deciding where to paste a block depends on\n    // the starting position of the copied block, so we'll pass those coordinates along\n    const initialCoordinates =\n      coordinate ||\n      new Coordinate(\n        copyData.blockState['x'] || 0,\n        copyData.blockState['y'] || 0,\n      );\n\n    eventUtils.disable();\n    let block;\n    try {\n      block = append(copyData.blockState, workspace) as BlockSvg;\n      moveBlockToNotConflict(block, initialCoordinates);\n    } finally {\n      eventUtils.enable();\n    }\n\n    if (!block) return block;\n\n    if (eventUtils.isEnabled() && !block.isShadow()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(block));\n    }\n    common.setSelected(block);\n    return block;\n  }\n}\n\n/**\n * Moves the given block to a location where it does not: (1) overlap exactly\n * with any other blocks, or (2) look like it is connected to any other blocks.\n *\n * Exported for testing.\n *\n * @param block The block to move to an unambiguous location.\n * @param originalPosition The initial coordinate to start searching from,\n *    likely the position of the copied block.\n * @internal\n */\nexport function moveBlockToNotConflict(\n  block: BlockSvg,\n  originalPosition: Coordinate,\n) {\n  const workspace = block.workspace;\n  const snapRadius = config.snapRadius;\n  const bumpOffset = Coordinate.difference(\n    originalPosition,\n    block.getRelativeToSurfaceXY(),\n  );\n  const offset = new Coordinate(0, 0);\n  // getRelativeToSurfaceXY is really expensive, so we want to cache this.\n  const otherCoords = workspace\n    .getAllBlocks(false)\n    .filter((otherBlock) => otherBlock.id != block.id)\n    .map((b) => b.getRelativeToSurfaceXY());\n\n  while (\n    blockOverlapsOtherExactly(\n      Coordinate.sum(originalPosition, offset),\n      otherCoords,\n    ) ||\n    blockIsInSnapRadius(block, Coordinate.sum(bumpOffset, offset), snapRadius)\n  ) {\n    if (workspace.RTL) {\n      offset.translate(-snapRadius, snapRadius * 2);\n    } else {\n      offset.translate(snapRadius, snapRadius * 2);\n    }\n  }\n\n  block!.moveTo(Coordinate.sum(originalPosition, offset));\n}\n\n/**\n * @returns true if the given block coordinates are less than a delta of 1 from\n *     any of the other coordinates.\n */\nfunction blockOverlapsOtherExactly(\n  coord: Coordinate,\n  otherCoords: Coordinate[],\n): boolean {\n  return otherCoords.some(\n    (otherCoord) =>\n      Math.abs(otherCoord.x - coord.x) <= 1 &&\n      Math.abs(otherCoord.y - coord.y) <= 1,\n  );\n}\n\n/**\n * @returns true if the given block (when offset by the given amount) is close\n *     enough to any other connections (within the snap radius) that it looks\n *     like they could connect.\n */\nfunction blockIsInSnapRadius(\n  block: BlockSvg,\n  offset: Coordinate,\n  snapRadius: number,\n): boolean {\n  return block\n    .getConnections_(false)\n    .some((connection) => !!connection.closest(snapRadius, offset).connection);\n}\n\nexport interface BlockCopyData extends ICopyData {\n  blockState: State;\n  typeCounts: {[key: string]: number};\n}\n\nregistry.register(BlockPaster.TYPE, new BlockPaster());\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.bumpObjects\n\nimport {RenderedWorkspaceComment} from './comments/rendered_workspace_comment.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BlockCreate} from './events/events_block_create.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport type {CommentCreate} from './events/events_comment_create.js';\nimport type {CommentMove} from './events/events_comment_move.js';\nimport type {ViewportChange} from './events/events_viewport.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport type {ContainerRegion} from './metrics_manager.js';\nimport * as mathUtils from './utils/math.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Bumps the given object that has passed out of bounds.\n *\n * @param workspace The workspace containing the object.\n * @param bounds The region to bump an object into. For example, pass\n *     ScrollMetrics to bump a block into the scrollable region of the\n *     workspace, or pass ViewMetrics to bump a block into the visible region of\n *     the workspace. This should be specified in workspace coordinates.\n * @param object The object to bump.\n * @returns True if object was bumped.\n */\nfunction bumpObjectIntoBounds(\n  workspace: WorkspaceSvg,\n  bounds: ContainerRegion,\n  object: IBoundedElement,\n): boolean {\n  // Compute new top/left position for object.\n  const objectMetrics = object.getBoundingRectangle();\n  const height = objectMetrics.bottom - objectMetrics.top;\n  const width = objectMetrics.right - objectMetrics.left;\n\n  const topClamp = bounds.top;\n  const boundsBottom = bounds.top + bounds.height;\n  const bottomClamp = boundsBottom - height;\n  // If the object is taller than the workspace we want to\n  // top-align the block\n  const newYPosition = mathUtils.clamp(\n    topClamp,\n    objectMetrics.top,\n    bottomClamp,\n  );\n  const deltaY = newYPosition - objectMetrics.top;\n\n  // Note: Even in RTL mode the \"anchor\" of the object is the\n  // top-left corner of the object.\n  let leftClamp = bounds.left;\n  const boundsRight = bounds.left + bounds.width;\n  let rightClamp = boundsRight - width;\n  if (workspace.RTL) {\n    // If the object is wider than the workspace and we're in RTL\n    // mode we want to right-align the block, which means setting\n    // the left clamp to match.\n    leftClamp = Math.min(rightClamp, leftClamp);\n  } else {\n    // If the object is wider than the workspace and we're in LTR\n    // mode we want to left-align the block, which means setting\n    // the right clamp to match.\n    rightClamp = Math.max(leftClamp, rightClamp);\n  }\n  const newXPosition = mathUtils.clamp(\n    leftClamp,\n    objectMetrics.left,\n    rightClamp,\n  );\n  const deltaX = newXPosition - objectMetrics.left;\n\n  if (deltaX || deltaY) {\n    object.moveBy(deltaX, deltaY, ['inbounds']);\n    return true;\n  }\n  return false;\n}\nexport const bumpIntoBounds = bumpObjectIntoBounds;\n\n/**\n * Creates a handler for bumping objects when they cross fixed bounds.\n *\n * @param workspace The workspace to handle.\n * @returns The event handler.\n */\nexport function bumpIntoBoundsHandler(\n  workspace: WorkspaceSvg,\n): (p1: Abstract) => void {\n  return (e) => {\n    const metricsManager = workspace.getMetricsManager();\n    if (!metricsManager.hasFixedEdges() || workspace.isDragging()) {\n      return;\n    }\n\n    if (eventUtils.BUMP_EVENTS.includes(e.type ?? '')) {\n      const scrollMetricsInWsCoords = metricsManager.getScrollMetrics(true);\n\n      // Triggered by move/create event\n      const object = extractObjectFromEvent(\n        workspace,\n        e as eventUtils.BumpEvent,\n      );\n      if (!object) {\n        return;\n      }\n      // Handle undo.\n      const existingGroup = eventUtils.getGroup() || false;\n      eventUtils.setGroup(e.group);\n\n      const wasBumped = bumpObjectIntoBounds(\n        workspace,\n        scrollMetricsInWsCoords,\n        object as IBoundedElement,\n      );\n\n      if (wasBumped && !e.group) {\n        console.warn(\n          'Moved object in bounds but there was no' +\n            ' event group. This may break undo.',\n        );\n      }\n      eventUtils.setGroup(existingGroup);\n    } else if (e.type === eventUtils.VIEWPORT_CHANGE) {\n      const viewportEvent = e as ViewportChange;\n      if (\n        viewportEvent.scale &&\n        viewportEvent.oldScale &&\n        viewportEvent.scale > viewportEvent.oldScale\n      ) {\n        bumpTopObjectsIntoBounds(workspace);\n      }\n    }\n  };\n}\n\n/**\n * Extracts the object from the given event.\n *\n * @param workspace The workspace the event originated\n *    from.\n * @param e An event containing an object.\n * @returns The extracted\n *    object.\n */\nfunction extractObjectFromEvent(\n  workspace: WorkspaceSvg,\n  e: eventUtils.BumpEvent,\n): IBoundedElement | null {\n  let object = null;\n  switch (e.type) {\n    case eventUtils.BLOCK_CREATE:\n    case eventUtils.BLOCK_MOVE:\n      object = workspace.getBlockById((e as BlockCreate | BlockMove).blockId!);\n      if (object) {\n        object = object.getRootBlock();\n      }\n      break;\n    case eventUtils.COMMENT_CREATE:\n    case eventUtils.COMMENT_MOVE:\n      object = workspace.getCommentById(\n        (e as CommentCreate | CommentMove).commentId!,\n      ) as RenderedWorkspaceComment;\n      break;\n  }\n  return object;\n}\n\n/**\n * Bumps the top objects in the given workspace into bounds.\n *\n * @param workspace The workspace.\n */\nexport function bumpTopObjectsIntoBounds(workspace: WorkspaceSvg) {\n  const metricsManager = workspace.getMetricsManager();\n  if (!metricsManager.hasFixedEdges() || workspace.isDragging()) {\n    return;\n  }\n\n  const scrollMetricsInWsCoords = metricsManager.getScrollMetrics(true);\n  const topBlocks = workspace.getTopBoundedElements();\n  for (let i = 0, block; (block = topBlocks[i]); i++) {\n    bumpObjectIntoBounds(workspace, scrollMetricsInWsCoords, block);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IDeletable\n\n/**\n * The interface for an object that can be deleted.\n */\nexport interface IDeletable {\n  /**\n   * Get whether this object is deletable or not.\n   *\n   * @returns True if deletable.\n   */\n  isDeletable(): boolean;\n\n  /** Disposes of this object, cleaning up any references or DOM elements. */\n  dispose(): void;\n\n  /** Visually indicates that the object is pending deletion. */\n  setDeleteStyle(wouldDelete: boolean): void;\n}\n\n/** Returns whether the given object is an IDeletable. */\nexport function isDeletable(obj: any): obj is IDeletable {\n  return (\n    obj['isDeletable'] !== undefined &&\n    obj['dispose'] !== undefined &&\n    obj['setDeleteStyle'] !== undefined\n  );\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.clipboard\n\nimport type {ICopyData, ICopyable} from './interfaces/i_copyable.js';\nimport {BlockPaster} from './clipboard/block_paster.js';\nimport * as globalRegistry from './registry.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\nimport * as registry from './clipboard/registry.js';\nimport {Coordinate} from './utils/coordinate.js';\n\n/** Metadata about the object that is currently on the clipboard. */\nlet stashedCopyData: ICopyData | null = null;\n\nlet stashedWorkspace: WorkspaceSvg | null = null;\n\n/**\n * Private version of copy for stubbing in tests.\n */\nfunction copyInternal<T extends ICopyData>(toCopy: ICopyable<T>): T | null {\n  const data = toCopy.toCopyData();\n  stashedCopyData = data;\n  stashedWorkspace = (toCopy as any).workspace ?? null;\n  return data;\n}\n\n/**\n * Paste a pasteable element into the workspace.\n *\n * @param copyData The data to paste into the workspace.\n * @param workspace The workspace to paste the data into.\n * @param coordinate The location to paste the thing at.\n * @returns The pasted thing if the paste was successful, null otherwise.\n */\nexport function paste<T extends ICopyData>(\n  copyData: T,\n  workspace: WorkspaceSvg,\n  coordinate?: Coordinate,\n): ICopyable<T> | null;\n\n/**\n * Pastes the last copied ICopyable into the workspace.\n *\n * @returns the pasted thing if the paste was successful, null otherwise.\n */\nexport function paste(): ICopyable<ICopyData> | null;\n\n/**\n * Pastes the given data into the workspace, or the last copied ICopyable if\n * no data is passed.\n *\n * @param copyData The data to paste into the workspace.\n * @param workspace The workspace to paste the data into.\n * @param coordinate The location to paste the thing at.\n * @returns The pasted thing if the paste was successful, null otherwise.\n */\nexport function paste<T extends ICopyData>(\n  copyData?: T,\n  workspace?: WorkspaceSvg,\n  coordinate?: Coordinate,\n): ICopyable<ICopyData> | null {\n  if (!copyData || !workspace) {\n    if (!stashedCopyData || !stashedWorkspace) return null;\n    return pasteFromData(stashedCopyData, stashedWorkspace);\n  }\n  return pasteFromData(copyData, workspace, coordinate);\n}\n\n/**\n * Paste a pasteable element into the workspace.\n *\n * @param copyData The data to paste into the workspace.\n * @param workspace The workspace to paste the data into.\n * @param coordinate The location to paste the thing at.\n * @returns The pasted thing if the paste was successful, null otherwise.\n */\nfunction pasteFromData<T extends ICopyData>(\n  copyData: T,\n  workspace: WorkspaceSvg,\n  coordinate?: Coordinate,\n): ICopyable<T> | null {\n  workspace = workspace.getRootWorkspace() ?? workspace;\n  return (globalRegistry\n    .getObject(globalRegistry.Type.PASTER, copyData.paster, false)\n    ?.paste(copyData, workspace, coordinate) ?? null) as ICopyable<T> | null;\n}\n\n/**\n * Private version of duplicate for stubbing in tests.\n */\nfunction duplicateInternal<\n  U extends ICopyData,\n  T extends ICopyable<U> & IHasWorkspace,\n>(toDuplicate: T): T | null {\n  const data = toDuplicate.toCopyData();\n  if (!data) return null;\n  return paste(data, toDuplicate.workspace) as T;\n}\n\ninterface IHasWorkspace {\n  workspace: WorkspaceSvg;\n}\n\nexport const TEST_ONLY = {\n  duplicateInternal,\n  copyInternal,\n};\n\nexport {BlockPaster, registry};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.ICopyable\n\nimport type {ISelectable} from './i_selectable.js';\n\nexport interface ICopyable<T extends ICopyData> extends ISelectable {\n  /**\n   * Encode for copying.\n   *\n   * @returns Copy metadata.\n   */\n  toCopyData(): T | null;\n}\n\nexport namespace ICopyable {\n  export interface ICopyData {\n    paster: string;\n  }\n}\n\nexport type ICopyData = ICopyable.ICopyData;\n\n/** @returns true if the given object is copyable. */\nexport function isCopyable(obj: any): obj is ICopyable<ICopyData> {\n  return obj.toCopyData !== undefined;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.ShortcutItems\n\nimport {BlockSvg} from './block_svg.js';\nimport * as clipboard from './clipboard.js';\nimport * as common from './common.js';\nimport {Gesture} from './gesture.js';\nimport {ICopyData, isCopyable} from './interfaces/i_copyable.js';\nimport {isDeletable} from './interfaces/i_deletable.js';\nimport {KeyboardShortcut, ShortcutRegistry} from './shortcut_registry.js';\nimport {KeyCodes} from './utils/keycodes.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport {isDraggable} from './interfaces/i_draggable.js';\nimport * as eventUtils from './events/utils.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport {Rect} from './utils/rect.js';\n\n/**\n * Object holding the names of the default shortcut items.\n */\nexport enum names {\n  ESCAPE = 'escape',\n  DELETE = 'delete',\n  COPY = 'copy',\n  CUT = 'cut',\n  PASTE = 'paste',\n  UNDO = 'undo',\n  REDO = 'redo',\n}\n\n/**\n * Keyboard shortcut to hide chaff on escape.\n */\nexport function registerEscape() {\n  const escapeAction: KeyboardShortcut = {\n    name: names.ESCAPE,\n    preconditionFn(workspace) {\n      return !workspace.options.readOnly;\n    },\n    callback(workspace) {\n      // AnyDuringMigration because:  Property 'hideChaff' does not exist on\n      // type 'Workspace'.\n      (workspace as AnyDuringMigration).hideChaff();\n      return true;\n    },\n    keyCodes: [KeyCodes.ESC],\n  };\n  ShortcutRegistry.registry.register(escapeAction);\n}\n\n/**\n * Keyboard shortcut to delete a block on delete or backspace\n */\nexport function registerDelete() {\n  const deleteShortcut: KeyboardShortcut = {\n    name: names.DELETE,\n    preconditionFn(workspace) {\n      const selected = common.getSelected();\n      return (\n        !workspace.options.readOnly &&\n        selected != null &&\n        isDeletable(selected) &&\n        selected.isDeletable() &&\n        !Gesture.inProgress()\n      );\n    },\n    callback(workspace, e) {\n      // Delete or backspace.\n      // Stop the browser from going back to the previous page.\n      // Do this first to prevent an error in the delete code from resulting in\n      // data loss.\n      e.preventDefault();\n      const selected = common.getSelected();\n      if (selected instanceof BlockSvg) {\n        selected.checkAndDelete();\n      } else if (isDeletable(selected) && selected.isDeletable()) {\n        eventUtils.setGroup(true);\n        selected.dispose();\n        eventUtils.setGroup(false);\n      }\n      return true;\n    },\n    keyCodes: [KeyCodes.DELETE, KeyCodes.BACKSPACE],\n  };\n  ShortcutRegistry.registry.register(deleteShortcut);\n}\n\nlet copyData: ICopyData | null = null;\nlet copyWorkspace: WorkspaceSvg | null = null;\nlet copyCoords: Coordinate | null = null;\n\n/**\n * Keyboard shortcut to copy a block on ctrl+c, cmd+c, or alt+c.\n */\nexport function registerCopy() {\n  const ctrlC = ShortcutRegistry.registry.createSerializedKey(KeyCodes.C, [\n    KeyCodes.CTRL,\n  ]);\n  const altC = ShortcutRegistry.registry.createSerializedKey(KeyCodes.C, [\n    KeyCodes.ALT,\n  ]);\n  const metaC = ShortcutRegistry.registry.createSerializedKey(KeyCodes.C, [\n    KeyCodes.META,\n  ]);\n\n  const copyShortcut: KeyboardShortcut = {\n    name: names.COPY,\n    preconditionFn(workspace) {\n      const selected = common.getSelected();\n      return (\n        !workspace.options.readOnly &&\n        !Gesture.inProgress() &&\n        selected != null &&\n        isDeletable(selected) &&\n        selected.isDeletable() &&\n        isDraggable(selected) &&\n        selected.isMovable() &&\n        isCopyable(selected)\n      );\n    },\n    callback(workspace, e) {\n      // Prevent the default copy behavior, which may beep or otherwise indicate\n      // an error due to the lack of a selection.\n      e.preventDefault();\n      workspace.hideChaff();\n      const selected = common.getSelected();\n      if (!selected || !isCopyable(selected)) return false;\n      copyData = selected.toCopyData();\n      copyWorkspace = workspace;\n      copyCoords = isDraggable(selected)\n        ? selected.getRelativeToSurfaceXY()\n        : null;\n      return !!copyData;\n    },\n    keyCodes: [ctrlC, altC, metaC],\n  };\n  ShortcutRegistry.registry.register(copyShortcut);\n}\n\n/**\n * Keyboard shortcut to copy and delete a block on ctrl+x, cmd+x, or alt+x.\n */\nexport function registerCut() {\n  const ctrlX = ShortcutRegistry.registry.createSerializedKey(KeyCodes.X, [\n    KeyCodes.CTRL,\n  ]);\n  const altX = ShortcutRegistry.registry.createSerializedKey(KeyCodes.X, [\n    KeyCodes.ALT,\n  ]);\n  const metaX = ShortcutRegistry.registry.createSerializedKey(KeyCodes.X, [\n    KeyCodes.META,\n  ]);\n\n  const cutShortcut: KeyboardShortcut = {\n    name: names.CUT,\n    preconditionFn(workspace) {\n      const selected = common.getSelected();\n      return (\n        !workspace.options.readOnly &&\n        !Gesture.inProgress() &&\n        selected != null &&\n        isDeletable(selected) &&\n        selected.isDeletable() &&\n        isDraggable(selected) &&\n        selected.isMovable() &&\n        !selected.workspace!.isFlyout\n      );\n    },\n    callback(workspace) {\n      const selected = common.getSelected();\n\n      if (selected instanceof BlockSvg) {\n        copyData = selected.toCopyData();\n        copyWorkspace = workspace;\n        copyCoords = selected.getRelativeToSurfaceXY();\n        selected.checkAndDelete();\n        return true;\n      } else if (\n        isDeletable(selected) &&\n        selected.isDeletable() &&\n        isCopyable(selected)\n      ) {\n        copyData = selected.toCopyData();\n        copyWorkspace = workspace;\n        copyCoords = isDraggable(selected)\n          ? selected.getRelativeToSurfaceXY()\n          : null;\n        selected.dispose();\n        return true;\n      }\n      return false;\n    },\n    keyCodes: [ctrlX, altX, metaX],\n  };\n\n  ShortcutRegistry.registry.register(cutShortcut);\n}\n\n/**\n * Keyboard shortcut to paste a block on ctrl+v, cmd+v, or alt+v.\n */\nexport function registerPaste() {\n  const ctrlV = ShortcutRegistry.registry.createSerializedKey(KeyCodes.V, [\n    KeyCodes.CTRL,\n  ]);\n  const altV = ShortcutRegistry.registry.createSerializedKey(KeyCodes.V, [\n    KeyCodes.ALT,\n  ]);\n  const metaV = ShortcutRegistry.registry.createSerializedKey(KeyCodes.V, [\n    KeyCodes.META,\n  ]);\n\n  const pasteShortcut: KeyboardShortcut = {\n    name: names.PASTE,\n    preconditionFn(workspace) {\n      return !workspace.options.readOnly && !Gesture.inProgress();\n    },\n    callback() {\n      if (!copyData || !copyWorkspace) return false;\n      if (!copyCoords) {\n        // If we don't have location data about the original copyable, let the\n        // paster determine position.\n        return !!clipboard.paste(copyData, copyWorkspace);\n      }\n\n      const {left, top, width, height} = copyWorkspace\n        .getMetricsManager()\n        .getViewMetrics(true);\n      const viewportRect = new Rect(top, top + height, left, left + width);\n\n      if (viewportRect.contains(copyCoords.x, copyCoords.y)) {\n        // If the original copyable is inside the viewport, let the paster\n        // determine position.\n        return !!clipboard.paste(copyData, copyWorkspace);\n      }\n\n      // Otherwise, paste in the middle of the viewport.\n      const centerCoords = new Coordinate(left + width / 2, top + height / 2);\n      return !!clipboard.paste(copyData, copyWorkspace, centerCoords);\n    },\n    keyCodes: [ctrlV, altV, metaV],\n  };\n\n  ShortcutRegistry.registry.register(pasteShortcut);\n}\n\n/**\n * Keyboard shortcut to undo the previous action on ctrl+z, cmd+z, or alt+z.\n */\nexport function registerUndo() {\n  const ctrlZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.CTRL,\n  ]);\n  const altZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.ALT,\n  ]);\n  const metaZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.META,\n  ]);\n\n  const undoShortcut: KeyboardShortcut = {\n    name: names.UNDO,\n    preconditionFn(workspace) {\n      return !workspace.options.readOnly && !Gesture.inProgress();\n    },\n    callback(workspace, e) {\n      // 'z' for undo 'Z' is for redo.\n      (workspace as WorkspaceSvg).hideChaff();\n      workspace.undo(false);\n      e.preventDefault();\n      return true;\n    },\n    keyCodes: [ctrlZ, altZ, metaZ],\n  };\n  ShortcutRegistry.registry.register(undoShortcut);\n}\n\n/**\n * Keyboard shortcut to redo the previous action on ctrl+shift+z, cmd+shift+z,\n * or alt+shift+z.\n */\nexport function registerRedo() {\n  const ctrlShiftZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.SHIFT,\n    KeyCodes.CTRL,\n  ]);\n  const altShiftZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.SHIFT,\n    KeyCodes.ALT,\n  ]);\n  const metaShiftZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.SHIFT,\n    KeyCodes.META,\n  ]);\n  // Ctrl-y is redo in Windows.  Command-y is never valid on Macs.\n  const ctrlY = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Y, [\n    KeyCodes.CTRL,\n  ]);\n\n  const redoShortcut: KeyboardShortcut = {\n    name: names.REDO,\n    preconditionFn(workspace) {\n      return !Gesture.inProgress() && !workspace.options.readOnly;\n    },\n    callback(workspace, e) {\n      // 'z' for undo 'Z' is for redo.\n      (workspace as WorkspaceSvg).hideChaff();\n      workspace.undo(true);\n      e.preventDefault();\n      return true;\n    },\n    keyCodes: [ctrlShiftZ, altShiftZ, metaShiftZ, ctrlY],\n  };\n  ShortcutRegistry.registry.register(redoShortcut);\n}\n\n/**\n * Registers all default keyboard shortcut item. This should be called once per\n * instance of KeyboardShortcutRegistry.\n *\n * @internal\n */\nexport function registerDefaultShortcuts() {\n  registerEscape();\n  registerDelete();\n  registerCopy();\n  registerCut();\n  registerPaste();\n  registerUndo();\n  registerRedo();\n}\n\nregisterDefaultShortcuts();\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IParameterModel} from '../interfaces/i_parameter_model.js';\nimport {IProcedureModel} from '../interfaces/i_procedure_model.js';\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport * as priorities from './priorities.js';\nimport type {Workspace} from '../workspace.js';\n\n/** Represents the state of a procedure model. */\nexport interface State {\n  id: string;\n  name: string;\n  returnTypes: string[] | null;\n  parameters?: ParameterState[];\n  [key: string]: unknown;\n}\n\n/** Represents the state of a parameter model. */\nexport interface ParameterState {\n  id: string;\n  name: string;\n  types?: string[];\n  [key: string]: unknown;\n}\n\n/**\n * A newable signature for an IProcedureModel.\n *\n * Refer to\n * https://www.typescriptlang.org/docs/handbook/interfaces.html#difference-between-the-static-and-instance-sides-of-classes\n * for what is going on with this.\n */\ninterface ProcedureModelConstructor<ProcedureModel extends IProcedureModel> {\n  new (workspace: Workspace, name: string, id: string): ProcedureModel;\n\n  /**\n   * Deserializes the JSON state and returns a procedure model.\n   *\n   * @param state The state to deserialize.\n   * @param workspace The workspace to load the procedure model into.\n   * @returns The constructed procedure model.\n   */\n  loadState(state: Object, workspace: Workspace): ProcedureModel;\n}\n\n/**\n * A newable signature for an IParameterModel.\n *\n * Refer to\n * https://www.typescriptlang.org/docs/handbook/interfaces.html#difference-between-the-static-and-instance-sides-of-classes\n * for what is going on with this.\n */\ninterface ParameterModelConstructor<ParameterModel extends IParameterModel> {\n  new (workspace: Workspace, name: string, id: string): ParameterModel;\n\n  /**\n   * Deserializes the JSON state and returns a parameter model.\n   *\n   * @param state The state to deserialize.\n   * @param workspace The workspace to load the parameter model into.\n   * @returns The constructed parameter model.\n   */\n  loadState(state: Object, workspace: Workspace): ParameterModel;\n}\n\n/**\n * Serializes the given IProcedureModel to JSON.\n */\nexport function saveProcedure(proc: IProcedureModel): State {\n  const state: State = proc.saveState();\n  if (!proc.getParameters().length) return state;\n  state.parameters = proc.getParameters().map((param) => param.saveState());\n  return state;\n}\n\n/**\n * Deserializes the given procedure model State from JSON.\n */\nexport function loadProcedure<\n  ProcedureModel extends IProcedureModel,\n  ParameterModel extends IParameterModel,\n>(\n  procedureModelClass: ProcedureModelConstructor<ProcedureModel>,\n  parameterModelClass: ParameterModelConstructor<ParameterModel>,\n  state: State,\n  workspace: Workspace,\n): ProcedureModel {\n  const proc = procedureModelClass.loadState(state, workspace);\n  if (!state.parameters) return proc;\n  for (const [index, param] of state.parameters.entries()) {\n    proc.insertParameter(\n      parameterModelClass.loadState(param, workspace),\n      index,\n    );\n  }\n  return proc;\n}\n\n/** Serializer for saving and loading procedure state. */\nexport class ProcedureSerializer<\n  ProcedureModel extends IProcedureModel,\n  ParameterModel extends IParameterModel,\n> implements ISerializer\n{\n  public priority = priorities.PROCEDURES;\n\n  /**\n   * Constructs the procedure serializer.\n   *\n   * Example usage:\n   *   new ProcedureSerializer(MyProcedureModelClass, MyParameterModelClass)\n   *\n   * @param procedureModelClass The class (implementing IProcedureModel) that\n   *     you want this serializer to deserialize.\n   * @param parameterModelClass The class (implementing IParameterModel) that\n   *     you want this serializer to deserialize.\n   */\n  constructor(\n    private readonly procedureModelClass: ProcedureModelConstructor<ProcedureModel>,\n    private readonly parameterModelClass: ParameterModelConstructor<ParameterModel>,\n  ) {}\n\n  /** Serializes the procedure models of the given workspace. */\n  save(workspace: Workspace): State[] | null {\n    const save = workspace\n      .getProcedureMap()\n      .getProcedures()\n      .map((proc) => saveProcedure(proc));\n    return save.length ? save : null;\n  }\n\n  /**\n   * Deserializes the procedures models defined by the given state into the\n   * workspace.\n   */\n  load(state: State[], workspace: Workspace) {\n    const map = workspace.getProcedureMap();\n    for (const procState of state) {\n      map.add(\n        loadProcedure(\n          this.procedureModelClass,\n          this.parameterModelClass,\n          procState,\n          workspace,\n        ),\n      );\n    }\n  }\n\n  /** Disposes of any procedure models that exist on the workspace. */\n  clear(workspace: Workspace) {\n    workspace.getProcedureMap().clear();\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.serialization.workspaces\n\nimport * as eventUtils from '../events/utils.js';\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport * as registry from '../registry.js';\nimport * as dom from '../utils/dom.js';\n// eslint-disable-next-line no-unused-vars\nimport type {Workspace} from '../workspace.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\n\n/**\n * Returns the state of the workspace as a plain JavaScript object.\n *\n * @param workspace The workspace to serialize.\n * @returns The serialized state of the workspace.\n */\nexport function save(workspace: Workspace): {\n  [key: string]: AnyDuringMigration;\n} {\n  const state = Object.create(null);\n  const serializerMap = registry.getAllItems(registry.Type.SERIALIZER, true);\n  for (const key in serializerMap) {\n    const save = (serializerMap[key] as ISerializer)?.save(workspace);\n    if (save) {\n      state[key] = save;\n    }\n  }\n  return state;\n}\n\n/**\n * Loads the variable represented by the given state into the given workspace.\n *\n * @param state The state of the workspace to deserialize into the workspace.\n * @param workspace The workspace to add the new state to.\n * @param param1 recordUndo: If true, events triggered by this function will be\n *     undo-able by the user. False by default.\n */\nexport function load(\n  state: {[key: string]: AnyDuringMigration},\n  workspace: Workspace,\n  {recordUndo = false}: {recordUndo?: boolean} = {},\n) {\n  const serializerMap = registry.getAllItems(registry.Type.SERIALIZER, true);\n  if (!serializerMap) {\n    return;\n  }\n\n  const deserializers = Object.entries(serializerMap).sort(\n    (a, b) => (b[1] as ISerializer)!.priority - (a[1] as ISerializer)!.priority,\n  );\n\n  const prevRecordUndo = eventUtils.getRecordUndo();\n  eventUtils.setRecordUndo(recordUndo);\n  const existingGroup = eventUtils.getGroup();\n  if (!existingGroup) {\n    eventUtils.setGroup(true);\n  }\n\n  dom.startTextWidthCache();\n  if (workspace instanceof WorkspaceSvg) {\n    workspace.setResizesEnabled(false);\n  }\n\n  // We want to trigger clearing in reverse priority order so plugins don't end\n  // up missing dependencies.\n  for (const [, deserializer] of deserializers.reverse()) {\n    (deserializer as ISerializer)?.clear(workspace);\n  }\n\n  // reverse() is destructive, so we have to re-reverse to correct the order.\n  for (const [name, deserializer] of deserializers.reverse()) {\n    const pluginState = state[name];\n    if (pluginState) {\n      (deserializer as ISerializer)?.load(state[name], workspace);\n    }\n  }\n\n  if (workspace instanceof WorkspaceSvg) {\n    workspace.setResizesEnabled(true);\n  }\n  dom.stopTextWidthCache();\n\n  eventUtils.fire(new (eventUtils.get(eventUtils.FINISHED_LOADING))(workspace));\n\n  eventUtils.setGroup(existingGroup);\n  eventUtils.setRecordUndo(prevRecordUndo);\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.inject\n\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as browserEvents from './browser_events.js';\nimport * as bumpObjects from './bump_objects.js';\nimport * as common from './common.js';\nimport * as Css from './css.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {Grid} from './grid.js';\nimport {Msg} from './msg.js';\nimport {Options} from './options.js';\nimport {ScrollbarPair} from './scrollbar_pair.js';\nimport {ShortcutRegistry} from './shortcut_registry.js';\nimport * as Tooltip from './tooltip.js';\nimport * as Touch from './touch.js';\nimport * as aria from './utils/aria.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Inject a Blockly editor into the specified container element (usually a div).\n *\n * @param container Containing element, or its ID, or a CSS selector.\n * @param opt_options Optional dictionary of options.\n * @returns Newly created main workspace.\n */\nexport function inject(\n  container: Element | string,\n  opt_options?: BlocklyOptions,\n): WorkspaceSvg {\n  let containerElement: Element | null = null;\n  if (typeof container === 'string') {\n    containerElement =\n      document.getElementById(container) || document.querySelector(container);\n  } else {\n    containerElement = container;\n  }\n  // Verify that the container is in document.\n  if (\n    !document.contains(containerElement) &&\n    document !== containerElement?.ownerDocument\n  ) {\n    throw Error('Error: container is not in current document');\n  }\n  const options = new Options(opt_options || ({} as BlocklyOptions));\n  const subContainer = document.createElement('div');\n  dom.addClass(subContainer, 'injectionDiv');\n  if (opt_options?.rtl) {\n    dom.addClass(subContainer, 'blocklyRTL');\n  }\n  subContainer.tabIndex = 0;\n  aria.setState(subContainer, aria.State.LABEL, Msg['WORKSPACE_ARIA_LABEL']);\n\n  containerElement!.appendChild(subContainer);\n  const svg = createDom(subContainer, options);\n\n  const workspace = createMainWorkspace(subContainer, svg, options);\n\n  init(workspace);\n\n  // Keep focus on the first workspace so entering keyboard navigation looks\n  // correct.\n  common.setMainWorkspace(workspace);\n\n  common.svgResize(workspace);\n\n  subContainer.addEventListener('focusin', function () {\n    common.setMainWorkspace(workspace);\n  });\n\n  return workspace;\n}\n\n/**\n * Create the SVG image.\n *\n * @param container Containing element.\n * @param options Dictionary of options.\n * @returns Newly created SVG image.\n */\nfunction createDom(container: Element, options: Options): SVGElement {\n  // Sadly browsers (Chrome vs Firefox) are currently inconsistent in laying\n  // out content in RTL mode.  Therefore Blockly forces the use of LTR,\n  // then manually positions content in RTL as needed.\n  container.setAttribute('dir', 'LTR');\n\n  // Load CSS.\n  Css.inject(options.hasCss, options.pathToMedia);\n\n  // Build the SVG DOM.\n  /*\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlns:html=\"http://www.w3.org/1999/xhtml\"\n      xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n      version=\"1.1\"\n      class=\"blocklySvg\">\n      ...\n    </svg>\n    */\n  const svg = dom.createSvgElement(\n    Svg.SVG,\n    {\n      'xmlns': dom.SVG_NS,\n      'xmlns:html': dom.HTML_NS,\n      'xmlns:xlink': dom.XLINK_NS,\n      'version': '1.1',\n      'class': 'blocklySvg',\n      'tabindex': '0',\n    },\n    container,\n  );\n  /*\n    <defs>\n      ... filters go here ...\n    </defs>\n    */\n  const defs = dom.createSvgElement(Svg.DEFS, {}, svg);\n  // Each filter/pattern needs a unique ID for the case of multiple Blockly\n  // instances on a page.  Browser behaviour becomes undefined otherwise.\n  // https://neil.fraser.name/news/2015/11/01/\n  const rnd = String(Math.random()).substring(2);\n\n  options.gridPattern = Grid.createDom(rnd, options.gridOptions, defs);\n  return svg;\n}\n\n/**\n * Create a main workspace and add it to the SVG.\n *\n * @param svg SVG element with pattern defined.\n * @param options Dictionary of options.\n * @returns Newly created main workspace.\n */\nfunction createMainWorkspace(\n  injectionDiv: Element,\n  svg: SVGElement,\n  options: Options,\n): WorkspaceSvg {\n  options.parentWorkspace = null;\n  const mainWorkspace = new WorkspaceSvg(options);\n  const wsOptions = mainWorkspace.options;\n  mainWorkspace.scale = wsOptions.zoomOptions.startScale;\n  svg.appendChild(\n    mainWorkspace.createDom('blocklyMainBackground', injectionDiv),\n  );\n\n  // Set the theme name and renderer name onto the injection div.\n  const rendererClassName = mainWorkspace.getRenderer().getClassName();\n  if (rendererClassName) {\n    dom.addClass(injectionDiv, rendererClassName);\n  }\n  const themeClassName = mainWorkspace.getTheme().getClassName();\n  if (themeClassName) {\n    dom.addClass(injectionDiv, themeClassName);\n  }\n\n  if (!wsOptions.hasCategories && wsOptions.languageTree) {\n    // Add flyout as an <svg> that is a sibling of the workspace SVG.\n    const flyout = mainWorkspace.addFlyout(Svg.SVG);\n    dom.insertAfter(flyout, svg);\n  }\n  if (wsOptions.hasTrashcan) {\n    mainWorkspace.addTrashcan();\n  }\n  if (wsOptions.zoomOptions && wsOptions.zoomOptions.controls) {\n    mainWorkspace.addZoomControls();\n  }\n  // Register the workspace svg as a UI component.\n  mainWorkspace\n    .getThemeManager()\n    .subscribe(svg, 'workspaceBackgroundColour', 'background-color');\n\n  // A null translation will also apply the correct initial scale.\n  mainWorkspace.translate(0, 0);\n\n  mainWorkspace.addChangeListener(\n    bumpObjects.bumpIntoBoundsHandler(mainWorkspace),\n  );\n\n  // The SVG is now fully assembled.\n  common.svgResize(mainWorkspace);\n  WidgetDiv.createDom();\n  dropDownDiv.createDom();\n  Tooltip.createDom();\n  return mainWorkspace;\n}\n\n/**\n * Initialize Blockly with various handlers.\n *\n * @param mainWorkspace Newly created main workspace.\n */\nfunction init(mainWorkspace: WorkspaceSvg) {\n  const options = mainWorkspace.options;\n  const svg = mainWorkspace.getParentSvg();\n\n  // Suppress the browser's context menu.\n  browserEvents.conditionalBind(\n    svg.parentNode as Element,\n    'contextmenu',\n    null,\n    function (e: Event) {\n      if (!browserEvents.isTargetInput(e)) {\n        e.preventDefault();\n      }\n    },\n  );\n\n  const workspaceResizeHandler = browserEvents.conditionalBind(\n    window,\n    'resize',\n    null,\n    function () {\n      // Don't hide all the chaff. Leave the dropdown and widget divs open if\n      // possible.\n      Tooltip.hide();\n      mainWorkspace.hideComponents(true);\n      dropDownDiv.repositionForWindowResize();\n      WidgetDiv.repositionForWindowResize();\n      common.svgResize(mainWorkspace);\n      bumpObjects.bumpTopObjectsIntoBounds(mainWorkspace);\n    },\n  );\n  mainWorkspace.setResizeHandlerWrapper(workspaceResizeHandler);\n\n  bindDocumentEvents();\n\n  if (options.languageTree) {\n    const toolbox = mainWorkspace.getToolbox();\n    const flyout = mainWorkspace.getFlyout(true);\n    if (toolbox) {\n      toolbox.init();\n    } else if (flyout) {\n      // Build a fixed flyout with the root blocks.\n      flyout.init(mainWorkspace);\n      flyout.show(options.languageTree);\n      if (typeof flyout.scrollToStart === 'function') {\n        flyout.scrollToStart();\n      }\n    }\n  }\n\n  if (options.hasTrashcan) {\n    mainWorkspace.trashcan!.init();\n  }\n  if (options.zoomOptions && options.zoomOptions.controls) {\n    mainWorkspace.zoomControls_!.init();\n  }\n\n  if (options.moveOptions && options.moveOptions.scrollbars) {\n    const horizontalScroll =\n      options.moveOptions.scrollbars === true ||\n      !!options.moveOptions.scrollbars.horizontal;\n    const verticalScroll =\n      options.moveOptions.scrollbars === true ||\n      !!options.moveOptions.scrollbars.vertical;\n    mainWorkspace.scrollbar = new ScrollbarPair(\n      mainWorkspace,\n      horizontalScroll,\n      verticalScroll,\n      'blocklyMainWorkspaceScrollbar',\n    );\n    mainWorkspace.scrollbar.resize();\n  } else {\n    mainWorkspace.setMetrics({x: 0.5, y: 0.5});\n  }\n\n  // Load the sounds.\n  if (options.hasSounds) {\n    loadSounds(options.pathToMedia, mainWorkspace);\n  }\n}\n\n/**\n * Handle a key-down on SVG drawing surface. Does nothing if the main workspace\n * is not visible.\n *\n * @param e Key down event.\n */\n// TODO (https://github.com/google/blockly/issues/1998) handle cases where there\n// are multiple workspaces and non-main workspaces are able to accept input.\nfunction onKeyDown(e: KeyboardEvent) {\n  const mainWorkspace = common.getMainWorkspace() as WorkspaceSvg;\n  if (!mainWorkspace) {\n    return;\n  }\n\n  if (\n    browserEvents.isTargetInput(e) ||\n    (mainWorkspace.rendered && !mainWorkspace.isVisible())\n  ) {\n    // When focused on an HTML text input widget, don't trap any keys.\n    // Ignore keypresses on rendered workspaces that have been explicitly\n    // hidden.\n    return;\n  }\n  ShortcutRegistry.registry.onKeyDown(mainWorkspace, e);\n}\n\n/**\n * Whether event handlers have been bound. Document event handlers will only\n * be bound once, even if Blockly is destroyed and reinjected.\n */\nlet documentEventsBound = false;\n\n/**\n * Bind document events, but only once.  Destroying and reinjecting Blockly\n * should not bind again.\n * Bind events for scrolling the workspace.\n * Most of these events should be bound to the SVG's surface.\n * However, 'mouseup' has to be on the whole document so that a block dragged\n * out of bounds and released will know that it has been released.\n * Also, 'keydown' has to be on the whole document since the browser doesn't\n * understand a concept of focus on the SVG image.\n */\nfunction bindDocumentEvents() {\n  if (!documentEventsBound) {\n    browserEvents.conditionalBind(document, 'scroll', null, function () {\n      const workspaces = common.getAllWorkspaces();\n      for (let i = 0, workspace; (workspace = workspaces[i]); i++) {\n        if (workspace instanceof WorkspaceSvg) {\n          workspace.updateInverseScreenCTM();\n        }\n      }\n    });\n    browserEvents.conditionalBind(document, 'keydown', null, onKeyDown);\n    // longStop needs to run to stop the context menu from showing up.  It\n    // should run regardless of what other touch event handlers have run.\n    browserEvents.bind(document, 'touchend', null, Touch.longStop);\n    browserEvents.bind(document, 'touchcancel', null, Touch.longStop);\n    // Some iPad versions don't fire resize after portrait to landscape change.\n    if (userAgent.IPAD) {\n      browserEvents.conditionalBind(\n        window,\n        'orientationchange',\n        document,\n        function () {\n          // TODO (#397): Fix for multiple Blockly workspaces.\n          common.svgResize(common.getMainWorkspace() as WorkspaceSvg);\n        },\n      );\n    }\n  }\n  documentEventsBound = true;\n}\n\n/**\n * Load sounds for the given workspace.\n *\n * @param pathToMedia The path to the media directory.\n * @param workspace The workspace to load sounds for.\n */\nfunction loadSounds(pathToMedia: string, workspace: WorkspaceSvg) {\n  const audioMgr = workspace.getAudioManager();\n  audioMgr.load(\n    [\n      pathToMedia + 'click.mp3',\n      pathToMedia + 'click.wav',\n      pathToMedia + 'click.ogg',\n    ],\n    'click',\n  );\n  audioMgr.load(\n    [\n      pathToMedia + 'disconnect.wav',\n      pathToMedia + 'disconnect.mp3',\n      pathToMedia + 'disconnect.ogg',\n    ],\n    'disconnect',\n  );\n  audioMgr.load(\n    [\n      pathToMedia + 'delete.mp3',\n      pathToMedia + 'delete.ogg',\n      pathToMedia + 'delete.wav',\n    ],\n    'delete',\n  );\n\n  // Bind temporary hooks that preload the sounds.\n  const soundBinds: browserEvents.Data[] = [];\n  /**\n   *\n   */\n  function unbindSounds() {\n    while (soundBinds.length) {\n      const oldSoundBinding = soundBinds.pop();\n      if (oldSoundBinding) {\n        browserEvents.unbind(oldSoundBinding);\n      }\n    }\n    audioMgr.preload();\n  }\n\n  // These are bound on mouse/touch events with\n  // Blockly.browserEvents.conditionalBind, so they restrict the touch\n  // identifier that will be recognized.  But this is really something that\n  // happens on a click, not a drag, so that's not necessary.\n\n  // Android ignores any sound not loaded as a result of a user action.\n  soundBinds.push(\n    browserEvents.conditionalBind(\n      document,\n      'pointermove',\n      null,\n      unbindSounds,\n      true,\n    ),\n  );\n  soundBinds.push(\n    browserEvents.conditionalBind(\n      document,\n      'touchstart',\n      null,\n      unbindSounds,\n      true,\n    ),\n  );\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.ContextMenuItems\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as clipboard from './clipboard.js';\nimport {RenderedWorkspaceComment} from './comments/rendered_workspace_comment.js';\nimport {\n  ContextMenuRegistry,\n  RegistryItem,\n  Scope,\n} from './contextmenu_registry.js';\nimport {MANUALLY_DISABLED} from './constants.js';\nimport * as dialog from './dialog.js';\nimport * as Events from './events/events.js';\nimport * as eventUtils from './events/utils.js';\nimport {CommentIcon} from './icons/comment_icon.js';\nimport {Msg} from './msg.js';\nimport {StatementInput} from './renderers/zelos/zelos.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as common from './common.js';\n\n/**\n * Option to undo previous action.\n */\nexport function registerUndo() {\n  const undoOption: RegistryItem = {\n    displayText() {\n      return Msg['UNDO'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.getUndoStack().length > 0) {\n        return 'enabled';\n      }\n      return 'disabled';\n    },\n    callback(scope: Scope) {\n      scope.workspace!.undo(false);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'undoWorkspace',\n    weight: 1,\n  };\n  ContextMenuRegistry.registry.register(undoOption);\n}\n\n/**\n * Option to redo previous action.\n */\nexport function registerRedo() {\n  const redoOption: RegistryItem = {\n    displayText() {\n      return Msg['REDO'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.getRedoStack().length > 0) {\n        return 'enabled';\n      }\n      return 'disabled';\n    },\n    callback(scope: Scope) {\n      scope.workspace!.undo(true);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'redoWorkspace',\n    weight: 2,\n  };\n  ContextMenuRegistry.registry.register(redoOption);\n}\n\n/**\n * Option to clean up blocks.\n */\nexport function registerCleanup() {\n  const cleanOption: RegistryItem = {\n    displayText() {\n      return Msg['CLEAN_UP'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.isMovable()) {\n        if (scope.workspace!.getTopBlocks(false).length > 1) {\n          return 'enabled';\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.workspace!.cleanUp();\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'cleanWorkspace',\n    weight: 3,\n  };\n  ContextMenuRegistry.registry.register(cleanOption);\n}\n/**\n * Creates a callback to collapse or expand top blocks.\n *\n * @param shouldCollapse Whether a block should collapse.\n * @param topBlocks Top blocks in the workspace.\n */\nfunction toggleOption_(shouldCollapse: boolean, topBlocks: BlockSvg[]) {\n  const DELAY = 10;\n  let ms = 0;\n  let timeoutCounter = 0;\n  function timeoutFn(block: BlockSvg) {\n    timeoutCounter--;\n    block.setCollapsed(shouldCollapse);\n    if (timeoutCounter === 0) {\n      Events.setGroup(false);\n    }\n  }\n  Events.setGroup(true);\n  for (let i = 0; i < topBlocks.length; i++) {\n    let block: BlockSvg | null = topBlocks[i];\n    while (block) {\n      timeoutCounter++;\n      setTimeout(timeoutFn.bind(null, block), ms);\n      block = block.getNextBlock();\n      ms += DELAY;\n    }\n  }\n}\n\n/**\n * Option to collapse all blocks.\n */\nexport function registerCollapse() {\n  const collapseOption: RegistryItem = {\n    displayText() {\n      return Msg['COLLAPSE_ALL'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.options.collapse) {\n        const topBlocks = scope.workspace!.getTopBlocks(false);\n        for (let i = 0; i < topBlocks.length; i++) {\n          let block: BlockSvg | null = topBlocks[i];\n          while (block) {\n            if (!block.isCollapsed()) {\n              return 'enabled';\n            }\n            block = block.getNextBlock();\n          }\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      toggleOption_(true, scope.workspace!.getTopBlocks(true));\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'collapseWorkspace',\n    weight: 4,\n  };\n  ContextMenuRegistry.registry.register(collapseOption);\n}\n\n/**\n * Option to expand all blocks.\n */\nexport function registerExpand() {\n  const expandOption: RegistryItem = {\n    displayText() {\n      return Msg['EXPAND_ALL'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.options.collapse) {\n        const topBlocks = scope.workspace!.getTopBlocks(false);\n        for (let i = 0; i < topBlocks.length; i++) {\n          let block: BlockSvg | null = topBlocks[i];\n          while (block) {\n            if (block.isCollapsed()) {\n              return 'enabled';\n            }\n            block = block.getNextBlock();\n          }\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      toggleOption_(false, scope.workspace!.getTopBlocks(true));\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'expandWorkspace',\n    weight: 5,\n  };\n  ContextMenuRegistry.registry.register(expandOption);\n}\n/**\n * Adds a block and its children to a list of deletable blocks.\n *\n * @param block to delete.\n * @param deleteList list of blocks that can be deleted.\n *     This will be modified in place with the given block and its descendants.\n */\nfunction addDeletableBlocks_(block: BlockSvg, deleteList: BlockSvg[]) {\n  if (block.isDeletable()) {\n    Array.prototype.push.apply(deleteList, block.getDescendants(false));\n  } else {\n    const children = block.getChildren(false);\n    for (let i = 0; i < children.length; i++) {\n      addDeletableBlocks_(children[i], deleteList);\n    }\n  }\n}\n\n/**\n * Constructs a list of blocks that can be deleted in the given workspace.\n *\n * @param workspace to delete all blocks from.\n * @returns list of blocks to delete.\n */\nfunction getDeletableBlocks_(workspace: WorkspaceSvg): BlockSvg[] {\n  const deleteList: BlockSvg[] = [];\n  const topBlocks = workspace.getTopBlocks(true);\n  for (let i = 0; i < topBlocks.length; i++) {\n    addDeletableBlocks_(topBlocks[i], deleteList);\n  }\n  return deleteList;\n}\n\n/**\n * Deletes the given blocks. Used to delete all blocks in the workspace.\n *\n * @param deleteList List of blocks to delete.\n * @param eventGroup Event group ID with which all delete events should be\n *     associated.  If not specified, create a new group.\n */\nfunction deleteNext_(deleteList: BlockSvg[], eventGroup?: string) {\n  const DELAY = 10;\n  if (eventGroup) {\n    eventUtils.setGroup(eventGroup);\n  } else {\n    eventUtils.setGroup(true);\n    eventGroup = eventUtils.getGroup();\n  }\n  const block = deleteList.shift();\n  if (block) {\n    if (!block.isDeadOrDying()) {\n      block.dispose(false, true);\n      setTimeout(deleteNext_, DELAY, deleteList, eventGroup);\n    } else {\n      deleteNext_(deleteList, eventGroup);\n    }\n  }\n  eventUtils.setGroup(false);\n}\n\n/**\n * Option to delete all blocks.\n */\nexport function registerDeleteAll() {\n  const deleteOption: RegistryItem = {\n    displayText(scope: Scope) {\n      if (!scope.workspace) {\n        return '';\n      }\n      const deletableBlocksLength = getDeletableBlocks_(scope.workspace).length;\n      if (deletableBlocksLength === 1) {\n        return Msg['DELETE_BLOCK'];\n      }\n      return Msg['DELETE_X_BLOCKS'].replace('%1', `${deletableBlocksLength}`);\n    },\n    preconditionFn(scope: Scope) {\n      if (!scope.workspace) {\n        return 'disabled';\n      }\n      const deletableBlocksLength = getDeletableBlocks_(scope.workspace).length;\n      return deletableBlocksLength > 0 ? 'enabled' : 'disabled';\n    },\n    callback(scope: Scope) {\n      if (!scope.workspace) {\n        return;\n      }\n      scope.workspace.cancelCurrentGesture();\n      const deletableBlocks = getDeletableBlocks_(scope.workspace);\n      if (deletableBlocks.length < 2) {\n        deleteNext_(deletableBlocks);\n      } else {\n        dialog.confirm(\n          Msg['DELETE_ALL_BLOCKS'].replace(\n            '%1',\n            String(deletableBlocks.length),\n          ),\n          function (ok) {\n            if (ok) {\n              deleteNext_(deletableBlocks);\n            }\n          },\n        );\n      }\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'workspaceDelete',\n    weight: 6,\n  };\n  ContextMenuRegistry.registry.register(deleteOption);\n}\n/** Registers all workspace-scoped context menu items. */\nfunction registerWorkspaceOptions_() {\n  registerUndo();\n  registerRedo();\n  registerCleanup();\n  registerCollapse();\n  registerExpand();\n  registerDeleteAll();\n}\n\n/**\n * Option to duplicate a block.\n */\nexport function registerDuplicate() {\n  const duplicateOption: RegistryItem = {\n    displayText() {\n      return Msg['DUPLICATE_BLOCK'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (!block!.isInFlyout && block!.isDeletable() && block!.isMovable()) {\n        if (block!.isDuplicatable()) {\n          return 'enabled';\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      if (!scope.block) return;\n      const data = scope.block.toCopyData();\n      if (!data) return;\n      clipboard.paste(data, scope.block.workspace);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockDuplicate',\n    weight: 1,\n  };\n  ContextMenuRegistry.registry.register(duplicateOption);\n}\n\n/**\n * Option to add or remove block-level comment.\n */\nexport function registerComment() {\n  const commentOption: RegistryItem = {\n    displayText(scope: Scope) {\n      if (scope.block!.hasIcon(CommentIcon.TYPE)) {\n        // If there's already a comment,  option is to remove.\n        return Msg['REMOVE_COMMENT'];\n      }\n      // If there's no comment yet, option is to add.\n      return Msg['ADD_COMMENT'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (\n        !block!.isInFlyout &&\n        block!.workspace.options.comments &&\n        !block!.isCollapsed() &&\n        block!.isEditable()\n      ) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      const block = scope.block;\n      if (block!.hasIcon(CommentIcon.TYPE)) {\n        block!.setCommentText(null);\n      } else {\n        block!.setCommentText('');\n      }\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockComment',\n    weight: 2,\n  };\n  ContextMenuRegistry.registry.register(commentOption);\n}\n\n/**\n * Option to inline variables.\n */\nexport function registerInline() {\n  const inlineOption: RegistryItem = {\n    displayText(scope: Scope) {\n      return scope.block!.getInputsInline()\n        ? Msg['EXTERNAL_INPUTS']\n        : Msg['INLINE_INPUTS'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (!block!.isInFlyout && block!.isMovable() && !block!.isCollapsed()) {\n        for (let i = 1; i < block!.inputList.length; i++) {\n          // Only display this option if there are two value or dummy inputs\n          // next to each other.\n          if (\n            !(block!.inputList[i - 1] instanceof StatementInput) &&\n            !(block!.inputList[i] instanceof StatementInput)\n          ) {\n            return 'enabled';\n          }\n        }\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.block!.setInputsInline(!scope.block!.getInputsInline());\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockInline',\n    weight: 3,\n  };\n  ContextMenuRegistry.registry.register(inlineOption);\n}\n\n/**\n * Option to collapse or expand a block.\n */\nexport function registerCollapseExpandBlock() {\n  const collapseExpandOption: RegistryItem = {\n    displayText(scope: Scope) {\n      return scope.block!.isCollapsed()\n        ? Msg['EXPAND_BLOCK']\n        : Msg['COLLAPSE_BLOCK'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (\n        !block!.isInFlyout &&\n        block!.isMovable() &&\n        block!.workspace.options.collapse\n      ) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.block!.setCollapsed(!scope.block!.isCollapsed());\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockCollapseExpand',\n    weight: 4,\n  };\n  ContextMenuRegistry.registry.register(collapseExpandOption);\n}\n\n/**\n * Option to disable or enable a block.\n */\nexport function registerDisable() {\n  const disableOption: RegistryItem = {\n    displayText(scope: Scope) {\n      return scope.block!.hasDisabledReason(MANUALLY_DISABLED)\n        ? Msg['ENABLE_BLOCK']\n        : Msg['DISABLE_BLOCK'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (\n        !block!.isInFlyout &&\n        block!.workspace.options.disable &&\n        block!.isEditable()\n      ) {\n        // Determine whether this block is currently disabled for any reason\n        // other than the manual reason that this context menu item controls.\n        const disabledReasons = block!.getDisabledReasons();\n        const isDisabledForOtherReason =\n          disabledReasons.size >\n          (disabledReasons.has(MANUALLY_DISABLED) ? 1 : 0);\n\n        if (block!.getInheritedDisabled() || isDisabledForOtherReason) {\n          return 'disabled';\n        }\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      const block = scope.block;\n      const existingGroup = eventUtils.getGroup();\n      if (!existingGroup) {\n        eventUtils.setGroup(true);\n      }\n      block!.setDisabledReason(\n        !block!.hasDisabledReason(MANUALLY_DISABLED),\n        MANUALLY_DISABLED,\n      );\n      eventUtils.setGroup(existingGroup);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockDisable',\n    weight: 5,\n  };\n  ContextMenuRegistry.registry.register(disableOption);\n}\n\n/**\n * Option to delete a block.\n */\nexport function registerDelete() {\n  const deleteOption: RegistryItem = {\n    displayText(scope: Scope) {\n      const block = scope.block;\n      // Count the number of blocks that are nested in this block.\n      let descendantCount = block!.getDescendants(false).length;\n      const nextBlock = block!.getNextBlock();\n      if (nextBlock) {\n        // Blocks in the current stack would survive this block's deletion.\n        descendantCount -= nextBlock.getDescendants(false).length;\n      }\n      return descendantCount === 1\n        ? Msg['DELETE_BLOCK']\n        : Msg['DELETE_X_BLOCKS'].replace('%1', `${descendantCount}`);\n    },\n    preconditionFn(scope: Scope) {\n      if (!scope.block!.isInFlyout && scope.block!.isDeletable()) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      if (scope.block) {\n        scope.block.checkAndDelete();\n      }\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockDelete',\n    weight: 6,\n  };\n  ContextMenuRegistry.registry.register(deleteOption);\n}\n\n/**\n * Option to open help for a block.\n */\nexport function registerHelp() {\n  const helpOption: RegistryItem = {\n    displayText() {\n      return Msg['HELP'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      const url =\n        typeof block!.helpUrl === 'function'\n          ? block!.helpUrl()\n          : block!.helpUrl;\n      if (url) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.block!.showHelp();\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockHelp',\n    weight: 7,\n  };\n  ContextMenuRegistry.registry.register(helpOption);\n}\n\n/** Registers an option for deleting a workspace comment. */\nexport function registerCommentDelete() {\n  const deleteOption: RegistryItem = {\n    displayText: () => Msg['REMOVE_COMMENT'],\n    preconditionFn(scope: Scope) {\n      return scope.comment?.isDeletable() ? 'enabled' : 'hidden';\n    },\n    callback(scope: Scope) {\n      eventUtils.setGroup(true);\n      scope.comment?.dispose();\n      eventUtils.setGroup(false);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.COMMENT,\n    id: 'commentDelete',\n    weight: 6,\n  };\n  ContextMenuRegistry.registry.register(deleteOption);\n}\n\n/** Registers an option for duplicating a workspace comment. */\nexport function registerCommentDuplicate() {\n  const duplicateOption: RegistryItem = {\n    displayText: () => Msg['DUPLICATE_COMMENT'],\n    preconditionFn(scope: Scope) {\n      return scope.comment?.isMovable() ? 'enabled' : 'hidden';\n    },\n    callback(scope: Scope) {\n      if (!scope.comment) return;\n      const data = scope.comment.toCopyData();\n      if (!data) return;\n      clipboard.paste(data, scope.comment.workspace);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.COMMENT,\n    id: 'commentDuplicate',\n    weight: 1,\n  };\n  ContextMenuRegistry.registry.register(duplicateOption);\n}\n\n/** Registers an option for adding a workspace comment to the workspace. */\nexport function registerCommentCreate() {\n  const createOption: RegistryItem = {\n    displayText: () => Msg['ADD_COMMENT'],\n    preconditionFn: () => 'enabled',\n    callback: (scope: Scope, e: PointerEvent) => {\n      const workspace = scope.workspace;\n      if (!workspace) return;\n      eventUtils.setGroup(true);\n      const comment = new RenderedWorkspaceComment(workspace);\n      comment.setText(Msg['WORKSPACE_COMMENT_DEFAULT_TEXT']);\n      comment.moveTo(\n        pixelsToWorkspaceCoords(\n          new Coordinate(e.clientX, e.clientY),\n          workspace,\n        ),\n      );\n      common.setSelected(comment);\n      eventUtils.setGroup(false);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'commentCreate',\n    weight: 8,\n  };\n  ContextMenuRegistry.registry.register(createOption);\n}\n\n/**\n * Converts pixel coordinates (relative to the window) to workspace coordinates.\n */\nfunction pixelsToWorkspaceCoords(\n  pixelCoord: Coordinate,\n  workspace: WorkspaceSvg,\n): Coordinate {\n  const injectionDiv = workspace.getInjectionDiv();\n  // Bounding rect coordinates are in client coordinates, meaning that they\n  // are in pixels relative to the upper left corner of the visible browser\n  // window.  These coordinates change when you scroll the browser window.\n  const boundingRect = injectionDiv.getBoundingClientRect();\n\n  // The client coordinates offset by the injection div's upper left corner.\n  const clientOffsetPixels = new Coordinate(\n    pixelCoord.x - boundingRect.left,\n    pixelCoord.y - boundingRect.top,\n  );\n\n  // The offset in pixels between the main workspace's origin and the upper\n  // left corner of the injection div.\n  const mainOffsetPixels = workspace.getOriginOffsetInPixels();\n\n  // The position of the new comment in pixels relative to the origin of the\n  // main workspace.\n  const finalOffset = Coordinate.difference(\n    clientOffsetPixels,\n    mainOffsetPixels,\n  );\n  // The position of the new comment in main workspace coordinates.\n  finalOffset.scale(1 / workspace.scale);\n  return finalOffset;\n}\n\n/** Registers all block-scoped context menu items. */\nfunction registerBlockOptions_() {\n  registerDuplicate();\n  registerComment();\n  registerInline();\n  registerCollapseExpandBlock();\n  registerDisable();\n  registerDelete();\n  registerHelp();\n}\n\n/** Registers all workspace comment related menu items. */\nexport function registerCommentOptions() {\n  registerCommentDuplicate();\n  registerCommentDelete();\n  registerCommentCreate();\n}\n\n/**\n * Registers all default context menu items. This should be called once per\n * instance of ContextMenuRegistry.\n *\n * @internal\n */\nexport function registerDefaultOptions() {\n  registerWorkspaceOptions_();\n  registerBlockOptions_();\n}\n\nregisterDefaultOptions();\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Coordinate} from '../utils/coordinate.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport {ICopyable, ICopyData} from './i_copyable.js';\n\n/** An object that can paste data into a workspace. */\nexport interface IPaster<U extends ICopyData, T extends ICopyable<U>> {\n  paste(\n    copyData: U,\n    workspace: WorkspaceSvg,\n    coordinate?: Coordinate,\n  ): T | null;\n}\n\n/** @returns True if the given object is a paster. */\nexport function isPaster(\n  obj: any,\n): obj is IPaster<ICopyData, ICopyable<ICopyData>> {\n  return obj.paste !== undefined;\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/** @internal */\nexport interface IRenderedElement {\n  /**\n   * @returns The root SVG element of htis rendered element.\n   */\n  getSvgRoot(): SVGElement;\n}\n\n/**\n * @returns True if the given object is an IRenderedElement.\n *\n * @internal\n */\nexport function isRenderedElement(obj: any): obj is IRenderedElement {\n  return obj['getSvgRoot'] !== undefined;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.ISelectable\n\nimport type {Workspace} from '../workspace.js';\n\n/**\n * The interface for an object that is selectable.\n */\nexport interface ISelectable {\n  id: string;\n\n  workspace: Workspace;\n\n  /** Select this.  Highlight it visually. */\n  select(): void;\n\n  /** Unselect this.  Unhighlight it visually. */\n  unselect(): void;\n}\n\n/** Checks whether the given object is an ISelectable. */\nexport function isSelectable(obj: Object): obj is ISelectable {\n  return (\n    typeof (obj as any).id === 'string' &&\n    (obj as any).workspace !== undefined &&\n    (obj as any).select !== undefined &&\n    (obj as any).unselect !== undefined\n  );\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {FlyoutItemInfoArray} from '../utils/toolbox';\n// Former goog.module ID: Blockly.ISelectableToolboxItem\n\nimport type {IToolboxItem} from './i_toolbox_item.js';\n\n/**\n * Interface for an item in the toolbox that can be selected.\n */\nexport interface ISelectableToolboxItem extends IToolboxItem {\n  /**\n   * Gets the name of the toolbox item. Used for emitting events.\n   *\n   * @returns The name of the toolbox item.\n   */\n  getName(): string;\n\n  /**\n   * Gets the contents of the toolbox item. These are items that are meant to be\n   * displayed in the flyout.\n   *\n   * @returns The definition of items to be displayed in the flyout.\n   */\n  getContents(): FlyoutItemInfoArray | string;\n\n  /**\n   * Sets the current toolbox item as selected.\n   *\n   * @param _isSelected True if this category is selected, false otherwise.\n   */\n  setSelected(_isSelected: boolean): void;\n\n  /**\n   * Gets the HTML element that is clickable.\n   * The parent toolbox element receives clicks. The parent toolbox will add an\n   * ID to this element so it can pass the onClick event to the correct\n   * toolboxItem.\n   *\n   * @returns The HTML element that receives clicks.\n   */\n  getClickTarget(): Element;\n\n  /**\n   * Handles when the toolbox item is clicked.\n   *\n   * @param _e Click event to handle.\n   */\n  onClick(_e: Event): void;\n}\n\n/**\n * Type guard that checks whether an IToolboxItem is an ISelectableToolboxItem.\n */\nexport function isSelectableToolboxItem(\n  toolboxItem: IToolboxItem,\n): toolboxItem is ISelectableToolboxItem {\n  return toolboxItem.isSelectable();\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_create.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/workspace_events.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_ui_base.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_create.js';\n\nimport {Block} from './block.js';\nimport * as blockAnimations from './block_animations.js';\nimport {BlockSvg} from './block_svg.js';\nimport {BlocklyOptions} from './blockly_options.js';\nimport {Blocks} from './blocks.js';\nimport * as browserEvents from './browser_events.js';\nimport * as bubbles from './bubbles.js';\nimport * as bumpObjects from './bump_objects.js';\nimport * as clipboard from './clipboard.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {config} from './config.js';\nimport {Connection} from './connection.js';\nimport {ConnectionChecker} from './connection_checker.js';\nimport {ConnectionDB} from './connection_db.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as ContextMenu from './contextmenu.js';\nimport * as ContextMenuItems from './contextmenu_items.js';\nimport {ContextMenuRegistry} from './contextmenu_registry.js';\nimport * as comments from './comments.js';\nimport * as Css from './css.js';\nimport {DeleteArea} from './delete_area.js';\nimport * as dialog from './dialog.js';\nimport * as dragging from './dragging.js';\nimport {DragTarget} from './drag_target.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as Events from './events/events.js';\nimport * as Extensions from './extensions.js';\nimport {\n  Field,\n  FieldConfig,\n  FieldValidator,\n  UnattachedFieldError,\n} from './field.js';\nimport {\n  FieldCheckbox,\n  FieldCheckboxConfig,\n  FieldCheckboxFromJsonConfig,\n  FieldCheckboxValidator,\n} from './field_checkbox.js';\nimport {\n  FieldDropdown,\n  FieldDropdownConfig,\n  FieldDropdownFromJsonConfig,\n  FieldDropdownValidator,\n  MenuGenerator,\n  MenuGeneratorFunction,\n  MenuOption,\n} from './field_dropdown.js';\nimport {\n  FieldImage,\n  FieldImageConfig,\n  FieldImageFromJsonConfig,\n} from './field_image.js';\nimport {\n  FieldLabel,\n  FieldLabelConfig,\n  FieldLabelFromJsonConfig,\n} from './field_label.js';\nimport {FieldLabelSerializable} from './field_label_serializable.js';\nimport {\n  FieldNumber,\n  FieldNumberConfig,\n  FieldNumberFromJsonConfig,\n  FieldNumberValidator,\n} from './field_number.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {\n  FieldTextInput,\n  FieldTextInputConfig,\n  FieldTextInputFromJsonConfig,\n  FieldTextInputValidator,\n} from './field_textinput.js';\nimport {\n  FieldVariable,\n  FieldVariableConfig,\n  FieldVariableFromJsonConfig,\n  FieldVariableValidator,\n} from './field_variable.js';\nimport {Flyout} from './flyout_base.js';\nimport {FlyoutButton} from './flyout_button.js';\nimport {HorizontalFlyout} from './flyout_horizontal.js';\nimport {FlyoutMetricsManager} from './flyout_metrics_manager.js';\nimport {VerticalFlyout} from './flyout_vertical.js';\nimport {CodeGenerator} from './generator.js';\nimport {Gesture} from './gesture.js';\nimport {Grid} from './grid.js';\nimport * as icons from './icons.js';\nimport {inject} from './inject.js';\nimport {Input} from './inputs/input.js';\nimport * as inputs from './inputs.js';\nimport {InsertionMarkerManager} from './insertion_marker_manager.js';\nimport {InsertionMarkerPreviewer} from './insertion_marker_previewer.js';\nimport {IASTNodeLocation} from './interfaces/i_ast_node_location.js';\nimport {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport {IASTNodeLocationWithBlock} from './interfaces/i_ast_node_location_with_block.js';\nimport {IAutoHideable} from './interfaces/i_autohideable.js';\nimport {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport {IBubble} from './interfaces/i_bubble.js';\nimport {ICollapsibleToolboxItem} from './interfaces/i_collapsible_toolbox_item.js';\nimport {IComponent} from './interfaces/i_component.js';\nimport {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport {IConnectionPreviewer} from './interfaces/i_connection_previewer.js';\nimport {IContextMenu} from './interfaces/i_contextmenu.js';\nimport {ICopyable, isCopyable, ICopyData} from './interfaces/i_copyable.js';\nimport {IDeletable, isDeletable} from './interfaces/i_deletable.js';\nimport {IDeleteArea} from './interfaces/i_delete_area.js';\nimport {IDragTarget} from './interfaces/i_drag_target.js';\nimport {IDragger} from './interfaces/i_dragger.js';\nimport {\n  IDraggable,\n  isDraggable,\n  IDragStrategy,\n} from './interfaces/i_draggable.js';\nimport {IFlyout} from './interfaces/i_flyout.js';\nimport {IHasBubble, hasBubble} from './interfaces/i_has_bubble.js';\nimport {IIcon, isIcon} from './interfaces/i_icon.js';\nimport {IKeyboardAccessible} from './interfaces/i_keyboard_accessible.js';\nimport {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport {IMovable} from './interfaces/i_movable.js';\nimport {IObservable, isObservable} from './interfaces/i_observable.js';\nimport {IPaster, isPaster} from './interfaces/i_paster.js';\nimport {IPositionable} from './interfaces/i_positionable.js';\nimport {IRegistrable} from './interfaces/i_registrable.js';\nimport {\n  IRenderedElement,\n  isRenderedElement,\n} from './interfaces/i_rendered_element.js';\nimport {ISelectable, isSelectable} from './interfaces/i_selectable.js';\nimport {ISelectableToolboxItem} from './interfaces/i_selectable_toolbox_item.js';\nimport {ISerializable, isSerializable} from './interfaces/i_serializable.js';\nimport {IStyleable} from './interfaces/i_styleable.js';\nimport {IToolbox} from './interfaces/i_toolbox.js';\nimport {IToolboxItem} from './interfaces/i_toolbox_item.js';\nimport {\n  IVariableBackedParameterModel,\n  isVariableBackedParameterModel,\n} from './interfaces/i_variable_backed_parameter_model.js';\nimport * as internalConstants from './internal_constants.js';\nimport {ASTNode} from './keyboard_nav/ast_node.js';\nimport {BasicCursor} from './keyboard_nav/basic_cursor.js';\nimport {Cursor} from './keyboard_nav/cursor.js';\nimport {Marker} from './keyboard_nav/marker.js';\nimport {TabNavigateCursor} from './keyboard_nav/tab_navigate_cursor.js';\nimport {MarkerManager} from './marker_manager.js';\nimport type {LayerManager} from './layer_manager.js';\nimport {Menu} from './menu.js';\nimport {MenuItem} from './menuitem.js';\nimport {MetricsManager} from './metrics_manager.js';\nimport {Msg, setLocale} from './msg.js';\nimport {MiniWorkspaceBubble} from './bubbles/mini_workspace_bubble.js';\nimport {Names} from './names.js';\nimport {Options} from './options.js';\nimport * as uiPosition from './positionable_helpers.js';\nimport * as Procedures from './procedures.js';\nimport * as registry from './registry.js';\nimport {RenderedConnection} from './rendered_connection.js';\nimport * as renderManagement from './render_management.js';\nimport * as blockRendering from './renderers/common/block_rendering.js';\nimport * as constants from './constants.js';\nimport * as geras from './renderers/geras/geras.js';\nimport * as thrasos from './renderers/thrasos/thrasos.js';\nimport * as zelos from './renderers/zelos/zelos.js';\nimport {Scrollbar} from './scrollbar.js';\nimport {ScrollbarPair} from './scrollbar_pair.js';\nimport * as serialization from './serialization.js';\nimport * as ShortcutItems from './shortcut_items.js';\nimport {ShortcutRegistry} from './shortcut_registry.js';\nimport {Theme} from './theme.js';\nimport * as Themes from './theme/themes.js';\nimport {ThemeManager} from './theme_manager.js';\nimport {ToolboxCategory} from './toolbox/category.js';\nimport {CollapsibleToolboxCategory} from './toolbox/collapsible_category.js';\nimport {ToolboxSeparator} from './toolbox/separator.js';\nimport {Toolbox} from './toolbox/toolbox.js';\nimport {ToolboxItem} from './toolbox/toolbox_item.js';\nimport * as Tooltip from './tooltip.js';\nimport * as Touch from './touch.js';\nimport {Trashcan} from './trashcan.js';\nimport * as utils from './utils.js';\nimport * as toolbox from './utils/toolbox.js';\nimport {VariableMap} from './variable_map.js';\nimport {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport * as VariablesDynamic from './variables_dynamic.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport {Workspace} from './workspace.js';\nimport {WorkspaceAudio} from './workspace_audio.js';\nimport {WorkspaceDragger} from './workspace_dragger.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\nimport * as Xml from './xml.js';\nimport {ZoomControls} from './zoom_controls.js';\n\n/**\n * Blockly core version.\n * This constant is overridden by the build script (npm run build) to the value\n * of the version in package.json. This is done by the Closure Compiler in the\n * buildCompressed gulp task.\n * For local builds, you can pass --define='Blockly.VERSION=X.Y.Z' to the\n * compiler to override this constant.\n *\n * @define {string}\n */\nexport const VERSION = 'uncompiled';\n\n/*\n * Top-level functions and properties on the Blockly namespace.\n * These are used only in external code. Do not reference these\n * from internal code as importing from this file can cause circular\n * dependencies. Do not add new functions here. There is probably a better\n * namespace to put new functions on.\n */\n\n/*\n * Aliases for constants used for connection and input types.\n */\n\n/**\n * @see ConnectionType.INPUT_VALUE\n */\nexport const INPUT_VALUE = ConnectionType.INPUT_VALUE;\n\n/**\n * @see ConnectionType.OUTPUT_VALUE\n */\nexport const OUTPUT_VALUE = ConnectionType.OUTPUT_VALUE;\n\n/**\n * @see ConnectionType.NEXT_STATEMENT\n */\nexport const NEXT_STATEMENT = ConnectionType.NEXT_STATEMENT;\n\n/**\n * @see ConnectionType.PREVIOUS_STATEMENT\n */\nexport const PREVIOUS_STATEMENT = ConnectionType.PREVIOUS_STATEMENT;\n\n/** Aliases for toolbox positions. */\n\n/**\n * @see toolbox.Position.TOP\n */\nexport const TOOLBOX_AT_TOP = toolbox.Position.TOP;\n\n/**\n * @see toolbox.Position.BOTTOM\n */\nexport const TOOLBOX_AT_BOTTOM = toolbox.Position.BOTTOM;\n\n/**\n * @see toolbox.Position.LEFT\n */\nexport const TOOLBOX_AT_LEFT = toolbox.Position.LEFT;\n\n/**\n * @see toolbox.Position.RIGHT\n */\nexport const TOOLBOX_AT_RIGHT = toolbox.Position.RIGHT;\n\n/*\n * Other aliased functions.\n */\n\n/**\n * Size the SVG image to completely fill its container. Call this when the view\n * actually changes sizes (e.g. on a window resize/device orientation change).\n * See workspace.resizeContents to resize the workspace when the contents\n * change (e.g. when a block is added or removed).\n * Record the height/width of the SVG image.\n *\n * @param workspace Any workspace in the SVG.\n * @see Blockly.common.svgResize\n */\nexport const svgResize = common.svgResize;\n\n/**\n * Close tooltips, context menus, dropdown selections, etc.\n *\n * @param opt_onlyClosePopups Whether only popups should be closed.\n * @see Blockly.WorkspaceSvg.hideChaff\n */\nexport function hideChaff(opt_onlyClosePopups?: boolean) {\n  (common.getMainWorkspace() as WorkspaceSvg).hideChaff(opt_onlyClosePopups);\n}\n\n/**\n * Returns the main workspace.  Returns the last used main workspace (based on\n * focus).  Try not to use this function, particularly if there are multiple\n * Blockly instances on a page.\n *\n * @see Blockly.common.getMainWorkspace\n */\nexport const getMainWorkspace = common.getMainWorkspace;\n\n/**\n * Returns the currently selected copyable object.\n */\nexport const getSelected = common.getSelected;\n\n/**\n * Define blocks from an array of JSON block definitions, as might be generated\n * by the Blockly Developer Tools.\n *\n * @param jsonArray An array of JSON block definitions.\n * @see Blockly.common.defineBlocksWithJsonArray\n */\nexport const defineBlocksWithJsonArray = common.defineBlocksWithJsonArray;\n\n/**\n * Set the parent container.  This is the container element that the WidgetDiv,\n * dropDownDiv, and Tooltip are rendered into the first time `Blockly.inject`\n * is called.\n * This method is a NOP if called after the first `Blockly.inject`.\n *\n * @param container The container element.\n * @see Blockly.common.setParentContainer\n */\nexport const setParentContainer = common.setParentContainer;\n\n// Aliases to allow external code to access these values for legacy reasons.\nexport const COLLAPSE_CHARS = internalConstants.COLLAPSE_CHARS;\nexport const OPPOSITE_TYPE = internalConstants.OPPOSITE_TYPE;\nexport const RENAME_VARIABLE_ID = internalConstants.RENAME_VARIABLE_ID;\nexport const DELETE_VARIABLE_ID = internalConstants.DELETE_VARIABLE_ID;\nexport const COLLAPSED_INPUT_NAME = constants.COLLAPSED_INPUT_NAME;\nexport const COLLAPSED_FIELD_NAME = constants.COLLAPSED_FIELD_NAME;\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n */\nexport const VARIABLE_CATEGORY_NAME: string = Variables.CATEGORY_NAME;\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n */\nexport const VARIABLE_DYNAMIC_CATEGORY_NAME: string =\n  VariablesDynamic.CATEGORY_NAME;\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * procedure blocks.\n */\nexport const PROCEDURE_CATEGORY_NAME: string = Procedures.CATEGORY_NAME;\n\n// Context for why we need to monkey-patch in these functions (internal):\n//   https://docs.google.com/document/d/1MbO0LEA-pAyx1ErGLJnyUqTLrcYTo-5zga9qplnxeXo/edit?usp=sharing&resourcekey=0-5h_32-i-dHwHjf_9KYEVKg\n\n// clang-format off\nWorkspace.prototype.newBlock = function (\n  prototypeName: string,\n  opt_id?: string,\n): Block {\n  return new Block(this, prototypeName, opt_id);\n};\n\nWorkspaceSvg.prototype.newBlock = function (\n  prototypeName: string,\n  opt_id?: string,\n): BlockSvg {\n  return new BlockSvg(this, prototypeName, opt_id);\n};\n\nWorkspace.prototype.newComment = function (\n  id?: string,\n): comments.WorkspaceComment {\n  return new comments.WorkspaceComment(this, id);\n};\n\nWorkspaceSvg.prototype.newComment = function (\n  id?: string,\n): comments.RenderedWorkspaceComment {\n  return new comments.RenderedWorkspaceComment(this, id);\n};\n\nWorkspaceSvg.newTrashcan = function (workspace: WorkspaceSvg): Trashcan {\n  return new Trashcan(workspace);\n};\n\nMiniWorkspaceBubble.prototype.newWorkspaceSvg = function (\n  options: Options,\n): WorkspaceSvg {\n  return new WorkspaceSvg(options);\n};\n\nNames.prototype.populateProcedures = function (\n  this: Names,\n  workspace: Workspace,\n) {\n  const procedures = Procedures.allProcedures(workspace);\n  // Flatten the return vs no-return procedure lists.\n  const flattenedProcedures = procedures[0].concat(procedures[1]);\n  for (let i = 0; i < flattenedProcedures.length; i++) {\n    this.getName(flattenedProcedures[i][0], Names.NameType.PROCEDURE);\n  }\n};\n// clang-format on\n\n// Re-export submodules that no longer declareLegacyNamespace.\nexport {browserEvents};\nexport {ContextMenu};\nexport {ContextMenuItems};\nexport {Css};\nexport {Events};\nexport {Extensions};\nexport {Procedures};\nexport {Procedures as procedures};\nexport {ShortcutItems};\nexport {Themes};\nexport {Tooltip};\nexport {Touch};\nexport {Variables};\nexport {VariablesDynamic};\nexport {WidgetDiv};\nexport {Xml};\nexport {blockAnimations};\nexport {blockRendering};\nexport {bumpObjects};\nexport {clipboard};\nexport {common};\nexport {constants};\nexport {dialog};\nexport {fieldRegistry};\nexport {geras};\nexport {registry};\nexport {thrasos};\nexport {uiPosition};\nexport {utils};\nexport {zelos};\nexport {ASTNode};\nexport {BasicCursor};\nexport {Block};\nexport {BlocklyOptions};\nexport {BlockSvg};\nexport {Blocks};\nexport {bubbles};\nexport {CollapsibleToolboxCategory};\nexport {ComponentManager};\nexport {Connection};\nexport {ConnectionType};\nexport {ConnectionChecker};\nexport {ConnectionDB};\nexport {ContextMenuRegistry};\nexport {comments};\nexport {Cursor};\nexport {DeleteArea};\nexport {dragging};\nexport {DragTarget};\nexport const DropDownDiv = dropDownDiv;\nexport {Field, FieldConfig, FieldValidator, UnattachedFieldError};\nexport {\n  FieldCheckbox,\n  FieldCheckboxConfig,\n  FieldCheckboxFromJsonConfig,\n  FieldCheckboxValidator,\n};\nexport {\n  FieldDropdown,\n  FieldDropdownConfig,\n  FieldDropdownFromJsonConfig,\n  FieldDropdownValidator,\n  MenuGenerator,\n  MenuGeneratorFunction,\n  MenuOption,\n};\nexport {FieldImage, FieldImageConfig, FieldImageFromJsonConfig};\nexport {FieldLabel, FieldLabelConfig, FieldLabelFromJsonConfig};\nexport {FieldLabelSerializable};\nexport {\n  FieldNumber,\n  FieldNumberConfig,\n  FieldNumberFromJsonConfig,\n  FieldNumberValidator,\n};\nexport {\n  FieldTextInput,\n  FieldTextInputConfig,\n  FieldTextInputFromJsonConfig,\n  FieldTextInputValidator,\n};\nexport {\n  FieldVariable,\n  FieldVariableConfig,\n  FieldVariableFromJsonConfig,\n  FieldVariableValidator,\n};\nexport {Flyout};\nexport {FlyoutButton};\nexport {FlyoutMetricsManager};\nexport {CodeGenerator};\nexport {CodeGenerator as Generator}; // Deprecated name, October 2022.\nexport {Gesture};\nexport {Grid};\nexport {HorizontalFlyout};\nexport {IASTNodeLocation};\nexport {IASTNodeLocationSvg};\nexport {IASTNodeLocationWithBlock};\nexport {IAutoHideable};\nexport {IBoundedElement};\nexport {IBubble};\nexport {ICollapsibleToolboxItem};\nexport {IComponent};\nexport {IConnectionChecker};\nexport {IConnectionPreviewer};\nexport {IContextMenu};\nexport {icons};\nexport {ICopyable, isCopyable, ICopyData};\nexport {IDeletable, isDeletable};\nexport {IDeleteArea};\nexport {IDragTarget};\nexport {IDragger};\nexport {IDraggable, isDraggable, IDragStrategy};\nexport {IFlyout};\nexport {IHasBubble, hasBubble};\nexport {IIcon, isIcon};\nexport {IKeyboardAccessible};\nexport {IMetricsManager};\nexport {IMovable};\nexport {Input};\nexport {inputs};\nexport {InsertionMarkerManager};\nexport {InsertionMarkerPreviewer};\nexport {IObservable, isObservable};\nexport {IPaster, isPaster};\nexport {IPositionable};\nexport {IRegistrable};\nexport {IRenderedElement, isRenderedElement};\nexport {ISelectable, isSelectable};\nexport {ISelectableToolboxItem};\nexport {ISerializable, isSerializable};\nexport {IStyleable};\nexport {IToolbox};\nexport {IToolboxItem};\nexport {IVariableBackedParameterModel, isVariableBackedParameterModel};\nexport {Marker};\nexport {MarkerManager};\nexport {LayerManager};\nexport {Menu};\nexport {MenuItem};\nexport {MetricsManager};\nexport {Msg, setLocale};\nexport {Names};\nexport {Options};\nexport {RenderedConnection};\nexport {renderManagement};\nexport {Scrollbar};\nexport {ScrollbarPair};\nexport {ShortcutRegistry};\nexport {TabNavigateCursor};\nexport {Theme};\nexport {ThemeManager};\nexport {Toolbox};\nexport {ToolboxCategory};\nexport {ToolboxItem};\nexport {ToolboxSeparator};\nexport {Trashcan};\nexport {VariableMap};\nexport {VariableModel};\nexport {VerticalFlyout};\nexport {Workspace};\nexport {WorkspaceAudio};\nexport {WorkspaceDragger};\nexport {WorkspaceSvg};\nexport {ZoomControls};\nexport {config};\nexport {inject};\nexport {serialization};\n",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blocks\n\n/**\n * A block definition.  For now this very loose, but it can potentially\n * be refined e.g. by replacing this typedef with a class definition.\n */\nexport type BlockDefinition = AnyDuringMigration;\n\n/**\n * A mapping of block type names to block prototype objects.\n */\nexport const Blocks: {[key: string]: BlockDefinition} = Object.create(null);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Abstract class for events fired as a result of actions in\n * Blockly's editor.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.Abstract\n\nimport * as common from '../common.js';\nimport type {Workspace} from '../workspace.js';\n\nimport * as eventUtils from './utils.js';\n\n/**\n * Abstract class for an event.\n */\nexport abstract class Abstract {\n  /**\n   * Whether or not the event was constructed without necessary parameters\n   * (to be populated by fromJson).\n   */\n  abstract isBlank: boolean;\n\n  /** The workspace identifier for this event. */\n  workspaceId?: string = undefined;\n\n  /**\n   * An ID for the group of events this block is associated with.\n   *\n   * Groups define events that should be treated as an single action from the\n   * user's perspective, and should be undone together.\n   */\n  group: string;\n\n  /** Whether this event is undoable or not. */\n  recordUndo: boolean;\n\n  /** Whether or not the event is a UI event. */\n  isUiEvent = false;\n\n  /** Type of this event. */\n  type = '';\n\n  constructor() {\n    this.group = eventUtils.getGroup();\n    this.recordUndo = eventUtils.getRecordUndo();\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  toJson(): AbstractEventJson {\n    return {\n      'type': this.type,\n      'group': this.group,\n    };\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of Abstract (like all events), but we can't specify that due to the\n   *     fact that parameters to static methods in subclasses must be\n   *     supertypes of parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: AbstractEventJson,\n    workspace: Workspace,\n    event: any,\n  ): Abstract {\n    event.isBlank = false;\n    event.group = json['group'] || '';\n    event.workspaceId = workspace.id;\n    return event;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns True if null, false if something changed.\n   */\n  isNull(): boolean {\n    return false;\n  }\n\n  /**\n   * Run an event.\n   *\n   * @param _forward True if run forward, false if run backward (undo).\n   */\n  run(_forward: boolean) {\n    // Defined by subclasses. Cannot be abstract b/c UI events do /not/ define\n    // this.\n  }\n\n  /**\n   * Get workspace the event belongs to.\n   *\n   * @returns The workspace the event belongs to.\n   * @throws {Error} if workspace is null.\n   * @internal\n   */\n  getEventWorkspace_(): Workspace {\n    let workspace;\n    if (this.workspaceId) {\n      workspace = common.getWorkspaceById(this.workspaceId);\n    }\n    if (!workspace) {\n      throw Error(\n        'Workspace is null. Event must have been generated from real' +\n          ' Blockly events.',\n      );\n    }\n    return workspace;\n  }\n}\n\nexport interface AbstractEventJson {\n  type: string;\n  group: string;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Base class for events fired as a result of UI actions in\n * Blockly's editor.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.UiBase\n\nimport {Abstract as AbstractEvent} from './events_abstract.js';\n\n/**\n * Base class for a UI event.\n * UI events are events that don't need to be sent over the wire for multi-user\n * editing to work (e.g. scrolling the workspace, zooming, opening toolbox\n * categories).\n * UI events do not undo or redo.\n */\nexport class UiBase extends AbstractEvent {\n  override isBlank = true;\n  override workspaceId: string;\n\n  // UI events do not undo or redo.\n  override recordUndo = false;\n\n  /** Whether or not the event is a UI event. */\n  override isUiEvent = true;\n\n  /**\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   */\n  constructor(opt_workspaceId?: string) {\n    super();\n\n    /** Whether or not the event is blank (to be populated by fromJson). */\n    this.isBlank = typeof opt_workspaceId === 'undefined';\n\n    /** The workspace identifier for this event. */\n    this.workspaceId = opt_workspaceId ? opt_workspaceId : '';\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of UI click in Blockly's editor.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.Click\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that some blockly element was clicked.\n */\nexport class Click extends UiBase {\n  /** The ID of the block that was clicked, if a block was clicked. */\n  blockId?: string;\n\n  /**\n   * The type of element that was clicked; one of 'block', 'workspace',\n   * or 'zoom_controls'.\n   */\n  targetType?: ClickTarget;\n  override type = eventUtils.CLICK;\n\n  /**\n   * @param opt_block The affected block. Null for click events that do not have\n   *     an associated block (i.e. workspace click). Undefined for a blank\n   *     event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Not used if block is passed. Undefined for a blank event.\n   * @param opt_targetType The type of element targeted by this click event.\n   *     Undefined for a blank event.\n   */\n  constructor(\n    opt_block?: Block | null,\n    opt_workspaceId?: string | null,\n    opt_targetType?: ClickTarget,\n  ) {\n    let workspaceId = opt_block ? opt_block.workspace.id : opt_workspaceId;\n    if (workspaceId === null) {\n      workspaceId = undefined;\n    }\n    super(workspaceId);\n\n    this.blockId = opt_block ? opt_block.id : undefined;\n    this.targetType = opt_targetType;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): ClickJson {\n    const json = super.toJson() as ClickJson;\n    if (!this.targetType) {\n      throw new Error(\n        'The click target type is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['targetType'] = this.targetType;\n    json['blockId'] = this.blockId;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of Click, but we can't specify that due to the fact that parameters to\n   *     static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(json: ClickJson, workspace: Workspace, event?: any): Click {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new Click(),\n    ) as Click;\n    newEvent.targetType = json['targetType'];\n    newEvent.blockId = json['blockId'];\n    return newEvent;\n  }\n}\n\nexport enum ClickTarget {\n  BLOCK = 'block',\n  WORKSPACE = 'workspace',\n  ZOOM_CONTROLS = 'zoom_controls',\n}\n\nexport interface ClickJson extends AbstractEventJson {\n  targetType: ClickTarget;\n  blockId?: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.CLICK, Click);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.userAgent\n\n/** The raw useragent string. */\nlet rawUserAgent: string;\n\nlet isJavaFx: boolean;\n\nlet isWebKit: boolean;\n\nlet isGecko: boolean;\n\nlet isAndroid: boolean;\n\nlet isIPad: boolean;\n\nlet isIPhone: boolean;\n\nlet isMac: boolean;\n\nlet isTablet: boolean;\n\nlet isMobile: boolean;\n\n(function (raw) {\n  rawUserAgent = raw;\n  const rawUpper = rawUserAgent.toUpperCase();\n  /**\n   * Case-insensitive test of whether name is in the useragent string.\n   *\n   * @param name Name to test.\n   * @returns True if name is present.\n   */\n  function has(name: string): boolean {\n    return rawUpper.includes(name.toUpperCase());\n  }\n\n  // Browsers.  Logic from:\n  // https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/browser.js\n  // Useragent for JavaFX:\n  // Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.44\n  //     (KHTML, like Gecko) JavaFX/8.0 Safari/537.44\n  isJavaFx = has('JavaFX');\n\n  // Engines.  Logic from:\n  // https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/engine.js\n  isWebKit = has('WebKit');\n  isGecko = has('Gecko') && !isWebKit;\n\n  // Platforms.  Logic from:\n  // https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/platform.js\n  // and\n  // https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/extra.js\n  isAndroid = has('Android');\n  const maxTouchPoints =\n    globalThis['navigator'] && globalThis['navigator']['maxTouchPoints'];\n  isIPad = has('iPad') || (has('Macintosh') && maxTouchPoints > 0);\n  isIPhone = has('iPhone') && !isIPad;\n  isMac = has('Macintosh');\n\n  // Devices.  Logic from:\n  // https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/device.js\n  isTablet = isIPad || (isAndroid && !has('Mobile')) || has('Silk');\n  isMobile = !isTablet && (isIPhone || isAndroid);\n})((globalThis['navigator'] && globalThis['navigator']['userAgent']) || '');\n\nexport const raw: string = rawUserAgent;\n\nexport const JavaFx: boolean = isJavaFx;\n\nexport const GECKO: boolean = isGecko;\n\nexport const ANDROID: boolean = isAndroid;\n\nexport const IPAD: boolean = isIPad;\n\nexport const IPHONE: boolean = isIPhone;\n\nexport const MAC: boolean = isMac;\n\nexport const MOBILE: boolean = isMobile;\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Manager for all items registered with the workspace.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ComponentManager\n\nimport type {IAutoHideable} from './interfaces/i_autohideable.js';\nimport type {IComponent} from './interfaces/i_component.js';\nimport type {IDeleteArea} from './interfaces/i_delete_area.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {IPositionable} from './interfaces/i_positionable.js';\nimport * as arrayUtils from './utils/array.js';\n\nclass Capability<_T> {\n  static POSITIONABLE = new Capability<IPositionable>('positionable');\n  static DRAG_TARGET = new Capability<IDragTarget>('drag_target');\n  static DELETE_AREA = new Capability<IDeleteArea>('delete_area');\n  static AUTOHIDEABLE = new Capability<IAutoHideable>('autohideable');\n  private readonly name_: string;\n  /** @param name The name of the component capability. */\n  constructor(name: string) {\n    this.name_ = name;\n  }\n\n  /**\n   * Returns the name of the capability.\n   *\n   * @returns The name.\n   */\n  toString(): string {\n    return this.name_;\n  }\n}\n\n/**\n * Manager for all items registered with the workspace.\n */\nexport class ComponentManager {\n  static Capability = Capability;\n\n  /**\n   * A map of the components registered with the workspace, mapped to id.\n   */\n  private readonly componentData = new Map<string, ComponentDatum>();\n\n  /** A map of capabilities to component IDs. */\n  private readonly capabilityToComponentIds = new Map<string, string[]>();\n\n  /**\n   * Adds a component.\n   *\n   * @param componentInfo The data for the component to register.\n   * @param opt_allowOverrides True to prevent an error when overriding an\n   *     already registered item.\n   */\n  addComponent(componentInfo: ComponentDatum, opt_allowOverrides?: boolean) {\n    // Don't throw an error if opt_allowOverrides is true.\n    const id = componentInfo.component.id;\n    if (!opt_allowOverrides && this.componentData.has(id)) {\n      throw Error(\n        'Plugin \"' +\n          id +\n          '\" with capabilities \"' +\n          this.componentData.get(id)?.capabilities +\n          '\" already added.',\n      );\n    }\n    this.componentData.set(id, componentInfo);\n    const stringCapabilities = [];\n    for (let i = 0; i < componentInfo.capabilities.length; i++) {\n      const capability = String(componentInfo.capabilities[i]).toLowerCase();\n      stringCapabilities.push(capability);\n      if (!this.capabilityToComponentIds.has(capability)) {\n        this.capabilityToComponentIds.set(capability, [id]);\n      } else {\n        this.capabilityToComponentIds.get(capability)?.push(id);\n      }\n    }\n    this.componentData.get(id)!.capabilities = stringCapabilities;\n  }\n\n  /**\n   * Removes a component.\n   *\n   * @param id The ID of the component to remove.\n   */\n  removeComponent(id: string) {\n    const componentInfo = this.componentData.get(id);\n    if (!componentInfo) {\n      return;\n    }\n    for (let i = 0; i < componentInfo.capabilities.length; i++) {\n      const capability = String(componentInfo.capabilities[i]).toLowerCase();\n      arrayUtils.removeElem(this.capabilityToComponentIds.get(capability)!, id);\n    }\n    this.componentData.delete(id);\n  }\n\n  /**\n   * Adds a capability to a existing registered component.\n   *\n   * @param id The ID of the component to add the capability to.\n   * @param capability The capability to add.\n   */\n  addCapability<T>(id: string, capability: string | Capability<T>) {\n    if (!this.getComponent(id)) {\n      throw Error(\n        'Cannot add capability, \"' +\n          capability +\n          '\". Plugin \"' +\n          id +\n          '\" has not been added to the ComponentManager',\n      );\n    }\n    if (this.hasCapability(id, capability)) {\n      console.warn(\n        'Plugin \"' + id + 'already has capability \"' + capability + '\"',\n      );\n      return;\n    }\n    capability = `${capability}`.toLowerCase();\n    this.componentData.get(id)?.capabilities.push(capability);\n    this.capabilityToComponentIds.get(capability)?.push(id);\n  }\n\n  /**\n   * Removes a capability from an existing registered component.\n   *\n   * @param id The ID of the component to remove the capability from.\n   * @param capability The capability to remove.\n   */\n  removeCapability<T>(id: string, capability: string | Capability<T>) {\n    if (!this.getComponent(id)) {\n      throw Error(\n        'Cannot remove capability, \"' +\n          capability +\n          '\". Plugin \"' +\n          id +\n          '\" has not been added to the ComponentManager',\n      );\n    }\n    if (!this.hasCapability(id, capability)) {\n      console.warn(\n        'Plugin \"' +\n          id +\n          'doesn\\'t have capability \"' +\n          capability +\n          '\" to remove',\n      );\n      return;\n    }\n    capability = `${capability}`.toLowerCase();\n    arrayUtils.removeElem(this.componentData.get(id)!.capabilities, capability);\n    arrayUtils.removeElem(this.capabilityToComponentIds.get(capability)!, id);\n  }\n\n  /**\n   * Returns whether the component with this id has the specified capability.\n   *\n   * @param id The ID of the component to check.\n   * @param capability The capability to check for.\n   * @returns Whether the component has the capability.\n   */\n  hasCapability<T>(id: string, capability: string | Capability<T>): boolean {\n    capability = `${capability}`.toLowerCase();\n    return (\n      this.componentData.has(id) &&\n      this.componentData.get(id)!.capabilities.includes(capability)\n    );\n  }\n\n  /**\n   * Gets the component with the given ID.\n   *\n   * @param id The ID of the component to get.\n   * @returns The component with the given name or undefined if not found.\n   */\n  getComponent(id: string): IComponent | undefined {\n    return this.componentData.get(id)?.component;\n  }\n\n  /**\n   * Gets all the components with the specified capability.\n   *\n   * @param capability The capability of the component.\n   * @param sorted Whether to return list ordered by weights.\n   * @returns The components that match the specified capability.\n   */\n  getComponents<T extends IComponent>(\n    capability: string | Capability<T>,\n    sorted: boolean,\n  ): T[] {\n    capability = `${capability}`.toLowerCase();\n    const componentIds = this.capabilityToComponentIds.get(capability);\n    if (!componentIds) {\n      return [];\n    }\n    const components: T[] = [];\n    if (sorted) {\n      const componentDataList: ComponentDatum[] = [];\n      componentIds.forEach((id) => {\n        componentDataList.push(this.componentData.get(id)!);\n      });\n      componentDataList.sort(function (a, b) {\n        return a.weight - b.weight;\n      });\n      componentDataList.forEach(function (componentDatum) {\n        components.push(componentDatum.component as T);\n      });\n    } else {\n      componentIds.forEach((id) => {\n        components.push(this.componentData.get(id)!.component as T);\n      });\n    }\n    return components;\n  }\n}\n\nexport namespace ComponentManager {\n  /** An object storing component information. */\n  export interface ComponentDatum {\n    component: IComponent;\n    capabilities: Array<string | Capability<IComponent>>;\n    weight: number;\n  }\n}\n\nexport type ComponentDatum = ComponentManager.ComponentDatum;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for coordinate manipulation.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @class\n */\n// Former goog.module ID: Blockly.utils.Coordinate\n\n/**\n * Class for representing coordinates and positions.\n */\nexport class Coordinate {\n  /**\n   * @param x Left.\n   * @param y Top.\n   */\n  constructor(\n    public x: number,\n    public y: number,\n  ) {}\n\n  /**\n   * Creates a new copy of this coordinate.\n   *\n   * @returns A copy of this coordinate.\n   */\n  clone(): Coordinate {\n    return new Coordinate(this.x, this.y);\n  }\n\n  /**\n   * Scales this coordinate by the given scale factor.\n   *\n   * @param s The scale factor to use for both x and y dimensions.\n   * @returns This coordinate after scaling.\n   */\n  scale(s: number): Coordinate {\n    this.x *= s;\n    this.y *= s;\n    return this;\n  }\n\n  /**\n   * Translates this coordinate by the given offsets.\n   * respectively.\n   *\n   * @param tx The value to translate x by.\n   * @param ty The value to translate y by.\n   * @returns This coordinate after translating.\n   */\n  translate(tx: number, ty: number): Coordinate {\n    this.x += tx;\n    this.y += ty;\n    return this;\n  }\n\n  /**\n   * Compares coordinates for equality.\n   *\n   * @param a A Coordinate.\n   * @param b A Coordinate.\n   * @returns True iff the coordinates are equal, or if both are null.\n   */\n  static equals(a?: Coordinate | null, b?: Coordinate | null): boolean {\n    if (a === b) {\n      return true;\n    }\n    if (!a || !b) {\n      return false;\n    }\n    return a.x === b.x && a.y === b.y;\n  }\n\n  /**\n   * Returns the distance between two coordinates.\n   *\n   * @param a A Coordinate.\n   * @param b A Coordinate.\n   * @returns The distance between `a` and `b`.\n   */\n  static distance(a: Coordinate, b: Coordinate): number {\n    const dx = a.x - b.x;\n    const dy = a.y - b.y;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n\n  /**\n   * Returns the magnitude of a coordinate.\n   *\n   * @param a A Coordinate.\n   * @returns The distance between the origin and `a`.\n   */\n  static magnitude(a: Coordinate): number {\n    return Math.sqrt(a.x * a.x + a.y * a.y);\n  }\n\n  /**\n   * Returns the difference between two coordinates as a new\n   * Coordinate.\n   *\n   * @param a An x/y coordinate.\n   * @param b An x/y coordinate.\n   * @returns A Coordinate representing the difference between `a` and `b`.\n   */\n  static difference(\n    a: Coordinate | SVGPoint,\n    b: Coordinate | SVGPoint,\n  ): Coordinate {\n    return new Coordinate(a.x - b.x, a.y - b.y);\n  }\n\n  /**\n   * Returns the sum of two coordinates as a new Coordinate.\n   *\n   * @param a An x/y coordinate.\n   * @param b An x/y coordinate.\n   * @returns A Coordinate representing the sum of the two coordinates.\n   */\n  static sum(a: Coordinate | SVGPoint, b: Coordinate | SVGPoint): Coordinate {\n    return new Coordinate(a.x + b.x, a.y + b.y);\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Defines the Svg class. Its constants enumerate\n * all SVG tag names used by Blockly.\n *\n * @class\n */\n// Former goog.module ID: Blockly.utils.Svg\n\n/**\n * A name with the type of the SVG element stored in the generic.\n */\nexport class Svg<_T> {\n  /** @internal */\n  static ANIMATE = new Svg<SVGAnimateElement>('animate');\n  /** @internal */\n  static CIRCLE = new Svg<SVGCircleElement>('circle');\n  /** @internal */\n  static CLIPPATH = new Svg<SVGClipPathElement>('clipPath');\n  /** @internal */\n  static DEFS = new Svg<SVGDefsElement>('defs');\n  /** @internal */\n  static FECOMPOSITE = new Svg<SVGFECompositeElement>('feComposite');\n  /** @internal */\n  static FECOMPONENTTRANSFER = new Svg<SVGFEComponentTransferElement>(\n    'feComponentTransfer',\n  );\n  /** @internal */\n  static FEFLOOD = new Svg<SVGFEFloodElement>('feFlood');\n  /** @internal */\n  static FEFUNCA = new Svg<SVGFEFuncAElement>('feFuncA');\n  /** @internal */\n  static FEGAUSSIANBLUR = new Svg<SVGFEGaussianBlurElement>('feGaussianBlur');\n  /** @internal */\n  static FEPOINTLIGHT = new Svg<SVGFEPointLightElement>('fePointLight');\n  /** @internal */\n  static FESPECULARLIGHTING = new Svg<SVGFESpecularLightingElement>(\n    'feSpecularLighting',\n  );\n  /** @internal */\n  static FILTER = new Svg<SVGFilterElement>('filter');\n  /** @internal */\n  static FOREIGNOBJECT = new Svg<SVGForeignObjectElement>('foreignObject');\n  /** @internal */\n  static G = new Svg<SVGGElement>('g');\n  /** @internal */\n  static IMAGE = new Svg<SVGImageElement>('image');\n  /** @internal */\n  static LINE = new Svg<SVGLineElement>('line');\n  /** @internal */\n  static PATH = new Svg<SVGPathElement>('path');\n  /** @internal */\n  static PATTERN = new Svg<SVGPatternElement>('pattern');\n  /** @internal */\n  static POLYGON = new Svg<SVGPolygonElement>('polygon');\n  /** @internal */\n  static RECT = new Svg<SVGRectElement>('rect');\n  /** @internal */\n  static SVG = new Svg<SVGSVGElement>('svg');\n  /** @internal */\n  static TEXT = new Svg<SVGTextElement>('text');\n  /** @internal */\n  static TSPAN = new Svg<SVGTSpanElement>('tspan');\n\n  /**\n   * @param tagName The SVG element tag name.\n   * @internal\n   */\n  constructor(private readonly tagName: string) {}\n\n  /**\n   * Returns the SVG element tag name.\n   *\n   * @returns The name.\n   */\n  toString(): string {\n    return this.tagName;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for rectangle manipulation.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @class\n */\n// Former goog.module ID: Blockly.utils.Rect\n\n/**\n * Class for representing rectangular regions.\n */\nexport class Rect {\n  /**\n   * @param top Top.\n   * @param bottom Bottom.\n   * @param left Left.\n   * @param right Right.\n   */\n  constructor(\n    public top: number,\n    public bottom: number,\n    public left: number,\n    public right: number,\n  ) {}\n\n  getHeight(): number {\n    return this.bottom - this.top;\n  }\n\n  getWidth(): number {\n    return this.right - this.left;\n  }\n\n  /**\n   * Tests whether this rectangle contains a x/y coordinate.\n   *\n   * @param x The x coordinate to test for containment.\n   * @param y The y coordinate to test for containment.\n   * @returns Whether this rectangle contains given coordinate.\n   */\n  contains(x: number, y: number): boolean {\n    return (\n      x >= this.left && x <= this.right && y >= this.top && y <= this.bottom\n    );\n  }\n\n  /**\n   * Tests whether this rectangle intersects the provided rectangle.\n   * Assumes that the coordinate system increases going down and left.\n   *\n   * @param other The other rectangle to check for intersection with.\n   * @returns Whether this rectangle intersects the provided rectangle.\n   */\n  intersects(other: Rect): boolean {\n    return !(\n      this.left > other.right ||\n      this.right < other.left ||\n      this.top > other.bottom ||\n      this.bottom < other.top\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for size calculation.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @class\n */\n// Former goog.module ID: Blockly.utils.Size\n\n/**\n * Class for representing sizes consisting of a width and height.\n */\nexport class Size {\n  /**\n   * @param width Width.\n   * @param height Height.\n   */\n  constructor(\n    public width: number,\n    public height: number,\n  ) {}\n\n  /**\n   * Compares sizes for equality.\n   *\n   * @param a A Size.\n   * @param b A Size.\n   * @returns True iff the sizes have equal widths and equal heights, or if both\n   *     are null.\n   */\n  static equals(a: Size | null, b: Size | null): boolean {\n    if (a === b) {\n      return true;\n    }\n    if (!a || !b) {\n      return false;\n    }\n    return a.width === b.width && a.height === b.height;\n  }\n\n  /**\n   * Returns a new size with the maximum width and height values out of both\n   * sizes.\n   */\n  static max(a: Size, b: Size): Size {\n    return new Size(Math.max(a.width, b.width), Math.max(a.height, b.height));\n  }\n\n  /**\n   * Returns a new size with the minimum width and height values out of both\n   * sizes.\n   */\n  static min(a: Size, b: Size): Size {\n    return new Size(Math.min(a.width, b.width), Math.min(a.height, b.height));\n  }\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a scrollbar.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Scrollbar\n\nimport * as browserEvents from './browser_events.js';\nimport * as Touch from './touch.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * A note on units: most of the numbers that are in CSS pixels are scaled if the\n * scrollbar is in a mutator.\n */\n\n/**\n * Class for a pure SVG scrollbar.\n * This technique offers a scrollbar that is guaranteed to work, but may not\n * look or behave like the system's scrollbars.\n */\nexport class Scrollbar {\n  /**\n   * Width of vertical scrollbar or height of horizontal scrollbar in CSS\n   * pixels. Scrollbars should be larger on touch devices.\n   */\n  static scrollbarThickness = Touch.TOUCH_ENABLED ? 25 : 15;\n\n  /**\n   * Default margin around the scrollbar (between the scrollbar and the edge of\n   * the viewport in pixels).\n   *\n   * @internal\n   */\n  static readonly DEFAULT_SCROLLBAR_MARGIN = 0.5;\n\n  /** Whether this scrollbar is part of a pair. */\n  private readonly pair: boolean;\n\n  /**\n   * Margin around the scrollbar (between the scrollbar and the edge of the\n   * viewport in pixels).\n   */\n  private readonly margin: number;\n\n  /** Previously recorded metrics from the workspace. */\n  private oldHostMetrics: Metrics | null = null;\n\n  /**\n   * The ratio of handle position offset to workspace content displacement.\n   *\n   * @internal\n   */\n  ratio = 1;\n\n  /**\n   * The location of the origin of the workspace that the scrollbar is in,\n   * measured in CSS pixels relative to the injection div origin.  This is\n   * usually (0, 0).  When the scrollbar is in a flyout it may have a\n   * different origin.\n   */\n  private origin = new Coordinate(0, 0);\n\n  /**\n   * The position of the mouse along this scrollbar's major axis at the start\n   * of the most recent drag. Units are CSS pixels, with (0, 0) at the top\n   * left of the browser window. For a horizontal scrollbar this is the x\n   * coordinate of the mouse down event; for a vertical scrollbar it's the y\n   * coordinate of the mouse down event.\n   */\n  private startDragMouse = 0;\n\n  /**\n   * The length of the scrollbars (including the handle and the background),\n   * in CSS pixels. This is equivalent to scrollbar background length and the\n   * area within which the scrollbar handle can move.\n   */\n  private scrollbarLength = 0;\n\n  /** The length of the scrollbar handle in CSS pixels. */\n  private handleLength = 0;\n\n  /**\n   * The offset of the start of the handle from the scrollbar position, in CSS\n   * pixels.\n   */\n  private handlePosition = 0;\n\n  private startDragHandle = 0;\n\n  /** Whether the scrollbar handle is visible. */\n  private isHandleVisible = true;\n\n  /** Whether the workspace containing this scrollbar is visible. */\n  private containerVisible = true;\n\n  /** The transparent background behind the handle. */\n  private svgBackground: SVGRectElement;\n\n  /** The visible handle that can be dragged around. */\n  private svgHandle: SVGRectElement;\n\n  /** The outermost SVG element, which contains all parts of the scrollbar. */\n  private outerSvg: SVGSVGElement;\n\n  /**\n   * The upper left corner of the scrollbar's SVG group in CSS pixels relative\n   * to the scrollbar's origin.  This is usually relative to the injection div\n   * origin.\n   *\n   * @internal\n   */\n  position = new Coordinate(0, 0);\n\n  /**\n   * The DOM attribute that controls the length of the scrollbar. Different\n   * for horizontal and vertical scrollbars.\n   */\n  lengthAttribute_: string;\n\n  /**\n   * The DOM attribute that controls the position of the scrollbar.\n   * Different for horizontal and vertical scrollbars.\n   */\n  positionAttribute_: string;\n\n  /** Handler for mouse down events on the background of the scrollbar. */\n  onMouseDownBarWrapper_: browserEvents.Data;\n\n  /** Handler for mouse down events on the handle of the scrollbar. */\n  onMouseDownHandleWrapper_: browserEvents.Data;\n\n  /** Handler for mouse move events during scrollbar drags. */\n  onMouseUpWrapper_: browserEvents.Data | null = null;\n\n  /** Handler for mouse up events to end scrollbar drags. */\n  onMouseMoveWrapper_: browserEvents.Data | null = null;\n\n  /**\n   * @param workspace Workspace to bind the scrollbar to.\n   * @param horizontal True if horizontal, false if vertical.\n   * @param opt_pair True if scrollbar is part of a horiz/vert pair.\n   * @param opt_class A class to be applied to this scrollbar.\n   * @param opt_margin The margin to apply to this scrollbar.\n   */\n  constructor(\n    private workspace: WorkspaceSvg,\n    private readonly horizontal: boolean,\n    opt_pair?: boolean,\n    opt_class?: string,\n    opt_margin?: number,\n  ) {\n    this.pair = opt_pair || false;\n\n    this.margin =\n      opt_margin !== undefined\n        ? opt_margin\n        : Scrollbar.DEFAULT_SCROLLBAR_MARGIN;\n\n    let className =\n      'blocklyScrollbar' + (this.horizontal ? 'Horizontal' : 'Vertical');\n    if (opt_class) {\n      className += ' ' + opt_class;\n    }\n\n    /* Create the following DOM:\n      <svg class=\"blocklyScrollbarHorizontal optionalClass\">\n        <g>\n          <rect class=\"blocklyScrollbarBackground\" />\n          <rect class=\"blocklyScrollbarHandle\" rx=\"8\" ry=\"8\" />\n        </g>\n      </svg>\n    */\n    this.outerSvg = dom.createSvgElement(Svg.SVG, {'class': className});\n    // Child group to hold the handle and background together.\n    const group = dom.createSvgElement(Svg.G, {}, this.outerSvg);\n\n    this.svgBackground = dom.createSvgElement(\n      Svg.RECT,\n      {'class': 'blocklyScrollbarBackground'},\n      group,\n    );\n\n    const radius = Math.floor((Scrollbar.scrollbarThickness - 5) / 2);\n    this.svgHandle = dom.createSvgElement(\n      Svg.RECT,\n      {'class': 'blocklyScrollbarHandle', 'rx': radius, 'ry': radius},\n      group,\n    );\n\n    this.workspace\n      .getThemeManager()\n      .subscribe(this.svgHandle, 'scrollbarColour', 'fill');\n    this.workspace\n      .getThemeManager()\n      .subscribe(this.svgHandle, 'scrollbarOpacity', 'fill-opacity');\n\n    // Add everything to the DOM.\n    dom.insertAfter(this.outerSvg, this.workspace.getParentSvg());\n\n    this.setInitialThickness();\n\n    if (horizontal) {\n      this.lengthAttribute_ = 'width';\n      this.positionAttribute_ = 'x';\n    } else {\n      this.lengthAttribute_ = 'height';\n      this.positionAttribute_ = 'y';\n    }\n\n    this.onMouseDownBarWrapper_ = browserEvents.conditionalBind(\n      this.svgBackground,\n      'pointerdown',\n      this,\n      this.onMouseDownBar,\n    );\n    this.onMouseDownHandleWrapper_ = browserEvents.conditionalBind(\n      this.svgHandle,\n      'pointerdown',\n      this,\n      this.onMouseDownHandle,\n    );\n  }\n\n  /**\n   * Set the size of the scrollbar DOM elements along the minor axis.\n   */\n  private setInitialThickness() {\n    const scrollbarThickness = Scrollbar.scrollbarThickness;\n    if (this.horizontal) {\n      this.svgBackground.setAttribute('height', String(scrollbarThickness));\n      this.outerSvg.setAttribute('height', String(scrollbarThickness));\n      this.svgHandle.setAttribute('height', String(scrollbarThickness - 5));\n      this.svgHandle.setAttribute('y', '2.5');\n    } else {\n      this.svgBackground.setAttribute('width', String(scrollbarThickness));\n      this.outerSvg.setAttribute('width', String(scrollbarThickness));\n      this.svgHandle.setAttribute('width', String(scrollbarThickness - 5));\n      this.svgHandle.setAttribute('x', '2.5');\n    }\n  }\n\n  /**\n   * Dispose of this scrollbar. Remove DOM elements, event listeners,\n   * and theme subscriptions.\n   */\n  dispose() {\n    this.cleanUp();\n    browserEvents.unbind(this.onMouseDownBarWrapper_);\n    browserEvents.unbind(this.onMouseDownHandleWrapper_);\n\n    dom.removeNode(this.outerSvg);\n    this.workspace.getThemeManager().unsubscribe(this.svgHandle);\n  }\n\n  /**\n   * Constrain the handle's length within the minimum (0) and maximum\n   * (scrollbar background) values allowed for the scrollbar.\n   *\n   * @param value Value that is potentially out of bounds, in CSS pixels.\n   * @returns Constrained value, in CSS pixels.\n   */\n  private constrainHandleLength(value: number): number {\n    if (value <= 0 || isNaN(value)) {\n      value = 0;\n    } else {\n      value = Math.min(value, this.scrollbarLength);\n    }\n    return value;\n  }\n\n  /**\n   * Set the length of the scrollbar's handle and change the SVG attribute\n   * accordingly.\n   *\n   * @param newLength The new scrollbar handle length in CSS pixels.\n   */\n  private setHandleLength(newLength: number) {\n    this.handleLength = newLength;\n    this.svgHandle.setAttribute(\n      this.lengthAttribute_,\n      String(this.handleLength),\n    );\n  }\n\n  /**\n   * Constrain the handle's position within the minimum (0) and maximum values\n   * allowed for the scrollbar.\n   *\n   * @param value Value that is potentially out of bounds, in CSS pixels.\n   * @returns Constrained value, in CSS pixels.\n   */\n  private constrainHandlePosition(value: number): number {\n    if (value <= 0 || isNaN(value)) {\n      value = 0;\n    } else {\n      // Handle length should never be greater than this.scrollbarLength_.\n      // If the viewSize is greater than or equal to the scrollSize, the\n      // handleLength will end up equal to this.scrollbarLength_.\n      value = Math.min(value, this.scrollbarLength - this.handleLength);\n    }\n    return value;\n  }\n\n  /**\n   * Set the offset of the scrollbar's handle from the scrollbar's position, and\n   * change the SVG attribute accordingly.\n   *\n   * @param newPosition The new scrollbar handle offset in CSS pixels.\n   */\n  setHandlePosition(newPosition: number) {\n    this.handlePosition = newPosition;\n    this.svgHandle.setAttribute(\n      this.positionAttribute_,\n      String(this.handlePosition),\n    );\n  }\n\n  /**\n   * Set the size of the scrollbar's background and change the SVG attribute\n   * accordingly.\n   *\n   * @param newSize The new scrollbar background length in CSS pixels.\n   */\n  private setScrollbarLength(newSize: number) {\n    this.scrollbarLength = newSize;\n    this.outerSvg.setAttribute(\n      this.lengthAttribute_,\n      String(this.scrollbarLength),\n    );\n    this.svgBackground.setAttribute(\n      this.lengthAttribute_,\n      String(this.scrollbarLength),\n    );\n  }\n\n  /**\n   * Set the position of the scrollbar's SVG group in CSS pixels relative to the\n   * scrollbar's origin.  This sets the scrollbar's location within the\n   * workspace.\n   *\n   * @param x The new x coordinate.\n   * @param y The new y coordinate.\n   * @internal\n   */\n  setPosition(x: number, y: number) {\n    this.position.x = x;\n    this.position.y = y;\n\n    const tempX = this.position.x + this.origin.x;\n    const tempY = this.position.y + this.origin.y;\n    const transform = 'translate(' + tempX + 'px,' + tempY + 'px)';\n    dom.setCssTransform(this.outerSvg, transform);\n  }\n\n  /**\n   * Recalculate the scrollbar's location and its length.\n   *\n   * @param opt_metrics A data structure of from the describing all the required\n   *     dimensions.  If not provided, it will be fetched from the host object.\n   */\n  resize(opt_metrics?: Metrics) {\n    // Determine the location, height and width of the host element.\n    let hostMetrics = opt_metrics;\n    if (!hostMetrics) {\n      hostMetrics = this.workspace.getMetrics();\n      if (!hostMetrics) {\n        // Host element is likely not visible.\n        return;\n      }\n    }\n\n    if (\n      this.oldHostMetrics &&\n      Scrollbar.metricsAreEquivalent(hostMetrics, this.oldHostMetrics)\n    ) {\n      return;\n    }\n\n    if (this.horizontal) {\n      this.resizeHorizontal(hostMetrics);\n    } else {\n      this.resizeVertical(hostMetrics);\n    }\n\n    this.oldHostMetrics = hostMetrics;\n\n    // Resizing may have caused some scrolling.\n    this.updateMetrics();\n  }\n\n  /**\n   * Returns whether the a resizeView is necessary by comparing the passed\n   * hostMetrics with cached old host metrics.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   * @returns Whether a resizeView is necessary.\n   */\n  private requiresViewResize(hostMetrics: Metrics): boolean {\n    if (!this.oldHostMetrics) {\n      return true;\n    }\n    return (\n      this.oldHostMetrics.viewWidth !== hostMetrics.viewWidth ||\n      this.oldHostMetrics.viewHeight !== hostMetrics.viewHeight ||\n      this.oldHostMetrics.absoluteLeft !== hostMetrics.absoluteLeft ||\n      this.oldHostMetrics.absoluteTop !== hostMetrics.absoluteTop\n    );\n  }\n\n  /**\n   * Recalculate a horizontal scrollbar's location and length.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  private resizeHorizontal(hostMetrics: Metrics) {\n    if (this.requiresViewResize(hostMetrics)) {\n      this.resizeViewHorizontal(hostMetrics);\n    } else {\n      this.resizeContentHorizontal(hostMetrics);\n    }\n  }\n\n  /**\n   * Recalculate a horizontal scrollbar's location on the screen and path\n   * length. This should be called when the layout or size of the window has\n   * changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeViewHorizontal(hostMetrics: Metrics) {\n    let viewSize = hostMetrics.viewWidth - this.margin * 2;\n    if (this.pair) {\n      // Shorten the scrollbar to make room for the corner square.\n      viewSize -= Scrollbar.scrollbarThickness;\n    }\n    this.setScrollbarLength(Math.max(0, viewSize));\n\n    let xCoordinate = hostMetrics.absoluteLeft + this.margin;\n    if (this.pair && this.workspace.RTL) {\n      xCoordinate += Scrollbar.scrollbarThickness;\n    }\n\n    // Horizontal toolbar should always be just above the bottom of the\n    // workspace.\n    const yCoordinate =\n      hostMetrics.absoluteTop +\n      hostMetrics.viewHeight -\n      Scrollbar.scrollbarThickness -\n      this.margin;\n    this.setPosition(xCoordinate, yCoordinate);\n\n    // If the view has been resized, a content resize will also be necessary.\n    // The reverse is not true.\n    this.resizeContentHorizontal(hostMetrics);\n  }\n\n  /**\n   * Recalculate a horizontal scrollbar's location within its path and length.\n   * This should be called when the contents of the workspace have changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeContentHorizontal(hostMetrics: Metrics) {\n    if (hostMetrics.viewWidth >= hostMetrics.scrollWidth) {\n      // viewWidth is often greater than scrollWidth in flyouts and\n      // non-scrollable workspaces.\n      this.setHandleLength(this.scrollbarLength);\n      this.setHandlePosition(0);\n      if (!this.pair) {\n        // The scrollbar isn't needed.\n        // This doesn't apply to scrollbar pairs because interactions with the\n        // corner square aren't handled.\n        this.setVisible(false);\n      }\n      return;\n    } else if (!this.pair) {\n      // The scrollbar is needed. Only non-paired scrollbars are hidden/shown.\n      this.setVisible(true);\n    }\n\n    // Resize the handle.\n    let handleLength =\n      (this.scrollbarLength * hostMetrics.viewWidth) / hostMetrics.scrollWidth;\n    handleLength = this.constrainHandleLength(handleLength);\n    this.setHandleLength(handleLength);\n\n    // Compute the handle offset.\n    // The position of the handle can be between:\n    //     0 and this.scrollbarLength_ - handleLength\n    // If viewLeft === scrollLeft\n    //     then the offset should be 0\n    // If viewRight === scrollRight\n    //     then viewLeft = scrollLeft + scrollWidth - viewWidth\n    //     then the offset should be max offset\n\n    const maxScrollDistance = hostMetrics.scrollWidth - hostMetrics.viewWidth;\n    const contentDisplacement = hostMetrics.viewLeft - hostMetrics.scrollLeft;\n    // Percent of content to the left of our current position.\n    const offsetRatio = contentDisplacement / maxScrollDistance;\n    // Area available to scroll * percent to the left\n    const maxHandleOffset = this.scrollbarLength - this.handleLength;\n    let handleOffset = maxHandleOffset * offsetRatio;\n    handleOffset = this.constrainHandlePosition(handleOffset);\n    this.setHandlePosition(handleOffset);\n\n    // Compute ratio (for use with set calls, which pass in content\n    // displacement).\n    this.ratio = maxHandleOffset / maxScrollDistance;\n  }\n\n  /**\n   * Recalculate a vertical scrollbar's location and length.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  private resizeVertical(hostMetrics: Metrics) {\n    if (this.requiresViewResize(hostMetrics)) {\n      this.resizeViewVertical(hostMetrics);\n    } else {\n      this.resizeContentVertical(hostMetrics);\n    }\n  }\n\n  /**\n   * Recalculate a vertical scrollbar's location on the screen and path length.\n   * This should be called when the layout or size of the window has changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeViewVertical(hostMetrics: Metrics) {\n    let viewSize = hostMetrics.viewHeight - this.margin * 2;\n    if (this.pair) {\n      // Shorten the scrollbar to make room for the corner square.\n      viewSize -= Scrollbar.scrollbarThickness;\n    }\n    this.setScrollbarLength(Math.max(0, viewSize));\n\n    const xCoordinate = this.workspace.RTL\n      ? hostMetrics.absoluteLeft + this.margin\n      : hostMetrics.absoluteLeft +\n        hostMetrics.viewWidth -\n        Scrollbar.scrollbarThickness -\n        this.margin;\n\n    const yCoordinate = hostMetrics.absoluteTop + this.margin;\n    this.setPosition(xCoordinate, yCoordinate);\n\n    // If the view has been resized, a content resize will also be necessary.\n    // The reverse is not true.\n    this.resizeContentVertical(hostMetrics);\n  }\n\n  /**\n   * Recalculate a vertical scrollbar's location within its path and length.\n   * This should be called when the contents of the workspace have changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeContentVertical(hostMetrics: Metrics) {\n    if (hostMetrics.viewHeight >= hostMetrics.scrollHeight) {\n      // viewHeight is often greater than scrollHeight in flyouts and\n      // non-scrollable workspaces.\n      this.setHandleLength(this.scrollbarLength);\n      this.setHandlePosition(0);\n      if (!this.pair) {\n        // The scrollbar isn't needed.\n        // This doesn't apply to scrollbar pairs because interactions with the\n        // corner square aren't handled.\n        this.setVisible(false);\n      }\n      return;\n    } else if (!this.pair) {\n      // The scrollbar is needed. Only non-paired scrollbars are hidden/shown.\n      this.setVisible(true);\n    }\n\n    // Resize the handle.\n    let handleLength =\n      (this.scrollbarLength * hostMetrics.viewHeight) /\n      hostMetrics.scrollHeight;\n    handleLength = this.constrainHandleLength(handleLength);\n    this.setHandleLength(handleLength);\n\n    // Compute the handle offset.\n    // The position of the handle can be between:\n    //     0 and this.scrollbarLength_ - handleLength\n    // If viewTop === scrollTop\n    //     then the offset should be 0\n    // If viewBottom === scrollBottom\n    //     then viewTop = scrollTop + scrollHeight - viewHeight\n    //     then the offset should be max offset\n\n    const maxScrollDistance = hostMetrics.scrollHeight - hostMetrics.viewHeight;\n    const contentDisplacement = hostMetrics.viewTop - hostMetrics.scrollTop;\n    // Percent of content to the left of our current position.\n    const offsetRatio = contentDisplacement / maxScrollDistance;\n    // Area available to scroll * percent to the left\n    const maxHandleOffset = this.scrollbarLength - this.handleLength;\n    let handleOffset = maxHandleOffset * offsetRatio;\n    handleOffset = this.constrainHandlePosition(handleOffset);\n    this.setHandlePosition(handleOffset);\n\n    // Compute ratio (for use with set calls, which pass in content\n    // displacement).\n    this.ratio = maxHandleOffset / maxScrollDistance;\n  }\n\n  /**\n   * Is the scrollbar visible.  Non-paired scrollbars disappear when they aren't\n   * needed.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.isHandleVisible;\n  }\n\n  /**\n   * Set whether the scrollbar's container is visible and update\n   * display accordingly if visibility has changed.\n   *\n   * @param visible Whether the container is visible\n   */\n  setContainerVisible(visible: boolean) {\n    const visibilityChanged = visible !== this.containerVisible;\n\n    this.containerVisible = visible;\n    if (visibilityChanged) {\n      this.updateDisplay_();\n    }\n  }\n\n  /**\n   * Set whether the scrollbar is visible.\n   * Only applies to non-paired scrollbars.\n   *\n   * @param visible True if visible.\n   */\n  setVisible(visible: boolean) {\n    // Ideally this would also apply to scrollbar pairs, but that's a bigger\n    // headache (due to interactions with the corner square), and the fact\n    // that telling the pair to resize itself would cause circular dependencies.\n    if (this.pair) {\n      throw Error('Unable to toggle visibility of paired scrollbars.');\n    }\n    this.setVisibleInternal(visible);\n  }\n\n  /**\n   * Set whether the scrollbar is visible. Bypasses checking whether this\n   * scrollbar is part of a pair so that it can be toggled by the scrollbar\n   * pair.\n   *\n   * @param visible True if visible.\n   * @internal\n   */\n  setVisibleInternal(visible: boolean) {\n    const visibilityChanged = visible !== this.isVisible();\n    this.isHandleVisible = visible;\n    if (visibilityChanged) {\n      this.updateDisplay_();\n    }\n  }\n\n  /**\n   * Update visibility of scrollbar based on whether it thinks it should\n   * be visible and whether its containing workspace is visible.\n   * We cannot rely on the containing workspace being hidden to hide us\n   * because it is not necessarily our parent in the DOM.\n   */\n  updateDisplay_() {\n    let show = true;\n    // Check whether our parent/container is visible.\n    if (!this.containerVisible) {\n      show = false;\n    } else {\n      show = this.isVisible();\n    }\n    if (show) {\n      this.outerSvg.setAttribute('display', 'block');\n    } else {\n      this.outerSvg.setAttribute('display', 'none');\n    }\n  }\n\n  /**\n   * Scroll by one pageful.\n   * Called when scrollbar background is clicked.\n   *\n   * @param e Mouse down event.\n   */\n  private onMouseDownBar(e: MouseEvent) {\n    this.workspace.markFocused();\n    Touch.clearTouchIdentifier(); // This is really a click.\n    this.cleanUp();\n    if (browserEvents.isRightButton(e)) {\n      // Right-click.\n      // Scrollbars have no context menu.\n      e.stopPropagation();\n      return;\n    }\n    const mouseXY = browserEvents.mouseToSvg(\n      e,\n      this.workspace.getParentSvg(),\n      this.workspace.getInverseScreenCTM(),\n    );\n    const mouseLocation = this.horizontal ? mouseXY.x : mouseXY.y;\n\n    const handleXY = svgMath.getInjectionDivXY(this.svgHandle);\n    const handleStart = this.horizontal ? handleXY.x : handleXY.y;\n    let handlePosition = this.handlePosition;\n\n    const pageLength = this.handleLength * 0.95;\n    if (mouseLocation <= handleStart) {\n      // Decrease the scrollbar's value by a page.\n      handlePosition -= pageLength;\n    } else if (mouseLocation >= handleStart + this.handleLength) {\n      // Increase the scrollbar's value by a page.\n      handlePosition += pageLength;\n    }\n\n    this.setHandlePosition(this.constrainHandlePosition(handlePosition));\n\n    this.updateMetrics();\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  /**\n   * Start a dragging operation.\n   * Called when scrollbar handle is clicked.\n   *\n   * @param e Mouse down event.\n   */\n  private onMouseDownHandle(e: PointerEvent) {\n    this.workspace.markFocused();\n    this.cleanUp();\n    if (browserEvents.isRightButton(e)) {\n      // Right-click.\n      // Scrollbars have no context menu.\n      e.stopPropagation();\n      return;\n    }\n    // Look up the current translation and record it.\n    this.startDragHandle = this.handlePosition;\n\n    // Record the current mouse position.\n    this.startDragMouse = this.horizontal ? e.clientX : e.clientY;\n    this.onMouseUpWrapper_ = browserEvents.conditionalBind(\n      document,\n      'pointerup',\n      this,\n      this.onMouseUpHandle,\n    );\n    this.onMouseMoveWrapper_ = browserEvents.conditionalBind(\n      document,\n      'pointermove',\n      this,\n      this.onMouseMoveHandle,\n    );\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  /**\n   * Drag the scrollbar's handle.\n   *\n   * @param e Mouse move event.\n   */\n  private onMouseMoveHandle(e: PointerEvent) {\n    const currentMouse = this.horizontal ? e.clientX : e.clientY;\n    const mouseDelta = currentMouse - this.startDragMouse;\n    const handlePosition = this.startDragHandle + mouseDelta;\n    // Position the bar.\n    this.setHandlePosition(this.constrainHandlePosition(handlePosition));\n    this.updateMetrics();\n  }\n\n  /** Release the scrollbar handle and reset state accordingly. */\n  private onMouseUpHandle() {\n    Touch.clearTouchIdentifier();\n    this.cleanUp();\n  }\n\n  /**\n   * Hide chaff and stop binding to mouseup and mousemove events.  Call this to\n   * wrap up loose ends associated with the scrollbar.\n   */\n  private cleanUp() {\n    this.workspace.hideChaff(true);\n    if (this.onMouseUpWrapper_) {\n      browserEvents.unbind(this.onMouseUpWrapper_);\n      this.onMouseUpWrapper_ = null;\n    }\n    if (this.onMouseMoveWrapper_) {\n      browserEvents.unbind(this.onMouseMoveWrapper_);\n      this.onMouseMoveWrapper_ = null;\n    }\n  }\n\n  /**\n   * Helper to calculate the ratio of handle position to scrollbar view size.\n   *\n   * @returns Ratio.\n   * @internal\n   */\n  getRatio_(): number {\n    const scrollHandleRange = this.scrollbarLength - this.handleLength;\n    let ratio = this.handlePosition / scrollHandleRange;\n    if (isNaN(ratio)) {\n      ratio = 0;\n    }\n    return ratio;\n  }\n\n  /**\n   * Updates workspace metrics based on new scroll ratio. Called when scrollbar\n   * is moved.\n   */\n  private updateMetrics() {\n    const ratio = this.getRatio_();\n    if (this.horizontal) {\n      this.workspace.setMetrics({x: ratio});\n    } else {\n      this.workspace.setMetrics({y: ratio});\n    }\n  }\n\n  /**\n   * Set the scrollbar handle's position.\n   *\n   * @param value The content displacement, relative to the view in pixels.\n   * @param updateMetrics Whether to update metrics on this set call.\n   *    Defaults to true.\n   */\n  set(value: number, updateMetrics?: boolean) {\n    this.setHandlePosition(this.constrainHandlePosition(value * this.ratio));\n    if (updateMetrics || updateMetrics === undefined) {\n      this.updateMetrics();\n    }\n  }\n\n  /**\n   * Record the origin of the workspace that the scrollbar is in, in pixels\n   * relative to the injection div origin. This is for times when the scrollbar\n   * is used in an object whose origin isn't the same as the main workspace\n   * (e.g. in a flyout.)\n   *\n   * @param x The x coordinate of the scrollbar's origin, in CSS pixels.\n   * @param y The y coordinate of the scrollbar's origin, in CSS pixels.\n   */\n  setOrigin(x: number, y: number) {\n    this.origin = new Coordinate(x, y);\n  }\n\n  /**\n   * @param first An object containing computed measurements of a workspace.\n   * @param second Another object containing computed measurements of a\n   *     workspace.\n   * @returns Whether the two sets of metrics are equivalent.\n   */\n  private static metricsAreEquivalent(\n    first: Metrics,\n    second: Metrics,\n  ): boolean {\n    return (\n      first.viewWidth === second.viewWidth &&\n      first.viewHeight === second.viewHeight &&\n      first.viewLeft === second.viewLeft &&\n      first.viewTop === second.viewTop &&\n      first.absoluteTop === second.absoluteTop &&\n      first.absoluteLeft === second.absoluteLeft &&\n      first.scrollWidth === second.scrollWidth &&\n      first.scrollHeight === second.scrollHeight &&\n      first.scrollLeft === second.scrollLeft &&\n      first.scrollTop === second.scrollTop\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Contains the path to a single png tat holds the images for the trashcan\n * as well as the zoom controls.\n */\nexport const SPRITE = {\n  width: 96,\n  height: 124,\n  url: 'sprites.png',\n};\n","/**\n * @license\n * Copyright 2015 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a zoom icons.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ZoomControls\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_click.js';\n\nimport * as browserEvents from './browser_events.js';\nimport {ComponentManager} from './component_manager.js';\nimport * as Css from './css.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IPositionable} from './interfaces/i_positionable.js';\nimport type {UiMetrics} from './metrics_manager.js';\nimport * as uiPosition from './positionable_helpers.js';\nimport {SPRITE} from './sprites.js';\nimport * as Touch from './touch.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for a zoom controls.\n */\nexport class ZoomControls implements IPositionable {\n  /**\n   * The unique ID for this component that is used to register with the\n   * ComponentManager.\n   */\n  id = 'zoomControls';\n\n  /**\n   * Array holding info needed to unbind events.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  private boundEvents: browserEvents.Data[] = [];\n\n  /** The zoom in svg <g> element. */\n  private zoomInGroup: SVGGElement | null = null;\n\n  /** The zoom out svg <g> element. */\n  private zoomOutGroup: SVGGElement | null = null;\n\n  /** The zoom reset svg <g> element. */\n  private zoomResetGroup: SVGGElement | null = null;\n\n  /** Width of the zoom controls. */\n  private readonly WIDTH = 32;\n\n  /** Height of each zoom control. */\n  private readonly HEIGHT = 32;\n\n  /** Small spacing used between the zoom in and out control, in pixels. */\n  private readonly SMALL_SPACING = 2;\n\n  /**\n   * Large spacing used between the zoom in and reset control, in pixels.\n   */\n  private readonly LARGE_SPACING = 11;\n\n  /** Distance between zoom controls and bottom or top edge of workspace. */\n  private readonly MARGIN_VERTICAL = 20;\n\n  /** Distance between zoom controls and right or left edge of workspace. */\n  private readonly MARGIN_HORIZONTAL = 20;\n\n  /** The SVG group containing the zoom controls. */\n  private svgGroup: SVGElement | null = null;\n\n  /** Left coordinate of the zoom controls. */\n  private left = 0;\n\n  /** Top coordinate of the zoom controls. */\n  private top = 0;\n\n  /** Whether this has been initialized. */\n  private initialized = false;\n\n  /** @param workspace The workspace to sit in. */\n  constructor(private readonly workspace: WorkspaceSvg) {}\n\n  /**\n   * Create the zoom controls.\n   *\n   * @returns The zoom controls SVG group.\n   */\n  createDom(): SVGElement {\n    this.svgGroup = dom.createSvgElement(Svg.G, {});\n\n    // Each filter/pattern needs a unique ID for the case of multiple Blockly\n    // instances on a page.  Browser behaviour becomes undefined otherwise.\n    // https://neil.fraser.name/news/2015/11/01/\n    const rnd = String(Math.random()).substring(2);\n    this.createZoomOutSvg(rnd);\n    this.createZoomInSvg(rnd);\n    if (this.workspace.isMovable()) {\n      // If we zoom to the center and the workspace isn't movable we could\n      // loose blocks at the edges of the workspace.\n      this.createZoomResetSvg(rnd);\n    }\n    return this.svgGroup;\n  }\n\n  /** Initializes the zoom controls. */\n  init() {\n    this.workspace.getComponentManager().addComponent({\n      component: this,\n      weight: 2,\n      capabilities: [ComponentManager.Capability.POSITIONABLE],\n    });\n    this.initialized = true;\n  }\n\n  /**\n   * Disposes of this zoom controls.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    this.workspace.getComponentManager().removeComponent('zoomControls');\n    if (this.svgGroup) {\n      dom.removeNode(this.svgGroup);\n    }\n    for (const event of this.boundEvents) {\n      browserEvents.unbind(event);\n    }\n    this.boundEvents.length = 0;\n  }\n\n  /**\n   * Returns the bounding rectangle of the UI element in pixel units relative to\n   * the Blockly injection div.\n   *\n   * @returns The UI elements's bounding box. Null if bounding box should be\n   *     ignored by other UI elements.\n   */\n  getBoundingRectangle(): Rect | null {\n    let height = this.SMALL_SPACING + 2 * this.HEIGHT;\n    if (this.zoomResetGroup) {\n      height += this.LARGE_SPACING + this.HEIGHT;\n    }\n    const bottom = this.top + height;\n    const right = this.left + this.WIDTH;\n    return new Rect(this.top, bottom, this.left, right);\n  }\n\n  /**\n   * Positions the zoom controls.\n   * It is positioned in the opposite corner to the corner the\n   * categories/toolbox starts at.\n   *\n   * @param metrics The workspace metrics.\n   * @param savedPositions List of rectangles that are already on the workspace.\n   */\n  position(metrics: UiMetrics, savedPositions: Rect[]) {\n    // Not yet initialized.\n    if (!this.initialized) {\n      return;\n    }\n\n    const cornerPosition = uiPosition.getCornerOppositeToolbox(\n      this.workspace,\n      metrics,\n    );\n    let height = this.SMALL_SPACING + 2 * this.HEIGHT;\n    if (this.zoomResetGroup) {\n      height += this.LARGE_SPACING + this.HEIGHT;\n    }\n    const startRect = uiPosition.getStartPositionRect(\n      cornerPosition,\n      new Size(this.WIDTH, height),\n      this.MARGIN_HORIZONTAL,\n      this.MARGIN_VERTICAL,\n      metrics,\n      this.workspace,\n    );\n\n    const verticalPosition = cornerPosition.vertical;\n    const bumpDirection =\n      verticalPosition === uiPosition.verticalPosition.TOP\n        ? uiPosition.bumpDirection.DOWN\n        : uiPosition.bumpDirection.UP;\n    const positionRect = uiPosition.bumpPositionRect(\n      startRect,\n      this.MARGIN_VERTICAL,\n      bumpDirection,\n      savedPositions,\n    );\n\n    if (verticalPosition === uiPosition.verticalPosition.TOP) {\n      const zoomInTranslateY = this.SMALL_SPACING + this.HEIGHT;\n      this.zoomInGroup?.setAttribute(\n        'transform',\n        'translate(0, ' + zoomInTranslateY + ')',\n      );\n      if (this.zoomResetGroup) {\n        const zoomResetTranslateY =\n          zoomInTranslateY + this.LARGE_SPACING + this.HEIGHT;\n        this.zoomResetGroup.setAttribute(\n          'transform',\n          'translate(0, ' + zoomResetTranslateY + ')',\n        );\n      }\n    } else {\n      const zoomInTranslateY = this.zoomResetGroup\n        ? this.LARGE_SPACING + this.HEIGHT\n        : 0;\n      this.zoomInGroup?.setAttribute(\n        'transform',\n        'translate(0, ' + zoomInTranslateY + ')',\n      );\n      const zoomOutTranslateY =\n        zoomInTranslateY + this.SMALL_SPACING + this.HEIGHT;\n      this.zoomOutGroup?.setAttribute(\n        'transform',\n        'translate(0, ' + zoomOutTranslateY + ')',\n      );\n    }\n\n    this.top = positionRect.top;\n    this.left = positionRect.left;\n    this.svgGroup?.setAttribute(\n      'transform',\n      'translate(' + this.left + ',' + this.top + ')',\n    );\n  }\n\n  /**\n   * Create the zoom in icon and its event handler.\n   *\n   * @param rnd The random string to use as a suffix in the clip path's ID.\n   *     These IDs must be unique in case there are multiple Blockly instances\n   *     on the same page.\n   */\n  private createZoomOutSvg(rnd: string) {\n    /* This markup will be generated and added to the .svgGroup:\n        <g class=\"blocklyZoom\">\n          <clipPath id=\"blocklyZoomoutClipPath837493\">\n            <rect width=\"32\" height=\"32></rect>\n          </clipPath>\n          <image width=\"96\" height=\"124\" x=\"-64\" y=\"-92\"\n        xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyZoomoutClipPath837493)\"></image>\n        </g>\n        */\n    this.zoomOutGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': 'blocklyZoom blocklyZoomOut'},\n      this.svgGroup,\n    );\n    const clip = dom.createSvgElement(\n      Svg.CLIPPATH,\n      {'id': 'blocklyZoomoutClipPath' + rnd},\n      this.zoomOutGroup,\n    );\n    dom.createSvgElement(\n      Svg.RECT,\n      {\n        'width': 32,\n        'height': 32,\n      },\n      clip,\n    );\n    const zoomoutSvg = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'width': SPRITE.width,\n        'height': SPRITE.height,\n        'x': -64,\n        'y': -92,\n        'clip-path': 'url(#blocklyZoomoutClipPath' + rnd + ')',\n      },\n      this.zoomOutGroup,\n    );\n    zoomoutSvg.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.workspace.options.pathToMedia + SPRITE.url,\n    );\n\n    // Attach listener.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        this.zoomOutGroup,\n        'pointerdown',\n        null,\n        this.zoom.bind(this, -1),\n      ),\n    );\n  }\n\n  /**\n   * Create the zoom out icon and its event handler.\n   *\n   * @param rnd The random string to use as a suffix in the clip path's ID.\n   *     These IDs must be unique in case there are multiple Blockly instances\n   *     on the same page.\n   */\n  private createZoomInSvg(rnd: string) {\n    /* This markup will be generated and added to the .svgGroup:\n        <g class=\"blocklyZoom\">\n          <clipPath id=\"blocklyZoominClipPath837493\">\n            <rect width=\"32\" height=\"32\"></rect>\n          </clipPath>\n          <image width=\"96\" height=\"124\" x=\"-32\" y=\"-92\"\n        xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyZoominClipPath837493)\"></image>\n        </g>\n        */\n    this.zoomInGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': 'blocklyZoom blocklyZoomIn'},\n      this.svgGroup,\n    );\n    const clip = dom.createSvgElement(\n      Svg.CLIPPATH,\n      {'id': 'blocklyZoominClipPath' + rnd},\n      this.zoomInGroup,\n    );\n    dom.createSvgElement(\n      Svg.RECT,\n      {\n        'width': 32,\n        'height': 32,\n      },\n      clip,\n    );\n    const zoominSvg = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'width': SPRITE.width,\n        'height': SPRITE.height,\n        'x': -32,\n        'y': -92,\n        'clip-path': 'url(#blocklyZoominClipPath' + rnd + ')',\n      },\n      this.zoomInGroup,\n    );\n    zoominSvg.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.workspace.options.pathToMedia + SPRITE.url,\n    );\n\n    // Attach listener.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        this.zoomInGroup,\n        'pointerdown',\n        null,\n        this.zoom.bind(this, 1),\n      ),\n    );\n  }\n\n  /**\n   * Handles a mouse down event on the zoom in or zoom out buttons on the\n   *    workspace.\n   *\n   * @param amount Amount of zooming. Negative amount values zoom out, and\n   *     positive amount values zoom in.\n   * @param e A mouse down event.\n   */\n  private zoom(amount: number, e: PointerEvent) {\n    this.workspace.markFocused();\n    this.workspace.zoomCenter(amount);\n    this.fireZoomEvent();\n    Touch.clearTouchIdentifier(); // Don't block future drags.\n    e.stopPropagation(); // Don't start a workspace scroll.\n    e.preventDefault(); // Stop double-clicking from selecting text.\n  }\n\n  /**\n   * Create the zoom reset icon and its event handler.\n   *\n   * @param rnd The random string to use as a suffix in the clip path's ID.\n   *     These IDs must be unique in case there are multiple Blockly instances\n   *     on the same page.\n   */\n  private createZoomResetSvg(rnd: string) {\n    /* This markup will be generated and added to the .svgGroup:\n        <g class=\"blocklyZoom\">\n          <clipPath id=\"blocklyZoomresetClipPath837493\">\n            <rect width=\"32\" height=\"32\"></rect>\n          </clipPath>\n          <image width=\"96\" height=\"124\" x=\"-32\" y=\"-92\"\n        xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyZoomresetClipPath837493)\"></image>\n        </g>\n        */\n    this.zoomResetGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': 'blocklyZoom blocklyZoomReset'},\n      this.svgGroup,\n    );\n    const clip = dom.createSvgElement(\n      Svg.CLIPPATH,\n      {'id': 'blocklyZoomresetClipPath' + rnd},\n      this.zoomResetGroup,\n    );\n    dom.createSvgElement(Svg.RECT, {'width': 32, 'height': 32}, clip);\n    const zoomresetSvg = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'width': SPRITE.width,\n        'height': SPRITE.height,\n        'y': -92,\n        'clip-path': 'url(#blocklyZoomresetClipPath' + rnd + ')',\n      },\n      this.zoomResetGroup,\n    );\n    zoomresetSvg.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.workspace.options.pathToMedia + SPRITE.url,\n    );\n\n    // Attach event listeners.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        this.zoomResetGroup,\n        'pointerdown',\n        null,\n        this.resetZoom.bind(this),\n      ),\n    );\n  }\n\n  /**\n   * Handles a mouse down event on the reset zoom button on the workspace.\n   *\n   * @param e A mouse down event.\n   */\n  private resetZoom(e: PointerEvent) {\n    this.workspace.markFocused();\n\n    // zoom is passed amount and computes the new scale using the formula:\n    // targetScale = currentScale * Math.pow(speed, amount)\n    const targetScale = this.workspace.options.zoomOptions.startScale;\n    const currentScale = this.workspace.scale;\n    const speed = this.workspace.options.zoomOptions.scaleSpeed;\n    // To compute amount:\n    // amount = log(speed, (targetScale / currentScale))\n    // Math.log computes natural logarithm (ln), to change the base, use\n    // formula: log(base, value) = ln(value) / ln(base)\n    const amount = Math.log(targetScale / currentScale) / Math.log(speed);\n    this.workspace.beginCanvasTransition();\n    this.workspace.zoomCenter(amount);\n    this.workspace.scrollCenter();\n\n    setTimeout(this.workspace.endCanvasTransition.bind(this.workspace), 500);\n    this.fireZoomEvent();\n    Touch.clearTouchIdentifier(); // Don't block future drags.\n    e.stopPropagation(); // Don't start a workspace scroll.\n    e.preventDefault(); // Stop double-clicking from selecting text.\n  }\n\n  /** Fires a zoom control UI event. */\n  private fireZoomEvent() {\n    const uiEvent = new (eventUtils.get(eventUtils.CLICK))(\n      null,\n      this.workspace.id,\n      'zoom_controls',\n    );\n    eventUtils.fire(uiEvent);\n  }\n}\n\n/** CSS for zoom controls.  See css.js for use. */\nCss.register(`\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n`);\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.constants\n\n/**\n * The language-neutral ID given to the collapsed input.\n */\nexport const COLLAPSED_INPUT_NAME = '_TEMP_COLLAPSED_INPUT';\n\n/**\n * The language-neutral ID given to the collapsed field.\n */\nexport const COLLAPSED_FIELD_NAME = '_TEMP_COLLAPSED_FIELD';\n\n/**\n * The language-neutral ID for when the reason why a block is disabled is\n * because the user manually disabled it, such as via the context menu.\n */\nexport const MANUALLY_DISABLED = 'MANUALLY_DISABLED';\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {ICommentIcon} from '../interfaces/i_comment_icon.js';\nimport {IIcon} from '../interfaces/i_icon.js';\nimport {MutatorIcon} from './mutator_icon.js';\nimport {WarningIcon} from './warning_icon.js';\n\n/**\n * Defines the type of an icon, so that it can be retrieved from block.getIcon\n */\nexport class IconType<_T extends IIcon> {\n  /** @param name The name of the registry type. */\n  constructor(private readonly name: string) {}\n\n  /** @returns the name of the type. */\n  toString(): string {\n    return this.name;\n  }\n\n  /** @returns true if this icon type is equivalent to the given icon type. */\n  equals(type: IconType<IIcon>): boolean {\n    return this.name === type.toString();\n  }\n\n  static MUTATOR = new IconType<MutatorIcon>('mutator');\n  static WARNING = new IconType<WarningIcon>('warning');\n  static COMMENT = new IconType<ICommentIcon>('comment');\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.inputTypes\n\nimport {ConnectionType} from '../connection_type.js';\n\n/**\n * Enum for the type of a connection or input.\n */\nexport enum inputTypes {\n  // A right-facing value input.  E.g. 'set item to' or 'return'.\n  VALUE = ConnectionType.INPUT_VALUE,\n  // A down-facing block stack.  E.g. 'if-do' or 'else'.\n  STATEMENT = ConnectionType.NEXT_STATEMENT,\n  // A dummy input.  Used to add field(s) with no input.\n  DUMMY = 5,\n  // An unknown type of input defined by an external developer.\n  CUSTOM = 6,\n  // An input with no connections that is always the last input of a row. Any\n  // subsequent input will be rendered on the next row. Any newline character in\n  // a JSON block definition's message will be parsed as an end-row input.\n  END_ROW = 7,\n}\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Msg\n\n/** A dictionary of localised messages. */\nexport const Msg: {[key: string]: string} = Object.create(null);\n\n/**\n * Sets the locale (i.e. the localized messages/block-text/etc) to the given\n * locale.\n *\n * This is not useful/necessary when loading from a script tag, because the\n * messages are automatically cluged into the Blockly.Msg object. But we provide\n * it in both the script-tag and non-script-tag contexts so that the tscompiler\n * can properly create our type definition files.\n *\n * @param locale An object defining the messages for a given language.\n */\nexport const setLocale = function (locale: {[key: string]: string}) {\n  Object.keys(locale).forEach(function (k) {\n    Msg[k] = locale[k];\n  });\n};\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Abstract class for a variable event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.VarBase\n\nimport type {VariableModel} from '../variable_model.js';\n\nimport {\n  Abstract as AbstractEvent,\n  AbstractEventJson,\n} from './events_abstract.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Abstract class for a variable event.\n */\nexport class VarBase extends AbstractEvent {\n  override isBlank = true;\n  /** The ID of the variable this event references. */\n  varId?: string;\n\n  /**\n   * @param opt_variable The variable this event corresponds to.  Undefined for\n   *     a blank event.\n   */\n  constructor(opt_variable?: VariableModel) {\n    super();\n    this.isBlank = typeof opt_variable === 'undefined';\n    if (!opt_variable) return;\n\n    this.varId = opt_variable.getId();\n    this.workspaceId = opt_variable.workspace.id;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): VarBaseJson {\n    const json = super.toJson() as VarBaseJson;\n    if (!this.varId) {\n      throw new Error(\n        'The var ID is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['varId'] = this.varId;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of VarBase, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: VarBaseJson,\n    workspace: Workspace,\n    event?: any,\n  ): VarBase {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new VarBase(),\n    ) as VarBase;\n    newEvent.varId = json['varId'];\n    return newEvent;\n  }\n}\n\nexport interface VarBaseJson extends AbstractEventJson {\n  varId: string;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a variable creation event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.VarCreate\n\nimport * as registry from '../registry.js';\nimport type {VariableModel} from '../variable_model.js';\n\nimport {VarBase, VarBaseJson} from './events_var_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a variable model has been created.\n */\nexport class VarCreate extends VarBase {\n  override type = eventUtils.VAR_CREATE;\n\n  /** The type of the variable that was created. */\n  varType?: string;\n\n  /** The name of the variable that was created. */\n  varName?: string;\n\n  /**\n   * @param opt_variable The created variable. Undefined for a blank event.\n   */\n  constructor(opt_variable?: VariableModel) {\n    super(opt_variable);\n\n    if (!opt_variable) {\n      return; // Blank event to be populated by fromJson.\n    }\n    this.varType = opt_variable.type;\n    this.varName = opt_variable.name;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): VarCreateJson {\n    const json = super.toJson() as VarCreateJson;\n    if (this.varType === undefined) {\n      throw new Error(\n        'The var type is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.varName) {\n      throw new Error(\n        'The var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['varType'] = this.varType;\n    json['varName'] = this.varName;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of VarCreate, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: VarCreateJson,\n    workspace: Workspace,\n    event?: any,\n  ): VarCreate {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new VarCreate(),\n    ) as VarCreate;\n    newEvent.varType = json['varType'];\n    newEvent.varName = json['varName'];\n    return newEvent;\n  }\n\n  /**\n   * Run a variable creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.varId) {\n      throw new Error(\n        'The var ID is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.varName) {\n      throw new Error(\n        'The var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (forward) {\n      workspace.createVariable(this.varName, this.varType, this.varId);\n    } else {\n      workspace.deleteVariableById(this.varId);\n    }\n  }\n}\n\nexport interface VarCreateJson extends VarBaseJson {\n  varType: string;\n  varName: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.VAR_CREATE, VarCreate);\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Components for the variable model.\n *\n * @class\n */\n// Former goog.module ID: Blockly.VariableModel\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_create.js';\n\nimport * as idGenerator from './utils/idgenerator.js';\nimport type {Workspace} from './workspace.js';\n\n/**\n * Class for a variable model.\n * Holds information for the variable including name, ID, and type.\n *\n * @see {Blockly.FieldVariable}\n */\nexport class VariableModel {\n  type: string;\n  private readonly id_: string;\n\n  /**\n   * @param workspace The variable's workspace.\n   * @param name The name of the variable.  This is the user-visible name (e.g.\n   *     'my var' or ''), not the generated name.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   */\n  constructor(\n    public workspace: Workspace,\n    public name: string,\n    opt_type?: string,\n    opt_id?: string,\n  ) {\n    /**\n     * The type of the variable, such as 'int' or 'sound_effect'. This may be\n     * used to build a list of variables of a specific type. By default this is\n     * the empty string '', which is a specific type.\n     *\n     * @see {Blockly.FieldVariable}\n     */\n    this.type = opt_type || '';\n\n    /**\n     * A unique ID for the variable. This should be defined at creation and\n     * not change, even if the name changes. In most cases this should be a\n     * UUID.\n     */\n    this.id_ = opt_id || idGenerator.genUid();\n  }\n\n  /** @returns The ID for the variable. */\n  getId(): string {\n    return this.id_;\n  }\n\n  /**\n   * A custom compare function for the VariableModel objects.\n   *\n   * @param var1 First variable to compare.\n   * @param var2 Second variable to compare.\n   * @returns -1 if name of var1 is less than name of var2, 0 if equal, and 1 if\n   *     greater.\n   * @internal\n   */\n  static compareByName(var1: VariableModel, var2: VariableModel): number {\n    return var1.name.localeCompare(var2.name, undefined, {sensitivity: 'base'});\n  }\n}\n","/**\n * @license\n * Copyright 2024 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Workspace} from '../workspace.js';\nimport {Size} from '../utils/size.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as idGenerator from '../utils/idgenerator.js';\nimport * as eventUtils from '../events/utils.js';\nimport {CommentMove} from '../events/events_comment_move.js';\n\nexport class WorkspaceComment {\n  /** The unique identifier for this comment. */\n  public readonly id: string;\n\n  /** The text of the comment. */\n  private text = '';\n\n  /** The size of the comment in workspace units. */\n  private size = new Size(120, 100);\n\n  /** Whether the comment is collapsed or not. */\n  private collapsed = false;\n\n  /** Whether the comment is editable or not. */\n  private editable = true;\n\n  /** Whether the comment is movable or not. */\n  private movable = true;\n\n  /** Whether the comment is deletable or not. */\n  private deletable = true;\n\n  /** The location of the comment in workspace coordinates. */\n  protected location = new Coordinate(0, 0);\n\n  /** Whether this comment has been disposed or not. */\n  protected disposed = false;\n\n  /** Whether this comment is being disposed or not. */\n  protected disposing = false;\n\n  /**\n   * Constructs the comment.\n   *\n   * @param workspace The workspace to construct the comment in.\n   * @param id An optional ID to give to the comment. If not provided, one will\n   *     be generated.\n   */\n  constructor(\n    public readonly workspace: Workspace,\n    id?: string,\n  ) {\n    this.id = id && !workspace.getCommentById(id) ? id : idGenerator.genUid();\n\n    workspace.addTopComment(this);\n\n    this.fireCreateEvent();\n  }\n\n  private fireCreateEvent() {\n    if (eventUtils.isEnabled()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.COMMENT_CREATE))(this));\n    }\n  }\n\n  private fireDeleteEvent() {\n    if (eventUtils.isEnabled()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.COMMENT_DELETE))(this));\n    }\n  }\n\n  /** Fires a comment change event. */\n  private fireChangeEvent(oldText: string, newText: string) {\n    if (eventUtils.isEnabled()) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.COMMENT_CHANGE))(this, oldText, newText),\n      );\n    }\n  }\n\n  /** Fires a comment collapse event. */\n  private fireCollapseEvent(newCollapsed: boolean) {\n    if (eventUtils.isEnabled()) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.COMMENT_COLLAPSE))(this, newCollapsed),\n      );\n    }\n  }\n\n  /** Sets the text of the comment. */\n  setText(text: string) {\n    const oldText = this.text;\n    this.text = text;\n    this.fireChangeEvent(oldText, text);\n  }\n\n  /** Returns the text of the comment. */\n  getText(): string {\n    return this.text;\n  }\n\n  /** Sets the comment's size in workspace units. */\n  setSize(size: Size) {\n    this.size = size;\n  }\n\n  /** Returns the comment's size in workspace units. */\n  getSize(): Size {\n    return this.size;\n  }\n\n  /** Sets whether the comment is collapsed or not. */\n  setCollapsed(collapsed: boolean) {\n    this.collapsed = collapsed;\n    this.fireCollapseEvent(collapsed);\n  }\n\n  /** Returns whether the comment is collapsed or not. */\n  isCollapsed(): boolean {\n    return this.collapsed;\n  }\n\n  /** Sets whether the comment is editable or not. */\n  setEditable(editable: boolean) {\n    this.editable = editable;\n  }\n\n  /**\n   * Returns whether the comment is editable or not, respecting whether the\n   * workspace is read-only.\n   */\n  isEditable(): boolean {\n    return this.isOwnEditable() && !this.workspace.options.readOnly;\n  }\n\n  /**\n   * Returns whether the comment is editable or not, only examining its own\n   * state and ignoring the state of the workspace.\n   */\n  isOwnEditable(): boolean {\n    return this.editable;\n  }\n\n  /** Sets whether the comment is movable or not. */\n  setMovable(movable: boolean) {\n    this.movable = movable;\n  }\n\n  /**\n   * Returns whether the comment is movable or not, respecting whether the\n   * workspace is read-only.\n   */\n  isMovable() {\n    return this.isOwnMovable() && !this.workspace.options.readOnly;\n  }\n\n  /**\n   * Returns whether the comment is movable or not, only examining its own\n   * state and ignoring the state of the workspace.\n   */\n  isOwnMovable() {\n    return this.movable;\n  }\n\n  /** Sets whether the comment is deletable or not. */\n  setDeletable(deletable: boolean) {\n    this.deletable = deletable;\n  }\n\n  /**\n   * Returns whether the comment is deletable or not, respecting whether the\n   * workspace is read-only.\n   */\n  isDeletable(): boolean {\n    return this.isOwnDeletable() && !this.workspace.options.readOnly;\n  }\n\n  /**\n   * Returns whether the comment is deletable or not, only examining its own\n   * state and ignoring the state of the workspace.\n   */\n  isOwnDeletable(): boolean {\n    return this.deletable;\n  }\n\n  /** Moves the comment to the given location in workspace coordinates. */\n  moveTo(location: Coordinate, reason?: string[] | undefined) {\n    const event = new (eventUtils.get(eventUtils.COMMENT_MOVE))(\n      this,\n    ) as CommentMove;\n    if (reason) event.setReason(reason);\n\n    this.location = location;\n\n    event.recordNew();\n    if (eventUtils.isEnabled()) eventUtils.fire(event);\n  }\n\n  /** Returns the position of the comment in workspace coordinates. */\n  getRelativeToSurfaceXY(): Coordinate {\n    return this.location;\n  }\n\n  /** Disposes of this comment. */\n  dispose() {\n    this.disposing = true;\n    this.fireDeleteEvent();\n    this.workspace.removeTopComment(this);\n    this.disposed = true;\n  }\n\n  /** Returns whether the comment has been disposed or not. */\n  isDisposed() {\n    return this.disposed;\n  }\n\n  /**\n   * Returns true if this comment view is currently being disposed or has\n   * already been disposed.\n   */\n  isDeadOrDying(): boolean {\n    return this.disposing || this.disposed;\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The layer to place blocks on.\n *\n * @internal\n */\nexport const BLOCK = 50;\n\n/**\n * The layer to place bubbles on.\n *\n * @internal\n */\nexport const BUBBLE = 100;\n","/**\n * @license\n * Copyright 2024 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IRenderedElement} from '../interfaces/i_rendered_element.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport * as dom from '../utils/dom.js';\nimport {Svg} from '../utils/svg.js';\nimport * as layers from '../layers.js';\nimport * as css from '../css.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport {Size} from '../utils/size.js';\nimport * as browserEvents from '../browser_events.js';\nimport * as touch from '../touch.js';\n\nexport class CommentView implements IRenderedElement {\n  /** The root group element of the comment view. */\n  private svgRoot: SVGGElement;\n\n  /**\n   * The svg rect element that we use to create a hightlight around the comment.\n   */\n  private highlightRect: SVGRectElement;\n\n  /** The group containing all of the top bar elements. */\n  private topBarGroup: SVGGElement;\n\n  /** The rect background for the top bar. */\n  private topBarBackground: SVGRectElement;\n\n  /** The delete icon that goes in the top bar. */\n  private deleteIcon: SVGImageElement;\n\n  /** The foldout icon that goes in the top bar. */\n  private foldoutIcon: SVGImageElement;\n\n  /** The text element that goes in the top bar. */\n  private textPreview: SVGTextElement;\n\n  /** The actual text node in the text preview. */\n  private textPreviewNode: Text;\n\n  /** The resize handle element. */\n  private resizeHandle: SVGImageElement;\n\n  /** The foreignObject containing the HTML text area. */\n  private foreignObject: SVGForeignObjectElement;\n\n  /** The text area where the user can type. */\n  private textArea: HTMLTextAreaElement;\n\n  /** The current size of the comment in workspace units. */\n  private size: Size = new Size(120, 100);\n\n  /** Whether the comment is collapsed or not. */\n  private collapsed: boolean = false;\n\n  /** Whether the comment is editable or not. */\n  private editable: boolean = true;\n\n  /** The current location of the comment in workspace coordinates. */\n  private location: Coordinate = new Coordinate(0, 0);\n\n  /** The current text of the comment. Updates on  text area change. */\n  private text: string = '';\n\n  /** Listeners for changes to text. */\n  private textChangeListeners: Array<\n    (oldText: string, newText: string) => void\n  > = [];\n\n  /** Listeners for changes to size. */\n  private sizeChangeListeners: Array<(oldSize: Size, newSize: Size) => void> =\n    [];\n\n  /** Listeners for disposal. */\n  private disposeListeners: Array<() => void> = [];\n\n  /** Listeners for collapsing. */\n  private collapseChangeListeners: Array<(newCollapse: boolean) => void> = [];\n\n  /**\n   * Event data for the pointer up event on the resize handle. Used to\n   * unregister the listener.\n   */\n  private resizePointerUpListener: browserEvents.Data | null = null;\n\n  /**\n   * Event data for the pointer move event on the resize handle. Used to\n   * unregister the listener.\n   */\n  private resizePointerMoveListener: browserEvents.Data | null = null;\n\n  /** Whether this comment view is currently being disposed or not. */\n  private disposing = false;\n\n  /** Whether this comment view has been disposed or not. */\n  private disposed = false;\n\n  constructor(private readonly workspace: WorkspaceSvg) {\n    this.svgRoot = dom.createSvgElement(Svg.G, {\n      'class': 'blocklyComment blocklyEditable',\n    });\n\n    this.highlightRect = this.createHighlightRect(this.svgRoot);\n\n    ({\n      topBarGroup: this.topBarGroup,\n      topBarBackground: this.topBarBackground,\n      deleteIcon: this.deleteIcon,\n      foldoutIcon: this.foldoutIcon,\n      textPreview: this.textPreview,\n      textPreviewNode: this.textPreviewNode,\n    } = this.createTopBar(this.svgRoot, workspace));\n\n    ({foreignObject: this.foreignObject, textArea: this.textArea} =\n      this.createTextArea(this.svgRoot));\n\n    this.resizeHandle = this.createResizeHandle(this.svgRoot, workspace);\n\n    // TODO: Remove this comment before merging.\n    // I think we want comments to exist on the same layer as blocks.\n    workspace.getLayerManager()?.append(this, layers.BLOCK);\n\n    // Set size to the default size.\n    this.setSize(this.size);\n\n    // Set default transform (including inverted scale for RTL).\n    this.moveTo(new Coordinate(0, 0));\n  }\n\n  /**\n   * Creates the rect we use for highlighting the comment when it's selected.\n   */\n  private createHighlightRect(svgRoot: SVGGElement): SVGRectElement {\n    return dom.createSvgElement(\n      Svg.RECT,\n      {'class': 'blocklyCommentHighlight'},\n      svgRoot,\n    );\n  }\n\n  /**\n   * Creates the top bar and the elements visually within it.\n   * Registers event listeners.\n   */\n  private createTopBar(\n    svgRoot: SVGGElement,\n    workspace: WorkspaceSvg,\n  ): {\n    topBarGroup: SVGGElement;\n    topBarBackground: SVGRectElement;\n    deleteIcon: SVGImageElement;\n    foldoutIcon: SVGImageElement;\n    textPreview: SVGTextElement;\n    textPreviewNode: Text;\n  } {\n    const topBarGroup = dom.createSvgElement(\n      Svg.G,\n      {\n        'class': 'blocklyCommentTopbar',\n      },\n      svgRoot,\n    );\n    const topBarBackground = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyCommentTopbarBackground',\n      },\n      topBarGroup,\n    );\n    // TODO: Before merging, does this mean to override an individual image,\n    // folks need to replace the whole media folder?\n    const deleteIcon = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'class': 'blocklyDeleteIcon',\n        'href': `${workspace.options.pathToMedia}delete-icon.svg`,\n      },\n      topBarGroup,\n    );\n    const foldoutIcon = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'class': 'blocklyFoldoutIcon',\n        'href': `${workspace.options.pathToMedia}foldout-icon.svg`,\n      },\n      topBarGroup,\n    );\n    const textPreview = dom.createSvgElement(\n      Svg.TEXT,\n      {\n        'class': 'blocklyCommentPreview blocklyCommentText blocklyText',\n      },\n      topBarGroup,\n    );\n    const textPreviewNode = document.createTextNode('');\n    textPreview.appendChild(textPreviewNode);\n\n    // TODO(toychest): Triggering this on pointerdown means that we can't start\n    //   drags on the foldout icon. We need to open up the gesture system\n    //   to fix this.\n    browserEvents.conditionalBind(\n      foldoutIcon,\n      'pointerdown',\n      this,\n      this.onFoldoutDown,\n    );\n    browserEvents.conditionalBind(\n      deleteIcon,\n      'pointerdown',\n      this,\n      this.onDeleteDown,\n    );\n\n    return {\n      topBarGroup,\n      topBarBackground,\n      deleteIcon,\n      foldoutIcon,\n      textPreview,\n      textPreviewNode,\n    };\n  }\n\n  /**\n   * Creates the text area where users can type. Registers event listeners.\n   */\n  private createTextArea(svgRoot: SVGGElement): {\n    foreignObject: SVGForeignObjectElement;\n    textArea: HTMLTextAreaElement;\n  } {\n    const foreignObject = dom.createSvgElement(\n      Svg.FOREIGNOBJECT,\n      {\n        'class': 'blocklyCommentForeignObject',\n      },\n      svgRoot,\n    );\n    const body = document.createElementNS(dom.HTML_NS, 'body');\n    body.setAttribute('xmlns', dom.HTML_NS);\n    body.className = 'blocklyMinimalBody';\n    const textArea = document.createElementNS(\n      dom.HTML_NS,\n      'textarea',\n    ) as HTMLTextAreaElement;\n    dom.addClass(textArea, 'blocklyCommentText');\n    dom.addClass(textArea, 'blocklyTextarea');\n    dom.addClass(textArea, 'blocklyText');\n    body.appendChild(textArea);\n    foreignObject.appendChild(body);\n\n    browserEvents.conditionalBind(textArea, 'change', this, this.onTextChange);\n\n    return {foreignObject, textArea};\n  }\n\n  /** Creates the DOM elements for the comment resize handle. */\n  private createResizeHandle(\n    svgRoot: SVGGElement,\n    workspace: WorkspaceSvg,\n  ): SVGImageElement {\n    const resizeHandle = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'class': 'blocklyResizeHandle',\n        'href': `${workspace.options.pathToMedia}resize-handle.svg`,\n      },\n      svgRoot,\n    );\n\n    browserEvents.conditionalBind(\n      resizeHandle,\n      'pointerdown',\n      this,\n      this.onResizePointerDown,\n    );\n\n    return resizeHandle;\n  }\n\n  /** Returns the root SVG group element of the comment view. */\n  getSvgRoot(): SVGGElement {\n    return this.svgRoot;\n  }\n\n  /**\n   * Returns the current size of the comment in workspace units.\n   * Respects collapsing.\n   */\n  getSize(): Size {\n    return this.collapsed ? this.topBarBackground.getBBox() : this.size;\n  }\n\n  /**\n   * Sets the size of the comment in workspace units, and updates the view\n   * elements to reflect the new size.\n   */\n  setSize(size: Size) {\n    const topBarSize = this.topBarBackground.getBBox();\n    const deleteSize = this.deleteIcon.getBBox();\n    const foldoutSize = this.foldoutIcon.getBBox();\n    const textPreviewSize = this.textPreview.getBBox();\n    const resizeSize = this.resizeHandle.getBBox();\n\n    size = Size.max(\n      size,\n      this.calcMinSize(topBarSize, foldoutSize, deleteSize),\n    );\n    const oldSize = this.size;\n    this.size = size;\n\n    this.svgRoot.setAttribute('height', `${size.height}`);\n    this.svgRoot.setAttribute('width', `${size.width}`);\n\n    this.updateHighlightRect(size);\n    this.updateTopBarSize(size);\n    this.updateTextAreaSize(size, topBarSize);\n    this.updateDeleteIconPosition(size, topBarSize, deleteSize);\n    this.updateFoldoutIconPosition(topBarSize, foldoutSize);\n    this.updateTextPreviewSize(\n      size,\n      topBarSize,\n      textPreviewSize,\n      deleteSize,\n      resizeSize,\n    );\n    this.updateResizeHandlePosition(size, resizeSize);\n\n    this.onSizeChange(oldSize, this.size);\n  }\n\n  /**\n   * Calculates the minimum size for the uncollapsed comment based on text\n   * size and visible icons.\n   *\n   * The minimum width is based on the width of the truncated preview text.\n   *\n   * The minimum height is based on the height of the top bar.\n   */\n  private calcMinSize(\n    topBarSize: Size,\n    foldoutSize: Size,\n    deleteSize: Size,\n  ): Size {\n    this.updateTextPreview(this.textArea.value ?? '');\n    const textPreviewWidth = dom.getTextWidth(this.textPreview);\n\n    const foldoutMargin = this.calcFoldoutMargin(topBarSize, foldoutSize);\n    const deleteMargin = this.calcDeleteMargin(topBarSize, deleteSize);\n\n    let width = textPreviewWidth;\n    if (this.foldoutIcon.checkVisibility()) {\n      width += foldoutSize.width + foldoutMargin * 2;\n    } else if (textPreviewWidth) {\n      width += 4; // Arbitrary margin before text.\n    }\n    if (this.deleteIcon.checkVisibility()) {\n      width += deleteSize.width + deleteMargin * 2;\n    } else if (textPreviewWidth) {\n      width += 4; // Arbitrary margin after text.\n    }\n\n    // Arbitrary additional height.\n    const height = topBarSize.height + 20;\n\n    return new Size(width, height);\n  }\n\n  /** Calculates the margin that should exist around the delete icon. */\n  private calcDeleteMargin(topBarSize: Size, deleteSize: Size) {\n    return (topBarSize.height - deleteSize.height) / 2;\n  }\n\n  /** Calculates the margin that should exist around the foldout icon. */\n  private calcFoldoutMargin(topBarSize: Size, foldoutSize: Size) {\n    return (topBarSize.height - foldoutSize.height) / 2;\n  }\n\n  /** Updates the size of the highlight rect to reflect the new size. */\n  private updateHighlightRect(size: Size) {\n    this.highlightRect.setAttribute('height', `${size.height}`);\n    this.highlightRect.setAttribute('width', `${size.width}`);\n    if (this.workspace.RTL) {\n      this.highlightRect.setAttribute('x', `${-size.width}`);\n    }\n  }\n\n  /** Updates the size of the top bar to reflect the new size. */\n  private updateTopBarSize(size: Size) {\n    this.topBarBackground.setAttribute('width', `${size.width}`);\n  }\n\n  /** Updates the size of the text area elements to reflect the new size. */\n  private updateTextAreaSize(size: Size, topBarSize: Size) {\n    this.foreignObject.setAttribute(\n      'height',\n      `${size.height - topBarSize.height}`,\n    );\n    this.foreignObject.setAttribute('width', `${size.width}`);\n    this.foreignObject.setAttribute('y', `${topBarSize.height}`);\n    if (this.workspace.RTL) {\n      this.foreignObject.setAttribute('x', `${-size.width}`);\n    }\n  }\n\n  /**\n   * Updates the position of the delete icon elements to reflect the new size.\n   */\n  private updateDeleteIconPosition(\n    size: Size,\n    topBarSize: Size,\n    deleteSize: Size,\n  ) {\n    const deleteMargin = this.calcDeleteMargin(topBarSize, deleteSize);\n    this.deleteIcon.setAttribute('y', `${deleteMargin}`);\n    this.deleteIcon.setAttribute(\n      'x',\n      `${size.width - deleteSize.width - deleteMargin}`,\n    );\n  }\n\n  /**\n   * Updates the position of the foldout icon elements to reflect the new size.\n   */\n  private updateFoldoutIconPosition(topBarSize: Size, foldoutSize: Size) {\n    const foldoutMargin = this.calcFoldoutMargin(topBarSize, foldoutSize);\n    this.foldoutIcon.setAttribute('y', `${foldoutMargin}`);\n    this.foldoutIcon.setAttribute('x', `${foldoutMargin}`);\n  }\n\n  /**\n   * Updates the size and position of the text preview elements to reflect the new size.\n   */\n  private updateTextPreviewSize(\n    size: Size,\n    topBarSize: Size,\n    textPreviewSize: Size,\n    deleteSize: Size,\n    foldoutSize: Size,\n  ) {\n    const textPreviewMargin = (topBarSize.height - textPreviewSize.height) / 2;\n    const deleteMargin = this.calcDeleteMargin(topBarSize, deleteSize);\n    const foldoutMargin = this.calcFoldoutMargin(topBarSize, foldoutSize);\n\n    const textPreviewWidth =\n      size.width -\n      foldoutSize.width -\n      foldoutMargin * 2 -\n      deleteSize.width -\n      deleteMargin * 2;\n    this.textPreview.setAttribute(\n      'x',\n      `${\n        foldoutSize.width + foldoutMargin * 2 * (this.workspace.RTL ? -1 : 1)\n      }`,\n    );\n    this.textPreview.setAttribute(\n      'y',\n      `${textPreviewMargin + textPreviewSize.height / 2}`,\n    );\n    this.textPreview.setAttribute('width', `${textPreviewWidth}`);\n  }\n\n  /** Updates the position of the resize handle to reflect the new size. */\n  private updateResizeHandlePosition(size: Size, resizeSize: Size) {\n    this.resizeHandle.setAttribute('y', `${size.height - resizeSize.height}`);\n    this.resizeHandle.setAttribute('x', `${size.width - resizeSize.width}`);\n  }\n\n  /**\n   * Triggers listeners when the size of the comment changes, either\n   * progrmatically or manually by the user.\n   */\n  private onSizeChange(oldSize: Size, newSize: Size) {\n    // Loop through listeners backwards in case they remove themselves.\n    for (let i = this.sizeChangeListeners.length - 1; i >= 0; i--) {\n      this.sizeChangeListeners[i](oldSize, newSize);\n    }\n  }\n\n  /**\n   * Registers a callback that listens for size changes.\n   *\n   * @param listener Receives callbacks when the size of the comment changes.\n   *     The new and old size are in workspace units.\n   */\n  addSizeChangeListener(listener: (oldSize: Size, newSize: Size) => void) {\n    this.sizeChangeListeners.push(listener);\n  }\n\n  /** Removes the given listener from the list of size change listeners. */\n  removeSizeChangeListener(listener: () => void) {\n    this.sizeChangeListeners.splice(\n      this.sizeChangeListeners.indexOf(listener),\n      1,\n    );\n  }\n\n  /**\n   * Handles starting an interaction with the resize handle to resize the\n   * comment.\n   */\n  private onResizePointerDown(e: PointerEvent) {\n    if (!this.isEditable()) return;\n\n    this.bringToFront();\n    if (browserEvents.isRightButton(e)) {\n      e.stopPropagation();\n      return;\n    }\n\n    // TODO(#7926): Move this into a utils file.\n    this.workspace.startDrag(\n      e,\n      new Coordinate(\n        this.workspace.RTL ? -this.getSize().width : this.getSize().width,\n        this.getSize().height,\n      ),\n    );\n\n    this.resizePointerUpListener = browserEvents.conditionalBind(\n      document,\n      'pointerup',\n      this,\n      this.onResizePointerUp,\n    );\n    this.resizePointerMoveListener = browserEvents.conditionalBind(\n      document,\n      'pointermove',\n      this,\n      this.onResizePointerMove,\n    );\n\n    this.workspace.hideChaff();\n\n    e.stopPropagation();\n  }\n\n  /** Ends an interaction with the resize handle. */\n  private onResizePointerUp(_e: PointerEvent) {\n    touch.clearTouchIdentifier();\n    if (this.resizePointerUpListener) {\n      browserEvents.unbind(this.resizePointerUpListener);\n      this.resizePointerUpListener = null;\n    }\n    if (this.resizePointerMoveListener) {\n      browserEvents.unbind(this.resizePointerMoveListener);\n      this.resizePointerMoveListener = null;\n    }\n  }\n\n  /** Resizes the comment in response to a drag on the resize handle. */\n  private onResizePointerMove(e: PointerEvent) {\n    // TODO(#7926): Move this into a utils file.\n    const delta = this.workspace.moveDrag(e);\n    this.setSize(new Size(this.workspace.RTL ? -delta.x : delta.x, delta.y));\n  }\n\n  /** Returns true if the comment is currently collapsed. */\n  isCollapsed(): boolean {\n    return this.collapsed;\n  }\n\n  /** Sets whether the comment is currently collapsed or not. */\n  setCollapsed(collapsed: boolean) {\n    this.collapsed = collapsed;\n    if (collapsed) {\n      dom.addClass(this.svgRoot, 'blocklyCollapsed');\n    } else {\n      dom.removeClass(this.svgRoot, 'blocklyCollapsed');\n    }\n    // Repositions resize handle and such.\n    this.setSize(this.size);\n    this.onCollapse();\n  }\n\n  /**\n   * Triggers listeners when the collapsed-ness of the comment changes, either\n   * progrmatically or manually by the user.\n   */\n  private onCollapse() {\n    // Loop through listeners backwards in case they remove themselves.\n    for (let i = this.collapseChangeListeners.length - 1; i >= 0; i--) {\n      this.collapseChangeListeners[i](this.collapsed);\n    }\n  }\n\n  /** Registers a callback that listens for collapsed-ness changes. */\n  addOnCollapseListener(listener: (newCollapse: boolean) => void) {\n    this.collapseChangeListeners.push(listener);\n  }\n\n  /** Removes the given listener from the list of on collapse listeners. */\n  removeOnCollapseListener(listener: () => void) {\n    this.collapseChangeListeners.splice(\n      this.collapseChangeListeners.indexOf(listener),\n      1,\n    );\n  }\n\n  /**\n   * Toggles the collapsedness of the block when we receive a pointer down\n   * event on the foldout icon.\n   */\n  private onFoldoutDown(e: PointerEvent) {\n    this.bringToFront();\n    if (browserEvents.isRightButton(e)) {\n      e.stopPropagation();\n      return;\n    }\n\n    this.setCollapsed(!this.collapsed);\n\n    this.workspace.hideChaff();\n\n    e.stopPropagation();\n  }\n\n  /** Returns true if the comment is currently editable. */\n  isEditable(): boolean {\n    return this.editable;\n  }\n\n  /** Sets the editability of the comment. */\n  setEditable(editable: boolean) {\n    this.editable = editable;\n    if (this.editable) {\n      dom.addClass(this.svgRoot, 'blocklyEditable');\n      dom.removeClass(this.svgRoot, 'blocklyReadonly');\n      this.textArea.removeAttribute('readonly');\n    } else {\n      dom.removeClass(this.svgRoot, 'blocklyEditable');\n      dom.addClass(this.svgRoot, 'blocklyReadonly');\n      this.textArea.setAttribute('readonly', 'true');\n    }\n  }\n\n  /** Returns the current location of the comment in workspace coordinates. */\n  getRelativeToSurfaceXY(): Coordinate {\n    return this.location;\n  }\n\n  /**\n   * Moves the comment view to the given location.\n   *\n   * @param location The location to move to in workspace coordinates.\n   */\n  moveTo(location: Coordinate) {\n    this.location = location;\n    this.svgRoot.setAttribute(\n      'transform',\n      `translate(${location.x}, ${location.y})`,\n    );\n  }\n\n  /** Retursn the current text of the comment. */\n  getText() {\n    return this.text;\n  }\n\n  /** Sets the current text of the comment. */\n  setText(text: string) {\n    this.textArea.value = text;\n    this.onTextChange();\n  }\n\n  /** Registers a callback that listens for text changes. */\n  addTextChangeListener(listener: (oldText: string, newText: string) => void) {\n    this.textChangeListeners.push(listener);\n  }\n\n  /** Removes the given listener from the list of text change listeners. */\n  removeTextChangeListener(listener: () => void) {\n    this.textChangeListeners.splice(\n      this.textChangeListeners.indexOf(listener),\n      1,\n    );\n  }\n\n  /**\n   * Triggers listeners when the text of the comment changes, either\n   * progrmatically or manually by the user.\n   */\n  private onTextChange() {\n    const oldText = this.text;\n    this.text = this.textArea.value;\n    this.updateTextPreview(this.text);\n    // Update size in case our minimum size increased.\n    this.setSize(this.size);\n    // Loop through listeners backwards in case they remove themselves.\n    for (let i = this.textChangeListeners.length - 1; i >= 0; i--) {\n      this.textChangeListeners[i](oldText, this.text);\n    }\n  }\n\n  /** Updates the preview text element to reflect the given text. */\n  private updateTextPreview(text: string) {\n    this.textPreviewNode.textContent = this.truncateText(text);\n  }\n\n  /** Truncates the text to fit within the top view. */\n  private truncateText(text: string): string {\n    return text.length >= 12 ? `${text.substring(0, 9)}...` : text;\n  }\n\n  /** Brings the workspace comment to the front of its layer. */\n  private bringToFront() {\n    const parent = this.svgRoot.parentNode;\n    const childNodes = parent!.childNodes;\n    // Avoid moving the comment if it's already at the bottom.\n    if (childNodes[childNodes.length - 1] !== this.svgRoot) {\n      parent!.appendChild(this.svgRoot);\n    }\n  }\n\n  /**\n   * Handles disposing of the comment when we get a pointer down event on the\n   * delete icon.\n   */\n  private onDeleteDown(e: PointerEvent) {\n    if (browserEvents.isRightButton(e)) {\n      e.stopPropagation();\n      return;\n    }\n\n    this.dispose();\n    e.stopPropagation();\n  }\n\n  /** Disposes of this comment view. */\n  dispose() {\n    this.disposing = true;\n    dom.removeNode(this.svgRoot);\n    // Loop through listeners backwards in case they remove themselves.\n    for (let i = this.disposeListeners.length - 1; i >= 0; i--) {\n      this.disposeListeners[i]();\n    }\n    this.disposed = true;\n  }\n\n  /** Returns whether this comment view has been disposed or not. */\n  isDisposed(): boolean {\n    return this.disposed;\n  }\n\n  /**\n   * Returns true if this comment view is currently being disposed or has\n   * already been disposed.\n   */\n  isDeadOrDying(): boolean {\n    return this.disposing || this.disposed;\n  }\n\n  /** Registers a callback that listens for disposal of this view. */\n  addDisposeListener(listener: () => void) {\n    this.disposeListeners.push(listener);\n  }\n\n  /** Removes the given listener from the list of disposal listeners. */\n  removeDisposeListener(listener: () => void) {\n    this.disposeListeners.splice(this.disposeListeners.indexOf(listener), 1);\n  }\n}\n\ncss.register(`\n.injectionDiv {\n  --commentFillColour: #FFFCC7;\n  --commentBorderColour: #F2E49B;\n}\n\n.blocklyComment .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 1px solid var(--commentBorderColour);\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n\n.blocklyReadonly.blocklyComment .blocklyTextarea {\n  cursor: inherit;\n}\n\n.blocklyDeleteIcon {\n  width: 20px;\n  height: 20px;\n  display: none;\n  cursor: pointer;\n}\n\n.blocklyFoldoutIcon {\n  width: 20px;\n  height: 20px;\n  transform-origin: 12px 12px;\n  cursor: pointer;\n}\n.blocklyResizeHandle {\n  width: 12px;\n  height: 12px;\n  cursor: se-resize;\n}\n.blocklyReadonly.blocklyComment .blocklyResizeHandle {\n  cursor: inherit;\n}\n\n.blocklyCommentTopbarBackground {\n  cursor: grab;\n  fill: var(--commentBorderColour);\n  height: 24px;\n}\n\n.blocklyComment .blocklyCommentPreview.blocklyText {\n  fill: #000;\n  dominant-baseline: middle;\n  visibility: hidden;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentPreview {\n  visibility: visible;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentForeignObject,\n.blocklyCollapsed.blocklyComment .blocklyResizeHandle {\n  display: none;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyFoldoutIcon {\n  transform: rotate(-90deg);\n}\n\n.blocklyRTL .blocklyCommentTopbar {\n  transform: scale(-1, 1);\n}\n\n.blocklyRTL .blocklyCommentForeignObject {\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyCommentPreview {\n  /* Revert the scale and control RTL using direction instead. */\n  transform: scale(-1, 1);\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyResizeHandle {\n  transform: scale(-1, 1);\n  cursor: sw-resize;\n}\n\n.blocklyCommentHighlight {\n  fill: none;\n}\n\n.blocklySelected .blocklyCommentHighlight {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentHighlight {\n  stroke: none;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentTopbarBackground {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n`);\n","/**\n * @license\n * Copyright 2024 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IDragStrategy} from '../interfaces/i_draggable.js';\nimport {Coordinate} from '../utils.js';\nimport * as eventUtils from '../events/utils.js';\nimport * as layers from '../layers.js';\nimport {RenderedWorkspaceComment} from '../comments.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport {CommentMove} from '../events/events_comment_move.js';\n\nexport class CommentDragStrategy implements IDragStrategy {\n  private startLoc: Coordinate | null = null;\n\n  private workspace: WorkspaceSvg;\n\n  constructor(private comment: RenderedWorkspaceComment) {\n    this.workspace = comment.workspace;\n  }\n\n  isMovable(): boolean {\n    return this.comment.isOwnMovable() && !this.workspace.options.readOnly;\n  }\n\n  startDrag(): void {\n    if (!eventUtils.getGroup()) {\n      eventUtils.setGroup(true);\n    }\n    this.startLoc = this.comment.getRelativeToSurfaceXY();\n    this.workspace.setResizesEnabled(false);\n    this.workspace.getLayerManager()?.moveToDragLayer(this.comment);\n    this.comment.setDragging(true);\n  }\n\n  drag(newLoc: Coordinate): void {\n    this.comment.moveDuringDrag(newLoc);\n  }\n\n  endDrag(): void {\n    this.fireMoveEvent();\n\n    this.workspace\n      .getLayerManager()\n      ?.moveOffDragLayer(this.comment, layers.BLOCK);\n    this.comment.setDragging(false);\n\n    this.comment.snapToGrid();\n\n    this.workspace.setResizesEnabled(true);\n    eventUtils.setGroup(false);\n  }\n\n  private fireMoveEvent() {\n    if (this.comment.isDeadOrDying()) return;\n    const event = new (eventUtils.get(eventUtils.COMMENT_MOVE))(\n      this.comment,\n    ) as CommentMove;\n    event.setReason(['drag']);\n    event.oldCoordinate_ = this.startLoc!;\n    event.recordNew();\n    eventUtils.fire(event);\n  }\n\n  revertDrag(): void {\n    if (this.startLoc) this.comment.moveDuringDrag(this.startLoc);\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.serialization.priorities\n\n/**\n * The priority for deserializing variables.\n */\nexport const VARIABLES = 100;\n\n/**\n * The priority for deserializing variable data.\n */\nexport const PROCEDURES = 75;\n\n/**\n * The priority for deserializing blocks.\n */\nexport const BLOCKS = 50;\n\n/** The priority for deserializing workspace comments. */\nexport const WORKSPACE_COMMENTS = 25;\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.config\n\n/**\n * All the values that we expect developers to be able to change\n * before injecting Blockly.\n */\ninterface Config {\n  dragRadius: number;\n  flyoutDragRadius: number;\n  snapRadius: number;\n  currentConnectionPreference: number;\n  bumpDelay: number;\n  connectingSnapRadius: number;\n}\n\n/** Default snap radius. */\nconst DEFAULT_SNAP_RADIUS = 28;\n\n/**\n * Object holding all the values on Blockly that we expect developers to be\n * able to change.\n */\nexport const config: Config = {\n  /**\n   * Number of pixels the mouse must move before a drag starts.\n   *\n   */\n  dragRadius: 5,\n  /**\n   * Number of pixels the mouse must move before a drag/scroll starts from the\n   * flyout.  Because the drag-intention is determined when this is reached, it\n   * is larger than dragRadius so that the drag-direction is clearer.\n   *\n   */\n  flyoutDragRadius: 10,\n  /**\n   * Maximum misalignment between connections for them to snap together.\n   *\n   */\n  snapRadius: DEFAULT_SNAP_RADIUS,\n  /**\n   * Maximum misalignment between connections for them to snap together.\n   * This should be the same as the snap radius.\n   */\n  connectingSnapRadius: DEFAULT_SNAP_RADIUS,\n  /**\n   * How much to prefer staying connected to the current connection over moving\n   * to a new connection.  The current previewed connection is considered to be\n   * this much closer to the matching connection on the block than it actually\n   * is.\n   *\n   */\n  currentConnectionPreference: 8,\n  /**\n   * Delay in ms between trigger and bumping unconnected block out of alignment.\n   *\n   */\n  bumpDelay: 250,\n};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Blockly menu similar to Closure's goog.ui.Menu\n *\n * @class\n */\n// Former goog.module ID: Blockly.Menu\n\nimport * as browserEvents from './browser_events.js';\nimport type {MenuItem} from './menuitem.js';\nimport * as aria from './utils/aria.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport type {Size} from './utils/size.js';\nimport * as style from './utils/style.js';\n\n/**\n * A basic menu class.\n */\nexport class Menu {\n  /**\n   * Array of menu items.\n   * (Nulls are never in the array, but typing the array as nullable prevents\n   * the compiler from objecting to .indexOf(null))\n   */\n  private readonly menuItems: MenuItem[] = [];\n\n  /**\n   * Coordinates of the mousedown event that caused this menu to open. Used to\n   * prevent the consequent mouseup event due to a simple click from\n   * activating a menu item immediately.\n   */\n  openingCoords: Coordinate | null = null;\n\n  /**\n   * This is the element that we will listen to the real focus events on.\n   * A value of null means no menu item is highlighted.\n   */\n  private highlightedItem: MenuItem | null = null;\n\n  /** Mouse over event data. */\n  private mouseOverHandler: browserEvents.Data | null = null;\n\n  /** Click event data. */\n  private clickHandler: browserEvents.Data | null = null;\n\n  /** Mouse enter event data. */\n  private mouseEnterHandler: browserEvents.Data | null = null;\n\n  /** Mouse leave event data. */\n  private mouseLeaveHandler: browserEvents.Data | null = null;\n\n  /** Key down event data. */\n  private onKeyDownHandler: browserEvents.Data | null = null;\n\n  /** The menu's root DOM element. */\n  private element: HTMLDivElement | null = null;\n\n  /** ARIA name for this menu. */\n  private roleName: aria.Role | null = null;\n\n  /** Constructs a new Menu instance. */\n  constructor() {}\n\n  /**\n   * Add a new menu item to the bottom of this menu.\n   *\n   * @param menuItem Menu item to append.\n   * @internal\n   */\n  addChild(menuItem: MenuItem) {\n    this.menuItems.push(menuItem);\n  }\n\n  /**\n   * Creates the menu DOM.\n   *\n   * @param container Element upon which to append this menu.\n   * @returns The menu's root DOM element.\n   */\n  render(container: Element): HTMLDivElement {\n    const element = document.createElement('div');\n    // goog-menu is deprecated, use blocklyMenu.  May 2020.\n    element.className = 'blocklyMenu goog-menu blocklyNonSelectable';\n    element.tabIndex = 0;\n    if (this.roleName) {\n      aria.setRole(element, this.roleName);\n    }\n    this.element = element;\n\n    // Add menu items.\n    for (let i = 0, menuItem; (menuItem = this.menuItems[i]); i++) {\n      element.appendChild(menuItem.createDom());\n    }\n\n    // Add event handlers.\n    this.mouseOverHandler = browserEvents.conditionalBind(\n      element,\n      'pointerover',\n      this,\n      this.handleMouseOver,\n      true,\n    );\n    this.clickHandler = browserEvents.conditionalBind(\n      element,\n      'pointerup',\n      this,\n      this.handleClick,\n      true,\n    );\n    this.mouseEnterHandler = browserEvents.conditionalBind(\n      element,\n      'pointerenter',\n      this,\n      this.handleMouseEnter,\n      true,\n    );\n    this.mouseLeaveHandler = browserEvents.conditionalBind(\n      element,\n      'pointerleave',\n      this,\n      this.handleMouseLeave,\n      true,\n    );\n    this.onKeyDownHandler = browserEvents.conditionalBind(\n      element,\n      'keydown',\n      this,\n      this.handleKeyEvent,\n    );\n\n    container.appendChild(element);\n    return element;\n  }\n\n  /**\n   * Gets the menu's element.\n   *\n   * @returns The DOM element.\n   * @internal\n   */\n  getElement(): HTMLDivElement | null {\n    return this.element;\n  }\n\n  /**\n   * Focus the menu element.\n   *\n   * @internal\n   */\n  focus() {\n    const el = this.getElement();\n    if (el) {\n      el.focus({preventScroll: true});\n      dom.addClass(el, 'blocklyFocused');\n    }\n  }\n\n  /** Blur the menu element. */\n  private blur() {\n    const el = this.getElement();\n    if (el) {\n      el.blur();\n      dom.removeClass(el, 'blocklyFocused');\n    }\n  }\n\n  /**\n   * Set the menu accessibility role.\n   *\n   * @param roleName role name.\n   * @internal\n   */\n  setRole(roleName: aria.Role) {\n    this.roleName = roleName;\n  }\n\n  /** Dispose of this menu. */\n  dispose() {\n    // Remove event handlers.\n    if (this.mouseOverHandler) {\n      browserEvents.unbind(this.mouseOverHandler);\n      this.mouseOverHandler = null;\n    }\n    if (this.clickHandler) {\n      browserEvents.unbind(this.clickHandler);\n      this.clickHandler = null;\n    }\n    if (this.mouseEnterHandler) {\n      browserEvents.unbind(this.mouseEnterHandler);\n      this.mouseEnterHandler = null;\n    }\n    if (this.mouseLeaveHandler) {\n      browserEvents.unbind(this.mouseLeaveHandler);\n      this.mouseLeaveHandler = null;\n    }\n    if (this.onKeyDownHandler) {\n      browserEvents.unbind(this.onKeyDownHandler);\n      this.onKeyDownHandler = null;\n    }\n\n    // Remove menu items.\n    for (let i = 0, menuItem; (menuItem = this.menuItems[i]); i++) {\n      menuItem.dispose();\n    }\n    this.element = null;\n  }\n\n  // Child component management.\n\n  /**\n   * Returns the child menu item that owns the given DOM element,\n   * or null if no such menu item is found.\n   *\n   * @param elem DOM element whose owner is to be returned.\n   * @returns Menu item for which the DOM element belongs to.\n   */\n  private getMenuItem(elem: Element): MenuItem | null {\n    const menuElem = this.getElement();\n    // Node might be the menu border (resulting in no associated menu item), or\n    // a menu item's div, or some element within the menu item.\n    // Walk up parents until one meets either the menu's root element, or\n    // a menu item's div.\n    let currentElement: Element | null = elem;\n    while (currentElement && currentElement !== menuElem) {\n      if (currentElement.classList.contains('blocklyMenuItem')) {\n        // Having found a menu item's div, locate that menu item in this menu.\n        for (let i = 0, menuItem; (menuItem = this.menuItems[i]); i++) {\n          if (menuItem.getElement() === currentElement) {\n            return menuItem;\n          }\n        }\n      }\n      currentElement = currentElement.parentElement;\n    }\n    return null;\n  }\n\n  // Highlight management.\n\n  /**\n   * Highlights the given menu item, or clears highlighting if null.\n   *\n   * @param item Item to highlight, or null.\n   * @internal\n   */\n  setHighlighted(item: MenuItem | null) {\n    const currentHighlighted = this.highlightedItem;\n    if (currentHighlighted) {\n      currentHighlighted.setHighlighted(false);\n      this.highlightedItem = null;\n    }\n    if (item) {\n      item.setHighlighted(true);\n      this.highlightedItem = item;\n      // Bring the highlighted item into view. This has no effect if the menu is\n      // not scrollable.\n      const el = this.getElement() as Element;\n      style.scrollIntoContainerView(item.getElement() as Element, el);\n\n      aria.setState(el, aria.State.ACTIVEDESCENDANT, item.getId());\n    }\n  }\n\n  /**\n   * Highlights the next highlightable item (or the first if nothing is\n   * currently highlighted).\n   *\n   * @internal\n   */\n  highlightNext() {\n    const index = this.highlightedItem\n      ? this.menuItems.indexOf(this.highlightedItem)\n      : -1;\n    this.highlightHelper(index, 1);\n  }\n\n  /**\n   * Highlights the previous highlightable item (or the last if nothing is\n   * currently highlighted).\n   *\n   * @internal\n   */\n  highlightPrevious() {\n    const index = this.highlightedItem\n      ? this.menuItems.indexOf(this.highlightedItem)\n      : -1;\n    this.highlightHelper(index < 0 ? this.menuItems.length : index, -1);\n  }\n\n  /** Highlights the first highlightable item. */\n  private highlightFirst() {\n    this.highlightHelper(-1, 1);\n  }\n\n  /** Highlights the last highlightable item. */\n  private highlightLast() {\n    this.highlightHelper(this.menuItems.length, -1);\n  }\n\n  /**\n   * Helper function that manages the details of moving the highlight among\n   * child menuitems in response to keyboard events.\n   *\n   * @param startIndex Start index.\n   * @param delta Step direction: 1 to go down, -1 to go up.\n   */\n  private highlightHelper(startIndex: number, delta: number) {\n    let index = startIndex + delta;\n    let menuItem;\n    while ((menuItem = this.menuItems[index])) {\n      if (menuItem.isEnabled()) {\n        this.setHighlighted(menuItem);\n        break;\n      }\n      index += delta;\n    }\n  }\n\n  // Mouse events.\n\n  /**\n   * Handles mouseover events. Highlight menuitems as the user hovers over them.\n   *\n   * @param e Mouse event to handle.\n   */\n  private handleMouseOver(e: PointerEvent) {\n    const menuItem = this.getMenuItem(e.target as Element);\n\n    if (menuItem) {\n      if (menuItem.isEnabled()) {\n        if (this.highlightedItem !== menuItem) {\n          this.setHighlighted(menuItem);\n        }\n      } else {\n        this.setHighlighted(null);\n      }\n    }\n  }\n\n  /**\n   * Handles click events. Pass the event onto the child menuitem to handle.\n   *\n   * @param e Click event to handle.\n   */\n  private handleClick(e: PointerEvent) {\n    const oldCoords = this.openingCoords;\n    // Clear out the saved opening coords immediately so they're not used twice.\n    this.openingCoords = null;\n    if (oldCoords && typeof e.clientX === 'number') {\n      const newCoords = new Coordinate(e.clientX, e.clientY);\n      if (Coordinate.distance(oldCoords, newCoords) < 1) {\n        // This menu was opened by a mousedown and we're handling the consequent\n        // click event. The coords haven't changed, meaning this was the same\n        // opening event. Don't do the usual behavior because the menu just\n        // popped up under the mouse and the user didn't mean to activate this\n        // item.\n        return;\n      }\n    }\n\n    const menuItem = this.getMenuItem(e.target as Element);\n    if (menuItem) {\n      menuItem.performAction();\n    }\n  }\n\n  /**\n   * Handles mouse enter events. Focus the element.\n   *\n   * @param _e Mouse event to handle.\n   */\n  private handleMouseEnter(_e: PointerEvent) {\n    this.focus();\n  }\n\n  /**\n   * Handles mouse leave events. Blur and clear highlight.\n   *\n   * @param _e Mouse event to handle.\n   */\n  private handleMouseLeave(_e: PointerEvent) {\n    if (this.getElement()) {\n      this.blur();\n      this.setHighlighted(null);\n    }\n  }\n\n  // Keyboard events.\n\n  /**\n   * Attempts to handle a keyboard event, if the menu item is enabled, by\n   * calling\n   * {@link Menu#handleKeyEventInternal_}.\n   *\n   * @param e Key event to handle.\n   */\n  private handleKeyEvent(e: Event) {\n    if (!this.menuItems.length) {\n      // Empty menu.\n      return;\n    }\n    const keyboardEvent = e as KeyboardEvent;\n    if (\n      keyboardEvent.shiftKey ||\n      keyboardEvent.ctrlKey ||\n      keyboardEvent.metaKey ||\n      keyboardEvent.altKey\n    ) {\n      // Do not handle the key event if any modifier key is pressed.\n      return;\n    }\n\n    const highlighted = this.highlightedItem;\n    switch (keyboardEvent.key) {\n      case 'Enter':\n      case ' ':\n        if (highlighted) {\n          highlighted.performAction();\n        }\n        break;\n\n      case 'ArrowUp':\n        this.highlightPrevious();\n        break;\n\n      case 'ArrowDown':\n        this.highlightNext();\n        break;\n\n      case 'PageUp':\n      case 'Home':\n        this.highlightFirst();\n        break;\n\n      case 'PageDown':\n      case 'End':\n        this.highlightLast();\n        break;\n\n      default:\n        // Not a key the menu is interested in.\n        return;\n    }\n    // The menu used this key, don't let it have secondary effects.\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  /**\n   * Get the size of a rendered menu.\n   *\n   * @returns Object with width and height properties.\n   * @internal\n   */\n  getSize(): Size {\n    const menuDom = this.getElement() as HTMLDivElement;\n    const menuSize = style.getSize(menuDom);\n    // Recalculate height for the total content, not only box height.\n    menuSize.height = menuDom.scrollHeight;\n    return menuSize;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Blockly menu item similar to Closure's goog.ui.MenuItem\n *\n * @class\n */\n// Former goog.module ID: Blockly.MenuItem\n\nimport * as aria from './utils/aria.js';\nimport * as dom from './utils/dom.js';\nimport * as idGenerator from './utils/idgenerator.js';\n\n/**\n * Class representing an item in a menu.\n */\nexport class MenuItem {\n  /** Is the menu item clickable, as opposed to greyed-out. */\n  private enabled = true;\n\n  /** The DOM element for the menu item. */\n  private element: HTMLDivElement | null = null;\n\n  /** Whether the menu item is rendered right-to-left. */\n  private rightToLeft = false;\n\n  /** ARIA name for this menu. */\n  private roleName: aria.Role | null = null;\n\n  /** Is this menu item checkable. */\n  private checkable = false;\n\n  /** Is this menu item currently checked. */\n  private checked = false;\n\n  /** Is this menu item currently highlighted. */\n  private highlight = false;\n\n  /** Bound function to call when this menu item is clicked. */\n  private actionHandler: Function | null = null;\n\n  /**\n   * @param content Text caption to display as the content of the item, or a\n   *     HTML element to display.\n   * @param opt_value Data/model associated with the menu item.\n   */\n  constructor(\n    private readonly content: string | HTMLElement,\n    private readonly opt_value?: string,\n  ) {}\n\n  /**\n   * Creates the menuitem's DOM.\n   *\n   * @returns Completed DOM.\n   */\n  createDom(): Element {\n    const element = document.createElement('div');\n    element.id = idGenerator.getNextUniqueId();\n    this.element = element;\n\n    // Set class and style\n    // goog-menuitem* is deprecated, use blocklyMenuItem*.  May 2020.\n    element.className =\n      'blocklyMenuItem goog-menuitem ' +\n      (this.enabled ? '' : 'blocklyMenuItemDisabled goog-menuitem-disabled ') +\n      (this.checked ? 'blocklyMenuItemSelected goog-option-selected ' : '') +\n      (this.highlight\n        ? 'blocklyMenuItemHighlight goog-menuitem-highlight '\n        : '') +\n      (this.rightToLeft ? 'blocklyMenuItemRtl goog-menuitem-rtl ' : '');\n\n    const content = document.createElement('div');\n    content.className = 'blocklyMenuItemContent goog-menuitem-content';\n    // Add a checkbox for checkable menu items.\n    if (this.checkable) {\n      const checkbox = document.createElement('div');\n      checkbox.className = 'blocklyMenuItemCheckbox goog-menuitem-checkbox';\n      content.appendChild(checkbox);\n    }\n\n    let contentDom: Node = this.content as HTMLElement;\n    if (typeof this.content === 'string') {\n      contentDom = document.createTextNode(this.content);\n    }\n    content.appendChild(contentDom);\n    element.appendChild(content);\n\n    // Initialize ARIA role and state.\n    if (this.roleName) {\n      aria.setRole(element, this.roleName);\n    }\n    aria.setState(\n      element,\n      aria.State.SELECTED,\n      (this.checkable && this.checked) || false,\n    );\n    aria.setState(element, aria.State.DISABLED, !this.enabled);\n\n    return element;\n  }\n\n  /** Dispose of this menu item. */\n  dispose() {\n    this.element = null;\n  }\n\n  /**\n   * Gets the menu item's element.\n   *\n   * @returns The DOM element.\n   * @internal\n   */\n  getElement(): Element | null {\n    return this.element;\n  }\n\n  /**\n   * Gets the unique ID for this menu item.\n   *\n   * @returns Unique component ID.\n   * @internal\n   */\n  getId(): string {\n    return this.element!.id;\n  }\n\n  /**\n   * Gets the value associated with the menu item.\n   *\n   * @returns value Value associated with the menu item.\n   * @internal\n   */\n  getValue(): string | null {\n    return this.opt_value ?? null;\n  }\n\n  /**\n   * Set menu item's rendering direction.\n   *\n   * @param rtl True if RTL, false if LTR.\n   * @internal\n   */\n  setRightToLeft(rtl: boolean) {\n    this.rightToLeft = rtl;\n  }\n\n  /**\n   * Set the menu item's accessibility role.\n   *\n   * @param roleName Role name.\n   * @internal\n   */\n  setRole(roleName: aria.Role) {\n    this.roleName = roleName;\n  }\n\n  /**\n   * Sets the menu item to be checkable or not. Set to true for menu items\n   * that represent checkable options.\n   *\n   * @param checkable Whether the menu item is checkable.\n   * @internal\n   */\n  setCheckable(checkable: boolean) {\n    this.checkable = checkable;\n  }\n\n  /**\n   * Checks or unchecks the component.\n   *\n   * @param checked Whether to check or uncheck the component.\n   * @internal\n   */\n  setChecked(checked: boolean) {\n    this.checked = checked;\n  }\n\n  /**\n   * Highlights or unhighlights the component.\n   *\n   * @param highlight Whether to highlight or unhighlight the component.\n   * @internal\n   */\n  setHighlighted(highlight: boolean) {\n    this.highlight = highlight;\n\n    const el = this.getElement();\n    if (el && this.isEnabled()) {\n      // goog-menuitem-highlight is deprecated, use blocklyMenuItemHighlight.\n      // May 2020.\n      const name = 'blocklyMenuItemHighlight';\n      const nameDep = 'goog-menuitem-highlight';\n      if (highlight) {\n        dom.addClass(el, name);\n        dom.addClass(el, nameDep);\n      } else {\n        dom.removeClass(el, name);\n        dom.removeClass(el, nameDep);\n      }\n    }\n  }\n\n  /**\n   * Returns true if the menu item is enabled, false otherwise.\n   *\n   * @returns Whether the menu item is enabled.\n   * @internal\n   */\n  isEnabled(): boolean {\n    return this.enabled;\n  }\n\n  /**\n   * Enables or disables the menu item.\n   *\n   * @param enabled Whether to enable or disable the menu item.\n   * @internal\n   */\n  setEnabled(enabled: boolean) {\n    this.enabled = enabled;\n  }\n\n  /**\n   * Performs the appropriate action when the menu item is activated\n   * by the user.\n   *\n   * @internal\n   */\n  performAction() {\n    if (this.isEnabled() && this.actionHandler) {\n      this.actionHandler(this);\n    }\n  }\n\n  /**\n   * Set the handler that's called when the menu item is activated by the user.\n   * `obj` will be used as the 'this' object in the function when called.\n   *\n   * @param fn The handler.\n   * @param obj Used as the 'this' object in fn when called.\n   * @internal\n   */\n  onAction(fn: (p1: MenuItem) => void, obj: object) {\n    this.actionHandler = fn.bind(obj);\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.serialization.exceptions\n\nimport type {Block} from '../block.js';\nimport type {State} from './blocks.js';\n\nexport class DeserializationError extends Error {}\n\n/**\n * Represents an error where the serialized state is expected to provide a\n * block type, but it is not provided.\n *\n */\nexport class MissingBlockType extends DeserializationError {\n  /**\n   * @param state The state object which is missing the block type.\n   * @internal\n   */\n  constructor(public state: State) {\n    super(`Expected to find a 'type' property, defining the block type`);\n  }\n}\n\n/**\n * Represents an error where deserialization encountered a block that did\n * not have a connection that was defined in the serialized state.\n */\nexport class MissingConnection extends DeserializationError {\n  /**\n   * @param connection The name of the connection that is missing. E.g.\n   *     'IF0', or 'next'.\n   * @param block The block missing the connection.\n   * @param state The state object containing the bad connection.\n   * @internal\n   */\n  constructor(\n    connection: string,\n    public block: Block,\n    public state: State,\n  ) {\n    super(`The block ${block.toDevString()} is missing a(n) ${connection}\nconnection`);\n  }\n}\n\n/**\n * Represents an error where deserialization tried to connect two connections\n * that were not compatible.\n */\nexport class BadConnectionCheck extends DeserializationError {\n  /**\n   * @param reason The reason the connections were not compatible.\n   * @param childConnection The name of the incompatible child connection. E.g.\n   *     'output' or 'previous'.\n   * @param childBlock The child block that could not connect to its parent.\n   * @param childState The state object representing the child block.\n   * @internal\n   */\n  constructor(\n    reason: string,\n    childConnection: string,\n    public childBlock: Block,\n    public childState: State,\n  ) {\n    super(`The block ${childBlock.toDevString()} could not connect its\n${childConnection} to its parent, because: ${reason}`);\n  }\n}\n\n/**\n * Represents an error where deserialization encountered a real block as it\n * was deserializing children of a shadow.\n * This is an error because it is an invariant of Blockly that shadow blocks\n * do not have real children.\n */\nexport class RealChildOfShadow extends DeserializationError {\n  /**\n   * @param state The state object representing the real block.\n   * @internal\n   */\n  constructor(public state: State) {\n    super(`Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren`);\n  }\n}\n\nexport class UnregisteredIcon extends DeserializationError {\n  /**\n   * @param iconType The type of the unregistered icon we are attempting to\n   *     deserialize.\n   * @param block The block we are attempting to add the unregistered icon to.\n   * @param state The state object representing the block.\n   */\n  constructor(\n    iconType: string,\n    public block: Block,\n    public state: State,\n  ) {\n    super(\n      `Cannot add an icon of type '${iconType}' to the block ` +\n        `${block.toDevString()}, because there is no icon registered with ` +\n        `type '${iconType}'. Make sure that all of your icons have been ` +\n        `registered.`,\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Base class for all types of block events.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BlockBase\n\nimport type {Block} from '../block.js';\nimport type {Workspace} from '../workspace.js';\n\nimport {\n  Abstract as AbstractEvent,\n  AbstractEventJson,\n} from './events_abstract.js';\n\n/**\n * Abstract class for any event related to blocks.\n */\nexport class BlockBase extends AbstractEvent {\n  override isBlank = true;\n\n  /** The ID of the block associated with this event. */\n  blockId?: string;\n\n  /**\n   * @param opt_block The block this event corresponds to.\n   *     Undefined for a blank event.\n   */\n  constructor(opt_block?: Block) {\n    super();\n    this.isBlank = !opt_block;\n\n    if (!opt_block) return;\n\n    this.blockId = opt_block.id;\n    this.workspaceId = opt_block.workspace.id;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockBaseJson {\n    const json = super.toJson() as BlockBaseJson;\n    if (!this.blockId) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['blockId'] = this.blockId;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockBase, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockBaseJson,\n    workspace: Workspace,\n    event?: any,\n  ): BlockBase {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockBase(),\n    ) as BlockBase;\n    newEvent.blockId = json['blockId'];\n    return newEvent;\n  }\n}\n\nexport interface BlockBaseJson extends AbstractEventJson {\n  blockId: string;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block change event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BlockChange\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport {IconType} from '../icons/icon_types.js';\nimport {hasBubble} from '../interfaces/i_has_bubble.js';\nimport {MANUALLY_DISABLED} from '../constants.js';\nimport * as registry from '../registry.js';\nimport * as utilsXml from '../utils/xml.js';\nimport {Workspace} from '../workspace.js';\nimport * as Xml from '../xml.js';\n\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\n\n/**\n * Notifies listeners when some element of a block has changed (e.g.\n * field values, comments, etc).\n */\nexport class BlockChange extends BlockBase {\n  override type = eventUtils.BLOCK_CHANGE;\n  /**\n   * The element that changed; one of 'field', 'comment', 'collapsed',\n   * 'disabled', 'inline', or 'mutation'\n   */\n  element?: string;\n\n  /** The name of the field that changed, if this is a change to a field. */\n  name?: string;\n\n  /** The original value of the element. */\n  oldValue: unknown;\n\n  /** The new value of the element. */\n  newValue: unknown;\n\n  /**\n   * If element is 'disabled', this is the language-neutral identifier of the\n   * reason why the block was or was not disabled.\n   */\n  private disabledReason?: string;\n\n  /**\n   * @param opt_block The changed block.  Undefined for a blank event.\n   * @param opt_element One of 'field', 'comment', 'disabled', etc.\n   * @param opt_name Name of input or field affected, or null.\n   * @param opt_oldValue Previous value of element.\n   * @param opt_newValue New value of element.\n   */\n  constructor(\n    opt_block?: Block,\n    opt_element?: string,\n    opt_name?: string | null,\n    opt_oldValue?: unknown,\n    opt_newValue?: unknown,\n  ) {\n    super(opt_block);\n\n    if (!opt_block) {\n      return; // Blank event to be populated by fromJson.\n    }\n    this.element = opt_element;\n    this.name = opt_name || undefined;\n    this.oldValue = opt_oldValue;\n    this.newValue = opt_newValue;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockChangeJson {\n    const json = super.toJson() as BlockChangeJson;\n    if (!this.element) {\n      throw new Error(\n        'The changed element is undefined. Either pass an ' +\n          'element to the constructor, or call fromJson',\n      );\n    }\n    json['element'] = this.element;\n    json['name'] = this.name;\n    json['oldValue'] = this.oldValue;\n    json['newValue'] = this.newValue;\n    if (this.disabledReason) {\n      json['disabledReason'] = this.disabledReason;\n    }\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockChange, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockChangeJson,\n    workspace: Workspace,\n    event?: any,\n  ): BlockChange {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockChange(),\n    ) as BlockChange;\n    newEvent.element = json['element'];\n    newEvent.name = json['name'];\n    newEvent.oldValue = json['oldValue'];\n    newEvent.newValue = json['newValue'];\n    if (json['disabledReason'] !== undefined) {\n      newEvent.disabledReason = json['disabledReason'];\n    }\n    return newEvent;\n  }\n\n  /**\n   * Set the language-neutral identifier for the reason why the block was or was\n   * not disabled. This is only valid for events where element is 'disabled'.\n   * Defaults to 'MANUALLY_DISABLED'.\n   *\n   * @param disabledReason The identifier of the reason why the block was or was\n   *     not disabled.\n   */\n  setDisabledReason(disabledReason: string) {\n    if (this.element !== 'disabled') {\n      throw new Error(\n        'Cannot set the disabled reason for a BlockChange event if the ' +\n          'element is not \"disabled\".',\n      );\n    }\n    this.disabledReason = disabledReason;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return this.oldValue === this.newValue;\n  }\n\n  /**\n   * Run a change event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.blockId) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    const block = workspace.getBlockById(this.blockId);\n    if (!block) {\n      throw new Error(\n        'The associated block is undefined. Either pass a ' +\n          'block to the constructor, or call fromJson',\n      );\n    }\n    // Assume the block is rendered so that then we can check.\n    const icon = block.getIcon(IconType.MUTATOR);\n    if (icon && hasBubble(icon) && icon.bubbleIsVisible()) {\n      // Close the mutator (if open) since we don't want to update it.\n      icon.setBubbleVisible(false);\n    }\n    const value = forward ? this.newValue : this.oldValue;\n    switch (this.element) {\n      case 'field': {\n        const field = block.getField(this.name!);\n        if (field) {\n          field.setValue(value);\n        } else {\n          console.warn(\"Can't set non-existent field: \" + this.name);\n        }\n        break;\n      }\n      case 'comment':\n        block.setCommentText((value as string) || null);\n        break;\n      case 'collapsed':\n        block.setCollapsed(!!value);\n        break;\n      case 'disabled':\n        block.setDisabledReason(\n          !!value,\n          this.disabledReason ?? MANUALLY_DISABLED,\n        );\n        break;\n      case 'inline':\n        block.setInputsInline(!!value);\n        break;\n      case 'mutation': {\n        const oldState = BlockChange.getExtraBlockState_(block as BlockSvg);\n        if (block.loadExtraState) {\n          block.loadExtraState(JSON.parse((value as string) || '{}'));\n        } else if (block.domToMutation) {\n          block.domToMutation(\n            utilsXml.textToDom((value as string) || '<mutation/>'),\n          );\n        }\n        eventUtils.fire(\n          new BlockChange(block, 'mutation', null, oldState, value),\n        );\n        break;\n      }\n      default:\n        console.warn('Unknown change type: ' + this.element);\n    }\n  }\n\n  // TODO (#5397): Encapsulate this in the BlocklyMutationChange event when\n  //    refactoring change events.\n  /**\n   * Returns the extra state of the given block (either as XML or a JSO,\n   * depending on the block's definition).\n   *\n   * @param block The block to get the extra state of.\n   * @returns A stringified version of the extra state of the given block.\n   * @internal\n   */\n  static getExtraBlockState_(block: BlockSvg): string {\n    if (block.saveExtraState) {\n      const state = block.saveExtraState(true);\n      return state ? JSON.stringify(state) : '';\n    } else if (block.mutationToDom) {\n      const state = block.mutationToDom();\n      return state ? Xml.domToText(state) : '';\n    }\n    return '';\n  }\n}\n\nexport interface BlockChangeJson extends BlockBaseJson {\n  element: string;\n  name?: string;\n  newValue: unknown;\n  oldValue: unknown;\n  disabledReason?: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.CHANGE, BlockChange);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object in charge of managing markers and the cursor.\n *\n * @class\n */\n// Former goog.module ID: Blockly.MarkerManager\n\nimport type {Cursor} from './keyboard_nav/cursor.js';\nimport type {Marker} from './keyboard_nav/marker.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class to manage the multiple markers and the cursor on a workspace.\n */\nexport class MarkerManager {\n  /** The name of the local marker. */\n  static readonly LOCAL_MARKER = 'local_marker_1';\n\n  /** The cursor. */\n  private cursor_: Cursor | null = null;\n\n  /** The cursor's SVG element. */\n  private cursorSvg_: SVGElement | null = null;\n\n  /** The map of markers for the workspace. */\n  private markers = new Map<string, Marker>();\n\n  /** The marker's SVG element. */\n  private markerSvg_: SVGElement | null = null;\n\n  /**\n   * @param workspace The workspace for the marker manager.\n   * @internal\n   */\n  constructor(private readonly workspace: WorkspaceSvg) {}\n\n  /**\n   * Register the marker by adding it to the map of markers.\n   *\n   * @param id A unique identifier for the marker.\n   * @param marker The marker to register.\n   */\n  registerMarker(id: string, marker: Marker) {\n    if (this.markers.has(id)) {\n      this.unregisterMarker(id);\n    }\n    marker.setDrawer(\n      this.workspace.getRenderer().makeMarkerDrawer(this.workspace, marker),\n    );\n    this.setMarkerSvg(marker.getDrawer().createDom());\n    this.markers.set(id, marker);\n  }\n\n  /**\n   * Unregister the marker by removing it from the map of markers.\n   *\n   * @param id The ID of the marker to unregister.\n   */\n  unregisterMarker(id: string) {\n    const marker = this.markers.get(id);\n    if (marker) {\n      marker.dispose();\n      this.markers.delete(id);\n    } else {\n      throw Error(\n        'Marker with ID ' +\n          id +\n          ' does not exist. ' +\n          'Can only unregister markers that exist.',\n      );\n    }\n  }\n\n  /**\n   * Get the cursor for the workspace.\n   *\n   * @returns The cursor for this workspace.\n   */\n  getCursor(): Cursor | null {\n    return this.cursor_;\n  }\n\n  /**\n   * Get a single marker that corresponds to the given ID.\n   *\n   * @param id A unique identifier for the marker.\n   * @returns The marker that corresponds to the given ID, or null if none\n   *     exists.\n   */\n  getMarker(id: string): Marker | null {\n    return this.markers.get(id) || null;\n  }\n\n  /**\n   * Sets the cursor and initializes the drawer for use with keyboard\n   * navigation.\n   *\n   * @param cursor The cursor used to move around this workspace.\n   */\n  setCursor(cursor: Cursor) {\n    if (this.cursor_ && this.cursor_.getDrawer()) {\n      this.cursor_.getDrawer().dispose();\n    }\n    this.cursor_ = cursor;\n    if (this.cursor_) {\n      const drawer = this.workspace\n        .getRenderer()\n        .makeMarkerDrawer(this.workspace, this.cursor_);\n      this.cursor_.setDrawer(drawer);\n      this.setCursorSvg(this.cursor_.getDrawer().createDom());\n    }\n  }\n\n  /**\n   * Add the cursor SVG to this workspace SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement | null) {\n    if (!cursorSvg) {\n      this.cursorSvg_ = null;\n      return;\n    }\n\n    this.workspace.getBlockCanvas()!.appendChild(cursorSvg);\n    this.cursorSvg_ = cursorSvg;\n  }\n\n  /**\n   * Add the marker SVG to this workspaces SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement | null) {\n    if (!markerSvg) {\n      this.markerSvg_ = null;\n      return;\n    }\n\n    if (this.workspace.getBlockCanvas()) {\n      if (this.cursorSvg_) {\n        this.workspace\n          .getBlockCanvas()!\n          .insertBefore(markerSvg, this.cursorSvg_);\n      } else {\n        this.workspace.getBlockCanvas()!.appendChild(markerSvg);\n      }\n    }\n  }\n\n  /**\n   * Redraw the attached cursor SVG if needed.\n   *\n   * @internal\n   */\n  updateMarkers() {\n    if (this.workspace.keyboardAccessibilityMode && this.cursorSvg_) {\n      this.workspace.getCursor()!.draw();\n    }\n  }\n\n  /**\n   * Dispose of the marker manager.\n   * Go through and delete all markers associated with this marker manager.\n   *\n   * @internal\n   */\n  dispose() {\n    const markerIds = Object.keys(this.markers);\n    for (let i = 0, markerId; (markerId = markerIds[i]); i++) {\n      this.unregisterMarker(markerId);\n    }\n    this.markers.clear();\n    if (this.cursor_) {\n      this.cursor_.dispose();\n      this.cursor_ = null;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Field.  Used for editable titles, variables, etc.\n * This is an abstract class that defines the UI on the block.  Actual\n * instances would be FieldTextInput, FieldDropdown, etc.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Field\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Input} from './inputs/input.js';\nimport type {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport type {IASTNodeLocationWithBlock} from './interfaces/i_ast_node_location_with_block.js';\nimport type {IKeyboardAccessible} from './interfaces/i_keyboard_accessible.js';\nimport type {IRegistrable} from './interfaces/i_registrable.js';\nimport {MarkerManager} from './marker_manager.js';\nimport type {ConstantProvider} from './renderers/common/constants.js';\nimport type {KeyboardShortcut} from './shortcut_registry.js';\nimport * as Tooltip from './tooltip.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport * as style from './utils/style.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as utilsXml from './utils/xml.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport {ISerializable} from './interfaces/i_serializable.js';\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldValidator<T = any> = (newValue: T) => T | null | undefined;\n\n/**\n * Abstract class for an editable field.\n *\n * @typeParam T - The value stored on the field.\n */\nexport abstract class Field<T = any>\n  implements\n    IASTNodeLocationSvg,\n    IASTNodeLocationWithBlock,\n    IKeyboardAccessible,\n    IRegistrable,\n    ISerializable\n{\n  /**\n   * To overwrite the default value which is set in **Field**, directly update\n   * the prototype.\n   *\n   * Example:\n   * `FieldImage.prototype.DEFAULT_VALUE = null;`\n   */\n  DEFAULT_VALUE: T | null = null;\n\n  /** Non-breaking space. */\n  static readonly NBSP = '\\u00A0';\n\n  /**\n   * A value used to signal when a field's constructor should *not* set the\n   * field's value or run configure_, and should allow a subclass to do that\n   * instead.\n   */\n  static readonly SKIP_SETUP = Symbol('SKIP_SETUP');\n\n  /**\n   * Name of field.  Unique within each block.\n   * Static labels are usually unnamed.\n   */\n  name?: string = undefined;\n  protected value_: T | null;\n\n  /** Validation function called when user edits an editable field. */\n  protected validator_: FieldValidator<T> | null = null;\n\n  /**\n   * Used to cache the field's tooltip value if setTooltip is called when the\n   * field is not yet initialized. Is *not* guaranteed to be accurate.\n   */\n  private tooltip_: Tooltip.TipInfo | null = null;\n  protected size_: Size;\n\n  /**\n   * Holds the cursors svg element when the cursor is attached to the field.\n   * This is null if there is no cursor on the field.\n   */\n  private cursorSvg_: SVGElement | null = null;\n\n  /**\n   * Holds the markers svg element when the marker is attached to the field.\n   * This is null if there is no marker on the field.\n   */\n  private markerSvg_: SVGElement | null = null;\n\n  /** The rendered field's SVG group element. */\n  protected fieldGroup_: SVGGElement | null = null;\n\n  /** The rendered field's SVG border element. */\n  protected borderRect_: SVGRectElement | null = null;\n\n  /** The rendered field's SVG text element. */\n  protected textElement_: SVGTextElement | null = null;\n\n  /** The rendered field's text content element. */\n  protected textContent_: Text | null = null;\n\n  /** Mouse down event listener data. */\n  private mouseDownWrapper_: browserEvents.Data | null = null;\n\n  /** Constants associated with the source block's renderer. */\n  protected constants_: ConstantProvider | null = null;\n\n  /**\n   * Has this field been disposed of?\n   *\n   * @internal\n   */\n  disposed = false;\n\n  /** Maximum characters of text to display before adding an ellipsis. */\n  maxDisplayLength = 50;\n\n  /** Block this field is attached to.  Starts as null, then set in init. */\n  protected sourceBlock_: Block | null = null;\n\n  /** Does this block need to be re-rendered? */\n  protected isDirty_ = true;\n\n  /** Is the field visible, or hidden due to the block being collapsed? */\n  protected visible_ = true;\n\n  /**\n   * Can the field value be changed using the editor on an editable block?\n   */\n  protected enabled_ = true;\n\n  /** The element the click handler is bound to. */\n  protected clickTarget_: Element | null = null;\n\n  /**\n   * The prefix field.\n   *\n   * @internal\n   */\n  prefixField: string | null = null;\n\n  /**\n   * The suffix field.\n   *\n   * @internal\n   */\n  suffixField: string | null = null;\n\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. They will also be saved by the serializer.\n   */\n  EDITABLE = true;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable. This is not the\n   * case by default so that SERIALIZABLE is backwards compatible.\n   */\n  SERIALIZABLE = false;\n\n  /** Mouse cursor style when over the hotspot that initiates the editor. */\n  CURSOR = '';\n\n  /**\n   * @param value The initial value of the field.\n   *     Also accepts Field.SKIP_SETUP if you wish to skip setup (only used by\n   * subclasses that want to handle configuration and setting the field value\n   * after their own constructors have run).\n   * @param validator  A function that is called to validate changes to the\n   *     field's value. Takes in a value & returns a validated value, or null to\n   *     abort the change.\n   * @param config A map of options used to configure the field.\n   *    Refer to the individual field's documentation for a list of properties\n   * this parameter supports.\n   */\n  constructor(\n    value: T | typeof Field.SKIP_SETUP,\n    validator?: FieldValidator<T> | null,\n    config?: FieldConfig,\n  ) {\n    /**\n     * A generic value possessed by the field.\n     * Should generally be non-null, only null when the field is created.\n     */\n    this.value_ =\n      'DEFAULT_VALUE' in new.target.prototype\n        ? new.target.prototype.DEFAULT_VALUE\n        : this.DEFAULT_VALUE;\n\n    /** The size of the area rendered by the field. */\n    this.size_ = new Size(0, 0);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Process the configuration map passed to the field.\n   *\n   * @param config A map of options used to configure the field. See the\n   *     individual field's documentation for a list of properties this\n   *     parameter supports.\n   */\n  protected configure_(config: FieldConfig) {\n    // TODO (#2884): Possibly add CSS class config option.\n    // TODO (#2885): Possibly add cursor config option.\n    if (config.tooltip) {\n      this.setTooltip(parsing.replaceMessageReferences(config.tooltip));\n    }\n  }\n\n  /**\n   * Attach this field to a block.\n   *\n   * @param block The block containing this field.\n   */\n  setSourceBlock(block: Block) {\n    if (this.sourceBlock_) {\n      throw Error('Field already bound to a block');\n    }\n    this.sourceBlock_ = block;\n  }\n\n  /**\n   * Get the renderer constant provider.\n   *\n   * @returns The renderer constant provider.\n   */\n  getConstants(): ConstantProvider | null {\n    if (\n      !this.constants_ &&\n      this.sourceBlock_ &&\n      !this.sourceBlock_.isDeadOrDying() &&\n      this.sourceBlock_.workspace.rendered\n    ) {\n      this.constants_ = (this.sourceBlock_.workspace as WorkspaceSvg)\n        .getRenderer()\n        .getConstants();\n    }\n    return this.constants_;\n  }\n\n  /**\n   * Get the block this field is attached to.\n   *\n   * @returns The block containing this field.\n   * @throws An error if the source block is not defined.\n   */\n  getSourceBlock(): Block | null {\n    return this.sourceBlock_;\n  }\n\n  /**\n   * Initialize everything to render this field. Override\n   * methods initModel and initView rather than this method.\n   *\n   * @sealed\n   * @internal\n   */\n  init() {\n    if (this.fieldGroup_) {\n      // Field has already been initialized once.\n      return;\n    }\n    this.fieldGroup_ = dom.createSvgElement(Svg.G, {});\n    if (!this.isVisible()) {\n      this.fieldGroup_.style.display = 'none';\n    }\n    const sourceBlockSvg = this.sourceBlock_ as BlockSvg;\n    sourceBlockSvg.getSvgRoot().appendChild(this.fieldGroup_);\n    this.initView();\n    this.updateEditable();\n    this.setTooltip(this.tooltip_);\n    this.bindEvents_();\n    this.initModel();\n    this.applyColour();\n  }\n\n  /**\n   * Create the block UI for this field.\n   */\n  protected initView() {\n    this.createBorderRect_();\n    this.createTextElement_();\n  }\n\n  /**\n   * Initializes the model of the field after it has been installed on a block.\n   * No-op by default.\n   */\n  initModel() {}\n\n  /**\n   * Defines whether this field should take up the full block or not.\n   *\n   * Be cautious when overriding this function. It may not work as you expect /\n   * intend because the behavior was kind of hacked in. If you are thinking\n   * about overriding this function, post on the forum with your intended\n   * behavior to see if there's another approach.\n   */\n  protected isFullBlockField(): boolean {\n    return !this.borderRect_;\n  }\n\n  /**\n   * Create a field border rect element. Not to be overridden by subclasses.\n   * Instead modify the result of the function inside initView, or create a\n   * separate function to call.\n   */\n  protected createBorderRect_() {\n    this.borderRect_ = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'rx': this.getConstants()!.FIELD_BORDER_RECT_RADIUS,\n        'ry': this.getConstants()!.FIELD_BORDER_RECT_RADIUS,\n        'x': 0,\n        'y': 0,\n        'height': this.size_.height,\n        'width': this.size_.width,\n        'class': 'blocklyFieldRect',\n      },\n      this.fieldGroup_,\n    );\n  }\n\n  /**\n   * Create a field text element. Not to be overridden by subclasses. Instead\n   * modify the result of the function inside initView, or create a separate\n   * function to call.\n   */\n  protected createTextElement_() {\n    this.textElement_ = dom.createSvgElement(\n      Svg.TEXT,\n      {\n        'class': 'blocklyText',\n      },\n      this.fieldGroup_,\n    );\n    if (this.getConstants()!.FIELD_TEXT_BASELINE_CENTER) {\n      this.textElement_.setAttribute('dominant-baseline', 'central');\n    }\n    this.textContent_ = document.createTextNode('');\n    this.textElement_.appendChild(this.textContent_);\n  }\n\n  /**\n   * Bind events to the field. Can be overridden by subclasses if they need to\n   * do custom input handling.\n   */\n  protected bindEvents_() {\n    const clickTarget = this.getClickTarget_();\n    if (!clickTarget) throw new Error('A click target has not been set.');\n    Tooltip.bindMouseEvents(clickTarget);\n    this.mouseDownWrapper_ = browserEvents.conditionalBind(\n      clickTarget,\n      'pointerdown',\n      this,\n      this.onMouseDown_,\n    );\n  }\n\n  /**\n   * Sets the field's value based on the given XML element. Should only be\n   * called by Blockly.Xml.\n   *\n   * @param fieldElement The element containing info about the field's state.\n   * @internal\n   */\n  fromXml(fieldElement: Element) {\n    // Any because gremlins live here. No touchie!\n    this.setValue(fieldElement.textContent as any);\n  }\n\n  /**\n   * Serializes this field's value to XML. Should only be called by Blockly.Xml.\n   *\n   * @param fieldElement The element to populate with info about the field's\n   *     state.\n   * @returns The element containing info about the field's state.\n   * @internal\n   */\n  toXml(fieldElement: Element): Element {\n    // Any because gremlins live here. No touchie!\n    fieldElement.textContent = this.getValue() as any;\n    return fieldElement;\n  }\n\n  /**\n   * Saves this fields value as something which can be serialized to JSON.\n   * Should only be called by the serialization system.\n   *\n   * @param _doFullSerialization If true, this signals to the field that if it\n   *     normally just saves a reference to some state (eg variable fields) it\n   *     should instead serialize the full state of the thing being referenced.\n   *     See the\n   *     {@link https://developers.devsite.google.com/blockly/guides/create-custom-blocks/fields/customizing-fields/creating#full_serialization_and_backing_data | field serialization docs}\n   *     for more information.\n   * @returns JSON serializable state.\n   * @internal\n   */\n  saveState(_doFullSerialization?: boolean): AnyDuringMigration {\n    const legacyState = this.saveLegacyState(Field);\n    if (legacyState !== null) {\n      return legacyState;\n    }\n    return this.getValue();\n  }\n\n  /**\n   * Sets the field's state based on the given state value. Should only be\n   * called by the serialization system.\n   *\n   * @param state The state we want to apply to the field.\n   * @internal\n   */\n  loadState(state: AnyDuringMigration) {\n    if (this.loadLegacyState(Field, state)) {\n      return;\n    }\n    this.setValue(state);\n  }\n\n  /**\n   * Returns a stringified version of the XML state, if it should be used.\n   * Otherwise this returns null, to signal the field should use its own\n   * serialization.\n   *\n   * @param callingClass The class calling this method.\n   *     Used to see if `this` has overridden any relevant hooks.\n   * @returns The stringified version of the XML state, or null.\n   */\n  protected saveLegacyState(callingClass: FieldProto): string | null {\n    if (\n      callingClass.prototype.saveState === this.saveState &&\n      callingClass.prototype.toXml !== this.toXml\n    ) {\n      const elem = utilsXml.createElement('field');\n      elem.setAttribute('name', this.name || '');\n      const text = utilsXml.domToText(this.toXml(elem));\n      return text.replace(\n        ' xmlns=\"https://developers.google.com/blockly/xml\"',\n        '',\n      );\n    }\n    // Either they called this on purpose from their saveState, or they have\n    // no implementations of either hook. Just do our thing.\n    return null;\n  }\n\n  /**\n   * Loads the given state using either the old XML hooks, if they should be\n   * used. Returns true to indicate loading has been handled, false otherwise.\n   *\n   * @param callingClass The class calling this method.\n   *     Used to see if `this` has overridden any relevant hooks.\n   * @param state The state to apply to the field.\n   * @returns Whether the state was applied or not.\n   */\n  loadLegacyState(\n    callingClass: FieldProto,\n    state: AnyDuringMigration,\n  ): boolean {\n    if (\n      callingClass.prototype.loadState === this.loadState &&\n      callingClass.prototype.fromXml !== this.fromXml\n    ) {\n      this.fromXml(utilsXml.textToDom(state as string));\n      return true;\n    }\n    // Either they called this on purpose from their loadState, or they have\n    // no implementations of either hook. Just do our thing.\n    return false;\n  }\n\n  /**\n   * Dispose of all DOM objects and events belonging to this editable field.\n   *\n   * @internal\n   */\n  dispose() {\n    dropDownDiv.hideIfOwner(this);\n    WidgetDiv.hideIfOwner(this);\n\n    if (!this.getSourceBlock()?.isDeadOrDying()) {\n      dom.removeNode(this.fieldGroup_);\n    }\n\n    this.disposed = true;\n  }\n\n  /** Add or remove the UI indicating if this field is editable or not. */\n  updateEditable() {\n    const group = this.fieldGroup_;\n    const block = this.getSourceBlock();\n    if (!this.EDITABLE || !group || !block) {\n      return;\n    }\n    if (this.enabled_ && block.isEditable()) {\n      dom.addClass(group, 'blocklyEditableText');\n      dom.removeClass(group, 'blocklyNonEditableText');\n      group.style.cursor = this.CURSOR;\n    } else {\n      dom.addClass(group, 'blocklyNonEditableText');\n      dom.removeClass(group, 'blocklyEditableText');\n      group.style.cursor = '';\n    }\n  }\n\n  /**\n   * Set whether this field's value can be changed using the editor when the\n   *     source block is editable.\n   *\n   * @param enabled True if enabled.\n   */\n  setEnabled(enabled: boolean) {\n    this.enabled_ = enabled;\n    this.updateEditable();\n  }\n\n  /**\n   * Check whether this field's value can be changed using the editor when the\n   *     source block is editable.\n   *\n   * @returns Whether this field is enabled.\n   */\n  isEnabled(): boolean {\n    return this.enabled_;\n  }\n\n  /**\n   * Check whether this field defines the showEditor_ function.\n   *\n   * @returns Whether this field is clickable.\n   */\n  isClickable(): boolean {\n    return (\n      this.enabled_ &&\n      !!this.sourceBlock_ &&\n      this.sourceBlock_.isEditable() &&\n      this.showEditor_ !== Field.prototype.showEditor_\n    );\n  }\n\n  /**\n   * Check whether the field should be clickable while the block is in a flyout.\n   * The default is that fields are clickable in always-open flyouts such as the\n   * simple toolbox, but not in autoclosing flyouts such as the category toolbox.\n   * Subclasses may override this function to change this behavior. Note that\n   * `isClickable` must also return true for this to have any effect.\n   *\n   * @param autoClosingFlyout true if the containing flyout is an auto-closing one.\n   * @returns Whether the field should be clickable while the block is in a flyout.\n   */\n  isClickableInFlyout(autoClosingFlyout: boolean): boolean {\n    return !autoClosingFlyout;\n  }\n\n  /**\n   * Check whether this field is currently editable.  Some fields are never\n   * EDITABLE (e.g. text labels). Other fields may be EDITABLE but may exist on\n   * non-editable blocks or be currently disabled.\n   *\n   * @returns Whether this field is currently enabled, editable and on an\n   *     editable block.\n   */\n  isCurrentlyEditable(): boolean {\n    return (\n      this.enabled_ &&\n      this.EDITABLE &&\n      !!this.sourceBlock_ &&\n      this.sourceBlock_.isEditable()\n    );\n  }\n\n  /**\n   * Check whether this field should be serialized by the XML renderer.\n   * Handles the logic for backwards compatibility and incongruous states.\n   *\n   * @returns Whether this field should be serialized or not.\n   */\n  isSerializable(): boolean {\n    let isSerializable = false;\n    if (this.name) {\n      if (this.SERIALIZABLE) {\n        isSerializable = true;\n      } else if (this.EDITABLE) {\n        console.warn(\n          'Detected an editable field that was not serializable.' +\n            ' Please define SERIALIZABLE property as true on all editable custom' +\n            ' fields. Proceeding with serialization.',\n        );\n        isSerializable = true;\n      }\n    }\n    return isSerializable;\n  }\n\n  /**\n   * Gets whether this editable field is visible or not.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.visible_;\n  }\n\n  /**\n   * Sets whether this editable field is visible or not. Should only be called\n   * by input.setVisible.\n   *\n   * @param visible True if visible.\n   * @internal\n   */\n  setVisible(visible: boolean) {\n    if (this.visible_ === visible) {\n      return;\n    }\n    this.visible_ = visible;\n    const root = this.fieldGroup_;\n    if (root) {\n      root.style.display = visible ? 'block' : 'none';\n    }\n  }\n\n  /**\n   * Sets a new validation function for editable fields, or clears a previously\n   * set validator.\n   *\n   * The validator function takes in the new field value, and returns\n   * validated value. The validated value could be the input value, a modified\n   * version of the input value, or null to abort the change.\n   *\n   * If the function does not return anything (or returns undefined) the new\n   * value is accepted as valid. This is to allow for fields using the\n   * validated function as a field-level change event notification.\n   *\n   * @param handler The validator function or null to clear a previous\n   *     validator.\n   */\n  setValidator(handler: FieldValidator<T>) {\n    this.validator_ = handler;\n  }\n\n  /**\n   * Gets the validation function for editable fields, or null if not set.\n   *\n   * @returns Validation function, or null.\n   */\n  getValidator(): FieldValidator<T> | null {\n    return this.validator_;\n  }\n\n  /**\n   * Gets the group element for this editable field.\n   * Used for measuring the size and for positioning.\n   *\n   * @returns The group element.\n   */\n  getSvgRoot(): SVGGElement | null {\n    return this.fieldGroup_;\n  }\n\n  /**\n   * Gets the border rectangle element.\n   *\n   * @returns The border rectangle element.\n   * @throws An error if the border rectangle element is not defined.\n   */\n  protected getBorderRect(): SVGRectElement {\n    if (!this.borderRect_) {\n      throw new Error(`The border rectangle is ${this.borderRect_}.`);\n    }\n    return this.borderRect_;\n  }\n\n  /**\n   * Gets the text element.\n   *\n   * @returns The text element.\n   * @throws An error if the text element is not defined.\n   */\n  protected getTextElement(): SVGTextElement {\n    if (!this.textElement_) {\n      throw new Error(`The text element is ${this.textElement_}.`);\n    }\n    return this.textElement_;\n  }\n\n  /**\n   * Gets the text content.\n   *\n   * @returns The text content.\n   * @throws An error if the text content is not defined.\n   */\n  protected getTextContent(): Text {\n    if (!this.textContent_) {\n      throw new Error(`The text content is ${this.textContent_}.`);\n    }\n    return this.textContent_;\n  }\n\n  /**\n   * Updates the field to match the colour/style of the block.\n   *\n   * Non-abstract sub-classes may wish to implement this if the colour of the\n   * field depends on the colour of the block. It will automatically be called\n   * at relevant times, such as when the parent block or renderer changes.\n   *\n   * See {@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/customizing-fields/creating#matching_block_colours\n   * | the field documentation} for more information, or FieldDropdown for an\n   * example.\n   */\n  applyColour() {}\n\n  /**\n   * Used by getSize() to move/resize any DOM elements, and get the new size.\n   *\n   * All rendering that has an effect on the size/shape of the block should be\n   * done here, and should be triggered by getSize().\n   */\n  protected render_() {\n    if (this.textContent_) {\n      this.textContent_.nodeValue = this.getDisplayText_();\n    }\n    this.updateSize_();\n  }\n\n  /**\n   * Calls showEditor_ when the field is clicked if the field is clickable.\n   * Do not override.\n   *\n   * @param e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   * @sealed\n   * @internal\n   */\n  showEditor(e?: Event) {\n    if (this.isClickable()) {\n      this.showEditor_(e);\n    }\n  }\n\n  /**\n   * A developer hook to create an editor for the field. This is no-op by\n   * default, and must be overriden to create an editor.\n   *\n   * @param _e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   */\n  protected showEditor_(_e?: Event): void {}\n  // NOP\n\n  /**\n   * A developer hook to reposition the WidgetDiv during a window resize. You\n   * need to define this hook if your field has a WidgetDiv that needs to\n   * reposition itself when the window is resized. For example, text input\n   * fields define this hook so that the input WidgetDiv can reposition itself\n   * on a window resize event. This is especially important when modal inputs\n   * have been disabled, as Android devices will fire a window resize event when\n   * the soft keyboard opens.\n   *\n   * If you want the WidgetDiv to hide itself instead of repositioning, return\n   * false. This is the default behavior.\n   *\n   * DropdownDivs already handle their own positioning logic, so you do not need\n   * to override this function if your field only has a DropdownDiv.\n   *\n   * @returns True if the field should be repositioned,\n   *    false if the WidgetDiv should hide itself instead.\n   */\n  repositionForWindowResize(): boolean {\n    return false;\n  }\n\n  /**\n   * Updates the size of the field based on the text.\n   *\n   * @param margin margin to use when positioning the text element.\n   */\n  protected updateSize_(margin?: number) {\n    const constants = this.getConstants();\n    const xOffset =\n      margin !== undefined\n        ? margin\n        : !this.isFullBlockField()\n          ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING\n          : 0;\n    let totalWidth = xOffset * 2;\n    let totalHeight = constants!.FIELD_TEXT_HEIGHT;\n\n    let contentWidth = 0;\n    if (this.textElement_) {\n      contentWidth = dom.getFastTextWidth(\n        this.textElement_,\n        constants!.FIELD_TEXT_FONTSIZE,\n        constants!.FIELD_TEXT_FONTWEIGHT,\n        constants!.FIELD_TEXT_FONTFAMILY,\n      );\n      totalWidth += contentWidth;\n    }\n    if (!this.isFullBlockField()) {\n      totalHeight = Math.max(totalHeight, constants!.FIELD_BORDER_RECT_HEIGHT);\n    }\n\n    this.size_.height = totalHeight;\n    this.size_.width = totalWidth;\n\n    this.positionTextElement_(xOffset, contentWidth);\n    this.positionBorderRect_();\n  }\n\n  /**\n   * Position a field's text element after a size change.  This handles both LTR\n   * and RTL positioning.\n   *\n   * @param xOffset x offset to use when positioning the text element.\n   * @param contentWidth The content width.\n   */\n  protected positionTextElement_(xOffset: number, contentWidth: number) {\n    if (!this.textElement_) {\n      return;\n    }\n    const constants = this.getConstants();\n    const halfHeight = this.size_.height / 2;\n\n    this.textElement_.setAttribute(\n      'x',\n      String(\n        this.getSourceBlock()?.RTL\n          ? this.size_.width - contentWidth - xOffset\n          : xOffset,\n      ),\n    );\n    this.textElement_.setAttribute(\n      'y',\n      String(\n        constants!.FIELD_TEXT_BASELINE_CENTER\n          ? halfHeight\n          : halfHeight -\n              constants!.FIELD_TEXT_HEIGHT / 2 +\n              constants!.FIELD_TEXT_BASELINE,\n      ),\n    );\n  }\n\n  /** Position a field's border rect after a size change. */\n  protected positionBorderRect_() {\n    if (!this.borderRect_) {\n      return;\n    }\n    this.borderRect_.setAttribute('width', String(this.size_.width));\n    this.borderRect_.setAttribute('height', String(this.size_.height));\n    this.borderRect_.setAttribute(\n      'rx',\n      String(this.getConstants()!.FIELD_BORDER_RECT_RADIUS),\n    );\n    this.borderRect_.setAttribute(\n      'ry',\n      String(this.getConstants()!.FIELD_BORDER_RECT_RADIUS),\n    );\n  }\n\n  /**\n   * Returns the height and width of the field.\n   *\n   * This should *in general* be the only place render_ gets called from.\n   *\n   * @returns Height and width.\n   */\n  getSize(): Size {\n    if (!this.isVisible()) {\n      return new Size(0, 0);\n    }\n\n    if (this.isDirty_) {\n      this.render_();\n      this.isDirty_ = false;\n    } else if (this.visible_ && this.size_.width === 0) {\n      // If the field is not visible the width will be 0 as well, one of the\n      // problems with the old system.\n      this.render_();\n      // Don't issue a warning if the field is actually zero width.\n      if (this.size_.width !== 0) {\n        console.warn(\n          'Deprecated use of setting size_.width to 0 to rerender a' +\n            ' field. Set field.isDirty_ to true instead.',\n        );\n      }\n    }\n    return this.size_;\n  }\n\n  /**\n   * Returns the bounding box of the rendered field, accounting for workspace\n   * scaling.\n   *\n   * @returns An object with top, bottom, left, and right in pixels relative to\n   *     the top left corner of the page (window coordinates).\n   * @internal\n   */\n  getScaledBBox(): Rect {\n    let scaledWidth;\n    let scaledHeight;\n    let xy;\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n\n    if (this.isFullBlockField()) {\n      // Browsers are inconsistent in what they return for a bounding box.\n      // - Webkit / Blink: fill-box / object bounding box\n      // - Gecko: stroke-box\n      const bBox = (this.sourceBlock_ as BlockSvg).getHeightWidth();\n      const scale = (block.workspace as WorkspaceSvg).scale;\n      xy = this.getAbsoluteXY_();\n      scaledWidth = (bBox.width + 1) * scale;\n      scaledHeight = (bBox.height + 1) * scale;\n\n      if (userAgent.GECKO) {\n        xy.x += 1.5 * scale;\n        xy.y += 1.5 * scale;\n      } else {\n        xy.x -= 0.5 * scale;\n        xy.y -= 0.5 * scale;\n      }\n    } else {\n      const bBox = this.borderRect_!.getBoundingClientRect();\n      xy = style.getPageOffset(this.borderRect_!);\n      scaledWidth = bBox.width;\n      scaledHeight = bBox.height;\n    }\n    return new Rect(xy.y, xy.y + scaledHeight, xy.x, xy.x + scaledWidth);\n  }\n\n  /**\n   * Notifies the field that it has changed locations.\n   *\n   * @param _ The location of this field's block's top-start corner\n   *     in workspace coordinates.\n   */\n  onLocationChange(_: Coordinate) {}\n\n  /**\n   * Get the text from this field to display on the block. May differ from\n   * `getText` due to ellipsis, and other formatting.\n   *\n   * @returns Text to display.\n   */\n  protected getDisplayText_(): string {\n    let text = this.getText();\n    if (!text) {\n      // Prevent the field from disappearing if empty.\n      return Field.NBSP;\n    }\n    if (text.length > this.maxDisplayLength) {\n      // Truncate displayed string and add an ellipsis ('...').\n      text = text.substring(0, this.maxDisplayLength - 2) + '';\n    }\n    // Replace whitespace with non-breaking spaces so the text doesn't collapse.\n    text = text.replace(/\\s/g, Field.NBSP);\n    if (this.sourceBlock_ && this.sourceBlock_.RTL) {\n      // The SVG is LTR, force text to be RTL by adding an RLM.\n      text += '\\u200F';\n    }\n    return text;\n  }\n\n  /**\n   * Get the text from this field.\n   * Override getText_ to provide a different behavior than simply casting the\n   * value to a string.\n   *\n   * @returns Current text.\n   * @sealed\n   */\n  getText(): string {\n    // this.getText_ was intended so that devs don't have to remember to call\n    // super when overriding how the text of the field is generated. (#2910)\n    const text = this.getText_();\n    if (text !== null) {\n      return String(text);\n    }\n    return String(this.getValue());\n  }\n\n  /**\n   * A developer hook to override the returned text of this field.\n   * Override if the text representation of the value of this field\n   * is not just a string cast of its value.\n   * Return null to resort to a string cast.\n   *\n   * @returns Current text or null.\n   */\n  protected getText_(): string | null {\n    return null;\n  }\n\n  /**\n   * Force a rerender of the block that this field is installed on, which will\n   * rerender this field and adjust for any sizing changes.\n   * Other fields on the same block will not rerender, because their sizes have\n   * already been recorded.\n   *\n   * @internal\n   */\n  markDirty() {\n    this.isDirty_ = true;\n    this.constants_ = null;\n  }\n\n  /**\n   * Force a rerender of the block that this field is installed on, which will\n   * rerender this field and adjust for any sizing changes.\n   * Other fields on the same block will not rerender, because their sizes have\n   * already been recorded.\n   *\n   * @internal\n   */\n  forceRerender() {\n    this.isDirty_ = true;\n    if (this.sourceBlock_ && this.sourceBlock_.rendered) {\n      (this.sourceBlock_ as BlockSvg).queueRender();\n    }\n  }\n\n  /**\n   * Used to change the value of the field. Handles validation and events.\n   * Subclasses should override doClassValidation_ and doValueUpdate_ rather\n   * than this method.\n   *\n   * @param newValue New value.\n   * @param fireChangeEvent Whether to fire a change event. Defaults to true.\n   *     Should usually be true unless the change will be reported some other\n   *     way, e.g. an intermediate field change event.\n   * @sealed\n   */\n  setValue(newValue: AnyDuringMigration, fireChangeEvent = true) {\n    const doLogging = false;\n    if (newValue === null) {\n      doLogging && console.log('null, return');\n      // Not a valid value to check.\n      return;\n    }\n\n    const classValidation = this.doClassValidation_(newValue);\n    const classValue = this.processValidation_(\n      newValue,\n      classValidation,\n      fireChangeEvent,\n    );\n    if (classValue instanceof Error) {\n      doLogging && console.log('invalid class validation, return');\n      return;\n    }\n\n    const localValidation = this.getValidator()?.call(this, classValue);\n    const localValue = this.processValidation_(\n      classValue,\n      localValidation,\n      fireChangeEvent,\n    );\n    if (localValue instanceof Error) {\n      doLogging && console.log('invalid local validation, return');\n      return;\n    }\n\n    const source = this.sourceBlock_;\n    if (source && source.disposed) {\n      doLogging && console.log('source disposed, return');\n      return;\n    }\n\n    const oldValue = this.getValue();\n    if (oldValue === localValue) {\n      doLogging && console.log('same, doValueUpdate_, return');\n      this.doValueUpdate_(localValue);\n      return;\n    }\n\n    this.doValueUpdate_(localValue);\n    if (fireChangeEvent && source && eventUtils.isEnabled()) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          source,\n          'field',\n          this.name || null,\n          oldValue,\n          localValue,\n        ),\n      );\n    }\n    if (this.isDirty_) {\n      this.forceRerender();\n    }\n    doLogging && console.log(this.value_);\n  }\n\n  /**\n   * Process the result of validation.\n   *\n   * @param newValue New value.\n   * @param validatedValue Validated value.\n   * @param fireChangeEvent Whether to fire a change event if the value changes.\n   * @returns New value, or an Error object.\n   */\n  private processValidation_(\n    newValue: AnyDuringMigration,\n    validatedValue: T | null | undefined,\n    fireChangeEvent: boolean,\n  ): T | Error {\n    if (validatedValue === null) {\n      this.doValueInvalid_(newValue, fireChangeEvent);\n      if (this.isDirty_) {\n        this.forceRerender();\n      }\n      return Error();\n    }\n    return validatedValue === undefined ? (newValue as T) : validatedValue;\n  }\n\n  /**\n   * Get the current value of the field.\n   *\n   * @returns Current value.\n   */\n  getValue(): T | null {\n    return this.value_;\n  }\n\n  /**\n   * Validate the changes to a field's value before they are set. See\n   * **FieldDropdown** for an example of subclass implementation.\n   *\n   * **NOTE:** Validation returns one option between `T`, `null`, and\n   * `undefined`. **Field**'s implementation will never return `undefined`, but\n   * it is valid for a subclass to return `undefined` if the new value is\n   * compatible with `T`.\n   *\n   * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n   * @param newValue - The value to be validated.\n   * @returns One of three instructions for setting the new value: `T`, `null`,\n   * or `undefined`.\n   *\n   * - `T` to set this function's returned value instead of `newValue`.\n   *\n   * - `null` to invoke `doValueInvalid_` and not set a value.\n   *\n   * - `undefined` to set `newValue` as is.\n   */\n  protected doClassValidation_(newValue: T): T | null | undefined;\n  protected doClassValidation_(newValue?: AnyDuringMigration): T | null;\n  protected doClassValidation_(\n    newValue?: T | AnyDuringMigration,\n  ): T | null | undefined {\n    if (newValue === null || newValue === undefined) {\n      return null;\n    }\n\n    return newValue as T;\n  }\n\n  /**\n   * Used to update the value of a field. Can be overridden by subclasses to do\n   * custom storage of values/updating of external things.\n   *\n   * @param newValue The value to be saved.\n   */\n  protected doValueUpdate_(newValue: T) {\n    this.value_ = newValue;\n    this.isDirty_ = true;\n  }\n\n  /**\n   * Used to notify the field an invalid value was input. Can be overridden by\n   * subclasses, see FieldTextInput.\n   * No-op by default.\n   *\n   * @param _invalidValue The input value that was determined to be invalid.\n   * @param _fireChangeEvent Whether to fire a change event if the value changes.\n   */\n  protected doValueInvalid_(\n    _invalidValue: AnyDuringMigration,\n    _fireChangeEvent: boolean = true,\n  ) {}\n  // NOP\n\n  /**\n   * Handle a pointerdown event on a field.\n   *\n   * @param e Pointer down event.\n   */\n  protected onMouseDown_(e: PointerEvent) {\n    if (!this.sourceBlock_ || this.sourceBlock_.isDeadOrDying()) {\n      return;\n    }\n    const gesture = (this.sourceBlock_.workspace as WorkspaceSvg).getGesture(e);\n    if (gesture) {\n      gesture.setStartField(this);\n    }\n  }\n\n  /**\n   * Sets the tooltip for this field.\n   *\n   * @param newTip The text for the tooltip, a function that returns the text\n   *     for the tooltip, a parent object whose tooltip will be used, or null to\n   *     display the tooltip of the parent block. To not display a tooltip pass\n   *     the empty string.\n   */\n  setTooltip(newTip: Tooltip.TipInfo | null) {\n    if (!newTip && newTip !== '') {\n      // If null or undefined.\n      newTip = this.sourceBlock_;\n    }\n    const clickTarget = this.getClickTarget_();\n    if (clickTarget) {\n      (clickTarget as AnyDuringMigration).tooltip = newTip;\n    } else {\n      // Field has not been initialized yet.\n      this.tooltip_ = newTip;\n    }\n  }\n\n  /**\n   * Returns the tooltip text for this field.\n   *\n   * @returns The tooltip text for this field.\n   */\n  getTooltip(): string {\n    const clickTarget = this.getClickTarget_();\n    if (clickTarget) {\n      return Tooltip.getTooltipOfObject(clickTarget);\n    }\n    // Field has not been initialized yet. Return stashed this.tooltip_ value.\n    return Tooltip.getTooltipOfObject({tooltip: this.tooltip_});\n  }\n\n  /**\n   * The element to bind the click handler to. If not set explicitly, defaults\n   * to the SVG root of the field. When this element is\n   * clicked on an editable field, the editor will open.\n   *\n   * @returns Element to bind click handler to.\n   */\n  protected getClickTarget_(): Element | null {\n    return this.clickTarget_ || this.getSvgRoot();\n  }\n\n  /**\n   * Return the absolute coordinates of the top-left corner of this field.\n   * The origin (0,0) is the top-left corner of the page body.\n   *\n   * @returns Object with .x and .y properties.\n   */\n  protected getAbsoluteXY_(): Coordinate {\n    return style.getPageOffset(this.getClickTarget_() as SVGRectElement);\n  }\n\n  /**\n   * Whether this field references any Blockly variables.  If true it may need\n   * to be handled differently during serialization and deserialization.\n   * Subclasses may override this.\n   *\n   * @returns True if this field has any variable references.\n   * @internal\n   */\n  referencesVariables(): boolean {\n    return false;\n  }\n\n  /**\n   * Refresh the variable name referenced by this field if this field references\n   * variables.\n   *\n   * @internal\n   */\n  refreshVariableName() {}\n  // NOP\n\n  /**\n   * Search through the list of inputs and their fields in order to find the\n   * parent input of a field.\n   *\n   * @returns The input that the field belongs to.\n   * @internal\n   */\n  getParentInput(): Input {\n    let parentInput = null;\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const inputs = block.inputList;\n\n    for (let idx = 0; idx < block.inputList.length; idx++) {\n      const input = inputs[idx];\n      const fieldRows = input.fieldRow;\n      for (let j = 0; j < fieldRows.length; j++) {\n        if (fieldRows[j] === this) {\n          parentInput = input;\n          break;\n        }\n      }\n    }\n    return parentInput!;\n  }\n\n  /**\n   * Returns whether or not we should flip the field in RTL.\n   *\n   * @returns True if we should flip in RTL.\n   */\n  getFlipRtl(): boolean {\n    return false;\n  }\n\n  /**\n   * Returns whether or not the field is tab navigable.\n   *\n   * @returns True if the field is tab navigable.\n   */\n  isTabNavigable(): boolean {\n    return false;\n  }\n\n  /**\n   * Handles the given keyboard shortcut.\n   *\n   * @param _shortcut The shortcut to be handled.\n   * @returns True if the shortcut has been handled, false otherwise.\n   */\n  onShortcut(_shortcut: KeyboardShortcut): boolean {\n    return false;\n  }\n\n  /**\n   * Add the cursor SVG to this fields SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the field group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    if (!cursorSvg) {\n      this.cursorSvg_ = null;\n      return;\n    }\n\n    if (!this.fieldGroup_) {\n      throw new Error(`The field group is ${this.fieldGroup_}.`);\n    }\n    this.fieldGroup_.appendChild(cursorSvg);\n    this.cursorSvg_ = cursorSvg;\n  }\n\n  /**\n   * Add the marker SVG to this fields SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the field group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    if (!markerSvg) {\n      this.markerSvg_ = null;\n      return;\n    }\n\n    if (!this.fieldGroup_) {\n      throw new Error(`The field group is ${this.fieldGroup_}.`);\n    }\n    this.fieldGroup_.appendChild(markerSvg);\n    this.markerSvg_ = markerSvg;\n  }\n\n  /**\n   * Redraw any attached marker or cursor svgs if needed.\n   *\n   * @internal\n   */\n  updateMarkers_() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const workspace = block.workspace as WorkspaceSvg;\n    if (workspace.keyboardAccessibilityMode && this.cursorSvg_) {\n      workspace.getCursor()!.draw();\n    }\n    if (workspace.keyboardAccessibilityMode && this.markerSvg_) {\n      // TODO(#4592): Update all markers on the field.\n      workspace.getMarker(MarkerManager.LOCAL_MARKER)!.draw();\n    }\n  }\n\n  /**\n   * Subclasses should reimplement this method to construct their Field\n   * subclass from a JSON arg object.\n   *\n   * It is an error to attempt to register a field subclass in the\n   * FieldRegistry if that subclass has not overridden this method.\n   *\n   * @param _options JSON configuration object with properties needed\n   *    to configure a specific field.\n   */\n  static fromJson(_options: FieldConfig): Field {\n    throw new Error(\n      `Attempted to instantiate a field from the registry that hasn't defined a 'fromJson' method.`,\n    );\n  }\n}\n\n/**\n * Extra configuration options for the base field.\n */\nexport interface FieldConfig {\n  tooltip?: string;\n}\n\n/**\n * Represents an object that has all the prototype properties of the `Field`\n * class. This is necessary because constructors can change\n * in descendants, though they should contain all of Field's prototype methods.\n *\n * This type should only be used in places where we directly access the prototype\n * of a Field class or subclass.\n */\ntype FieldProto = Pick<typeof Field, 'prototype'>;\n\n/**\n * Represents an error where the field is trying to access its block or\n * information about its block before it has actually been attached to said\n * block.\n */\nexport class UnattachedFieldError extends Error {\n  /** @internal */\n  constructor() {\n    super(\n      'The field has not yet been attached to its input. ' +\n        'Call appendField to attach it.',\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Registry for context menu option items.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ContextMenuRegistry\n\nimport type {BlockSvg} from './block_svg.js';\nimport {RenderedWorkspaceComment} from './comments/rendered_workspace_comment.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for the registry of context menu items. This is intended to be a\n * singleton. You should not create a new instance, and only access this class\n * from ContextMenuRegistry.registry.\n */\nexport class ContextMenuRegistry {\n  static registry: ContextMenuRegistry;\n  /** Registry of all registered RegistryItems, keyed by ID. */\n  private registry_ = new Map<string, RegistryItem>();\n\n  /** Resets the existing singleton instance of ContextMenuRegistry. */\n  constructor() {\n    this.reset();\n  }\n\n  /** Clear and recreate the registry. */\n  reset() {\n    this.registry_.clear();\n  }\n\n  /**\n   * Registers a RegistryItem.\n   *\n   * @param item Context menu item to register.\n   * @throws {Error} if an item with the given ID already exists.\n   */\n  register(item: RegistryItem) {\n    if (this.registry_.has(item.id)) {\n      throw Error('Menu item with ID \"' + item.id + '\" is already registered.');\n    }\n    this.registry_.set(item.id, item);\n  }\n\n  /**\n   * Unregisters a RegistryItem with the given ID.\n   *\n   * @param id The ID of the RegistryItem to remove.\n   * @throws {Error} if an item with the given ID does not exist.\n   */\n  unregister(id: string) {\n    if (!this.registry_.has(id)) {\n      throw new Error('Menu item with ID \"' + id + '\" not found.');\n    }\n    this.registry_.delete(id);\n  }\n\n  /**\n   * @param id The ID of the RegistryItem to get.\n   * @returns RegistryItem or null if not found\n   */\n  getItem(id: string): RegistryItem | null {\n    return this.registry_.get(id) ?? null;\n  }\n\n  /**\n   * Gets the valid context menu options for the given scope type (e.g. block or\n   * workspace) and scope. Blocks are only shown if the preconditionFn shows\n   * they should not be hidden.\n   *\n   * @param scopeType Type of scope where menu should be shown (e.g. on a block\n   *     or on a workspace)\n   * @param scope Current scope of context menu (i.e., the exact workspace or\n   *     block being clicked on)\n   * @returns the list of ContextMenuOptions\n   */\n  getContextMenuOptions(\n    scopeType: ScopeType,\n    scope: Scope,\n  ): ContextMenuOption[] {\n    const menuOptions: ContextMenuOption[] = [];\n    for (const item of this.registry_.values()) {\n      if (scopeType === item.scopeType) {\n        const precondition = item.preconditionFn(scope);\n        if (precondition !== 'hidden') {\n          const displayText =\n            typeof item.displayText === 'function'\n              ? item.displayText(scope)\n              : item.displayText;\n          const menuOption: ContextMenuOption = {\n            text: displayText,\n            enabled: precondition === 'enabled',\n            callback: item.callback,\n            scope,\n            weight: item.weight,\n          };\n          menuOptions.push(menuOption);\n        }\n      }\n    }\n    menuOptions.sort(function (a, b) {\n      return a.weight - b.weight;\n    });\n    return menuOptions;\n  }\n}\n\nexport namespace ContextMenuRegistry {\n  /**\n   * Where this menu item should be rendered. If the menu item should be\n   * rendered in multiple scopes, e.g. on both a block and a workspace, it\n   * should be registered for each scope.\n   */\n  export enum ScopeType {\n    BLOCK = 'block',\n    WORKSPACE = 'workspace',\n    COMMENT = 'comment',\n  }\n\n  /**\n   * The actual workspace/block where the menu is being rendered. This is passed\n   * to callback and displayText functions that depend on this information.\n   */\n  export interface Scope {\n    block?: BlockSvg;\n    workspace?: WorkspaceSvg;\n    comment?: RenderedWorkspaceComment;\n  }\n\n  /**\n   * A menu item as entered in the registry.\n   */\n  export interface RegistryItem {\n    /**\n     * @param scope Object that provides a reference to the thing that had its\n     *     context menu opened.\n     * @param e The original event that triggered the context menu to open. Not\n     *     the event that triggered the click on the option.\n     */\n    callback: (scope: Scope, e: PointerEvent) => void;\n    scopeType: ScopeType;\n    displayText: ((p1: Scope) => string | HTMLElement) | string | HTMLElement;\n    preconditionFn: (p1: Scope) => string;\n    weight: number;\n    id: string;\n  }\n\n  /**\n   * A menu item as presented to contextmenu.js.\n   */\n  export interface ContextMenuOption {\n    text: string | HTMLElement;\n    enabled: boolean;\n    /**\n     * @param scope Object that provides a reference to the thing that had its\n     *     context menu opened.\n     * @param e The original event that triggered the context menu to open. Not\n     *     the event that triggered the click on the option.\n     */\n    callback: (scope: Scope, e: PointerEvent) => void;\n    scope: Scope;\n    weight: number;\n  }\n\n  /**\n   * A subset of ContextMenuOption corresponding to what was publicly\n   * documented.  ContextMenuOption should be preferred for new code.\n   */\n  export interface LegacyContextMenuOption {\n    text: string;\n    enabled: boolean;\n    callback: (p1: Scope) => void;\n  }\n\n  /**\n   * Singleton instance of this class. All interactions with this class should\n   * be done on this object.\n   */\n  ContextMenuRegistry.registry = new ContextMenuRegistry();\n}\n\nexport type ScopeType = ContextMenuRegistry.ScopeType;\nexport const ScopeType = ContextMenuRegistry.ScopeType;\nexport type Scope = ContextMenuRegistry.Scope;\nexport type RegistryItem = ContextMenuRegistry.RegistryItem;\nexport type ContextMenuOption = ContextMenuRegistry.ContextMenuOption;\nexport type LegacyContextMenuOption =\n  ContextMenuRegistry.LegacyContextMenuOption;\n","/**\n * @license\n * Copyright 2024 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {WorkspaceComment} from './workspace_comment.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport {CommentView} from './comment_view.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport {IBoundedElement} from '../interfaces/i_bounded_element.js';\nimport {IRenderedElement} from '../interfaces/i_rendered_element.js';\nimport * as dom from '../utils/dom.js';\nimport {IDraggable} from '../interfaces/i_draggable.js';\nimport {CommentDragStrategy} from '../dragging/comment_drag_strategy.js';\nimport * as browserEvents from '../browser_events.js';\nimport * as common from '../common.js';\nimport {ISelectable} from '../interfaces/i_selectable.js';\nimport {IDeletable} from '../interfaces/i_deletable.js';\nimport {ICopyable} from '../interfaces/i_copyable.js';\nimport * as commentSerialization from '../serialization/workspace_comments.js';\nimport {\n  WorkspaceCommentPaster,\n  WorkspaceCommentCopyData,\n} from '../clipboard/workspace_comment_paster.js';\nimport {IContextMenu} from '../interfaces/i_contextmenu.js';\nimport * as contextMenu from '../contextmenu.js';\nimport {ContextMenuRegistry} from '../contextmenu_registry.js';\n\nexport class RenderedWorkspaceComment\n  extends WorkspaceComment\n  implements\n    IBoundedElement,\n    IRenderedElement,\n    IDraggable,\n    ISelectable,\n    IDeletable,\n    ICopyable<WorkspaceCommentCopyData>,\n    IContextMenu\n{\n  /** The class encompassing the svg elements making up the workspace comment. */\n  private view: CommentView;\n\n  public readonly workspace: WorkspaceSvg;\n\n  private dragStrategy = new CommentDragStrategy(this);\n\n  /** Constructs the workspace comment, including the view. */\n  constructor(workspace: WorkspaceSvg, id?: string) {\n    super(workspace, id);\n\n    this.workspace = workspace;\n\n    this.view = new CommentView(workspace);\n    // Set the size to the default size as defined in the superclass.\n    this.view.setSize(this.getSize());\n    this.view.setEditable(this.isEditable());\n\n    this.addModelUpdateBindings();\n\n    browserEvents.conditionalBind(\n      this.view.getSvgRoot(),\n      'pointerdown',\n      this,\n      this.startGesture,\n    );\n    // Don't zoom with mousewheel; let it scroll instead.\n    browserEvents.conditionalBind(\n      this.view.getSvgRoot(),\n      'wheel',\n      this,\n      (e: Event) => {\n        e.stopPropagation();\n      },\n    );\n  }\n\n  /**\n   * Adds listeners to the view that updates the model (i.e. the superclass)\n   * when changes are made to the view.\n   */\n  private addModelUpdateBindings() {\n    this.view.addTextChangeListener(\n      (_, newText: string) => void super.setText(newText),\n    );\n    this.view.addSizeChangeListener(\n      (_, newSize: Size) => void super.setSize(newSize),\n    );\n    this.view.addOnCollapseListener(\n      () => void super.setCollapsed(this.view.isCollapsed()),\n    );\n    this.view.addDisposeListener(() => {\n      if (!this.isDeadOrDying()) this.dispose();\n    });\n  }\n\n  /** Sets the text of the comment. */\n  override setText(text: string): void {\n    // setText will trigger the change listener that updates\n    // the model aka superclass.\n    this.view.setText(text);\n  }\n\n  /** Sets the size of the comment. */\n  override setSize(size: Size) {\n    // setSize will trigger the change listener that updates\n    // the model aka superclass.\n    this.view.setSize(size);\n  }\n\n  /** Sets whether the comment is collapsed or not. */\n  override setCollapsed(collapsed: boolean) {\n    // setCollapsed will trigger the change listener that updates\n    // the model aka superclass.\n    this.view.setCollapsed(collapsed);\n  }\n\n  /** Sets whether the comment is editable or not. */\n  override setEditable(editable: boolean): void {\n    super.setEditable(editable);\n    // Use isEditable rather than isOwnEditable to account for workspace state.\n    this.view.setEditable(this.isEditable());\n  }\n\n  /** Returns the root SVG element of this comment. */\n  getSvgRoot(): SVGElement {\n    return this.view.getSvgRoot();\n  }\n\n  /**\n   * Returns the comment's size in workspace units.\n   * Does not respect collapsing.\n   */\n  getSize(): Size {\n    return super.getSize();\n  }\n\n  /**\n   * Returns the bounding rectangle of this comment in workspace coordinates.\n   * Respects collapsing.\n   */\n  getBoundingRectangle(): Rect {\n    const loc = this.getRelativeToSurfaceXY();\n    const size = this.view?.getSize() ?? this.getSize();\n    let left;\n    let right;\n    if (this.workspace.RTL) {\n      left = loc.x - size.width;\n      right = loc.x;\n    } else {\n      left = loc.x;\n      right = loc.x + size.width;\n    }\n    return new Rect(loc.y, loc.y + size.height, left, right);\n  }\n\n  /** Move the comment by the given amounts in workspace coordinates. */\n  moveBy(dx: number, dy: number, reason?: string[] | undefined): void {\n    const loc = this.getRelativeToSurfaceXY();\n    const newLoc = new Coordinate(loc.x + dx, loc.y + dy);\n    this.moveTo(newLoc, reason);\n  }\n\n  /** Moves the comment to the given location in workspace coordinates. */\n  override moveTo(location: Coordinate, reason?: string[] | undefined): void {\n    super.moveTo(location, reason);\n    this.view.moveTo(location);\n  }\n\n  /**\n   * Moves the comment during a drag. Doesn't fire move events.\n   *\n   * @internal\n   */\n  moveDuringDrag(location: Coordinate): void {\n    this.location = location;\n    this.view.moveTo(location);\n  }\n\n  /**\n   * Adds the dragging CSS class to this comment.\n   *\n   * @internal\n   */\n  setDragging(dragging: boolean): void {\n    if (dragging) {\n      dom.addClass(this.getSvgRoot(), 'blocklyDragging');\n    } else {\n      dom.removeClass(this.getSvgRoot(), 'blocklyDragging');\n    }\n  }\n\n  /** Disposes of the view. */\n  override dispose() {\n    this.disposing = true;\n    if (!this.view.isDeadOrDying()) this.view.dispose();\n    super.dispose();\n  }\n\n  /**\n   * Starts a gesture because we detected a pointer down on the comment\n   * (that wasn't otherwise gobbled up, e.g. by resizing).\n   */\n  private startGesture(e: PointerEvent) {\n    const gesture = this.workspace.getGesture(e);\n    if (gesture) {\n      gesture.handleCommentStart(e, this);\n      common.setSelected(this);\n    }\n  }\n\n  /** Visually indicates that this comment would be deleted if dropped. */\n  setDeleteStyle(wouldDelete: boolean): void {\n    if (wouldDelete) {\n      dom.addClass(this.getSvgRoot(), 'blocklyDraggingDelete');\n    } else {\n      dom.removeClass(this.getSvgRoot(), 'blocklyDraggingDelete');\n    }\n  }\n\n  /** Returns whether this comment is movable or not. */\n  isMovable(): boolean {\n    return this.dragStrategy.isMovable();\n  }\n\n  /** Starts a drag on the comment. */\n  startDrag(): void {\n    this.dragStrategy.startDrag();\n  }\n\n  /** Drags the comment to the given location. */\n  drag(newLoc: Coordinate): void {\n    this.dragStrategy.drag(newLoc);\n  }\n\n  /** Ends the drag on the comment. */\n  endDrag(): void {\n    this.dragStrategy.endDrag();\n  }\n\n  /** Moves the comment back to where it was at the start of a drag. */\n  revertDrag(): void {\n    this.dragStrategy.revertDrag();\n  }\n\n  /** Visually highlights the comment. */\n  select(): void {\n    dom.addClass(this.getSvgRoot(), 'blocklySelected');\n  }\n\n  /** Visually unhighlights the comment. */\n  unselect(): void {\n    dom.removeClass(this.getSvgRoot(), 'blocklySelected');\n  }\n\n  /**\n   * Returns a JSON serializable representation of this comment's state that\n   * can be used for pasting.\n   */\n  toCopyData(): WorkspaceCommentCopyData | null {\n    return {\n      paster: WorkspaceCommentPaster.TYPE,\n      commentState: commentSerialization.save(this, {\n        addCoordinates: true,\n      }),\n    };\n  }\n\n  /** Show a context menu for this comment. */\n  showContextMenu(e: PointerEvent): void {\n    const menuOptions = ContextMenuRegistry.registry.getContextMenuOptions(\n      ContextMenuRegistry.ScopeType.COMMENT,\n      {comment: this},\n    );\n    contextMenu.show(e, menuOptions, this.workspace.RTL, this.workspace);\n  }\n\n  /** Snap this comment to the nearest grid point. */\n  snapToGrid(): void {\n    if (this.isDeadOrDying()) return;\n    const grid = this.workspace.getGrid();\n    if (!grid?.shouldSnap()) return;\n    const currentXY = this.getRelativeToSurfaceXY();\n    const alignedXY = grid.alignXY(currentXY);\n    if (alignedXY !== currentXY) {\n      this.moveTo(alignedXY, ['snap']);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block creation event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BlockCreate\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport * as blocks from '../serialization/blocks.js';\nimport * as utilsXml from '../utils/xml.js';\nimport * as Xml from '../xml.js';\n\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\nimport {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners when a block (or connected stack of blocks) is\n * created.\n */\nexport class BlockCreate extends BlockBase {\n  override type = eventUtils.BLOCK_CREATE;\n\n  /** The XML representation of the created block(s). */\n  xml?: Element | DocumentFragment;\n\n  /** The JSON respresentation of the created block(s). */\n  json?: blocks.State;\n\n  /** All of the IDs of created blocks. */\n  ids?: string[];\n\n  /** @param opt_block The created block.  Undefined for a blank event. */\n  constructor(opt_block?: Block) {\n    super(opt_block);\n\n    if (!opt_block) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    if (opt_block.isShadow()) {\n      // Moving shadow blocks is handled via disconnection.\n      this.recordUndo = false;\n    }\n\n    this.xml = Xml.blockToDomWithXY(opt_block);\n    this.ids = eventUtils.getDescendantIds(opt_block);\n\n    this.json = blocks.save(opt_block, {addCoordinates: true}) as blocks.State;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockCreateJson {\n    const json = super.toJson() as BlockCreateJson;\n    if (!this.xml) {\n      throw new Error(\n        'The block XML is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.ids) {\n      throw new Error(\n        'The block IDs are undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.json) {\n      throw new Error(\n        'The block JSON is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['xml'] = Xml.domToText(this.xml);\n    json['ids'] = this.ids;\n    json['json'] = this.json;\n    if (!this.recordUndo) {\n      json['recordUndo'] = this.recordUndo;\n    }\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockCreate, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockCreateJson,\n    workspace: Workspace,\n    event?: any,\n  ): BlockCreate {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockCreate(),\n    ) as BlockCreate;\n    newEvent.xml = utilsXml.textToDom(json['xml']);\n    newEvent.ids = json['ids'];\n    newEvent.json = json['json'] as blocks.State;\n    if (json['recordUndo'] !== undefined) {\n      newEvent.recordUndo = json['recordUndo'];\n    }\n    return newEvent;\n  }\n\n  /**\n   * Run a creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.json) {\n      throw new Error(\n        'The block JSON is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.ids) {\n      throw new Error(\n        'The block IDs are undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (allShadowBlocks(workspace, this.ids)) return;\n    if (forward) {\n      blocks.append(this.json, workspace);\n    } else {\n      for (let i = 0; i < this.ids.length; i++) {\n        const id = this.ids[i];\n        const block = workspace.getBlockById(id);\n        if (block) {\n          block.dispose(false);\n        } else if (id === this.blockId) {\n          // Only complain about root-level block.\n          console.warn(\"Can't uncreate non-existent block: \" + id);\n        }\n      }\n    }\n  }\n}\n/**\n * Returns true if all blocks in the list are shadow blocks. If so, that means\n * the top-level block being created is a shadow block. This only happens when a\n * block that was covering up a shadow block is removed. We don't need to create\n * an additional block in that case because the original block still has its\n * shadow block.\n *\n * @param workspace Workspace to check for blocks\n * @param ids A list of block ids that were created in this event\n * @returns True if all block ids in the list are shadow blocks\n */\nconst allShadowBlocks = function (\n  workspace: Workspace,\n  ids: string[],\n): boolean {\n  const shadows = ids\n    .map((id) => workspace.getBlockById(id))\n    .filter((block) => block && block.isShadow());\n  return shadows.length === ids.length;\n};\n\nexport interface BlockCreateJson extends BlockBaseJson {\n  xml: string;\n  ids: string[];\n  json: object;\n  recordUndo?: boolean;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.CREATE, BlockCreate);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of a theme update.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.ThemeChange\n\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that the workspace theme has changed.\n */\nexport class ThemeChange extends UiBase {\n  /** The name of the new theme that has been set. */\n  themeName?: string;\n\n  override type = eventUtils.THEME_CHANGE;\n\n  /**\n   * @param opt_themeName The theme name. Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    event. Undefined for a blank event.\n   */\n  constructor(opt_themeName?: string, opt_workspaceId?: string) {\n    super(opt_workspaceId);\n    this.themeName = opt_themeName;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): ThemeChangeJson {\n    const json = super.toJson() as ThemeChangeJson;\n    if (!this.themeName) {\n      throw new Error(\n        'The theme name is undefined. Either pass a theme name to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['themeName'] = this.themeName;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of ThemeChange, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: ThemeChangeJson,\n    workspace: Workspace,\n    event?: any,\n  ): ThemeChange {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new ThemeChange(),\n    ) as ThemeChange;\n    newEvent.themeName = json['themeName'];\n    return newEvent;\n  }\n}\n\nexport interface ThemeChangeJson extends AbstractEventJson {\n  themeName: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.THEME_CHANGE, ThemeChange);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of a viewport change.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.ViewportChange\n\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that the workspace surface's position or scale has\n * changed.\n *\n * Does not notify when the workspace itself resizes.\n */\nexport class ViewportChange extends UiBase {\n  /**\n   * Top edge of the visible portion of the workspace, relative to the\n   * workspace origin.\n   */\n  viewTop?: number;\n\n  /**\n   * The left edge of the visible portion of the workspace, relative to\n   * the workspace origin.\n   */\n  viewLeft?: number;\n\n  /** The scale of the workpace. */\n  scale?: number;\n\n  /** The previous scale of the workspace. */\n  oldScale?: number;\n\n  override type = eventUtils.VIEWPORT_CHANGE;\n\n  /**\n   * @param opt_top Top-edge of the visible portion of the workspace, relative\n   *     to the workspace origin. Undefined for a blank event.\n   * @param opt_left Left-edge of the visible portion of the workspace relative\n   *     to the workspace origin. Undefined for a blank event.\n   * @param opt_scale The scale of the workspace. Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   * @param opt_oldScale The old scale of the workspace. Undefined for a blank\n   *     event.\n   */\n  constructor(\n    opt_top?: number,\n    opt_left?: number,\n    opt_scale?: number,\n    opt_workspaceId?: string,\n    opt_oldScale?: number,\n  ) {\n    super(opt_workspaceId);\n\n    this.viewTop = opt_top;\n    this.viewLeft = opt_left;\n    this.scale = opt_scale;\n    this.oldScale = opt_oldScale;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): ViewportChangeJson {\n    const json = super.toJson() as ViewportChangeJson;\n    if (this.viewTop === undefined) {\n      throw new Error(\n        'The view top is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (this.viewLeft === undefined) {\n      throw new Error(\n        'The view left is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (this.scale === undefined) {\n      throw new Error(\n        'The scale is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (this.oldScale === undefined) {\n      throw new Error(\n        'The old scale is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['viewTop'] = this.viewTop;\n    json['viewLeft'] = this.viewLeft;\n    json['scale'] = this.scale;\n    json['oldScale'] = this.oldScale;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of Viewport, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: ViewportChangeJson,\n    workspace: Workspace,\n    event?: any,\n  ): ViewportChange {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new ViewportChange(),\n    ) as ViewportChange;\n    newEvent.viewTop = json['viewTop'];\n    newEvent.viewLeft = json['viewLeft'];\n    newEvent.scale = json['scale'];\n    newEvent.oldScale = json['oldScale'];\n    return newEvent;\n  }\n}\n\nexport interface ViewportChangeJson extends AbstractEventJson {\n  viewTop: number;\n  viewLeft: number;\n  scale: number;\n  oldScale: number;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.VIEWPORT_CHANGE,\n  ViewportChange,\n);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.ConnectionType\n\n/**\n * Enum for the type of a connection or input.\n */\nexport enum ConnectionType {\n  // A right-facing value input.  E.g. 'set item to' or 'return'.\n  INPUT_VALUE = 1,\n  // A left-facing value output.  E.g. 'random fraction'.\n  OUTPUT_VALUE,\n  // A down-facing block stack.  E.g. 'if-do' or 'else'.\n  NEXT_STATEMENT,\n  // An up-facing block stack.  E.g. 'break out of loop'.\n  PREVIOUS_STATEMENT,\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A database of all the rendered connections that could\n *    possibly be connected to (i.e. not collapsed, etc).\n *    Sorted by y coordinate.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ConnectionDB\n\nimport {ConnectionType} from './connection_type.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport type {RenderedConnection} from './rendered_connection.js';\nimport type {Coordinate} from './utils/coordinate.js';\n\n/**\n * Database of connections.\n * Connections are stored in order of their vertical component.  This way\n * connections in an area may be looked up quickly using a binary search.\n */\nexport class ConnectionDB {\n  /** Array of connections sorted by y position in workspace units. */\n  private readonly connections: RenderedConnection[] = [];\n\n  /**\n   * @param connectionChecker The workspace's connection type checker, used to\n   *     decide if connections are valid during a drag.\n   */\n  constructor(private readonly connectionChecker: IConnectionChecker) {}\n\n  /**\n   * Add a connection to the database. Should not already exist in the database.\n   *\n   * @param connection The connection to be added.\n   * @param yPos The y position used to decide where to insert the connection.\n   * @internal\n   */\n  addConnection(connection: RenderedConnection, yPos: number) {\n    const index = this.calculateIndexForYPos(yPos);\n    this.connections.splice(index, 0, connection);\n  }\n\n  /**\n   * Finds the index of the given connection.\n   *\n   * Starts by doing a binary search to find the approximate location, then\n   * linearly searches nearby for the exact connection.\n   *\n   * @param conn The connection to find.\n   * @param yPos The y position used to find the index of the connection.\n   * @returns The index of the connection, or -1 if the connection was not\n   *     found.\n   */\n  private findIndexOfConnection(\n    conn: RenderedConnection,\n    yPos: number,\n  ): number {\n    if (!this.connections.length) {\n      return -1;\n    }\n\n    const bestGuess = this.calculateIndexForYPos(yPos);\n    if (bestGuess >= this.connections.length) {\n      // Not in list\n      return -1;\n    }\n\n    yPos = conn.y;\n    // Walk forward and back on the y axis looking for the connection.\n    let pointer = bestGuess;\n    while (pointer >= 0 && this.connections[pointer].y === yPos) {\n      if (this.connections[pointer] === conn) {\n        return pointer;\n      }\n      pointer--;\n    }\n\n    pointer = bestGuess;\n    while (\n      pointer < this.connections.length &&\n      this.connections[pointer].y === yPos\n    ) {\n      if (this.connections[pointer] === conn) {\n        return pointer;\n      }\n      pointer++;\n    }\n    return -1;\n  }\n\n  /**\n   * Finds the correct index for the given y position.\n   *\n   * @param yPos The y position used to decide where to insert the connection.\n   * @returns The candidate index.\n   */\n  private calculateIndexForYPos(yPos: number): number {\n    if (!this.connections.length) {\n      return 0;\n    }\n    let pointerMin = 0;\n    let pointerMax = this.connections.length;\n    while (pointerMin < pointerMax) {\n      const pointerMid = Math.floor((pointerMin + pointerMax) / 2);\n      if (this.connections[pointerMid].y < yPos) {\n        pointerMin = pointerMid + 1;\n      } else if (this.connections[pointerMid].y > yPos) {\n        pointerMax = pointerMid;\n      } else {\n        pointerMin = pointerMid;\n        break;\n      }\n    }\n    return pointerMin;\n  }\n\n  /**\n   * Remove a connection from the database.  Must already exist in DB.\n   *\n   * @param connection The connection to be removed.\n   * @param yPos The y position used to find the index of the connection.\n   * @throws {Error} If the connection cannot be found in the database.\n   */\n  removeConnection(connection: RenderedConnection, yPos: number) {\n    const index = this.findIndexOfConnection(connection, yPos);\n    if (index === -1) {\n      throw Error('Unable to find connection in connectionDB.');\n    }\n    this.connections.splice(index, 1);\n  }\n\n  /**\n   * Find all nearby connections to the given connection.\n   * Type checking does not apply, since this function is used for bumping.\n   *\n   * @param connection The connection whose neighbours should be returned.\n   * @param maxRadius The maximum radius to another connection.\n   * @returns List of connections.\n   */\n  getNeighbours(\n    connection: RenderedConnection,\n    maxRadius: number,\n  ): RenderedConnection[] {\n    const db = this.connections;\n    const currentX = connection.x;\n    const currentY = connection.y;\n\n    // Binary search to find the closest y location.\n    let pointerMin = 0;\n    let pointerMax = db.length - 2;\n    let pointerMid = pointerMax;\n    while (pointerMin < pointerMid) {\n      if (db[pointerMid].y < currentY) {\n        pointerMin = pointerMid;\n      } else {\n        pointerMax = pointerMid;\n      }\n      pointerMid = Math.floor((pointerMin + pointerMax) / 2);\n    }\n\n    const neighbours: RenderedConnection[] = [];\n    /**\n     * Computes if the current connection is within the allowed radius of\n     * another connection. This function is a closure and has access to outside\n     * variables.\n     *\n     * @param yIndex The other connection's index in the database.\n     * @returns True if the current connection's vertical distance from the\n     *     other connection is less than the allowed radius.\n     */\n    function checkConnection(yIndex: number): boolean {\n      const dx = currentX - db[yIndex].x;\n      const dy = currentY - db[yIndex].y;\n      const r = Math.sqrt(dx * dx + dy * dy);\n      if (r <= maxRadius) {\n        neighbours.push(db[yIndex]);\n      }\n      return dy < maxRadius;\n    }\n\n    // Walk forward and back on the y axis looking for the closest x,y point.\n    pointerMin = pointerMid;\n    pointerMax = pointerMid;\n    if (db.length) {\n      while (pointerMin >= 0 && checkConnection(pointerMin)) {\n        pointerMin--;\n      }\n      do {\n        pointerMax++;\n      } while (pointerMax < db.length && checkConnection(pointerMax));\n    }\n\n    return neighbours;\n  }\n\n  /**\n   * Is the candidate connection close to the reference connection.\n   * Extremely fast; only looks at Y distance.\n   *\n   * @param index Index in database of candidate connection.\n   * @param baseY Reference connection's Y value.\n   * @param maxRadius The maximum radius to another connection.\n   * @returns True if connection is in range.\n   */\n  private isInYRange(index: number, baseY: number, maxRadius: number): boolean {\n    return Math.abs(this.connections[index].y - baseY) <= maxRadius;\n  }\n\n  /**\n   * Find the closest compatible connection to this connection.\n   *\n   * @param conn The connection searching for a compatible mate.\n   * @param maxRadius The maximum radius to another connection.\n   * @param dxy Offset between this connection's location in the database and\n   *     the current location (as a result of dragging).\n   * @returns Contains two properties: 'connection' which is either another\n   *     connection or null, and 'radius' which is the distance.\n   */\n  searchForClosest(\n    conn: RenderedConnection,\n    maxRadius: number,\n    dxy: Coordinate,\n  ): {connection: RenderedConnection | null; radius: number} {\n    if (!this.connections.length) {\n      // Don't bother.\n      return {connection: null, radius: maxRadius};\n    }\n\n    // Stash the values of x and y from before the drag.\n    const baseY = conn.y;\n    const baseX = conn.x;\n\n    conn.x = baseX + dxy.x;\n    conn.y = baseY + dxy.y;\n\n    // calculateIndexForYPos_ finds an index for insertion, which is always\n    // after any block with the same y index.  We want to search both forward\n    // and back, so search on both sides of the index.\n    const closestIndex = this.calculateIndexForYPos(conn.y);\n\n    let bestConnection = null;\n    let bestRadius = maxRadius;\n    let temp;\n\n    // Walk forward and back on the y axis looking for the closest x,y point.\n    let pointerMin = closestIndex - 1;\n    while (pointerMin >= 0 && this.isInYRange(pointerMin, conn.y, maxRadius)) {\n      temp = this.connections[pointerMin];\n      if (this.connectionChecker.canConnect(conn, temp, true, bestRadius)) {\n        bestConnection = temp;\n        bestRadius = temp.distanceFrom(conn);\n      }\n      pointerMin--;\n    }\n\n    let pointerMax = closestIndex;\n    while (\n      pointerMax < this.connections.length &&\n      this.isInYRange(pointerMax, conn.y, maxRadius)\n    ) {\n      temp = this.connections[pointerMax];\n      if (this.connectionChecker.canConnect(conn, temp, true, bestRadius)) {\n        bestConnection = temp;\n        bestRadius = temp.distanceFrom(conn);\n      }\n      pointerMax++;\n    }\n\n    // Reset the values of x and y.\n    conn.x = baseX;\n    conn.y = baseY;\n    // If there were no valid connections, bestConnection will be null.\n    return {connection: bestConnection, radius: bestRadius};\n  }\n\n  /**\n   * Initialize a set of connection DBs for a workspace.\n   *\n   * @param checker The workspace's connection checker, used to decide if\n   *     connections are valid during a drag.\n   * @returns Array of databases.\n   */\n  static init(checker: IConnectionChecker): ConnectionDB[] {\n    // Create four databases, one for each connection type.\n    const dbList = [];\n    dbList[ConnectionType.INPUT_VALUE] = new ConnectionDB(checker);\n    dbList[ConnectionType.OUTPUT_VALUE] = new ConnectionDB(checker);\n    dbList[ConnectionType.NEXT_STATEMENT] = new ConnectionDB(checker);\n    dbList[ConnectionType.PREVIOUS_STATEMENT] = new ConnectionDB(checker);\n    return dbList;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for dragging a workspace visually.\n *\n * @class\n */\n// Former goog.module ID: Blockly.WorkspaceDragger\n\nimport * as common from './common.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for a workspace dragger.  It moves the workspace around when it is\n * being dragged by a mouse or touch.\n *\n */\nexport class WorkspaceDragger {\n  private readonly horizontalScrollEnabled_: boolean;\n  private readonly verticalScrollEnabled_: boolean;\n  protected startScrollXY_: Coordinate;\n\n  /** @param workspace The workspace to drag. */\n  constructor(private workspace: WorkspaceSvg) {\n    /** Whether horizontal scroll is enabled. */\n    this.horizontalScrollEnabled_ = this.workspace.isMovableHorizontally();\n\n    /** Whether vertical scroll is enabled. */\n    this.verticalScrollEnabled_ = this.workspace.isMovableVertically();\n\n    /**\n     * The scroll position of the workspace at the beginning of the drag.\n     * Coordinate system: pixel coordinates.\n     */\n    this.startScrollXY_ = new Coordinate(workspace.scrollX, workspace.scrollY);\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @internal\n   */\n  dispose() {\n    // AnyDuringMigration because:  Type 'null' is not assignable to type\n    // 'WorkspaceSvg'.\n    this.workspace = null as AnyDuringMigration;\n  }\n\n  /**\n   * Start dragging the workspace.\n   *\n   * @internal\n   */\n  startDrag() {\n    if (common.getSelected()) {\n      common.getSelected()!.unselect();\n    }\n  }\n\n  /**\n   * Finish dragging the workspace and put everything back where it belongs.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel coordinates.\n   * @internal\n   */\n  endDrag(currentDragDeltaXY: Coordinate) {\n    // Make sure everything is up to date.\n    this.drag(currentDragDeltaXY);\n  }\n\n  /**\n   * Move the workspace based on the most recent mouse movements.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel coordinates.\n   * @internal\n   */\n  drag(currentDragDeltaXY: Coordinate) {\n    const newXY = Coordinate.sum(this.startScrollXY_, currentDragDeltaXY);\n\n    if (this.horizontalScrollEnabled_ && this.verticalScrollEnabled_) {\n      this.workspace.scroll(newXY.x, newXY.y);\n    } else if (this.horizontalScrollEnabled_) {\n      this.workspace.scroll(newXY.x, this.workspace.scrollY);\n    } else if (this.verticalScrollEnabled_) {\n      this.workspace.scroll(this.workspace.scrollX, newXY.y);\n    } else {\n      throw new TypeError('Invalid state.');\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing an in-progress gesture, e.g. a drag,\n * tap, or pinch to zoom.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Gesture\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_click.js';\n\nimport * as blockAnimations from './block_animations.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\nimport {config} from './config.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Field} from './field.js';\nimport type {IBubble} from './interfaces/i_bubble.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport * as Tooltip from './tooltip.js';\nimport * as Touch from './touch.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport {WorkspaceDragger} from './workspace_dragger.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport type {IIcon} from './interfaces/i_icon.js';\nimport {IDragger} from './interfaces/i_dragger.js';\nimport * as registry from './registry.js';\nimport {IDraggable, isDraggable} from './interfaces/i_draggable.js';\nimport {RenderedWorkspaceComment} from './comments.js';\n\n/**\n * Note: In this file \"start\" refers to pointerdown\n * events.  \"End\" refers to pointerup events.\n */\n\n/** A multiplier used to convert the gesture scale to a zoom in delta. */\nconst ZOOM_IN_MULTIPLIER = 5;\n\n/** A multiplier used to convert the gesture scale to a zoom out delta. */\nconst ZOOM_OUT_MULTIPLIER = 6;\n\n/**\n * Class for one gesture.\n */\nexport class Gesture {\n  /**\n   * The position of the pointer when the gesture started.  Units are CSS\n   * pixels, with (0, 0) at the top left of the browser window (pointer event\n   * clientX/Y).\n   */\n  private mouseDownXY = new Coordinate(0, 0);\n  private currentDragDeltaXY: Coordinate;\n\n  /**\n   * The bubble that the gesture started on, or null if it did not start on a\n   * bubble.\n   */\n  private startBubble: IBubble | null = null;\n\n  /**\n   * The field that the gesture started on, or null if it did not start on a\n   * field.\n   */\n  private startField: Field | null = null;\n\n  /**\n   * The icon that the gesture started on, or null if it did not start on an\n   * icon.\n   */\n  private startIcon: IIcon | null = null;\n\n  /**\n   * The block that the gesture started on, or null if it did not start on a\n   * block.\n   */\n  private startBlock: BlockSvg | null = null;\n\n  /**\n   * The comment that the gesture started on, or null if it did not start on a\n   * comment.\n   */\n  private startComment: RenderedWorkspaceComment | null = null;\n\n  /**\n   * The block that this gesture targets.  If the gesture started on a\n   * shadow block, this is the first non-shadow parent of the block.  If the\n   * gesture started in the flyout, this is the root block of the block group\n   * that was clicked or dragged.\n   */\n  private targetBlock: BlockSvg | null = null;\n\n  /**\n   * The workspace that the gesture started on.  There may be multiple\n   * workspaces on a page; this is more accurate than using\n   * Blockly.common.getMainWorkspace().\n   */\n  protected startWorkspace_: WorkspaceSvg | null = null;\n\n  /**\n   * Whether the pointer has at any point moved out of the drag radius.\n   * A gesture that exceeds the drag radius is a drag even if it ends exactly\n   * at its start point.\n   */\n  private hasExceededDragRadius = false;\n\n  /**\n   * Array holding info needed to unbind events.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  private boundEvents: browserEvents.Data[] = [];\n\n  private dragger: IDragger | null = null;\n\n  /**\n   * The object tracking a workspace or flyout workspace drag, or null if none\n   * is in progress.\n   */\n  private workspaceDragger: WorkspaceDragger | null = null;\n\n  /** Whether the gesture is dragging or not. */\n  private dragging: boolean = false;\n\n  /** The flyout a gesture started in, if any. */\n  private flyout: IFlyout | null = null;\n\n  /** Boolean for sanity-checking that some code is only called once. */\n  private calledUpdateIsDragging = false;\n\n  /** Boolean for sanity-checking that some code is only called once. */\n  private gestureHasStarted = false;\n\n  /** Boolean used internally to break a cycle in disposal. */\n  protected isEnding_ = false;\n\n  /** The event that most recently updated this gesture. */\n  private mostRecentEvent: PointerEvent;\n\n  /** Boolean for whether or not this gesture is a multi-touch gesture. */\n  private isMultiTouch_ = false;\n\n  /** A map of cached points used for tracking multi-touch gestures. */\n  private cachedPoints = new Map<string, Coordinate | null>();\n\n  /**\n   * This is the ratio between the starting distance between the touch points\n   * and the most recent distance between the touch points.\n   * Scales between 0 and 1 mean the most recent zoom was a zoom out.\n   * Scales above 1.0 mean the most recent zoom was a zoom in.\n   */\n  private previousScale = 0;\n\n  /** The starting distance between two touch points. */\n  private startDistance = 0;\n\n  /** Boolean for whether or not the workspace supports pinch-zoom. */\n  private isPinchZoomEnabled: boolean | null = null;\n\n  /**\n   * The owner of the dropdownDiv when this gesture first starts.\n   * Needed because we'll close the dropdown before fields get to\n   * act on their events, and some fields care about who owns\n   * the dropdown.\n   */\n  currentDropdownOwner: Field | null = null;\n\n  /**\n   * @param e The event that kicked off this gesture.\n   * @param creatorWorkspace The workspace that created this gesture and has a\n   *     reference to it.\n   */\n  constructor(\n    e: PointerEvent,\n    private readonly creatorWorkspace: WorkspaceSvg,\n  ) {\n    this.mostRecentEvent = e;\n\n    /**\n     * How far the pointer has moved during this drag, in pixel units.\n     * (0, 0) is at this.mouseDownXY_.\n     */\n    this.currentDragDeltaXY = new Coordinate(0, 0);\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @internal\n   */\n  dispose() {\n    Touch.clearTouchIdentifier();\n    Tooltip.unblock();\n    // Clear the owner's reference to this gesture.\n    this.creatorWorkspace.clearGesture();\n\n    for (const event of this.boundEvents) {\n      browserEvents.unbind(event);\n    }\n    this.boundEvents.length = 0;\n\n    if (this.workspaceDragger) {\n      this.workspaceDragger.dispose();\n    }\n  }\n\n  /**\n   * Update internal state based on an event.\n   *\n   * @param e The most recent pointer event.\n   */\n  private updateFromEvent(e: PointerEvent) {\n    const currentXY = new Coordinate(e.clientX, e.clientY);\n    const changed = this.updateDragDelta(currentXY);\n    // Exceeded the drag radius for the first time.\n    if (changed) {\n      this.updateIsDragging(e);\n      Touch.longStop();\n    }\n    this.mostRecentEvent = e;\n  }\n\n  /**\n   * DO MATH to set currentDragDeltaXY_ based on the most recent pointer\n   * position.\n   *\n   * @param currentXY The most recent pointer position, in pixel units,\n   *     with (0, 0) at the window's top left corner.\n   * @returns True if the drag just exceeded the drag radius for the first time.\n   */\n  private updateDragDelta(currentXY: Coordinate): boolean {\n    this.currentDragDeltaXY = Coordinate.difference(\n      currentXY,\n      this.mouseDownXY,\n    );\n\n    if (!this.hasExceededDragRadius) {\n      const currentDragDelta = Coordinate.magnitude(this.currentDragDeltaXY);\n\n      // The flyout has a different drag radius from the rest of Blockly.\n      const limitRadius = this.flyout\n        ? config.flyoutDragRadius\n        : config.dragRadius;\n\n      this.hasExceededDragRadius = currentDragDelta > limitRadius;\n      return this.hasExceededDragRadius;\n    }\n    return false;\n  }\n\n  /**\n   * Update this gesture to record whether a block is being dragged from the\n   * flyout.\n   * This function should be called on a pointermove event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture. If a block should be dragged from the flyout this function creates\n   * the new block on the main workspace and updates targetBlock_ and\n   * startWorkspace_.\n   *\n   * @returns True if a block is being dragged from the flyout.\n   */\n  private updateIsDraggingFromFlyout(): boolean {\n    if (!this.targetBlock || !this.flyout?.isBlockCreatable(this.targetBlock)) {\n      return false;\n    }\n    if (!this.flyout.targetWorkspace) {\n      throw new Error(`Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined`);\n    }\n    if (\n      !this.flyout.isScrollable() ||\n      this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)\n    ) {\n      this.startWorkspace_ = this.flyout.targetWorkspace;\n      this.startWorkspace_.updateScreenCalculationsIfScrolled();\n      // Start the event group now, so that the same event group is used for\n      // block creation and block dragging.\n      if (!eventUtils.getGroup()) {\n        eventUtils.setGroup(true);\n      }\n      // The start block is no longer relevant, because this is a drag.\n      this.startBlock = null;\n      this.targetBlock = this.flyout.createBlock(this.targetBlock);\n      common.setSelected(this.targetBlock);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Check whether to start a workspace drag. If a workspace is being dragged,\n   * create the necessary WorkspaceDragger and start the drag.\n   *\n   * This function should be called on a pointermove event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture. If a workspace is being dragged this function creates the\n   * necessary WorkspaceDragger and starts the drag.\n   */\n  private updateIsDraggingWorkspace() {\n    if (!this.startWorkspace_) {\n      throw new Error(\n        'Cannot update dragging the workspace because the ' +\n          'start workspace is undefined',\n      );\n    }\n\n    const wsMovable = this.flyout\n      ? this.flyout.isScrollable()\n      : this.startWorkspace_ && this.startWorkspace_.isDraggable();\n    if (!wsMovable) return;\n\n    this.dragging = true;\n    this.workspaceDragger = new WorkspaceDragger(this.startWorkspace_);\n\n    this.workspaceDragger.startDrag();\n  }\n\n  /**\n   * Update this gesture to record whether anything is being dragged.\n   * This function should be called on a pointermove event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture.\n   */\n  private updateIsDragging(e: PointerEvent) {\n    if (!this.startWorkspace_) {\n      throw new Error(\n        'Cannot update dragging because the start workspace is undefined',\n      );\n    }\n\n    if (this.calledUpdateIsDragging) {\n      throw Error('updateIsDragging_ should only be called once per gesture.');\n    }\n    this.calledUpdateIsDragging = true;\n\n    // If we drag a block out of the flyout, it updates `common.getSelected`\n    // to return the new block.\n    if (this.flyout) this.updateIsDraggingFromFlyout();\n\n    const selected = common.getSelected();\n    if (selected && isDraggable(selected) && selected.isMovable()) {\n      this.dragging = true;\n      this.dragger = this.createDragger(selected, this.startWorkspace_);\n      this.dragger.onDragStart(e);\n      this.dragger.onDrag(e, this.currentDragDeltaXY);\n    } else {\n      this.updateIsDraggingWorkspace();\n    }\n  }\n\n  private createDragger(\n    draggable: IDraggable,\n    workspace: WorkspaceSvg,\n  ): IDragger {\n    const DraggerClass = registry.getClassFromOptions(\n      registry.Type.BLOCK_DRAGGER,\n      this.creatorWorkspace.options,\n      true,\n    );\n    return new DraggerClass!(draggable, workspace);\n  }\n\n  /**\n   * Start a gesture: update the workspace to indicate that a gesture is in\n   * progress and bind pointermove and pointerup handlers.\n   *\n   * @param e A pointerdown event.\n   * @internal\n   */\n  doStart(e: PointerEvent) {\n    if (!this.startWorkspace_) {\n      throw new Error(\n        'Cannot start the touch gesture becauase the start ' +\n          'workspace is undefined',\n      );\n    }\n    this.isPinchZoomEnabled =\n      this.startWorkspace_.options.zoomOptions &&\n      this.startWorkspace_.options.zoomOptions.pinch;\n\n    if (browserEvents.isTargetInput(e)) {\n      this.cancel();\n      return;\n    }\n\n    this.gestureHasStarted = true;\n\n    blockAnimations.disconnectUiStop();\n\n    this.startWorkspace_.updateScreenCalculationsIfScrolled();\n    if (this.startWorkspace_.isMutator) {\n      // Mutator's coordinate system could be out of date because the bubble was\n      // dragged, the block was moved, the parent workspace zoomed, etc.\n      this.startWorkspace_.resize();\n    }\n\n    // Keep track of which field owns the dropdown before we close it.\n    this.currentDropdownOwner = dropDownDiv.getOwner();\n    // Hide chaff also hides the flyout, so don't do it if the click is in a\n    // flyout.\n    this.startWorkspace_.hideChaff(!!this.flyout);\n\n    this.startWorkspace_.markFocused();\n    this.mostRecentEvent = e;\n\n    Tooltip.block();\n\n    if (browserEvents.isRightButton(e)) {\n      this.handleRightClick(e);\n      return;\n    }\n\n    if (e.type.toLowerCase() === 'pointerdown' && e.pointerType !== 'mouse') {\n      Touch.longStart(e, this);\n    }\n\n    this.mouseDownXY = new Coordinate(e.clientX, e.clientY);\n\n    this.bindMouseEvents(e);\n\n    if (!this.isEnding_) {\n      this.handleTouchStart(e);\n    }\n  }\n\n  /**\n   * Bind gesture events.\n   *\n   * @param e A pointerdown event.\n   * @internal\n   */\n  bindMouseEvents(e: PointerEvent) {\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        document,\n        'pointerdown',\n        null,\n        this.handleStart.bind(this),\n        /* opt_noCaptureIdentifier */ true,\n      ),\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        document,\n        'pointermove',\n        null,\n        this.handleMove.bind(this),\n        /* opt_noCaptureIdentifier */ true,\n      ),\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        document,\n        'pointerup',\n        null,\n        this.handleUp.bind(this),\n        /* opt_noCaptureIdentifier */ true,\n      ),\n    );\n\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  /**\n   * Handle a pointerdown event.\n   *\n   * @param e A pointerdown event.\n   * @internal\n   */\n  handleStart(e: PointerEvent) {\n    if (this.isDragging()) {\n      // A drag has already started, so this can no longer be a pinch-zoom.\n      return;\n    }\n    this.handleTouchStart(e);\n\n    if (this.isMultiTouch()) {\n      Touch.longStop();\n    }\n  }\n\n  /**\n   * Handle a pointermove event.\n   *\n   * @param e A pointermove event.\n   * @internal\n   */\n  handleMove(e: PointerEvent) {\n    if (\n      (this.isDragging() && Touch.shouldHandleEvent(e)) ||\n      !this.isMultiTouch()\n    ) {\n      this.updateFromEvent(e);\n      if (this.workspaceDragger) {\n        this.workspaceDragger.drag(this.currentDragDeltaXY);\n      } else if (this.dragger) {\n        this.dragger.onDrag(this.mostRecentEvent, this.currentDragDeltaXY);\n      }\n      e.preventDefault();\n      e.stopPropagation();\n    } else if (this.isMultiTouch()) {\n      this.handleTouchMove(e);\n      Touch.longStop();\n    }\n  }\n\n  /**\n   * Handle a pointerup event.\n   *\n   * @param e A pointerup event.\n   * @internal\n   */\n  handleUp(e: PointerEvent) {\n    if (!this.isDragging()) {\n      this.handleTouchEnd(e);\n    }\n    if (!this.isMultiTouch() || this.isDragging()) {\n      if (!Touch.shouldHandleEvent(e)) {\n        return;\n      }\n      this.updateFromEvent(e);\n      Touch.longStop();\n\n      if (this.isEnding_) {\n        console.log('Trying to end a gesture recursively.');\n        return;\n      }\n      this.isEnding_ = true;\n      // The ordering of these checks is important: drags have higher priority\n      // than clicks.  Fields and icons have higher priority than blocks; blocks\n      // have higher priority than workspaces. The ordering within drags does\n      // not matter, because the three types of dragging are exclusive.\n      if (this.dragger) {\n        this.dragger.onDragEnd(e, this.currentDragDeltaXY);\n      } else if (this.workspaceDragger) {\n        this.workspaceDragger.endDrag(this.currentDragDeltaXY);\n      } else if (this.isBubbleClick()) {\n        // Do nothing, bubbles don't currently respond to clicks.\n      } else if (this.isCommentClick()) {\n        // Do nothing, comments don't currently respond to clicks.\n      } else if (this.isFieldClick()) {\n        this.doFieldClick();\n      } else if (this.isIconClick()) {\n        this.doIconClick();\n      } else if (this.isBlockClick()) {\n        this.doBlockClick();\n      } else if (this.isWorkspaceClick()) {\n        this.doWorkspaceClick(e);\n      }\n\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.dispose();\n    } else {\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.dispose();\n    }\n  }\n\n  /**\n   * Handle a pointerdown event and keep track of current\n   * pointers.\n   *\n   * @param e A pointerdown event.\n   * @internal\n   */\n  handleTouchStart(e: PointerEvent) {\n    const pointerId = Touch.getTouchIdentifierFromEvent(e);\n    // store the pointerId in the current list of pointers\n    this.cachedPoints.set(pointerId, this.getTouchPoint(e));\n    const pointers = Array.from(this.cachedPoints.keys());\n    // If two pointers are down, store info\n    if (pointers.length === 2) {\n      const point0 = this.cachedPoints.get(pointers[0])!;\n      const point1 = this.cachedPoints.get(pointers[1])!;\n      this.startDistance = Coordinate.distance(point0, point1);\n      this.isMultiTouch_ = true;\n      e.preventDefault();\n    }\n  }\n\n  /**\n   * Handle a pointermove event and zoom in/out if two pointers\n   * are on the screen.\n   *\n   * @param e A pointermove event.\n   * @internal\n   */\n  handleTouchMove(e: PointerEvent) {\n    const pointerId = Touch.getTouchIdentifierFromEvent(e);\n    // Update the cache\n    this.cachedPoints.set(pointerId, this.getTouchPoint(e));\n\n    if (this.isPinchZoomEnabled && this.cachedPoints.size === 2) {\n      this.handlePinch(e);\n    } else {\n      this.handleMove(e);\n    }\n  }\n\n  /**\n   * Handle pinch zoom gesture.\n   *\n   * @param e A pointermove event.\n   */\n  private handlePinch(e: PointerEvent) {\n    const pointers = Array.from(this.cachedPoints.keys());\n    // Calculate the distance between the two pointers\n    const point0 = this.cachedPoints.get(pointers[0])!;\n    const point1 = this.cachedPoints.get(pointers[1])!;\n    const moveDistance = Coordinate.distance(point0, point1);\n    const scale = moveDistance / this.startDistance;\n\n    if (this.previousScale > 0 && this.previousScale < Infinity) {\n      const gestureScale = scale - this.previousScale;\n      const delta =\n        gestureScale > 0\n          ? gestureScale * ZOOM_IN_MULTIPLIER\n          : gestureScale * ZOOM_OUT_MULTIPLIER;\n      if (!this.startWorkspace_) {\n        throw new Error(\n          'Cannot handle a pinch because the start workspace ' + 'is undefined',\n        );\n      }\n      const workspace = this.startWorkspace_;\n      const position = browserEvents.mouseToSvg(\n        e,\n        workspace.getParentSvg(),\n        workspace.getInverseScreenCTM(),\n      );\n      workspace.zoom(position.x, position.y, delta);\n    }\n    this.previousScale = scale;\n    e.preventDefault();\n  }\n\n  /**\n   * Handle a pointerup event and end the gesture.\n   *\n   * @param e A pointerup event.\n   * @internal\n   */\n  handleTouchEnd(e: PointerEvent) {\n    const pointerId = Touch.getTouchIdentifierFromEvent(e);\n    if (this.cachedPoints.has(pointerId)) {\n      this.cachedPoints.delete(pointerId);\n    }\n    if (this.cachedPoints.size < 2) {\n      this.cachedPoints.clear();\n      this.previousScale = 0;\n    }\n  }\n\n  /**\n   * Helper function returning the current touch point coordinate.\n   *\n   * @param e A pointer event.\n   * @returns The current touch point coordinate\n   * @internal\n   */\n  getTouchPoint(e: PointerEvent): Coordinate | null {\n    if (!this.startWorkspace_) {\n      return null;\n    }\n    return new Coordinate(e.pageX, e.pageY);\n  }\n\n  /**\n   * Whether this gesture is part of a multi-touch gesture.\n   *\n   * @returns Whether this gesture is part of a multi-touch gesture.\n   * @internal\n   */\n  isMultiTouch(): boolean {\n    return this.isMultiTouch_;\n  }\n\n  /**\n   * Cancel an in-progress gesture.  If a workspace or block drag is in\n   * progress, end the drag at the most recent location.\n   *\n   * @internal\n   */\n  cancel() {\n    // Disposing of a block cancels in-progress drags, but dragging to a delete\n    // area disposes of a block and leads to recursive disposal. Break that\n    // cycle.\n    if (this.isEnding_) {\n      return;\n    }\n    Touch.longStop();\n    if (this.dragger) {\n      this.dragger.onDragEnd(this.mostRecentEvent, this.currentDragDeltaXY);\n    } else if (this.workspaceDragger) {\n      this.workspaceDragger.endDrag(this.currentDragDeltaXY);\n    }\n    this.dispose();\n  }\n\n  /**\n   * Handle a real or faked right-click event by showing a context menu.\n   *\n   * @param e A pointerdown event.\n   * @internal\n   */\n  handleRightClick(e: PointerEvent) {\n    if (this.targetBlock) {\n      this.bringBlockToFront();\n      this.targetBlock.workspace.hideChaff(!!this.flyout);\n      this.targetBlock.showContextMenu(e);\n    } else if (this.startBubble) {\n      this.startBubble.showContextMenu(e);\n    } else if (this.startComment) {\n      this.startComment.workspace.hideChaff();\n      this.startComment.showContextMenu(e);\n    } else if (this.startWorkspace_ && !this.flyout) {\n      this.startWorkspace_.hideChaff();\n      this.startWorkspace_.showContextMenu(e);\n    }\n\n    // TODO: Handle right-click on a bubble.\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.dispose();\n  }\n\n  /**\n   * Handle a pointerdown event on a workspace.\n   *\n   * @param e A pointerdown event.\n   * @param ws The workspace the event hit.\n   * @internal\n   */\n  handleWsStart(e: PointerEvent, ws: WorkspaceSvg) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.handleWsStart, ' +\n          'but the gesture had already been started.',\n      );\n    }\n    this.setStartWorkspace(ws);\n    this.mostRecentEvent = e;\n\n    if (!this.startBlock && !this.startBubble && !this.startComment) {\n      // Selection determines what things start drags. So to drag the workspace,\n      // we need to deselect anything that was previously selected.\n      common.setSelected(null);\n    }\n\n    this.doStart(e);\n  }\n\n  /**\n   * Fires a workspace click event.\n   *\n   * @param ws The workspace that a user clicks on.\n   */\n  private fireWorkspaceClick(ws: WorkspaceSvg) {\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.CLICK))(null, ws.id, 'workspace'),\n    );\n  }\n\n  /**\n   * Handle a pointerdown event on a flyout.\n   *\n   * @param e A pointerdown event.\n   * @param flyout The flyout the event hit.\n   * @internal\n   */\n  handleFlyoutStart(e: PointerEvent, flyout: IFlyout) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.handleFlyoutStart, ' +\n          'but the gesture had already been started.',\n      );\n    }\n    this.setStartFlyout(flyout);\n    this.handleWsStart(e, flyout.getWorkspace());\n  }\n\n  /**\n   * Handle a pointerdown event on a block.\n   *\n   * @param e A pointerdown event.\n   * @param block The block the event hit.\n   * @internal\n   */\n  handleBlockStart(e: PointerEvent, block: BlockSvg) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.handleBlockStart, ' +\n          'but the gesture had already been started.',\n      );\n    }\n    this.setStartBlock(block);\n    this.mostRecentEvent = e;\n  }\n\n  /**\n   * Handle a pointerdown event on a bubble.\n   *\n   * @param e A pointerdown event.\n   * @param bubble The bubble the event hit.\n   * @internal\n   */\n  handleBubbleStart(e: PointerEvent, bubble: IBubble) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.handleBubbleStart, ' +\n          'but the gesture had already been started.',\n      );\n    }\n    this.setStartBubble(bubble);\n    this.mostRecentEvent = e;\n  }\n\n  /**\n   * Handle a pointerdown event on a workspace comment.\n   *\n   * @param e A pointerdown event.\n   * @param comment The comment the event hit.\n   * @internal\n   */\n  handleCommentStart(e: PointerEvent, comment: RenderedWorkspaceComment) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.handleCommentStart, ' +\n          'but the gesture had already been started.',\n      );\n    }\n    this.setStartComment(comment);\n    this.mostRecentEvent = e;\n  }\n\n  /* Begin functions defining what actions to take to execute clicks on each\n   * type of target.  Any developer wanting to add behaviour on clicks should\n   * modify only this code. */\n\n  /** Execute a field click. */\n  private doFieldClick() {\n    if (!this.startField) {\n      throw new Error(\n        'Cannot do a field click because the start field is undefined',\n      );\n    }\n\n    // Only show the editor if the field's editor wasn't already open\n    // right before this gesture started.\n    const dropdownAlreadyOpen = this.currentDropdownOwner === this.startField;\n    if (!dropdownAlreadyOpen) {\n      this.startField.showEditor(this.mostRecentEvent);\n    }\n    this.bringBlockToFront();\n  }\n\n  /** Execute an icon click. */\n  private doIconClick() {\n    if (!this.startIcon) {\n      throw new Error(\n        'Cannot do an icon click because the start icon is undefined',\n      );\n    }\n    this.bringBlockToFront();\n    this.startIcon.onClick();\n  }\n\n  /** Execute a block click. */\n  private doBlockClick() {\n    // Block click in an autoclosing flyout.\n    if (this.flyout && this.flyout.autoClose) {\n      if (!this.targetBlock) {\n        throw new Error(\n          'Cannot do a block click because the target block is ' + 'undefined',\n        );\n      }\n      if (this.targetBlock.isEnabled()) {\n        if (!eventUtils.getGroup()) {\n          eventUtils.setGroup(true);\n        }\n        const newBlock = this.flyout.createBlock(this.targetBlock);\n        newBlock.snapToGrid();\n        newBlock.bumpNeighbours();\n      }\n    } else {\n      if (!this.startWorkspace_) {\n        throw new Error(\n          'Cannot do a block click because the start workspace ' +\n            'is undefined',\n        );\n      }\n      // Clicks events are on the start block, even if it was a shadow.\n      const event = new (eventUtils.get(eventUtils.CLICK))(\n        this.startBlock,\n        this.startWorkspace_.id,\n        'block',\n      );\n      eventUtils.fire(event);\n    }\n    this.bringBlockToFront();\n    eventUtils.setGroup(false);\n  }\n\n  /**\n   * Execute a workspace click. When in accessibility mode shift clicking will\n   * move the cursor.\n   *\n   * @param _e A pointerup event.\n   */\n  private doWorkspaceClick(_e: PointerEvent) {\n    const ws = this.creatorWorkspace;\n    if (common.getSelected()) {\n      common.getSelected()!.unselect();\n    }\n    this.fireWorkspaceClick(this.startWorkspace_ || ws);\n  }\n\n  /* End functions defining what actions to take to execute clicks on each type\n   * of target. */\n\n  // TODO (fenichel): Move bubbles to the front.\n\n  /**\n   * Move the dragged/clicked block to the front of the workspace so that it is\n   * not occluded by other blocks.\n   */\n  private bringBlockToFront() {\n    // Blocks in the flyout don't overlap, so skip the work.\n    if (this.targetBlock && !this.flyout) {\n      this.targetBlock.bringToFront();\n    }\n  }\n\n  /* Begin functions for populating a gesture at pointerdown. */\n\n  /**\n   * Record the field that a gesture started on.\n   *\n   * @param field The field the gesture started on.\n   * @internal\n   */\n  setStartField<T>(field: Field<T>) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.setStartField, ' +\n          'but the gesture had already been started.',\n      );\n    }\n    if (!this.startField) {\n      this.startField = field as Field;\n    }\n  }\n\n  /**\n   * Record the icon that a gesture started on.\n   *\n   * @param icon The icon the gesture started on.\n   * @internal\n   */\n  setStartIcon(icon: IIcon) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.setStartIcon, ' +\n          'but the gesture had already been started.',\n      );\n    }\n\n    if (!this.startIcon) this.startIcon = icon;\n  }\n\n  /**\n   * Record the bubble that a gesture started on\n   *\n   * @param bubble The bubble the gesture started on.\n   * @internal\n   */\n  setStartBubble(bubble: IBubble) {\n    if (!this.startBubble) {\n      this.startBubble = bubble;\n    }\n  }\n\n  /**\n   * Record the comment that a gesture started on\n   *\n   * @param comment The comment the gesture started on.\n   * @internal\n   */\n  setStartComment(comment: RenderedWorkspaceComment) {\n    if (!this.startComment) {\n      this.startComment = comment;\n    }\n  }\n\n  /**\n   * Record the block that a gesture started on, and set the target block\n   * appropriately.\n   *\n   * @param block The block the gesture started on.\n   * @internal\n   */\n  setStartBlock(block: BlockSvg) {\n    // If the gesture already went through a bubble, don't set the start block.\n    if (!this.startBlock && !this.startBubble) {\n      this.startBlock = block;\n      common.setSelected(this.startBlock);\n      if (block.isInFlyout && block !== block.getRootBlock()) {\n        this.setTargetBlock(block.getRootBlock());\n      } else {\n        this.setTargetBlock(block);\n      }\n    }\n  }\n\n  /**\n   * Record the block that a gesture targets, meaning the block that will be\n   * dragged if this turns into a drag.  If this block is a shadow, that will be\n   * its first non-shadow parent.\n   *\n   * @param block The block the gesture targets.\n   */\n  private setTargetBlock(block: BlockSvg) {\n    if (block.isShadow()) {\n      // Non-null assertion is fine b/c it is an invariant that shadows always\n      // have parents.\n      this.setTargetBlock(block.getParent()!);\n    } else {\n      this.targetBlock = block;\n    }\n  }\n\n  /**\n   * Record the workspace that a gesture started on.\n   *\n   * @param ws The workspace the gesture started on.\n   */\n  private setStartWorkspace(ws: WorkspaceSvg) {\n    if (!this.startWorkspace_) {\n      this.startWorkspace_ = ws;\n    }\n  }\n\n  /**\n   * Record the flyout that a gesture started on.\n   *\n   * @param flyout The flyout the gesture started on.\n   */\n  private setStartFlyout(flyout: IFlyout) {\n    if (!this.flyout) {\n      this.flyout = flyout;\n    }\n  }\n\n  /* End functions for populating a gesture at pointerdown. */\n\n  /* Begin helper functions defining types of clicks.  Any developer wanting\n   * to change the definition of a click should modify only this code. */\n\n  /**\n   * Whether this gesture is a click on a bubble.  This should only be called\n   * when ending a gesture (pointerup).\n   *\n   * @returns Whether this gesture was a click on a bubble.\n   */\n  private isBubbleClick(): boolean {\n    // A bubble click starts on a bubble and never escapes the drag radius.\n    const hasStartBubble = !!this.startBubble;\n    return hasStartBubble && !this.hasExceededDragRadius;\n  }\n\n  private isCommentClick(): boolean {\n    return !!this.startComment && !this.hasExceededDragRadius;\n  }\n\n  /**\n   * Whether this gesture is a click on a block.  This should only be called\n   * when ending a gesture (pointerup).\n   *\n   * @returns Whether this gesture was a click on a block.\n   */\n  private isBlockClick(): boolean {\n    // A block click starts on a block, never escapes the drag radius, and is\n    // not a field click.\n    const hasStartBlock = !!this.startBlock;\n    return (\n      hasStartBlock &&\n      !this.hasExceededDragRadius &&\n      !this.isFieldClick() &&\n      !this.isIconClick()\n    );\n  }\n\n  /**\n   * Whether this gesture is a click on a field that should be handled.  This should only be called\n   * when ending a gesture (pointerup).\n   *\n   * @returns Whether this gesture was a click on a field.\n   */\n  private isFieldClick(): boolean {\n    if (!this.startField) return false;\n    return (\n      this.startField.isClickable() &&\n      !this.hasExceededDragRadius &&\n      (!this.flyout ||\n        this.startField.isClickableInFlyout(this.flyout.autoClose))\n    );\n  }\n\n  /** @returns Whether this gesture is a click on an icon that should be handled. */\n  private isIconClick(): boolean {\n    if (!this.startIcon) return false;\n    const handleInFlyout =\n      !this.flyout ||\n      !this.startIcon.isClickableInFlyout ||\n      this.startIcon.isClickableInFlyout(this.flyout.autoClose);\n    return !this.hasExceededDragRadius && handleInFlyout;\n  }\n\n  /**\n   * Whether this gesture is a click on a workspace.  This should only be called\n   * when ending a gesture (pointerup).\n   *\n   * @returns Whether this gesture was a click on a workspace.\n   */\n  private isWorkspaceClick(): boolean {\n    const onlyTouchedWorkspace =\n      !this.startBlock && !this.startBubble && !this.startField;\n    return onlyTouchedWorkspace && !this.hasExceededDragRadius;\n  }\n\n  /* End helper functions defining types of clicks. */\n\n  /** Returns the current dragger if the gesture is a drag. */\n  getCurrentDragger(): WorkspaceDragger | IDragger | null {\n    return this.workspaceDragger ?? this.dragger ?? null;\n  }\n\n  /**\n   * Whether this gesture is a drag of either a workspace or block.\n   * This function is called externally to block actions that cannot be taken\n   * mid-drag (e.g. using the keyboard to delete the selected blocks).\n   *\n   * @returns True if this gesture is a drag of a workspace or block.\n   * @internal\n   */\n  isDragging(): boolean {\n    return this.dragging;\n  }\n\n  /**\n   * Whether this gesture has already been started.  In theory every pointerdown\n   * has a corresponding pointerup, but in reality it is possible to lose a\n   * pointerup, leaving an in-process gesture hanging.\n   *\n   * @returns Whether this gesture was a click on a workspace.\n   * @internal\n   */\n  hasStarted(): boolean {\n    return this.gestureHasStarted;\n  }\n\n  /**\n   * Is a drag or other gesture currently in progress on any workspace?\n   *\n   * @returns True if gesture is occurring.\n   */\n  static inProgress(): boolean {\n    const workspaces = common.getAllWorkspaces();\n    for (let i = 0, workspace; (workspace = workspaces[i]); i++) {\n      // Not actually necessarily a WorkspaceSvg, but it doesn't matter b/c\n      // we're just checking if the property exists. Theoretically we would\n      // want to use instanceof, but that causes a circular dependency.\n      if ((workspace as WorkspaceSvg).currentGesture_) {\n        return true;\n      }\n    }\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object for configuring and updating a workspace grid in\n * Blockly.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Grid\n\nimport * as dom from './utils/dom.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport {Svg} from './utils/svg.js';\nimport {GridOptions} from './options.js';\n\n/**\n * Class for a workspace's grid.\n */\nexport class Grid {\n  private spacing: number;\n  private length: number;\n  private scale: number = 1;\n  private readonly line1: SVGElement;\n  private readonly line2: SVGElement;\n  private snapToGrid: boolean;\n\n  /**\n   * @param pattern The grid's SVG pattern, created during injection.\n   * @param options A dictionary of normalized options for the grid.\n   *     See grid documentation:\n   *     https://developers.google.com/blockly/guides/configure/web/grid\n   */\n  constructor(\n    private pattern: SVGElement,\n    options: GridOptions,\n  ) {\n    /** The spacing of the grid lines (in px). */\n    this.spacing = options['spacing'] ?? 0;\n\n    /** How long the grid lines should be (in px). */\n    this.length = options['length'] ?? 1;\n\n    /** The horizontal grid line, if it exists. */\n    this.line1 = pattern.firstChild as SVGElement;\n\n    /** The vertical grid line, if it exists. */\n    this.line2 = this.line1 && (this.line1.nextSibling as SVGElement);\n\n    /** Whether blocks should snap to the grid. */\n    this.snapToGrid = options['snap'] ?? false;\n  }\n\n  /**\n   * Sets the spacing between the centers of the grid lines.\n   *\n   * This does not trigger snapping to the newly spaced grid. If you want to\n   * snap blocks to the grid programmatically that needs to be triggered\n   * on individual top-level blocks. The next time a block is dragged and\n   * dropped it will snap to the grid if snapping to the grid is enabled.\n   */\n  setSpacing(spacing: number) {\n    this.spacing = spacing;\n    this.update(this.scale);\n  }\n\n  /**\n   * Get the spacing of the grid points (in px).\n   *\n   * @returns The spacing of the grid points.\n   */\n  getSpacing(): number {\n    return this.spacing;\n  }\n\n  /** Sets the length of the grid lines. */\n  setLength(length: number) {\n    this.length = length;\n    this.update(this.scale);\n  }\n\n  /** Get the length of the grid lines (in px). */\n  getLength(): number {\n    return this.length;\n  }\n\n  /**\n   * Sets whether blocks should snap to the grid or not.\n   *\n   * Setting this to true does not trigger snapping. If you want to snap blocks\n   * to the grid programmatically that needs to be triggered on individual\n   * top-level blocks. The next time a block is dragged and dropped it will\n   * snap to the grid.\n   */\n  setSnapToGrid(snap: boolean) {\n    this.snapToGrid = snap;\n  }\n\n  /**\n   * Whether blocks should snap to the grid.\n   *\n   * @returns True if blocks should snap, false otherwise.\n   */\n  shouldSnap(): boolean {\n    return this.snapToGrid;\n  }\n\n  /**\n   * Get the ID of the pattern element, which should be randomized to avoid\n   * conflicts with other Blockly instances on the page.\n   *\n   * @returns The pattern ID.\n   * @internal\n   */\n  getPatternId(): string {\n    return this.pattern.id;\n  }\n\n  /**\n   * Update the grid with a new scale.\n   *\n   * @param scale The new workspace scale.\n   * @internal\n   */\n  update(scale: number) {\n    this.scale = scale;\n    const safeSpacing = this.spacing * scale;\n\n    this.pattern.setAttribute('width', `${safeSpacing}`);\n    this.pattern.setAttribute('height', `${safeSpacing}`);\n\n    let half = Math.floor(this.spacing / 2) + 0.5;\n    let start = half - this.length / 2;\n    let end = half + this.length / 2;\n\n    half *= scale;\n    start *= scale;\n    end *= scale;\n\n    this.setLineAttributes(this.line1, scale, start, end, half, half);\n    this.setLineAttributes(this.line2, scale, half, half, start, end);\n  }\n\n  /**\n   * Set the attributes on one of the lines in the grid.  Use this to update the\n   * length and stroke width of the grid lines.\n   *\n   * @param line Which line to update.\n   * @param width The new stroke size (in px).\n   * @param x1 The new x start position of the line (in px).\n   * @param x2 The new x end position of the line (in px).\n   * @param y1 The new y start position of the line (in px).\n   * @param y2 The new y end position of the line (in px).\n   */\n  private setLineAttributes(\n    line: SVGElement,\n    width: number,\n    x1: number,\n    x2: number,\n    y1: number,\n    y2: number,\n  ) {\n    if (line) {\n      line.setAttribute('stroke-width', `${width}`);\n      line.setAttribute('x1', `${x1}`);\n      line.setAttribute('y1', `${y1}`);\n      line.setAttribute('x2', `${x2}`);\n      line.setAttribute('y2', `${y2}`);\n    }\n  }\n\n  /**\n   * Move the grid to a new x and y position, and make sure that change is\n   * visible.\n   *\n   * @param x The new x position of the grid (in px).\n   * @param y The new y position of the grid (in px).\n   * @internal\n   */\n  moveTo(x: number, y: number) {\n    this.pattern.setAttribute('x', `${x}`);\n    this.pattern.setAttribute('y', `${y}`);\n  }\n\n  /**\n   * Given a coordinate, return the nearest coordinate aligned to the grid.\n   *\n   * @param xy A workspace coordinate.\n   * @returns Workspace coordinate of nearest grid point.\n   *   If there's no change, return the same coordinate object.\n   */\n  alignXY(xy: Coordinate): Coordinate {\n    const spacing = this.getSpacing();\n    const half = spacing / 2;\n    const x = Math.round(Math.round((xy.x - half) / spacing) * spacing + half);\n    const y = Math.round(Math.round((xy.y - half) / spacing) * spacing + half);\n    if (x === xy.x && y === xy.y) {\n      // No change.\n      return xy;\n    }\n    return new Coordinate(x, y);\n  }\n\n  /**\n   * Create the DOM for the grid described by options.\n   *\n   * @param rnd A random ID to append to the pattern's ID.\n   * @param gridOptions The object containing grid configuration.\n   * @param defs The root SVG element for this workspace's defs.\n   * @returns The SVG element for the grid pattern.\n   * @internal\n   */\n  static createDom(\n    rnd: string,\n    gridOptions: GridOptions,\n    defs: SVGElement,\n  ): SVGElement {\n    /*\n          <pattern id=\"blocklyGridPattern837493\" patternUnits=\"userSpaceOnUse\">\n            <rect stroke=\"#888\" />\n            <rect stroke=\"#888\" />\n          </pattern>\n        */\n    const gridPattern = dom.createSvgElement(\n      Svg.PATTERN,\n      {'id': 'blocklyGridPattern' + rnd, 'patternUnits': 'userSpaceOnUse'},\n      defs,\n    );\n    // x1, y1, x1, x2 properties will be set later in update.\n    if ((gridOptions['length'] ?? 1) > 0 && (gridOptions['spacing'] ?? 0) > 0) {\n      dom.createSvgElement(\n        Svg.LINE,\n        {'stroke': gridOptions['colour']},\n        gridPattern,\n      );\n      if (gridOptions['length'] ?? 1 > 1) {\n        dom.createSvgElement(\n          Svg.LINE,\n          {'stroke': gridOptions['colour']},\n          gridPattern,\n        );\n      }\n    } else {\n      // Edge 16 doesn't handle empty patterns\n      dom.createSvgElement(Svg.LINE, {}, gridPattern);\n    }\n    return gridPattern;\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a theme.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Theme\n\nimport * as registry from './registry.js';\nimport * as object from './utils/object.js';\n\nexport interface ITheme {\n  blockStyles?: {[key: string]: Partial<BlockStyle>};\n  categoryStyles?: {[key: string]: CategoryStyle};\n  componentStyles?: ComponentStyle;\n  fontStyle?: FontStyle;\n  startHats?: boolean;\n  base?: string | Theme;\n  name: string;\n}\n\n/**\n * Class for a theme.\n */\nexport class Theme implements ITheme {\n  /** @internal */\n  blockStyles: {[key: string]: BlockStyle};\n  /** @internal */\n  categoryStyles: {[key: string]: CategoryStyle};\n  /** @internal */\n  componentStyles: ComponentStyle;\n  /** @internal */\n  fontStyle: FontStyle;\n\n  /**\n   * Whether or not to add a 'hat' on top of all blocks with no previous or\n   * output connections.\n   *\n   * @internal\n   */\n  startHats?: boolean = false;\n\n  /**\n   * @param name Theme name.\n   * @param opt_blockStyles A map from style names (strings) to objects with\n   *     style attributes for blocks.\n   * @param opt_categoryStyles A map from style names (strings) to objects with\n   *     style attributes for categories.\n   * @param opt_componentStyles A map of Blockly component names to style value.\n   */\n  constructor(\n    public name: string,\n    opt_blockStyles?: {[key: string]: Partial<BlockStyle>},\n    opt_categoryStyles?: {[key: string]: CategoryStyle},\n    opt_componentStyles?: ComponentStyle,\n  ) {\n    /** The block styles map. */\n    this.blockStyles = opt_blockStyles || Object.create(null);\n\n    /** The category styles map. */\n    this.categoryStyles = opt_categoryStyles || Object.create(null);\n\n    /** The UI components styles map. */\n    this.componentStyles =\n      opt_componentStyles || (Object.create(null) as ComponentStyle);\n\n    /** The font style. */\n    this.fontStyle = Object.create(null) as FontStyle;\n\n    // Register the theme by name.\n    registry.register(registry.Type.THEME, name, this, true);\n  }\n\n  /**\n   * Gets the class name that identifies this theme.\n   *\n   * @returns The CSS class name.\n   * @internal\n   */\n  getClassName(): string {\n    return this.name + '-theme';\n  }\n\n  /**\n   * Overrides or adds a style to the blockStyles map.\n   *\n   * @param blockStyleName The name of the block style.\n   * @param blockStyle The block style.\n   */\n  setBlockStyle(blockStyleName: string, blockStyle: BlockStyle) {\n    this.blockStyles[blockStyleName] = blockStyle;\n  }\n\n  /**\n   * Overrides or adds a style to the categoryStyles map.\n   *\n   * @param categoryStyleName The name of the category style.\n   * @param categoryStyle The category style.\n   */\n  setCategoryStyle(categoryStyleName: string, categoryStyle: CategoryStyle) {\n    this.categoryStyles[categoryStyleName] = categoryStyle;\n  }\n\n  /**\n   * Gets the style for a given Blockly UI component.  If the style value is a\n   * string, we attempt to find the value of any named references.\n   *\n   * @param componentName The name of the component.\n   * @returns The style value.\n   */\n  getComponentStyle(componentName: string): string | null {\n    const style = (this.componentStyles as AnyDuringMigration)[componentName];\n    if (!style) {\n      return null;\n    }\n    if (typeof style === 'string') {\n      const recursiveStyle = this.getComponentStyle(style);\n      if (recursiveStyle) {\n        return recursiveStyle;\n      }\n    }\n    return `${style}`;\n  }\n\n  /**\n   * Configure a specific Blockly UI component with a style value.\n   *\n   * @param componentName The name of the component.\n   * @param styleValue The style value.\n   */\n  setComponentStyle(componentName: string, styleValue: AnyDuringMigration) {\n    (this.componentStyles as AnyDuringMigration)[componentName] = styleValue;\n  }\n\n  /**\n   * Configure a theme's font style.\n   *\n   * @param fontStyle The font style.\n   */\n  setFontStyle(fontStyle: FontStyle) {\n    this.fontStyle = fontStyle;\n  }\n\n  /**\n   * Configure a theme's start hats.\n   *\n   * @param startHats True if the theme enables start hats, false otherwise.\n   */\n  setStartHats(startHats: boolean) {\n    this.startHats = startHats;\n  }\n\n  /**\n   * Define a new Blockly theme.\n   *\n   * @param name The name of the theme.\n   * @param themeObj An object containing theme properties.\n   * @returns A new Blockly theme.\n   */\n  static defineTheme(name: string, themeObj: ITheme): Theme {\n    name = name.toLowerCase();\n    const theme = new Theme(name);\n    let base = themeObj['base'];\n    if (base) {\n      if (typeof base === 'string') {\n        base = registry.getObject(registry.Type.THEME, base) ?? undefined;\n      }\n      if (base instanceof Theme) {\n        object.deepMerge(theme, base);\n        theme.name = name;\n      }\n    }\n\n    object.deepMerge(theme.blockStyles, themeObj['blockStyles']);\n    object.deepMerge(theme.categoryStyles, themeObj['categoryStyles']);\n    object.deepMerge(theme.componentStyles, themeObj['componentStyles']);\n    object.deepMerge(theme.fontStyle, themeObj['fontStyle']);\n    if (themeObj['startHats'] !== null) {\n      theme.startHats = themeObj['startHats'];\n    }\n\n    return theme;\n  }\n}\n\nexport namespace Theme {\n  export interface BlockStyle {\n    colourPrimary: string;\n    colourSecondary: string;\n    colourTertiary: string;\n    hat: string;\n  }\n\n  export interface CategoryStyle {\n    colour: string;\n  }\n\n  export interface ComponentStyle {\n    workspaceBackgroundColour?: string;\n    toolboxBackgroundColour?: string;\n    toolboxForegroundColour?: string;\n    flyoutBackgroundColour?: string;\n    flyoutForegroundColour?: string;\n    flyoutOpacity?: number;\n    scrollbarColour?: string;\n    scrollbarOpacity?: number;\n    insertionMarkerColour?: string;\n    insertionMarkerOpacity?: number;\n    markerColour?: string;\n    cursorColour?: string;\n    selectedGlowColour?: string;\n    selectedGlowOpacity?: number;\n    replacementGlowColour?: string;\n    replacementGlowOpacity?: number;\n  }\n\n  export interface FontStyle {\n    family?: string;\n    weight?: string;\n    size?: number;\n  }\n}\n\nexport type BlockStyle = Theme.BlockStyle;\nexport type CategoryStyle = Theme.CategoryStyle;\nexport type ComponentStyle = Theme.ComponentStyle;\nexport type FontStyle = Theme.FontStyle;\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Themes.Classic\n\nimport {Theme} from '../theme.js';\n\nconst defaultBlockStyles = {\n  'colour_blocks': {'colourPrimary': '20'},\n  'list_blocks': {'colourPrimary': '260'},\n  'logic_blocks': {'colourPrimary': '210'},\n  'loop_blocks': {'colourPrimary': '120'},\n  'math_blocks': {'colourPrimary': '230'},\n  'procedure_blocks': {'colourPrimary': '290'},\n  'text_blocks': {'colourPrimary': '160'},\n  'variable_blocks': {'colourPrimary': '330'},\n  'variable_dynamic_blocks': {'colourPrimary': '310'},\n  'hat_blocks': {'colourPrimary': '330', 'hat': 'cap'},\n};\n\nconst categoryStyles = {\n  'colour_category': {'colour': '20'},\n  'list_category': {'colour': '260'},\n  'logic_category': {'colour': '210'},\n  'loop_category': {'colour': '120'},\n  'math_category': {'colour': '230'},\n  'procedure_category': {'colour': '290'},\n  'text_category': {'colour': '160'},\n  'variable_category': {'colour': '330'},\n  'variable_dynamic_category': {'colour': '310'},\n};\n\n/**\n * Classic theme.\n * Contains multi-coloured border to create shadow effect.\n */\nexport const Classic = new Theme('classic', defaultBlockStyles, categoryStyles);\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object that controls settings for the workspace.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Options\n\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as registry from './registry.js';\nimport {Theme} from './theme.js';\nimport {Classic} from './theme/classic.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport type {Metrics} from './utils/metrics.js';\nimport * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Parse the user-specified options, using reasonable defaults where behaviour\n * is unspecified.\n */\nexport class Options {\n  RTL: boolean;\n  oneBasedIndex: boolean;\n  collapse: boolean;\n  comments: boolean;\n  disable: boolean;\n  readOnly: boolean;\n  maxBlocks: number;\n  maxInstances: {[key: string]: number} | null;\n  modalInputs: boolean;\n  pathToMedia: string;\n  hasCategories: boolean;\n  moveOptions: MoveOptions;\n  /** @deprecated  January 2019 */\n  hasScrollbars: boolean;\n  hasTrashcan: boolean;\n  maxTrashcanContents: number;\n  hasSounds: boolean;\n  hasCss: boolean;\n  horizontalLayout: boolean;\n  languageTree: toolbox.ToolboxInfo | null;\n  gridOptions: GridOptions;\n  zoomOptions: ZoomOptions;\n  toolboxPosition: toolbox.Position;\n  theme: Theme;\n  renderer: string;\n  rendererOverrides: {[rendererConstant: string]: any} | null;\n\n  /**\n   * The SVG element for the grid pattern.\n   * Created during injection.\n   */\n  gridPattern: SVGElement | null = null;\n  parentWorkspace: WorkspaceSvg | null;\n  plugins: {[key: string]: (new (...p1: any[]) => any) | string};\n\n  /**\n   * If set, sets the translation of the workspace to match the scrollbars.\n   * A function that\n   *     sets the translation of the workspace to match the scrollbars. The\n   *     argument Contains an x and/or y property which is a float between 0\n   *     and 1 specifying the degree of scrolling.\n   */\n  setMetrics?: (p1: {x?: number; y?: number}) => void = undefined;\n\n  /**\n   * A function that returns a metrics\n   *     object that describes the current workspace.\n   */\n  getMetrics?: () => Metrics = undefined;\n\n  /**\n   * @param options Dictionary of options.\n   *     Specification:\n   * https://developers.google.com/blockly/guides/get-started/web#configuration\n   */\n  constructor(options: BlocklyOptions) {\n    let toolboxJsonDef = null;\n    let hasCategories = false;\n    let hasTrashcan = false;\n    let hasCollapse = false;\n    let hasComments = false;\n    let hasDisable = false;\n    let hasSounds = false;\n    const readOnly = !!options['readOnly'];\n    if (!readOnly) {\n      toolboxJsonDef = toolbox.convertToolboxDefToJson(\n        options['toolbox'] ?? null,\n      );\n      hasCategories = toolbox.hasCategories(toolboxJsonDef);\n      const rawHasTrashcan = options['trashcan'];\n      hasTrashcan =\n        rawHasTrashcan === undefined ? hasCategories : rawHasTrashcan;\n      const rawHasCollapse = options['collapse'];\n      hasCollapse =\n        rawHasCollapse === undefined ? hasCategories : rawHasCollapse;\n      const rawHasComments = options['comments'];\n      hasComments =\n        rawHasComments === undefined ? hasCategories : rawHasComments;\n      const rawHasDisable = options['disable'];\n      hasDisable = rawHasDisable === undefined ? hasCategories : rawHasDisable;\n      const rawHasSounds = options['sounds'];\n      hasSounds = rawHasSounds === undefined ? true : rawHasSounds;\n    }\n\n    let maxTrashcanContents = options['maxTrashcanContents'];\n    if (hasTrashcan) {\n      if (maxTrashcanContents === undefined) {\n        maxTrashcanContents = 32;\n      }\n    } else {\n      maxTrashcanContents = 0;\n    }\n    const rtl = !!options['rtl'];\n    let horizontalLayout = options['horizontalLayout'];\n    if (horizontalLayout === undefined) {\n      horizontalLayout = false;\n    }\n    const toolboxAtStart = options['toolboxPosition'] !== 'end';\n\n    let toolboxPosition: toolbox.Position;\n    if (horizontalLayout) {\n      toolboxPosition = toolboxAtStart\n        ? toolbox.Position.TOP\n        : toolbox.Position.BOTTOM;\n    } else {\n      toolboxPosition =\n        toolboxAtStart === rtl ? toolbox.Position.RIGHT : toolbox.Position.LEFT;\n    }\n\n    let hasCss = options['css'];\n    if (hasCss === undefined) {\n      hasCss = true;\n    }\n    let pathToMedia = 'https://blockly-demo.appspot.com/static/media/';\n    if (options['media']) {\n      pathToMedia = options['media'].endsWith('/')\n        ? options['media']\n        : options['media'] + '/';\n    }\n    const rawOneBasedIndex = options['oneBasedIndex'];\n    const oneBasedIndex =\n      rawOneBasedIndex === undefined ? true : rawOneBasedIndex;\n    const renderer = options['renderer'] || 'geras';\n\n    const plugins = options['plugins'] || {};\n\n    let modalInputs = options['modalInputs'];\n    if (modalInputs === undefined) {\n      modalInputs = true;\n    }\n\n    this.RTL = rtl;\n    this.oneBasedIndex = oneBasedIndex;\n    this.collapse = hasCollapse;\n    this.comments = hasComments;\n    this.disable = hasDisable;\n    this.readOnly = readOnly;\n    this.maxBlocks = options['maxBlocks'] || Infinity;\n    this.maxInstances = options['maxInstances'] ?? null;\n    this.modalInputs = modalInputs;\n    this.pathToMedia = pathToMedia;\n    this.hasCategories = hasCategories;\n    this.moveOptions = Options.parseMoveOptions_(options, hasCategories);\n    this.hasScrollbars = !!this.moveOptions.scrollbars;\n    this.hasTrashcan = hasTrashcan;\n    this.maxTrashcanContents = maxTrashcanContents;\n    this.hasSounds = hasSounds;\n    this.hasCss = hasCss;\n    this.horizontalLayout = horizontalLayout;\n    this.languageTree = toolboxJsonDef;\n    this.gridOptions = Options.parseGridOptions_(options);\n    this.zoomOptions = Options.parseZoomOptions_(options);\n    this.toolboxPosition = toolboxPosition;\n    this.theme = Options.parseThemeOptions_(options);\n    this.renderer = renderer;\n    this.rendererOverrides = options['rendererOverrides'] ?? null;\n\n    /**\n     * The parent of the current workspace, or null if there is no parent\n     * workspace.  We can assert that this is of type WorkspaceSvg as opposed to\n     * Workspace as this is only used in a rendered workspace.\n     */\n    this.parentWorkspace = options['parentWorkspace'] ?? null;\n\n    /** Map of plugin type to name of registered plugin or plugin class. */\n    this.plugins = plugins;\n  }\n\n  /**\n   * Parse the user-specified move options, using reasonable defaults where\n   *    behaviour is unspecified.\n   *\n   * @param options Dictionary of options.\n   * @param hasCategories Whether the workspace has categories or not.\n   * @returns Normalized move options.\n   */\n  private static parseMoveOptions_(\n    options: BlocklyOptions,\n    hasCategories: boolean,\n  ): MoveOptions {\n    const move = options['move'] || {};\n    const moveOptions = {} as MoveOptions;\n    if (\n      move['scrollbars'] === undefined &&\n      options['scrollbars'] === undefined\n    ) {\n      moveOptions.scrollbars = hasCategories;\n    } else if (typeof move['scrollbars'] === 'object') {\n      moveOptions.scrollbars = {\n        'horizontal': !!move['scrollbars']['horizontal'],\n        'vertical': !!move['scrollbars']['vertical'],\n      };\n      // Convert scrollbars object to boolean if they have the same value.\n      // This allows us to easily check for whether any scrollbars exist using\n      // !!moveOptions.scrollbars.\n      if (\n        moveOptions.scrollbars.horizontal &&\n        moveOptions.scrollbars.vertical\n      ) {\n        moveOptions.scrollbars = true;\n      } else if (\n        !moveOptions.scrollbars.horizontal &&\n        !moveOptions.scrollbars.vertical\n      ) {\n        moveOptions.scrollbars = false;\n      }\n    } else {\n      moveOptions.scrollbars = !!move['scrollbars'] || !!options['scrollbars'];\n    }\n\n    if (!moveOptions.scrollbars || move['wheel'] === undefined) {\n      // Defaults to true if single-direction scroll is enabled.\n      moveOptions.wheel = typeof moveOptions.scrollbars === 'object';\n    } else {\n      moveOptions.wheel = !!move['wheel'];\n    }\n    if (!moveOptions.scrollbars) {\n      moveOptions.drag = false;\n    } else if (move['drag'] === undefined) {\n      // Defaults to true if scrollbars is true.\n      moveOptions.drag = true;\n    } else {\n      moveOptions.drag = !!move['drag'];\n    }\n    return moveOptions;\n  }\n\n  /**\n   * Parse the user-specified zoom options, using reasonable defaults where\n   * behaviour is unspecified.  See zoom documentation:\n   *   https://developers.google.com/blockly/guides/configure/web/zoom\n   *\n   * @param options Dictionary of options.\n   * @returns Normalized zoom options.\n   */\n  private static parseZoomOptions_(options: BlocklyOptions): ZoomOptions {\n    const zoom = options['zoom'] || {};\n    const zoomOptions = {} as ZoomOptions;\n    if (zoom['controls'] === undefined) {\n      zoomOptions.controls = false;\n    } else {\n      zoomOptions.controls = !!zoom['controls'];\n    }\n    if (zoom['wheel'] === undefined) {\n      zoomOptions.wheel = false;\n    } else {\n      zoomOptions.wheel = !!zoom['wheel'];\n    }\n    if (zoom['startScale'] === undefined) {\n      zoomOptions.startScale = 1;\n    } else {\n      zoomOptions.startScale = Number(zoom['startScale']);\n    }\n    if (zoom['maxScale'] === undefined) {\n      zoomOptions.maxScale = 3;\n    } else {\n      zoomOptions.maxScale = Number(zoom['maxScale']);\n    }\n    if (zoom['minScale'] === undefined) {\n      zoomOptions.minScale = 0.3;\n    } else {\n      zoomOptions.minScale = Number(zoom['minScale']);\n    }\n    if (zoom['scaleSpeed'] === undefined) {\n      zoomOptions.scaleSpeed = 1.2;\n    } else {\n      zoomOptions.scaleSpeed = Number(zoom['scaleSpeed']);\n    }\n    if (zoom['pinch'] === undefined) {\n      zoomOptions.pinch = zoomOptions.wheel || zoomOptions.controls;\n    } else {\n      zoomOptions.pinch = !!zoom['pinch'];\n    }\n    return zoomOptions;\n  }\n\n  /**\n   * Parse the user-specified grid options, using reasonable defaults where\n   * behaviour is unspecified. See grid documentation:\n   *   https://developers.google.com/blockly/guides/configure/web/grid\n   *\n   * @param options Dictionary of options.\n   * @returns Normalized grid options.\n   */\n  private static parseGridOptions_(options: BlocklyOptions): GridOptions {\n    const grid = options['grid'] || {};\n    const gridOptions = {} as GridOptions;\n    gridOptions.spacing = Number(grid['spacing']) || 0;\n    gridOptions.colour = grid['colour'] || '#888';\n    gridOptions.length =\n      grid['length'] === undefined ? 1 : Number(grid['length']);\n    gridOptions.snap = gridOptions.spacing > 0 && !!grid['snap'];\n    return gridOptions;\n  }\n\n  /**\n   * Parse the user-specified theme options, using the classic theme as a\n   * default. https://developers.google.com/blockly/guides/configure/web/themes\n   *\n   * @param options Dictionary of options.\n   * @returns A Blockly Theme.\n   */\n  private static parseThemeOptions_(options: BlocklyOptions): Theme {\n    const theme = options['theme'] || Classic;\n    if (typeof theme === 'string') {\n      return registry.getObject(registry.Type.THEME, theme) as Theme;\n    } else if (theme instanceof Theme) {\n      return theme;\n    }\n    return Theme.defineTheme(\n      theme.name || 'builtin' + idGenerator.getNextUniqueId(),\n      theme,\n    );\n  }\n}\n\nexport namespace Options {\n  export interface GridOptions {\n    colour: string;\n    length: number;\n    snap: boolean;\n    spacing: number;\n  }\n\n  export interface MoveOptions {\n    drag: boolean;\n    scrollbars: boolean | ScrollbarOptions;\n    wheel: boolean;\n  }\n\n  export interface ScrollbarOptions {\n    horizontal: boolean;\n    vertical: boolean;\n  }\n\n  export interface ZoomOptions {\n    controls: boolean;\n    maxScale: number;\n    minScale: number;\n    pinch: boolean;\n    scaleSpeed: number;\n    startScale: number;\n    wheel: boolean;\n  }\n}\n\nexport type GridOptions = Options.GridOptions;\nexport type MoveOptions = Options.MoveOptions;\nexport type ScrollbarOptions = Options.ScrollbarOptions;\nexport type ZoomOptions = Options.ZoomOptions;\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility functions for handling variable and procedure names.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Names\n\nimport {Msg} from './msg.js';\n// import * as Procedures from './procedures.js';\nimport type {VariableMap} from './variable_map.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\n\n/**\n * Class for a database of entity names (variables, procedures, etc).\n */\nexport class Names {\n  static DEVELOPER_VARIABLE_TYPE: NameType;\n  private readonly variablePrefix: string;\n\n  /** A set of reserved words. */\n  private readonly reservedWords: Set<string>;\n\n  /**\n   * A map from type (e.g. name, procedure) to maps from names to generated\n   * names.\n   */\n  private readonly db = new Map<string, Map<string, string>>();\n\n  /** A set of used names to avoid collisions. */\n  private readonly dbReverse = new Set<string>();\n\n  /**\n   * The variable map from the workspace, containing Blockly variable models.\n   */\n  private variableMap: VariableMap | null = null;\n\n  /**\n   * @param reservedWordsList A comma-separated string of words that are illegal\n   *     for use as names in a language (e.g. 'new,if,this,...').\n   * @param opt_variablePrefix Some languages need a '$' or a namespace before\n   *     all variable names (but not procedure names).\n   */\n  constructor(reservedWordsList: string, opt_variablePrefix?: string) {\n    /** The prefix to attach to variable names in generated code. */\n    this.variablePrefix = opt_variablePrefix || '';\n\n    this.reservedWords = new Set<string>(\n      reservedWordsList ? reservedWordsList.split(',') : [],\n    );\n  }\n\n  /**\n   * Empty the database and start from scratch.  The reserved words are kept.\n   */\n  reset() {\n    this.db.clear();\n    this.dbReverse.clear();\n    this.variableMap = null;\n  }\n\n  /**\n   * Set the variable map that maps from variable name to variable object.\n   *\n   * @param map The map to track.\n   */\n  setVariableMap(map: VariableMap) {\n    this.variableMap = map;\n  }\n\n  /**\n   * Get the name for a user-defined variable, based on its ID.\n   * This should only be used for variables of NameType VARIABLE.\n   *\n   * @param id The ID to look up in the variable map.\n   * @returns The name of the referenced variable, or null if there was no\n   *     variable map or the variable was not found in the map.\n   */\n  private getNameForUserVariable(id: string): string | null {\n    if (!this.variableMap) {\n      console.warn(\n        'Deprecated call to Names.prototype.getName without ' +\n          'defining a variable map. To fix, add the following code in your ' +\n          \"generator's init() function:\\n\" +\n          'Blockly.YourGeneratorName.nameDB_.setVariableMap(' +\n          'workspace.getVariableMap());',\n      );\n      return null;\n    }\n    const variable = this.variableMap.getVariableById(id);\n    if (variable) {\n      return variable.name;\n    }\n    return null;\n  }\n\n  /**\n   * Generate names for user variables, but only ones that are being used.\n   *\n   * @param workspace Workspace to generate variables from.\n   */\n  populateVariables(workspace: Workspace) {\n    const variables = Variables.allUsedVarModels(workspace);\n    for (let i = 0; i < variables.length; i++) {\n      this.getName(variables[i].getId(), NameType.VARIABLE);\n    }\n  }\n\n  /**\n   * Generate names for procedures.\n   *\n   * @param workspace Workspace to generate procedures from.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  populateProcedures(workspace: Workspace) {\n    throw new Error(\n      'The implementation of populateProcedures should be ' +\n        'monkey-patched in by blockly.ts',\n    );\n  }\n\n  /**\n   * Convert a Blockly entity name to a legal exportable entity name.\n   *\n   * @param nameOrId The Blockly entity name (no constraints) or variable ID.\n   * @param type The type of the name in Blockly ('VARIABLE', 'PROCEDURE',\n   *     'DEVELOPER_VARIABLE', etc...).\n   * @returns An entity name that is legal in the exported language.\n   */\n  getName(nameOrId: string, type: NameType | string): string {\n    let name = nameOrId;\n    if (type === NameType.VARIABLE) {\n      const varName = this.getNameForUserVariable(nameOrId);\n      if (varName) {\n        // Successful ID lookup.\n        name = varName;\n      }\n    }\n    const normalizedName = name.toLowerCase();\n\n    const isVar =\n      type === NameType.VARIABLE || type === NameType.DEVELOPER_VARIABLE;\n\n    const prefix = isVar ? this.variablePrefix : '';\n    if (!this.db.has(type)) {\n      this.db.set(type, new Map<string, string>());\n    }\n    const typeDb = this.db.get(type);\n    if (typeDb!.has(normalizedName)) {\n      return prefix + typeDb!.get(normalizedName);\n    }\n    const safeName = this.getDistinctName(name, type);\n    typeDb!.set(normalizedName, safeName.substr(prefix.length));\n    return safeName;\n  }\n\n  /**\n   * Return a list of all known user-created names of a specified name type.\n   *\n   * @param type The type of entity in Blockly ('VARIABLE', 'PROCEDURE',\n   *     'DEVELOPER_VARIABLE', etc...).\n   * @returns A list of Blockly entity names (no constraints).\n   */\n  getUserNames(type: NameType | string): string[] {\n    const userNames = this.db.get(type)?.keys();\n    return userNames ? Array.from(userNames) : [];\n  }\n\n  /**\n   * Convert a Blockly entity name to a legal exportable entity name.\n   * Ensure that this is a new name not overlapping any previously defined name.\n   * Also check against list of reserved words for the current language and\n   * ensure name doesn't collide.\n   *\n   * @param name The Blockly entity name (no constraints).\n   * @param type The type of entity in Blockly ('VARIABLE', 'PROCEDURE',\n   *     'DEVELOPER_VARIABLE', etc...).\n   * @returns An entity name that is legal in the exported language.\n   */\n  getDistinctName(name: string, type: NameType | string): string {\n    let safeName = this.safeName(name);\n    let i: number | null = null;\n    while (\n      this.dbReverse.has(safeName + (i ?? '')) ||\n      this.reservedWords.has(safeName + (i ?? ''))\n    ) {\n      // Collision with existing name.  Create a unique name.\n      i = i ? i + 1 : 2;\n    }\n    safeName += i ?? '';\n    this.dbReverse.add(safeName);\n    const isVar =\n      type === NameType.VARIABLE || type === NameType.DEVELOPER_VARIABLE;\n    const prefix = isVar ? this.variablePrefix : '';\n    return prefix + safeName;\n  }\n\n  /**\n   * Given a proposed entity name, generate a name that conforms to the\n   * [_A-Za-z][_A-Za-z0-9]* format that most languages consider legal for\n   * variable and function names.\n   *\n   * @param name Potentially illegal entity name.\n   * @returns Safe entity name.\n   */\n  private safeName(name: string): string {\n    if (!name) {\n      name = Msg['UNNAMED_KEY'] || 'unnamed';\n    } else {\n      // Unfortunately names in non-latin characters will look like\n      // _E9_9F_B3_E4_B9_90 which is pretty meaningless.\n      // https://github.com/google/blockly/issues/1654\n      name = encodeURI(name.replace(/ /g, '_')).replace(/[^\\w]/g, '_');\n      // Most languages don't allow names with leading numbers.\n      if ('0123456789'.includes(name[0])) {\n        name = 'my_' + name;\n      }\n    }\n    return name;\n  }\n\n  /**\n   * Do the given two entity names refer to the same entity?\n   * Blockly names are case-insensitive.\n   *\n   * @param name1 First name.\n   * @param name2 Second name.\n   * @returns True if names are the same.\n   */\n  static equals(name1: string, name2: string): boolean {\n    // name1.localeCompare(name2) is slower.\n    return name1.toLowerCase() === name2.toLowerCase();\n  }\n}\n\nexport namespace Names {\n  /**\n   * Enum for the type of a name. Different name types may have different rules\n   * about collisions.\n   * When JavaScript (or most other languages) is generated, variable 'foo' and\n   * procedure 'foo' would collide.  However, Blockly has no such problems since\n   * variable get 'foo' and procedure call 'foo' are unambiguous.\n   * Therefore, Blockly keeps a separate name type to disambiguate.\n   * getName('foo', 'VARIABLE') = 'foo'\n   * getName('foo', 'PROCEDURE') = 'foo2'\n   *\n   */\n  export enum NameType {\n    DEVELOPER_VARIABLE = 'DEVELOPER_VARIABLE',\n    VARIABLE = 'VARIABLE',\n    PROCEDURE = 'PROCEDURE',\n  }\n}\n\nexport type NameType = Names.NameType;\nexport const NameType = Names.NameType;\n\n/**\n * Constant to separate developer variable names from user-defined variable\n * names when running generators.\n * A developer variable will be declared as a global in the generated code, but\n * will never be shown to the user in the workspace or stored in the variable\n * map.\n */\nNames.DEVELOPER_VARIABLE_TYPE = NameType.DEVELOPER_VARIABLE;\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IProcedureMap} from './interfaces/i_procedure_map.js';\nimport type {IProcedureModel} from './interfaces/i_procedure_model.js';\nimport {isObservable} from './interfaces/i_observable.js';\n\nexport class ObservableProcedureMap\n  extends Map<string, IProcedureModel>\n  implements IProcedureMap\n{\n  /** @internal */\n  constructor() {\n    super();\n  }\n\n  /**\n   * Adds the given procedure model to the procedure map.\n   */\n  override set(id: string, proc: IProcedureModel): this {\n    if (this.get(id) === proc) return this;\n    super.set(id, proc);\n    if (isObservable(proc)) proc.startPublishing();\n    return this;\n  }\n\n  /**\n   * Deletes the ProcedureModel with the given ID from the procedure map (if it\n   * exists).\n   */\n  override delete(id: string): boolean {\n    const proc = this.get(id);\n    const existed = super.delete(id);\n    if (!existed) return existed;\n    if (isObservable(proc)) proc.stopPublishing();\n    return existed;\n  }\n\n  /**\n   * Removes all ProcedureModels from the procedure map.\n   */\n  override clear() {\n    if (!this.size) return;\n    for (const id of this.keys()) {\n      this.delete(id);\n    }\n  }\n\n  /**\n   * Adds the given ProcedureModel to the map of procedure models, so that\n   * blocks can find it.\n   */\n  add(proc: IProcedureModel): this {\n    return this.set(proc.getId(), proc);\n  }\n\n  /**\n   * Returns all of the procedures stored in this map.\n   */\n  getProcedures(): IProcedureModel[] {\n    return [...this.values()];\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport * as browserEvents from '../browser_events.js';\nimport {hasBubble} from '../interfaces/i_has_bubble.js';\nimport type {IIcon} from '../interfaces/i_icon.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport type {IconType} from './icon_types.js';\nimport * as tooltip from '../tooltip.js';\n\n/**\n * The abstract icon class. Icons are visual elements that live in the top-start\n * corner of the block. Usually they provide more \"meta\" information about a\n * block (such as warnings or comments) as opposed to fields, which provide\n * \"actual\" information, related to how a block functions.\n */\nexport abstract class Icon implements IIcon {\n  /**\n   * The position of this icon relative to its blocks top-start,\n   * in workspace units.\n   */\n  protected offsetInBlock: Coordinate = new Coordinate(0, 0);\n\n  /** The position of this icon in workspace coordinates. */\n  protected workspaceLocation: Coordinate = new Coordinate(0, 0);\n\n  /** The root svg element visually representing this icon. */\n  protected svgRoot: SVGGElement | null = null;\n\n  /** The tooltip for this icon. */\n  protected tooltip: tooltip.TipInfo;\n\n  constructor(protected sourceBlock: Block) {\n    this.tooltip = sourceBlock;\n  }\n\n  getType(): IconType<IIcon> {\n    throw new Error('Icons must implement getType');\n  }\n\n  initView(pointerdownListener: (e: PointerEvent) => void): void {\n    if (this.svgRoot) return; // The icon has already been initialized.\n\n    const svgBlock = this.sourceBlock as BlockSvg;\n    this.svgRoot = dom.createSvgElement(Svg.G, {'class': 'blocklyIconGroup'});\n    svgBlock.getSvgRoot().appendChild(this.svgRoot);\n    this.updateSvgRootOffset();\n    browserEvents.conditionalBind(\n      this.svgRoot,\n      'pointerdown',\n      this,\n      pointerdownListener,\n    );\n    (this.svgRoot as any).tooltip = this;\n    tooltip.bindMouseEvents(this.svgRoot);\n  }\n\n  dispose(): void {\n    tooltip.unbindMouseEvents(this.svgRoot);\n    dom.removeNode(this.svgRoot);\n  }\n\n  getWeight(): number {\n    return -1;\n  }\n\n  getSize(): Size {\n    return new Size(0, 0);\n  }\n\n  /**\n   * Sets the tooltip for this icon to the given value. Null to show the\n   * tooltip of the block.\n   */\n  setTooltip(tip: tooltip.TipInfo | null) {\n    this.tooltip = tip ?? this.sourceBlock;\n  }\n\n  /** Returns the tooltip for this icon. */\n  getTooltip(): tooltip.TipInfo {\n    return this.tooltip;\n  }\n\n  applyColour(): void {}\n\n  updateEditable(): void {}\n\n  updateCollapsed(): void {\n    if (!this.svgRoot) return;\n    if (this.sourceBlock.isCollapsed()) {\n      this.svgRoot.style.display = 'none';\n    } else {\n      this.svgRoot.style.display = 'block';\n    }\n    if (hasBubble(this)) {\n      this.setBubbleVisible(false);\n    }\n  }\n\n  hideForInsertionMarker(): void {\n    if (!this.svgRoot) return;\n    this.svgRoot.style.display = 'none';\n  }\n\n  isShownWhenCollapsed(): boolean {\n    return false;\n  }\n\n  setOffsetInBlock(offset: Coordinate): void {\n    this.offsetInBlock = offset;\n    this.updateSvgRootOffset();\n  }\n\n  private updateSvgRootOffset(): void {\n    this.svgRoot?.setAttribute(\n      'transform',\n      `translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`,\n    );\n  }\n\n  onLocationChange(blockOrigin: Coordinate): void {\n    this.workspaceLocation = Coordinate.sum(blockOrigin, this.offsetInBlock);\n  }\n\n  onClick(): void {}\n\n  /**\n   * Check whether the icon should be clickable while the block is in a flyout.\n   * The default is that icons are clickable in all flyouts (auto-closing or not).\n   * Subclasses may override this function to change this behavior.\n   *\n   * @param autoClosingFlyout true if the containing flyout is an auto-closing one.\n   * @returns Whether the icon should be clickable while the block is in a flyout.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  isClickableInFlyout(autoClosingFlyout: boolean): boolean {\n    return true;\n  }\n}\n","/**\n * @license\n * Copyright 2024 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IDragStrategy} from '../interfaces/i_draggable.js';\nimport {Coordinate} from '../utils.js';\nimport * as eventUtils from '../events/utils.js';\nimport {IBubble, WorkspaceSvg} from '../blockly.js';\nimport * as layers from '../layers.js';\n\nexport class BubbleDragStrategy implements IDragStrategy {\n  private startLoc: Coordinate | null = null;\n\n  constructor(\n    private bubble: IBubble,\n    private workspace: WorkspaceSvg,\n  ) {}\n\n  isMovable(): boolean {\n    return true;\n  }\n\n  startDrag(): void {\n    if (!eventUtils.getGroup()) {\n      eventUtils.setGroup(true);\n    }\n    this.startLoc = this.bubble.getRelativeToSurfaceXY();\n    this.workspace.setResizesEnabled(false);\n    this.workspace.getLayerManager()?.moveToDragLayer(this.bubble);\n    this.bubble.setDragging && this.bubble.setDragging(true);\n  }\n\n  drag(newLoc: Coordinate): void {\n    this.bubble.moveDuringDrag(newLoc);\n  }\n\n  endDrag(): void {\n    this.workspace.setResizesEnabled(true);\n    eventUtils.setGroup(false);\n\n    this.workspace\n      .getLayerManager()\n      ?.moveOffDragLayer(this.bubble, layers.BUBBLE);\n    this.bubble.setDragging(false);\n  }\n\n  revertDrag(): void {\n    if (this.startLoc) this.bubble.moveDuringDrag(this.startLoc);\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as browserEvents from '../browser_events.js';\nimport {BubbleDragStrategy} from '../dragging/bubble_drag_strategy.js';\nimport {IBubble} from '../interfaces/i_bubble.js';\nimport {ContainerRegion} from '../metrics_manager.js';\nimport {Scrollbar} from '../scrollbar.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport * as math from '../utils/math.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport * as common from '../common.js';\nimport {ISelectable} from '../blockly.js';\nimport * as idGenerator from '../utils/idgenerator.js';\n\n/**\n * The abstract pop-up bubble class. This creates a UI that looks like a speech\n * bubble, where it has a \"tail\" that points to the block, and a \"head\" that\n * displays arbitrary svg elements.\n */\nexport abstract class Bubble implements IBubble, ISelectable {\n  /** The width of the border around the bubble. */\n  static readonly BORDER_WIDTH = 6;\n\n  /** Double the width of the border around the bubble. */\n  static readonly DOUBLE_BORDER = this.BORDER_WIDTH * 2;\n\n  /** The minimum size the bubble can have. */\n  static readonly MIN_SIZE = this.DOUBLE_BORDER;\n\n  /**\n   * The thickness of the base of the tail in relation to the size of the\n   * bubble. Higher numbers result in thinner tails.\n   */\n  static readonly TAIL_THICKNESS = 1;\n\n  /** The number of degrees that the tail bends counter-clockwise. */\n  static readonly TAIL_ANGLE = 20;\n\n  /**\n   * The sharpness of the tail's bend. Higher numbers result in smoother\n   * tails.\n   */\n  static readonly TAIL_BEND = 4;\n\n  /** Distance between arrow point and anchor point. */\n  static readonly ANCHOR_RADIUS = 8;\n\n  public id: string;\n\n  /** The SVG group containing all parts of the bubble. */\n  protected svgRoot: SVGGElement;\n\n  /** The SVG path for the arrow from the anchor to the bubble. */\n  private tail: SVGPathElement;\n\n  /** The SVG background rect for the main body of the bubble. */\n  private background: SVGRectElement;\n\n  /** The SVG group containing the contents of the bubble. */\n  protected contentContainer: SVGGElement;\n\n  /**\n   * The size of the bubble (including background and contents but not tail).\n   */\n  private size = new Size(0, 0);\n\n  /** The colour of the background of the bubble. */\n  private colour = '#ffffff';\n\n  /** True if the bubble has been disposed, false otherwise. */\n  public disposed = false;\n\n  /** The position of the top of the bubble relative to its anchor. */\n  private relativeTop = 0;\n\n  /** The position of the left of the bubble realtive to its anchor. */\n  private relativeLeft = 0;\n\n  private dragStrategy = new BubbleDragStrategy(this, this.workspace);\n\n  /**\n   * @param workspace The workspace this bubble belongs to.\n   * @param anchor The anchor location of the thing this bubble is attached to.\n   *     The tail of the bubble will point to this location.\n   * @param ownerRect An optional rect we don't want the bubble to overlap with\n   *     when automatically positioning.\n   */\n  constructor(\n    public readonly workspace: WorkspaceSvg,\n    protected anchor: Coordinate,\n    protected ownerRect?: Rect,\n  ) {\n    this.id = idGenerator.getNextUniqueId();\n    this.svgRoot = dom.createSvgElement(\n      Svg.G,\n      {'class': 'blocklyBubble'},\n      workspace.getBubbleCanvas(),\n    );\n    const embossGroup = dom.createSvgElement(\n      Svg.G,\n      {\n        'filter': `url(#${\n          this.workspace.getRenderer().getConstants().embossFilterId\n        })`,\n      },\n      this.svgRoot,\n    );\n    this.tail = dom.createSvgElement(\n      Svg.PATH,\n      {'class': 'blocklyBubbleTail'},\n      embossGroup,\n    );\n    this.background = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyDraggable',\n        'x': 0,\n        'y': 0,\n        'rx': Bubble.BORDER_WIDTH,\n        'ry': Bubble.BORDER_WIDTH,\n      },\n      embossGroup,\n    );\n    this.contentContainer = dom.createSvgElement(Svg.G, {}, this.svgRoot);\n\n    browserEvents.conditionalBind(\n      this.background,\n      'pointerdown',\n      this,\n      this.onMouseDown,\n    );\n  }\n\n  /** Dispose of this bubble. */\n  dispose() {\n    dom.removeNode(this.svgRoot);\n    this.disposed = true;\n  }\n\n  /**\n   * Set the location the tail of this bubble points to.\n   *\n   * @param anchor The location the tail of this bubble points to.\n   * @param relayout If true, reposition the bubble from scratch so that it is\n   *     optimally visible. If false, reposition it so it maintains the same\n   *     position relative to the anchor.\n   */\n  setAnchorLocation(anchor: Coordinate, relayout = false) {\n    this.anchor = anchor;\n    if (relayout) {\n      this.positionByRect(this.ownerRect);\n    } else {\n      this.positionRelativeToAnchor();\n    }\n    this.renderTail();\n  }\n\n  /** Sets the position of this bubble relative to its anchor. */\n  setPositionRelativeToAnchor(left: number, top: number) {\n    this.relativeLeft = left;\n    this.relativeTop = top;\n    this.positionRelativeToAnchor();\n    this.renderTail();\n  }\n\n  /** @returns the size of this bubble. */\n  protected getSize() {\n    return this.size;\n  }\n\n  /**\n   * Sets the size of this bubble, including the border.\n   *\n   * @param size Sets the size of this bubble, including the border.\n   * @param relayout If true, reposition the bubble from scratch so that it is\n   *     optimally visible. If false, reposition it so it maintains the same\n   *     position relative to the anchor.\n   */\n  protected setSize(size: Size, relayout = false) {\n    size.width = Math.max(size.width, Bubble.MIN_SIZE);\n    size.height = Math.max(size.height, Bubble.MIN_SIZE);\n    this.size = size;\n\n    this.background.setAttribute('width', `${size.width}`);\n    this.background.setAttribute('height', `${size.height}`);\n\n    if (relayout) {\n      this.positionByRect(this.ownerRect);\n    } else {\n      this.positionRelativeToAnchor();\n    }\n    this.renderTail();\n  }\n\n  /** Returns the colour of the background and tail of this bubble. */\n  protected getColour(): string {\n    return this.colour;\n  }\n\n  /** Sets the colour of the background and tail of this bubble. */\n  public setColour(colour: string) {\n    this.colour = colour;\n    this.tail.setAttribute('fill', colour);\n    this.background.setAttribute('fill', colour);\n  }\n\n  /** Passes the pointer event off to the gesture system. */\n  private onMouseDown(e: PointerEvent) {\n    this.workspace.getGesture(e)?.handleBubbleStart(e, this);\n    common.setSelected(this);\n  }\n\n  /** Positions the bubble relative to its anchor. Does not render its tail. */\n  protected positionRelativeToAnchor() {\n    let left = this.anchor.x;\n    if (this.workspace.RTL) {\n      left -= this.relativeLeft + this.size.width;\n    } else {\n      left += this.relativeLeft;\n    }\n    const top = this.relativeTop + this.anchor.y;\n    this.moveTo(left, top);\n  }\n\n  /**\n   * Moves the bubble to the given coordinates.\n   *\n   * @internal\n   */\n  moveTo(x: number, y: number) {\n    this.svgRoot.setAttribute('transform', `translate(${x}, ${y})`);\n  }\n\n  /**\n   * Positions the bubble \"optimally\" so that the most of it is visible and\n   * it does not overlap the rect (if provided).\n   */\n  protected positionByRect(rect = new Rect(0, 0, 0, 0)) {\n    const viewMetrics = this.workspace.getMetricsManager().getViewMetrics(true);\n\n    const optimalLeft = this.getOptimalRelativeLeft(viewMetrics);\n    const optimalTop = this.getOptimalRelativeTop(viewMetrics);\n\n    const topPosition = {\n      x: optimalLeft,\n      y: (-this.size.height -\n        this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT) as number,\n    };\n    const startPosition = {x: -this.size.width - 30, y: optimalTop};\n    const endPosition = {x: rect.getWidth(), y: optimalTop};\n    const bottomPosition = {x: optimalLeft, y: rect.getHeight()};\n\n    const closerPosition =\n      rect.getWidth() < rect.getHeight() ? endPosition : bottomPosition;\n    const fartherPosition =\n      rect.getWidth() < rect.getHeight() ? bottomPosition : endPosition;\n\n    const topPositionOverlap = this.getOverlap(topPosition, viewMetrics);\n    const startPositionOverlap = this.getOverlap(startPosition, viewMetrics);\n    const closerPositionOverlap = this.getOverlap(closerPosition, viewMetrics);\n    const fartherPositionOverlap = this.getOverlap(\n      fartherPosition,\n      viewMetrics,\n    );\n\n    // Set the position to whichever position shows the most of the bubble,\n    // with tiebreaks going in the order: top > start > close > far.\n    const mostOverlap = Math.max(\n      topPositionOverlap,\n      startPositionOverlap,\n      closerPositionOverlap,\n      fartherPositionOverlap,\n    );\n    if (topPositionOverlap === mostOverlap) {\n      this.relativeLeft = topPosition.x;\n      this.relativeTop = topPosition.y;\n      this.positionRelativeToAnchor();\n      return;\n    }\n    if (startPositionOverlap === mostOverlap) {\n      this.relativeLeft = startPosition.x;\n      this.relativeTop = startPosition.y;\n      this.positionRelativeToAnchor();\n      return;\n    }\n    if (closerPositionOverlap === mostOverlap) {\n      this.relativeLeft = closerPosition.x;\n      this.relativeTop = closerPosition.y;\n      this.positionRelativeToAnchor();\n      return;\n    }\n    // TODO: I believe relativeLeft_ should actually be called relativeStart_\n    //  and then the math should be fixed to reflect this. (hopefully it'll\n    //  make it look simpler)\n    this.relativeLeft = fartherPosition.x;\n    this.relativeTop = fartherPosition.y;\n    this.positionRelativeToAnchor();\n  }\n\n  /**\n   * Calculate the what percentage of the bubble overlaps with the visible\n   * workspace (what percentage of the bubble is visible).\n   *\n   * @param relativeMin The position of the top-left corner of the bubble\n   *     relative to the anchor point.\n   * @param viewMetrics The view metrics of the workspace the bubble will appear\n   *     in.\n   * @returns The percentage of the bubble that is visible.\n   */\n  private getOverlap(\n    relativeMin: {x: number; y: number},\n    viewMetrics: ContainerRegion,\n  ): number {\n    // The position of the top-left corner of the bubble in workspace units.\n    const bubbleMin = {\n      x: this.workspace.RTL\n        ? this.anchor.x - relativeMin.x - this.size.width\n        : relativeMin.x + this.anchor.x,\n      y: relativeMin.y + this.anchor.y,\n    };\n    // The position of the bottom-right corner of the bubble in workspace units.\n    const bubbleMax = {\n      x: bubbleMin.x + this.size.width,\n      y: bubbleMin.y + this.size.height,\n    };\n\n    // We could adjust these values to account for the scrollbars, but the\n    // bubbles should have been adjusted to not collide with them anyway, so\n    // giving the workspace a slightly larger \"bounding box\" shouldn't affect\n    // the calculation.\n\n    // The position of the top-left corner of the workspace.\n    const workspaceMin = {x: viewMetrics.left, y: viewMetrics.top};\n    // The position of the bottom-right corner of the workspace.\n    const workspaceMax = {\n      x: viewMetrics.left + viewMetrics.width,\n      y: viewMetrics.top + viewMetrics.height,\n    };\n\n    const overlapWidth =\n      Math.min(bubbleMax.x, workspaceMax.x) -\n      Math.max(bubbleMin.x, workspaceMin.x);\n    const overlapHeight =\n      Math.min(bubbleMax.y, workspaceMax.y) -\n      Math.max(bubbleMin.y, workspaceMin.y);\n    return Math.max(\n      0,\n      Math.min(\n        1,\n        (overlapWidth * overlapHeight) / (this.size.width * this.size.height),\n      ),\n    );\n  }\n\n  /**\n   * Calculate what the optimal horizontal position of the top-left corner of\n   * the bubble is (relative to the anchor point) so that the most area of the\n   * bubble is shown.\n   *\n   * @param viewMetrics The view metrics of the workspace the bubble will appear\n   *     in.\n   * @returns The optimal horizontal position of the top-left corner of the\n   *     bubble.\n   */\n  private getOptimalRelativeLeft(viewMetrics: ContainerRegion): number {\n    // By default, show the bubble just a bit to the left of the anchor.\n    let relativeLeft = -this.size.width / 4;\n\n    // No amount of sliding left or right will give us better overlap.\n    if (this.size.width > viewMetrics.width) return relativeLeft;\n\n    const workspaceRect = this.getWorkspaceViewRect(viewMetrics);\n\n    if (this.workspace.RTL) {\n      // Bubble coordinates are flipped in RTL.\n      const bubbleRight = this.anchor.x - relativeLeft;\n      const bubbleLeft = bubbleRight - this.size.width;\n\n      if (bubbleLeft < workspaceRect.left) {\n        // Slide the bubble right until it is onscreen.\n        relativeLeft = -(workspaceRect.left - this.anchor.x + this.size.width);\n      } else if (bubbleRight > workspaceRect.right) {\n        // Slide the bubble left until it is onscreen.\n        relativeLeft = -(workspaceRect.right - this.anchor.x);\n      }\n    } else {\n      const bubbleLeft = relativeLeft + this.anchor.x;\n      const bubbleRight = bubbleLeft + this.size.width;\n\n      if (bubbleLeft < workspaceRect.left) {\n        // Slide the bubble right until it is onscreen.\n        relativeLeft = workspaceRect.left - this.anchor.x;\n      } else if (bubbleRight > workspaceRect.right) {\n        // Slide the bubble left until it is onscreen.\n        relativeLeft = workspaceRect.right - this.anchor.x - this.size.width;\n      }\n    }\n\n    return relativeLeft;\n  }\n\n  /**\n   * Calculate what the optimal vertical position of the top-left corner of\n   * the bubble is (relative to the anchor point) so that the most area of the\n   * bubble is shown.\n   *\n   * @param viewMetrics The view metrics of the workspace the bubble will appear\n   *     in.\n   * @returns The optimal vertical position of the top-left corner of the\n   *     bubble.\n   */\n  private getOptimalRelativeTop(viewMetrics: ContainerRegion): number {\n    // By default, show the bubble just a bit higher than the anchor.\n    let relativeTop = -this.size.height / 4;\n\n    // No amount of sliding up or down will give us better overlap.\n    if (this.size.height > viewMetrics.height) return relativeTop;\n\n    const top = this.anchor.y + relativeTop;\n    const bottom = top + this.size.height;\n    const workspaceRect = this.getWorkspaceViewRect(viewMetrics);\n\n    if (top < workspaceRect.top) {\n      // Slide the bubble down until it is onscreen.\n      relativeTop = workspaceRect.top - this.anchor.y;\n    } else if (bottom > workspaceRect.bottom) {\n      // Slide the bubble up until it is onscreen.\n      relativeTop = workspaceRect.bottom - this.anchor.y - this.size.height;\n    }\n\n    return relativeTop;\n  }\n\n  /**\n   * @returns a rect defining the bounds of the workspace's view in workspace\n   * coordinates.\n   */\n  private getWorkspaceViewRect(viewMetrics: ContainerRegion): Rect {\n    const top = viewMetrics.top;\n    let bottom = viewMetrics.top + viewMetrics.height;\n    let left = viewMetrics.left;\n    let right = viewMetrics.left + viewMetrics.width;\n\n    bottom -= this.getScrollbarThickness();\n    if (this.workspace.RTL) {\n      left -= this.getScrollbarThickness();\n    } else {\n      right -= this.getScrollbarThickness();\n    }\n\n    return new Rect(top, bottom, left, right);\n  }\n\n  /** @returns the scrollbar thickness in workspace units. */\n  private getScrollbarThickness() {\n    return Scrollbar.scrollbarThickness / this.workspace.scale;\n  }\n\n  /** Draws the tail of the bubble. */\n  private renderTail() {\n    const steps = [];\n    // Find the relative coordinates of the center of the bubble.\n    const relBubbleX = this.size.width / 2;\n    const relBubbleY = this.size.height / 2;\n    // Find the relative coordinates of the center of the anchor.\n    let relAnchorX = -this.relativeLeft;\n    let relAnchorY = -this.relativeTop;\n    if (relBubbleX === relAnchorX && relBubbleY === relAnchorY) {\n      // Null case.  Bubble is directly on top of the anchor.\n      // Short circuit this rather than wade through divide by zeros.\n      steps.push('M ' + relBubbleX + ',' + relBubbleY);\n    } else {\n      // Compute the angle of the tail's line.\n      const rise = relAnchorY - relBubbleY;\n      let run = relAnchorX - relBubbleX;\n      if (this.workspace.RTL) {\n        run *= -1;\n      }\n      const hypotenuse = Math.sqrt(rise * rise + run * run);\n      let angle = Math.acos(run / hypotenuse);\n      if (rise < 0) {\n        angle = 2 * Math.PI - angle;\n      }\n      // Compute a line perpendicular to the tail.\n      let rightAngle = angle + Math.PI / 2;\n      if (rightAngle > Math.PI * 2) {\n        rightAngle -= Math.PI * 2;\n      }\n      const rightRise = Math.sin(rightAngle);\n      const rightRun = Math.cos(rightAngle);\n\n      // Calculate the thickness of the base of the tail.\n      let thickness =\n        (this.size.width + this.size.height) / Bubble.TAIL_THICKNESS;\n      thickness = Math.min(thickness, this.size.width, this.size.height) / 4;\n\n      // Back the tip of the tail off of the anchor.\n      const backoffRatio = 1 - Bubble.ANCHOR_RADIUS / hypotenuse;\n      relAnchorX = relBubbleX + backoffRatio * run;\n      relAnchorY = relBubbleY + backoffRatio * rise;\n\n      // Coordinates for the base of the tail.\n      const baseX1 = relBubbleX + thickness * rightRun;\n      const baseY1 = relBubbleY + thickness * rightRise;\n      const baseX2 = relBubbleX - thickness * rightRun;\n      const baseY2 = relBubbleY - thickness * rightRise;\n\n      // Distortion to curve the tail.\n      const radians = math.toRadians(\n        this.workspace.RTL ? -Bubble.TAIL_ANGLE : Bubble.TAIL_ANGLE,\n      );\n      let swirlAngle = angle + radians;\n      if (swirlAngle > Math.PI * 2) {\n        swirlAngle -= Math.PI * 2;\n      }\n      const swirlRise = (Math.sin(swirlAngle) * hypotenuse) / Bubble.TAIL_BEND;\n      const swirlRun = (Math.cos(swirlAngle) * hypotenuse) / Bubble.TAIL_BEND;\n\n      steps.push('M' + baseX1 + ',' + baseY1);\n      steps.push(\n        'C' +\n          (baseX1 + swirlRun) +\n          ',' +\n          (baseY1 + swirlRise) +\n          ' ' +\n          relAnchorX +\n          ',' +\n          relAnchorY +\n          ' ' +\n          relAnchorX +\n          ',' +\n          relAnchorY,\n      );\n      steps.push(\n        'C' +\n          relAnchorX +\n          ',' +\n          relAnchorY +\n          ' ' +\n          (baseX2 + swirlRun) +\n          ',' +\n          (baseY2 + swirlRise) +\n          ' ' +\n          baseX2 +\n          ',' +\n          baseY2,\n      );\n    }\n    steps.push('z');\n    this.tail?.setAttribute('d', steps.join(' '));\n  }\n  /**\n   * Move this bubble to the front of the visible workspace.\n   *\n   * @returns Whether or not the bubble has been moved.\n   * @internal\n   */\n  bringToFront(): boolean {\n    const svgGroup = this.svgRoot?.parentNode;\n    if (this.svgRoot && svgGroup?.lastChild !== this.svgRoot) {\n      svgGroup?.appendChild(this.svgRoot);\n      return true;\n    }\n    return false;\n  }\n\n  /** @internal */\n  getRelativeToSurfaceXY(): Coordinate {\n    return new Coordinate(\n      this.workspace.RTL\n        ? -this.relativeLeft + this.anchor.x - this.size.width\n        : this.anchor.x + this.relativeLeft,\n      this.anchor.y + this.relativeTop,\n    );\n  }\n\n  /** @internal */\n  getSvgRoot(): SVGElement {\n    return this.svgRoot;\n  }\n\n  /**\n   * Move this bubble during a drag.\n   *\n   * @param newLoc The location to translate to, in workspace coordinates.\n   * @internal\n   */\n  moveDuringDrag(newLoc: Coordinate) {\n    this.moveTo(newLoc.x, newLoc.y);\n    if (this.workspace.RTL) {\n      this.relativeLeft = this.anchor.x - newLoc.x - this.size.width;\n    } else {\n      this.relativeLeft = newLoc.x - this.anchor.x;\n    }\n    this.relativeTop = newLoc.y - this.anchor.y;\n    this.renderTail();\n  }\n\n  setDragging(_start: boolean) {\n    // NOOP in base class.\n  }\n\n  /** @internal */\n  setDeleteStyle(_enable: boolean) {\n    // NOOP in base class.\n  }\n\n  /** @internal */\n  isDeletable(): boolean {\n    return false;\n  }\n\n  /** @internal */\n  showContextMenu(_e: Event) {\n    // NOOP in base class.\n  }\n\n  /** Returns whether this bubble is movable or not. */\n  isMovable(): boolean {\n    return true;\n  }\n\n  /** Starts a drag on the bubble. */\n  startDrag(): void {\n    this.dragStrategy.startDrag();\n  }\n\n  /** Drags the bubble to the given location. */\n  drag(newLoc: Coordinate): void {\n    this.dragStrategy.drag(newLoc);\n  }\n\n  /** Ends the drag on the bubble. */\n  endDrag(): void {\n    this.dragStrategy.endDrag();\n  }\n\n  /** Moves the bubble back to where it was at the start of a drag. */\n  revertDrag(): void {\n    this.dragStrategy.revertDrag();\n  }\n\n  select(): void {\n    // Bubbles don't have any visual for being selected.\n  }\n\n  unselect(): void {\n    // Bubbles don't have any visual for being selected.\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Abstract as AbstractEvent} from '../events/events_abstract.js';\nimport type {BlocklyOptions} from '../blockly_options.js';\nimport {Bubble} from './bubble.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport {Options} from '../options.js';\nimport {Svg} from '../utils/svg.js';\nimport type {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\n/**\n * A bubble that contains a mini-workspace which can hold arbitrary blocks.\n * Used by the mutator icon.\n */\nexport class MiniWorkspaceBubble extends Bubble {\n  /**\n   * The minimum amount of change to the mini workspace view to trigger\n   * resizing the bubble.\n   */\n  private static readonly MINIMUM_VIEW_CHANGE = 10;\n\n  /**\n   * An arbitrary margin of whitespace to put around the blocks in the\n   * workspace.\n   */\n  private static readonly MARGIN = Bubble.DOUBLE_BORDER * 3;\n\n  /** The root svg element containing the workspace. */\n  private svgDialog: SVGElement;\n\n  /** The workspace that gets shown within this bubble. */\n  private miniWorkspace: WorkspaceSvg;\n\n  /**\n   * Should this bubble automatically reposition itself when it resizes?\n   * Becomes false after this bubble is first dragged.\n   */\n  private autoLayout = true;\n\n  /** @internal */\n  constructor(\n    workspaceOptions: BlocklyOptions,\n    public readonly workspace: WorkspaceSvg,\n    protected anchor: Coordinate,\n    protected ownerRect?: Rect,\n  ) {\n    super(workspace, anchor, ownerRect);\n    const options = new Options(workspaceOptions);\n    this.validateWorkspaceOptions(options);\n\n    this.svgDialog = dom.createSvgElement(\n      Svg.SVG,\n      {\n        'x': Bubble.BORDER_WIDTH,\n        'y': Bubble.BORDER_WIDTH,\n      },\n      this.contentContainer,\n    );\n    workspaceOptions.parentWorkspace = this.workspace;\n    this.miniWorkspace = this.newWorkspaceSvg(new Options(workspaceOptions));\n    // TODO (#7422): Change this to `internalIsMiniWorkspace` or something. Not\n    //   all mini workspaces are necessarily mutators.\n    this.miniWorkspace.internalIsMutator = true;\n    const background = this.miniWorkspace.createDom('blocklyMutatorBackground');\n    this.svgDialog.appendChild(background);\n    if (options.languageTree) {\n      background.insertBefore(\n        this.miniWorkspace.addFlyout(Svg.G),\n        this.miniWorkspace.getCanvas(),\n      );\n      const flyout = this.miniWorkspace.getFlyout();\n      flyout?.init(this.miniWorkspace);\n      flyout?.show(options.languageTree);\n    }\n\n    this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this));\n    this.miniWorkspace\n      .getFlyout()\n      ?.getWorkspace()\n      ?.addChangeListener(this.onWorkspaceChange.bind(this));\n    this.updateBubbleSize();\n  }\n\n  dispose() {\n    this.miniWorkspace.dispose();\n    super.dispose();\n  }\n\n  /** @internal */\n  getWorkspace(): WorkspaceSvg {\n    return this.miniWorkspace;\n  }\n\n  /** Adds a change listener to the mini workspace. */\n  addWorkspaceChangeListener(listener: (e: AbstractEvent) => void) {\n    this.miniWorkspace.addChangeListener(listener);\n  }\n\n  /**\n   * Validates the workspace options to make sure folks aren't trying to\n   * enable things the miniworkspace doesn't support.\n   */\n  private validateWorkspaceOptions(options: Options) {\n    if (options.hasCategories) {\n      throw new Error(\n        'The miniworkspace bubble does not support toolboxes with categories',\n      );\n    }\n    if (options.hasTrashcan) {\n      throw new Error('The miniworkspace bubble does not support trashcans');\n    }\n    if (\n      options.zoomOptions.controls ||\n      options.zoomOptions.wheel ||\n      options.zoomOptions.pinch\n    ) {\n      throw new Error('The miniworkspace bubble does not support zooming');\n    }\n    if (\n      options.moveOptions.scrollbars ||\n      options.moveOptions.wheel ||\n      options.moveOptions.drag\n    ) {\n      throw new Error(\n        'The miniworkspace bubble does not scrolling/moving the workspace',\n      );\n    }\n    if (options.horizontalLayout) {\n      throw new Error(\n        'The miniworkspace bubble does not support horizontal layouts',\n      );\n    }\n  }\n\n  private onWorkspaceChange() {\n    this.bumpBlocksIntoBounds();\n    this.updateBubbleSize();\n  }\n\n  /**\n   * Bumps blocks that are above the top or outside the start-side of the\n   * workspace back within the workspace.\n   *\n   * Blocks that are below the bottom or outside the end-side of the workspace\n   * are dealt with by resizing the workspace to show them.\n   */\n  private bumpBlocksIntoBounds() {\n    if (this.miniWorkspace.isDragging()) return;\n\n    const MARGIN = 20;\n\n    for (const block of this.miniWorkspace.getTopBlocks(false)) {\n      const blockXY = block.getRelativeToSurfaceXY();\n\n      // Bump any block that's above the top back inside.\n      if (blockXY.y < MARGIN) {\n        block.moveBy(0, MARGIN - blockXY.y);\n      }\n      // Bump any block overlapping the flyout back inside.\n      if (block.RTL) {\n        let right = -MARGIN;\n        const flyout = this.miniWorkspace.getFlyout();\n        if (flyout) {\n          right -= flyout.getWidth();\n        }\n        if (blockXY.x > right) {\n          block.moveBy(right - blockXY.x, 0);\n        }\n      } else if (blockXY.x < MARGIN) {\n        block.moveBy(MARGIN - blockXY.x, 0);\n      }\n    }\n  }\n\n  /**\n   * Updates the size of this bubble to account for the size of the\n   * mini workspace.\n   */\n  private updateBubbleSize() {\n    if (this.miniWorkspace.isDragging()) return;\n\n    const currSize = this.getSize();\n    const newSize = this.calculateWorkspaceSize();\n    if (\n      Math.abs(currSize.width - newSize.width) <\n        MiniWorkspaceBubble.MINIMUM_VIEW_CHANGE &&\n      Math.abs(currSize.height - newSize.height) <\n        MiniWorkspaceBubble.MINIMUM_VIEW_CHANGE\n    ) {\n      // Only resize if the size has noticeably changed.\n      return;\n    }\n    this.svgDialog.setAttribute('width', `${newSize.width}px`);\n    this.svgDialog.setAttribute('height', `${newSize.height}px`);\n    this.miniWorkspace.setCachedParentSvgSize(newSize.width, newSize.height);\n    if (this.miniWorkspace.RTL) {\n      // Scroll the workspace to always left-align.\n      this.miniWorkspace\n        .getCanvas()\n        .setAttribute('transform', `translate(${newSize.width}, 0)`);\n    }\n    this.setSize(\n      new Size(\n        newSize.width + Bubble.DOUBLE_BORDER,\n        newSize.height + Bubble.DOUBLE_BORDER,\n      ),\n      this.autoLayout,\n    );\n    this.miniWorkspace.resize();\n    this.miniWorkspace.recordDragTargets();\n  }\n\n  /**\n   * Calculates the size of the mini workspace for use in resizing the bubble.\n   */\n  private calculateWorkspaceSize(): Size {\n    const workspaceSize = this.miniWorkspace.getCanvas().getBBox();\n    let width = workspaceSize.width + MiniWorkspaceBubble.MARGIN;\n    let height = workspaceSize.height + MiniWorkspaceBubble.MARGIN;\n\n    const flyout = this.miniWorkspace.getFlyout();\n    if (flyout) {\n      const flyoutScrollMetrics = flyout\n        .getWorkspace()\n        .getMetricsManager()\n        .getScrollMetrics();\n      height = Math.max(height, flyoutScrollMetrics.height + 20);\n      width += flyout.getWidth();\n    }\n    return new Size(width, height);\n  }\n\n  /** Reapplies styles to all of the blocks in the mini workspace. */\n  updateBlockStyles() {\n    for (const block of this.miniWorkspace.getAllBlocks(false)) {\n      block.setStyle(block.getStyleName());\n    }\n\n    const flyoutWs = this.miniWorkspace.getFlyout()?.getWorkspace();\n    if (flyoutWs) {\n      for (const block of flyoutWs.getAllBlocks(false)) {\n        block.setStyle(block.getStyleName());\n      }\n    }\n  }\n\n  /**\n   * Move this bubble during a drag.\n   *\n   * @param newLoc The location to translate to, in workspace coordinates.\n   * @internal\n   */\n  moveDuringDrag(newLoc: Coordinate): void {\n    super.moveDuringDrag(newLoc);\n    this.autoLayout = false;\n  }\n\n  /** @internal */\n  moveTo(x: number, y: number): void {\n    super.moveTo(x, y);\n    this.miniWorkspace.recordDragTargets();\n  }\n\n  /** @internal */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  newWorkspaceSvg(options: Options): WorkspaceSvg {\n    throw new Error(\n      'The implementation of newWorkspaceSvg should be ' +\n        'monkey-patched in by blockly.ts',\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Mutator\n\nimport type {Abstract} from '../events/events_abstract.js';\nimport {BlockChange} from '../events/events_block_change.js';\nimport type {BlocklyOptions} from '../blockly_options.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport * as eventUtils from '../events/utils.js';\nimport type {IHasBubble} from '../interfaces/i_has_bubble.js';\nimport {Icon} from './icon.js';\nimport {MiniWorkspaceBubble} from '../bubbles/mini_workspace_bubble.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\nimport {IconType} from './icon_types.js';\nimport * as renderManagement from '../render_management.js';\n\n/** The size of the mutator icon in workspace-scale units. */\nconst SIZE = 17;\n\n/**\n * The distance between the root block in the mini workspace and that\n * workspace's edges.\n */\nconst WORKSPACE_MARGIN = 16;\n\n/**\n * An icon that allows the user to change the shape of the block.\n *\n * For example, it could be used to add additional fields or inputs to\n * the block.\n */\nexport class MutatorIcon extends Icon implements IHasBubble {\n  /** The type string used to identify this icon. */\n  static readonly TYPE = IconType.MUTATOR;\n\n  /**\n   * The weight this icon has relative to other icons. Icons with more positive\n   * weight values are rendered farther toward the end of the block.\n   */\n  static readonly WEIGHT = 1;\n\n  /** The bubble used to show the mini workspace to the user. */\n  private miniWorkspaceBubble: MiniWorkspaceBubble | null = null;\n\n  /** The root block in the mini workspace. */\n  private rootBlock: BlockSvg | null = null;\n\n  /** The PID tracking updating the workkspace in response to user events. */\n  private updateWorkspacePid: ReturnType<typeof setTimeout> | null = null;\n\n  /**\n   * The change listener in the main workspace that triggers the saveConnections\n   * method when anything in the main workspace changes.\n   *\n   * Only actually registered to listen for events while the mutator bubble is\n   * open.\n   */\n  private saveConnectionsListener: (() => void) | null = null;\n\n  constructor(\n    private readonly flyoutBlockTypes: string[],\n    protected readonly sourceBlock: BlockSvg,\n  ) {\n    super(sourceBlock);\n  }\n\n  override getType(): IconType<MutatorIcon> {\n    return MutatorIcon.TYPE;\n  }\n\n  override initView(pointerdownListener: (e: PointerEvent) => void): void {\n    if (this.svgRoot) return; // Already initialized.\n\n    super.initView(pointerdownListener);\n\n    // Square with rounded corners.\n    dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyIconShape',\n        'rx': '4',\n        'ry': '4',\n        'height': '16',\n        'width': '16',\n      },\n      this.svgRoot,\n    );\n    // Gear teeth.\n    dom.createSvgElement(\n      Svg.PATH,\n      {\n        'class': 'blocklyIconSymbol',\n        'd':\n          'm4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,' +\n          '0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,' +\n          '-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,' +\n          '-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,' +\n          '-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 ' +\n          '-0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,' +\n          '0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z',\n      },\n      this.svgRoot,\n    );\n    // Axle hole.\n    dom.createSvgElement(\n      Svg.CIRCLE,\n      {'class': 'blocklyIconShape', 'r': '2.7', 'cx': '8', 'cy': '8'},\n      this.svgRoot,\n    );\n    dom.addClass(this.svgRoot!, 'blockly-icon-mutator');\n  }\n\n  override dispose(): void {\n    super.dispose();\n    this.miniWorkspaceBubble?.dispose();\n  }\n\n  override getWeight(): number {\n    return MutatorIcon.WEIGHT;\n  }\n\n  override getSize(): Size {\n    return new Size(SIZE, SIZE);\n  }\n\n  override applyColour(): void {\n    super.applyColour();\n    this.miniWorkspaceBubble?.setColour(this.sourceBlock.style.colourPrimary);\n    this.miniWorkspaceBubble?.updateBlockStyles();\n  }\n\n  override updateCollapsed(): void {\n    super.updateCollapsed();\n    if (this.sourceBlock.isCollapsed()) this.setBubbleVisible(false);\n  }\n\n  override onLocationChange(blockOrigin: Coordinate): void {\n    super.onLocationChange(blockOrigin);\n    this.miniWorkspaceBubble?.setAnchorLocation(this.getAnchorLocation());\n  }\n\n  override onClick(): void {\n    super.onClick();\n    if (this.sourceBlock.isEditable()) {\n      this.setBubbleVisible(!this.bubbleIsVisible());\n    }\n  }\n\n  override isClickableInFlyout(): boolean {\n    return false;\n  }\n\n  bubbleIsVisible(): boolean {\n    return !!this.miniWorkspaceBubble;\n  }\n\n  async setBubbleVisible(visible: boolean): Promise<void> {\n    if (this.bubbleIsVisible() === visible) return;\n\n    await renderManagement.finishQueuedRenders();\n\n    if (visible) {\n      this.miniWorkspaceBubble = new MiniWorkspaceBubble(\n        this.getMiniWorkspaceConfig(),\n        this.sourceBlock.workspace,\n        this.getAnchorLocation(),\n        this.getBubbleOwnerRect(),\n      );\n      this.applyColour();\n      this.createRootBlock();\n      this.addSaveConnectionsListener();\n      this.miniWorkspaceBubble?.addWorkspaceChangeListener(\n        this.createMiniWorkspaceChangeListener(),\n      );\n    } else {\n      this.miniWorkspaceBubble?.dispose();\n      this.miniWorkspaceBubble = null;\n      if (this.saveConnectionsListener) {\n        this.sourceBlock.workspace.removeChangeListener(\n          this.saveConnectionsListener,\n        );\n      }\n      this.saveConnectionsListener = null;\n    }\n\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BUBBLE_OPEN))(\n        this.sourceBlock,\n        visible,\n        'mutator',\n      ),\n    );\n  }\n\n  /** @returns the configuration the mini workspace should have. */\n  private getMiniWorkspaceConfig() {\n    const options: BlocklyOptions = {\n      'disable': false,\n      'media': this.sourceBlock.workspace.options.pathToMedia,\n      'rtl': this.sourceBlock.RTL,\n      'renderer': this.sourceBlock.workspace.options.renderer,\n      'rendererOverrides':\n        this.sourceBlock.workspace.options.rendererOverrides ?? undefined,\n    };\n\n    if (this.flyoutBlockTypes.length) {\n      options.toolbox = {\n        'kind': 'flyoutToolbox',\n        'contents': this.flyoutBlockTypes.map((type) => ({\n          'kind': 'block',\n          'type': type,\n        })),\n      };\n    }\n\n    return options;\n  }\n\n  /**\n   * @returns the location the bubble should be anchored to.\n   *     I.E. the middle of this icon.\n   */\n  private getAnchorLocation(): Coordinate {\n    const midIcon = SIZE / 2;\n    return Coordinate.sum(\n      this.workspaceLocation,\n      new Coordinate(midIcon, midIcon),\n    );\n  }\n\n  /**\n   * @returns the rect the bubble should avoid overlapping.\n   *     I.E. the block that owns this icon.\n   */\n  private getBubbleOwnerRect(): Rect {\n    const bbox = this.sourceBlock.getSvgRoot().getBBox();\n    return new Rect(bbox.y, bbox.y + bbox.height, bbox.x, bbox.x + bbox.width);\n  }\n\n  /** Decomposes the source block to create blocks in the mini workspace. */\n  private createRootBlock() {\n    if (!this.sourceBlock.decompose) {\n      throw new Error(\n        'Blocks with mutator icons must include a decompose method',\n      );\n    }\n    this.rootBlock = this.sourceBlock.decompose(\n      this.miniWorkspaceBubble!.getWorkspace(),\n    )!;\n\n    for (const child of this.rootBlock.getDescendants(false)) {\n      child.queueRender();\n    }\n\n    this.rootBlock.setMovable(false);\n    this.rootBlock.setDeletable(false);\n\n    const flyoutWidth =\n      this.miniWorkspaceBubble?.getWorkspace()?.getFlyout()?.getWidth() ?? 0;\n    this.rootBlock.moveBy(\n      this.rootBlock.RTL ? -(flyoutWidth + WORKSPACE_MARGIN) : WORKSPACE_MARGIN,\n      WORKSPACE_MARGIN,\n    );\n  }\n\n  /** Adds a listen to the source block that triggers saving connections. */\n  private addSaveConnectionsListener() {\n    if (!this.sourceBlock.saveConnections || !this.rootBlock) return;\n    this.saveConnectionsListener = () => {\n      if (!this.sourceBlock.saveConnections || !this.rootBlock) return;\n      this.sourceBlock.saveConnections(this.rootBlock);\n    };\n    this.saveConnectionsListener();\n    this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener);\n  }\n\n  /**\n   * Creates a change listener to add to the mini workspace which recomposes\n   * the block.\n   */\n  private createMiniWorkspaceChangeListener() {\n    return (e: Abstract) => {\n      if (!MutatorIcon.isIgnorableMutatorEvent(e) && !this.updateWorkspacePid) {\n        this.updateWorkspacePid = setTimeout(() => {\n          this.updateWorkspacePid = null;\n          this.recomposeSourceBlock();\n        }, 0);\n      }\n    };\n  }\n\n  /**\n   * Returns true if the given event is not one the mutator needs to\n   * care about.\n   *\n   * @internal\n   */\n  static isIgnorableMutatorEvent(e: Abstract) {\n    return (\n      e.isUiEvent ||\n      e.type === eventUtils.CREATE ||\n      (e.type === eventUtils.CHANGE &&\n        (e as BlockChange).element === 'disabled')\n    );\n  }\n\n  /** Recomposes the source block based on changes to the mini workspace. */\n  private recomposeSourceBlock() {\n    if (!this.rootBlock) return;\n    if (!this.sourceBlock.compose) {\n      throw new Error(\n        'Blocks with mutator icons must include a compose method',\n      );\n    }\n\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) eventUtils.setGroup(true);\n\n    const oldExtraState = BlockChange.getExtraBlockState_(this.sourceBlock);\n    this.sourceBlock.compose(this.rootBlock);\n    const newExtraState = BlockChange.getExtraBlockState_(this.sourceBlock);\n\n    if (oldExtraState !== newExtraState) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this.sourceBlock,\n          'mutation',\n          null,\n          oldExtraState,\n          newExtraState,\n        ),\n      );\n    }\n\n    eventUtils.setGroup(existingGroup);\n  }\n\n  /**\n   * @returns The workspace of the mini workspace bubble, if the bubble is\n   *     currently open.\n   */\n  getWorkspace(): WorkspaceSvg | undefined {\n    return this.miniWorkspaceBubble?.getWorkspace();\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.KeyCodes\n\n/* eslint-disable @typescript-eslint/no-duplicate-enum-values */\n\n/**\n * Key codes for common characters.\n *\n * Copied from Closure's goog.events.KeyCodes\n *\n * This list is not localized and therefore some of the key codes are not\n * correct for non US keyboard layouts. See comments below.\n */\nexport enum KeyCodes {\n  WIN_KEY_FF_LINUX = 0,\n  MAC_ENTER = 3,\n  BACKSPACE = 8,\n  TAB = 9,\n  NUM_CENTER = 12, // NUMLOCK on FF/Safari Mac\n  ENTER = 13,\n  SHIFT = 16,\n  CTRL = 17,\n  ALT = 18,\n  PAUSE = 19,\n  CAPS_LOCK = 20,\n  ESC = 27,\n  SPACE = 32,\n  PAGE_UP = 33, // also NUM_NORTH_EAST\n  PAGE_DOWN = 34, // also NUM_SOUTH_EAST\n  END = 35, // also NUM_SOUTH_WEST\n  HOME = 36, // also NUM_NORTH_WEST\n  LEFT = 37, // also NUM_WEST\n  UP = 38, // also NUM_NORTH\n  RIGHT = 39, // also NUM_EAST\n  DOWN = 40, // also NUM_SOUTH\n  PLUS_SIGN = 43, // NOT numpad plus\n  PRINT_SCREEN = 44,\n  INSERT = 45, // also NUM_INSERT\n  DELETE = 46, // also NUM_DELETE\n  ZERO = 48,\n  ONE = 49,\n  TWO = 50,\n  THREE = 51,\n  FOUR = 52,\n  FIVE = 53,\n  SIX = 54,\n  SEVEN = 55,\n  EIGHT = 56,\n  NINE = 57,\n  FF_SEMICOLON = 59, // Firefox (Gecko) fires this for semicolon instead of 186\n  FF_EQUALS = 61, // Firefox (Gecko) fires this for equals instead of 187\n  FF_DASH = 173, // Firefox (Gecko) fires this for dash instead of 189\n  // Firefox (Gecko) fires this for # on UK keyboards, rather than\n  // Shift+SINGLE_QUOTE.\n  FF_HASH = 163,\n  QUESTION_MARK = 63, // needs localization\n  AT_SIGN = 64,\n  A = 65,\n  B = 66,\n  C = 67,\n  D = 68,\n  E = 69,\n  F = 70,\n  G = 71,\n  H = 72,\n  I = 73,\n  J = 74,\n  K = 75,\n  L = 76,\n  M = 77,\n  N = 78,\n  O = 79,\n  P = 80,\n  Q = 81,\n  R = 82,\n  S = 83,\n  T = 84,\n  U = 85,\n  V = 86,\n  W = 87,\n  X = 88,\n  Y = 89,\n  Z = 90,\n  META = 91, // WIN_KEY_LEFT\n  WIN_KEY_RIGHT = 92,\n  CONTEXT_MENU = 93,\n  NUM_ZERO = 96,\n  NUM_ONE = 97,\n  NUM_TWO = 98,\n  NUM_THREE = 99,\n  NUM_FOUR = 100,\n  NUM_FIVE = 101,\n  NUM_SIX = 102,\n  NUM_SEVEN = 103,\n  NUM_EIGHT = 104,\n  NUM_NINE = 105,\n  NUM_MULTIPLY = 106,\n  NUM_PLUS = 107,\n  NUM_MINUS = 109,\n  NUM_PERIOD = 110,\n  NUM_DIVISION = 111,\n  F1 = 112,\n  F2 = 113,\n  F3 = 114,\n  F4 = 115,\n  F5 = 116,\n  F6 = 117,\n  F7 = 118,\n  F8 = 119,\n  F9 = 120,\n  F10 = 121,\n  F11 = 122,\n  F12 = 123,\n  NUMLOCK = 144,\n  SCROLL_LOCK = 145,\n\n  // OS-specific media keys like volume controls and browser controls.\n  FIRST_MEDIA_KEY = 166,\n  LAST_MEDIA_KEY = 183,\n\n  SEMICOLON = 186, // needs localization\n  DASH = 189, // needs localization\n  EQUALS = 187, // needs localization\n  COMMA = 188, // needs localization\n  PERIOD = 190, // needs localization\n  SLASH = 191, // needs localization\n  APOSTROPHE = 192, // needs localization\n  TILDE = 192, // needs localization\n  SINGLE_QUOTE = 222, // needs localization\n  OPEN_SQUARE_BRACKET = 219, // needs localization\n  BACKSLASH = 220, // needs localization\n  CLOSE_SQUARE_BRACKET = 221, // needs localization\n  WIN_KEY = 224,\n  MAC_FF_META = 224, // Firefox (Gecko) fires this for the meta key instead of 91\n  MAC_WK_CMD_LEFT = 91, // WebKit Left Command key fired, same as META\n  MAC_WK_CMD_RIGHT = 93, // WebKit Right Command key fired, different from META\n  WIN_IME = 229,\n\n  // \"Reserved for future use\". Some programs (e.g. the SlingPlayer 2.4 ActiveX\n  // control) fire this as a hacky way to disable screensavers.\n  VK_NONAME = 252,\n\n  // We've seen users whose machines fire this keycode at regular one\n  // second intervals. The common thread among these users is that\n  // they're all using Dell Inspiron laptops, so we suspect that this\n  // indicates a hardware/bios problem.\n  // http://en.community.dell.com/support-forums/laptop/f/3518/p/19285957/19523128.aspx\n  PHANTOM = 255,\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils\n\nimport * as browserEvents from './browser_events.js';\nimport * as extensions from './extensions.js';\nimport * as aria from './utils/aria.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as colour from './utils/colour.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as deprecation from './utils/deprecation.js';\nimport * as dom from './utils/dom.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport {KeyCodes} from './utils/keycodes.js';\nimport * as math from './utils/math.js';\nimport type {Metrics} from './utils/metrics.js';\nimport * as object from './utils/object.js';\nimport * as parsing from './utils/parsing.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport * as stringUtils from './utils/string.js';\nimport * as style from './utils/style.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport * as svgPaths from './utils/svg_paths.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as xml from './utils/xml.js';\n\nexport {\n  aria,\n  arrayUtils as array,\n  browserEvents,\n  colour,\n  Coordinate,\n  deprecation,\n  dom,\n  extensions,\n  idGenerator,\n  KeyCodes,\n  math,\n  Metrics,\n  object,\n  parsing,\n  Rect,\n  Size,\n  stringUtils as string,\n  style,\n  Svg,\n  svgMath,\n  svgPaths,\n  toolbox,\n  userAgent,\n  xml,\n};\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Bubble} from './bubble.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\n\n/**\n * A bubble that displays non-editable text. Used by the warning icon.\n */\nexport class TextBubble extends Bubble {\n  private paragraph: SVGTextElement;\n\n  constructor(\n    private text: string,\n    public readonly workspace: WorkspaceSvg,\n    protected anchor: Coordinate,\n    protected ownerRect?: Rect,\n  ) {\n    super(workspace, anchor, ownerRect);\n    this.paragraph = this.stringToSvg(text, this.contentContainer);\n    this.updateBubbleSize();\n  }\n\n  /** @returns the current text of this text bubble. */\n  getText(): string {\n    return this.text;\n  }\n\n  /** Sets the current text of this text bubble, and updates the display. */\n  setText(text: string) {\n    this.text = text;\n    dom.removeNode(this.paragraph);\n    this.paragraph = this.stringToSvg(text, this.contentContainer);\n    this.updateBubbleSize();\n  }\n\n  /**\n   * Converts the given string into an svg containing that string,\n   * broken up by newlines.\n   */\n  private stringToSvg(text: string, container: SVGGElement) {\n    const paragraph = this.createParagraph(container);\n    const spans = this.createSpans(paragraph, text);\n    if (this.workspace.RTL)\n      this.rightAlignSpans(paragraph.getBBox().width, spans);\n    return paragraph;\n  }\n\n  /** Creates the paragraph container for this bubble's view's spans. */\n  private createParagraph(container: SVGGElement): SVGTextElement {\n    return dom.createSvgElement(\n      Svg.TEXT,\n      {\n        'class': 'blocklyText blocklyBubbleText blocklyNoPointerEvents',\n        'y': Bubble.BORDER_WIDTH,\n      },\n      container,\n    );\n  }\n\n  /** Creates the spans visualizing the text of this bubble. */\n  private createSpans(parent: SVGTextElement, text: string): SVGTSpanElement[] {\n    return text.split('\\n').map((line) => {\n      const tspan = dom.createSvgElement(\n        Svg.TSPAN,\n        {'dy': '1em', 'x': Bubble.BORDER_WIDTH},\n        parent,\n      );\n      const textNode = document.createTextNode(line);\n      tspan.appendChild(textNode);\n      return tspan;\n    });\n  }\n\n  /** Right aligns the given spans. */\n  private rightAlignSpans(maxWidth: number, spans: SVGTSpanElement[]) {\n    for (const span of spans) {\n      span.setAttribute('text-anchor', 'end');\n      span.setAttribute('x', `${maxWidth + Bubble.BORDER_WIDTH}`);\n    }\n  }\n\n  /** Updates the size of this bubble to account for the size of the text. */\n  private updateBubbleSize() {\n    const bbox = this.paragraph.getBBox();\n    this.setSize(\n      new Size(\n        bbox.width + Bubble.BORDER_WIDTH * 2,\n        bbox.height + Bubble.BORDER_WIDTH * 2,\n      ),\n      true,\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Bubble} from './bubble.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as Css from '../css.js';\nimport * as dom from '../utils/dom.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport * as touch from '../touch.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport {browserEvents} from '../utils.js';\n\n/**\n * A bubble that displays editable text. It can also be resized by the user.\n * Used by the comment icon.\n */\nexport class TextInputBubble extends Bubble {\n  /** The root of the elements specific to the text element. */\n  private inputRoot: SVGForeignObjectElement;\n\n  /** The text input area element. */\n  private textArea: HTMLTextAreaElement;\n\n  /** The group containing the lines indicating the bubble is resizable. */\n  private resizeGroup: SVGGElement;\n\n  /**\n   * Event data associated with the listener for pointer up events on the\n   * resize group.\n   */\n  private resizePointerUpListener: browserEvents.Data | null = null;\n\n  /**\n   * Event data associated with the listener for pointer move events on the\n   * resize group.\n   */\n  private resizePointerMoveListener: browserEvents.Data | null = null;\n\n  /** Functions listening for changes to the text of this bubble. */\n  private textChangeListeners: (() => void)[] = [];\n\n  /** Functions listening for changes to the size of this bubble. */\n  private sizeChangeListeners: (() => void)[] = [];\n\n  /** The text of this bubble. */\n  private text = '';\n\n  /** The default size of this bubble, including borders. */\n  private readonly DEFAULT_SIZE = new Size(\n    160 + Bubble.DOUBLE_BORDER,\n    80 + Bubble.DOUBLE_BORDER,\n  );\n\n  /** The minimum size of this bubble, including borders. */\n  private readonly MIN_SIZE = new Size(\n    45 + Bubble.DOUBLE_BORDER,\n    20 + Bubble.DOUBLE_BORDER,\n  );\n\n  /**\n   * @param workspace The workspace this bubble belongs to.\n   * @param anchor The anchor location of the thing this bubble is attached to.\n   *     The tail of the bubble will point to this location.\n   * @param ownerRect An optional rect we don't want the bubble to overlap with\n   *     when automatically positioning.\n   */\n  constructor(\n    public readonly workspace: WorkspaceSvg,\n    protected anchor: Coordinate,\n    protected ownerRect?: Rect,\n  ) {\n    super(workspace, anchor, ownerRect);\n    dom.addClass(this.svgRoot, 'blocklyTextInputBubble');\n    ({inputRoot: this.inputRoot, textArea: this.textArea} = this.createEditor(\n      this.contentContainer,\n    ));\n    this.resizeGroup = this.createResizeHandle(this.svgRoot, workspace);\n    this.setSize(this.DEFAULT_SIZE, true);\n  }\n\n  /** @returns the text of this bubble. */\n  getText(): string {\n    return this.text;\n  }\n\n  /** Sets the text of this bubble. Calls change listeners. */\n  setText(text: string) {\n    this.text = text;\n    this.textArea.value = text;\n    this.onTextChange();\n  }\n\n  /** Adds a change listener to be notified when this bubble's text changes. */\n  addTextChangeListener(listener: () => void) {\n    this.textChangeListeners.push(listener);\n  }\n\n  /** Adds a change listener to be notified when this bubble's size changes. */\n  addSizeChangeListener(listener: () => void) {\n    this.sizeChangeListeners.push(listener);\n  }\n\n  /** Creates the editor UI for this bubble. */\n  private createEditor(container: SVGGElement): {\n    inputRoot: SVGForeignObjectElement;\n    textArea: HTMLTextAreaElement;\n  } {\n    const inputRoot = dom.createSvgElement(\n      Svg.FOREIGNOBJECT,\n      {\n        'x': Bubble.BORDER_WIDTH,\n        'y': Bubble.BORDER_WIDTH,\n      },\n      container,\n    );\n\n    const body = document.createElementNS(dom.HTML_NS, 'body');\n    body.setAttribute('xmlns', dom.HTML_NS);\n    body.className = 'blocklyMinimalBody';\n\n    const textArea = document.createElementNS(\n      dom.HTML_NS,\n      'textarea',\n    ) as HTMLTextAreaElement;\n    textArea.className = 'blocklyTextarea blocklyText';\n    textArea.setAttribute('dir', this.workspace.RTL ? 'RTL' : 'LTR');\n\n    body.appendChild(textArea);\n    inputRoot.appendChild(body);\n\n    this.bindTextAreaEvents(textArea);\n    setTimeout(() => {\n      textArea.focus();\n    }, 0);\n\n    return {inputRoot, textArea};\n  }\n\n  /** Binds events to the text area element. */\n  private bindTextAreaEvents(textArea: HTMLTextAreaElement) {\n    // Don't zoom with mousewheel; let it scroll instead.\n    browserEvents.conditionalBind(textArea, 'wheel', this, (e: Event) => {\n      e.stopPropagation();\n    });\n\n    browserEvents.conditionalBind(\n      textArea,\n      'focus',\n      this,\n      this.onStartEdit,\n      true,\n    );\n    browserEvents.conditionalBind(textArea, 'change', this, this.onTextChange);\n  }\n\n  /** Creates the resize handler elements and binds events to them. */\n  private createResizeHandle(\n    container: SVGGElement,\n    workspace: WorkspaceSvg,\n  ): SVGGElement {\n    const resizeHandle = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'class': 'blocklyResizeHandle',\n        'href': `${workspace.options.pathToMedia}resize-handle.svg`,\n      },\n      container,\n    );\n\n    browserEvents.conditionalBind(\n      resizeHandle,\n      'pointerdown',\n      this,\n      this.onResizePointerDown,\n    );\n\n    return resizeHandle;\n  }\n\n  /**\n   * Sets the size of this bubble, including the border.\n   *\n   * @param size Sets the size of this bubble, including the border.\n   * @param relayout If true, reposition the bubble from scratch so that it is\n   *     optimally visible. If false, reposition it so it maintains the same\n   *     position relative to the anchor.\n   */\n  setSize(size: Size, relayout = false) {\n    size.width = Math.max(size.width, this.MIN_SIZE.width);\n    size.height = Math.max(size.height, this.MIN_SIZE.height);\n\n    const widthMinusBorder = size.width - Bubble.DOUBLE_BORDER;\n    const heightMinusBorder = size.height - Bubble.DOUBLE_BORDER;\n    this.inputRoot.setAttribute('width', `${widthMinusBorder}`);\n    this.inputRoot.setAttribute('height', `${heightMinusBorder}`);\n\n    this.resizeGroup.setAttribute('y', `${heightMinusBorder}`);\n    if (this.workspace.RTL) {\n      this.resizeGroup.setAttribute('x', `${-Bubble.DOUBLE_BORDER}`);\n    } else {\n      this.resizeGroup.setAttribute('x', `${widthMinusBorder}`);\n    }\n\n    super.setSize(size, relayout);\n    this.onSizeChange();\n  }\n\n  /** @returns the size of this bubble. */\n  getSize(): Size {\n    // Overriden to be public.\n    return super.getSize();\n  }\n\n  /** Handles mouse down events on the resize target. */\n  private onResizePointerDown(e: PointerEvent) {\n    this.bringToFront();\n    if (browserEvents.isRightButton(e)) {\n      e.stopPropagation();\n      return;\n    }\n\n    this.workspace.startDrag(\n      e,\n      new Coordinate(\n        this.workspace.RTL ? -this.getSize().width : this.getSize().width,\n        this.getSize().height,\n      ),\n    );\n\n    this.resizePointerUpListener = browserEvents.conditionalBind(\n      document,\n      'pointerup',\n      this,\n      this.onResizePointerUp,\n    );\n    this.resizePointerMoveListener = browserEvents.conditionalBind(\n      document,\n      'pointermove',\n      this,\n      this.onResizePointerMove,\n    );\n    this.workspace.hideChaff();\n    // This event has been handled.  No need to bubble up to the document.\n    e.stopPropagation();\n  }\n\n  /** Handles pointer up events on the resize target. */\n  private onResizePointerUp(_e: PointerEvent) {\n    touch.clearTouchIdentifier();\n    if (this.resizePointerUpListener) {\n      browserEvents.unbind(this.resizePointerUpListener);\n      this.resizePointerUpListener = null;\n    }\n    if (this.resizePointerMoveListener) {\n      browserEvents.unbind(this.resizePointerMoveListener);\n      this.resizePointerMoveListener = null;\n    }\n  }\n\n  /** Handles pointer move events on the resize target. */\n  private onResizePointerMove(e: PointerEvent) {\n    const delta = this.workspace.moveDrag(e);\n    this.setSize(\n      new Size(this.workspace.RTL ? -delta.x : delta.x, delta.y),\n      false,\n    );\n    this.onSizeChange();\n  }\n\n  /**\n   * Handles starting an edit of the text area. Brings the bubble to the front.\n   */\n  private onStartEdit() {\n    if (this.bringToFront()) {\n      // Since the act of moving this node within the DOM causes a loss of\n      // focus, we need to reapply the focus.\n      this.textArea.focus();\n    }\n  }\n\n  /** Handles a text change event for the text area. Calls event listeners. */\n  private onTextChange() {\n    this.text = this.textArea.value;\n    for (const listener of this.textChangeListeners) {\n      listener();\n    }\n  }\n\n  /** Handles a size change event for the text area. Calls event listeners. */\n  private onSizeChange() {\n    for (const listener of this.sizeChangeListeners) {\n      listener();\n    }\n  }\n}\n\nCss.register(`\n.blocklyTextInputBubble .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 0;\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n`);\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Comment\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport {IconType} from './icon_types.js';\nimport {Coordinate} from '../utils.js';\nimport * as dom from '../utils/dom.js';\nimport * as eventUtils from '../events/utils.js';\nimport {Icon} from './icon.js';\nimport type {IHasBubble} from '../interfaces/i_has_bubble.js';\nimport type {ISerializable} from '../interfaces/i_serializable.js';\nimport {Rect} from '../utils/rect.js';\nimport * as registry from './registry.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport {TextBubble} from '../bubbles/text_bubble.js';\nimport {TextInputBubble} from '../bubbles/textinput_bubble.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\nimport * as renderManagement from '../render_management.js';\n\n/** The size of the comment icon in workspace-scale units. */\nconst SIZE = 17;\n\n/** The default width in workspace-scale units of the text input bubble. */\nconst DEFAULT_BUBBLE_WIDTH = 160;\n\n/** The default height in workspace-scale units of the text input bubble. */\nconst DEFAULT_BUBBLE_HEIGHT = 80;\n\n/**\n * An icon which allows the user to add comment text to a block.\n */\nexport class CommentIcon extends Icon implements IHasBubble, ISerializable {\n  /** The type string used to identify this icon. */\n  static readonly TYPE = IconType.COMMENT;\n\n  /**\n   * The weight this icon has relative to other icons. Icons with more positive\n   * weight values are rendered farther toward the end of the block.\n   */\n  static readonly WEIGHT = 3;\n\n  /** The bubble used to show editable text to the user. */\n  private textInputBubble: TextInputBubble | null = null;\n\n  /** The bubble used to show non-editable text to the user. */\n  private textBubble: TextBubble | null = null;\n\n  /** The text of this comment. */\n  private text = '';\n\n  /** The size of this comment (which is applied to the editable bubble). */\n  private bubbleSize = new Size(DEFAULT_BUBBLE_WIDTH, DEFAULT_BUBBLE_HEIGHT);\n\n  /**\n   * The visibility of the bubble for this comment.\n   *\n   * This is used to track what the visibile state /should/ be, not necessarily\n   * what it currently /is/. E.g. sometimes this will be true, but the block\n   * hasn't been rendered yet, so the bubble will not currently be visible.\n   */\n  private bubbleVisiblity = false;\n\n  constructor(protected readonly sourceBlock: Block) {\n    super(sourceBlock);\n  }\n\n  override getType(): IconType<CommentIcon> {\n    return CommentIcon.TYPE;\n  }\n\n  override initView(pointerdownListener: (e: PointerEvent) => void): void {\n    if (this.svgRoot) return; // Already initialized.\n\n    super.initView(pointerdownListener);\n\n    // Circle.\n    dom.createSvgElement(\n      Svg.CIRCLE,\n      {'class': 'blocklyIconShape', 'r': '8', 'cx': '8', 'cy': '8'},\n      this.svgRoot,\n    );\n    // Can't use a real '?' text character since different browsers and\n    // operating systems render it differently. Body of question mark.\n    dom.createSvgElement(\n      Svg.PATH,\n      {\n        'class': 'blocklyIconSymbol',\n        'd':\n          'm6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.405' +\n          '0.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25' +\n          '-1.201,0.998 -1.201,1.528 -1.204,2.19z',\n      },\n      this.svgRoot,\n    );\n    // Dot of question mark.\n    dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyIconSymbol',\n        'x': '6.8',\n        'y': '10.78',\n        'height': '2',\n        'width': '2',\n      },\n      this.svgRoot,\n    );\n    dom.addClass(this.svgRoot!, 'blockly-icon-comment');\n  }\n\n  override dispose() {\n    super.dispose();\n    this.textInputBubble?.dispose();\n    this.textBubble?.dispose();\n  }\n\n  override getWeight(): number {\n    return CommentIcon.WEIGHT;\n  }\n\n  override getSize(): Size {\n    return new Size(SIZE, SIZE);\n  }\n\n  override applyColour(): void {\n    super.applyColour();\n    const colour = (this.sourceBlock as BlockSvg).style.colourPrimary;\n    this.textInputBubble?.setColour(colour);\n    this.textBubble?.setColour(colour);\n  }\n\n  /**\n   * Updates the state of the bubble (editable / noneditable) to reflect the\n   * state of the bubble if the bubble is currently shown.\n   */\n  override async updateEditable(): Promise<void> {\n    super.updateEditable();\n    if (this.bubbleIsVisible()) {\n      // Close and reopen the bubble to display the correct UI.\n      await this.setBubbleVisible(false);\n      await this.setBubbleVisible(true);\n    }\n  }\n\n  override onLocationChange(blockOrigin: Coordinate): void {\n    super.onLocationChange(blockOrigin);\n    const anchorLocation = this.getAnchorLocation();\n    this.textInputBubble?.setAnchorLocation(anchorLocation);\n    this.textBubble?.setAnchorLocation(anchorLocation);\n  }\n\n  /** Sets the text of this comment. Updates any bubbles if they are visible. */\n  setText(text: string) {\n    const oldText = this.text;\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n        this.sourceBlock,\n        'comment',\n        null,\n        oldText,\n        text,\n      ),\n    );\n    this.text = text;\n    this.textInputBubble?.setText(this.text);\n    this.textBubble?.setText(this.text);\n  }\n\n  /** Returns the text of this comment. */\n  getText(): string {\n    return this.text;\n  }\n\n  /**\n   * Sets the size of the editable bubble for this comment. Resizes the\n   * bubble if it is visible.\n   */\n  setBubbleSize(size: Size) {\n    this.bubbleSize = size;\n    this.textInputBubble?.setSize(this.bubbleSize, true);\n  }\n\n  /** @returns the size of the editable bubble for this comment. */\n  getBubbleSize(): Size {\n    return this.bubbleSize;\n  }\n\n  /**\n   * @returns the state of the comment as a JSON serializable value if the\n   * comment has text. Otherwise returns null.\n   */\n  saveState(): CommentState | null {\n    if (this.text) {\n      return {\n        'text': this.text,\n        'pinned': this.bubbleIsVisible(),\n        'height': this.bubbleSize.height,\n        'width': this.bubbleSize.width,\n      };\n    }\n    return null;\n  }\n\n  /** Applies the given state to this comment. */\n  loadState(state: CommentState) {\n    this.text = state['text'] ?? '';\n    this.bubbleSize = new Size(\n      state['width'] ?? DEFAULT_BUBBLE_WIDTH,\n      state['height'] ?? DEFAULT_BUBBLE_HEIGHT,\n    );\n    this.bubbleVisiblity = state['pinned'] ?? false;\n    this.setBubbleVisible(this.bubbleVisiblity);\n  }\n\n  override onClick(): void {\n    super.onClick();\n    this.setBubbleVisible(!this.bubbleIsVisible());\n  }\n\n  override isClickableInFlyout(): boolean {\n    return false;\n  }\n\n  /**\n   * Updates the text of this comment in response to changes in the text of\n   * the input bubble.\n   */\n  onTextChange(): void {\n    if (!this.textInputBubble) return;\n\n    const newText = this.textInputBubble.getText();\n    if (this.text === newText) return;\n\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n        this.sourceBlock,\n        'comment',\n        null,\n        this.text,\n        newText,\n      ),\n    );\n    this.text = newText;\n  }\n\n  /**\n   * Updates the size of this icon in response to changes in the size of the\n   * input bubble.\n   */\n  onSizeChange(): void {\n    if (this.textInputBubble) {\n      this.bubbleSize = this.textInputBubble.getSize();\n    }\n  }\n\n  bubbleIsVisible(): boolean {\n    return this.bubbleVisiblity;\n  }\n\n  async setBubbleVisible(visible: boolean): Promise<void> {\n    if (this.bubbleVisiblity === visible) return;\n    this.bubbleVisiblity = visible;\n\n    await renderManagement.finishQueuedRenders();\n\n    if (\n      !this.sourceBlock.rendered ||\n      this.sourceBlock.isInFlyout ||\n      this.sourceBlock.isInsertionMarker()\n    )\n      return;\n\n    if (visible) {\n      if (this.sourceBlock.isEditable()) {\n        this.showEditableBubble();\n      } else {\n        this.showNonEditableBubble();\n      }\n      this.applyColour();\n    } else {\n      this.hideBubble();\n    }\n\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BUBBLE_OPEN))(\n        this.sourceBlock,\n        visible,\n        'comment',\n      ),\n    );\n  }\n\n  /**\n   * Shows the editable text bubble for this comment, and adds change listeners\n   * to update the state of this icon in response to changes in the bubble.\n   */\n  private showEditableBubble() {\n    this.textInputBubble = new TextInputBubble(\n      this.sourceBlock.workspace as WorkspaceSvg,\n      this.getAnchorLocation(),\n      this.getBubbleOwnerRect(),\n    );\n    this.textInputBubble.setText(this.getText());\n    this.textInputBubble.setSize(this.bubbleSize, true);\n    this.textInputBubble.addTextChangeListener(() => this.onTextChange());\n    this.textInputBubble.addSizeChangeListener(() => this.onSizeChange());\n  }\n\n  /** Shows the non editable text bubble for this comment. */\n  private showNonEditableBubble() {\n    this.textBubble = new TextBubble(\n      this.getText(),\n      this.sourceBlock.workspace as WorkspaceSvg,\n      this.getAnchorLocation(),\n      this.getBubbleOwnerRect(),\n    );\n  }\n\n  /** Hides any open bubbles owned by this comment. */\n  private hideBubble() {\n    this.textInputBubble?.dispose();\n    this.textInputBubble = null;\n    this.textBubble?.dispose();\n    this.textBubble = null;\n  }\n\n  /**\n   * @returns the location the bubble should be anchored to.\n   *     I.E. the middle of this icon.\n   */\n  private getAnchorLocation(): Coordinate {\n    const midIcon = SIZE / 2;\n    return Coordinate.sum(\n      this.workspaceLocation,\n      new Coordinate(midIcon, midIcon),\n    );\n  }\n\n  /**\n   * @returns the rect the bubble should avoid overlapping.\n   *     I.E. the block that owns this icon.\n   */\n  private getBubbleOwnerRect(): Rect {\n    const bbox = (this.sourceBlock as BlockSvg).getSvgRoot().getBBox();\n    return new Rect(bbox.y, bbox.y + bbox.height, bbox.x, bbox.x + bbox.width);\n  }\n}\n\n/** The save state format for a comment icon. */\nexport interface CommentState {\n  /** The text of the comment. */\n  text?: string;\n\n  /** True if the comment is open, false otherwise. */\n  pinned?: boolean;\n\n  /** The height of the comment bubble. */\n  height?: number;\n\n  /** The width of the comment bubble. */\n  width?: number;\n}\n\nregistry.register(CommentIcon.TYPE, CommentIcon);\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Warning\n\nimport type {BlockSvg} from '../block_svg.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport * as eventUtils from '../events/utils.js';\nimport {Icon} from './icon.js';\nimport type {IHasBubble} from '../interfaces/i_has_bubble.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils.js';\nimport {Svg} from '../utils/svg.js';\nimport {TextBubble} from '../bubbles/text_bubble.js';\nimport {IconType} from './icon_types.js';\nimport * as renderManagement from '../render_management.js';\n\n/** The size of the warning icon in workspace-scale units. */\nconst SIZE = 17;\n\n/**\n * An icon that warns the user that something is wrong with their block.\n *\n * For example, this could be used to warn them about incorrect field values,\n * or incorrect placement of the block (putting it somewhere it doesn't belong).\n */\nexport class WarningIcon extends Icon implements IHasBubble {\n  /** The type string used to identify this icon. */\n  static readonly TYPE = IconType.WARNING;\n\n  /**\n   * The weight this icon has relative to other icons. Icons with more positive\n   * weight values are rendered farther toward the end of the block.\n   */\n  static readonly WEIGHT = 2;\n\n  /** A map of warning IDs to warning text. */\n  private textMap: Map<string, string> = new Map();\n\n  /** The bubble used to display the warnings to the user. */\n  private textBubble: TextBubble | null = null;\n\n  /** @internal */\n  constructor(protected readonly sourceBlock: BlockSvg) {\n    super(sourceBlock);\n  }\n\n  override getType(): IconType<WarningIcon> {\n    return WarningIcon.TYPE;\n  }\n\n  override initView(pointerdownListener: (e: PointerEvent) => void): void {\n    if (this.svgRoot) return; // Already initialized.\n\n    super.initView(pointerdownListener);\n\n    // Triangle with rounded corners.\n    dom.createSvgElement(\n      Svg.PATH,\n      {\n        'class': 'blocklyIconShape',\n        'd': 'M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z',\n      },\n      this.svgRoot,\n    );\n    // Can't use a real '!' text character since different browsers and\n    // operating systems render it differently. Body of exclamation point.\n    dom.createSvgElement(\n      Svg.PATH,\n      {\n        'class': 'blocklyIconSymbol',\n        'd': 'm7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z',\n      },\n      this.svgRoot,\n    );\n    // Dot of exclamation point.\n    dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyIconSymbol',\n        'x': '7',\n        'y': '11',\n        'height': '2',\n        'width': '2',\n      },\n      this.svgRoot,\n    );\n    dom.addClass(this.svgRoot!, 'blockly-icon-warning');\n  }\n\n  override dispose() {\n    super.dispose();\n    this.textBubble?.dispose();\n  }\n\n  override getWeight(): number {\n    return WarningIcon.WEIGHT;\n  }\n\n  override getSize(): Size {\n    return new Size(SIZE, SIZE);\n  }\n\n  override applyColour(): void {\n    super.applyColour();\n    this.textBubble?.setColour(this.sourceBlock.style.colourPrimary);\n  }\n\n  override updateCollapsed(): void {\n    // We are shown when collapsed, so do nothing! I.e. skip the default\n    // behavior of hiding.\n  }\n\n  /** Tells blockly that this icon is shown when the block is collapsed. */\n  override isShownWhenCollapsed(): boolean {\n    return true;\n  }\n\n  /** Updates the location of the icon's bubble if it is open. */\n  override onLocationChange(blockOrigin: Coordinate): void {\n    super.onLocationChange(blockOrigin);\n    this.textBubble?.setAnchorLocation(this.getAnchorLocation());\n  }\n\n  /**\n   * Adds a warning message to this warning icon.\n   *\n   * @param text The text of the message to add.\n   * @param id The id of the message to add.\n   * @internal\n   */\n  addMessage(text: string, id: string): this {\n    if (this.textMap.get(id) === text) return this;\n\n    if (text) {\n      this.textMap.set(id, text);\n    } else {\n      this.textMap.delete(id);\n    }\n\n    this.textBubble?.setText(this.getText());\n    return this;\n  }\n\n  /**\n   * @returns the display text for this icon. Includes all warning messages\n   *     concatenated together with newlines.\n   * @internal\n   */\n  getText(): string {\n    return [...this.textMap.values()].join('\\n');\n  }\n\n  /** Toggles the visibility of the bubble. */\n  override onClick(): void {\n    super.onClick();\n    this.setBubbleVisible(!this.bubbleIsVisible());\n  }\n\n  override isClickableInFlyout(): boolean {\n    return false;\n  }\n\n  bubbleIsVisible(): boolean {\n    return !!this.textBubble;\n  }\n\n  async setBubbleVisible(visible: boolean): Promise<void> {\n    if (this.bubbleIsVisible() === visible) return;\n\n    await renderManagement.finishQueuedRenders();\n\n    if (visible) {\n      this.textBubble = new TextBubble(\n        this.getText(),\n        this.sourceBlock.workspace,\n        this.getAnchorLocation(),\n        this.getBubbleOwnerRect(),\n      );\n      this.applyColour();\n    } else {\n      this.textBubble?.dispose();\n      this.textBubble = null;\n    }\n\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BUBBLE_OPEN))(\n        this.sourceBlock,\n        visible,\n        'warning',\n      ),\n    );\n  }\n\n  /**\n   * @returns the location the bubble should be anchored to.\n   *     I.E. the middle of this icon.\n   */\n  private getAnchorLocation(): Coordinate {\n    const midIcon = SIZE / 2;\n    return Coordinate.sum(\n      this.workspaceLocation,\n      new Coordinate(midIcon, midIcon),\n    );\n  }\n\n  /**\n   * @returns the rect the bubble should avoid overlapping.\n   *     I.E. the block that owns this icon.\n   */\n  private getBubbleOwnerRect(): Rect {\n    const bbox = this.sourceBlock.getSvgRoot().getBBox();\n    return new Rect(bbox.y, bbox.y + bbox.height, bbox.x, bbox.x + bbox.width);\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {IIcon} from '../interfaces/i_icon.js';\n\n/**\n * Thrown when you add more than one icon of the same type to a block.\n */\nexport class DuplicateIconType extends Error {\n  /**\n   * @internal\n   */\n  constructor(public icon: IIcon) {\n    super(\n      `Tried to append an icon of type ${icon.getType()} when an icon of ` +\n        `that type already exists on the block. ` +\n        `Use getIcon to access the existing icon.`,\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Icon} from './icons/icon.js';\nimport {CommentIcon, CommentState} from './icons/comment_icon.js';\nimport {MutatorIcon} from './icons/mutator_icon.js';\nimport {WarningIcon} from './icons/warning_icon.js';\nimport {IconType} from './icons/icon_types.js';\nimport * as exceptions from './icons/exceptions.js';\nimport * as registry from './icons/registry.js';\n\nexport {\n  Icon,\n  CommentIcon,\n  CommentState,\n  MutatorIcon,\n  WarningIcon,\n  IconType,\n  exceptions,\n  registry,\n};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Types\n\nimport type {Measurable} from './base.js';\nimport type {Row} from './row.js';\n\n/**\n * Types of rendering elements.\n */\nclass TypesContainer {\n  [index: string]: number | Function;\n\n  NONE = 0; // None\n  FIELD = 1 << 0; // Field.\n  HAT = 1 << 1; // Hat.\n  ICON = 1 << 2; // Icon.\n  SPACER = 1 << 3; // Spacer.\n  BETWEEN_ROW_SPACER = 1 << 4; // Between Row Spacer.\n  IN_ROW_SPACER = 1 << 5; // In Row Spacer.\n  EXTERNAL_VALUE_INPUT = 1 << 6; // External Value Input.\n  INPUT = 1 << 7; // Input.\n  INLINE_INPUT = 1 << 8; // Inline Input.\n  STATEMENT_INPUT = 1 << 9; // Statement Input.\n  CONNECTION = 1 << 10; // Connection.\n  PREVIOUS_CONNECTION = 1 << 11; // Previous Connection.\n  NEXT_CONNECTION = 1 << 12; // Next Connection.\n  OUTPUT_CONNECTION = 1 << 13; // Output Connection.\n  CORNER = 1 << 14; // Corner.\n  LEFT_SQUARE_CORNER = 1 << 15; // Square Corner.\n  LEFT_ROUND_CORNER = 1 << 16; // Round Corner.\n  RIGHT_SQUARE_CORNER = 1 << 17; // Right Square Corner.\n  RIGHT_ROUND_CORNER = 1 << 18; // Right Round Corner.\n  JAGGED_EDGE = 1 << 19; // Jagged Edge.\n  ROW = 1 << 20; // Row.\n  TOP_ROW = 1 << 21; // Top Row.\n  BOTTOM_ROW = 1 << 22; // Bottom Row.\n  INPUT_ROW = 1 << 23; // Input Row.\n\n  /**\n   * A Left Corner Union Type.\n   */\n  LEFT_CORNER = this.LEFT_SQUARE_CORNER | this.LEFT_ROUND_CORNER;\n\n  /**\n   * A Right Corner Union Type.\n   */\n  RIGHT_CORNER = this.RIGHT_SQUARE_CORNER | this.RIGHT_ROUND_CORNER;\n\n  /**\n   * Next flag value to use for custom rendering element types.\n   * This must be updated to reflect the next enum flag value\n   * to use if additional elements are added to\n   * `Types`.\n   */\n  nextTypeValue_ = 1 << 24;\n\n  /**\n   * Get the enum flag value of an existing type or register a new type.\n   *\n   * @param type The name of the type.\n   * @returns The enum flag value associated with that type.\n   */\n  getType(type: string): number {\n    if (!Object.prototype.hasOwnProperty.call(this, type)) {\n      this[type] = this.nextTypeValue_;\n      this.nextTypeValue_ <<= 1;\n    }\n    return this[type] as number;\n  }\n\n  /**\n   * Whether a measurable stores information about a field.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a field.\n   */\n  isField(elem: Measurable): number {\n    return elem.type & this.FIELD;\n  }\n\n  /**\n   * Whether a measurable stores information about a hat.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a hat.\n   */\n  isHat(elem: Measurable): number {\n    return elem.type & this.HAT;\n  }\n\n  /**\n   * Whether a measurable stores information about an icon.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an icon.\n   */\n  isIcon(elem: Measurable): number {\n    return elem.type & this.ICON;\n  }\n\n  /**\n   * Whether a measurable stores information about a spacer.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a spacer.\n   */\n  isSpacer(elem: Measurable | Row): number {\n    return elem.type & this.SPACER;\n  }\n\n  /**\n   * Whether a measurable stores information about an in-row spacer.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an in-row spacer.\n   */\n  isInRowSpacer(elem: Measurable): number {\n    return elem.type & this.IN_ROW_SPACER;\n  }\n\n  /**\n   * Whether a measurable stores information about an input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an input.\n   */\n  isInput(elem: Measurable): number {\n    return elem.type & this.INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about an external input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an external input.\n   */\n  isExternalInput(elem: Measurable): number {\n    return elem.type & this.EXTERNAL_VALUE_INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about an inline input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an inline input.\n   */\n  isInlineInput(elem: Measurable): number {\n    return elem.type & this.INLINE_INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about a statement input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a statement input.\n   */\n  isStatementInput(elem: Measurable): number {\n    return elem.type & this.STATEMENT_INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about a previous connection.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a previous connection.\n   */\n  isPreviousConnection(elem: Measurable): number {\n    return elem.type & this.PREVIOUS_CONNECTION;\n  }\n\n  /**\n   * Whether a measurable stores information about a next connection.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a next connection.\n   */\n  isNextConnection(elem: Measurable): number {\n    return elem.type & this.NEXT_CONNECTION;\n  }\n\n  /**\n   * Whether a measurable stores information about a previous or next\n   * connection.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a previous or next\n   *     connection.\n   */\n  isPreviousOrNextConnection(elem: Measurable): number {\n    return elem.type & (this.PREVIOUS_CONNECTION | this.NEXT_CONNECTION);\n  }\n\n  /**\n   * Whether a measurable stores information about a left round corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a left round corner.\n   */\n  isLeftRoundedCorner(elem: Measurable): number {\n    return elem.type & this.LEFT_ROUND_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a right round corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a right round corner.\n   */\n  isRightRoundedCorner(elem: Measurable): number {\n    return elem.type & this.RIGHT_ROUND_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a left square corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a left square corner.\n   */\n  isLeftSquareCorner(elem: Measurable): number {\n    return elem.type & this.LEFT_SQUARE_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a right square corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a right square corner.\n   */\n  isRightSquareCorner(elem: Measurable): number {\n    return elem.type & this.RIGHT_SQUARE_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a corner.\n   */\n  isCorner(elem: Measurable): number {\n    return elem.type & this.CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a jagged edge.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a jagged edge.\n   */\n  isJaggedEdge(elem: Measurable): number {\n    return elem.type & this.JAGGED_EDGE;\n  }\n\n  /**\n   * Whether a measurable stores information about a row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a row.\n   */\n  isRow(row: Row): number {\n    return row.type & this.ROW;\n  }\n\n  /**\n   * Whether a measurable stores information about a between-row spacer.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a between-row spacer.\n   */\n  isBetweenRowSpacer(row: Row): number {\n    return row.type & this.BETWEEN_ROW_SPACER;\n  }\n\n  /**\n   * Whether a measurable stores information about a top row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a top row.\n   */\n  isTopRow(row: Row): number {\n    return row.type & this.TOP_ROW;\n  }\n\n  /**\n   * Whether a measurable stores information about a bottom row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a bottom row.\n   */\n  isBottomRow(row: Row): number {\n    return row.type & this.BOTTOM_ROW;\n  }\n\n  /**\n   * Whether a measurable stores information about a top or bottom row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a top or bottom row.\n   */\n  isTopOrBottomRow(row: Row): number {\n    return row.type & (this.TOP_ROW | this.BOTTOM_ROW);\n  }\n\n  /**\n   * Whether a measurable stores information about an input row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about an input row.\n   */\n  isInputRow(row: Row): number {\n    return row.type & this.INPUT_ROW;\n  }\n}\n\nexport const Types = new TypesContainer();\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Measurable\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Types} from './types.js';\n\n/**\n * The base class to represent a part of a block that takes up space during\n * rendering.  The constructor for each non-spacer Measurable records the size\n * of the block element (e.g. field, statement input).\n */\nexport class Measurable {\n  width = 0;\n\n  height = 0;\n  type: number;\n  xPos = 0;\n\n  centerline = 0;\n  notchOffset: number;\n\n  /** The renderer's constant provider. */\n  protected readonly constants_: ConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    this.constants_ = constants;\n\n    this.type = Types.NONE;\n\n    this.notchOffset = this.constants_.NOTCH_OFFSET_LEFT;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Row\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport type {Measurable} from './base.js';\nimport type {InRowSpacer} from './in_row_spacer.js';\nimport type {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object representing a single row on a rendered block and all of its\n * subcomponents.\n */\nexport class Row {\n  type: number;\n\n  /**\n   * An array of elements contained in this row.\n   */\n  elements: Measurable[] = [];\n\n  /**\n   * The height of the row.\n   */\n  height = 0;\n\n  /**\n   * The width of the row, from the left edge of the block to the right.\n   * Does not include child blocks unless they are inline.\n   */\n  width = 0;\n\n  /**\n   * The minimum height of the row.\n   */\n  minHeight = 0;\n\n  /**\n   * The minimum width of the row, from the left edge of the block to the\n   * right. Does not include child blocks unless they are inline.\n   */\n  minWidth = 0;\n\n  /**\n   * The width of the row, from the left edge of the block to the edge of the\n   * block or any connected child blocks.\n   */\n  widthWithConnectedBlocks = 0;\n\n  /**\n   * The Y position of the row relative to the origin of the block's svg\n   * group.\n   */\n  yPos = 0;\n\n  /**\n   * The X position of the row relative to the origin of the block's svg\n   * group.\n   */\n  xPos = 0;\n\n  /**\n   * Whether the row has any external inputs.\n   */\n  hasExternalInput = false;\n\n  /**\n   * Whether the row has any statement inputs.\n   */\n  hasStatement = false;\n\n  /**\n   * Where the left edge of all of the statement inputs on the block should\n   * be. This makes sure that statement inputs which are proceded by fields\n   * of varius widths are all aligned.\n   */\n  statementEdge = 0;\n\n  /**\n   * Whether the row has any inline inputs.\n   */\n  hasInlineInput = false;\n\n  /**\n   * Whether the row has any dummy inputs or end-row inputs.\n   */\n  hasDummyInput = false;\n\n  /**\n   * Whether the row has a jagged edge.\n   */\n  hasJaggedEdge = false;\n  notchOffset: number;\n\n  /**\n   * Alignment of the row.\n   */\n  align: number | null = null;\n\n  protected readonly constants_: ConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    /** The renderer's constant provider. */\n    this.constants_ = constants;\n\n    /** The type of this rendering object. */\n    this.type = Types.ROW;\n\n    this.notchOffset = this.constants_.NOTCH_OFFSET_LEFT;\n  }\n\n  /**\n   * Get the last input on this row, if it has one.\n   *\n   * @returns The last input on the row, or null.\n   */\n  getLastInput(): InputConnection | null {\n    // TODO: Consider moving this to InputRow, if possible.\n    for (let i = this.elements.length - 1; i >= 0; i--) {\n      const elem = this.elements[i];\n      if (Types.isInput(elem)) {\n        return elem as InputConnection;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Inspect all subcomponents and populate all size properties on the row.\n   */\n  measure() {\n    throw Error('Unexpected attempt to measure a base Row.');\n  }\n\n  /**\n   * Determines whether this row should start with an element spacer.\n   *\n   * @returns Whether the row should start with a spacer.\n   */\n  startsWithElemSpacer(): boolean {\n    return true;\n  }\n\n  /**\n   * Determines whether this row should end with an element spacer.\n   *\n   * @returns Whether the row should end with a spacer.\n   */\n  endsWithElemSpacer(): boolean {\n    return true;\n  }\n\n  /**\n   * Convenience method to get the first spacer element on this row.\n   *\n   * @returns The first spacer element on this row.\n   */\n  getFirstSpacer(): InRowSpacer | null {\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      if (Types.isSpacer(elem)) {\n        return elem as InRowSpacer;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Convenience method to get the last spacer element on this row.\n   *\n   * @returns The last spacer element on this row.\n   */\n  getLastSpacer(): InRowSpacer | null {\n    for (let i = this.elements.length - 1; i >= 0; i--) {\n      const elem = this.elements[i];\n      if (Types.isSpacer(elem)) {\n        return elem as InRowSpacer;\n      }\n    }\n    return null;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.BottomRow\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport type {NextConnection} from './next_connection.js';\nimport {Row} from './row.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about what elements are in the bottom row of\n * a block as well as spacing information for the bottom row.\n * Elements in a bottom row can consist of corners, spacers and next\n * connections.\n */\nexport class BottomRow extends Row {\n  /**\n   * Whether this row has a next connection.\n   */\n  hasNextConnection = false;\n\n  /**\n   * The next connection on the row, if any.\n   */\n  connection: NextConnection | null = null;\n\n  /**\n   * The amount that the bottom of the block extends below the horizontal\n   * edge, e.g. because of a next connection.  Must be non-negative (see\n   * #2820).\n   */\n  descenderHeight = 0;\n\n  /**\n   * The Y position of the bottom edge of the block, relative to the origin\n   * of the block rendering.\n   */\n  baseline = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.BOTTOM_ROW;\n  }\n\n  /**\n   * Returns whether or not the bottom row has a left square corner.\n   *\n   * @param block The block whose bottom row this represents.\n   * @returns Whether or not the bottom row has a left square corner.\n   */\n  hasLeftSquareCorner(block: BlockSvg): boolean {\n    return !!block.outputConnection || !!block.getNextBlock();\n  }\n\n  /**\n   * Returns whether or not the bottom row has a right square corner.\n   *\n   * @param _block The block whose bottom row this represents.\n   * @returns Whether or not the bottom row has a right square corner.\n   */\n  hasRightSquareCorner(_block: BlockSvg): boolean {\n    return true;\n  }\n\n  override measure() {\n    let height = 0;\n    let width = 0;\n    let descenderHeight = 0;\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      width += elem.width;\n      if (!Types.isSpacer(elem)) {\n        // Note: this assumes that next connections have *only* descenderHeight,\n        // with no height above the baseline.\n        if (Types.isNextConnection(elem)) {\n          descenderHeight = Math.max(descenderHeight, elem.height);\n        } else {\n          height = Math.max(height, elem.height);\n        }\n      }\n    }\n    this.width = Math.max(this.minWidth, width);\n    this.height = Math.max(this.minHeight, height) + descenderHeight;\n    this.descenderHeight = descenderHeight;\n    this.widthWithConnectedBlocks = this.width;\n  }\n\n  override startsWithElemSpacer() {\n    return false;\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Connection\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider, Shape} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * The base class to represent a connection and the space that it takes up on\n * the block.\n */\nexport class Connection extends Measurable {\n  shape: Shape;\n  isDynamicShape: boolean;\n  highlighted: boolean;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   */\n  constructor(\n    constants: ConstantProvider,\n    public connectionModel: RenderedConnection,\n  ) {\n    super(constants);\n\n    this.type |= Types.CONNECTION;\n\n    this.shape = this.constants_.shapeFor(connectionModel);\n    this.isDynamicShape = 'isDynamic' in this.shape && this.shape.isDynamic;\n\n    this.highlighted = connectionModel.isHighlighted();\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.InputConnection\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Input} from '../../inputs/input.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n/**\n * The base class to represent an input that takes up space on a block\n * during rendering.\n */\nexport class InputConnection extends Connection {\n  align: number;\n  connectedBlock: BlockSvg | null;\n  connectedBlockWidth: number;\n  connectedBlockHeight: number;\n  connectionOffsetX = 0;\n  connectionOffsetY = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The input to measure and store information for.\n   */\n  constructor(\n    constants: ConstantProvider,\n    public input: Input,\n  ) {\n    super(constants, input.connection as RenderedConnection);\n\n    this.type |= Types.INPUT;\n\n    this.align = input.align;\n\n    this.connectedBlock =\n      input.connection && input.connection.targetBlock()\n        ? (input.connection.targetBlock() as BlockSvg)\n        : null;\n\n    if (this.connectedBlock) {\n      const bBox = this.connectedBlock.getHeightWidth();\n      this.connectedBlockWidth = bBox.width;\n      this.connectedBlockHeight = bBox.height;\n    } else {\n      this.connectedBlockWidth = 0;\n      this.connectedBlockHeight = 0;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.ExternalValueInput\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../inputs/input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space an external value input\n * takes up during rendering\n */\nexport class ExternalValueInput extends InputConnection {\n  override height = 0;\n  override width: number;\n  override connectionOffsetY: number;\n  connectionHeight: number;\n  connectionWidth: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The external value input to measure and store information for.\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n    this.type |= Types.EXTERNAL_VALUE_INPUT;\n    if (!this.connectedBlock) {\n      this.height = this.shape.height as number;\n    } else {\n      this.height =\n        this.connectedBlockHeight -\n        this.constants_.TAB_OFFSET_FROM_TOP -\n        this.constants_.MEDIUM_PADDING;\n    }\n\n    this.width =\n      (this.shape.width as number) +\n      this.constants_.EXTERNAL_VALUE_INPUT_PADDING;\n\n    this.connectionOffsetY = this.constants_.TAB_OFFSET_FROM_TOP;\n\n    this.connectionHeight = this.shape.height as number;\n\n    this.connectionWidth = this.shape.width as number;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Field\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Field as BlocklyField} from '../../field.js';\nimport type {Input} from '../../inputs/input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a field takes up during\n * rendering\n */\nexport class Field extends Measurable {\n  isEditable: boolean;\n  flipRtl: boolean;\n  override height: number;\n  override width: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param field The field to measure and store information for.\n   * @param parentInput The parent input for the field.\n   */\n  constructor(\n    constants: ConstantProvider,\n    public field: BlocklyField,\n    public parentInput: Input,\n  ) {\n    super(constants);\n\n    this.isEditable = field.EDITABLE;\n\n    this.flipRtl = field.getFlipRtl();\n    this.type |= Types.FIELD;\n\n    const size = this.field.getSize();\n\n    this.height = size.height;\n\n    this.width = size.width;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Hat\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a hat takes up during\n * rendering.\n */\nexport class Hat extends Measurable {\n  ascenderHeight: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.HAT;\n\n    this.height = this.constants_.START_HAT.height;\n    this.width = this.constants_.START_HAT.width;\n\n    this.ascenderHeight = this.height;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Icon\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {IIcon as BlocklyIcon} from '../../interfaces/i_icon.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space an icon takes up during\n * rendering.\n */\nexport class Icon extends Measurable {\n  flipRtl = false;\n\n  /**\n   * An object containing information about the space an icon takes up during\n   * rendering.\n   *\n   * @param constants The rendering constants provider.\n   * @param icon The icon to measure and store information for.\n   */\n  constructor(\n    constants: ConstantProvider,\n    public icon: BlocklyIcon,\n  ) {\n    super(constants);\n\n    this.type |= Types.ICON;\n\n    const size = icon.getSize();\n    this.height = size.height;\n    this.width = size.width;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.InRowSpacer\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about a spacer between two elements on a\n * row.\n */\nexport class InRowSpacer extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   * @param width The width of the spacer.\n   */\n  constructor(constants: ConstantProvider, width: number) {\n    super(constants);\n    this.type |= Types.SPACER | Types.IN_ROW_SPACER;\n    this.width = width;\n    this.height = this.constants_.SPACER_DEFAULT_HEIGHT;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.InlineInput\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../inputs/input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space an inline input takes up\n * during rendering.\n */\nexport class InlineInput extends InputConnection {\n  connectionHeight: number;\n  connectionWidth: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The inline input to measure and store information for.\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n    this.type |= Types.INLINE_INPUT;\n\n    if (!this.connectedBlock) {\n      this.height = this.constants_.EMPTY_INLINE_INPUT_HEIGHT;\n      this.width = this.constants_.EMPTY_INLINE_INPUT_PADDING;\n    } else {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.width = this.connectedBlockWidth;\n      this.height = this.connectedBlockHeight;\n    }\n\n    this.connectionHeight = !this.isDynamicShape\n      ? (this.shape.height as number)\n      : (this.shape.height as (p1: number) => number)(this.height);\n\n    this.connectionWidth = !this.isDynamicShape\n      ? (this.shape.width as number)\n      : (this.shape.width as (p1: number) => number)(this.height);\n    if (!this.connectedBlock) {\n      this.width += this.connectionWidth * (this.isDynamicShape ? 2 : 1);\n    }\n\n    this.connectionOffsetY =\n      'connectionOffsetY' in this.shape\n        ? this.shape.connectionOffsetY(this.connectionHeight)\n        : this.constants_.TAB_OFFSET_FROM_TOP;\n\n    this.connectionOffsetX =\n      'connectionOffsetX' in this.shape\n        ? this.shape.connectionOffsetX(this.connectionWidth)\n        : 0;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.StatementInput\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../inputs/input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a statement input takes up\n * during rendering\n */\nexport class StatementInput extends InputConnection {\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The statement input to measure and store information for.\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n    this.type |= Types.STATEMENT_INPUT;\n\n    if (!this.connectedBlock) {\n      this.height = this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT;\n    } else {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.height =\n        this.connectedBlockHeight + this.constants_.STATEMENT_BOTTOM_SPACER;\n    }\n    this.width =\n      this.constants_.STATEMENT_INPUT_NOTCH_OFFSET +\n      (this.shape.width as number);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.InputRow\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {ExternalValueInput} from './external_value_input.js';\nimport {InputConnection} from './input_connection.js';\nimport {Row} from './row.js';\nimport {StatementInput} from './statement_input.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about a row that holds one or more inputs.\n */\nexport class InputRow extends Row {\n  /**\n   * The total width of all blocks connected to this row.\n   */\n  connectedBlockWidths = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.INPUT_ROW;\n  }\n\n  /**\n   * Inspect all subcomponents and populate all size properties on the row.\n   */\n  override measure() {\n    this.width = this.minWidth;\n    this.height = this.minHeight;\n    let connectedBlockWidths = 0;\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      this.width += elem.width;\n      if (Types.isInput(elem) && elem instanceof InputConnection) {\n        if (Types.isStatementInput(elem) && elem instanceof StatementInput) {\n          connectedBlockWidths += elem.connectedBlockWidth;\n        } else if (\n          Types.isExternalInput(elem) &&\n          elem instanceof ExternalValueInput &&\n          elem.connectedBlockWidth !== 0\n        ) {\n          connectedBlockWidths +=\n            elem.connectedBlockWidth - elem.connectionWidth;\n        }\n      }\n      if (!Types.isSpacer(elem)) {\n        this.height = Math.max(this.height, elem.height);\n      }\n    }\n    this.connectedBlockWidths = connectedBlockWidths;\n    this.widthWithConnectedBlocks = this.width + connectedBlockWidths;\n  }\n\n  override endsWithElemSpacer() {\n    return !this.hasExternalInput && !this.hasStatement;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.JaggedEdge\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space the jagged edge of a\n * collapsed block takes up during rendering.\n */\nexport class JaggedEdge extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.JAGGED_EDGE;\n    this.height = this.constants_.JAGGED_TEETH.height;\n    this.width = this.constants_.JAGGED_TEETH.width;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.NextConnection\n\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a next connection takes\n * up during rendering.\n */\nexport class NextConnection extends Connection {\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   */\n  constructor(\n    constants: ConstantProvider,\n    connectionModel: RenderedConnection,\n  ) {\n    super(constants, connectionModel);\n    this.type |= Types.NEXT_CONNECTION;\n    this.height = this.shape.height as number;\n    this.width = this.shape.width as number;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.OutputConnection\n\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space an output connection takes\n * up during rendering.\n */\nexport class OutputConnection extends Connection {\n  startX: number;\n  connectionOffsetY: number;\n  connectionOffsetX = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   */\n  constructor(\n    constants: ConstantProvider,\n    connectionModel: RenderedConnection,\n  ) {\n    super(constants, connectionModel);\n    this.type |= Types.OUTPUT_CONNECTION;\n\n    this.height = !this.isDynamicShape ? (this.shape.height as number) : 0;\n    this.width = !this.isDynamicShape ? (this.shape.width as number) : 0;\n\n    this.startX = this.width;\n\n    this.connectionOffsetY = this.constants_.TAB_OFFSET_FROM_TOP;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.PreviousConnection\n\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a previous connection takes\n * up during rendering.\n */\nexport class PreviousConnection extends Connection {\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   */\n  constructor(\n    constants: ConstantProvider,\n    connectionModel: RenderedConnection,\n  ) {\n    super(constants, connectionModel);\n    this.type |= Types.PREVIOUS_CONNECTION;\n    this.height = this.shape.height as number;\n    this.width = this.shape.width as number;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.RoundCorner\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a rounded corner takes up\n * during rendering.\n */\nexport class RoundCorner extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   * @param opt_position The position of this corner.\n   */\n  constructor(constants: ConstantProvider, opt_position?: string) {\n    super(constants);\n    this.type =\n      (!opt_position || opt_position === 'left'\n        ? Types.LEFT_ROUND_CORNER\n        : Types.RIGHT_ROUND_CORNER) | Types.CORNER;\n    this.width = this.constants_.CORNER_RADIUS;\n    // The rounded corner extends into the next row by 4 so we only take the\n    // height that is aligned with this row.\n    this.height = this.constants_.CORNER_RADIUS / 2;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.SpacerRow\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InRowSpacer} from './in_row_spacer.js';\nimport {Row} from './row.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about a spacer between two rows.\n */\nexport class SpacerRow extends Row {\n  followsStatement = false;\n\n  precedesStatement = false;\n\n  override widthWithConnectedBlocks = 0;\n  override elements: InRowSpacer[];\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param height The height of the spacer.\n   * @param width The width of the spacer.\n   */\n  constructor(\n    constants: ConstantProvider,\n    public override height: number,\n    public override width: number,\n  ) {\n    super(constants);\n    this.type |= Types.SPACER | Types.BETWEEN_ROW_SPACER;\n\n    this.elements = [new InRowSpacer(this.constants_, width)];\n  }\n\n  override measure() {}\n}\n// NOP.  Width and height were set at creation.\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.SquareCorner\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a square corner takes up\n * during rendering.\n */\nexport class SquareCorner extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   * @param opt_position The position of this corner.\n   */\n  constructor(constants: ConstantProvider, opt_position?: string) {\n    super(constants);\n    this.type =\n      (!opt_position || opt_position === 'left'\n        ? Types.LEFT_SQUARE_CORNER\n        : Types.RIGHT_SQUARE_CORNER) | Types.CORNER;\n    this.height = this.constants_.NO_PADDING;\n    this.width = this.constants_.NO_PADDING;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.TopRow\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Hat} from './hat.js';\nimport type {PreviousConnection} from './previous_connection.js';\nimport {Row} from './row.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about what elements are in the top row of a\n * block as well as sizing information for the top row.\n * Elements in a top row can consist of corners, hats, spacers, and previous\n * connections.\n * After this constructor is called, the row will contain all non-spacer\n * elements it needs.\n */\nexport class TopRow extends Row {\n  /**\n   * The starting point for drawing the row, in the y direction.\n   * This allows us to draw hats and similar shapes that don't start at the\n   * origin. Must be non-negative (see #2820).\n   */\n  capline = 0;\n\n  /** How much the row extends up above its capline. */\n  ascenderHeight = 0;\n\n  /** Whether the block has a previous connection. */\n  hasPreviousConnection = false;\n\n  /** The previous connection on the block, if any. */\n  connection: PreviousConnection | null = null;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n\n    this.type |= Types.TOP_ROW;\n  }\n\n  /**\n   * Returns whether or not the top row has a left square corner.\n   *\n   * @param block The block whose top row this represents.\n   * @returns Whether or not the top row has a left square corner.\n   */\n  hasLeftSquareCorner(block: BlockSvg): boolean {\n    const hasHat =\n      (block.hat ? block.hat === 'cap' : this.constants_.ADD_START_HATS) &&\n      !block.outputConnection &&\n      !block.previousConnection;\n    const prevBlock = block.getPreviousBlock();\n\n    return (\n      !!block.outputConnection ||\n      hasHat ||\n      (prevBlock ? prevBlock.getNextBlock() === block : false)\n    );\n  }\n\n  /**\n   * Returns whether or not the top row has a right square corner.\n   *\n   * @param _block The block whose top row this represents.\n   * @returns Whether or not the top row has a right square corner.\n   */\n  hasRightSquareCorner(_block: BlockSvg): boolean {\n    return true;\n  }\n\n  override measure() {\n    let height = 0;\n    let width = 0;\n    let ascenderHeight = 0;\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      width += elem.width;\n      if (!Types.isSpacer(elem)) {\n        if (Types.isHat(elem) && elem instanceof Hat) {\n          ascenderHeight = Math.max(ascenderHeight, elem.ascenderHeight);\n        } else {\n          height = Math.max(height, elem.height);\n        }\n      }\n    }\n    this.width = Math.max(this.minWidth, width);\n    this.height = Math.max(this.minHeight, height) + ascenderHeight;\n    this.ascenderHeight = ascenderHeight;\n    this.capline = this.ascenderHeight;\n    this.widthWithConnectedBlocks = this.width;\n  }\n\n  override startsWithElemSpacer() {\n    return false;\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Drawer\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {Coordinate} from '../../utils.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport {Connection} from '../measurables/connection.js';\nimport type {ExternalValueInput} from '../measurables/external_value_input.js';\nimport type {Field} from '../measurables/field.js';\nimport type {Icon} from '../measurables/icon.js';\nimport type {InlineInput} from '../measurables/inline_input.js';\nimport type {PreviousConnection} from '../measurables/previous_connection.js';\nimport type {Row} from '../measurables/row.js';\nimport {Types} from '../measurables/types.js';\n\nimport {isDynamicShape, isNotch, isPuzzleTab} from './constants.js';\nimport type {ConstantProvider, Notch, PuzzleTab} from './constants.js';\nimport type {RenderInfo} from './info.js';\nimport {ConnectionType} from '../../connection_type.js';\n\n/**\n * An object that draws a block based on the given rendering information.\n */\nexport class Drawer {\n  block_: BlockSvg;\n  info_: RenderInfo;\n  topLeft_: Coordinate;\n  outlinePath_ = '';\n  inlinePath_ = '';\n  protected constants_: ConstantProvider;\n\n  /**\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   */\n  constructor(block: BlockSvg, info: RenderInfo) {\n    this.block_ = block;\n    this.info_ = info;\n    this.topLeft_ = block.getRelativeToSurfaceXY();\n\n    /** The renderer's constant provider. */\n    this.constants_ = info.getRenderer().getConstants();\n  }\n\n  /**\n   * Draw the block to the workspace. Here \"drawing\" means setting SVG path\n   * elements and moving fields, icons, and connections on the screen.\n   *\n   * The pieces of the paths are pushed into arrays of \"steps\", which are then\n   * joined with spaces and set directly on the block.  This guarantees that\n   * the steps are separated by spaces for improved readability, but isn't\n   * required.\n   */\n  draw() {\n    this.drawOutline_();\n    this.drawInternals_();\n    this.updateConnectionHighlights();\n\n    this.block_.pathObject.setPath(this.outlinePath_ + '\\n' + this.inlinePath_);\n    if (this.info_.RTL) {\n      this.block_.pathObject.flipRTL();\n    }\n    this.recordSizeOnBlock_();\n  }\n\n  /**\n   * Save sizing information back to the block\n   * Most of the rendering information can be thrown away at the end of the\n   * render. Anything that needs to be kept around should be set in this\n   * function.\n   */\n  protected recordSizeOnBlock_() {\n    // This is used when the block is reporting its size to anyone else.\n    // The dark path adds to the size of the block in both X and Y.\n    this.block_.height = this.info_.height;\n    this.block_.width = this.info_.widthWithChildren;\n  }\n\n  /** Create the outline of the block.  This is a single continuous path. */\n  protected drawOutline_() {\n    this.drawTop_();\n    for (let r = 1; r < this.info_.rows.length - 1; r++) {\n      const row = this.info_.rows[r];\n      if (row.hasJaggedEdge) {\n        this.drawJaggedEdge_(row);\n      } else if (row.hasStatement) {\n        this.drawStatementInput_(row);\n      } else if (row.hasExternalInput) {\n        this.drawValueInput_(row);\n      } else {\n        this.drawRightSideRow_(row);\n      }\n    }\n    this.drawBottom_();\n    this.drawLeft_();\n  }\n\n  /**\n   * Add steps for the top corner of the block, taking into account\n   * details such as hats and rounded corners.\n   */\n  protected drawTop_() {\n    const topRow = this.info_.topRow;\n    const elements = topRow.elements;\n\n    this.positionPreviousConnection_();\n    this.outlinePath_ += svgPaths.moveBy(topRow.xPos, this.info_.startY);\n    for (let i = 0, elem; (elem = elements[i]); i++) {\n      if (Types.isLeftRoundedCorner(elem)) {\n        this.outlinePath_ += this.constants_.OUTSIDE_CORNERS.topLeft;\n      } else if (Types.isRightRoundedCorner(elem)) {\n        this.outlinePath_ += this.constants_.OUTSIDE_CORNERS.topRight;\n      } else if (\n        Types.isPreviousConnection(elem) &&\n        elem instanceof Connection\n      ) {\n        this.outlinePath_ += (\n          (elem as PreviousConnection).shape as Notch\n        ).pathLeft;\n      } else if (Types.isHat(elem)) {\n        this.outlinePath_ += this.constants_.START_HAT.path;\n      } else if (Types.isSpacer(elem)) {\n        this.outlinePath_ += svgPaths.lineOnAxis('h', elem.width);\n      }\n    }\n    // No branch for a square corner, because it's a no-op.\n    this.outlinePath_ += svgPaths.lineOnAxis('v', topRow.height);\n  }\n\n  /**\n   * Add steps for the jagged edge of a row on a collapsed block.\n   *\n   * @param row The row to draw the side of.\n   */\n  protected drawJaggedEdge_(row: Row) {\n    const remainder = row.height - this.constants_.JAGGED_TEETH.height;\n    this.outlinePath_ +=\n      this.constants_.JAGGED_TEETH.path + svgPaths.lineOnAxis('v', remainder);\n  }\n\n  /**\n   * Add steps for an external value input, rendered as a notch in the side\n   * of the block.\n   *\n   * @param row The row that this input belongs to.\n   */\n  protected drawValueInput_(row: Row) {\n    const input = row.getLastInput() as ExternalValueInput | InlineInput;\n    this.positionExternalValueConnection_(row);\n\n    const pathDown = isDynamicShape(input.shape)\n      ? input.shape.pathDown(input.height)\n      : (input.shape as PuzzleTab).pathDown;\n\n    this.outlinePath_ +=\n      svgPaths.lineOnAxis('H', input.xPos + input.width) +\n      pathDown +\n      svgPaths.lineOnAxis('v', row.height - input.connectionHeight);\n  }\n\n  /**\n   * Add steps for a statement input.\n   *\n   * @param row The row that this input belongs to.\n   */\n  protected drawStatementInput_(row: Row) {\n    const input = row.getLastInput();\n    if (!input) return;\n    // Where to start drawing the notch, which is on the right side in LTR.\n    const x = input.xPos + input.notchOffset + (input.shape as Notch).width;\n\n    const innerTopLeftCorner =\n      (input.shape as Notch).pathRight +\n      svgPaths.lineOnAxis(\n        'h',\n        -(input.notchOffset - this.constants_.INSIDE_CORNERS.width),\n      ) +\n      this.constants_.INSIDE_CORNERS.pathTop;\n\n    const innerHeight = row.height - 2 * this.constants_.INSIDE_CORNERS.height;\n\n    this.outlinePath_ +=\n      svgPaths.lineOnAxis('H', x) +\n      innerTopLeftCorner +\n      svgPaths.lineOnAxis('v', innerHeight) +\n      this.constants_.INSIDE_CORNERS.pathBottom +\n      svgPaths.lineOnAxis('H', row.xPos + row.width);\n\n    this.positionStatementInputConnection_(row);\n  }\n\n  /**\n   * Add steps for the right side of a row that does not have value or\n   * statement input connections.\n   *\n   * @param row The row to draw the side of.\n   */\n  protected drawRightSideRow_(row: Row) {\n    this.outlinePath_ += svgPaths.lineOnAxis('V', row.yPos + row.height);\n  }\n\n  /**\n   * Add steps for the bottom edge of a block, possibly including a notch\n   * for the next connection.\n   */\n  protected drawBottom_() {\n    const bottomRow = this.info_.bottomRow;\n    const elems = bottomRow.elements;\n    this.positionNextConnection_();\n\n    let rightCornerYOffset = 0;\n    let outlinePath = '';\n    for (let i = elems.length - 1, elem; (elem = elems[i]); i--) {\n      if (Types.isNextConnection(elem) && elem instanceof Connection) {\n        outlinePath += (elem.shape as Notch).pathRight;\n      } else if (Types.isLeftSquareCorner(elem)) {\n        outlinePath += svgPaths.lineOnAxis('H', bottomRow.xPos);\n      } else if (Types.isLeftRoundedCorner(elem)) {\n        outlinePath += this.constants_.OUTSIDE_CORNERS.bottomLeft;\n      } else if (Types.isRightRoundedCorner(elem)) {\n        outlinePath += this.constants_.OUTSIDE_CORNERS.bottomRight;\n        rightCornerYOffset = this.constants_.OUTSIDE_CORNERS.rightHeight;\n      } else if (Types.isSpacer(elem)) {\n        outlinePath += svgPaths.lineOnAxis('h', elem.width * -1);\n      }\n    }\n\n    this.outlinePath_ += svgPaths.lineOnAxis(\n      'V',\n      bottomRow.baseline - rightCornerYOffset,\n    );\n    this.outlinePath_ += outlinePath;\n  }\n\n  /**\n   * Add steps for the left side of the block, which may include an output\n   * connection\n   */\n  protected drawLeft_() {\n    const outputConnection = this.info_.outputConnection;\n    this.positionOutputConnection_();\n\n    if (outputConnection) {\n      const tabBottom =\n        outputConnection.connectionOffsetY + outputConnection.height;\n      const pathUp = isDynamicShape(outputConnection.shape)\n        ? outputConnection.shape.pathUp(outputConnection.height)\n        : (outputConnection.shape as PuzzleTab).pathUp;\n\n      // Draw a line up to the bottom of the tab.\n      this.outlinePath_ += svgPaths.lineOnAxis('V', tabBottom) + pathUp;\n    }\n    // Close off the path.  This draws a vertical line up to the start of the\n    // block's path, which may be either a rounded or a sharp corner.\n    this.outlinePath_ += 'z';\n  }\n\n  /**\n   * Draw the internals of the block: inline inputs, fields, and icons.  These\n   * do not depend on the outer path for placement.\n   */\n  protected drawInternals_() {\n    for (let i = 0, row; (row = this.info_.rows[i]); i++) {\n      for (let j = 0, elem; (elem = row.elements[j]); j++) {\n        if (Types.isInlineInput(elem)) {\n          this.drawInlineInput_(elem as InlineInput);\n        } else if (Types.isIcon(elem) || Types.isField(elem)) {\n          this.layoutField_(elem as Field | Icon);\n        }\n      }\n    }\n  }\n\n  /**\n   * Push a field or icon's new position to its SVG root.\n   *\n   * @param fieldInfo The rendering information for the field or icon.\n   */\n  protected layoutField_(fieldInfo: Icon | Field) {\n    const yPos = fieldInfo.centerline - fieldInfo.height / 2;\n    let xPos = fieldInfo.xPos;\n    let scale = '';\n    if (this.info_.RTL) {\n      xPos = -(xPos + fieldInfo.width);\n      if (fieldInfo.flipRtl) {\n        xPos += fieldInfo.width;\n        scale = 'scale(-1 1)';\n      }\n    }\n\n    if (Types.isIcon(fieldInfo)) {\n      const icon = (fieldInfo as Icon).icon;\n      icon.setOffsetInBlock(new Coordinate(xPos, yPos));\n      if (this.info_.isInsertionMarker) {\n        icon.hideForInsertionMarker();\n      }\n    } else {\n      const svgGroup = (fieldInfo as Field).field.getSvgRoot()!;\n      svgGroup.setAttribute(\n        'transform',\n        'translate(' + xPos + ',' + yPos + ')' + scale,\n      );\n      if (this.info_.isInsertionMarker) {\n        svgGroup.setAttribute('display', 'none');\n      }\n    }\n  }\n\n  /**\n   * Add steps for an inline input.\n   *\n   * @param input The information about the input to render.\n   */\n  protected drawInlineInput_(input: InlineInput) {\n    const width = input.width;\n    const height = input.height;\n    const yPos = input.centerline - height / 2;\n\n    const connectionTop = input.connectionOffsetY;\n    const connectionBottom = input.connectionHeight + connectionTop;\n    const connectionRight = input.xPos + input.connectionWidth;\n\n    this.inlinePath_ +=\n      svgPaths.moveTo(connectionRight, yPos) +\n      svgPaths.lineOnAxis('v', connectionTop) +\n      (input.shape as PuzzleTab).pathDown +\n      svgPaths.lineOnAxis('v', height - connectionBottom) +\n      svgPaths.lineOnAxis('h', width - input.connectionWidth) +\n      svgPaths.lineOnAxis('v', -height) +\n      'z';\n\n    this.positionInlineInputConnection_(input);\n  }\n\n  /**\n   * Position the connection on an inline value input, taking into account\n   * RTL and the small gap between the parent block and child block which lets\n   * the parent block's dark path show through.\n   *\n   * @param input The information about the input that the connection is on.\n   */\n  protected positionInlineInputConnection_(input: InlineInput) {\n    const yPos = input.centerline - input.height / 2;\n    // Move the connection.\n    if (input.connectionModel) {\n      // xPos already contains info about startX\n      let connX = input.xPos + input.connectionWidth + input.connectionOffsetX;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(\n        connX,\n        yPos + input.connectionOffsetY,\n      );\n    }\n  }\n\n  /**\n   * Position the connection on a statement input, taking into account\n   * RTL and the small gap between the parent block and child block which lets\n   * the parent block's dark path show through.\n   *\n   * @param row The row that the connection is on.\n   */\n  protected positionStatementInputConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input?.connectionModel) {\n      let connX = row.xPos + row.statementEdge + input.notchOffset;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(connX, row.yPos);\n    }\n  }\n\n  /**\n   * Position the connection on an external value input, taking into account\n   * RTL and the small gap between the parent block and child block which lets\n   * the parent block's dark path show through.\n   *\n   * @param row The row that the connection is on.\n   */\n  protected positionExternalValueConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input && input.connectionModel) {\n      let connX = row.xPos + row.width;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(connX, row.yPos);\n    }\n  }\n\n  /** Position the previous connection on a block. */\n  protected positionPreviousConnection_() {\n    const topRow = this.info_.topRow;\n    if (topRow.connection) {\n      const x = topRow.xPos + topRow.notchOffset;\n      const connX = this.info_.RTL ? -x : x;\n      topRow.connection.connectionModel.setOffsetInBlock(connX, 0);\n    }\n  }\n\n  /** Position the next connection on a block. */\n  protected positionNextConnection_() {\n    const bottomRow = this.info_.bottomRow;\n\n    if (bottomRow.connection) {\n      const connInfo = bottomRow.connection;\n      const x = connInfo.xPos; // Already contains info about startX.\n      const connX = this.info_.RTL ? -x : x;\n      connInfo.connectionModel.setOffsetInBlock(connX, bottomRow.baseline);\n    }\n  }\n\n  /** Position the output connection on a block. */\n  protected positionOutputConnection_() {\n    if (this.info_.outputConnection) {\n      const x =\n        this.info_.startX + this.info_.outputConnection.connectionOffsetX;\n      const connX = this.info_.RTL ? -x : x;\n      this.block_.outputConnection.setOffsetInBlock(\n        connX,\n        this.info_.outputConnection.connectionOffsetY,\n      );\n    }\n  }\n\n  /**\n   * Updates the path object to reflect which connections on the block are\n   * highlighted.\n   */\n  protected updateConnectionHighlights() {\n    for (const row of this.info_.rows) {\n      for (const elem of row.elements) {\n        if (!(elem instanceof Connection)) continue;\n\n        if (elem.highlighted) {\n          this.drawConnectionHighlightPath(elem);\n        } else {\n          this.block_.pathObject.removeConnectionHighlight?.(\n            elem.connectionModel,\n          );\n        }\n      }\n    }\n  }\n\n  /** Returns a path to highlight the given connection. */\n  drawConnectionHighlightPath(measurable: Connection) {\n    const conn = measurable.connectionModel;\n    let path = '';\n    if (\n      conn.type === ConnectionType.INPUT_VALUE ||\n      conn.type === ConnectionType.OUTPUT_VALUE\n    ) {\n      path = this.getExpressionConnectionHighlightPath(measurable);\n    } else {\n      path = this.getStatementConnectionHighlightPath(measurable);\n    }\n    const block = conn.getSourceBlock();\n    block.pathObject.addConnectionHighlight?.(\n      conn,\n      path,\n      conn.getOffsetInBlock(),\n      block.RTL,\n    );\n  }\n\n  /**\n   * Returns a path to highlight the given conneciton, assuming it is an\n   * input or output connection.\n   */\n  private getExpressionConnectionHighlightPath(connection: Connection): string {\n    let connPath = '';\n    if (isDynamicShape(connection.shape)) {\n      connPath = connection.shape.pathDown(connection.height);\n    } else if (isPuzzleTab(connection.shape)) {\n      connPath = connection.shape.pathDown;\n    }\n\n    // We are assuming that there is room for the tab offset above and below\n    // the tab.\n    const yLen = this.constants_.TAB_OFFSET_FROM_TOP;\n    return (\n      svgPaths.moveBy(0, -yLen) +\n      svgPaths.lineOnAxis('v', yLen) +\n      connPath +\n      svgPaths.lineOnAxis('v', yLen)\n    );\n  }\n\n  /**\n   * Returns a path to highlight the given conneciton, assuming it is a\n   * next or previous connection.\n   */\n  private getStatementConnectionHighlightPath(connection: Connection): string {\n    if (!isNotch(connection.shape)) {\n      throw new Error('Statement connections should have notch shapes');\n    }\n\n    const xLen =\n      this.constants_.NOTCH_OFFSET_LEFT - this.constants_.CORNER_RADIUS;\n    return (\n      svgPaths.moveBy(-xLen, 0) +\n      svgPaths.lineOnAxis('h', xLen) +\n      connection.shape.pathLeft +\n      svgPaths.lineOnAxis('h', xLen)\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Enum for alignment of inputs.\n */\nexport enum Align {\n  LEFT = -1,\n  CENTRE = 0,\n  RIGHT = 1,\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Non-editable, non-serializable text field.  Used for titles,\n *    labels, etc.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldLabel\n\nimport * as dom from './utils/dom.js';\nimport {Field, FieldConfig} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as parsing from './utils/parsing.js';\n\n/**\n * Class for a non-editable, non-serializable text field.\n */\nexport class FieldLabel extends Field<string> {\n  /** The HTML class name to use for this field. */\n  private class: string | null = null;\n\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. This field should not.\n   */\n  override EDITABLE = false;\n\n  /** Text labels should not truncate. */\n  override maxDisplayLength = Infinity;\n\n  /**\n   * @param value The initial value of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param textClass Optional CSS class for the field's text.\n   * @param config A map of options used to configure the field.\n   *    See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/label#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | typeof Field.SKIP_SETUP,\n    textClass?: string,\n    config?: FieldLabelConfig,\n  ) {\n    super(Field.SKIP_SETUP);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    } else {\n      this.class = textClass || null;\n    }\n    this.setValue(value);\n  }\n\n  protected override configure_(config: FieldLabelConfig) {\n    super.configure_(config);\n    if (config.class) this.class = config.class;\n  }\n\n  /**\n   * Create block UI for this label.\n   */\n  override initView() {\n    this.createTextElement_();\n    if (this.class) {\n      dom.addClass(this.getTextElement(), this.class);\n    }\n  }\n\n  /**\n   * Ensure that the input value casts to a valid string.\n   *\n   * @param newValue The input value.\n   * @returns A valid string, or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue?: AnyDuringMigration,\n  ): string | null {\n    if (newValue === null || newValue === undefined) {\n      return null;\n    }\n    return `${newValue}`;\n  }\n\n  /**\n   * Set the CSS class applied to the field's textElement_.\n   *\n   * @param cssClass The new CSS class name, or null to remove.\n   */\n  setClass(cssClass: string | null) {\n    if (this.textElement_) {\n      if (this.class) {\n        dom.removeClass(this.textElement_, this.class);\n      }\n      if (cssClass) {\n        dom.addClass(this.textElement_, cssClass);\n      }\n    }\n    this.class = cssClass;\n  }\n\n  /**\n   * Construct a FieldLabel from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (text, and class).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(options: FieldLabelFromJsonConfig): FieldLabel {\n    const text = parsing.replaceMessageReferences(options.text);\n    // `this` might be a subclass of FieldLabel if that class doesn't override\n    // the static fromJson method.\n    return new this(text, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_label', FieldLabel);\n\nFieldLabel.prototype.DEFAULT_VALUE = '';\n\n// clang-format off\n// Clang does not like the 'class' keyword being used as a property.\n/**\n * Config options for the label field.\n */\nexport interface FieldLabelConfig extends FieldConfig {\n  class?: string;\n}\n// clang-format on\n\n/**\n * fromJson config options for the label field.\n */\nexport interface FieldLabelFromJsonConfig extends FieldLabelConfig {\n  text?: string;\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing an input (value, statement, or dummy).\n *\n * @class\n */\n// Former goog.module ID: Blockly.Input\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport '../field_label.js';\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport type {Connection} from '../connection.js';\nimport type {ConnectionType} from '../connection_type.js';\nimport type {Field} from '../field.js';\nimport * as fieldRegistry from '../field_registry.js';\nimport type {RenderedConnection} from '../rendered_connection.js';\nimport {inputTypes} from './input_types.js';\nimport {Align} from './align.js';\n\n/** Class for an input with optional fields. */\nexport class Input {\n  fieldRow: Field[] = [];\n  /** Alignment of input's fields (left, right or centre). */\n  align = Align.LEFT;\n\n  /** Is the input visible? */\n  private visible = true;\n\n  public readonly type: inputTypes = inputTypes.CUSTOM;\n\n  public connection: Connection | null = null;\n\n  /**\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.\n   * @param sourceBlock The block containing this input.\n   */\n  constructor(\n    public name: string,\n    private sourceBlock: Block,\n  ) {}\n\n  /**\n   * Get the source block for this input.\n   *\n   * @returns The block this input is part of.\n   */\n  getSourceBlock(): Block {\n    return this.sourceBlock;\n  }\n\n  /**\n   * Add a field (or label from string), and all prefix and suffix fields, to\n   * the end of the input's field row.\n   *\n   * @param field Something to add as a field.\n   * @param opt_name Language-neutral identifier which may used to find this\n   *     field again.  Should be unique to the host block.\n   * @returns The input being append to (to allow chaining).\n   */\n  appendField<T>(field: string | Field<T>, opt_name?: string): Input {\n    this.insertFieldAt(this.fieldRow.length, field, opt_name);\n    return this;\n  }\n\n  /**\n   * Inserts a field (or label from string), and all prefix and suffix fields,\n   * at the location of the input's field row.\n   *\n   * @param index The index at which to insert field.\n   * @param field Something to add as a field.\n   * @param opt_name Language-neutral identifier which may used to find this\n   *     field again.  Should be unique to the host block.\n   * @returns The index following the last inserted field.\n   */\n  insertFieldAt<T>(\n    index: number,\n    field: string | Field<T>,\n    opt_name?: string,\n  ): number {\n    if (index < 0 || index > this.fieldRow.length) {\n      throw Error('index ' + index + ' out of bounds.');\n    }\n    // Falsy field values don't generate a field, unless the field is an empty\n    // string and named.\n    if (!field && !(field === '' && opt_name)) {\n      return index;\n    }\n\n    // Generate a FieldLabel when given a plain text field.\n    if (typeof field === 'string') {\n      field = fieldRegistry.fromJson({\n        type: 'field_label',\n        text: field,\n      })!;\n    }\n\n    field.setSourceBlock(this.sourceBlock);\n    if (this.sourceBlock.initialized) this.initField(field);\n    field.name = opt_name;\n    field.setVisible(this.isVisible());\n\n    if (field.prefixField) {\n      // Add any prefix.\n      index = this.insertFieldAt(index, field.prefixField);\n    }\n    // Add the field to the field row.\n    this.fieldRow.splice(index, 0, field as Field);\n    index++;\n    if (field.suffixField) {\n      // Add any suffix.\n      index = this.insertFieldAt(index, field.suffixField);\n    }\n\n    if (this.sourceBlock.rendered) {\n      (this.sourceBlock as BlockSvg).queueRender();\n    }\n    return index;\n  }\n\n  /**\n   * Remove a field from this input.\n   *\n   * @param name The name of the field.\n   * @param opt_quiet True to prevent an error if field is not present.\n   * @returns True if operation succeeds, false if field is not present and\n   *     opt_quiet is true.\n   * @throws {Error} if the field is not present and opt_quiet is false.\n   */\n  removeField(name: string, opt_quiet?: boolean): boolean {\n    for (let i = 0, field; (field = this.fieldRow[i]); i++) {\n      if (field.name === name) {\n        field.dispose();\n        this.fieldRow.splice(i, 1);\n        if (this.sourceBlock.rendered) {\n          (this.sourceBlock as BlockSvg).queueRender();\n        }\n        return true;\n      }\n    }\n    if (opt_quiet) {\n      return false;\n    }\n    throw Error('Field \"' + name + '\" not found.');\n  }\n\n  /**\n   * Gets whether this input is visible or not.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.visible;\n  }\n\n  /**\n   * Sets whether this input is visible or not.\n   * Should only be used to collapse/uncollapse a block.\n   *\n   * @param visible True if visible.\n   * @returns List of blocks to render.\n   * @internal\n   */\n  setVisible(visible: boolean): BlockSvg[] {\n    // Note: Currently there are only unit tests for block.setCollapsed()\n    // because this function is package. If this function goes back to being a\n    // public API tests (lots of tests) should be added.\n    let renderList: AnyDuringMigration[] = [];\n    if (this.visible === visible) {\n      return renderList;\n    }\n    this.visible = visible;\n\n    for (let y = 0, field; (field = this.fieldRow[y]); y++) {\n      field.setVisible(visible);\n    }\n    if (this.connection) {\n      const renderedConnection = this.connection as RenderedConnection;\n      // Has a connection.\n      if (visible) {\n        renderList = renderedConnection.startTrackingAll();\n      } else {\n        renderedConnection.stopTrackingAll();\n      }\n      const child = renderedConnection.targetBlock();\n      if (child) {\n        child.getSvgRoot().style.display = visible ? 'block' : 'none';\n      }\n    }\n    return renderList;\n  }\n\n  /**\n   * Mark all fields on this input as dirty.\n   *\n   * @internal\n   */\n  markDirty() {\n    for (let y = 0, field; (field = this.fieldRow[y]); y++) {\n      field.markDirty();\n    }\n  }\n\n  /**\n   * Change a connection's compatibility.\n   *\n   * @param check Compatible value type or list of value types.  Null if all\n   *     types are compatible.\n   * @returns The input being modified (to allow chaining).\n   */\n  setCheck(check: string | string[] | null): Input {\n    if (!this.connection) {\n      throw Error('This input does not have a connection.');\n    }\n    this.connection.setCheck(check);\n    return this;\n  }\n\n  /**\n   * Change the alignment of the connection's field(s).\n   *\n   * @param align One of the values of Align.  In RTL mode directions\n   *     are reversed, and Align.RIGHT aligns to the left.\n   * @returns The input being modified (to allow chaining).\n   */\n  setAlign(align: Align): Input {\n    this.align = align;\n    if (this.sourceBlock.rendered) {\n      const sourceBlock = this.sourceBlock as BlockSvg;\n      sourceBlock.queueRender();\n    }\n    return this;\n  }\n\n  /**\n   * Changes the connection's shadow block.\n   *\n   * @param shadow DOM representation of a block or null.\n   * @returns The input being modified (to allow chaining).\n   */\n  setShadowDom(shadow: Element | null): Input {\n    if (!this.connection) {\n      throw Error('This input does not have a connection.');\n    }\n    this.connection.setShadowDom(shadow);\n    return this;\n  }\n\n  /**\n   * Returns the XML representation of the connection's shadow block.\n   *\n   * @returns Shadow DOM representation of a block or null.\n   */\n  getShadowDom(): Element | null {\n    if (!this.connection) {\n      throw Error('This input does not have a connection.');\n    }\n    return this.connection.getShadowDom();\n  }\n\n  /** Initialize the fields on this input. */\n  init() {\n    for (const field of this.fieldRow) {\n      field.init();\n    }\n  }\n\n  /**\n   * Initializes the fields on this input for a headless block.\n   *\n   * @internal\n   */\n  public initModel() {\n    for (const field of this.fieldRow) {\n      field.initModel();\n    }\n  }\n\n  /** Initializes the given field. */\n  private initField(field: Field) {\n    if (this.sourceBlock.rendered) {\n      field.init();\n    } else {\n      field.initModel();\n    }\n  }\n\n  /**\n   * Sever all links to this input.\n   */\n  dispose() {\n    for (let i = 0, field; (field = this.fieldRow[i]); i++) {\n      field.dispose();\n    }\n    if (this.connection) {\n      this.connection.dispose();\n    }\n  }\n\n  /**\n   * Constructs a connection based on the type of this input's source block.\n   * Properly handles constructing headless connections for headless blocks\n   * and rendered connections for rendered blocks.\n   *\n   * @returns a connection of the given type, which is either a headless\n   *     or rendered connection, based on the type of this input's source block.\n   */\n  protected makeConnection(type: ConnectionType): Connection {\n    return this.sourceBlock.makeConnection_(type);\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport {Input} from './input.js';\nimport {inputTypes} from './input_types.js';\n\n/** Represents an input on a block with no connection. */\nexport class DummyInput extends Input {\n  readonly type = inputTypes.DUMMY;\n\n  /**\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.\n   * @param block The block containing this input.\n   */\n  constructor(\n    public name: string,\n    block: Block,\n  ) {\n    super(name, block);\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport {Input} from './input.js';\nimport {inputTypes} from './input_types.js';\n\n/**\n * Represents an input on a block that is always the last input in the row. Any\n * following input will be rendered on the next row even if the block has inline\n * inputs. Any newline character in a JSON block definition's message will\n * automatically be parsed as an end-row input.\n */\nexport class EndRowInput extends Input {\n  readonly type = inputTypes.END_ROW;\n\n  /**\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.\n   * @param block The block containing this input.\n   */\n  constructor(\n    public name: string,\n    block: Block,\n  ) {\n    super(name, block);\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport type {Connection} from '../connection.js';\nimport {ConnectionType} from '../connection_type.js';\nimport {Input} from './input.js';\nimport {inputTypes} from './input_types.js';\n\n/** Represents an input on a block with a statement connection. */\nexport class StatementInput extends Input {\n  readonly type = inputTypes.STATEMENT;\n\n  public connection: Connection;\n\n  /**\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.\n   * @param block The block containing this input.\n   */\n  constructor(\n    public name: string,\n    block: Block,\n  ) {\n    // Errors are maintained for people not using typescript.\n    if (!name) throw new Error('Statement inputs must have a non-empty name');\n\n    super(name, block);\n    this.connection = this.makeConnection(ConnectionType.NEXT_STATEMENT);\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport {ConnectionType} from '../connection_type.js';\nimport {Input} from './input.js';\nimport {inputTypes} from './input_types.js';\n\n/** Represents an input on a block with a value connection. */\nexport class ValueInput extends Input {\n  readonly type = inputTypes.VALUE;\n\n  /**\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.\n   * @param block The block containing this input.\n   */\n  constructor(\n    public name: string,\n    block: Block,\n  ) {\n    // Errors are maintained for people not using typescript.\n    if (!name) throw new Error('Value inputs must have a non-empty name');\n    super(name, block);\n    this.connection = this.makeConnection(ConnectionType.INPUT_VALUE);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.RenderInfo\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {Input} from '../../inputs/input.js';\nimport {Align} from '../../inputs/align.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {Measurable} from '../measurables/base.js';\nimport {BottomRow} from '../measurables/bottom_row.js';\nimport {DummyInput} from '../../inputs/dummy_input.js';\nimport {EndRowInput} from '../../inputs/end_row_input.js';\nimport {ExternalValueInput} from '../measurables/external_value_input.js';\nimport {Field} from '../measurables/field.js';\nimport {Hat} from '../measurables/hat.js';\nimport {Icon} from '../measurables/icon.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport {InlineInput} from '../measurables/inline_input.js';\nimport {InputRow} from '../measurables/input_row.js';\nimport {JaggedEdge} from '../measurables/jagged_edge.js';\nimport {NextConnection} from '../measurables/next_connection.js';\nimport {OutputConnection} from '../measurables/output_connection.js';\nimport {PreviousConnection} from '../measurables/previous_connection.js';\nimport {RoundCorner} from '../measurables/round_corner.js';\nimport type {Row} from '../measurables/row.js';\nimport {SpacerRow} from '../measurables/spacer_row.js';\nimport {SquareCorner} from '../measurables/square_corner.js';\nimport {StatementInput as StatementInputMeasurable} from '../measurables/statement_input.js';\nimport {StatementInput} from '../../inputs/statement_input.js';\nimport {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\nimport {ValueInput} from '../../inputs/value_input.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport type {Renderer} from './renderer.js';\nimport {Connection} from '../measurables/connection.js';\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n */\nexport class RenderInfo {\n  block_: BlockSvg;\n  protected constants_: ConstantProvider;\n  outputConnection: OutputConnection | null;\n  isInline: boolean;\n  isCollapsed: boolean;\n  isInsertionMarker: boolean;\n  RTL: boolean;\n\n  /** The block renderer in use. */\n  protected readonly renderer_!: Renderer;\n\n  /** The height of the rendered block, including child blocks. */\n  height = 0;\n\n  /** The width of the rendered block, including child blocks. */\n  widthWithChildren = 0;\n\n  /**\n   * The width of the rendered block, excluding child blocks.  This is the\n   * right edge of the block when rendered LTR.\n   */\n  width = 0;\n  statementEdge = 0;\n\n  /** An array of Row objects containing sizing information. */\n  rows: Row[] = [];\n\n  /** An array of input rows on the block. */\n  inputRows: InputRow[] = [];\n\n  topRow: TopRow;\n  bottomRow: BottomRow;\n\n  // The position of the start point for drawing, relative to the block's\n  // location.\n  startX = 0;\n  startY = 0;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    this.renderer_ = renderer;\n\n    this.block_ = block;\n\n    /** The renderer's constant provider. */\n    this.constants_ = this.renderer_.getConstants();\n\n    /**\n     * A measurable representing the output connection if the block has one.\n     * Otherwise null.\n     */\n    this.outputConnection = block.outputConnection\n      ? new OutputConnection(this.constants_, block.outputConnection)\n      : null;\n\n    /**\n     * Whether the block should be rendered as a single line, either because\n     * it's inline or because it has been collapsed.\n     */\n    this.isInline = block.getInputsInline() && !block.isCollapsed();\n\n    /** Whether the block is collapsed. */\n    this.isCollapsed = block.isCollapsed();\n\n    /**\n     * Whether the block is an insertion marker.  Insertion markers are the same\n     * shape as normal blocks, but don't show fields.\n     */\n    this.isInsertionMarker = block.isInsertionMarker();\n\n    /** True if the block should be rendered right-to-left. */\n    this.RTL = block.RTL;\n\n    /**\n     * An object with rendering information about the top row of the block.\n     */\n    this.topRow = new TopRow(this.constants_);\n\n    /**\n     * An object with rendering information about the bottom row of the block.\n     */\n    this.bottomRow = new BottomRow(this.constants_);\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   */\n  getRenderer(): Renderer {\n    return this.renderer_;\n  }\n\n  /**\n   * Populate this object with all sizing information needed to draw the block.\n   *\n   * This measure pass does not propagate changes to the block (although fields\n   * may choose to rerender when getSize() is called).  However, calling it\n   * repeatedly may be expensive.\n   */\n  measure() {\n    this.createRows_();\n    this.addElemSpacing_();\n    this.addRowSpacing_();\n    this.computeBounds_();\n    this.alignRowElements_();\n    this.finalize_();\n  }\n\n  /**\n   * Create rows of Measurable objects representing all renderable parts of the\n   * block.\n   */\n  protected createRows_() {\n    this.populateTopRow_();\n    this.rows.push(this.topRow);\n    let activeRow = new InputRow(this.constants_);\n    this.inputRows.push(activeRow);\n\n    // Icons always go on the first row, before anything else.\n    const icons = this.block_.getIcons();\n    for (let i = 0, icon; (icon = icons[i]); i++) {\n      const iconInfo = new Icon(this.constants_, icon);\n      if (!this.isCollapsed || icon.isShownWhenCollapsed()) {\n        activeRow.elements.push(iconInfo);\n      }\n    }\n\n    let lastInput = undefined;\n    // Loop across all of the inputs on the block, creating objects for anything\n    // that needs to be rendered and breaking the block up into visual rows.\n    for (let i = 0, input; (input = this.block_.inputList[i]); i++) {\n      if (!input.isVisible()) {\n        continue;\n      }\n      if (this.shouldStartNewRow_(input, lastInput)) {\n        // Finish this row and create a new one.\n        this.rows.push(activeRow);\n        activeRow = new InputRow(this.constants_);\n        this.inputRows.push(activeRow);\n      }\n\n      // All of the fields in an input go on the same row.\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        activeRow.elements.push(new Field(this.constants_, field, input));\n      }\n      this.addInput_(input, activeRow);\n      lastInput = input;\n    }\n\n    if (this.isCollapsed) {\n      activeRow.hasJaggedEdge = true;\n      activeRow.elements.push(new JaggedEdge(this.constants_));\n    }\n\n    if (activeRow.elements.length || activeRow.hasDummyInput) {\n      this.rows.push(activeRow);\n    }\n    this.populateBottomRow_();\n    this.rows.push(this.bottomRow);\n  }\n\n  /**\n   * Create all non-spacer elements that belong on the top row.\n   */\n  protected populateTopRow_() {\n    const hasPrevious = !!this.block_.previousConnection;\n    const hasHat =\n      (this.block_.hat\n        ? this.block_.hat === 'cap'\n        : this.constants_.ADD_START_HATS) &&\n      !this.outputConnection &&\n      !hasPrevious;\n\n    let cornerClass = this.topRow.hasLeftSquareCorner(this.block_)\n      ? SquareCorner\n      : RoundCorner;\n    this.topRow.elements.push(new cornerClass(this.constants_));\n\n    if (hasHat) {\n      const hat = new Hat(this.constants_);\n      this.topRow.elements.push(hat);\n      this.topRow.capline = hat.ascenderHeight;\n    } else if (hasPrevious) {\n      this.topRow.hasPreviousConnection = true;\n      this.topRow.connection = new PreviousConnection(\n        this.constants_,\n        this.block_.previousConnection as RenderedConnection,\n      );\n      this.topRow.elements.push(this.topRow.connection);\n    }\n\n    const precedesStatement =\n      this.block_.inputList.length &&\n      this.block_.inputList[0] instanceof StatementInput;\n\n    // This is the minimum height for the row. If one of its elements has a\n    // greater height it will be overwritten in the compute pass.\n    if (precedesStatement && !this.block_.isCollapsed()) {\n      this.topRow.minHeight =\n        this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT;\n    } else {\n      this.topRow.minHeight = this.constants_.TOP_ROW_MIN_HEIGHT;\n    }\n\n    cornerClass = this.topRow.hasRightSquareCorner(this.block_)\n      ? SquareCorner\n      : RoundCorner;\n    this.topRow.elements.push(new cornerClass(this.constants_, 'right'));\n  }\n\n  /**\n   * Create all non-spacer elements that belong on the bottom row.\n   */\n  protected populateBottomRow_() {\n    this.bottomRow.hasNextConnection = !!this.block_.nextConnection;\n\n    const followsStatement =\n      this.block_.inputList.length &&\n      this.block_.inputList[this.block_.inputList.length - 1] instanceof\n        StatementInput;\n\n    // This is the minimum height for the row. If one of its elements has a\n    // greater height it will be overwritten in the compute pass.\n    if (followsStatement) {\n      this.bottomRow.minHeight =\n        this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT;\n    } else {\n      this.bottomRow.minHeight = this.constants_.BOTTOM_ROW_MIN_HEIGHT;\n    }\n\n    const leftSquareCorner = this.bottomRow.hasLeftSquareCorner(this.block_);\n\n    if (leftSquareCorner) {\n      this.bottomRow.elements.push(new SquareCorner(this.constants_));\n    } else {\n      this.bottomRow.elements.push(new RoundCorner(this.constants_));\n    }\n\n    if (this.bottomRow.hasNextConnection) {\n      this.bottomRow.connection = new NextConnection(\n        this.constants_,\n        this.block_.nextConnection as RenderedConnection,\n      );\n      this.bottomRow.elements.push(this.bottomRow.connection);\n    }\n\n    const rightSquareCorner = this.bottomRow.hasRightSquareCorner(this.block_);\n\n    if (rightSquareCorner) {\n      this.bottomRow.elements.push(new SquareCorner(this.constants_, 'right'));\n    } else {\n      this.bottomRow.elements.push(new RoundCorner(this.constants_, 'right'));\n    }\n  }\n\n  /**\n   * Add an input element to the active row, if needed, and record the type of\n   * the input on the row.\n   *\n   * @param input The input to record information about.\n   * @param activeRow The row that is currently being populated.\n   */\n  protected addInput_(input: Input, activeRow: Row) {\n    // Non-dummy inputs have visual representations onscreen.\n    if (this.isInline && input instanceof ValueInput) {\n      activeRow.elements.push(new InlineInput(this.constants_, input));\n      activeRow.hasInlineInput = true;\n    } else if (input instanceof StatementInput) {\n      activeRow.elements.push(\n        new StatementInputMeasurable(this.constants_, input),\n      );\n      activeRow.hasStatement = true;\n    } else if (input instanceof ValueInput) {\n      activeRow.elements.push(new ExternalValueInput(this.constants_, input));\n      activeRow.hasExternalInput = true;\n    } else if (input instanceof DummyInput || input instanceof EndRowInput) {\n      // Dummy and end-row inputs have no visual representation, but the\n      // information is still important.\n      activeRow.minHeight = Math.max(\n        activeRow.minHeight,\n        input.getSourceBlock() && input.getSourceBlock()!.isShadow()\n          ? this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT\n          : this.constants_.DUMMY_INPUT_MIN_HEIGHT,\n      );\n      activeRow.hasDummyInput = true;\n    }\n    if (activeRow.align === null) {\n      activeRow.align = input.align;\n    }\n  }\n\n  /**\n   * Decide whether to start a new row between the two Blockly.Inputs.\n   *\n   * @param currInput The current input.\n   * @param prevInput The previous input.\n   * @returns True if the current input should be rendered on a new row.\n   */\n  protected shouldStartNewRow_(currInput: Input, prevInput?: Input): boolean {\n    // If this is the first input, just add to the existing row.\n    // That row is either empty or has some icons in it.\n    if (!prevInput) {\n      return false;\n    }\n    // If the previous input was an end-row input, then any following input\n    // should always be rendered on the next row.\n    if (prevInput instanceof EndRowInput) {\n      return true;\n    }\n    // A statement input or an input following one always gets a new row.\n    if (\n      currInput instanceof StatementInput ||\n      prevInput instanceof StatementInput\n    ) {\n      return true;\n    }\n    // Value inputs, dummy inputs, and any input following an external value\n    // input get a new row if inputs are not inlined.\n    if (\n      currInput instanceof ValueInput ||\n      currInput instanceof DummyInput ||\n      prevInput instanceof ValueInput\n    ) {\n      return !this.isInline;\n    }\n    return false;\n  }\n\n  /** Add horizontal spacing between and around elements within each row. */\n  protected addElemSpacing_() {\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      const oldElems = row.elements;\n      row.elements = [];\n      // No spacing needed before the corner on the top row or the bottom row.\n      if (row.startsWithElemSpacer()) {\n        // There's a spacer before the first element in the row.\n        row.elements.push(\n          new InRowSpacer(\n            this.constants_,\n            this.getInRowSpacing_(null, oldElems[0]),\n          ),\n        );\n      }\n      if (!oldElems.length) {\n        continue;\n      }\n      for (let e = 0; e < oldElems.length - 1; e++) {\n        row.elements.push(oldElems[e]);\n        const spacing = this.getInRowSpacing_(oldElems[e], oldElems[e + 1]);\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n      row.elements.push(oldElems[oldElems.length - 1]);\n      if (row.endsWithElemSpacer()) {\n        // There's a spacer after the last element in the row.\n        row.elements.push(\n          new InRowSpacer(\n            this.constants_,\n            this.getInRowSpacing_(oldElems[oldElems.length - 1], null),\n          ),\n        );\n      }\n    }\n  }\n\n  /**\n   * Calculate the width of a spacer element in a row based on the previous and\n   * next elements in that row.  For instance, extra padding is added between\n   * two editable fields.\n   *\n   * @param prev The element before the spacer.\n   * @param next The element after the spacer.\n   * @returns The size of the spacing between the two elements.\n   */\n  protected getInRowSpacing_(\n    prev: Measurable | null,\n    next: Measurable | null,\n  ): number {\n    if (!prev) {\n      // Statement input padding.\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n    }\n    // Between inputs and the end of the row.\n    if (prev && Types.isInput(prev) && !next) {\n      if (Types.isExternalInput(prev)) {\n        return this.constants_.NO_PADDING;\n      } else if (Types.isInlineInput(prev)) {\n        return this.constants_.LARGE_PADDING;\n      } else if (Types.isStatementInput(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n\n    // Spacing between a square corner and a previous or next connection\n    if (prev && Types.isLeftSquareCorner(prev) && next) {\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset;\n      }\n    }\n\n    // Spacing between a rounded corner and a previous or next connection.\n    if (prev && Types.isLeftRoundedCorner(prev) && next) {\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset - this.constants_.CORNER_RADIUS;\n      }\n    }\n\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  /**\n   * Figure out where the right edge of the block and right edge of statement\n   * inputs should be placed.\n   */\n  protected computeBounds_() {\n    let widestStatementRowFields = 0;\n    let blockWidth = 0;\n    let widestRowWithConnectedBlocks = 0;\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      row.measure();\n      blockWidth = Math.max(blockWidth, row.width);\n      if (row.hasStatement) {\n        const statementInput = row.getLastInput();\n        const innerWidth = row.width - (statementInput?.width ?? 0);\n        widestStatementRowFields = Math.max(\n          widestStatementRowFields,\n          innerWidth,\n        );\n      }\n      widestRowWithConnectedBlocks = Math.max(\n        widestRowWithConnectedBlocks,\n        row.widthWithConnectedBlocks,\n      );\n    }\n\n    this.statementEdge = widestStatementRowFields;\n    this.width = blockWidth;\n\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      if (row.hasStatement) {\n        row.statementEdge = this.statementEdge;\n      }\n    }\n\n    this.widthWithChildren = Math.max(blockWidth, widestRowWithConnectedBlocks);\n\n    if (this.outputConnection) {\n      this.startX = this.outputConnection.width;\n      this.width += this.outputConnection.width;\n      this.widthWithChildren += this.outputConnection.width;\n    }\n  }\n\n  /**\n   * Extra spacing may be necessary to make sure that the right sides of all\n   * rows line up.  This can only be calculated after a first pass to calculate\n   * the sizes of all rows.\n   */\n  protected alignRowElements_() {\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      if (row.hasStatement) {\n        this.alignStatementRow_(row as InputRow);\n      } else {\n        const currentWidth = row.width;\n        const desiredWidth = this.getDesiredRowWidth_(row);\n        const missingSpace = desiredWidth - currentWidth;\n        if (missingSpace > 0) {\n          this.addAlignmentPadding_(row, missingSpace);\n        }\n        if (Types.isTopOrBottomRow(row)) {\n          row.widthWithConnectedBlocks = row.width;\n        }\n      }\n    }\n  }\n\n  /**\n   * Calculate the desired width of an input row.\n   *\n   * @param _row The input row.\n   * @returns The desired width of the input row.\n   */\n  protected getDesiredRowWidth_(_row: Row): number {\n    return this.width - this.startX;\n  }\n\n  /**\n   * Modify the given row to add the given amount of padding around its fields.\n   * The exact location of the padding is based on the alignment property of the\n   * last input in the field.\n   *\n   * @param row The row to add padding to.\n   * @param missingSpace How much padding to add.\n   */\n  protected addAlignmentPadding_(row: Row, missingSpace: number) {\n    const firstSpacer = row.getFirstSpacer();\n    const lastSpacer = row.getLastSpacer();\n    if (row.hasExternalInput || row.hasStatement) {\n      row.widthWithConnectedBlocks += missingSpace;\n    }\n\n    // Decide where the extra padding goes.\n    if (row.align === Align.LEFT && lastSpacer) {\n      // Add padding to the end of the row.\n      lastSpacer.width += missingSpace;\n    } else if (row.align === Align.CENTRE && firstSpacer && lastSpacer) {\n      // Split the padding between the beginning and end of the row.\n      firstSpacer.width += missingSpace / 2;\n      lastSpacer.width += missingSpace / 2;\n    } else if (row.align === Align.RIGHT && firstSpacer) {\n      // Add padding at the beginning of the row.\n      firstSpacer.width += missingSpace;\n    } else if (lastSpacer) {\n      // Default to left-aligning.\n      lastSpacer.width += missingSpace;\n    } else {\n      return;\n    }\n    row.width += missingSpace;\n  }\n\n  /**\n   * Align the elements of a statement row based on computed bounds.\n   * Unlike other types of rows, statement rows add space in multiple places.\n   *\n   * @param row The statement row to resize.\n   */\n  protected alignStatementRow_(row: InputRow) {\n    const statementInput = row.getLastInput();\n    if (!statementInput) return;\n    let currentWidth = row.width - statementInput.width;\n    let desiredWidth = this.statementEdge;\n    // Add padding before the statement input.\n    const missingSpace = desiredWidth - currentWidth;\n    if (missingSpace > 0) {\n      this.addAlignmentPadding_(row, missingSpace);\n    }\n    // Also widen the statement input to reach to the right side of the\n    // block. Note that this does not add padding.\n    currentWidth = row.width;\n    desiredWidth = this.getDesiredRowWidth_(row);\n    statementInput.width += desiredWidth - currentWidth;\n    statementInput.height = Math.max(statementInput.height, row.height);\n    row.width += desiredWidth - currentWidth;\n    row.widthWithConnectedBlocks = Math.max(\n      row.width,\n      this.statementEdge + row.connectedBlockWidths,\n    );\n  }\n\n  /** Add spacers between rows and set their sizes. */\n  protected addRowSpacing_() {\n    const oldRows = this.rows;\n    this.rows = [];\n\n    for (let r = 0; r < oldRows.length; r++) {\n      this.rows.push(oldRows[r]);\n      if (r !== oldRows.length - 1) {\n        this.rows.push(this.makeSpacerRow_(oldRows[r], oldRows[r + 1]));\n      }\n    }\n  }\n\n  /**\n   * Create a spacer row to go between prev and next, and set its size.\n   *\n   * @param prev The previous row.\n   * @param next The next row.\n   * @returns The newly created spacer row.\n   */\n  protected makeSpacerRow_(prev: Row, next: Row): SpacerRow {\n    const height = this.getSpacerRowHeight_(prev, next);\n    const width = this.getSpacerRowWidth_(prev, next);\n    const spacer = new SpacerRow(this.constants_, height, width);\n    if (prev.hasStatement) {\n      spacer.followsStatement = true;\n    }\n    if (next.hasStatement) {\n      spacer.precedesStatement = true;\n    }\n    return spacer;\n  }\n\n  /**\n   * Calculate the width of a spacer row.\n   *\n   * @param _prev The row before the spacer.\n   * @param _next The row after the spacer.\n   * @returns The desired width of the spacer row between these two rows.\n   */\n  protected getSpacerRowWidth_(_prev: Row, _next: Row): number {\n    return this.width - this.startX;\n  }\n\n  /**\n   * Calculate the height of a spacer row.\n   *\n   * @param _prev The row before the spacer.\n   * @param _next The row after the spacer.\n   * @returns The desired height of the spacer row between these two rows.\n   */\n  protected getSpacerRowHeight_(_prev: Row, _next: Row): number {\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  /**\n   * Calculate the centerline of an element in a rendered row.\n   * This base implementation puts the centerline at the middle of the row\n   * vertically, with no special cases.  You will likely need extra logic to\n   * handle (at minimum) top and bottom rows.\n   *\n   * @param row The row containing the element.\n   * @param elem The element to place.\n   * @returns The desired centerline of the given element, as an offset from the\n   *     top left of the block.\n   */\n  protected getElemCenterline_(row: Row, elem: Measurable): number {\n    if (Types.isSpacer(elem)) {\n      return row.yPos + elem.height / 2;\n    }\n    if (Types.isBottomRow(row)) {\n      const bottomRow = row as BottomRow;\n      const baseline =\n        bottomRow.yPos + bottomRow.height - bottomRow.descenderHeight;\n      if (Types.isNextConnection(elem)) {\n        return baseline + elem.height / 2;\n      }\n      return baseline - elem.height / 2;\n    }\n    if (Types.isTopRow(row)) {\n      const topRow = row as TopRow;\n      if (Types.isHat(elem)) {\n        return topRow.capline - elem.height / 2;\n      }\n      return topRow.capline + elem.height / 2;\n    }\n    return row.yPos + row.height / 2;\n  }\n\n  /**\n   * Record final position information on elements on the given row, for use in\n   * drawing.  At minimum this records xPos and centerline on each element.\n   *\n   * @param row The row containing the elements.\n   */\n  protected recordElemPositions_(row: Row) {\n    let xCursor = row.xPos;\n    for (let j = 0, elem; (elem = row.elements[j]); j++) {\n      // Now that row heights are finalized, make spacers use the row height.\n      if (Types.isSpacer(elem)) {\n        elem.height = row.height;\n      }\n      elem.xPos = xCursor;\n      elem.centerline = this.getElemCenterline_(row, elem);\n      xCursor += elem.width;\n    }\n  }\n\n  /**\n   * Make any final changes to the rendering information object.  In particular,\n   * store the y position of each row, and record the height of the full block.\n   */\n  protected finalize_() {\n    // Performance note: this could be combined with the draw pass, if the time\n    // that this takes is excessive.  But it shouldn't be, because it only\n    // accesses and sets properties that already exist on the objects.\n    let widestRowWithConnectedBlocks = 0;\n    let yCursor = 0;\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      row.yPos = yCursor;\n      row.xPos = this.startX;\n      yCursor += row.height;\n\n      widestRowWithConnectedBlocks = Math.max(\n        widestRowWithConnectedBlocks,\n        row.widthWithConnectedBlocks,\n      );\n      this.recordElemPositions_(row);\n    }\n    if (this.outputConnection && this.block_.nextConnection) {\n      const target = this.block_.nextConnection.targetBlock();\n      if (target) {\n        // Include width of connected block in value to stack width measurement.\n        widestRowWithConnectedBlocks = Math.max(\n          widestRowWithConnectedBlocks,\n          target.getHeightWidth().width,\n        );\n      }\n    }\n\n    this.widthWithChildren = widestRowWithConnectedBlocks + this.startX;\n\n    this.height = yCursor;\n    this.startY = this.topRow.capline;\n    this.bottomRow.baseline = yCursor - this.bottomRow.descenderHeight;\n  }\n\n  /** Returns the connection measurable associated with the given connection. */\n  getMeasureableForConnection(conn: RenderedConnection): Connection | null {\n    if (this.outputConnection?.connectionModel === conn) {\n      return this.outputConnection;\n    }\n\n    for (const row of this.rows) {\n      for (const elem of row.elements) {\n        if (elem instanceof Connection && elem.connectionModel === conn) {\n          return elem;\n        }\n      }\n    }\n\n    return null;\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block delete event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BlockDelete\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport * as blocks from '../serialization/blocks.js';\nimport * as utilsXml from '../utils/xml.js';\nimport * as Xml from '../xml.js';\n\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\nimport {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners when a block (or connected stack of blocks) is\n * deleted.\n */\nexport class BlockDelete extends BlockBase {\n  /** The XML representation of the deleted block(s). */\n  oldXml?: Element | DocumentFragment;\n\n  /** The JSON respresentation of the deleted block(s). */\n  oldJson?: blocks.State;\n\n  /** All of the IDs of deleted blocks. */\n  ids?: string[];\n\n  /** True if the deleted block was a shadow block, false otherwise. */\n  wasShadow?: boolean;\n\n  override type = eventUtils.BLOCK_DELETE;\n\n  /** @param opt_block The deleted block.  Undefined for a blank event. */\n  constructor(opt_block?: Block) {\n    super(opt_block);\n\n    if (!opt_block) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    if (opt_block.getParent()) {\n      throw Error('Connected blocks cannot be deleted.');\n    }\n    if (opt_block.isShadow()) {\n      // Respawning shadow blocks is handled via disconnection.\n      this.recordUndo = false;\n    }\n\n    this.oldXml = Xml.blockToDomWithXY(opt_block);\n    this.ids = eventUtils.getDescendantIds(opt_block);\n    this.wasShadow = opt_block.isShadow();\n    this.oldJson = blocks.save(opt_block, {\n      addCoordinates: true,\n    }) as blocks.State;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockDeleteJson {\n    const json = super.toJson() as BlockDeleteJson;\n    if (!this.oldXml) {\n      throw new Error(\n        'The old block XML is undefined. Either pass a block ' +\n          'to the constructor, or call fromJson',\n      );\n    }\n    if (!this.ids) {\n      throw new Error(\n        'The block IDs are undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (this.wasShadow === undefined) {\n      throw new Error(\n        'Whether the block was a shadow is undefined. Either ' +\n          'pass a block to the constructor, or call fromJson',\n      );\n    }\n    if (!this.oldJson) {\n      throw new Error(\n        'The old block JSON is undefined. Either pass a block ' +\n          'to the constructor, or call fromJson',\n      );\n    }\n    json['oldXml'] = Xml.domToText(this.oldXml);\n    json['ids'] = this.ids;\n    json['wasShadow'] = this.wasShadow;\n    json['oldJson'] = this.oldJson;\n    if (!this.recordUndo) {\n      json['recordUndo'] = this.recordUndo;\n    }\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockDelete, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockDeleteJson,\n    workspace: Workspace,\n    event?: any,\n  ): BlockDelete {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockDelete(),\n    ) as BlockDelete;\n    newEvent.oldXml = utilsXml.textToDom(json['oldXml']);\n    newEvent.ids = json['ids'];\n    newEvent.wasShadow =\n      json['wasShadow'] || newEvent.oldXml.tagName.toLowerCase() === 'shadow';\n    newEvent.oldJson = json['oldJson'];\n    if (json['recordUndo'] !== undefined) {\n      newEvent.recordUndo = json['recordUndo'];\n    }\n    return newEvent;\n  }\n\n  /**\n   * Run a deletion event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.ids) {\n      throw new Error(\n        'The block IDs are undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.oldJson) {\n      throw new Error(\n        'The old block JSON is undefined. Either pass a block ' +\n          'to the constructor, or call fromJson',\n      );\n    }\n    if (forward) {\n      for (let i = 0; i < this.ids.length; i++) {\n        const id = this.ids[i];\n        const block = workspace.getBlockById(id);\n        if (block) {\n          block.dispose(false);\n        } else if (id === this.blockId) {\n          // Only complain about root-level block.\n          console.warn(\"Can't delete non-existent block: \" + id);\n        }\n      }\n    } else {\n      blocks.append(this.oldJson, workspace);\n    }\n  }\n}\n\nexport interface BlockDeleteJson extends BlockBaseJson {\n  oldXml: string;\n  ids: string[];\n  wasShadow: boolean;\n  oldJson: blocks.State;\n  recordUndo?: boolean;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.DELETE, BlockDelete);\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing one block.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Block\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_create.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_delete.js';\n\nimport {Blocks} from './blocks.js';\nimport * as common from './common.js';\nimport {Connection} from './connection.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as constants from './constants.js';\nimport {DuplicateIconType} from './icons/exceptions.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BlockChange} from './events/events_block_change.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport * as deprecation from './utils/deprecation.js';\nimport * as eventUtils from './events/utils.js';\nimport * as Extensions from './extensions.js';\nimport type {Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {Input} from './inputs/input.js';\nimport {Align} from './inputs/align.js';\nimport type {IASTNodeLocation} from './interfaces/i_ast_node_location.js';\nimport {type IIcon} from './interfaces/i_icon.js';\nimport {isCommentIcon} from './interfaces/i_comment_icon.js';\nimport type {MutatorIcon} from './icons/mutator_icon.js';\nimport * as Tooltip from './tooltip.js';\nimport * as arrayUtils from './utils/array.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport * as parsing from './utils/parsing.js';\nimport * as registry from './registry.js';\nimport {Size} from './utils/size.js';\nimport type {VariableModel} from './variable_model.js';\nimport type {Workspace} from './workspace.js';\nimport {DummyInput} from './inputs/dummy_input.js';\nimport {EndRowInput} from './inputs/end_row_input.js';\nimport {ValueInput} from './inputs/value_input.js';\nimport {StatementInput} from './inputs/statement_input.js';\nimport {IconType} from './icons/icon_types.js';\n\n/**\n * Class for one block.\n * Not normally called directly, workspace.newBlock() is preferred.\n */\nexport class Block implements IASTNodeLocation {\n  /**\n   * An optional callback method to use whenever the block's parent workspace\n   * changes. This is usually only called from the constructor, the block type\n   * initializer function, or an extension initializer function.\n   */\n  onchange?: ((p1: Abstract) => void) | null;\n\n  /** The language-neutral ID given to the collapsed input. */\n  static readonly COLLAPSED_INPUT_NAME: string = constants.COLLAPSED_INPUT_NAME;\n\n  /** The language-neutral ID given to the collapsed field. */\n  static readonly COLLAPSED_FIELD_NAME: string = constants.COLLAPSED_FIELD_NAME;\n\n  /**\n   * Optional text data that round-trips between blocks and XML.\n   * Has no effect. May be used by 3rd parties for meta information.\n   */\n  data: string | null = null;\n\n  /**\n   * Has this block been disposed of?\n   *\n   * @internal\n   */\n  disposed = false;\n\n  /**\n   * Colour of the block as HSV hue value (0-360)\n   * This may be null if the block colour was not set via a hue number.\n   */\n  private hue_: number | null = null;\n\n  /** Colour of the block in '#RRGGBB' format. */\n  protected colour_ = '#000000';\n\n  /** Name of the block style. */\n  protected styleName_ = '';\n\n  /** An optional method called during initialization. */\n  init?: () => void;\n\n  /** An optional method called during disposal. */\n  destroy?: () => void;\n\n  /**\n   * An optional serialization method for defining how to serialize the\n   * mutation state to XML. This must be coupled with defining\n   * `domToMutation`.\n   */\n  mutationToDom?: (...p1: AnyDuringMigration[]) => Element;\n\n  /**\n   * An optional deserialization method for defining how to deserialize the\n   * mutation state from XML. This must be coupled with defining\n   * `mutationToDom`.\n   */\n  domToMutation?: (p1: Element) => void;\n\n  /**\n   * An optional serialization method for defining how to serialize the\n   * block's extra state (eg mutation state) to something JSON compatible.\n   * This must be coupled with defining `loadExtraState`.\n   *\n   * @param doFullSerialization Whether or not to serialize the full state of\n   *     the extra state (rather than possibly saving a reference to some\n   *     state). This is used during copy-paste. See the\n   *     {@link https://developers.devsite.google.com/blockly/guides/create-custom-blocks/extensions#full_serialization_and_backing_data | block serialization docs}\n   *     for more information.\n   */\n  saveExtraState?: (doFullSerialization?: boolean) => AnyDuringMigration;\n\n  /**\n   * An optional serialization method for defining how to deserialize the\n   * block's extra state (eg mutation state) from something JSON compatible.\n   * This must be coupled with defining `saveExtraState`.\n   */\n  loadExtraState?: (p1: AnyDuringMigration) => void;\n\n  /**\n   * An optional property for suppressing adding STATEMENT_PREFIX and\n   * STATEMENT_SUFFIX to generated code.\n   */\n  suppressPrefixSuffix: boolean | null = false;\n\n  /**\n   * An optional property for declaring developer variables.  Return a list of\n   * variable names for use by generators.  Developer variables are never\n   * shown to the user, but are declared as global variables in the generated\n   * code.\n   */\n  getDeveloperVariables?: () => string[];\n\n  /**\n   * An optional function that reconfigures the block based on the contents of\n   * the mutator dialog.\n   */\n  compose?: (p1: Block) => void;\n\n  /**\n   * An optional function that populates the mutator's dialog with\n   * this block's components.\n   */\n  decompose?: (p1: Workspace) => Block;\n  id: string;\n  outputConnection: Connection | null = null;\n  nextConnection: Connection | null = null;\n  previousConnection: Connection | null = null;\n  inputList: Input[] = [];\n  inputsInline?: boolean;\n  icons: IIcon[] = [];\n  private disabledReasons = new Set<string>();\n  tooltip: Tooltip.TipInfo = '';\n  contextMenu = true;\n\n  protected parentBlock_: this | null = null;\n\n  protected childBlocks_: this[] = [];\n\n  private deletable_ = true;\n\n  private movable_ = true;\n\n  private editable_ = true;\n\n  private isShadow_ = false;\n\n  protected collapsed_ = false;\n  protected outputShape_: number | null = null;\n\n  /**\n   * Is the current block currently in the process of being disposed?\n   */\n  protected disposing = false;\n\n  /**\n   * Has this block been fully initialized? E.g. all fields initailized.\n   *\n   * @internal\n   */\n  initialized = false;\n\n  private readonly xy_: Coordinate;\n  isInFlyout: boolean;\n  isInMutator: boolean;\n  RTL: boolean;\n\n  /** True if this block is an insertion marker. */\n  protected isInsertionMarker_ = false;\n\n  /** Name of the type of hat. */\n  hat?: string;\n\n  /** Is this block a BlockSVG? */\n  readonly rendered: boolean = false;\n\n  /**\n   * String for block help, or function that returns a URL. Null for no help.\n   */\n  helpUrl: string | Function | null = null;\n\n  /** A bound callback function to use when the parent workspace changes. */\n  private onchangeWrapper_: ((p1: Abstract) => void) | null = null;\n\n  /**\n   * A count of statement inputs on the block.\n   *\n   * @internal\n   */\n  statementInputCount = 0;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  type!: string;\n  // Record initial inline state.\n  inputsInlineDefault?: boolean;\n  workspace: Workspace;\n\n  /**\n   * @param workspace The block's workspace.\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   * @throws When the prototypeName is not valid or not allowed.\n   */\n  constructor(workspace: Workspace, prototypeName: string, opt_id?: string) {\n    this.workspace = workspace;\n\n    this.id =\n      opt_id && !workspace.getBlockById(opt_id) ? opt_id : idGenerator.genUid();\n    workspace.setBlockById(this.id, this);\n\n    /**\n     * The block's position in workspace units.  (0, 0) is at the workspace's\n     * origin; scale does not change this value.\n     */\n    this.xy_ = new Coordinate(0, 0);\n    this.isInFlyout = workspace.isFlyout;\n    this.isInMutator = workspace.isMutator;\n\n    this.RTL = workspace.RTL;\n\n    // Copy the type-specific functions and data from the prototype.\n    if (prototypeName) {\n      this.type = prototypeName;\n      const prototype = Blocks[prototypeName];\n      if (!prototype || typeof prototype !== 'object') {\n        throw TypeError('Invalid block definition for type: ' + prototypeName);\n      }\n      Object.assign(this, prototype);\n    }\n\n    workspace.addTopBlock(this);\n    workspace.addTypedBlock(this);\n\n    if (new.target === Block) {\n      this.doInit_();\n    }\n  }\n\n  /** Calls the init() function and handles associated event firing, etc. */\n  protected doInit_() {\n    // All events fired should be part of the same group.\n    // Any events fired during init should not be undoable,\n    // so that block creation is atomic.\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n    const initialUndoFlag = eventUtils.getRecordUndo();\n\n    try {\n      // Call an initialization function, if it exists.\n      if (typeof this.init === 'function') {\n        eventUtils.setRecordUndo(false);\n        this.init();\n        eventUtils.setRecordUndo(initialUndoFlag);\n      }\n\n      // Fire a create event.\n      if (eventUtils.isEnabled()) {\n        eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(this));\n      }\n    } finally {\n      eventUtils.setGroup(existingGroup);\n      // In case init threw, recordUndo flag should still be reset.\n      eventUtils.setRecordUndo(initialUndoFlag);\n    }\n    this.inputsInlineDefault = this.inputsInline;\n\n    // Bind an onchange function, if it exists.\n    if (typeof this.onchange === 'function') {\n      this.setOnChange(this.onchange);\n    }\n  }\n\n  /**\n   * Dispose of this block.\n   *\n   * @param healStack If true, then try to heal any gap by connecting the next\n   *     statement with the previous statement.  Otherwise, dispose of all\n   *     children of this block.\n   */\n  dispose(healStack = false) {\n    this.disposing = true;\n\n    // Dispose of this change listener before unplugging.\n    // Technically not necessary due to the event firing delay.\n    // But future-proofing.\n    if (this.onchangeWrapper_) {\n      this.workspace.removeChangeListener(this.onchangeWrapper_);\n    }\n\n    this.unplug(healStack);\n    if (eventUtils.isEnabled()) {\n      // Constructing the delete event is costly. Only perform if necessary.\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_DELETE))(this));\n    }\n    this.workspace.removeTopBlock(this);\n    this.disposeInternal();\n  }\n\n  /**\n   * Disposes of this block without doing things required by the top block.\n   * E.g. does not fire events, unplug the block, etc.\n   */\n  protected disposeInternal() {\n    this.disposing = true;\n    if (this.onchangeWrapper_) {\n      this.workspace.removeChangeListener(this.onchangeWrapper_);\n    }\n\n    this.workspace.removeTypedBlock(this);\n    this.workspace.removeBlockById(this.id);\n\n    if (typeof this.destroy === 'function') this.destroy();\n\n    this.childBlocks_.forEach((c) => c.disposeInternal());\n    this.inputList.forEach((i) => i.dispose());\n    this.inputList.length = 0;\n    this.getConnections_(true).forEach((c) => c.dispose());\n    this.disposed = true;\n  }\n\n  /**\n   * Returns true if the block is either in the process of being disposed, or\n   * is disposed.\n   *\n   * @internal\n   */\n  isDeadOrDying(): boolean {\n    return this.disposing || this.disposed;\n  }\n\n  /**\n   * Call initModel on all fields on the block.\n   * May be called more than once.\n   * Either initModel or initSvg must be called after creating a block and\n   * before the first interaction with it.  Interactions include UI actions\n   * (e.g. clicking and dragging) and firing events (e.g. create, delete, and\n   * change).\n   */\n  initModel() {\n    if (this.initialized) return;\n    for (const input of this.inputList) {\n      input.initModel();\n    }\n    this.initialized = true;\n  }\n\n  /**\n   * Unplug this block from its superior block.  If this block is a statement,\n   * optionally reconnect the block underneath with the block on top.\n   *\n   * @param opt_healStack Disconnect child statement and reconnect stack.\n   *     Defaults to false.\n   */\n  unplug(opt_healStack?: boolean) {\n    if (this.outputConnection) {\n      this.unplugFromRow_(opt_healStack);\n    }\n    if (this.previousConnection) {\n      this.unplugFromStack_(opt_healStack);\n    }\n  }\n\n  /**\n   * Unplug this block's output from an input on another block.  Optionally\n   * reconnect the block's parent to the only child block, if possible.\n   *\n   * @param opt_healStack Disconnect right-side block and connect to left-side\n   *     block.  Defaults to false.\n   */\n  private unplugFromRow_(opt_healStack?: boolean) {\n    let parentConnection = null;\n    if (this.outputConnection?.isConnected()) {\n      parentConnection = this.outputConnection.targetConnection;\n      // Disconnect from any superior block.\n      this.outputConnection.disconnect();\n    }\n\n    // Return early in obvious cases.\n    if (!parentConnection || !opt_healStack) {\n      return;\n    }\n\n    const thisConnection = this.getOnlyValueConnection_();\n    if (\n      !thisConnection ||\n      !thisConnection.isConnected() ||\n      thisConnection.targetBlock()!.isShadow()\n    ) {\n      // Too many or too few possible connections on this block, or there's\n      // nothing on the other side of this connection.\n      return;\n    }\n\n    const childConnection = thisConnection.targetConnection;\n    // Disconnect the child block.\n    childConnection?.disconnect();\n    // Connect child to the parent if possible, otherwise bump away.\n    if (\n      this.workspace.connectionChecker.canConnect(\n        childConnection,\n        parentConnection,\n        false,\n      )\n    ) {\n      parentConnection.connect(childConnection!);\n    } else {\n      childConnection?.onFailedConnect(parentConnection);\n    }\n  }\n\n  /**\n   * Returns the connection on the value input that is connected to another\n   * block. When an insertion marker is connected to a connection with a block\n   * already attached, the connected block is attached to the insertion marker.\n   * Since only one block can be displaced and attached to the insertion marker\n   * this should only ever return one connection.\n   *\n   * @returns The connection on the value input, or null.\n   */\n  private getOnlyValueConnection_(): Connection | null {\n    let connection = null;\n    for (let i = 0; i < this.inputList.length; i++) {\n      const thisConnection = this.inputList[i].connection;\n      if (\n        thisConnection &&\n        thisConnection.type === ConnectionType.INPUT_VALUE &&\n        thisConnection.targetConnection\n      ) {\n        if (connection) {\n          return null; // More than one value input found.\n        }\n        connection = thisConnection;\n      }\n    }\n    return connection;\n  }\n\n  /**\n   * Unplug this statement block from its superior block.  Optionally reconnect\n   * the block underneath with the block on top.\n   *\n   * @param opt_healStack Disconnect child statement and reconnect stack.\n   *     Defaults to false.\n   */\n  private unplugFromStack_(opt_healStack?: boolean) {\n    let previousTarget = null;\n    if (this.previousConnection?.isConnected()) {\n      // Remember the connection that any next statements need to connect to.\n      previousTarget = this.previousConnection.targetConnection;\n      // Detach this block from the parent's tree.\n      this.previousConnection.disconnect();\n    }\n    const nextBlock = this.getNextBlock();\n    if (opt_healStack && nextBlock && !nextBlock.isShadow()) {\n      // Disconnect the next statement.\n      const nextTarget = this.nextConnection?.targetConnection ?? null;\n      nextTarget?.disconnect();\n      if (\n        previousTarget &&\n        this.workspace.connectionChecker.canConnect(\n          previousTarget,\n          nextTarget,\n          false,\n        )\n      ) {\n        // Attach the next statement to the previous statement.\n        previousTarget.connect(nextTarget!);\n      }\n    }\n  }\n\n  /**\n   * Returns all connections originating from this block.\n   *\n   * @param _all If true, return all connections even hidden ones.\n   * @returns Array of connections.\n   * @internal\n   */\n  getConnections_(_all: boolean): Connection[] {\n    const myConnections = [];\n    if (this.outputConnection) {\n      myConnections.push(this.outputConnection);\n    }\n    if (this.previousConnection) {\n      myConnections.push(this.previousConnection);\n    }\n    if (this.nextConnection) {\n      myConnections.push(this.nextConnection);\n    }\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.connection) {\n        myConnections.push(input.connection);\n      }\n    }\n    return myConnections;\n  }\n\n  /**\n   * Walks down a stack of blocks and finds the last next connection on the\n   * stack.\n   *\n   * @param ignoreShadows If true,the last connection on a non-shadow block will\n   *     be returned. If false, this will follow shadows to find the last\n   *     connection.\n   * @returns The last next connection on the stack, or null.\n   * @internal\n   */\n  lastConnectionInStack(ignoreShadows: boolean): Connection | null {\n    let nextConnection = this.nextConnection;\n    while (nextConnection) {\n      const nextBlock = nextConnection.targetBlock();\n      if (!nextBlock || (ignoreShadows && nextBlock.isShadow())) {\n        return nextConnection;\n      }\n      nextConnection = nextBlock.nextConnection;\n    }\n    return null;\n  }\n\n  /**\n   * Bump unconnected blocks out of alignment.  Two blocks which aren't actually\n   * connected should not coincidentally line up on screen.\n   */\n  bumpNeighbours() {}\n\n  /**\n   * Return the parent block or null if this block is at the top level. The\n   * parent block is either the block connected to the previous connection (for\n   * a statement block) or the block connected to the output connection (for a\n   * value block).\n   *\n   * @returns The block (if any) that holds the current block.\n   */\n  getParent(): this | null {\n    return this.parentBlock_;\n  }\n\n  /**\n   * Return the input that connects to the specified block.\n   *\n   * @param block A block connected to an input on this block.\n   * @returns The input (if any) that connects to the specified block.\n   */\n  getInputWithBlock(block: Block): Input | null {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.connection && input.connection.targetBlock() === block) {\n        return input;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Return the parent block that surrounds the current block, or null if this\n   * block has no surrounding block.  A parent block might just be the previous\n   * statement, whereas the surrounding block is an if statement, while loop,\n   * etc.\n   *\n   * @returns The block (if any) that surrounds the current block.\n   */\n  getSurroundParent(): this | null {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block: this | null = this;\n    let prevBlock;\n    do {\n      prevBlock = block;\n      block = block.getParent();\n      if (!block) {\n        // Ran off the top.\n        return null;\n      }\n    } while (block.getNextBlock() === prevBlock);\n    // This block is an enclosing parent, not just a statement in a stack.\n    return block;\n  }\n\n  /**\n   * Return the next statement block directly connected to this block.\n   *\n   * @returns The next statement block or null.\n   */\n  getNextBlock(): Block | null {\n    return this.nextConnection && this.nextConnection.targetBlock();\n  }\n\n  /**\n   * Returns the block connected to the previous connection.\n   *\n   * @returns The previous statement block or null.\n   */\n  getPreviousBlock(): Block | null {\n    return this.previousConnection && this.previousConnection.targetBlock();\n  }\n\n  /**\n   * Return the top-most block in this block's tree.\n   * This will return itself if this block is at the top level.\n   *\n   * @returns The root block.\n   */\n  getRootBlock(): this {\n    let rootBlock: this;\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block: this | null = this;\n    do {\n      rootBlock = block;\n      block = rootBlock.parentBlock_;\n    } while (block);\n    return rootBlock;\n  }\n\n  /**\n   * Walk up from the given block up through the stack of blocks to find\n   * the top block of the sub stack. If we are nested in a statement input only\n   * find the top-most nested block. Do not go all the way to the root block.\n   *\n   * @returns The top block in a stack.\n   * @internal\n   */\n  getTopStackBlock(): this {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block = this;\n    let previous;\n    do {\n      previous = block.getPreviousBlock();\n      // AnyDuringMigration because:  Type 'Block' is not assignable to type\n      // 'this'.\n    } while (\n      previous &&\n      previous.getNextBlock() === block &&\n      (block = previous as AnyDuringMigration)\n    );\n    return block;\n  }\n\n  /**\n   * Find all the blocks that are directly nested inside this one.\n   * Includes value and statement inputs, as well as any following statement.\n   * Excludes any connection on an output tab or any preceding statement.\n   * Blocks are optionally sorted by position; top to bottom.\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  getChildren(ordered: boolean): Block[] {\n    if (!ordered) {\n      return this.childBlocks_;\n    }\n    const blocks = [];\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.connection) {\n        const child = input.connection.targetBlock();\n        if (child) {\n          blocks.push(child);\n        }\n      }\n    }\n    const next = this.getNextBlock();\n    if (next) {\n      blocks.push(next);\n    }\n    return blocks;\n  }\n\n  /**\n   * Set parent of this block to be a new block or null.\n   *\n   * @param newParent New parent block.\n   * @internal\n   */\n  setParent(newParent: this | null) {\n    if (newParent === this.parentBlock_) {\n      return;\n    }\n\n    // Check that block is connected to new parent if new parent is not null and\n    //    that block is not connected to superior one if new parent is null.\n    const targetBlock =\n      (this.previousConnection && this.previousConnection.targetBlock()) ||\n      (this.outputConnection && this.outputConnection.targetBlock());\n    const isConnected = !!targetBlock;\n\n    if (isConnected && newParent && targetBlock !== newParent) {\n      throw Error('Block connected to superior one that is not new parent.');\n    } else if (!isConnected && newParent) {\n      throw Error('Block not connected to new parent.');\n    } else if (isConnected && !newParent) {\n      throw Error(\n        'Cannot set parent to null while block is still connected to' +\n          ' superior block.',\n      );\n    }\n\n    // This block hasn't actually moved on-screen, so there's no need to\n    // update\n    //     its connection locations.\n    if (this.parentBlock_) {\n      // Remove this block from the old parent's child list.\n      arrayUtils.removeElem(this.parentBlock_.childBlocks_, this);\n    } else {\n      // New parent must be non-null so remove this block from the workspace's\n      //     list of top-most blocks.\n      this.workspace.removeTopBlock(this);\n    }\n\n    this.parentBlock_ = newParent;\n    if (newParent) {\n      // Add this block to the new parent's child list.\n      newParent.childBlocks_.push(this);\n    } else {\n      this.workspace.addTopBlock(this);\n    }\n  }\n\n  /**\n   * Find all the blocks that are directly or indirectly nested inside this one.\n   * Includes this block in the list.\n   * Includes value and statement inputs, as well as any following statements.\n   * Excludes any connection on an output tab or any preceding statements.\n   * Blocks are optionally sorted by position; top to bottom.\n   *\n   * @param ordered Sort the list if true.\n   * @returns Flattened array of blocks.\n   */\n  getDescendants(ordered: boolean): this[] {\n    const blocks = [this];\n    const childBlocks = this.getChildren(ordered);\n    for (let child, i = 0; (child = childBlocks[i]); i++) {\n      // AnyDuringMigration because:  Argument of type 'Block[]' is not\n      // assignable to parameter of type 'this[]'.\n      blocks.push(...(child.getDescendants(ordered) as AnyDuringMigration));\n    }\n    return blocks;\n  }\n\n  /**\n   * Get whether this block is deletable or not.\n   *\n   * @returns True if deletable.\n   */\n  isDeletable(): boolean {\n    return (\n      this.deletable_ &&\n      !this.isShadow_ &&\n      !this.isDeadOrDying() &&\n      !this.workspace.options.readOnly\n    );\n  }\n\n  /**\n   * Return whether this block's own deletable property is true or false.\n   *\n   * @returns True if the block's deletable property is true, false otherwise.\n   */\n  isOwnDeletable(): boolean {\n    return this.deletable_;\n  }\n\n  /**\n   * Set whether this block is deletable or not.\n   *\n   * @param deletable True if deletable.\n   */\n  setDeletable(deletable: boolean) {\n    this.deletable_ = deletable;\n  }\n\n  /**\n   * Get whether this block is movable or not.\n   *\n   * @returns True if movable.\n   * @internal\n   */\n  isMovable(): boolean {\n    return (\n      this.movable_ &&\n      !this.isShadow_ &&\n      !this.isDeadOrDying() &&\n      !this.workspace.options.readOnly\n    );\n  }\n\n  /**\n   * Return whether this block's own movable property is true or false.\n   *\n   * @returns True if the block's movable property is true, false otherwise.\n   * @internal\n   */\n  isOwnMovable(): boolean {\n    return this.movable_;\n  }\n\n  /**\n   * Set whether this block is movable or not.\n   *\n   * @param movable True if movable.\n   */\n  setMovable(movable: boolean) {\n    this.movable_ = movable;\n  }\n\n  /**\n   * Get whether is block is duplicatable or not. If duplicating this block and\n   * descendants will put this block over the workspace's capacity this block is\n   * not duplicatable. If duplicating this block and descendants will put any\n   * type over their maxInstances this block is not duplicatable.\n   *\n   * @returns True if duplicatable.\n   */\n  isDuplicatable(): boolean {\n    if (!this.workspace.hasBlockLimits()) {\n      return true;\n    }\n    return this.workspace.isCapacityAvailable(\n      common.getBlockTypeCounts(this, true),\n    );\n  }\n\n  /**\n   * Get whether this block is a shadow block or not.\n   *\n   * @returns True if a shadow.\n   */\n  isShadow(): boolean {\n    return this.isShadow_;\n  }\n\n  /**\n   * Set whether this block is a shadow block or not.\n   * This method is internal and should not be called by users of Blockly. To\n   * create shadow blocks programmatically call connection.setShadowState\n   *\n   * @param shadow True if a shadow.\n   * @internal\n   */\n  setShadow(shadow: boolean) {\n    this.isShadow_ = shadow;\n  }\n\n  /**\n   * Get whether this block is an insertion marker block or not.\n   *\n   * @returns True if an insertion marker.\n   */\n  isInsertionMarker(): boolean {\n    return this.isInsertionMarker_;\n  }\n\n  /**\n   * Set whether this block is an insertion marker block or not.\n   * Once set this cannot be unset.\n   *\n   * @param insertionMarker True if an insertion marker.\n   * @internal\n   */\n  setInsertionMarker(insertionMarker: boolean) {\n    this.isInsertionMarker_ = insertionMarker;\n  }\n\n  /**\n   * Get whether this block is editable or not.\n   *\n   * @returns True if editable.\n   * @internal\n   */\n  isEditable(): boolean {\n    return (\n      this.editable_ &&\n      !this.isDeadOrDying() &&\n      !this.workspace.options.readOnly\n    );\n  }\n\n  /**\n   * Return whether this block's own editable property is true or false.\n   *\n   * @returns True if the block's editable property is true, false otherwise.\n   */\n  isOwnEditable(): boolean {\n    return this.editable_;\n  }\n\n  /**\n   * Set whether this block is editable or not.\n   *\n   * @param editable True if editable.\n   */\n  setEditable(editable: boolean) {\n    this.editable_ = editable;\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        field.updateEditable();\n      }\n    }\n  }\n\n  /**\n   * Returns if this block has been disposed of / deleted.\n   *\n   * @returns True if this block has been disposed of / deleted.\n   */\n  isDisposed(): boolean {\n    return this.disposed;\n  }\n\n  /**\n   * @returns True if this block is a value block with a single editable field.\n   * @internal\n   */\n  isSimpleReporter(): boolean {\n    if (!this.outputConnection) return false;\n\n    for (const input of this.inputList) {\n      if (input.connection || input.fieldRow.length > 1) return false;\n    }\n    return true;\n  }\n\n  /**\n   * Find the connection on this block that corresponds to the given connection\n   * on the other block.\n   * Used to match connections between a block and its insertion marker.\n   *\n   * @param otherBlock The other block to match against.\n   * @param conn The other connection to match.\n   * @returns The matching connection on this block, or null.\n   * @internal\n   */\n  getMatchingConnection(\n    otherBlock: Block,\n    conn: Connection,\n  ): Connection | null {\n    const connections = this.getConnections_(true);\n    const otherConnections = otherBlock.getConnections_(true);\n    if (connections.length !== otherConnections.length) {\n      throw Error('Connection lists did not match in length.');\n    }\n    for (let i = 0; i < otherConnections.length; i++) {\n      if (otherConnections[i] === conn) {\n        return connections[i];\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Set the URL of this block's help page.\n   *\n   * @param url URL string for block help, or function that returns a URL.  Null\n   *     for no help.\n   */\n  setHelpUrl(url: string | Function) {\n    this.helpUrl = url;\n  }\n\n  /**\n   * Sets the tooltip for this block.\n   *\n   * @param newTip The text for the tooltip, a function that returns the text\n   *     for the tooltip, or a parent object whose tooltip will be used. To not\n   *     display a tooltip pass the empty string.\n   */\n  setTooltip(newTip: Tooltip.TipInfo) {\n    this.tooltip = newTip;\n  }\n\n  /**\n   * Returns the tooltip text for this block.\n   *\n   * @returns The tooltip text for this block.\n   */\n  getTooltip(): string {\n    return Tooltip.getTooltipOfObject(this);\n  }\n\n  /**\n   * Get the colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  getColour(): string {\n    return this.colour_;\n  }\n\n  /**\n   * Get the name of the block style.\n   *\n   * @returns Name of the block style.\n   */\n  getStyleName(): string {\n    return this.styleName_;\n  }\n\n  /**\n   * Get the HSV hue value of a block.  Null if hue not set.\n   *\n   * @returns Hue value (0-360).\n   */\n  getHue(): number | null {\n    return this.hue_;\n  }\n\n  /**\n   * Change the colour of a block.\n   *\n   * @param colour HSV hue value (0 to 360), #RRGGBB string, or a message\n   *     reference string pointing to one of those two values.\n   */\n  setColour(colour: number | string) {\n    const parsed = parsing.parseBlockColour(colour);\n    this.hue_ = parsed.hue;\n    this.colour_ = parsed.hex;\n  }\n\n  /**\n   * Set the style and colour values of a block.\n   *\n   * @param blockStyleName Name of the block style.\n   */\n  setStyle(blockStyleName: string) {\n    this.styleName_ = blockStyleName;\n  }\n\n  /**\n   * Sets a callback function to use whenever the block's parent workspace\n   * changes, replacing any prior onchange handler. This is usually only called\n   * from the constructor, the block type initializer function, or an extension\n   * initializer function.\n   *\n   * @param onchangeFn The callback to call when the block's workspace changes.\n   * @throws {Error} if onchangeFn is not falsey and not a function.\n   */\n  setOnChange(onchangeFn: (p1: Abstract) => void) {\n    if (onchangeFn && typeof onchangeFn !== 'function') {\n      throw Error('onchange must be a function.');\n    }\n    if (this.onchangeWrapper_) {\n      this.workspace.removeChangeListener(this.onchangeWrapper_);\n    }\n    this.onchange = onchangeFn;\n    this.onchangeWrapper_ = onchangeFn.bind(this);\n    this.workspace.addChangeListener(this.onchangeWrapper_);\n  }\n\n  /**\n   * Returns the named field from a block.\n   *\n   * @param name The name of the field.\n   * @returns Named field, or null if field does not exist.\n   */\n  getField(name: string): Field | null {\n    if (typeof name !== 'string') {\n      throw TypeError(\n        'Block.prototype.getField expects a string ' +\n          'with the field name but received ' +\n          (name === undefined ? 'nothing' : name + ' of type ' + typeof name) +\n          ' instead',\n      );\n    }\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (field.name === name) {\n          return field;\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Return all variables referenced by this block.\n   *\n   * @returns List of variable ids.\n   */\n  getVars(): string[] {\n    const vars: string[] = [];\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (field.referencesVariables()) {\n          // NOTE: This only applies to `FieldVariable`, a `Field<string>`\n          vars.push(field.getValue() as string);\n        }\n      }\n    }\n    return vars;\n  }\n\n  /**\n   * Return all variables referenced by this block.\n   *\n   * @returns List of variable models.\n   * @internal\n   */\n  getVarModels(): VariableModel[] {\n    const vars = [];\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (field.referencesVariables()) {\n          const model = this.workspace.getVariableById(\n            field.getValue() as string,\n          );\n          // Check if the variable actually exists (and isn't just a potential\n          // variable).\n          if (model) {\n            vars.push(model);\n          }\n        }\n      }\n    }\n    return vars;\n  }\n\n  /**\n   * Notification that a variable is renaming but keeping the same ID.  If the\n   * variable is in use on this block, rerender to show the new name.\n   *\n   * @param variable The variable being renamed.\n   * @internal\n   */\n  updateVarName(variable: VariableModel) {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (\n          field.referencesVariables() &&\n          variable.getId() === field.getValue()\n        ) {\n          field.refreshVariableName();\n        }\n      }\n    }\n  }\n\n  /**\n   * Notification that a variable is renaming.\n   * If the ID matches one of this block's variables, rename it.\n   *\n   * @param oldId ID of variable to rename.\n   * @param newId ID of new variable.  May be the same as oldId, but with an\n   *     updated name.\n   */\n  renameVarById(oldId: string, newId: string) {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (field.referencesVariables() && oldId === field.getValue()) {\n          field.setValue(newId);\n        }\n      }\n    }\n  }\n\n  /**\n   * Returns the language-neutral value of the given field.\n   *\n   * @param name The name of the field.\n   * @returns Value of the field or null if field does not exist.\n   */\n  getFieldValue(name: string): AnyDuringMigration {\n    const field = this.getField(name);\n    if (field) {\n      return field.getValue();\n    }\n    return null;\n  }\n\n  /**\n   * Sets the value of the given field for this block.\n   *\n   * @param newValue The value to set.\n   * @param name The name of the field to set the value of.\n   */\n  setFieldValue(newValue: AnyDuringMigration, name: string) {\n    const field = this.getField(name);\n    if (!field) {\n      throw Error('Field \"' + name + '\" not found.');\n    }\n    field.setValue(newValue);\n  }\n\n  /**\n   * Set whether this block can chain onto the bottom of another block.\n   *\n   * @param newBoolean True if there can be a previous statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  setPreviousStatement(\n    newBoolean: boolean,\n    opt_check?: string | string[] | null,\n  ) {\n    if (newBoolean) {\n      if (opt_check === undefined) {\n        opt_check = null;\n      }\n      if (!this.previousConnection) {\n        this.previousConnection = this.makeConnection_(\n          ConnectionType.PREVIOUS_STATEMENT,\n        );\n      }\n      this.previousConnection.setCheck(opt_check);\n    } else {\n      if (this.previousConnection) {\n        if (this.previousConnection.isConnected()) {\n          throw Error(\n            'Must disconnect previous statement before removing ' +\n              'connection.',\n          );\n        }\n        this.previousConnection.dispose();\n        this.previousConnection = null;\n      }\n    }\n  }\n\n  /**\n   * Set whether another block can chain onto the bottom of this block.\n   *\n   * @param newBoolean True if there can be a next statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  setNextStatement(newBoolean: boolean, opt_check?: string | string[] | null) {\n    if (newBoolean) {\n      if (opt_check === undefined) {\n        opt_check = null;\n      }\n      if (!this.nextConnection) {\n        this.nextConnection = this.makeConnection_(\n          ConnectionType.NEXT_STATEMENT,\n        );\n      }\n      this.nextConnection.setCheck(opt_check);\n    } else {\n      if (this.nextConnection) {\n        if (this.nextConnection.isConnected()) {\n          throw Error(\n            'Must disconnect next statement before removing ' + 'connection.',\n          );\n        }\n        this.nextConnection.dispose();\n        this.nextConnection = null;\n      }\n    }\n  }\n\n  /**\n   * Set whether this block returns a value.\n   *\n   * @param newBoolean True if there is an output.\n   * @param opt_check Returned type or list of returned types.  Null or\n   *     undefined if any type could be returned (e.g. variable get).\n   */\n  setOutput(newBoolean: boolean, opt_check?: string | string[] | null) {\n    if (newBoolean) {\n      if (opt_check === undefined) {\n        opt_check = null;\n      }\n      if (!this.outputConnection) {\n        this.outputConnection = this.makeConnection_(\n          ConnectionType.OUTPUT_VALUE,\n        );\n      }\n      this.outputConnection.setCheck(opt_check);\n    } else {\n      if (this.outputConnection) {\n        if (this.outputConnection.isConnected()) {\n          throw Error(\n            'Must disconnect output value before removing connection.',\n          );\n        }\n        this.outputConnection.dispose();\n        this.outputConnection = null;\n      }\n    }\n  }\n\n  /**\n   * Set whether value inputs are arranged horizontally or vertically.\n   *\n   * @param newBoolean True if inputs are horizontal.\n   */\n  setInputsInline(newBoolean: boolean) {\n    if (this.inputsInline !== newBoolean) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this,\n          'inline',\n          null,\n          this.inputsInline,\n          newBoolean,\n        ),\n      );\n      this.inputsInline = newBoolean;\n    }\n  }\n\n  /**\n   * Get whether value inputs are arranged horizontally or vertically.\n   *\n   * @returns True if inputs are horizontal.\n   */\n  getInputsInline(): boolean {\n    if (this.inputsInline !== undefined) {\n      // Set explicitly.\n      return this.inputsInline;\n    }\n    // Not defined explicitly.  Figure out what would look best.\n    for (let i = 1; i < this.inputList.length; i++) {\n      if (\n        this.inputList[i - 1] instanceof DummyInput &&\n        this.inputList[i] instanceof DummyInput\n      ) {\n        // Two dummy inputs in a row.  Don't inline them.\n        return false;\n      }\n    }\n    for (let i = 1; i < this.inputList.length; i++) {\n      if (\n        this.inputList[i - 1] instanceof ValueInput &&\n        this.inputList[i] instanceof DummyInput\n      ) {\n        // Dummy input after a value input.  Inline them.\n        return true;\n      }\n    }\n    for (let i = 0; i < this.inputList.length; i++) {\n      if (this.inputList[i] instanceof EndRowInput) {\n        // A row-end input is present. Inline value inputs.\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Set the block's output shape.\n   *\n   * @param outputShape Value representing an output shape.\n   */\n  setOutputShape(outputShape: number | null) {\n    this.outputShape_ = outputShape;\n  }\n\n  /**\n   * Get the block's output shape.\n   *\n   * @returns Value representing output shape if one exists.\n   */\n  getOutputShape(): number | null {\n    return this.outputShape_;\n  }\n\n  /**\n   * Get whether this block is enabled or not. A block is considered enabled\n   * if there aren't any reasons why it would be disabled. A block may still\n   * be disabled for other reasons even if the user attempts to manually\n   * enable it, such as when the block is in an invalid location.\n   *\n   * @returns True if enabled.\n   */\n  isEnabled(): boolean {\n    return this.disabledReasons.size === 0;\n  }\n\n  /** @deprecated v11 - Get whether the block is manually disabled. */\n  private get disabled(): boolean {\n    deprecation.warn(\n      'disabled',\n      'v11',\n      'v12',\n      'the isEnabled or hasDisabledReason methods of Block',\n    );\n    return this.hasDisabledReason(constants.MANUALLY_DISABLED);\n  }\n\n  /** @deprecated v11 - Set whether the block is manually disabled. */\n  private set disabled(value: boolean) {\n    deprecation.warn(\n      'disabled',\n      'v11',\n      'v12',\n      'the setDisabledReason method of Block',\n    );\n    this.setDisabledReason(value, constants.MANUALLY_DISABLED);\n  }\n\n  /**\n   * @deprecated v11 - Set whether the block is manually enabled or disabled.\n   * The user can toggle whether a block is disabled from a context menu\n   * option. A block may still be disabled for other reasons even if the user\n   * attempts to manually enable it, such as when the block is in an invalid\n   * location. This method is deprecated and setDisabledReason should be used\n   * instead.\n   *\n   * @param enabled True if enabled.\n   */\n  setEnabled(enabled: boolean) {\n    deprecation.warn(\n      'setEnabled',\n      'v11',\n      'v12',\n      'the setDisabledReason method of Block',\n    );\n    this.setDisabledReason(!enabled, constants.MANUALLY_DISABLED);\n  }\n\n  /**\n   * Add or remove a reason why the block might be disabled. If a block has\n   * any reasons to be disabled, then the block itself will be considered\n   * disabled. A block could be disabled for multiple independent reasons\n   * simultaneously, such as when the user manually disables it, or the block\n   * is invalid.\n   *\n   * @param disabled If true, then the block should be considered disabled for\n   *     at least the provided reason, otherwise the block is no longer disabled\n   *     for that reason.\n   * @param reason A language-neutral identifier for a reason why the block\n   *     could be disabled. Call this method again with the same identifier to\n   *     update whether the block is currently disabled for this reason.\n   */\n  setDisabledReason(disabled: boolean, reason: string): void {\n    if (this.disabledReasons.has(reason) !== disabled) {\n      if (disabled) {\n        this.disabledReasons.add(reason);\n      } else {\n        this.disabledReasons.delete(reason);\n      }\n      const blockChangeEvent = new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n        this,\n        'disabled',\n        /* name= */ null,\n        /* oldValue= */ !disabled,\n        /* newValue= */ disabled,\n      ) as BlockChange;\n      blockChangeEvent.setDisabledReason(reason);\n      eventUtils.fire(blockChangeEvent);\n    }\n  }\n\n  /**\n   * Get whether the block is disabled or not due to parents.\n   * The block's own disabled property is not considered.\n   *\n   * @returns True if disabled.\n   */\n  getInheritedDisabled(): boolean {\n    let ancestor = this.getSurroundParent();\n    while (ancestor) {\n      if (!ancestor.isEnabled()) {\n        return true;\n      }\n      ancestor = ancestor.getSurroundParent();\n    }\n    // Ran off the top.\n    return false;\n  }\n\n  /**\n   * Get whether the block is currently disabled for the provided reason.\n   *\n   * @param reason A language-neutral identifier for a reason why the block\n   *     could be disabled.\n   * @returns Whether the block is disabled for the provided reason.\n   */\n  hasDisabledReason(reason: string): boolean {\n    return this.disabledReasons.has(reason);\n  }\n\n  /**\n   * Get a set of reasons why the block is currently disabled, if any. If the\n   * block is enabled, this set will be empty.\n   *\n   * @returns The set of reasons why the block is disabled, if any.\n   */\n  getDisabledReasons(): ReadonlySet<string> {\n    return this.disabledReasons;\n  }\n\n  /**\n   * Get whether the block is collapsed or not.\n   *\n   * @returns True if collapsed.\n   */\n  isCollapsed(): boolean {\n    return this.collapsed_;\n  }\n\n  /**\n   * Set whether the block is collapsed or not.\n   *\n   * @param collapsed True if collapsed.\n   */\n  setCollapsed(collapsed: boolean) {\n    if (this.collapsed_ !== collapsed) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this,\n          'collapsed',\n          null,\n          this.collapsed_,\n          collapsed,\n        ),\n      );\n      this.collapsed_ = collapsed;\n    }\n  }\n\n  /**\n   * Create a human-readable text representation of this block and any children.\n   *\n   * @param opt_maxLength Truncate the string to this length.\n   * @param opt_emptyToken The placeholder string used to denote an empty input.\n   *     If not specified, '?' is used.\n   * @returns Text of block.\n   */\n  toString(opt_maxLength?: number, opt_emptyToken?: string): string {\n    const tokens = this.toTokens(opt_emptyToken);\n\n    // Run through our tokens array and simplify expression to remove\n    // parentheses around single field blocks.\n    // E.g. ['repeat', '(', '10', ')', 'times', 'do', '?']\n    for (let i = 2; i < tokens.length; i++) {\n      if (tokens[i - 2] === '(' && tokens[i] === ')') {\n        tokens[i - 2] = tokens[i - 1];\n        tokens.splice(i - 1, 2);\n      }\n    }\n\n    // Join the text array, removing the spaces around added parentheses.\n    let prev = '';\n    let text: string = tokens.reduce((acc, curr) => {\n      const val = acc + (prev === '(' || curr === ')' ? '' : ' ') + curr;\n      prev = curr[curr.length - 1];\n      return val;\n    }, '');\n\n    text = text.trim() || '???';\n    if (opt_maxLength) {\n      // TODO: Improve truncation so that text from this block is given\n      // priority. E.g. \"1+2+3+4+5+6+7+8+9=0\" should be \"...6+7+8+9=0\", not\n      // \"1+2+3+4+5...\". E.g. \"1+2+3+4+5=6+7+8+9+0\" should be \"...4+5=6+7...\".\n      if (text.length > opt_maxLength) {\n        text = text.substring(0, opt_maxLength - 3) + '...';\n      }\n    }\n    return text;\n  }\n\n  /**\n   * Converts this block into string tokens.\n   *\n   * @param emptyToken The token to use in place of an empty input.\n   *     Defaults to '?'.\n   * @returns The array of string tokens representing this block.\n   */\n  private toTokens(emptyToken = '?'): string[] {\n    const tokens = [];\n    /**\n     * Whether or not to add parentheses around an input.\n     *\n     * @param connection The connection.\n     * @returns True if we should add parentheses around the input.\n     */\n    function shouldAddParentheses(connection: Connection): boolean {\n      let checks = connection.getCheck();\n      if (!checks && connection.targetConnection) {\n        checks = connection.targetConnection.getCheck();\n      }\n      return (\n        !!checks && (checks.includes('Boolean') || checks.includes('Number'))\n      );\n    }\n\n    for (const input of this.inputList) {\n      if (input.name == constants.COLLAPSED_INPUT_NAME) {\n        continue;\n      }\n      for (const field of input.fieldRow) {\n        tokens.push(field.getText());\n      }\n      if (input.connection) {\n        const child = input.connection.targetBlock();\n        if (child) {\n          const shouldAddParens = shouldAddParentheses(input.connection);\n          if (shouldAddParens) tokens.push('(');\n          tokens.push(...child.toTokens(emptyToken));\n          if (shouldAddParens) tokens.push(')');\n        } else {\n          tokens.push(emptyToken);\n        }\n      }\n    }\n    return tokens;\n  }\n\n  /**\n   * Appends a value input row.\n   *\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  appendValueInput(name: string): Input {\n    return this.appendInput(new ValueInput(name, this));\n  }\n\n  /**\n   * Appends a statement input row.\n   *\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  appendStatementInput(name: string): Input {\n    this.statementInputCount++;\n    return this.appendInput(new StatementInput(name, this));\n  }\n\n  /**\n   * Appends a dummy input row.\n   *\n   * @param name Optional language-neutral identifier which may used to find\n   *     this input again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  appendDummyInput(name = ''): Input {\n    return this.appendInput(new DummyInput(name, this));\n  }\n\n  /**\n   * Appends an input that ends the row.\n   *\n   * @param name Optional language-neutral identifier which may used to find\n   *     this input again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  appendEndRowInput(name = ''): Input {\n    return this.appendInput(new EndRowInput(name, this));\n  }\n\n  /**\n   * Appends the given input row.\n   *\n   * Allows for custom inputs to be appended to the block.\n   */\n  appendInput(input: Input): Input {\n    this.inputList.push(input);\n    return input;\n  }\n\n  /**\n   * Appends an input with the given input type and name to the block after\n   * constructing it from the registry.\n   *\n   * @param type The name the input is registered under in the registry.\n   * @param name The name the input will have within the block.\n   * @returns The constucted input, or null if there was no constructor\n   *     associated with the type.\n   */\n  private appendInputFromRegistry(type: string, name: string): Input | null {\n    const inputConstructor = registry.getClass(\n      registry.Type.INPUT,\n      type,\n      false,\n    );\n    if (!inputConstructor) return null;\n    return this.appendInput(new inputConstructor(name, this));\n  }\n\n  /**\n   * Initialize this block using a cross-platform, internationalization-friendly\n   * JSON description.\n   *\n   * @param json Structured data describing the block.\n   */\n  jsonInit(json: AnyDuringMigration) {\n    const warningPrefix = json['type'] ? 'Block \"' + json['type'] + '\": ' : '';\n\n    // Validate inputs.\n    if (json['output'] && json['previousStatement']) {\n      throw Error(\n        warningPrefix + 'Must not have both an output and a previousStatement.',\n      );\n    }\n\n    // Validate that each arg has a corresponding message\n    let n = 0;\n    while (json['args' + n]) {\n      if (json['message' + n] === undefined) {\n        throw Error(\n          warningPrefix +\n            `args${n} must have a corresponding message (message${n}).`,\n        );\n      }\n      n++;\n    }\n\n    // Set basic properties of block.\n    // Makes styles backward compatible with old way of defining hat style.\n    if (json['style'] && json['style'].hat) {\n      this.hat = json['style'].hat;\n      // Must set to null so it doesn't error when checking for style and\n      // colour.\n      json['style'] = null;\n    }\n\n    if (json['style'] && json['colour']) {\n      throw Error(warningPrefix + 'Must not have both a colour and a style.');\n    } else if (json['style']) {\n      this.jsonInitStyle_(json, warningPrefix);\n    } else {\n      this.jsonInitColour_(json, warningPrefix);\n    }\n\n    // Interpolate the message blocks.\n    let i = 0;\n    while (json['message' + i] !== undefined) {\n      this.interpolate_(\n        json['message' + i],\n        json['args' + i] || [],\n        // Backwards compatibility: lastDummyAlign aliases implicitAlign.\n        json['implicitAlign' + i] || json['lastDummyAlign' + i],\n        warningPrefix,\n      );\n      i++;\n    }\n\n    if (json['inputsInline'] !== undefined) {\n      eventUtils.disable();\n      this.setInputsInline(json['inputsInline']);\n      eventUtils.enable();\n    }\n\n    // Set output and previous/next connections.\n    if (json['output'] !== undefined) {\n      this.setOutput(true, json['output']);\n    }\n    if (json['outputShape'] !== undefined) {\n      this.setOutputShape(json['outputShape']);\n    }\n    if (json['previousStatement'] !== undefined) {\n      this.setPreviousStatement(true, json['previousStatement']);\n    }\n    if (json['nextStatement'] !== undefined) {\n      this.setNextStatement(true, json['nextStatement']);\n    }\n    if (json['tooltip'] !== undefined) {\n      const rawValue = json['tooltip'];\n      const localizedText = parsing.replaceMessageReferences(rawValue);\n      this.setTooltip(localizedText);\n    }\n    if (json['enableContextMenu'] !== undefined) {\n      this.contextMenu = !!json['enableContextMenu'];\n    }\n    if (json['suppressPrefixSuffix'] !== undefined) {\n      this.suppressPrefixSuffix = !!json['suppressPrefixSuffix'];\n    }\n    if (json['helpUrl'] !== undefined) {\n      const rawValue = json['helpUrl'];\n      const localizedValue = parsing.replaceMessageReferences(rawValue);\n      this.setHelpUrl(localizedValue);\n    }\n    if (typeof json['extensions'] === 'string') {\n      console.warn(\n        warningPrefix +\n          \"JSON attribute 'extensions' should be an array of\" +\n          \" strings. Found raw string in JSON for '\" +\n          json['type'] +\n          \"' block.\",\n      );\n      json['extensions'] = [json['extensions']]; // Correct and continue.\n    }\n\n    // Add the mutator to the block.\n    if (json['mutator'] !== undefined) {\n      Extensions.apply(json['mutator'], this, true);\n    }\n\n    const extensionNames = json['extensions'];\n    if (Array.isArray(extensionNames)) {\n      for (let j = 0; j < extensionNames.length; j++) {\n        Extensions.apply(extensionNames[j], this, false);\n      }\n    }\n  }\n\n  /**\n   * Initialize the colour of this block from the JSON description.\n   *\n   * @param json Structured data describing the block.\n   * @param warningPrefix Warning prefix string identifying block.\n   */\n  private jsonInitColour_(json: AnyDuringMigration, warningPrefix: string) {\n    if ('colour' in json) {\n      if (json['colour'] === undefined) {\n        console.warn(warningPrefix + 'Undefined colour value.');\n      } else {\n        const rawValue = json['colour'];\n        try {\n          this.setColour(rawValue);\n        } catch (e) {\n          console.warn(warningPrefix + 'Illegal colour value: ', rawValue);\n        }\n      }\n    }\n  }\n\n  /**\n   * Initialize the style of this block from the JSON description.\n   *\n   * @param json Structured data describing the block.\n   * @param warningPrefix Warning prefix string identifying block.\n   */\n  private jsonInitStyle_(json: AnyDuringMigration, warningPrefix: string) {\n    const blockStyleName = json['style'];\n    try {\n      this.setStyle(blockStyleName);\n    } catch (styleError) {\n      console.warn(warningPrefix + 'Style does not exist: ', blockStyleName);\n    }\n  }\n\n  /**\n   * Add key/values from mixinObj to this block object. By default, this method\n   * will check that the keys in mixinObj will not overwrite existing values in\n   * the block, including prototype values. This provides some insurance against\n   * mixin / extension incompatibilities with future block features. This check\n   * can be disabled by passing true as the second argument.\n   *\n   * @param mixinObj The key/values pairs to add to this block object.\n   * @param opt_disableCheck Option flag to disable overwrite checks.\n   */\n  mixin(mixinObj: AnyDuringMigration, opt_disableCheck?: boolean) {\n    if (\n      opt_disableCheck !== undefined &&\n      typeof opt_disableCheck !== 'boolean'\n    ) {\n      throw Error('opt_disableCheck must be a boolean if provided');\n    }\n    if (!opt_disableCheck) {\n      const overwrites = [];\n      for (const key in mixinObj) {\n        if ((this as AnyDuringMigration)[key] !== undefined) {\n          overwrites.push(key);\n        }\n      }\n      if (overwrites.length) {\n        throw Error(\n          'Mixin will overwrite block members: ' + JSON.stringify(overwrites),\n        );\n      }\n    }\n    Object.assign(this, mixinObj);\n  }\n\n  /**\n   * Interpolate a message description onto the block.\n   *\n   * @param message Text contains interpolation tokens (%1, %2, ...) that match\n   *     with fields or inputs defined in the args array.\n   * @param args Array of arguments to be interpolated.\n   * @param implicitAlign If an implicit input is added at the end or in place\n   *     of newline tokens, how should it be aligned?\n   * @param warningPrefix Warning prefix string identifying block.\n   */\n  private interpolate_(\n    message: string,\n    args: AnyDuringMigration[],\n    implicitAlign: string | undefined,\n    warningPrefix: string,\n  ) {\n    const tokens = parsing.tokenizeInterpolation(message);\n    this.validateTokens_(tokens, args.length);\n    const elements = this.interpolateArguments_(tokens, args, implicitAlign);\n\n    // An array of [field, fieldName] tuples.\n    const fieldStack = [];\n    for (let i = 0, element; (element = elements[i]); i++) {\n      if (this.isInputKeyword_(element['type'])) {\n        const input = this.inputFromJson_(element, warningPrefix);\n        // Should never be null, but just in case.\n        if (input) {\n          for (let j = 0, tuple; (tuple = fieldStack[j]); j++) {\n            input.appendField(tuple[0], tuple[1]);\n          }\n          fieldStack.length = 0;\n        }\n      } else {\n        // All other types, including ones starting with 'input_' get routed\n        // here.\n        const field = this.fieldFromJson_(element);\n        if (field) {\n          fieldStack.push([field, element['name']]);\n        }\n      }\n    }\n  }\n\n  /**\n   * Validates that the tokens are within the correct bounds, with no\n   * duplicates, and that all of the arguments are referred to. Throws errors if\n   * any of these things are not true.\n   *\n   * @param tokens An array of tokens to validate\n   * @param argsCount The number of args that need to be referred to.\n   */\n  private validateTokens_(tokens: Array<string | number>, argsCount: number) {\n    const visitedArgsHash = [];\n    let visitedArgsCount = 0;\n    for (let i = 0; i < tokens.length; i++) {\n      const token = tokens[i];\n      if (typeof token !== 'number') {\n        continue;\n      }\n      if (token < 1 || token > argsCount) {\n        throw Error(\n          'Block \"' +\n            this.type +\n            '\": ' +\n            'Message index %' +\n            token +\n            ' out of range.',\n        );\n      }\n      if (visitedArgsHash[token]) {\n        throw Error(\n          'Block \"' +\n            this.type +\n            '\": ' +\n            'Message index %' +\n            token +\n            ' duplicated.',\n        );\n      }\n      visitedArgsHash[token] = true;\n      visitedArgsCount++;\n    }\n    if (visitedArgsCount !== argsCount) {\n      throw Error(\n        'Block \"' +\n          this.type +\n          '\": ' +\n          'Message does not reference all ' +\n          argsCount +\n          ' arg(s).',\n      );\n    }\n  }\n\n  /**\n   * Inserts args in place of numerical tokens. String args are converted to\n   * JSON that defines a label field. Newline characters are converted to\n   * end-row inputs, and if necessary an extra dummy input is added to the end\n   * of the elements.\n   *\n   * @param tokens The tokens to interpolate\n   * @param args The arguments to insert.\n   * @param implicitAlign The alignment to use for any implicitly added end-row\n   *     or dummy inputs, if necessary.\n   * @returns The JSON definitions of field and inputs to add to the block.\n   */\n  private interpolateArguments_(\n    tokens: Array<string | number>,\n    args: Array<AnyDuringMigration | string>,\n    implicitAlign: string | undefined,\n  ): AnyDuringMigration[] {\n    const elements = [];\n    for (let i = 0; i < tokens.length; i++) {\n      let element = tokens[i];\n      if (typeof element === 'number') {\n        element = args[element - 1];\n      }\n      // Args can be strings, which is why this isn't elseif.\n      if (typeof element === 'string') {\n        if (element === '\\n') {\n          // Convert newline tokens to end-row inputs.\n          const newlineInput = {'type': 'input_end_row'};\n          if (implicitAlign) {\n            (newlineInput as AnyDuringMigration)['align'] = implicitAlign;\n          }\n          element = newlineInput as AnyDuringMigration;\n        } else {\n          // AnyDuringMigration because:  Type '{ text: string; type: string; }\n          // | null' is not assignable to type 'string | number'.\n          element = this.stringToFieldJson_(element) as AnyDuringMigration;\n          if (!element) {\n            continue;\n          }\n        }\n      }\n      elements.push(element);\n    }\n\n    const length = elements.length;\n    if (\n      length &&\n      !this.isInputKeyword_(\n        (elements as AnyDuringMigration)[length - 1]['type'],\n      )\n    ) {\n      const dummyInput = {'type': 'input_dummy'};\n      if (implicitAlign) {\n        (dummyInput as AnyDuringMigration)['align'] = implicitAlign;\n      }\n      elements.push(dummyInput);\n    }\n\n    return elements;\n  }\n\n  /**\n   * Creates a field from the JSON definition of a field. If a field with the\n   * given type cannot be found, this attempts to create a different field using\n   * the 'alt' property of the JSON definition (if it exists).\n   *\n   * @param element The element to try to turn into a field.\n   * @returns The field defined by the JSON, or null if one couldn't be created.\n   */\n  private fieldFromJson_(element: {\n    alt?: string;\n    type: string;\n    text?: string;\n  }): Field | null {\n    const field = fieldRegistry.fromJson(element);\n    if (!field && element['alt']) {\n      if (typeof element['alt'] === 'string') {\n        const json = this.stringToFieldJson_(element['alt']);\n        return json ? this.fieldFromJson_(json) : null;\n      }\n      return this.fieldFromJson_(element['alt']);\n    }\n    return field;\n  }\n\n  /**\n   * Creates an input from the JSON definition of an input. Sets the input's\n   * check and alignment if they are provided.\n   *\n   * @param element The JSON to turn into an input.\n   * @param warningPrefix The prefix to add to warnings to help the developer\n   *     debug.\n   * @returns The input that has been created, or null if one could not be\n   *     created for some reason (should never happen).\n   */\n  private inputFromJson_(\n    element: AnyDuringMigration,\n    warningPrefix: string,\n  ): Input | null {\n    const alignmentLookup = {\n      'LEFT': Align.LEFT,\n      'RIGHT': Align.RIGHT,\n      'CENTRE': Align.CENTRE,\n      'CENTER': Align.CENTRE,\n    };\n\n    let input = null;\n    switch (element['type']) {\n      case 'input_value':\n        input = this.appendValueInput(element['name']);\n        break;\n      case 'input_statement':\n        input = this.appendStatementInput(element['name']);\n        break;\n      case 'input_dummy':\n        input = this.appendDummyInput(element['name']);\n        break;\n      case 'input_end_row':\n        input = this.appendEndRowInput(element['name']);\n        break;\n      default: {\n        input = this.appendInputFromRegistry(element['type'], element['name']);\n        break;\n      }\n    }\n    // Should never be hit because of interpolate_'s checks, but just in case.\n    if (!input) {\n      return null;\n    }\n\n    if (element['check']) {\n      input.setCheck(element['check']);\n    }\n    if (element['align']) {\n      const alignment = (alignmentLookup as AnyDuringMigration)[\n        element['align'].toUpperCase()\n      ];\n      if (alignment === undefined) {\n        console.warn(warningPrefix + 'Illegal align value: ', element['align']);\n      } else {\n        input.setAlign(alignment);\n      }\n    }\n    return input;\n  }\n\n  /**\n   * Returns true if the given string matches one of the input keywords.\n   *\n   * @param str The string to check.\n   * @returns True if the given string matches one of the input keywords, false\n   *     otherwise.\n   */\n  private isInputKeyword_(str: string): boolean {\n    return (\n      str === 'input_value' ||\n      str === 'input_statement' ||\n      str === 'input_dummy' ||\n      str === 'input_end_row' ||\n      registry.hasItem(registry.Type.INPUT, str)\n    );\n  }\n\n  /**\n   * Turns a string into the JSON definition of a label field. If the string\n   * becomes an empty string when trimmed, this returns null.\n   *\n   * @param str String to turn into the JSON definition of a label field.\n   * @returns The JSON definition or null.\n   */\n  private stringToFieldJson_(str: string): {text: string; type: string} | null {\n    str = str.trim();\n    if (str) {\n      return {\n        'type': 'field_label',\n        'text': str,\n      };\n    }\n    return null;\n  }\n\n  /**\n   * Move a named input to a different location on this block.\n   *\n   * @param name The name of the input to move.\n   * @param refName Name of input that should be after the moved input, or null\n   *     to be the input at the end.\n   */\n  moveInputBefore(name: string, refName: string | null) {\n    if (name === refName) {\n      return;\n    }\n    // Find both inputs.\n    let inputIndex = -1;\n    let refIndex = refName ? -1 : this.inputList.length;\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.name === name) {\n        inputIndex = i;\n        if (refIndex !== -1) {\n          break;\n        }\n      } else if (refName && input.name === refName) {\n        refIndex = i;\n        if (inputIndex !== -1) {\n          break;\n        }\n      }\n    }\n    if (inputIndex === -1) {\n      throw Error('Named input \"' + name + '\" not found.');\n    }\n    if (refIndex === -1) {\n      throw Error('Reference input \"' + refName + '\" not found.');\n    }\n    this.moveNumberedInputBefore(inputIndex, refIndex);\n  }\n\n  /**\n   * Move a numbered input to a different location on this block.\n   *\n   * @param inputIndex Index of the input to move.\n   * @param refIndex Index of input that should be after the moved input.\n   */\n  moveNumberedInputBefore(inputIndex: number, refIndex: number) {\n    // Validate arguments.\n    if (inputIndex === refIndex) {\n      throw Error(\"Can't move input to itself.\");\n    }\n    if (inputIndex >= this.inputList.length) {\n      throw RangeError('Input index ' + inputIndex + ' out of bounds.');\n    }\n    if (refIndex > this.inputList.length) {\n      throw RangeError('Reference input ' + refIndex + ' out of bounds.');\n    }\n    // Remove input.\n    const input = this.inputList[inputIndex];\n    this.inputList.splice(inputIndex, 1);\n    if (inputIndex < refIndex) {\n      refIndex--;\n    }\n    // Reinsert input.\n    this.inputList.splice(refIndex, 0, input);\n  }\n\n  /**\n   * Remove an input from this block.\n   *\n   * @param name The name of the input.\n   * @param opt_quiet True to prevent an error if input is not present.\n   * @returns True if operation succeeds, false if input is not present and\n   *     opt_quiet is true.\n   * @throws {Error} if the input is not present and opt_quiet is not true.\n   */\n  removeInput(name: string, opt_quiet?: boolean): boolean {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.name === name) {\n        if (input instanceof StatementInput) this.statementInputCount--;\n        input.dispose();\n        this.inputList.splice(i, 1);\n        return true;\n      }\n    }\n    if (opt_quiet) {\n      return false;\n    }\n    throw Error('Input not found: ' + name);\n  }\n\n  /**\n   * Fetches the named input object.\n   *\n   * @param name The name of the input.\n   * @returns The input object, or null if input does not exist.\n   */\n  getInput(name: string): Input | null {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.name === name) {\n        return input;\n      }\n    }\n    // This input does not exist.\n    return null;\n  }\n\n  /**\n   * Fetches the block attached to the named input.\n   *\n   * @param name The name of the input.\n   * @returns The attached value block, or null if the input is either\n   *     disconnected or if the input does not exist.\n   */\n  getInputTargetBlock(name: string): Block | null {\n    const input = this.getInput(name);\n    return input && input.connection && input.connection.targetBlock();\n  }\n\n  /**\n   * Returns the comment on this block (or null if there is no comment).\n   *\n   * @returns Block's comment.\n   */\n  getCommentText(): string | null {\n    const comment = this.getIcon(IconType.COMMENT);\n    return comment?.getText() ?? null;\n  }\n\n  /**\n   * Set this block's comment text.\n   *\n   * @param text The text, or null to delete.\n   */\n  setCommentText(text: string | null) {\n    const comment = this.getIcon(IconType.COMMENT);\n    const oldText = comment?.getText() ?? null;\n    if (oldText === text) return;\n    if (text !== null) {\n      let comment = this.getIcon(IconType.COMMENT);\n      if (!comment) {\n        const commentConstructor = registry.getClass(\n          registry.Type.ICON,\n          IconType.COMMENT.toString(),\n          false,\n        );\n        if (!commentConstructor) {\n          throw new Error(\n            'No comment icon class is registered, so a comment cannot be set',\n          );\n        }\n        const icon = new commentConstructor(this);\n        if (!isCommentIcon(icon)) {\n          throw new Error(\n            'The class registered as a comment icon does not conform to the ' +\n              'ICommentIcon interface',\n          );\n        }\n        comment = this.addIcon(icon);\n      }\n      eventUtils.disable();\n      comment.setText(text);\n      eventUtils.enable();\n    } else {\n      this.removeIcon(IconType.COMMENT);\n    }\n\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n        this,\n        'comment',\n        null,\n        oldText,\n        text,\n      ),\n    );\n  }\n\n  /**\n   * Set this block's warning text.\n   *\n   * @param _text The text, or null to delete.\n   * @param _opt_id An optional ID for the warning text to be able to maintain\n   *     multiple warnings.\n   */\n  setWarningText(_text: string | null, _opt_id?: string) {\n    // NOOP.\n  }\n\n  /**\n   * Give this block a mutator dialog.\n   *\n   * @param _mutator A mutator dialog instance or null to remove.\n   */\n  setMutator(_mutator: MutatorIcon) {\n    // NOOP.\n  }\n\n  /** Adds the given icon to the block. */\n  addIcon<T extends IIcon>(icon: T): T {\n    if (this.hasIcon(icon.getType())) throw new DuplicateIconType(icon);\n    this.icons.push(icon);\n    this.icons.sort((a, b) => a.getWeight() - b.getWeight());\n    return icon;\n  }\n\n  /**\n   * Removes the icon whose getType matches the given type iconType from the\n   * block.\n   *\n   * @param type The type of the icon to remove from the block.\n   * @returns True if an icon with the given type was found, false otherwise.\n   */\n  removeIcon(type: IconType<IIcon>): boolean {\n    if (!this.hasIcon(type)) return false;\n    this.getIcon(type)?.dispose();\n    this.icons = this.icons.filter((icon) => !icon.getType().equals(type));\n    return true;\n  }\n\n  /**\n   * @returns True if an icon with the given type exists on the block,\n   *     false otherwise.\n   */\n  hasIcon(type: IconType<IIcon>): boolean {\n    return this.icons.some((icon) => icon.getType().equals(type));\n  }\n\n  /**\n   * @param type The type of the icon to retrieve. Prefer passing an `IconType`\n   *     for proper type checking when using typescript.\n   * @returns The icon with the given type if it exists on the block, undefined\n   *     otherwise.\n   */\n  getIcon<T extends IIcon>(type: IconType<T> | string): T | undefined {\n    if (type instanceof IconType) {\n      return this.icons.find((icon) => icon.getType().equals(type)) as T;\n    } else {\n      return this.icons.find((icon) => icon.getType().toString() === type) as T;\n    }\n  }\n\n  /** @returns An array of the icons attached to this block. */\n  getIcons(): IIcon[] {\n    return [...this.icons];\n  }\n\n  /**\n   * Return the coordinates of the top-left corner of this block relative to the\n   * drawing surface's origin (0,0), in workspace units.\n   *\n   * @returns Object with .x and .y properties.\n   */\n  getRelativeToSurfaceXY(): Coordinate {\n    return this.xy_;\n  }\n\n  /**\n   * Move a block by a relative offset.\n   *\n   * @param dx Horizontal offset, in workspace units.\n   * @param dy Vertical offset, in workspace units.\n   * @param reason Why is this move happening?  'drag', 'bump', 'snap', ...\n   */\n  moveBy(dx: number, dy: number, reason?: string[]) {\n    if (this.parentBlock_) {\n      throw Error('Block has parent');\n    }\n    const event = new (eventUtils.get(eventUtils.BLOCK_MOVE))(\n      this,\n    ) as BlockMove;\n    reason && event.setReason(reason);\n    this.xy_.translate(dx, dy);\n    event.recordNew();\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Create a connection of the specified type.\n   *\n   * @param type The type of the connection to create.\n   * @returns A new connection of the specified type.\n   * @internal\n   */\n  makeConnection_(type: ConnectionType): Connection {\n    return new Connection(this, type);\n  }\n\n  /**\n   * Recursively checks whether all statement and value inputs are filled with\n   * blocks. Also checks all following statement blocks in this stack.\n   *\n   * @param opt_shadowBlocksAreFilled An optional argument controlling whether\n   *     shadow blocks are counted as filled. Defaults to true.\n   * @returns True if all inputs are filled, false otherwise.\n   */\n  allInputsFilled(opt_shadowBlocksAreFilled?: boolean): boolean {\n    // Account for the shadow block filledness toggle.\n    if (opt_shadowBlocksAreFilled === undefined) {\n      opt_shadowBlocksAreFilled = true;\n    }\n    if (!opt_shadowBlocksAreFilled && this.isShadow()) {\n      return false;\n    }\n\n    // Recursively check each input block of the current block.\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (!input.connection) {\n        continue;\n      }\n      const target = input.connection.targetBlock();\n      if (!target || !target.allInputsFilled(opt_shadowBlocksAreFilled)) {\n        return false;\n      }\n    }\n\n    // Recursively check the next block after the current block.\n    const next = this.getNextBlock();\n    if (next) {\n      return next.allInputsFilled(opt_shadowBlocksAreFilled);\n    }\n\n    return true;\n  }\n\n  /**\n   * This method returns a string describing this Block in developer terms (type\n   * name and ID; English only).\n   *\n   * Intended to on be used in console logs and errors. If you need a string\n   * that uses the user's native language (including block text, field values,\n   * and child blocks), use [toString()]{@link Block#toString}.\n   *\n   * @returns The description.\n   */\n  toDevString(): string {\n    let msg = this.type ? '\"' + this.type + '\" block' : 'Block';\n    if (this.id) {\n      msg += ' (id=\"' + this.id + '\")';\n    }\n    return msg;\n  }\n}\n\nexport namespace Block {\n  export interface CommentModel {\n    text: string | null;\n    pinned: boolean;\n    size: Size;\n  }\n}\n\nexport type CommentModel = Block.CommentModel;\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a button in the flyout.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FlyoutButton\n\nimport * as browserEvents from './browser_events.js';\nimport * as Css from './css.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport * as style from './utils/style.js';\nimport {Svg} from './utils/svg.js';\nimport type * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport type {IASTNodeLocationSvg} from './blockly.js';\n\n/**\n * Class for a button or label in the flyout.\n */\nexport class FlyoutButton implements IASTNodeLocationSvg {\n  /** The horizontal margin around the text in the button. */\n  static TEXT_MARGIN_X = 5;\n\n  /** The vertical margin around the text in the button. */\n  static TEXT_MARGIN_Y = 2;\n\n  /** The radius of the flyout button's borders. */\n  static BORDER_RADIUS = 4;\n\n  private readonly text: string;\n  private readonly position: Coordinate;\n  private readonly callbackKey: string;\n  private readonly cssClass: string | null;\n\n  /** Mouse up event data. */\n  private onMouseUpWrapper: browserEvents.Data | null = null;\n  info: toolbox.ButtonOrLabelInfo;\n\n  /** The width of the button's rect. */\n  width = 0;\n\n  /** The height of the button's rect. */\n  height = 0;\n\n  /** The root SVG group for the button or label. */\n  private svgGroup: SVGGElement | null = null;\n\n  /** The SVG element with the text of the label or button. */\n  private svgText: SVGTextElement | null = null;\n\n  /**\n   * Holds the cursors svg element when the cursor is attached to the button.\n   * This is null if there is no cursor on the button.\n   */\n  cursorSvg: SVGElement | null = null;\n\n  /**\n   * @param workspace The workspace in which to place this button.\n   * @param targetWorkspace The flyout's target workspace.\n   * @param json The JSON specifying the label/button.\n   * @param isFlyoutLabel Whether this button should be styled as a label.\n   * @internal\n   */\n  constructor(\n    private readonly workspace: WorkspaceSvg,\n    private readonly targetWorkspace: WorkspaceSvg,\n    json: toolbox.ButtonOrLabelInfo,\n    private readonly isFlyoutLabel: boolean,\n  ) {\n    this.text = json['text'];\n\n    this.position = new Coordinate(0, 0);\n\n    /** The key to the function called when this button is clicked. */\n    this.callbackKey =\n      (json as AnyDuringMigration)[\n        'callbackKey'\n      ] /* Check the lower case version\n                                                   too to satisfy IE */ ||\n      (json as AnyDuringMigration)['callbackkey'];\n\n    /** If specified, a CSS class to add to this button. */\n    this.cssClass = (json as AnyDuringMigration)['web-class'] || null;\n\n    /** The JSON specifying the label / button. */\n    this.info = json;\n  }\n\n  /**\n   * Create the button elements.\n   *\n   * @returns The button's SVG group.\n   */\n  createDom(): SVGElement {\n    let cssClass = this.isFlyoutLabel\n      ? 'blocklyFlyoutLabel'\n      : 'blocklyFlyoutButton';\n    if (this.cssClass) {\n      cssClass += ' ' + this.cssClass;\n    }\n\n    this.svgGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': cssClass},\n      this.workspace.getCanvas(),\n    );\n\n    let shadow;\n    if (!this.isFlyoutLabel) {\n      // Shadow rectangle (light source does not mirror in RTL).\n      shadow = dom.createSvgElement(\n        Svg.RECT,\n        {\n          'class': 'blocklyFlyoutButtonShadow',\n          'rx': FlyoutButton.BORDER_RADIUS,\n          'ry': FlyoutButton.BORDER_RADIUS,\n          'x': 1,\n          'y': 1,\n        },\n        this.svgGroup!,\n      );\n    }\n    // Background rectangle.\n    const rect = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': this.isFlyoutLabel\n          ? 'blocklyFlyoutLabelBackground'\n          : 'blocklyFlyoutButtonBackground',\n        'rx': FlyoutButton.BORDER_RADIUS,\n        'ry': FlyoutButton.BORDER_RADIUS,\n      },\n      this.svgGroup!,\n    );\n\n    const svgText = dom.createSvgElement(\n      Svg.TEXT,\n      {\n        'class': this.isFlyoutLabel ? 'blocklyFlyoutLabelText' : 'blocklyText',\n        'x': 0,\n        'y': 0,\n        'text-anchor': 'middle',\n      },\n      this.svgGroup!,\n    );\n    let text = parsing.replaceMessageReferences(this.text);\n    if (this.workspace.RTL) {\n      // Force text to be RTL by adding an RLM.\n      text += '\\u200F';\n    }\n    svgText.textContent = text;\n    if (this.isFlyoutLabel) {\n      this.svgText = svgText;\n      this.workspace\n        .getThemeManager()\n        .subscribe(this.svgText, 'flyoutForegroundColour', 'fill');\n    }\n\n    const fontSize = style.getComputedStyle(svgText, 'fontSize');\n    const fontWeight = style.getComputedStyle(svgText, 'fontWeight');\n    const fontFamily = style.getComputedStyle(svgText, 'fontFamily');\n    this.width = dom.getFastTextWidthWithSizeString(\n      svgText,\n      fontSize,\n      fontWeight,\n      fontFamily,\n    );\n    const fontMetrics = dom.measureFontMetrics(\n      text,\n      fontSize,\n      fontWeight,\n      fontFamily,\n    );\n    this.height = fontMetrics.height;\n\n    if (!this.isFlyoutLabel) {\n      this.width += 2 * FlyoutButton.TEXT_MARGIN_X;\n      this.height += 2 * FlyoutButton.TEXT_MARGIN_Y;\n      shadow?.setAttribute('width', String(this.width));\n      shadow?.setAttribute('height', String(this.height));\n    }\n    rect.setAttribute('width', String(this.width));\n    rect.setAttribute('height', String(this.height));\n\n    svgText.setAttribute('x', String(this.width / 2));\n    svgText.setAttribute(\n      'y',\n      String(this.height / 2 - fontMetrics.height / 2 + fontMetrics.baseline),\n    );\n\n    this.updateTransform();\n\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'EventTarget'.\n    this.onMouseUpWrapper = browserEvents.conditionalBind(\n      this.svgGroup as AnyDuringMigration,\n      'pointerup',\n      this,\n      this.onMouseUp,\n    );\n    return this.svgGroup!;\n  }\n\n  /** Correctly position the flyout button and make it visible. */\n  show() {\n    this.updateTransform();\n    this.svgGroup!.setAttribute('display', 'block');\n  }\n\n  /** Update SVG attributes to match internal state. */\n  private updateTransform() {\n    this.svgGroup!.setAttribute(\n      'transform',\n      'translate(' + this.position.x + ',' + this.position.y + ')',\n    );\n  }\n\n  /**\n   * Move the button to the given x, y coordinates.\n   *\n   * @param x The new x coordinate.\n   * @param y The new y coordinate.\n   */\n  moveTo(x: number, y: number) {\n    this.position.x = x;\n    this.position.y = y;\n    this.updateTransform();\n  }\n\n  /** @returns Whether or not the button is a label. */\n  isLabel(): boolean {\n    return this.isFlyoutLabel;\n  }\n\n  /**\n   * Location of the button.\n   *\n   * @returns x, y coordinates.\n   * @internal\n   */\n  getPosition(): Coordinate {\n    return this.position;\n  }\n\n  /** @returns Text of the button. */\n  getButtonText(): string {\n    return this.text;\n  }\n\n  /**\n   * Get the button's target workspace.\n   *\n   * @returns The target workspace of the flyout where this button resides.\n   */\n  getTargetWorkspace(): WorkspaceSvg {\n    return this.targetWorkspace;\n  }\n\n  /**\n   * Get the button's workspace.\n   *\n   * @returns The workspace in which to place this button.\n   */\n  getWorkspace(): WorkspaceSvg {\n    return this.workspace;\n  }\n\n  /** Dispose of this button. */\n  dispose() {\n    if (this.onMouseUpWrapper) {\n      browserEvents.unbind(this.onMouseUpWrapper);\n    }\n    if (this.svgGroup) {\n      dom.removeNode(this.svgGroup);\n    }\n    if (this.svgText) {\n      this.workspace.getThemeManager().unsubscribe(this.svgText);\n    }\n  }\n\n  /**\n   * Add the cursor SVG to this buttons's SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the button SVG\n   *     group.\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    if (!cursorSvg) {\n      this.cursorSvg = null;\n      return;\n    }\n    if (this.svgGroup) {\n      this.svgGroup.appendChild(cursorSvg);\n      this.cursorSvg = cursorSvg;\n    }\n  }\n\n  /**\n   * Required by IASTNodeLocationSvg, but not used. A marker cannot be set on a\n   * button. If the 'mark' shortcut is used on a button, its associated callback\n   * function is triggered.\n   */\n  setMarkerSvg() {\n    throw new Error('Attempted to set a marker on a button.');\n  }\n\n  /**\n   * Do something when the button is clicked.\n   *\n   * @param e Pointer up event.\n   */\n  private onMouseUp(e: PointerEvent) {\n    const gesture = this.targetWorkspace.getGesture(e);\n    if (gesture) {\n      gesture.cancel();\n    }\n\n    if (this.isFlyoutLabel && this.callbackKey) {\n      console.warn(\n        'Labels should not have callbacks. Label text: ' + this.text,\n      );\n    } else if (\n      !this.isFlyoutLabel &&\n      !(\n        this.callbackKey &&\n        this.targetWorkspace.getButtonCallback(this.callbackKey)\n      )\n    ) {\n      console.warn('Buttons should have callbacks. Button text: ' + this.text);\n    } else if (!this.isFlyoutLabel) {\n      const callback = this.targetWorkspace.getButtonCallback(this.callbackKey);\n      if (callback) {\n        callback(this);\n      }\n    }\n  }\n}\n\n/** CSS for buttons and labels. See css.js for use. */\nCss.register(`\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n`);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of a marker move.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.MarkerMove\n\nimport type {Block} from '../block.js';\nimport {ASTNode} from '../keyboard_nav/ast_node.js';\nimport * as registry from '../registry.js';\nimport type {Workspace} from '../workspace.js';\nimport {AbstractEventJson} from './events_abstract.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\n\n/**\n * Notifies listeners that a marker (used for keyboard navigation) has\n * moved.\n */\nexport class MarkerMove extends UiBase {\n  /** The ID of the block the marker is now on, if any. */\n  blockId?: string;\n\n  /** The old node the marker used to be on, if any. */\n  oldNode?: ASTNode;\n\n  /** The new node the marker is now on. */\n  newNode?: ASTNode;\n\n  /**\n   * True if this is a cursor event, false otherwise.\n   * For information about cursors vs markers see {@link\n   * https://blocklycodelabs.dev/codelabs/keyboard-navigation/index.html?index=..%2F..index#1}.\n   */\n  isCursor?: boolean;\n\n  override type = eventUtils.MARKER_MOVE;\n\n  /**\n   * @param opt_block The affected block. Null if current node is of type\n   *     workspace. Undefined for a blank event.\n   * @param isCursor Whether this is a cursor event. Undefined for a blank\n   *     event.\n   * @param opt_oldNode The old node the marker used to be on.\n   *    Undefined for a blank event.\n   * @param opt_newNode The new node the marker is now on.\n   *    Undefined for a blank event.\n   */\n  constructor(\n    opt_block?: Block | null,\n    isCursor?: boolean,\n    opt_oldNode?: ASTNode | null,\n    opt_newNode?: ASTNode,\n  ) {\n    let workspaceId = opt_block ? opt_block.workspace.id : undefined;\n    if (opt_newNode && opt_newNode.getType() === ASTNode.types.WORKSPACE) {\n      workspaceId = (opt_newNode.getLocation() as Workspace).id;\n    }\n    super(workspaceId);\n\n    this.blockId = opt_block?.id;\n    this.oldNode = opt_oldNode || undefined;\n    this.newNode = opt_newNode;\n    this.isCursor = isCursor;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): MarkerMoveJson {\n    const json = super.toJson() as MarkerMoveJson;\n    if (this.isCursor === undefined) {\n      throw new Error(\n        'Whether this is a cursor event or not is undefined. Either pass ' +\n          'a value to the constructor, or call fromJson',\n      );\n    }\n    if (!this.newNode) {\n      throw new Error(\n        'The new node is undefined. Either pass a node to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['isCursor'] = this.isCursor;\n    json['blockId'] = this.blockId;\n    json['oldNode'] = this.oldNode;\n    json['newNode'] = this.newNode;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of MarkerMove, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: MarkerMoveJson,\n    workspace: Workspace,\n    event?: any,\n  ): MarkerMove {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new MarkerMove(),\n    ) as MarkerMove;\n    newEvent.isCursor = json['isCursor'];\n    newEvent.blockId = json['blockId'];\n    newEvent.oldNode = json['oldNode'];\n    newEvent.newNode = json['newNode'];\n    return newEvent;\n  }\n}\n\nexport interface MarkerMoveJson extends AbstractEventJson {\n  isCursor: boolean;\n  blockId?: string;\n  oldNode?: ASTNode;\n  newNode: ASTNode;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.MARKER_MOVE, MarkerMove);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.MarkerSvg\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport '../../events/events_marker_move.js';\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Connection} from '../../connection.js';\nimport {ConnectionType} from '../../connection_type.js';\nimport * as eventUtils from '../../events/utils.js';\nimport type {Field} from '../../field.js';\nimport type {IASTNodeLocationSvg} from '../../interfaces/i_ast_node_location_svg.js';\nimport {ASTNode} from '../../keyboard_nav/ast_node.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\n\nimport type {ConstantProvider, Notch, PuzzleTab} from './constants.js';\nimport {FlyoutButton} from '../../flyout_button.js';\n\n/** The name of the CSS class for a cursor. */\nconst CURSOR_CLASS = 'blocklyCursor';\n\n/** The name of the CSS class for a marker. */\nconst MARKER_CLASS = 'blocklyMarker';\n\n/**\n * What we multiply the height by to get the height of the marker.\n * Only used for the block and block connections.\n */\nconst HEIGHT_MULTIPLIER = 3 / 4;\n\n/**\n * Class for a marker, containing methods for graphically rendering a marker as\n * SVG.\n */\nexport class MarkerSvg {\n  /**\n   * The workspace, field, or block that the marker SVG element should be\n   * attached to.\n   */\n  private parent: IASTNodeLocationSvg | null = null;\n\n  /** The current SVG element for the marker. */\n  currentMarkerSvg: SVGElement | null = null;\n  colour_: string;\n\n  /** The root SVG group containing the marker. */\n  protected markerSvg_: SVGGElement | null = null;\n  protected svgGroup_: SVGGElement | null = null;\n\n  protected markerBlock_: SVGPathElement | null = null;\n\n  protected markerInput_: SVGPathElement | null = null;\n  protected markerSvgLine_: SVGRectElement | null = null;\n\n  protected markerSvgRect_: SVGRectElement | null = null;\n\n  /** The constants necessary to draw the marker. */\n  protected constants_: ConstantProvider;\n\n  /**\n   * @param workspace The workspace the marker belongs to.\n   * @param constants The constants for the renderer.\n   * @param marker The marker to draw.\n   */\n  constructor(\n    private readonly workspace: WorkspaceSvg,\n    constants: ConstantProvider,\n    private readonly marker: Marker,\n  ) {\n    this.constants_ = constants;\n\n    const defaultColour = this.isCursor()\n      ? this.constants_.CURSOR_COLOUR\n      : this.constants_.MARKER_COLOUR;\n\n    /** The colour of the marker. */\n    this.colour_ = marker.colour || defaultColour;\n  }\n\n  /**\n   * Return the root node of the SVG or null if none exists.\n   *\n   * @returns The root SVG node.\n   */\n  getSvgRoot(): SVGElement | null {\n    return this.svgGroup_;\n  }\n\n  /**\n   * Get the marker.\n   *\n   * @returns The marker to draw for.\n   */\n  getMarker(): Marker {\n    return this.marker;\n  }\n\n  /**\n   * True if the marker should be drawn as a cursor, false otherwise.\n   * A cursor is drawn as a flashing line. A marker is drawn as a solid line.\n   *\n   * @returns True if the marker is a cursor, false otherwise.\n   */\n  isCursor(): boolean {\n    return this.marker.type === 'cursor';\n  }\n\n  /**\n   * Create the DOM element for the marker.\n   *\n   * @returns The marker controls SVG group.\n   */\n  createDom(): SVGElement {\n    const className = this.isCursor() ? CURSOR_CLASS : MARKER_CLASS;\n\n    this.svgGroup_ = dom.createSvgElement(Svg.G, {'class': className});\n\n    this.createDomInternal_();\n    return this.svgGroup_;\n  }\n\n  /**\n   * Attaches the SVG root of the marker to the SVG group of the parent.\n   *\n   * @param newParent The workspace, field, or block that the marker SVG element\n   *     should be attached to.\n   */\n  protected setParent_(newParent: IASTNodeLocationSvg) {\n    if (!this.isCursor()) {\n      if (this.parent) {\n        this.parent.setMarkerSvg(null);\n      }\n      newParent.setMarkerSvg(this.getSvgRoot());\n    } else {\n      if (this.parent) {\n        this.parent.setCursorSvg(null);\n      }\n      newParent.setCursorSvg(this.getSvgRoot());\n    }\n    this.parent = newParent;\n  }\n\n  /**\n   * Update the marker.\n   *\n   * @param oldNode The previous node the marker was on or null.\n   * @param curNode The node that we want to draw the marker for.\n   */\n  draw(oldNode: ASTNode, curNode: ASTNode) {\n    if (!curNode) {\n      this.hide();\n      return;\n    }\n\n    this.constants_ = this.workspace.getRenderer().getConstants();\n\n    const defaultColour = this.isCursor()\n      ? this.constants_.CURSOR_COLOUR\n      : this.constants_.MARKER_COLOUR;\n    this.colour_ = this.marker.colour || defaultColour;\n    this.applyColour_(curNode);\n\n    this.showAtLocation_(curNode);\n\n    this.fireMarkerEvent(oldNode, curNode);\n\n    // Ensures the marker will be visible immediately after the move.\n    const animate = this.currentMarkerSvg!.childNodes[0];\n    if (animate !== undefined) {\n      (animate as SVGAnimationElement).beginElement &&\n        (animate as SVGAnimationElement).beginElement();\n    }\n  }\n\n  /**\n   * Update the marker's visible state based on the type of curNode..\n   *\n   * @param curNode The node that we want to draw the marker for.\n   */\n  protected showAtLocation_(curNode: ASTNode) {\n    const curNodeAsConnection = curNode.getLocation() as Connection;\n    const connectionType = curNodeAsConnection.type;\n    if (curNode.getType() === ASTNode.types.BLOCK) {\n      this.showWithBlock_(curNode);\n    } else if (curNode.getType() === ASTNode.types.OUTPUT) {\n      this.showWithOutput_(curNode);\n    } else if (connectionType === ConnectionType.INPUT_VALUE) {\n      this.showWithInput_(curNode);\n    } else if (connectionType === ConnectionType.NEXT_STATEMENT) {\n      this.showWithNext_(curNode);\n    } else if (curNode.getType() === ASTNode.types.PREVIOUS) {\n      this.showWithPrevious_(curNode);\n    } else if (curNode.getType() === ASTNode.types.FIELD) {\n      this.showWithField_(curNode);\n    } else if (curNode.getType() === ASTNode.types.WORKSPACE) {\n      this.showWithCoordinates_(curNode);\n    } else if (curNode.getType() === ASTNode.types.STACK) {\n      this.showWithStack_(curNode);\n    } else if (curNode.getType() === ASTNode.types.BUTTON) {\n      this.showWithButton_(curNode);\n    }\n  }\n\n  /**************************\n   * Display\n   **************************/\n\n  /**\n   * Show the marker as a combination of the previous connection and block,\n   * the output connection and block, or just the block.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  private showWithBlockPrevOutput(curNode: ASTNode) {\n    const block = curNode.getSourceBlock() as BlockSvg;\n    const width = block.width;\n    const height = block.height;\n    const markerHeight = height * HEIGHT_MULTIPLIER;\n    const markerOffset = this.constants_.CURSOR_BLOCK_PADDING;\n\n    if (block.previousConnection) {\n      const connectionShape = this.constants_.shapeFor(\n        block.previousConnection,\n      ) as Notch;\n      this.positionPrevious_(\n        width,\n        markerOffset,\n        markerHeight,\n        connectionShape,\n      );\n    } else if (block.outputConnection) {\n      const connectionShape = this.constants_.shapeFor(\n        block.outputConnection,\n      ) as PuzzleTab;\n      this.positionOutput_(width, height, connectionShape);\n    } else {\n      this.positionBlock_(width, markerOffset, markerHeight);\n    }\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a block.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithBlock_(curNode: ASTNode) {\n    this.showWithBlockPrevOutput(curNode);\n  }\n\n  /**\n   * Position and display the marker for a previous connection.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithPrevious_(curNode: ASTNode) {\n    this.showWithBlockPrevOutput(curNode);\n  }\n\n  /**\n   * Position and display the marker for an output connection.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithOutput_(curNode: ASTNode) {\n    this.showWithBlockPrevOutput(curNode);\n  }\n\n  /**\n   * Position and display the marker for a workspace coordinate.\n   * This is a horizontal line.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithCoordinates_(curNode: ASTNode) {\n    const wsCoordinate = curNode.getWsCoordinate();\n    let x = wsCoordinate.x;\n    const y = wsCoordinate.y;\n\n    if (this.workspace.RTL) {\n      x -= this.constants_.CURSOR_WS_WIDTH;\n    }\n\n    this.positionLine_(x, y, this.constants_.CURSOR_WS_WIDTH);\n    this.setParent_(this.workspace);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a field.\n   * This is a box around the field.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithField_(curNode: ASTNode) {\n    const field = curNode.getLocation() as Field;\n    const width = field.getSize().width;\n    const height = field.getSize().height;\n\n    this.positionRect_(0, 0, width, height);\n    this.setParent_(field);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for an input.\n   * This is a puzzle piece.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithInput_(curNode: ASTNode) {\n    const connection = curNode.getLocation() as RenderedConnection;\n    const sourceBlock = connection.getSourceBlock();\n\n    this.positionInput_(connection);\n    this.setParent_(sourceBlock);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a next connection.\n   * This is a horizontal line.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithNext_(curNode: ASTNode) {\n    const connection = curNode.getLocation() as RenderedConnection;\n    const targetBlock = connection.getSourceBlock();\n    let x = 0;\n    const y = connection.getOffsetInBlock().y;\n    const width = targetBlock.getHeightWidth().width;\n    if (this.workspace.RTL) {\n      x = -width;\n    }\n    this.positionLine_(x, y, width);\n    this.setParent_(targetBlock);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a stack.\n   * This is a box with extra padding around the entire stack of blocks.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithStack_(curNode: ASTNode) {\n    const block = curNode.getLocation() as BlockSvg;\n\n    // Gets the height and width of entire stack.\n    const heightWidth = block.getHeightWidth();\n\n    // Add padding so that being on a stack looks different than being on a\n    // block.\n    const width = heightWidth.width + this.constants_.CURSOR_STACK_PADDING;\n    const height = heightWidth.height + this.constants_.CURSOR_STACK_PADDING;\n\n    // Shift the rectangle slightly to upper left so padding is equal on all\n    // sides.\n    const xPadding = -this.constants_.CURSOR_STACK_PADDING / 2;\n    const yPadding = -this.constants_.CURSOR_STACK_PADDING / 2;\n\n    let x = xPadding;\n    const y = yPadding;\n\n    if (this.workspace.RTL) {\n      x = -(width + xPadding);\n    }\n    this.positionRect_(x, y, width, height);\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a flyout button.\n   * This is a box with extra padding around the button.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithButton_(curNode: ASTNode) {\n    const button = curNode.getLocation() as FlyoutButton;\n\n    // Gets the height and width of entire stack.\n    const heightWidth = {height: button.height, width: button.width};\n\n    // Add padding so that being on a button looks similar to being on a stack.\n    const width = heightWidth.width + this.constants_.CURSOR_STACK_PADDING;\n    const height = heightWidth.height + this.constants_.CURSOR_STACK_PADDING;\n\n    // Shift the rectangle slightly to upper left so padding is equal on all\n    // sides.\n    const xPadding = -this.constants_.CURSOR_STACK_PADDING / 2;\n    const yPadding = -this.constants_.CURSOR_STACK_PADDING / 2;\n\n    let x = xPadding;\n    const y = yPadding;\n\n    if (this.workspace.RTL) {\n      x = -(width + xPadding);\n    }\n    this.positionRect_(x, y, width, height);\n    this.setParent_(button);\n    this.showCurrent_();\n  }\n\n  /** Show the current marker. */\n  protected showCurrent_() {\n    this.hide();\n    if (this.currentMarkerSvg) {\n      this.currentMarkerSvg.style.display = '';\n    }\n  }\n\n  /**************************\n   * Position\n   **************************/\n\n  /**\n   * Position the marker for a block.\n   * Displays an outline of the top half of a rectangle around a block.\n   *\n   * @param width The width of the block.\n   * @param markerOffset The extra padding for around the block.\n   * @param markerHeight The height of the marker.\n   */\n  protected positionBlock_(\n    width: number,\n    markerOffset: number,\n    markerHeight: number,\n  ) {\n    const markerPath =\n      svgPaths.moveBy(-markerOffset, markerHeight) +\n      svgPaths.lineOnAxis('V', -markerOffset) +\n      svgPaths.lineOnAxis('H', width + markerOffset * 2) +\n      svgPaths.lineOnAxis('V', markerHeight);\n    if (!this.markerBlock_) {\n      throw new Error(\n        'createDom should be called before positioning the marker',\n      );\n    }\n    this.markerBlock_.setAttribute('d', markerPath);\n    if (this.workspace.RTL) {\n      this.flipRtl(this.markerBlock_);\n    }\n    this.currentMarkerSvg = this.markerBlock_;\n  }\n\n  /**\n   * Position the marker for an input connection.\n   * Displays a filled in puzzle piece.\n   *\n   * @param connection The connection to position marker around.\n   */\n  protected positionInput_(connection: RenderedConnection) {\n    const x = connection.getOffsetInBlock().x;\n    const y = connection.getOffsetInBlock().y;\n\n    const path =\n      svgPaths.moveTo(0, 0) +\n      (this.constants_.shapeFor(connection) as PuzzleTab).pathDown;\n\n    this.markerInput_!.setAttribute('d', path);\n    this.markerInput_!.setAttribute(\n      'transform',\n      'translate(' +\n        x +\n        ',' +\n        y +\n        ')' +\n        (this.workspace.RTL ? ' scale(-1 1)' : ''),\n    );\n    this.currentMarkerSvg = this.markerInput_;\n  }\n\n  /**\n   * Move and show the marker at the specified coordinate in workspace units.\n   * Displays a horizontal line.\n   *\n   * @param x The new x, in workspace units.\n   * @param y The new y, in workspace units.\n   * @param width The new width, in workspace units.\n   */\n  protected positionLine_(x: number, y: number, width: number) {\n    if (!this.markerSvgLine_) {\n      throw new Error('createDom should be called before positioning the line');\n    }\n    this.markerSvgLine_.setAttribute('x', `${x}`);\n    this.markerSvgLine_.setAttribute('y', `${y}`);\n    this.markerSvgLine_.setAttribute('width', `${width}`);\n    this.currentMarkerSvg = this.markerSvgLine_;\n  }\n\n  /**\n   * Position the marker for an output connection.\n   * Displays a puzzle outline and the top and bottom path.\n   *\n   * @param width The width of the block.\n   * @param height The height of the block.\n   * @param connectionShape The shape object for the connection.\n   */\n  protected positionOutput_(\n    width: number,\n    height: number,\n    connectionShape: PuzzleTab,\n  ) {\n    if (!this.markerBlock_) {\n      throw new Error(\n        'createDom should be called before positioning the output',\n      );\n    }\n    const markerPath =\n      svgPaths.moveBy(width, 0) +\n      svgPaths.lineOnAxis('h', -(width - connectionShape.width)) +\n      svgPaths.lineOnAxis('v', this.constants_.TAB_OFFSET_FROM_TOP) +\n      connectionShape.pathDown +\n      svgPaths.lineOnAxis('V', height) +\n      svgPaths.lineOnAxis('H', width);\n    this.markerBlock_.setAttribute('d', markerPath);\n    if (this.workspace.RTL) {\n      this.flipRtl(this.markerBlock_);\n    }\n    this.currentMarkerSvg = this.markerBlock_;\n  }\n\n  /**\n   * Position the marker for a previous connection.\n   * Displays a half rectangle with a notch in the top to represent the previous\n   * connection.\n   *\n   * @param width The width of the block.\n   * @param markerOffset The offset of the marker from around the block.\n   * @param markerHeight The height of the marker.\n   * @param connectionShape The shape object for the connection.\n   */\n  protected positionPrevious_(\n    width: number,\n    markerOffset: number,\n    markerHeight: number,\n    connectionShape: Notch,\n  ) {\n    if (!this.markerBlock_) {\n      throw new Error(\n        'createDom should be called before positioning the previous connection marker',\n      );\n    }\n    const markerPath =\n      svgPaths.moveBy(-markerOffset, markerHeight) +\n      svgPaths.lineOnAxis('V', -markerOffset) +\n      svgPaths.lineOnAxis('H', this.constants_.NOTCH_OFFSET_LEFT) +\n      connectionShape.pathLeft +\n      svgPaths.lineOnAxis('H', width + markerOffset * 2) +\n      svgPaths.lineOnAxis('V', markerHeight);\n    this.markerBlock_.setAttribute('d', markerPath);\n    if (this.workspace.RTL) {\n      this.flipRtl(this.markerBlock_);\n    }\n    this.currentMarkerSvg = this.markerBlock_;\n  }\n\n  /**\n   * Move and show the marker at the specified coordinate in workspace units.\n   * Displays a filled in rectangle.\n   *\n   * @param x The new x, in workspace units.\n   * @param y The new y, in workspace units.\n   * @param width The new width, in workspace units.\n   * @param height The new height, in workspace units.\n   */\n  protected positionRect_(x: number, y: number, width: number, height: number) {\n    if (!this.markerSvgRect_) {\n      throw new Error('createDom should be called before positioning the rect');\n    }\n    this.markerSvgRect_.setAttribute('x', `${x}`);\n    this.markerSvgRect_.setAttribute('y', `${y}`);\n    this.markerSvgRect_.setAttribute('width', `${width}`);\n    this.markerSvgRect_.setAttribute('height', `${height}`);\n    this.currentMarkerSvg = this.markerSvgRect_;\n  }\n\n  /**\n   * Flip the SVG paths in RTL.\n   *\n   * @param markerSvg The marker that we want to flip.\n   */\n  private flipRtl(markerSvg: SVGElement) {\n    markerSvg.setAttribute('transform', 'scale(-1 1)');\n  }\n\n  /** Hide the marker. */\n  hide() {\n    if (\n      !this.markerSvgLine_ ||\n      !this.markerSvgRect_ ||\n      !this.markerInput_ ||\n      !this.markerBlock_\n    ) {\n      throw new Error('createDom should be called before hiding the marker');\n    }\n    this.markerSvgLine_.style.display = 'none';\n    this.markerSvgRect_.style.display = 'none';\n    this.markerInput_.style.display = 'none';\n    this.markerBlock_.style.display = 'none';\n  }\n\n  /**\n   * Fire event for the marker or marker.\n   *\n   * @param oldNode The old node the marker used to be on.\n   * @param curNode The new node the marker is currently on.\n   */\n  private fireMarkerEvent(oldNode: ASTNode, curNode: ASTNode) {\n    const curBlock = curNode.getSourceBlock();\n    const event = new (eventUtils.get(eventUtils.MARKER_MOVE))(\n      curBlock,\n      this.isCursor(),\n      oldNode,\n      curNode,\n    );\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Get the properties to make a marker blink.\n   *\n   * @returns The object holding attributes to make the marker blink.\n   */\n  protected getBlinkProperties_(): {[key: string]: string} {\n    return {\n      'attributeType': 'XML',\n      'attributeName': 'fill',\n      'dur': '1s',\n      'values': this.colour_ + ';transparent;transparent;',\n      'repeatCount': 'indefinite',\n    };\n  }\n\n  /**\n   * Create the marker SVG.\n   *\n   * @returns The SVG node created.\n   */\n  protected createDomInternal_(): Element {\n    /* This markup will be generated and added to the .svgGroup_:\n        <g>\n          <rect width=\"100\" height=\"5\">\n            <animate attributeType=\"XML\" attributeName=\"fill\" dur=\"1s\"\n              values=\"transparent;transparent;#fff;transparent\"\n        repeatCount=\"indefinite\" />\n          </rect>\n        </g>\n        */\n\n    this.markerSvg_ = dom.createSvgElement(\n      Svg.G,\n      {\n        'width': this.constants_.CURSOR_WS_WIDTH,\n        'height': this.constants_.WS_CURSOR_HEIGHT,\n      },\n      this.svgGroup_,\n    );\n\n    // A horizontal line used to represent a workspace coordinate or next\n    // connection.\n    this.markerSvgLine_ = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'width': this.constants_.CURSOR_WS_WIDTH,\n        'height': this.constants_.WS_CURSOR_HEIGHT,\n      },\n      this.markerSvg_,\n    );\n\n    // A filled in rectangle used to represent a stack.\n    this.markerSvgRect_ = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyVerticalMarker',\n        'rx': 10,\n        'ry': 10,\n      },\n      this.markerSvg_,\n    );\n\n    // A filled in puzzle piece used to represent an input value.\n    this.markerInput_ = dom.createSvgElement(\n      Svg.PATH,\n      {'transform': ''},\n      this.markerSvg_,\n    );\n\n    // A path used to represent a previous connection and a block, an output\n    // connection and a block, or a block.\n    this.markerBlock_ = dom.createSvgElement(\n      Svg.PATH,\n      {\n        'transform': '',\n        'fill': 'none',\n        'stroke-width': this.constants_.CURSOR_STROKE_WIDTH,\n      },\n      this.markerSvg_,\n    );\n\n    this.hide();\n\n    // Markers and stack markers don't blink.\n    if (this.isCursor()) {\n      const blinkProperties = this.getBlinkProperties_();\n      dom.createSvgElement(Svg.ANIMATE, blinkProperties, this.markerSvgLine_);\n      dom.createSvgElement(Svg.ANIMATE, blinkProperties, this.markerInput_);\n      dom.createSvgElement(\n        Svg.ANIMATE,\n        {...blinkProperties, attributeName: 'stroke'},\n        this.markerBlock_,\n      );\n    }\n\n    return this.markerSvg_;\n  }\n\n  /**\n   * Apply the marker's colour.\n   *\n   * @param _curNode The node that we want to draw the marker for.\n   */\n  protected applyColour_(_curNode: ASTNode) {\n    if (\n      !this.markerSvgLine_ ||\n      !this.markerSvgRect_ ||\n      !this.markerInput_ ||\n      !this.markerBlock_\n    ) {\n      throw new Error(\n        'createDom should be called before applying color to the markerj',\n      );\n    }\n    this.markerSvgLine_.setAttribute('fill', this.colour_);\n    this.markerSvgRect_.setAttribute('stroke', this.colour_);\n    this.markerInput_.setAttribute('fill', this.colour_);\n    this.markerBlock_.setAttribute('stroke', this.colour_);\n\n    if (this.isCursor()) {\n      const values = this.colour_ + ';transparent;transparent;';\n      this.markerSvgLine_.firstElementChild!.setAttribute('values', values);\n      this.markerInput_.firstElementChild!.setAttribute('values', values);\n      this.markerBlock_.firstElementChild!.setAttribute('values', values);\n    }\n  }\n\n  /** Dispose of this marker. */\n  dispose() {\n    if (this.svgGroup_) {\n      dom.removeNode(this.svgGroup_);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.PathObject\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Connection} from '../../connection.js';\nimport {RenderedConnection} from '../../rendered_connection.js';\nimport type {BlockStyle} from '../../theme.js';\nimport {Coordinate} from '../../utils/coordinate.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport type {IPathObject} from './i_path_object.js';\n\n/**\n * An object that handles creating and setting each of the SVG elements\n * used by the renderer.\n */\nexport class PathObject implements IPathObject {\n  svgRoot: SVGElement;\n  svgPath: SVGElement;\n\n  /**\n   * Holds the cursors svg element when the cursor is attached to the block.\n   * This is null if there is no cursor on the block.\n   */\n  cursorSvg: SVGElement | null = null;\n\n  /**\n   * Holds the markers svg element when the marker is attached to the block.\n   * This is null if there is no marker on the block.\n   */\n  markerSvg: SVGElement | null = null;\n\n  constants: ConstantProvider;\n  style: BlockStyle;\n\n  /** Highlight paths associated with connections. */\n  private connectionHighlights = new WeakMap<RenderedConnection, SVGElement>();\n\n  /** Locations of connection highlights. */\n  private highlightOffsets = new WeakMap<RenderedConnection, Coordinate>();\n\n  /**\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @param constants The renderer's constants.\n   */\n  constructor(\n    root: SVGElement,\n    style: BlockStyle,\n    constants: ConstantProvider,\n  ) {\n    this.constants = constants;\n    this.style = style;\n    this.svgRoot = root;\n\n    /** The primary path of the block. */\n    this.svgPath = dom.createSvgElement(\n      Svg.PATH,\n      {'class': 'blocklyPath'},\n      this.svgRoot,\n    );\n  }\n\n  /**\n   * Set the path generated by the renderer onto the respective SVG element.\n   *\n   * @param pathString The path.\n   */\n  setPath(pathString: string) {\n    this.svgPath.setAttribute('d', pathString);\n  }\n\n  /**\n   * Flip the SVG paths in RTL.\n   */\n  flipRTL() {\n    // Mirror the block's path.\n    this.svgPath.setAttribute('transform', 'scale(-1 1)');\n  }\n\n  /**\n   * Add the cursor SVG to this block's SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the block SVG\n   *     group.\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    if (!cursorSvg) {\n      this.cursorSvg = null;\n      return;\n    }\n\n    this.svgRoot.appendChild(cursorSvg);\n    this.cursorSvg = cursorSvg;\n  }\n\n  /**\n   * Add the marker SVG to this block's SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the block SVG\n   *     group.\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    if (!markerSvg) {\n      this.markerSvg = null;\n      return;\n    }\n\n    if (this.cursorSvg) {\n      this.svgRoot.insertBefore(markerSvg, this.cursorSvg);\n    } else {\n      this.svgRoot.appendChild(markerSvg);\n    }\n    this.markerSvg = markerSvg;\n  }\n\n  /**\n   * Apply the stored colours to the block's path, taking into account whether\n   * the paths belong to a shadow block.\n   *\n   * @param block The source block.\n   */\n  applyColour(block: BlockSvg) {\n    this.svgPath.setAttribute('stroke', this.style.colourTertiary);\n    this.svgPath.setAttribute('fill', this.style.colourPrimary);\n\n    this.updateShadow_(block.isShadow());\n    this.updateDisabled_(!block.isEnabled() || block.getInheritedDisabled());\n  }\n\n  /**\n   * Set the style.\n   *\n   * @param blockStyle The block style to use.\n   */\n  setStyle(blockStyle: BlockStyle) {\n    this.style = blockStyle;\n  }\n\n  /**\n   * Add or remove the given CSS class on the path object's root SVG element.\n   *\n   * @param className The name of the class to add or remove\n   * @param add True if the class should be added.  False if it should be\n   *     removed.\n   */\n  protected setClass_(className: string, add: boolean) {\n    if (!className) {\n      return;\n    }\n    if (add) {\n      dom.addClass(this.svgRoot, className);\n    } else {\n      dom.removeClass(this.svgRoot, className);\n    }\n  }\n\n  /**\n   * Set whether the block shows a highlight or not.  Block highlighting is\n   * often used to visually mark blocks currently being executed.\n   *\n   * @param enable True if highlighted.\n   */\n  updateHighlighted(enable: boolean) {\n    if (enable) {\n      this.svgPath.setAttribute(\n        'filter',\n        'url(#' + this.constants.embossFilterId + ')',\n      );\n    } else {\n      this.svgPath.setAttribute('filter', 'none');\n    }\n  }\n\n  /**\n   * Updates the look of the block to reflect a shadow state.\n   *\n   * @param shadow True if the block is a shadow block.\n   */\n  protected updateShadow_(shadow: boolean) {\n    if (shadow) {\n      this.svgPath.setAttribute('stroke', 'none');\n      this.svgPath.setAttribute('fill', this.style.colourSecondary);\n    }\n  }\n\n  /**\n   * Updates the look of the block to reflect a disabled state.\n   *\n   * @param disabled True if disabled.\n   */\n  protected updateDisabled_(disabled: boolean) {\n    this.setClass_('blocklyDisabled', disabled);\n    if (disabled) {\n      this.svgPath.setAttribute(\n        'fill',\n        'url(#' + this.constants.disabledPatternId + ')',\n      );\n    }\n  }\n\n  /**\n   * Add or remove styling showing that a block is selected.\n   *\n   * @param enable True if selection is enabled, false otherwise.\n   */\n  updateSelected(enable: boolean) {\n    this.setClass_('blocklySelected', enable);\n  }\n\n  /**\n   * Add or remove styling showing that a block is dragged over a delete area.\n   *\n   * @param enable True if the block is being dragged over a delete area, false\n   *     otherwise.\n   */\n  updateDraggingDelete(enable: boolean) {\n    this.setClass_('blocklyDraggingDelete', enable);\n  }\n\n  /**\n   * Add or remove styling showing that a block is an insertion marker.\n   *\n   * @param enable True if the block is an insertion marker, false otherwise.\n   */\n  updateInsertionMarker(enable: boolean) {\n    this.setClass_('blocklyInsertionMarker', enable);\n  }\n\n  /**\n   * Add or remove styling showing that a block is movable.\n   *\n   * @param enable True if the block is movable, false otherwise.\n   */\n  updateMovable(enable: boolean) {\n    this.setClass_('blocklyDraggable', enable);\n  }\n\n  /**\n   * Add or remove styling that shows that if the dragging block is dropped,\n   * this block will be replaced.  If a shadow block, it will disappear.\n   * Otherwise it will bump.\n   *\n   * @param enable True if styling should be added.\n   */\n  updateReplacementFade(enable: boolean) {\n    this.setClass_('blocklyReplaceable', enable);\n  }\n\n  /**\n   * Add or remove styling that shows that if the dragging block is dropped,\n   * this block will be connected to the input.\n   *\n   * @param _conn The connection on the input to highlight.\n   * @param _enable True if styling should be added.\n   */\n  updateShapeForInputHighlight(_conn: Connection, _enable: boolean) {\n    // NOOP\n  }\n\n  /** Adds the given path as a connection highlight for the given connection. */\n  addConnectionHighlight(\n    connection: RenderedConnection,\n    connectionPath: string,\n    offset: Coordinate,\n    rtl: boolean,\n  ) {\n    if (this.connectionHighlights.has(connection)) {\n      if (this.currentHighlightMatchesNew(connection, connectionPath, offset)) {\n        return;\n      }\n      this.removeConnectionHighlight(connection);\n    }\n\n    const highlight = dom.createSvgElement(\n      Svg.PATH,\n      {\n        'class': 'blocklyHighlightedConnectionPath',\n        'd': connectionPath,\n        'transform':\n          `translate(${offset.x}, ${offset.y})` + (rtl ? ' scale(-1 1)' : ''),\n      },\n      this.svgRoot,\n    );\n    this.connectionHighlights.set(connection, highlight);\n  }\n\n  private currentHighlightMatchesNew(\n    connection: RenderedConnection,\n    newPath: string,\n    newOffset: Coordinate,\n  ): boolean {\n    const currPath = this.connectionHighlights\n      .get(connection)\n      ?.getAttribute('d');\n    const currOffset = this.highlightOffsets.get(connection);\n    return currPath === newPath && Coordinate.equals(currOffset, newOffset);\n  }\n\n  /**\n   * Removes any highlight associated with the given connection, if it exists.\n   */\n  removeConnectionHighlight(connection: RenderedConnection) {\n    const highlight = this.connectionHighlights.get(connection);\n    if (!highlight) return;\n    dom.removeNode(highlight);\n    this.connectionHighlights.delete(connection);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class that controls updates to connections during drags.\n *\n * @class\n */\n// Former goog.module ID: Blockly.InsertionMarkerManager\n\nimport {finishQueuedRenders} from './render_management.js';\nimport * as blockAnimations from './block_animations.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {config} from './config.js';\nimport * as blocks from './serialization/blocks.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IDeleteArea} from './interfaces/i_delete_area.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {RenderedConnection} from './rendered_connection.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as renderManagement from './render_management.js';\n\n/** Represents a nearby valid connection. */\ninterface CandidateConnection {\n  /**\n   * A nearby valid connection that is compatible with local.\n   * This is not on any of the blocks that are being dragged.\n   */\n  closest: RenderedConnection;\n  /**\n   * A connection on the dragging stack that is compatible with closest. This is\n   * on the top block that is being dragged or the last block in the dragging\n   * stack.\n   */\n  local: RenderedConnection;\n  radius: number;\n}\n\n/**\n * Class that controls updates to connections during drags.  It is primarily\n * responsible for finding the closest eligible connection and highlighting or\n * unhighlighting it as needed during a drag.\n *\n * @deprecated v10 - Use an IConnectionPreviewer instead.\n */\nexport class InsertionMarkerManager {\n  /**\n   * The top block in the stack being dragged.\n   * Does not change during a drag.\n   */\n  private readonly topBlock: BlockSvg;\n\n  /**\n   * The workspace on which these connections are being dragged.\n   * Does not change during a drag.\n   */\n  private readonly workspace: WorkspaceSvg;\n\n  /**\n   * The last connection on the stack, if it's not the last connection on the\n   * first block.\n   * Set in initAvailableConnections, if at all.\n   */\n  private lastOnStack: RenderedConnection | null = null;\n\n  /**\n   * The insertion marker corresponding to the last block in the stack, if\n   * that's not the same as the first block in the stack.\n   * Set in initAvailableConnections, if at all\n   */\n  private lastMarker: BlockSvg | null = null;\n\n  /**\n   * The insertion marker that shows up between blocks to show where a block\n   * would go if dropped immediately.\n   */\n  private firstMarker: BlockSvg;\n\n  /**\n   * Information about the connection that would be made if the dragging block\n   * were released immediately. Updated on every mouse move.\n   */\n  private activeCandidate: CandidateConnection | null = null;\n\n  /**\n   * Whether the block would be deleted if it were dropped immediately.\n   * Updated on every mouse move.\n   *\n   * @internal\n   */\n  public wouldDeleteBlock = false;\n\n  /**\n   * Connection on the insertion marker block that corresponds to\n   * the active candidate's local connection on the currently dragged block.\n   */\n  private markerConnection: RenderedConnection | null = null;\n\n  /** The block that currently has an input being highlighted, or null. */\n  private highlightedBlock: BlockSvg | null = null;\n\n  /** The block being faded to indicate replacement, or null. */\n  private fadedBlock: BlockSvg | null = null;\n\n  /**\n   * The connections on the dragging blocks that are available to connect to\n   * other blocks.  This includes all open connections on the top block, as\n   * well as the last connection on the block stack.\n   */\n  private availableConnections: RenderedConnection[];\n\n  /** @param block The top block in the stack being dragged. */\n  constructor(block: BlockSvg) {\n    common.setSelected(block);\n    this.topBlock = block;\n\n    this.workspace = block.workspace;\n\n    this.firstMarker = this.createMarkerBlock(this.topBlock);\n\n    this.availableConnections = this.initAvailableConnections();\n\n    if (this.lastOnStack) {\n      this.lastMarker = this.createMarkerBlock(\n        this.lastOnStack.getSourceBlock(),\n      );\n    }\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @internal\n   */\n  dispose() {\n    this.availableConnections.length = 0;\n    this.disposeInsertionMarker(this.firstMarker);\n    this.disposeInsertionMarker(this.lastMarker);\n  }\n\n  /**\n   * Update the available connections for the top block. These connections can\n   * change if a block is unplugged and the stack is healed.\n   *\n   * @internal\n   */\n  updateAvailableConnections() {\n    this.availableConnections = this.initAvailableConnections();\n  }\n\n  /**\n   * Return whether the block would be connected if dropped immediately, based\n   * on information from the most recent move event.\n   *\n   * @returns True if the block would be connected if dropped immediately.\n   * @internal\n   */\n  wouldConnectBlock(): boolean {\n    return !!this.activeCandidate;\n  }\n\n  /**\n   * Connect to the closest connection and render the results.\n   * This should be called at the end of a drag.\n   *\n   * @internal\n   */\n  applyConnections() {\n    if (!this.activeCandidate) return;\n    eventUtils.disable();\n    this.hidePreview();\n    eventUtils.enable();\n    const {local, closest} = this.activeCandidate;\n    local.connect(closest);\n    const inferiorConnection = local.isSuperior() ? closest : local;\n    const rootBlock = this.topBlock.getRootBlock();\n\n    finishQueuedRenders().then(() => {\n      blockAnimations.connectionUiEffect(inferiorConnection.getSourceBlock());\n      // bringToFront is incredibly expensive. Delay until the next frame.\n      setTimeout(() => {\n        rootBlock.bringToFront();\n      }, 0);\n    });\n  }\n\n  /**\n   * Update connections based on the most recent move location.\n   *\n   * @param dxy Position relative to drag start, in workspace units.\n   * @param dragTarget The drag target that the block is currently over.\n   * @internal\n   */\n  update(dxy: Coordinate, dragTarget: IDragTarget | null) {\n    const newCandidate = this.getCandidate(dxy);\n\n    this.wouldDeleteBlock = this.shouldDelete(!!newCandidate, dragTarget);\n\n    const shouldUpdate =\n      this.wouldDeleteBlock || this.shouldUpdatePreviews(newCandidate, dxy);\n\n    if (shouldUpdate) {\n      // Don't fire events for insertion marker creation or movement.\n      eventUtils.disable();\n      this.maybeHidePreview(newCandidate);\n      this.maybeShowPreview(newCandidate);\n      eventUtils.enable();\n    }\n  }\n\n  /**\n   * Create an insertion marker that represents the given block.\n   *\n   * @param sourceBlock The block that the insertion marker will represent.\n   * @returns The insertion marker that represents the given block.\n   */\n  private createMarkerBlock(sourceBlock: BlockSvg): BlockSvg {\n    eventUtils.disable();\n    let result: BlockSvg;\n    try {\n      const blockJson = blocks.save(sourceBlock, {\n        addCoordinates: false,\n        addInputBlocks: false,\n        addNextBlocks: false,\n        doFullSerialization: false,\n      });\n\n      if (!blockJson) {\n        throw new Error(\n          `Failed to serialize source block. ${sourceBlock.toDevString()}`,\n        );\n      }\n\n      result = blocks.append(blockJson, this.workspace) as BlockSvg;\n\n      // Turn shadow blocks that are created programmatically during\n      // initalization to insertion markers too.\n      for (const block of result.getDescendants(false)) {\n        block.setInsertionMarker(true);\n      }\n\n      result.initSvg();\n      result.getSvgRoot().setAttribute('visibility', 'hidden');\n    } finally {\n      eventUtils.enable();\n    }\n\n    return result;\n  }\n\n  /**\n   * Populate the list of available connections on this block stack. If the\n   * stack has more than one block, this function will also update lastOnStack.\n   *\n   * @returns A list of available connections.\n   */\n  private initAvailableConnections(): RenderedConnection[] {\n    const available = this.topBlock.getConnections_(false);\n    // Also check the last connection on this stack\n    const lastOnStack = this.topBlock.lastConnectionInStack(true);\n    if (lastOnStack && lastOnStack !== this.topBlock.nextConnection) {\n      available.push(lastOnStack);\n      this.lastOnStack = lastOnStack;\n    }\n    return available;\n  }\n\n  /**\n   * Whether the previews (insertion marker and replacement marker) should be\n   * updated based on the closest candidate and the current drag distance.\n   *\n   * @param newCandidate A new candidate connection that may replace the current\n   *     best candidate.\n   * @param dxy Position relative to drag start, in workspace units.\n   * @returns Whether the preview should be updated.\n   */\n  private shouldUpdatePreviews(\n    newCandidate: CandidateConnection | null,\n    dxy: Coordinate,\n  ): boolean {\n    // Only need to update if we were showing a preview before.\n    if (!newCandidate) return !!this.activeCandidate;\n\n    // We weren't showing a preview before, but we should now.\n    if (!this.activeCandidate) return true;\n\n    // We're already showing an insertion marker.\n    // Decide whether the new connection has higher priority.\n    const {local: activeLocal, closest: activeClosest} = this.activeCandidate;\n    if (\n      activeClosest === newCandidate.closest &&\n      activeLocal === newCandidate.local\n    ) {\n      // The connection was the same as the current connection.\n      return false;\n    }\n\n    const xDiff = activeLocal.x + dxy.x - activeClosest.x;\n    const yDiff = activeLocal.y + dxy.y - activeClosest.y;\n    const curDistance = Math.sqrt(xDiff * xDiff + yDiff * yDiff);\n    // Slightly prefer the existing preview over a new preview.\n    return (\n      newCandidate.radius < curDistance - config.currentConnectionPreference\n    );\n  }\n\n  /**\n   * Find the nearest valid connection, which may be the same as the current\n   * closest connection.\n   *\n   * @param dxy Position relative to drag start, in workspace units.\n   * @returns An object containing a local connection, a closest connection, and\n   *     a radius.\n   */\n  private getCandidate(dxy: Coordinate): CandidateConnection | null {\n    // It's possible that a block has added or removed connections during a\n    // drag, (e.g. in a drag/move event handler), so let's update the available\n    // connections. Note that this will be called on every move while dragging,\n    // so it might cause slowness, especially if the block stack is large.  If\n    // so, maybe it could be made more efficient. Also note that we won't update\n    // the connections if we've already connected the insertion marker to a\n    // block.\n    if (!this.markerConnection || !this.markerConnection.isConnected()) {\n      this.updateAvailableConnections();\n    }\n\n    let radius = this.getStartRadius();\n    let candidate = null;\n    for (let i = 0; i < this.availableConnections.length; i++) {\n      const myConnection = this.availableConnections[i];\n      const neighbour = myConnection.closest(radius, dxy);\n      if (neighbour.connection) {\n        candidate = {\n          closest: neighbour.connection,\n          local: myConnection,\n          radius: neighbour.radius,\n        };\n        radius = neighbour.radius;\n      }\n    }\n    return candidate;\n  }\n\n  /**\n   * Decide the radius at which to start searching for the closest connection.\n   *\n   * @returns The radius at which to start the search for the closest\n   *     connection.\n   */\n  private getStartRadius(): number {\n    // If there is already a connection highlighted,\n    // increase the radius we check for making new connections.\n    // When a connection is highlighted, blocks move around when the\n    // insertion marker is created, which could cause the connection became out\n    // of range. By increasing radiusConnection when a connection already\n    // exists, we never \"lose\" the connection from the offset.\n    return this.activeCandidate\n      ? config.connectingSnapRadius\n      : config.snapRadius;\n  }\n\n  /**\n   * Whether ending the drag would delete the block.\n   *\n   * @param newCandidate Whether there is a candidate connection that the\n   *     block could connect to if the drag ended immediately.\n   * @param dragTarget The drag target that the block is currently over.\n   * @returns Whether dropping the block immediately would delete the block.\n   */\n  private shouldDelete(\n    newCandidate: boolean,\n    dragTarget: IDragTarget | null,\n  ): boolean {\n    if (dragTarget) {\n      const componentManager = this.workspace.getComponentManager();\n      const isDeleteArea = componentManager.hasCapability(\n        dragTarget.id,\n        ComponentManager.Capability.DELETE_AREA,\n      );\n      if (isDeleteArea) {\n        return (dragTarget as IDeleteArea).wouldDelete(this.topBlock);\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Show an insertion marker or replacement highlighting during a drag, if\n   * needed.\n   * At the beginning of this function, this.activeConnection should be null.\n   *\n   * @param newCandidate A new candidate connection that may replace the current\n   *     best candidate.\n   */\n  private maybeShowPreview(newCandidate: CandidateConnection | null) {\n    if (this.wouldDeleteBlock) return; // Nope, don't add a marker.\n    if (!newCandidate) return; // Nothing to connect to.\n\n    const closest = newCandidate.closest;\n\n    // Something went wrong and we're trying to connect to an invalid\n    // connection.\n    if (\n      closest === this.activeCandidate?.closest ||\n      closest.getSourceBlock().isInsertionMarker()\n    ) {\n      console.log('Trying to connect to an insertion marker');\n      return;\n    }\n    this.activeCandidate = newCandidate;\n    // Add an insertion marker or replacement marker.\n    this.showPreview(this.activeCandidate);\n  }\n\n  /**\n   * A preview should be shown.  This function figures out if it should be a\n   * block highlight or an insertion marker, and shows the appropriate one.\n   *\n   * @param activeCandidate The connection that will be made if the drag ends\n   *     immediately.\n   */\n  private showPreview(activeCandidate: CandidateConnection) {\n    const renderer = this.workspace.getRenderer();\n    const method = renderer.getConnectionPreviewMethod(\n      activeCandidate.closest,\n      activeCandidate.local,\n      this.topBlock,\n    );\n\n    switch (method) {\n      case InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:\n        this.showInsertionInputOutline(activeCandidate);\n        break;\n      case InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:\n        this.showInsertionMarker(activeCandidate);\n        break;\n      case InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:\n        this.showReplacementFade(activeCandidate);\n        break;\n    }\n\n    // Optionally highlight the actual connection, as a nod to previous\n    // behaviour.\n    if (renderer.shouldHighlightConnection(activeCandidate.closest)) {\n      activeCandidate.closest.highlight();\n    }\n  }\n\n  /**\n   * Hide an insertion marker or replacement highlighting during a drag, if\n   * needed.\n   * At the end of this function, this.activeCandidate will be null.\n   *\n   * @param newCandidate A new candidate connection that may replace the current\n   *     best candidate.\n   */\n  private maybeHidePreview(newCandidate: CandidateConnection | null) {\n    // If there's no new preview, remove the old one but don't bother deleting\n    // it. We might need it later, and this saves disposing of it and recreating\n    // it.\n    if (!newCandidate) {\n      this.hidePreview();\n    } else {\n      if (this.activeCandidate) {\n        const closestChanged =\n          this.activeCandidate.closest !== newCandidate.closest;\n        const localChanged = this.activeCandidate.local !== newCandidate.local;\n\n        // If there's a new preview and there was a preview before, and either\n        // connection has changed, remove the old preview.\n        // Also hide if we had a preview before but now we're going to delete\n        // instead.\n        if (closestChanged || localChanged || this.wouldDeleteBlock) {\n          this.hidePreview();\n        }\n      }\n    }\n\n    // Either way, clear out old state.\n    this.markerConnection = null;\n    this.activeCandidate = null;\n  }\n\n  /**\n   * A preview should be hidden. Loop through all possible preview modes\n   * and hide everything.\n   */\n  private hidePreview() {\n    const closest = this.activeCandidate?.closest;\n    if (\n      closest &&\n      closest.targetBlock() &&\n      this.workspace.getRenderer().shouldHighlightConnection(closest)\n    ) {\n      closest.unhighlight();\n    }\n    this.hideReplacementFade();\n    this.hideInsertionInputOutline();\n    this.hideInsertionMarker();\n  }\n\n  /**\n   * Shows an insertion marker connected to the appropriate blocks (based on\n   * manager state).\n   *\n   * @param activeCandidate The connection that will be made if the drag ends\n   *     immediately.\n   */\n  private showInsertionMarker(activeCandidate: CandidateConnection) {\n    const {local, closest} = activeCandidate;\n\n    const isLastInStack = this.lastOnStack && local === this.lastOnStack;\n    let insertionMarker = isLastInStack ? this.lastMarker : this.firstMarker;\n    if (!insertionMarker) {\n      throw new Error(\n        'Cannot show the insertion marker because there is no insertion ' +\n          'marker block',\n      );\n    }\n    let imConn;\n    try {\n      imConn = insertionMarker.getMatchingConnection(\n        local.getSourceBlock(),\n        local,\n      );\n    } catch (e) {\n      // It's possible that the number of connections on the local block has\n      // changed since the insertion marker was originally created.  Let's\n      // recreate the insertion marker and try again. In theory we could\n      // probably recreate the marker block (e.g. in getCandidate_), which is\n      // called more often during the drag, but creating a block that often\n      // might be too slow, so we only do it if necessary.\n      if (isLastInStack && this.lastOnStack) {\n        this.disposeInsertionMarker(this.lastMarker);\n        this.lastMarker = this.createMarkerBlock(\n          this.lastOnStack.getSourceBlock(),\n        );\n        insertionMarker = this.lastMarker;\n      } else {\n        this.disposeInsertionMarker(this.firstMarker);\n        this.firstMarker = this.createMarkerBlock(this.topBlock);\n        insertionMarker = this.firstMarker;\n      }\n\n      if (!insertionMarker) {\n        throw new Error(\n          'Cannot show the insertion marker because there is no insertion ' +\n            'marker block',\n        );\n      }\n      imConn = insertionMarker.getMatchingConnection(\n        local.getSourceBlock(),\n        local,\n      );\n    }\n\n    if (!imConn) {\n      throw new Error(\n        'Cannot show the insertion marker because there is no ' +\n          'associated connection',\n      );\n    }\n\n    if (imConn === this.markerConnection) {\n      throw new Error(\n        \"Made it to showInsertionMarker_ even though the marker isn't \" +\n          'changing',\n      );\n    }\n\n    // Render disconnected from everything else so that we have a valid\n    // connection location.\n    insertionMarker.queueRender();\n    renderManagement.triggerQueuedRenders();\n\n    // Connect() also renders the insertion marker.\n    imConn.connect(closest);\n\n    const originalOffsetToTarget = {\n      x: closest.x - imConn.x,\n      y: closest.y - imConn.y,\n    };\n    const originalOffsetInBlock = imConn.getOffsetInBlock().clone();\n    const imConnConst = imConn;\n    renderManagement.finishQueuedRenders().then(() => {\n      // Position so that the existing block doesn't move.\n      insertionMarker?.positionNearConnection(\n        imConnConst,\n        originalOffsetToTarget,\n        originalOffsetInBlock,\n      );\n      insertionMarker?.getSvgRoot().setAttribute('visibility', 'visible');\n    });\n\n    this.markerConnection = imConn;\n  }\n\n  /**\n   * Disconnects and hides the current insertion marker. Should return the\n   * blocks to their original state.\n   */\n  private hideInsertionMarker() {\n    if (!this.markerConnection) return;\n\n    const markerConn = this.markerConnection;\n    const imBlock = markerConn.getSourceBlock();\n    const markerPrev = imBlock.previousConnection;\n    const markerOutput = imBlock.outputConnection;\n\n    if (!markerPrev?.targetConnection && !markerOutput?.targetConnection) {\n      // If we are the top block, unplugging doesn't do anything.\n      // The marker connection may not have a target block if we are hiding\n      // as part of applying connections.\n      markerConn.targetBlock()?.unplug(false);\n    } else {\n      imBlock.unplug(true);\n    }\n\n    if (markerConn.targetConnection) {\n      throw Error(\n        'markerConnection still connected at the end of ' +\n          'disconnectInsertionMarker',\n      );\n    }\n\n    this.markerConnection = null;\n    const svg = imBlock.getSvgRoot();\n    if (svg) {\n      svg.setAttribute('visibility', 'hidden');\n    }\n  }\n\n  /**\n   * Shows an outline around the input the closest connection belongs to.\n   *\n   * @param activeCandidate The connection that will be made if the drag ends\n   *     immediately.\n   */\n  private showInsertionInputOutline(activeCandidate: CandidateConnection) {\n    const closest = activeCandidate.closest;\n    this.highlightedBlock = closest.getSourceBlock();\n    this.highlightedBlock.highlightShapeForInput(closest, true);\n  }\n\n  /** Hides any visible input outlines. */\n  private hideInsertionInputOutline() {\n    if (!this.highlightedBlock) return;\n\n    if (!this.activeCandidate) {\n      throw new Error(\n        'Cannot hide the insertion marker outline because ' +\n          'there is no active candidate',\n      );\n    }\n    this.highlightedBlock.highlightShapeForInput(\n      this.activeCandidate.closest,\n      false,\n    );\n    this.highlightedBlock = null;\n  }\n\n  /**\n   * Shows a replacement fade affect on the closest connection's target block\n   * (the block that is currently connected to it).\n   *\n   * @param activeCandidate The connection that will be made if the drag ends\n   *     immediately.\n   */\n  private showReplacementFade(activeCandidate: CandidateConnection) {\n    this.fadedBlock = activeCandidate.closest.targetBlock();\n    if (!this.fadedBlock) {\n      throw new Error(\n        'Cannot show the replacement fade because the ' +\n          'closest connection does not have a target block',\n      );\n    }\n    this.fadedBlock.fadeForReplacement(true);\n  }\n\n  /**\n   * Hides/Removes any visible fade affects.\n   */\n  private hideReplacementFade() {\n    if (!this.fadedBlock) return;\n\n    this.fadedBlock.fadeForReplacement(false);\n    this.fadedBlock = null;\n  }\n\n  /**\n   * Get a list of the insertion markers that currently exist.  Drags have 0, 1,\n   * or 2 insertion markers.\n   *\n   * @returns A possibly empty list of insertion marker blocks.\n   * @internal\n   */\n  getInsertionMarkers(): BlockSvg[] {\n    const result = [];\n    if (this.firstMarker) {\n      result.push(this.firstMarker);\n    }\n    if (this.lastMarker) {\n      result.push(this.lastMarker);\n    }\n    return result;\n  }\n\n  /**\n   * Safely disposes of an insertion marker.\n   */\n  private disposeInsertionMarker(marker: BlockSvg | null) {\n    if (marker) {\n      eventUtils.disable();\n      try {\n        marker.dispose();\n      } finally {\n        eventUtils.enable();\n      }\n    }\n  }\n}\n\nexport namespace InsertionMarkerManager {\n  /**\n   * An enum describing different kinds of previews the InsertionMarkerManager\n   * could display.\n   */\n  export enum PREVIEW_TYPE {\n    INSERTION_MARKER = 0,\n    INPUT_OUTLINE = 1,\n    REPLACEMENT_FADE = 2,\n  }\n}\n\nexport type PreviewType = InsertionMarkerManager.PREVIEW_TYPE;\nexport const PreviewType = InsertionMarkerManager.PREVIEW_TYPE;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.Renderer\n\nimport type {Block} from '../../block.js';\nimport type {BlockSvg} from '../../block_svg.js';\nimport {Connection} from '../../connection.js';\nimport {ConnectionType} from '../../connection_type.js';\nimport {\n  InsertionMarkerManager,\n  PreviewType,\n} from '../../insertion_marker_manager.js';\nimport type {IRegistrable} from '../../interfaces/i_registrable.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {BlockStyle, Theme} from '../../theme.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport type {IPathObject} from './i_path_object.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {PathObject} from './path_object.js';\nimport * as deprecation from '../../utils/deprecation.js';\n\n/**\n * The base class for a block renderer.\n */\nexport class Renderer implements IRegistrable {\n  /** The renderer's constant provider. */\n  protected constants_!: ConstantProvider;\n\n  protected name: string;\n\n  /**\n   * Rendering constant overrides, passed in through options.\n   */\n  protected overrides: object | null = null;\n\n  /**\n   * @param name The renderer name.\n   */\n  constructor(name: string) {\n    this.name = name;\n  }\n\n  /**\n   * Gets the class name that identifies this renderer.\n   *\n   * @returns The CSS class name.\n   */\n  getClassName(): string {\n    return this.name + '-renderer';\n  }\n\n  /**\n   * Initialize the renderer.\n   *\n   * @param theme The workspace theme object.\n   * @param opt_rendererOverrides Rendering constant overrides.\n   */\n  init(\n    theme: Theme,\n    opt_rendererOverrides?: {[rendererConstant: string]: any},\n  ) {\n    this.constants_ = this.makeConstants_();\n    if (opt_rendererOverrides) {\n      this.overrides = opt_rendererOverrides;\n      Object.assign(this.constants_, opt_rendererOverrides);\n    }\n    this.constants_.setTheme(theme);\n    this.constants_.init();\n  }\n\n  /**\n   * Create any DOM elements that this renderer needs.\n   * If you need to create additional DOM elements, override the\n   * {@link ConstantProvider#createDom} method instead.\n   *\n   * @param svg The root of the workspace's SVG.\n   * @param theme The workspace theme object.\n   * @internal\n   */\n  createDom(svg: SVGElement, theme: Theme) {\n    this.constants_.createDom(\n      svg,\n      this.name + '-' + theme.name,\n      '.' + this.getClassName() + '.' + theme.getClassName(),\n    );\n  }\n\n  /**\n   * Refresh the renderer after a theme change.\n   *\n   * @param svg The root of the workspace's SVG.\n   * @param theme The workspace theme object.\n   */\n  refreshDom(svg: SVGElement, theme: Theme) {\n    const previousConstants = this.getConstants();\n    previousConstants.dispose();\n    this.constants_ = this.makeConstants_();\n    if (this.overrides) {\n      Object.assign(this.constants_, this.overrides);\n    }\n    // Ensure the constant provider's random identifier does not change.\n    this.constants_.randomIdentifier = previousConstants.randomIdentifier;\n    this.constants_.setTheme(theme);\n    this.constants_.init();\n    this.createDom(svg, theme);\n  }\n\n  /**\n   * Dispose of this renderer.\n   * Delete all DOM elements that this renderer and its constants created.\n   */\n  dispose() {\n    if (this.constants_) {\n      this.constants_.dispose();\n    }\n  }\n\n  /**\n   * Create a new instance of the renderer's constant provider.\n   *\n   * @returns The constant provider.\n   */\n  protected makeConstants_(): ConstantProvider {\n    return new ConstantProvider();\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n\n  /**\n   * Create a new instance of the renderer's drawer.\n   *\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @returns The drawer.\n   */\n  protected makeDrawer_(block: BlockSvg, info: RenderInfo): Drawer {\n    return new Drawer(block, info);\n  }\n\n  /**\n   * Create a new instance of the renderer's marker drawer.\n   *\n   * @param workspace The workspace the marker belongs to.\n   * @param marker The marker.\n   * @returns The object in charge of drawing the marker.\n   */\n  makeMarkerDrawer(workspace: WorkspaceSvg, marker: Marker): MarkerSvg {\n    return new MarkerSvg(workspace, this.getConstants(), marker);\n  }\n\n  /**\n   * Create a new instance of a renderer path object.\n   *\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @returns The renderer path object.\n   */\n  makePathObject(root: SVGElement, style: BlockStyle): IPathObject {\n    return new PathObject(root, style, this.constants_);\n  }\n\n  /**\n   * Get the current renderer's constant provider.  We assume that when this is\n   * called, the renderer has already been initialized.\n   *\n   * @returns The constant provider.\n   */\n  getConstants(): ConstantProvider {\n    return this.constants_;\n  }\n\n  /**\n   * Determine whether or not to highlight a connection.\n   *\n   * @param _conn The connection to determine whether or not to highlight.\n   * @returns True if we should highlight the connection.\n   */\n  shouldHighlightConnection(_conn: Connection): boolean {\n    return true;\n  }\n\n  /**\n   * Checks if an orphaned block can connect to the \"end\" of the topBlock's\n   * block-clump. If the clump is a row the end is the last input. If the clump\n   * is a stack, the end is the last next connection. If the clump is neither,\n   * then this returns false.\n   *\n   * @param topBlock The top block of the block clump we want to try and connect\n   *     to.\n   * @param orphanBlock The orphan block that wants to find a home.\n   * @param localType The type of the connection being dragged.\n   * @returns Whether there is a home for the orphan or not.\n   */\n  protected orphanCanConnectAtEnd(\n    topBlock: BlockSvg,\n    orphanBlock: BlockSvg,\n    localType: number,\n  ): boolean {\n    const orphanConnection =\n      localType === ConnectionType.OUTPUT_VALUE\n        ? orphanBlock.outputConnection\n        : orphanBlock.previousConnection;\n    return !!Connection.getConnectionForOrphanedConnection(\n      topBlock as Block,\n      orphanConnection as Connection,\n    );\n  }\n\n  /**\n   * Chooses a connection preview method based on the available connection, the\n   * current dragged connection, and the block being dragged.\n   *\n   * @param closest The available connection.\n   * @param local The connection currently being dragged.\n   * @param topBlock The block currently being dragged.\n   * @returns The preview type to display.\n   *\n   * @deprecated v10 - This function is no longer respected. A custom\n   *    IConnectionPreviewer may be able to fulfill the functionality.\n   */\n  getConnectionPreviewMethod(\n    closest: RenderedConnection,\n    local: RenderedConnection,\n    topBlock: BlockSvg,\n  ): PreviewType {\n    deprecation.warn(\n      'getConnectionPreviewMethod',\n      'v10',\n      'v12',\n      'an IConnectionPreviewer, if it fulfills your use case.',\n    );\n    if (\n      local.type === ConnectionType.OUTPUT_VALUE ||\n      local.type === ConnectionType.PREVIOUS_STATEMENT\n    ) {\n      if (\n        !closest.isConnected() ||\n        this.orphanCanConnectAtEnd(\n          topBlock,\n          closest.targetBlock() as BlockSvg,\n          local.type,\n        )\n      ) {\n        return InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER;\n      }\n      return InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE;\n    }\n\n    return InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER;\n  }\n\n  /**\n   * Render the block.\n   *\n   * @param block The block to render.\n   * @internal\n   */\n  render(block: BlockSvg) {\n    const info = this.makeRenderInfo_(block);\n    info.measure();\n    this.makeDrawer_(block, info).draw();\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object in charge of storing and updating a workspace theme\n *     and UI components.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ThemeManager\n\nimport type {Theme} from './theme.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as dom from './utils/dom.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for storing and updating a workspace's theme and UI components.\n */\nexport class ThemeManager {\n  /** A list of workspaces that are subscribed to this theme. */\n  private subscribedWorkspaces_: Workspace[] = [];\n  private componentDB = new Map<string, Component[]>();\n\n  /**\n   * @param workspace The main workspace.\n   * @param theme The workspace theme.\n   * @internal\n   */\n  constructor(\n    private readonly workspace: WorkspaceSvg,\n    private theme: Theme,\n  ) {}\n\n  /**\n   * Get the workspace theme.\n   *\n   * @returns The workspace theme.\n   * @internal\n   */\n  getTheme(): Theme {\n    return this.theme;\n  }\n\n  /**\n   * Set the workspace theme, and refresh the workspace and all components.\n   *\n   * @param theme The workspace theme.\n   * @internal\n   */\n  setTheme(theme: Theme) {\n    const prevTheme = this.theme;\n    this.theme = theme;\n    // Set the theme name onto the injection div.\n    const injectionDiv = this.workspace.getInjectionDiv();\n    if (injectionDiv) {\n      if (prevTheme) {\n        const oldClassName = prevTheme.getClassName();\n        if (oldClassName) {\n          dom.removeClass(injectionDiv, oldClassName);\n        }\n      }\n      const newClassName = this.theme.getClassName();\n      if (newClassName) {\n        dom.addClass(injectionDiv, newClassName);\n      }\n    }\n\n    // Refresh all subscribed workspaces.\n    for (\n      let i = 0, workspace;\n      (workspace = this.subscribedWorkspaces_[i]);\n      i++\n    ) {\n      (workspace as WorkspaceSvg).refreshTheme();\n    }\n\n    // Refresh all registered Blockly UI components.\n    for (const [key, componentList] of this.componentDB) {\n      for (const component of componentList) {\n        const element = component.element;\n        const propertyName = component.propertyName;\n        const style = this.theme && this.theme.getComponentStyle(key);\n        element.style.setProperty(propertyName, style || '');\n      }\n    }\n\n    for (const workspace of this.subscribedWorkspaces_) {\n      (workspace as WorkspaceSvg).hideChaff();\n    }\n  }\n\n  /**\n   * Subscribe a workspace to changes to the selected theme.  If a new theme is\n   * set, the workspace is called to refresh its blocks.\n   *\n   * @param workspace The workspace to subscribe.\n   * @internal\n   */\n  subscribeWorkspace(workspace: Workspace) {\n    this.subscribedWorkspaces_.push(workspace);\n  }\n\n  /**\n   * Unsubscribe a workspace to changes to the selected theme.\n   *\n   * @param workspace The workspace to unsubscribe.\n   * @internal\n   */\n  unsubscribeWorkspace(workspace: Workspace) {\n    if (!arrayUtils.removeElem(this.subscribedWorkspaces_, workspace)) {\n      throw Error(\n        \"Cannot unsubscribe a workspace that hasn't been subscribed.\",\n      );\n    }\n  }\n\n  /**\n   * Subscribe an element to changes to the selected theme.  If a new theme is\n   * selected, the element's style is refreshed with the new theme's style.\n   *\n   * @param element The element to subscribe.\n   * @param componentName The name used to identify the component. This must be\n   *     the same name used to configure the style in the Theme object.\n   * @param propertyName The inline style property name to update.\n   * @internal\n   */\n  subscribe(\n    element: HTMLElement | SVGElement,\n    componentName: string,\n    propertyName: string,\n  ) {\n    if (!this.componentDB.has(componentName)) {\n      this.componentDB.set(componentName, []);\n    }\n\n    // Add the element to our component map.\n    this.componentDB.get(componentName)!.push({element, propertyName});\n\n    // Initialize the element with its corresponding theme style.\n    const style = this.theme && this.theme.getComponentStyle(componentName);\n    element.style.setProperty(propertyName, style || '');\n  }\n\n  /**\n   * Unsubscribe an element to changes to the selected theme.\n   *\n   * @param element The element to unsubscribe.\n   * @internal\n   */\n  unsubscribe(element: HTMLElement | SVGElement) {\n    if (!element) {\n      return;\n    }\n    // Go through all component, and remove any references to this element.\n    for (const [componentName, elements] of this.componentDB) {\n      for (let i = elements.length - 1; i >= 0; i--) {\n        if (elements[i].element === element) {\n          elements.splice(i, 1);\n        }\n      }\n      // Clean up the component map entry if the list is empty.\n      if (!elements.length) {\n        this.componentDB.delete(componentName);\n      }\n    }\n  }\n\n  /**\n   * Dispose of this theme manager.\n   *\n   * @internal\n   */\n  dispose() {\n    this.subscribedWorkspaces_.length = 0;\n    this.componentDB.clear();\n  }\n}\n\nexport namespace ThemeManager {\n  /** The type for a Blockly UI Component. */\n  export interface Component {\n    element: HTMLElement | SVGElement;\n    propertyName: string;\n  }\n}\n\nexport type Component = ThemeManager.Component;\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.internalConstants\n\nimport {ConnectionType} from './connection_type.js';\n\n/**\n * Number of characters to truncate a collapsed block to.\n *\n * @internal\n */\nexport const COLLAPSE_CHARS = 30;\n\n/**\n * Lookup table for determining the opposite type of a connection.\n *\n * @internal\n */\nexport const OPPOSITE_TYPE: number[] = [];\nOPPOSITE_TYPE[ConnectionType.INPUT_VALUE] = ConnectionType.OUTPUT_VALUE;\nOPPOSITE_TYPE[ConnectionType.OUTPUT_VALUE] = ConnectionType.INPUT_VALUE;\nOPPOSITE_TYPE[ConnectionType.NEXT_STATEMENT] =\n  ConnectionType.PREVIOUS_STATEMENT;\nOPPOSITE_TYPE[ConnectionType.PREVIOUS_STATEMENT] =\n  ConnectionType.NEXT_STATEMENT;\n\n/**\n * String for use in the dropdown created in field_variable.\n * This string indicates that this option in the dropdown is 'Rename\n * variable...' and if selected, should trigger the prompt to rename a variable.\n *\n * @internal\n */\nexport const RENAME_VARIABLE_ID = 'RENAME_VARIABLE_ID';\n\n/**\n * String for use in the dropdown created in field_variable.\n * This string indicates that this option in the dropdown is 'Delete the \"%1\"\n * variable' and if selected, should trigger the prompt to delete a variable.\n *\n * @internal\n */\nexport const DELETE_VARIABLE_ID = 'DELETE_VARIABLE_ID';\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object that encapsulates logic for checking whether a\n * potential connection is safe and valid.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ConnectionChecker\n\nimport * as common from './common.js';\nimport {Connection} from './connection.js';\nimport {ConnectionType} from './connection_type.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport * as internalConstants from './internal_constants.js';\nimport * as registry from './registry.js';\nimport type {RenderedConnection} from './rendered_connection.js';\n\n/**\n * Class for connection type checking logic.\n */\nexport class ConnectionChecker implements IConnectionChecker {\n  /**\n   * Check whether the current connection can connect with the target\n   * connection.\n   *\n   * @param a Connection to check compatibility with.\n   * @param b Connection to check compatibility with.\n   * @param isDragging True if the connection is being made by dragging a block.\n   * @param opt_distance The max allowable distance between the connections for\n   *     drag checks.\n   * @returns Whether the connection is legal.\n   */\n  canConnect(\n    a: Connection | null,\n    b: Connection | null,\n    isDragging: boolean,\n    opt_distance?: number,\n  ): boolean {\n    return (\n      this.canConnectWithReason(a, b, isDragging, opt_distance) ===\n      Connection.CAN_CONNECT\n    );\n  }\n\n  /**\n   * Checks whether the current connection can connect with the target\n   * connection, and return an error code if there are problems.\n   *\n   * @param a Connection to check compatibility with.\n   * @param b Connection to check compatibility with.\n   * @param isDragging True if the connection is being made by dragging a block.\n   * @param opt_distance The max allowable distance between the connections for\n   *     drag checks.\n   * @returns Connection.CAN_CONNECT if the connection is legal, an error code\n   *     otherwise.\n   */\n  canConnectWithReason(\n    a: Connection | null,\n    b: Connection | null,\n    isDragging: boolean,\n    opt_distance?: number,\n  ): number {\n    const safety = this.doSafetyChecks(a, b);\n    if (safety !== Connection.CAN_CONNECT) {\n      return safety;\n    }\n\n    // If the safety checks passed, both connections are non-null.\n    const connOne = a!;\n    const connTwo = b!;\n    if (!this.doTypeChecks(connOne, connTwo)) {\n      return Connection.REASON_CHECKS_FAILED;\n    }\n\n    if (\n      isDragging &&\n      !this.doDragChecks(\n        a as RenderedConnection,\n        b as RenderedConnection,\n        opt_distance || 0,\n      )\n    ) {\n      return Connection.REASON_DRAG_CHECKS_FAILED;\n    }\n\n    return Connection.CAN_CONNECT;\n  }\n\n  /**\n   * Helper method that translates a connection error code into a string.\n   *\n   * @param errorCode The error code.\n   * @param a One of the two connections being checked.\n   * @param b The second of the two connections being checked.\n   * @returns A developer-readable error string.\n   */\n  getErrorMessage(\n    errorCode: number,\n    a: Connection | null,\n    b: Connection | null,\n  ): string {\n    switch (errorCode) {\n      case Connection.REASON_SELF_CONNECTION:\n        return 'Attempted to connect a block to itself.';\n      case Connection.REASON_DIFFERENT_WORKSPACES:\n        // Usually this means one block has been deleted.\n        return 'Blocks not on same workspace.';\n      case Connection.REASON_WRONG_TYPE:\n        return 'Attempt to connect incompatible types.';\n      case Connection.REASON_TARGET_NULL:\n        return 'Target connection is null.';\n      case Connection.REASON_CHECKS_FAILED: {\n        const connOne = a!;\n        const connTwo = b!;\n        let msg = 'Connection checks failed. ';\n        msg +=\n          connOne +\n          ' expected ' +\n          connOne.getCheck() +\n          ', found ' +\n          connTwo.getCheck();\n        return msg;\n      }\n      case Connection.REASON_SHADOW_PARENT:\n        return 'Connecting non-shadow to shadow block.';\n      case Connection.REASON_DRAG_CHECKS_FAILED:\n        return 'Drag checks failed.';\n      case Connection.REASON_PREVIOUS_AND_OUTPUT:\n        return 'Block would have an output and a previous connection.';\n      default:\n        return 'Unknown connection failure: this should never happen!';\n    }\n  }\n\n  /**\n   * Check that connecting the given connections is safe, meaning that it would\n   * not break any of Blockly's basic assumptions (e.g. no self connections).\n   *\n   * @param a The first of the connections to check.\n   * @param b The second of the connections to check.\n   * @returns An enum with the reason this connection is safe or unsafe.\n   */\n  doSafetyChecks(a: Connection | null, b: Connection | null): number {\n    if (!a || !b) {\n      return Connection.REASON_TARGET_NULL;\n    }\n    let superiorBlock;\n    let inferiorBlock;\n    let superiorConnection;\n    let inferiorConnection;\n    if (a.isSuperior()) {\n      superiorBlock = a.getSourceBlock();\n      inferiorBlock = b.getSourceBlock();\n      superiorConnection = a;\n      inferiorConnection = b;\n    } else {\n      inferiorBlock = a.getSourceBlock();\n      superiorBlock = b.getSourceBlock();\n      inferiorConnection = a;\n      superiorConnection = b;\n    }\n    if (superiorBlock === inferiorBlock) {\n      return Connection.REASON_SELF_CONNECTION;\n    } else if (\n      inferiorConnection.type !==\n      internalConstants.OPPOSITE_TYPE[superiorConnection.type]\n    ) {\n      return Connection.REASON_WRONG_TYPE;\n    } else if (superiorBlock.workspace !== inferiorBlock.workspace) {\n      return Connection.REASON_DIFFERENT_WORKSPACES;\n    } else if (superiorBlock.isShadow() && !inferiorBlock.isShadow()) {\n      return Connection.REASON_SHADOW_PARENT;\n    } else if (\n      inferiorConnection.type === ConnectionType.OUTPUT_VALUE &&\n      inferiorBlock.previousConnection &&\n      inferiorBlock.previousConnection.isConnected()\n    ) {\n      return Connection.REASON_PREVIOUS_AND_OUTPUT;\n    } else if (\n      inferiorConnection.type === ConnectionType.PREVIOUS_STATEMENT &&\n      inferiorBlock.outputConnection &&\n      inferiorBlock.outputConnection.isConnected()\n    ) {\n      return Connection.REASON_PREVIOUS_AND_OUTPUT;\n    }\n    return Connection.CAN_CONNECT;\n  }\n\n  /**\n   * Check whether this connection is compatible with another connection with\n   * respect to the value type system.  E.g. square_root(\"Hello\") is not\n   * compatible.\n   *\n   * @param a Connection to compare.\n   * @param b Connection to compare against.\n   * @returns True if the connections share a type.\n   */\n  doTypeChecks(a: Connection, b: Connection): boolean {\n    const checkArrayOne = a.getCheck();\n    const checkArrayTwo = b.getCheck();\n\n    if (!checkArrayOne || !checkArrayTwo) {\n      // One or both sides are promiscuous enough that anything will fit.\n      return true;\n    }\n    // Find any intersection in the check lists.\n    for (let i = 0; i < checkArrayOne.length; i++) {\n      if (checkArrayTwo.includes(checkArrayOne[i])) {\n        return true;\n      }\n    }\n    // No intersection.\n    return false;\n  }\n\n  /**\n   * Check whether this connection can be made by dragging.\n   *\n   * @param a Connection to compare (on the block that's being dragged).\n   * @param b Connection to compare against.\n   * @param distance The maximum allowable distance between connections.\n   * @returns True if the connection is allowed during a drag.\n   */\n  doDragChecks(\n    a: RenderedConnection,\n    b: RenderedConnection,\n    distance: number,\n  ): boolean {\n    if (a.distanceFrom(b) > distance) {\n      return false;\n    }\n\n    // Don't consider insertion markers.\n    if (b.getSourceBlock().isInsertionMarker()) {\n      return false;\n    }\n\n    switch (b.type) {\n      case ConnectionType.PREVIOUS_STATEMENT:\n        return this.canConnectToPrevious_(a, b);\n      case ConnectionType.OUTPUT_VALUE: {\n        // Don't offer to connect an already connected left (male) value plug to\n        // an available right (female) value plug.\n        if (\n          (b.isConnected() && !b.targetBlock()!.isInsertionMarker()) ||\n          a.isConnected()\n        ) {\n          return false;\n        }\n        break;\n      }\n      case ConnectionType.INPUT_VALUE: {\n        // Offering to connect the left (male) of a value block to an already\n        // connected value pair is ok, we'll splice it in.\n        // However, don't offer to splice into an immovable block.\n        if (\n          b.isConnected() &&\n          !b.targetBlock()!.isMovable() &&\n          !b.targetBlock()!.isShadow()\n        ) {\n          return false;\n        }\n        break;\n      }\n      case ConnectionType.NEXT_STATEMENT: {\n        // Don't let a block with no next connection bump other blocks out of\n        // the stack.  But covering up a shadow block or stack of shadow blocks\n        // is fine.  Similarly, replacing a terminal statement with another\n        // terminal statement is allowed.\n        if (\n          b.isConnected() &&\n          !a.getSourceBlock().nextConnection &&\n          !b.targetBlock()!.isShadow() &&\n          b.targetBlock()!.nextConnection\n        ) {\n          return false;\n        }\n\n        // Don't offer to splice into a stack where the connected block is\n        // immovable, unless the block is a shadow block.\n        if (\n          b.targetBlock() &&\n          !b.targetBlock()!.isMovable() &&\n          !b.targetBlock()!.isShadow()\n        ) {\n          return false;\n        }\n        break;\n      }\n      default:\n        // Unexpected connection type.\n        return false;\n    }\n\n    // Don't let blocks try to connect to themselves or ones they nest.\n    if (common.draggingConnections.includes(b)) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Helper function for drag checking.\n   *\n   * @param a The connection to check, which must be a statement input or next\n   *     connection.\n   * @param b A nearby connection to check, which must be a previous connection.\n   * @returns True if the connection is allowed, false otherwise.\n   */\n  protected canConnectToPrevious_(a: Connection, b: Connection): boolean {\n    if (a.targetConnection) {\n      // This connection is already occupied.\n      // A next connection will never disconnect itself mid-drag.\n      return false;\n    }\n\n    // Don't let blocks try to connect to themselves or ones they nest.\n    if (common.draggingConnections.includes(b)) {\n      return false;\n    }\n\n    if (!b.targetConnection) {\n      return true;\n    }\n\n    const targetBlock = b.targetBlock();\n    // If it is connected to a real block, game over.\n    if (!targetBlock!.isInsertionMarker()) {\n      return false;\n    }\n    // If it's connected to an insertion marker but that insertion marker\n    // is the first block in a stack, it's still fine.  If that insertion\n    // marker is in the middle of a stack, it won't work.\n    return !targetBlock!.getPreviousBlock();\n  }\n}\n\nregistry.register(\n  registry.Type.CONNECTION_CHECKER,\n  registry.DEFAULT,\n  ConnectionChecker,\n);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Events.VarDelete\n\nimport * as registry from '../registry.js';\nimport type {VariableModel} from '../variable_model.js';\n\nimport {VarBase, VarBaseJson} from './events_var_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a variable model has been deleted.\n *\n * @class\n */\nexport class VarDelete extends VarBase {\n  override type = eventUtils.VAR_DELETE;\n  /** The type of the variable that was deleted. */\n  varType?: string;\n  /** The name of the variable that was deleted. */\n  varName?: string;\n\n  /**\n   * @param opt_variable The deleted variable. Undefined for a blank event.\n   */\n  constructor(opt_variable?: VariableModel) {\n    super(opt_variable);\n\n    if (!opt_variable) {\n      return; // Blank event to be populated by fromJson.\n    }\n    this.varType = opt_variable.type;\n    this.varName = opt_variable.name;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): VarDeleteJson {\n    const json = super.toJson() as VarDeleteJson;\n    if (this.varType === undefined) {\n      throw new Error(\n        'The var type is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.varName) {\n      throw new Error(\n        'The var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['varType'] = this.varType;\n    json['varName'] = this.varName;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of VarDelete, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: VarDeleteJson,\n    workspace: Workspace,\n    event?: any,\n  ): VarDelete {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new VarDelete(),\n    ) as VarDelete;\n    newEvent.varType = json['varType'];\n    newEvent.varName = json['varName'];\n    return newEvent;\n  }\n\n  /**\n   * Run a variable deletion event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.varId) {\n      throw new Error(\n        'The var ID is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.varName) {\n      throw new Error(\n        'The var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (forward) {\n      workspace.deleteVariableById(this.varId);\n    } else {\n      workspace.createVariable(this.varName, this.varType, this.varId);\n    }\n  }\n}\n\nexport interface VarDeleteJson extends VarBaseJson {\n  varType: string;\n  varName: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.VAR_DELETE, VarDelete);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Events.VarRename\n\nimport * as registry from '../registry.js';\nimport type {VariableModel} from '../variable_model.js';\n\nimport {VarBase, VarBaseJson} from './events_var_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a variable model was renamed.\n *\n * @class\n */\nexport class VarRename extends VarBase {\n  override type = eventUtils.VAR_RENAME;\n\n  /** The previous name of the variable. */\n  oldName?: string;\n\n  /** The new name of the variable. */\n  newName?: string;\n\n  /**\n   * @param opt_variable The renamed variable. Undefined for a blank event.\n   * @param newName The new name the variable will be changed to.\n   */\n  constructor(opt_variable?: VariableModel, newName?: string) {\n    super(opt_variable);\n\n    if (!opt_variable) {\n      return; // Blank event to be populated by fromJson.\n    }\n    this.oldName = opt_variable.name;\n    this.newName = typeof newName === 'undefined' ? '' : newName;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): VarRenameJson {\n    const json = super.toJson() as VarRenameJson;\n    if (!this.oldName) {\n      throw new Error(\n        'The old var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.newName) {\n      throw new Error(\n        'The new var name is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['oldName'] = this.oldName;\n    json['newName'] = this.newName;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of VarRename, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: VarRenameJson,\n    workspace: Workspace,\n    event?: any,\n  ): VarRename {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new VarRename(),\n    ) as VarRename;\n    newEvent.oldName = json['oldName'];\n    newEvent.newName = json['newName'];\n    return newEvent;\n  }\n\n  /**\n   * Run a variable rename event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.varId) {\n      throw new Error(\n        'The var ID is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.oldName) {\n      throw new Error(\n        'The old var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.newName) {\n      throw new Error(\n        'The new var name is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (forward) {\n      workspace.renameVariableById(this.varId, this.newName);\n    } else {\n      workspace.renameVariableById(this.varId, this.oldName);\n    }\n  }\n}\n\nexport interface VarRenameJson extends VarBaseJson {\n  oldName: string;\n  newName: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.VAR_RENAME, VarRename);\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a map of variables and their types.\n *\n * @class\n */\n// Former goog.module ID: Blockly.VariableMap\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_delete.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_rename.js';\n\nimport type {Block} from './block.js';\nimport * as dialog from './dialog.js';\nimport * as eventUtils from './events/utils.js';\nimport {Msg} from './msg.js';\nimport {Names} from './names.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport {VariableModel} from './variable_model.js';\nimport type {Workspace} from './workspace.js';\n\n/**\n * Class for a variable map.  This contains a dictionary data structure with\n * variable types as keys and lists of variables as values.  The list of\n * variables are the type indicated by the key.\n */\nexport class VariableMap {\n  /**\n   * A map from variable type to list of variable names.  The lists contain\n   * all of the named variables in the workspace, including variables that are\n   * not currently in use.\n   */\n  private variableMap = new Map<string, VariableModel[]>();\n\n  /** @param workspace The workspace this map belongs to. */\n  constructor(public workspace: Workspace) {}\n\n  /** Clear the variable map.  Fires events for every deletion. */\n  clear() {\n    for (const variables of this.variableMap.values()) {\n      while (variables.length > 0) {\n        this.deleteVariable(variables[0]);\n      }\n    }\n    if (this.variableMap.size !== 0) {\n      throw Error('Non-empty variable map');\n    }\n  }\n\n  /* Begin functions for renaming variables. */\n  /**\n   * Rename the given variable by updating its name in the variable map.\n   *\n   * @param variable Variable to rename.\n   * @param newName New variable name.\n   * @internal\n   */\n  renameVariable(variable: VariableModel, newName: string) {\n    if (variable.name === newName) return;\n    const type = variable.type;\n    const conflictVar = this.getVariable(newName, type);\n    const blocks = this.workspace.getAllBlocks(false);\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n    try {\n      // The IDs may match if the rename is a simple case change (name1 ->\n      // Name1).\n      if (!conflictVar || conflictVar.getId() === variable.getId()) {\n        this.renameVariableAndUses_(variable, newName, blocks);\n      } else {\n        this.renameVariableWithConflict_(\n          variable,\n          newName,\n          conflictVar,\n          blocks,\n        );\n      }\n    } finally {\n      eventUtils.setGroup(existingGroup);\n    }\n  }\n\n  /**\n   * Rename a variable by updating its name in the variable map. Identify the\n   * variable to rename with the given ID.\n   *\n   * @param id ID of the variable to rename.\n   * @param newName New variable name.\n   */\n  renameVariableById(id: string, newName: string) {\n    const variable = this.getVariableById(id);\n    if (!variable) {\n      throw Error(\"Tried to rename a variable that didn't exist. ID: \" + id);\n    }\n\n    this.renameVariable(variable, newName);\n  }\n\n  /**\n   * Update the name of the given variable and refresh all references to it.\n   * The new name must not conflict with any existing variable names.\n   *\n   * @param variable Variable to rename.\n   * @param newName New variable name.\n   * @param blocks The list of all blocks in the workspace.\n   */\n  private renameVariableAndUses_(\n    variable: VariableModel,\n    newName: string,\n    blocks: Block[],\n  ) {\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.VAR_RENAME))(variable, newName),\n    );\n    variable.name = newName;\n    for (let i = 0; i < blocks.length; i++) {\n      blocks[i].updateVarName(variable);\n    }\n  }\n\n  /**\n   * Update the name of the given variable to the same name as an existing\n   * variable.  The two variables are coalesced into a single variable with the\n   * ID of the existing variable that was already using newName. Refresh all\n   * references to the variable.\n   *\n   * @param variable Variable to rename.\n   * @param newName New variable name.\n   * @param conflictVar The variable that was already using newName.\n   * @param blocks The list of all blocks in the workspace.\n   */\n  private renameVariableWithConflict_(\n    variable: VariableModel,\n    newName: string,\n    conflictVar: VariableModel,\n    blocks: Block[],\n  ) {\n    const type = variable.type;\n    const oldCase = conflictVar.name;\n\n    if (newName !== oldCase) {\n      // Simple rename to change the case and update references.\n      this.renameVariableAndUses_(conflictVar, newName, blocks);\n    }\n\n    // These blocks now refer to a different variable.\n    // These will fire change events.\n    for (let i = 0; i < blocks.length; i++) {\n      blocks[i].renameVarById(variable.getId(), conflictVar.getId());\n    }\n    // Finally delete the original variable, which is now unreferenced.\n    eventUtils.fire(new (eventUtils.get(eventUtils.VAR_DELETE))(variable));\n    // And remove it from the list.\n    arrayUtils.removeElem(this.variableMap.get(type)!, variable);\n  }\n\n  /* End functions for renaming variables. */\n  /**\n   * Create a variable with a given name, optional type, and optional ID.\n   *\n   * @param name The name of the variable. This must be unique across variables\n   *     and procedures.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   * @returns The newly created variable.\n   */\n  createVariable(\n    name: string,\n    opt_type?: string | null,\n    opt_id?: string | null,\n  ): VariableModel {\n    let variable = this.getVariable(name, opt_type);\n    if (variable) {\n      if (opt_id && variable.getId() !== opt_id) {\n        throw Error(\n          'Variable \"' +\n            name +\n            '\" is already in use and its id is \"' +\n            variable.getId() +\n            '\" which conflicts with the passed in ' +\n            'id, \"' +\n            opt_id +\n            '\".',\n        );\n      }\n      // The variable already exists and has the same ID.\n      return variable;\n    }\n    if (opt_id && this.getVariableById(opt_id)) {\n      throw Error('Variable id, \"' + opt_id + '\", is already in use.');\n    }\n    const id = opt_id || idGenerator.genUid();\n    const type = opt_type || '';\n    variable = new VariableModel(this.workspace, name, type, id);\n\n    const variables = this.variableMap.get(type) || [];\n    variables.push(variable);\n    // Delete the list of variables of this type, and re-add it so that\n    // the most recent addition is at the end.\n    // This is used so the toolbox's set block is set to the most recent\n    // variable.\n    this.variableMap.delete(type);\n    this.variableMap.set(type, variables);\n\n    eventUtils.fire(new (eventUtils.get(eventUtils.VAR_CREATE))(variable));\n\n    return variable;\n  }\n\n  /* Begin functions for variable deletion. */\n  /**\n   * Delete a variable.\n   *\n   * @param variable Variable to delete.\n   */\n  deleteVariable(variable: VariableModel) {\n    const variableId = variable.getId();\n    const variableList = this.variableMap.get(variable.type);\n    if (variableList) {\n      for (let i = 0; i < variableList.length; i++) {\n        const tempVar = variableList[i];\n        if (tempVar.getId() === variableId) {\n          variableList.splice(i, 1);\n          eventUtils.fire(\n            new (eventUtils.get(eventUtils.VAR_DELETE))(variable),\n          );\n          if (variableList.length === 0) {\n            this.variableMap.delete(variable.type);\n          }\n          return;\n        }\n      }\n    }\n  }\n\n  /**\n   * Delete a variables by the passed in ID and all of its uses from this\n   * workspace. May prompt the user for confirmation.\n   *\n   * @param id ID of variable to delete.\n   */\n  deleteVariableById(id: string) {\n    const variable = this.getVariableById(id);\n    if (variable) {\n      // Check whether this variable is a function parameter before deleting.\n      const variableName = variable.name;\n      const uses = this.getVariableUsesById(id);\n      for (let i = 0, block; (block = uses[i]); i++) {\n        if (\n          block.type === 'procedures_defnoreturn' ||\n          block.type === 'procedures_defreturn'\n        ) {\n          const procedureName = String(block.getFieldValue('NAME'));\n          const deleteText = Msg['CANNOT_DELETE_VARIABLE_PROCEDURE']\n            .replace('%1', variableName)\n            .replace('%2', procedureName);\n          dialog.alert(deleteText);\n          return;\n        }\n      }\n\n      if (uses.length > 1) {\n        // Confirm before deleting multiple blocks.\n        const confirmText = Msg['DELETE_VARIABLE_CONFIRMATION']\n          .replace('%1', String(uses.length))\n          .replace('%2', variableName);\n        dialog.confirm(confirmText, (ok) => {\n          if (ok && variable) {\n            this.deleteVariableInternal(variable, uses);\n          }\n        });\n      } else {\n        // No confirmation necessary for a single block.\n        this.deleteVariableInternal(variable, uses);\n      }\n    } else {\n      console.warn(\"Can't delete non-existent variable: \" + id);\n    }\n  }\n\n  /**\n   * Deletes a variable and all of its uses from this workspace without asking\n   * the user for confirmation.\n   *\n   * @param variable Variable to delete.\n   * @param uses An array of uses of the variable.\n   * @internal\n   */\n  deleteVariableInternal(variable: VariableModel, uses: Block[]) {\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n    try {\n      for (let i = 0; i < uses.length; i++) {\n        uses[i].dispose(true);\n      }\n      this.deleteVariable(variable);\n    } finally {\n      eventUtils.setGroup(existingGroup);\n    }\n  }\n  /* End functions for variable deletion. */\n  /**\n   * Find the variable by the given name and type and return it.  Return null if\n   *     it is not found.\n   *\n   * @param name The name to check for.\n   * @param opt_type The type of the variable.  If not provided it defaults to\n   *     the empty string, which is a specific type.\n   * @returns The variable with the given name, or null if it was not found.\n   */\n  getVariable(name: string, opt_type?: string | null): VariableModel | null {\n    const type = opt_type || '';\n    const list = this.variableMap.get(type);\n    if (list) {\n      for (let j = 0, variable; (variable = list[j]); j++) {\n        if (Names.equals(variable.name, name)) {\n          return variable;\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Find the variable by the given ID and return it.  Return null if not found.\n   *\n   * @param id The ID to check for.\n   * @returns The variable with the given ID.\n   */\n  getVariableById(id: string): VariableModel | null {\n    for (const variables of this.variableMap.values()) {\n      for (const variable of variables) {\n        if (variable.getId() === id) {\n          return variable;\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Get a list containing all of the variables of a specified type. If type is\n   *     null, return list of variables with empty string type.\n   *\n   * @param type Type of the variables to find.\n   * @returns The sought after variables of the passed in type. An empty array\n   *     if none are found.\n   */\n  getVariablesOfType(type: string | null): VariableModel[] {\n    type = type || '';\n    const variableList = this.variableMap.get(type);\n    if (variableList) {\n      return variableList.slice();\n    }\n    return [];\n  }\n\n  /**\n   * Return all variable and potential variable types.  This list always\n   * contains the empty string.\n   *\n   * @param ws The workspace used to look for potential variables. This can be\n   *     different than the workspace stored on this object if the passed in ws\n   *     is a flyout workspace.\n   * @returns List of variable types.\n   * @internal\n   */\n  getVariableTypes(ws: Workspace | null): string[] {\n    const variableTypes = new Set<string>(this.variableMap.keys());\n    if (ws && ws.getPotentialVariableMap()) {\n      for (const key of ws.getPotentialVariableMap()!.variableMap.keys()) {\n        variableTypes.add(key);\n      }\n    }\n    if (!variableTypes.has('')) {\n      variableTypes.add('');\n    }\n    return Array.from(variableTypes.values());\n  }\n\n  /**\n   * Return all variables of all types.\n   *\n   * @returns List of variable models.\n   */\n  getAllVariables(): VariableModel[] {\n    let allVariables: VariableModel[] = [];\n    for (const variables of this.variableMap.values()) {\n      allVariables = allVariables.concat(variables);\n    }\n    return allVariables;\n  }\n\n  /**\n   * Returns all of the variable names of all types.\n   *\n   * @returns All of the variable names of all types.\n   */\n  getAllVariableNames(): string[] {\n    return Array.from(this.variableMap.values())\n      .flat()\n      .map((variable) => variable.name);\n  }\n\n  /**\n   * Find all the uses of a named variable.\n   *\n   * @param id ID of the variable to find.\n   * @returns Array of block usages.\n   */\n  getVariableUsesById(id: string): Block[] {\n    const uses = [];\n    const blocks = this.workspace.getAllBlocks(false);\n    // Iterate through every block and check the name.\n    for (let i = 0; i < blocks.length; i++) {\n      const blockVariables = blocks[i].getVarModels();\n      if (blockVariables) {\n        for (let j = 0; j < blockVariables.length; j++) {\n          if (blockVariables[j].getId() === id) {\n            uses.push(blocks[i]);\n          }\n        }\n      }\n    }\n    return uses;\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a workspace.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Workspace\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './connection_checker.js';\n\nimport type {Block} from './block.js';\nimport type {BlocklyOptions} from './blockly_options.js';\nimport type {ConnectionDB} from './connection_db.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport * as common from './common.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IASTNodeLocation} from './interfaces/i_ast_node_location.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport {Options} from './options.js';\nimport * as registry from './registry.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport * as math from './utils/math.js';\nimport type * as toolbox from './utils/toolbox.js';\nimport {VariableMap} from './variable_map.js';\nimport type {VariableModel} from './variable_model.js';\nimport {WorkspaceComment} from './comments/workspace_comment.js';\nimport {IProcedureMap} from './interfaces/i_procedure_map.js';\nimport {ObservableProcedureMap} from './observable_procedure_map.js';\n\n/**\n * Class for a workspace.  This is a data structure that contains blocks.\n * There is no UI, and can be created headlessly.\n */\nexport class Workspace implements IASTNodeLocation {\n  /**\n   * Angle away from the horizontal to sweep for blocks.  Order of execution is\n   * generally top to bottom, but a small angle changes the scan to give a bit\n   * of a left to right bias (reversed in RTL).  Units are in degrees. See:\n   * https://tvtropes.org/pmwiki/pmwiki.php/Main/DiagonalBilling\n   */\n  static SCAN_ANGLE = 3;\n  id: string;\n  options: Options;\n  RTL: boolean;\n  horizontalLayout: boolean;\n  toolboxPosition: toolbox.Position;\n\n  /**\n   * Returns `true` if the workspace is visible and `false` if it's headless.\n   */\n  rendered = false;\n\n  /**\n   * Is this workspace the surface for a flyout?\n   *\n   * @internal\n   */\n  internalIsFlyout = false;\n\n  /** Is this workspace the surface for a flyout? */\n  get isFlyout(): boolean {\n    return this.internalIsFlyout;\n  }\n\n  /**\n   * Is this workspace the surface for a mutator?\n   *\n   * @internal\n   */\n  internalIsMutator = false;\n\n  /** Is this workspace the surface for a mutator? */\n  get isMutator(): boolean {\n    return this.internalIsMutator;\n  }\n\n  /**\n   * Returns `true` if the workspace is currently in the process of a bulk\n   * clear.\n   *\n   * @internal\n   */\n  isClearing = false;\n\n  /**\n   * Maximum number of undo events in stack. `0` turns off undo, `Infinity`\n   * sets it to unlimited.\n   */\n  MAX_UNDO = 1024;\n\n  /** Set of databases for rapid lookup of connection locations. */\n  connectionDBList: ConnectionDB[] = [];\n  connectionChecker: IConnectionChecker;\n\n  private readonly topBlocks: Block[] = [];\n  private readonly topComments: WorkspaceComment[] = [];\n  private readonly commentDB = new Map<string, WorkspaceComment>();\n  private readonly listeners: Function[] = [];\n  protected undoStack_: Abstract[] = [];\n  protected redoStack_: Abstract[] = [];\n  private readonly blockDB = new Map<string, Block>();\n  private readonly typedBlocksDB = new Map<string, Block[]>();\n  private variableMap: VariableMap;\n  private procedureMap: IProcedureMap = new ObservableProcedureMap();\n\n  /**\n   * Blocks in the flyout can refer to variables that don't exist in the main\n   * workspace.  For instance, the \"get item in list\" block refers to an\n   * \"item\" variable regardless of whether the variable has been created yet.\n   * A FieldVariable must always refer to a VariableModel.  We reconcile\n   * these by tracking \"potential\" variables in the flyout.  These variables\n   * become real when references to them are dragged into the main workspace.\n   */\n  private potentialVariableMap: VariableMap | null = null;\n\n  /** @param opt_options Dictionary of options. */\n  constructor(opt_options?: Options) {\n    this.id = idGenerator.genUid();\n    common.registerWorkspace(this);\n    this.options = opt_options || new Options({} as BlocklyOptions);\n    this.RTL = !!this.options.RTL;\n    this.horizontalLayout = !!this.options.horizontalLayout;\n    this.toolboxPosition = this.options.toolboxPosition;\n\n    const connectionCheckerClass = registry.getClassFromOptions(\n      registry.Type.CONNECTION_CHECKER,\n      this.options,\n      true,\n    );\n    /**\n     * An object that encapsulates logic for safety, type, and dragging checks.\n     */\n    this.connectionChecker = new connectionCheckerClass!(this);\n\n    /**\n     * A map from variable type to list of variable names.  The lists contain\n     * all of the named variables in the workspace, including variables that are\n     * not currently in use.\n     */\n    this.variableMap = new VariableMap(this);\n  }\n\n  /**\n   * Dispose of this workspace.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    this.listeners.length = 0;\n    this.clear();\n    // Remove from workspace database.\n    common.unregisterWorkpace(this);\n  }\n\n  /**\n   * Compare function for sorting objects (blocks, comments, etc) by position;\n   *    top to bottom (with slight LTR or RTL bias).\n   *\n   * @param a The first object to compare.\n   * @param b The second object to compare.\n   * @returns The comparison value. This tells Array.sort() how to change object\n   *     a's index.\n   */\n  private sortObjects_(\n    a: Block | WorkspaceComment,\n    b: Block | WorkspaceComment,\n  ): number {\n    const offset =\n      Math.sin(math.toRadians(Workspace.SCAN_ANGLE)) * (this.RTL ? -1 : 1);\n    const aXY = a.getRelativeToSurfaceXY();\n    const bXY = b.getRelativeToSurfaceXY();\n    return aXY.y + offset * aXY.x - (bXY.y + offset * bXY.x);\n  }\n\n  /**\n   * Adds a block to the list of top blocks.\n   *\n   * @param block Block to add.\n   */\n  addTopBlock(block: Block) {\n    this.topBlocks.push(block);\n  }\n\n  /**\n   * Removes a block from the list of top blocks.\n   *\n   * @param block Block to remove.\n   */\n  removeTopBlock(block: Block) {\n    if (!arrayUtils.removeElem(this.topBlocks, block)) {\n      throw Error(\"Block not present in workspace's list of top-most blocks.\");\n    }\n  }\n\n  /**\n   * Finds the top-level blocks and returns them.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns The top-level block objects.\n   */\n  getTopBlocks(ordered = false): Block[] {\n    // Copy the topBlocks list.\n    const blocks = new Array<Block>().concat(this.topBlocks);\n    if (ordered && blocks.length > 1) {\n      blocks.sort(this.sortObjects_.bind(this));\n    }\n    return blocks;\n  }\n\n  /**\n   * Add a block to the list of blocks keyed by type.\n   *\n   * @param block Block to add.\n   */\n  addTypedBlock(block: Block) {\n    if (!this.typedBlocksDB.has(block.type)) {\n      this.typedBlocksDB.set(block.type, []);\n    }\n    this.typedBlocksDB.get(block.type)!.push(block);\n  }\n\n  /**\n   * Remove a block from the list of blocks keyed by type.\n   *\n   * @param block Block to remove.\n   */\n  removeTypedBlock(block: Block) {\n    arrayUtils.removeElem(this.typedBlocksDB.get(block.type)!, block);\n    if (!this.typedBlocksDB.get(block.type)!.length) {\n      this.typedBlocksDB.delete(block.type);\n    }\n  }\n\n  /**\n   * Finds the blocks with the associated type and returns them. Blocks are\n   * optionally sorted by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param type The type of block to search for.\n   * @param ordered Sort the list if true.\n   * @returns The blocks of the given type.\n   */\n  getBlocksByType(type: string, ordered = false): Block[] {\n    if (!this.typedBlocksDB.has(type)) {\n      return [];\n    }\n    const blocks = this.typedBlocksDB.get(type)!.slice(0);\n    if (ordered && blocks && blocks.length > 1) {\n      blocks.sort(this.sortObjects_.bind(this));\n    }\n\n    return blocks.filter(function (block: Block) {\n      return !block.isInsertionMarker();\n    });\n  }\n\n  /**\n   * Adds a comment to the list of top comments.\n   *\n   * @param comment comment to add.\n   * @internal\n   */\n  addTopComment(comment: WorkspaceComment) {\n    this.topComments.push(comment);\n\n    // Note: If the comment database starts to hold block comments, this may\n    // need to move to a separate function.\n    if (this.commentDB.has(comment.id)) {\n      console.warn(\n        'Overriding an existing comment on this workspace, with id \"' +\n          comment.id +\n          '\"',\n      );\n    }\n    this.commentDB.set(comment.id, comment);\n  }\n\n  /**\n   * Removes a comment from the list of top comments.\n   *\n   * @param comment comment to remove.\n   * @internal\n   */\n  removeTopComment(comment: WorkspaceComment) {\n    if (!arrayUtils.removeElem(this.topComments, comment)) {\n      throw Error(\n        \"Comment not present in workspace's list of top-most \" + 'comments.',\n      );\n    }\n    // Note: If the comment database starts to hold block comments, this may\n    // need to move to a separate function.\n    this.commentDB.delete(comment.id);\n  }\n\n  /**\n   * Finds the top-level comments and returns them.  Comments are optionally\n   * sorted by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns The top-level comment objects.\n   * @internal\n   */\n  getTopComments(ordered = false): WorkspaceComment[] {\n    // Copy the topComments list.\n    const comments = new Array<WorkspaceComment>().concat(this.topComments);\n    if (ordered && comments.length > 1) {\n      comments.sort(this.sortObjects_.bind(this));\n    }\n    return comments;\n  }\n\n  /**\n   * Find all blocks in workspace.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  getAllBlocks(ordered = false): Block[] {\n    let blocks: Block[];\n    if (ordered) {\n      // Slow, but ordered.\n      const topBlocks = this.getTopBlocks(true);\n      blocks = [];\n      for (let i = 0; i < topBlocks.length; i++) {\n        blocks.push(...topBlocks[i].getDescendants(true));\n      }\n    } else {\n      // Fast, but in no particular order.\n      blocks = this.getTopBlocks(false);\n      for (let i = 0; i < blocks.length; i++) {\n        blocks.push(...blocks[i].getChildren(false));\n      }\n    }\n\n    // Insertion markers exist on the workspace for rendering reasons, but\n    // aren't \"real\" blocks from a developer perspective.\n    const filtered = blocks.filter(function (block) {\n      return !block.isInsertionMarker();\n    });\n\n    return filtered;\n  }\n\n  /** Dispose of all blocks and comments in workspace. */\n  clear() {\n    this.isClearing = true;\n    try {\n      const existingGroup = eventUtils.getGroup();\n      if (!existingGroup) {\n        eventUtils.setGroup(true);\n      }\n      while (this.topBlocks.length) {\n        this.topBlocks[0].dispose(false);\n      }\n      while (this.topComments.length) {\n        this.topComments[this.topComments.length - 1].dispose();\n      }\n      eventUtils.setGroup(existingGroup);\n      this.variableMap.clear();\n      if (this.potentialVariableMap) {\n        this.potentialVariableMap.clear();\n      }\n    } finally {\n      this.isClearing = false;\n    }\n  }\n\n  /* Begin functions that are just pass-throughs to the variable map. */\n  /**\n   * Rename a variable by updating its name in the variable map. Identify the\n   * variable to rename with the given ID.\n   *\n   * @param id ID of the variable to rename.\n   * @param newName New variable name.\n   */\n  renameVariableById(id: string, newName: string) {\n    this.variableMap.renameVariableById(id, newName);\n  }\n\n  /**\n   * Create a variable with a given name, optional type, and optional ID.\n   *\n   * @param name The name of the variable. This must be unique across variables\n   *     and procedures.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   * @returns The newly created variable.\n   */\n  createVariable(\n    name: string,\n    opt_type?: string | null,\n    opt_id?: string | null,\n  ): VariableModel {\n    return this.variableMap.createVariable(name, opt_type, opt_id);\n  }\n\n  /**\n   * Find all the uses of the given variable, which is identified by ID.\n   *\n   * @param id ID of the variable to find.\n   * @returns Array of block usages.\n   */\n  getVariableUsesById(id: string): Block[] {\n    return this.variableMap.getVariableUsesById(id);\n  }\n\n  /**\n   * Delete a variables by the passed in ID and all of its uses from this\n   * workspace. May prompt the user for confirmation.\n   *\n   * @param id ID of variable to delete.\n   */\n  deleteVariableById(id: string) {\n    this.variableMap.deleteVariableById(id);\n  }\n\n  /**\n   * Find the variable by the given name and return it. Return null if not\n   * found.\n   *\n   * @param name The name to check for.\n   * @param opt_type The type of the variable.  If not provided it defaults to\n   *     the empty string, which is a specific type.\n   * @returns The variable with the given name.\n   */\n  getVariable(name: string, opt_type?: string): VariableModel | null {\n    // TODO (#1559): Possibly delete this function after resolving #1559.\n    return this.variableMap.getVariable(name, opt_type);\n  }\n\n  /**\n   * Find the variable by the given ID and return it. Return null if not found.\n   *\n   * @param id The ID to check for.\n   * @returns The variable with the given ID.\n   */\n  getVariableById(id: string): VariableModel | null {\n    return this.variableMap.getVariableById(id);\n  }\n\n  /**\n   * Find the variable with the specified type. If type is null, return list of\n   *     variables with empty string type.\n   *\n   * @param type Type of the variables to find.\n   * @returns The sought after variables of the passed in type. An empty array\n   *     if none are found.\n   */\n  getVariablesOfType(type: string | null): VariableModel[] {\n    return this.variableMap.getVariablesOfType(type);\n  }\n\n  /**\n   * Return all variable types.\n   *\n   * @returns List of variable types.\n   * @internal\n   */\n  getVariableTypes(): string[] {\n    return this.variableMap.getVariableTypes(this);\n  }\n\n  /**\n   * Return all variables of all types.\n   *\n   * @returns List of variable models.\n   */\n  getAllVariables(): VariableModel[] {\n    return this.variableMap.getAllVariables();\n  }\n\n  /**\n   * Returns all variable names of all types.\n   *\n   * @returns List of all variable names of all types.\n   */\n  getAllVariableNames(): string[] {\n    return this.variableMap.getAllVariableNames();\n  }\n  /* End functions that are just pass-throughs to the variable map. */\n  /**\n   * Returns the horizontal offset of the workspace.\n   * Intended for LTR/RTL compatibility in XML.\n   * Not relevant for a headless workspace.\n   *\n   * @returns Width.\n   */\n  getWidth(): number {\n    return 0;\n  }\n\n  /* eslint-disable jsdoc/require-returns-check */\n  /* eslint-disable @typescript-eslint/no-unused-vars */\n  /**\n   * Obtain a newly created block.\n   *\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   * @returns The created block.\n   */\n  newBlock(prototypeName: string, opt_id?: string): Block {\n    throw new Error(\n      'The implementation of newBlock should be ' +\n        'monkey-patched in by blockly.ts',\n    );\n  }\n\n  /**\n   * Obtain a newly created comment.\n   *\n   * @param id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   * @returns The created comment.\n   */\n  newComment(id?: string): WorkspaceComment {\n    throw new Error(\n      'The implementation of newComment should be ' +\n        'monkey-patched in by blockly.ts',\n    );\n  }\n  /* eslint-enable */\n\n  /**\n   * The number of blocks that may be added to the workspace before reaching\n   *     the maxBlocks.\n   *\n   * @returns Number of blocks left.\n   */\n  remainingCapacity(): number {\n    if (isNaN(this.options.maxBlocks)) {\n      return Infinity;\n    }\n\n    return this.options.maxBlocks - this.getAllBlocks(false).length;\n  }\n\n  /**\n   * The number of blocks of the given type that may be added to the workspace\n   *    before reaching the maxInstances allowed for that type.\n   *\n   * @param type Type of block to return capacity for.\n   * @returns Number of blocks of type left.\n   */\n  remainingCapacityOfType(type: string): number {\n    if (!this.options.maxInstances) {\n      return Infinity;\n    }\n\n    const maxInstanceOfType =\n      this.options.maxInstances[type] !== undefined\n        ? this.options.maxInstances[type]\n        : Infinity;\n\n    return maxInstanceOfType - this.getBlocksByType(type, false).length;\n  }\n\n  /**\n   * Check if there is remaining capacity for blocks of the given counts to be\n   *    created. If the total number of blocks represented by the map is more\n   * than the total remaining capacity, it returns false. If a type count is\n   * more than the remaining capacity for that type, it returns false.\n   *\n   * @param typeCountsMap A map of types to counts (usually representing blocks\n   *     to be created).\n   * @returns True if there is capacity for the given map, false otherwise.\n   */\n  isCapacityAvailable(typeCountsMap: {[key: string]: number}): boolean {\n    if (!this.hasBlockLimits()) {\n      return true;\n    }\n    let copyableBlocksCount = 0;\n    for (const type in typeCountsMap) {\n      if (typeCountsMap[type] > this.remainingCapacityOfType(type)) {\n        return false;\n      }\n      copyableBlocksCount += typeCountsMap[type];\n    }\n    if (copyableBlocksCount > this.remainingCapacity()) {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Checks if the workspace has any limits on the maximum number of blocks,\n   *    or the maximum number of blocks of specific types.\n   *\n   * @returns True if it has block limits, false otherwise.\n   */\n  hasBlockLimits(): boolean {\n    return this.options.maxBlocks !== Infinity || !!this.options.maxInstances;\n  }\n\n  /**\n   * Gets the undo stack for workplace.\n   *\n   * @returns undo stack\n   * @internal\n   */\n  getUndoStack(): Abstract[] {\n    return this.undoStack_;\n  }\n\n  /**\n   * Gets the redo stack for workplace.\n   *\n   * @returns redo stack\n   * @internal\n   */\n  getRedoStack(): Abstract[] {\n    return this.redoStack_;\n  }\n\n  /**\n   * Undo or redo the previous action.\n   *\n   * @param redo False if undo, true if redo.\n   */\n  undo(redo: boolean) {\n    const inputStack = redo ? this.redoStack_ : this.undoStack_;\n    const outputStack = redo ? this.undoStack_ : this.redoStack_;\n    const inputEvent = inputStack.pop();\n    if (!inputEvent) {\n      return;\n    }\n    let events = [inputEvent];\n    // Do another undo/redo if the next one is of the same group.\n    while (\n      inputStack.length &&\n      inputEvent.group &&\n      inputEvent.group === inputStack[inputStack.length - 1].group\n    ) {\n      const event = inputStack.pop();\n      if (!event) continue;\n      events.push(event);\n    }\n    // Push these popped events on the opposite stack.\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      outputStack.push(event);\n    }\n    events = eventUtils.filter(events, redo);\n    eventUtils.setRecordUndo(false);\n    try {\n      for (let i = 0; i < events.length; i++) {\n        const event = events[i];\n        event.run(redo);\n      }\n    } finally {\n      eventUtils.setRecordUndo(true);\n    }\n  }\n\n  /** Clear the undo/redo stacks. */\n  clearUndo() {\n    this.undoStack_.length = 0;\n    this.redoStack_.length = 0;\n    // Stop any events already in the firing queue from being undoable.\n    eventUtils.clearPendingUndo();\n  }\n\n  /**\n   * When something in this workspace changes, call a function.\n   * Note that there may be a few recent events already on the stack.  Thus the\n   * new change listener might be called with events that occurred a few\n   * milliseconds before the change listener was added.\n   *\n   * @param func Function to call.\n   * @returns Obsolete return value, ignore.\n   */\n  addChangeListener(func: (e: Abstract) => void): Function {\n    this.listeners.push(func);\n    return func;\n  }\n\n  /**\n   * Stop listening for this workspace's changes.\n   *\n   * @param func Function to stop calling.\n   */\n  removeChangeListener(func: Function) {\n    arrayUtils.removeElem(this.listeners, func);\n  }\n\n  /**\n   * Fire a change event.\n   *\n   * @param event Event to fire.\n   */\n  fireChangeListener(event: Abstract) {\n    if (event.recordUndo) {\n      this.undoStack_.push(event);\n      this.redoStack_.length = 0;\n      while (this.undoStack_.length > this.MAX_UNDO && this.MAX_UNDO >= 0) {\n        this.undoStack_.shift();\n      }\n    }\n    for (let i = 0; i < this.listeners.length; i++) {\n      const func = this.listeners[i];\n      func(event);\n    }\n  }\n\n  /**\n   * Find the block on this workspace with the specified ID.\n   *\n   * @param id ID of block to find.\n   * @returns The sought after block, or null if not found.\n   */\n  getBlockById(id: string): Block | null {\n    return this.blockDB.get(id) || null;\n  }\n\n  /**\n   * Set a block on this workspace with the specified ID.\n   *\n   * @param id ID of block to set.\n   * @param block The block to set.\n   * @internal\n   */\n  setBlockById(id: string, block: Block) {\n    this.blockDB.set(id, block);\n  }\n\n  /**\n   * Delete a block off this workspace with the specified ID.\n   *\n   * @param id ID of block to delete.\n   * @internal\n   */\n  removeBlockById(id: string) {\n    this.blockDB.delete(id);\n  }\n\n  /**\n   * Find the comment on this workspace with the specified ID.\n   *\n   * @param id ID of comment to find.\n   * @returns The sought after comment, or null if not found.\n   * @internal\n   */\n  getCommentById(id: string): WorkspaceComment | null {\n    return this.commentDB.get(id) ?? null;\n  }\n\n  /**\n   * Checks whether all value and statement inputs in the workspace are filled\n   * with blocks.\n   *\n   * @param opt_shadowBlocksAreFilled An optional argument controlling whether\n   *     shadow blocks are counted as filled. Defaults to true.\n   * @returns True if all inputs are filled, false otherwise.\n   */\n  allInputsFilled(opt_shadowBlocksAreFilled?: boolean): boolean {\n    const blocks = this.getTopBlocks(false);\n    for (let i = 0; i < blocks.length; i++) {\n      const block = blocks[i];\n      if (!block.allInputsFilled(opt_shadowBlocksAreFilled)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Return the variable map that contains \"potential\" variables.\n   * These exist in the flyout but not in the workspace.\n   *\n   * @returns The potential variable map.\n   * @internal\n   */\n  getPotentialVariableMap(): VariableMap | null {\n    return this.potentialVariableMap;\n  }\n\n  /**\n   * Create and store the potential variable map for this workspace.\n   *\n   * @internal\n   */\n  createPotentialVariableMap() {\n    this.potentialVariableMap = new VariableMap(this);\n  }\n\n  /**\n   * Return the map of all variables on the workspace.\n   *\n   * @returns The variable map.\n   */\n  getVariableMap(): VariableMap {\n    return this.variableMap;\n  }\n\n  /**\n   * Set the map of all variables on the workspace.\n   *\n   * @param variableMap The variable map.\n   * @internal\n   */\n  setVariableMap(variableMap: VariableMap) {\n    this.variableMap = variableMap;\n  }\n\n  /** Returns the map of all procedures on the workpace. */\n  getProcedureMap(): IProcedureMap {\n    return this.procedureMap;\n  }\n\n  /**\n   * Returns the root workspace of this workspace if the workspace has\n   * parent(s).\n   *\n   * E.g. workspaces in flyouts and mini workspace bubbles have parent\n   * workspaces.\n   */\n  getRootWorkspace(): Workspace | null {\n    let outerWs = null;\n    const parent = this.options.parentWorkspace;\n    // If we were in a flyout in a mutator, need to go up two levels to find\n    // the actual parent.\n    if (this.isFlyout) {\n      if (parent && parent.options) {\n        outerWs = parent.options.parentWorkspace;\n      }\n    } else if (parent) {\n      outerWs = parent;\n    }\n    return outerWs;\n  }\n\n  /**\n   * Find the workspace with the specified ID.\n   *\n   * @param id ID of workspace to find.\n   * @returns The sought after workspace or null if not found.\n   */\n  static getById(id: string): Workspace | null {\n    return common.getWorkspaceById(id);\n  }\n\n  /**\n   * Find all workspaces.\n   *\n   * @returns Array of workspaces.\n   */\n  static getAll(): Workspace[] {\n    return common.getAllWorkspaces();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object in charge of loading, storing, and playing audio for a\n *     workspace.\n *\n * @class\n */\n// Former goog.module ID: Blockly.WorkspaceAudio\n\nimport * as userAgent from './utils/useragent.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Prevent a sound from playing if another sound preceded it within this many\n * milliseconds.\n */\nconst SOUND_LIMIT = 100;\n\n/**\n * Class for loading, storing, and playing audio for a workspace.\n */\nexport class WorkspaceAudio {\n  /** Database of pre-loaded sounds. */\n  private sounds = new Map<string, HTMLAudioElement>();\n\n  /** Time that the last sound was played. */\n  private lastSound_: Date | null = null;\n\n  /** Whether the audio is muted or not. */\n  private muted: boolean = false;\n\n  /**\n   * @param parentWorkspace The parent of the workspace this audio object\n   *     belongs to, or null.\n   */\n  constructor(private parentWorkspace: WorkspaceSvg) {}\n\n  /**\n   * Dispose of this audio manager.\n   *\n   * @internal\n   */\n  dispose() {\n    this.sounds.clear();\n  }\n\n  /**\n   * Load an audio file.  Cache it, ready for instantaneous playing.\n   *\n   * @param filenames List of file types in decreasing order of preference (i.e.\n   *     increasing size).  E.g. ['media/go.mp3', 'media/go.wav'] Filenames\n   *     include path from Blockly's root.  File extensions matter.\n   * @param name Name of sound.\n   */\n  load(filenames: string[], name: string) {\n    if (!filenames.length) {\n      return;\n    }\n    let audioTest;\n    try {\n      audioTest = new globalThis['Audio']();\n    } catch (e) {\n      // No browser support for Audio.\n      // IE can throw an error even if the Audio object exists.\n      return;\n    }\n    let sound;\n    for (let i = 0; i < filenames.length; i++) {\n      const filename = filenames[i];\n      const ext = filename.match(/\\.(\\w+)$/);\n      if (ext && audioTest.canPlayType('audio/' + ext[1])) {\n        // Found an audio format we can play.\n        sound = new globalThis['Audio'](filename);\n        break;\n      }\n    }\n    if (sound) {\n      this.sounds.set(name, sound);\n    }\n  }\n\n  /**\n   * Preload all the audio files so that they play quickly when asked for.\n   *\n   * @internal\n   */\n  preload() {\n    for (const sound of this.sounds.values()) {\n      sound.volume = 0.01;\n      const playPromise = sound.play();\n      // Edge does not return a promise, so we need to check.\n      if (playPromise !== undefined) {\n        // If we don't wait for the play request to complete before calling\n        // pause() we will get an exception: (DOMException: The play() request\n        // was interrupted) See more:\n        // https://developers.google.com/web/updates/2017/06/play-request-was-interrupted\n        playPromise.then(sound.pause).catch(\n          // Play without user interaction was prevented.\n          function () {},\n        );\n      } else {\n        sound.pause();\n      }\n\n      // iOS can only process one sound at a time.  Trying to load more than one\n      // corrupts the earlier ones.  Just load one and leave the others\n      // uncached.\n      if (userAgent.IPAD || userAgent.IPHONE) {\n        break;\n      }\n    }\n  }\n\n  /**\n   * Play a named sound at specified volume.  If volume is not specified,\n   * use full volume (1).\n   *\n   * @param name Name of sound.\n   * @param opt_volume Volume of sound (0-1).\n   */\n  play(name: string, opt_volume?: number) {\n    if (this.muted) {\n      return;\n    }\n    const sound = this.sounds.get(name);\n    if (sound) {\n      // Don't play one sound on top of another.\n      const now = new Date();\n      if (\n        this.lastSound_ !== null &&\n        now.getTime() - this.lastSound_.getTime() < SOUND_LIMIT\n      ) {\n        return;\n      }\n      this.lastSound_ = now;\n      let mySound;\n      if (userAgent.IPAD || userAgent.ANDROID) {\n        // Creating a new audio node causes lag in Android and iPad.  Android\n        // refetches the file from the server, iPad uses a singleton audio\n        // node which must be deleted and recreated for each new audio tag.\n        mySound = sound;\n      } else {\n        mySound = sound.cloneNode() as HTMLAudioElement;\n      }\n      mySound.volume = opt_volume === undefined ? 1 : opt_volume;\n      mySound.play();\n    } else if (this.parentWorkspace) {\n      // Maybe a workspace on a lower level knows about this sound.\n      this.parentWorkspace.getAudioManager().play(name, opt_volume);\n    }\n  }\n\n  /**\n   * @param muted If true, mute sounds. Otherwise, play them.\n   */\n  setMuted(muted: boolean) {\n    this.muted = muted;\n  }\n\n  /**\n   * @returns Whether the audio is currently muted or not.\n   */\n  getMuted(): boolean {\n    return this.muted;\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {WorkspaceSvg} from './workspace_svg.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\nimport {IRenderedElement} from './interfaces/i_rendered_element.js';\nimport * as layerNums from './layers.js';\nimport {Coordinate} from './utils/coordinate.js';\n\n/** @internal */\nexport class LayerManager {\n  /** The layer elements being dragged are appended to. */\n  private dragLayer: SVGGElement | undefined;\n  /** The layer elements being animated are appended to. */\n  private animationLayer: SVGGElement | undefined;\n  /** The layers elements not being dragged are appended to.  */\n  private layers = new Map<number, SVGGElement>();\n\n  /** @internal */\n  constructor(private workspace: WorkspaceSvg) {\n    const injectionDiv = workspace.getInjectionDiv();\n    // `getInjectionDiv` is actually nullable. We hit this if the workspace\n    // is part of a flyout and the workspace the flyout is attached to hasn't\n    // been appended yet.\n    if (injectionDiv) {\n      this.dragLayer = this.createDragLayer(injectionDiv);\n      this.animationLayer = this.createAnimationLayer(injectionDiv);\n    }\n\n    // We construct these manually so we can add the css class for backwards\n    // compatibility.\n    const blockLayer = this.createLayer(layerNums.BLOCK);\n    dom.addClass(blockLayer, 'blocklyBlockCanvas');\n    const bubbleLayer = this.createLayer(layerNums.BUBBLE);\n    dom.addClass(bubbleLayer, 'blocklyBubbleCanvas');\n  }\n\n  private createDragLayer(injectionDiv: Element) {\n    const svg = dom.createSvgElement(Svg.SVG, {\n      'class': 'blocklyBlockDragSurface',\n      'xmlns': dom.SVG_NS,\n      'xmlns:html': dom.HTML_NS,\n      'xmlns:xlink': dom.XLINK_NS,\n      'version': '1.1',\n    });\n    injectionDiv.append(svg);\n    return dom.createSvgElement(Svg.G, {}, svg);\n  }\n\n  private createAnimationLayer(injectionDiv: Element) {\n    const svg = dom.createSvgElement(Svg.SVG, {\n      'class': 'blocklyAnimationLayer',\n      'xmlns': dom.SVG_NS,\n      'xmlns:html': dom.HTML_NS,\n      'xmlns:xlink': dom.XLINK_NS,\n      'version': '1.1',\n    });\n    injectionDiv.append(svg);\n    return dom.createSvgElement(Svg.G, {}, svg);\n  }\n\n  /**\n   * Appends the element to the animation layer. The animation layer doesn't\n   * move when the workspace moves, so e.g. delete animations don't move\n   * when a block delete triggers a workspace resize.\n   *\n   * @internal\n   */\n  appendToAnimationLayer(elem: IRenderedElement) {\n    const currentTransform = this.dragLayer?.getAttribute('transform');\n    // Only update the current transform when appending, so animations don't\n    // move if the workspace moves.\n    if (currentTransform) {\n      this.animationLayer?.setAttribute('transform', currentTransform);\n    }\n    this.animationLayer?.appendChild(elem.getSvgRoot());\n  }\n\n  /**\n   * Translates layers when the workspace is dragged or zoomed.\n   *\n   * @internal\n   */\n  translateLayers(newCoord: Coordinate, newScale: number) {\n    const translation = `translate(${newCoord.x}, ${newCoord.y}) scale(${newScale})`;\n    this.dragLayer?.setAttribute('transform', translation);\n    for (const [_, layer] of this.layers) {\n      layer.setAttribute('transform', translation);\n    }\n  }\n\n  /**\n   * Moves the given element to the drag layer, which exists on top of all other\n   * layers, and the drag surface.\n   *\n   * @internal\n   */\n  moveToDragLayer(elem: IRenderedElement) {\n    this.dragLayer?.appendChild(elem.getSvgRoot());\n  }\n\n  /**\n   * Moves the given element off of the drag layer.\n   *\n   * @internal\n   */\n  moveOffDragLayer(elem: IRenderedElement, layerNum: number) {\n    this.append(elem, layerNum);\n  }\n\n  /**\n   * Appends the given element to a layer. If the layer does not exist, it is\n   * created.\n   *\n   * @internal\n   */\n  append(elem: IRenderedElement, layerNum: number) {\n    if (!this.layers.has(layerNum)) {\n      this.createLayer(layerNum);\n    }\n    this.layers.get(layerNum)?.appendChild(elem.getSvgRoot());\n  }\n\n  /**\n   * Creates a layer and inserts it at the proper place given the layer number.\n   *\n   * More positive layers exist later in the dom and are rendered ontop of\n   * less positive layers. Layers are added to the layer map as a side effect.\n   */\n  private createLayer(layerNum: number): SVGGElement {\n    const parent = this.workspace.getSvgGroup();\n    const layer = dom.createSvgElement(Svg.G, {});\n\n    let inserted = false;\n    const sortedLayers = [...this.layers].sort((a, b) => a[0] - b[0]);\n    for (const [num, sib] of sortedLayers) {\n      if (layerNum < num) {\n        parent.insertBefore(layer, sib);\n        inserted = true;\n        break;\n      }\n    }\n    if (!inserted) {\n      parent.appendChild(layer);\n    }\n    this.layers.set(layerNum, layer);\n    return layer;\n  }\n\n  /**\n   * Returns true if the given element is a layer managed by the layer manager.\n   * False otherwise.\n   *\n   * @internal\n   */\n  hasLayer(elem: SVGElement) {\n    return (\n      elem === this.dragLayer ||\n      new Set(this.layers.values()).has(elem as SVGGElement)\n    );\n  }\n\n  /**\n   * We need to be able to access this layer explicitly for backwards\n   * compatibility.\n   *\n   * @internal\n   */\n  getBlockLayer(): SVGGElement {\n    return this.layers.get(layerNums.BLOCK)!;\n  }\n\n  /**\n   * We need to be able to access this layer explicitly for backwards\n   * compatibility.\n   *\n   * @internal\n   */\n  getBubbleLayer(): SVGGElement {\n    return this.layers.get(layerNums.BUBBLE)!;\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of trashcan flyout open and close.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.TrashcanOpen\n\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners when the trashcan is opening or closing.\n */\nexport class TrashcanOpen extends UiBase {\n  /**\n   * True if the trashcan is currently opening (previously closed).\n   * False if it is currently closing (previously open).\n   */\n  isOpen?: boolean;\n  override type = eventUtils.TRASHCAN_OPEN;\n\n  /**\n   * @param opt_isOpen Whether the trashcan flyout is opening (false if\n   *     opening). Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   */\n  constructor(opt_isOpen?: boolean, opt_workspaceId?: string) {\n    super(opt_workspaceId);\n    this.isOpen = opt_isOpen;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): TrashcanOpenJson {\n    const json = super.toJson() as TrashcanOpenJson;\n    if (this.isOpen === undefined) {\n      throw new Error(\n        'Whether this is already open or not is undefined. Either pass ' +\n          'a value to the constructor, or call fromJson',\n      );\n    }\n    json['isOpen'] = this.isOpen;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of TrashcanOpen, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: TrashcanOpenJson,\n    workspace: Workspace,\n    event?: any,\n  ): TrashcanOpen {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new TrashcanOpen(),\n    ) as TrashcanOpen;\n    newEvent.isOpen = json['isOpen'];\n    return newEvent;\n  }\n}\n\nexport interface TrashcanOpenJson extends AbstractEventJson {\n  isOpen: boolean;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.TRASHCAN_OPEN, TrashcanOpen);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of element select action.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.Selected\n\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Class for a selected event.\n * Notifies listeners that a new element has been selected.\n */\nexport class Selected extends UiBase {\n  /** The id of the last selected selectable element. */\n  oldElementId?: string;\n\n  /**\n   * The id of the newly selected selectable element,\n   * or undefined if unselected.\n   */\n  newElementId?: string;\n\n  override type = eventUtils.SELECTED;\n\n  /**\n   * @param opt_oldElementId The ID of the previously selected element. Null if\n   *     no element last selected. Undefined for a blank event.\n   * @param opt_newElementId The ID of the selected element. Null if no element\n   *     currently selected (deselect). Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Null if no element previously selected. Undefined for a blank event.\n   */\n  constructor(\n    opt_oldElementId?: string | null,\n    opt_newElementId?: string | null,\n    opt_workspaceId?: string,\n  ) {\n    super(opt_workspaceId);\n\n    this.oldElementId = opt_oldElementId ?? undefined;\n    this.newElementId = opt_newElementId ?? undefined;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): SelectedJson {\n    const json = super.toJson() as SelectedJson;\n    json['oldElementId'] = this.oldElementId;\n    json['newElementId'] = this.newElementId;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of Selected, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: SelectedJson,\n    workspace: Workspace,\n    event?: any,\n  ): Selected {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new Selected(),\n    ) as Selected;\n    newEvent.oldElementId = json['oldElementId'];\n    newEvent.newElementId = json['newElementId'];\n    return newEvent;\n  }\n}\n\nexport interface SelectedJson extends AbstractEventJson {\n  oldElementId?: string;\n  newElementId?: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.SELECTED, Selected);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a marker.\n * Used primarily for keyboard navigation to show a marked location.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Marker\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {MarkerSvg} from '../renderers/common/marker_svg.js';\n\nimport type {ASTNode} from './ast_node.js';\n\n/**\n * Class for a marker.\n * This is used in keyboard navigation to save a location in the Blockly AST.\n */\nexport class Marker {\n  /** The colour of the marker. */\n  colour: string | null = null;\n\n  /** The current location of the marker. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'ASTNode'.\n  private curNode: ASTNode = null as AnyDuringMigration;\n\n  /**\n   * The object in charge of drawing the visual representation of the current\n   * node.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'MarkerSvg'.\n  private drawer: MarkerSvg = null as AnyDuringMigration;\n\n  /** The type of the marker. */\n  type = 'marker';\n\n  /** Constructs a new Marker instance. */\n  constructor() {}\n\n  /**\n   * Sets the object in charge of drawing the marker.\n   *\n   * @param drawer The object in charge of drawing the marker.\n   */\n  setDrawer(drawer: MarkerSvg) {\n    this.drawer = drawer;\n  }\n\n  /**\n   * Get the current drawer for the marker.\n   *\n   * @returns The object in charge of drawing the marker.\n   */\n  getDrawer(): MarkerSvg {\n    return this.drawer;\n  }\n\n  /**\n   * Gets the current location of the marker.\n   *\n   * @returns The current field, connection, or block the marker is on.\n   */\n  getCurNode(): ASTNode {\n    return this.curNode;\n  }\n\n  /**\n   * Set the location of the marker and call the update method.\n   * Setting isStack to true will only work if the newLocation is the top most\n   * output or previous connection on a stack.\n   *\n   * @param newNode The new location of the marker.\n   */\n  setCurNode(newNode: ASTNode) {\n    const oldNode = this.curNode;\n    this.curNode = newNode;\n    if (this.drawer) {\n      this.drawer.draw(oldNode, this.curNode);\n    }\n  }\n\n  /**\n   * Redraw the current marker.\n   *\n   * @internal\n   */\n  draw() {\n    if (this.drawer) {\n      this.drawer.draw(this.curNode, this.curNode);\n    }\n  }\n\n  /** Hide the marker SVG. */\n  hide() {\n    if (this.drawer) {\n      this.drawer.hide();\n    }\n  }\n\n  /** Dispose of this marker. */\n  dispose() {\n    if (this.getDrawer()) {\n      this.getDrawer().dispose();\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a cursor.\n * Used primarily for keyboard navigation.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Cursor\n\nimport * as registry from '../registry.js';\n\nimport {ASTNode} from './ast_node.js';\nimport {Marker} from './marker.js';\n\n/**\n * Class for a cursor.\n * A cursor controls how a user navigates the Blockly AST.\n */\nexport class Cursor extends Marker {\n  override type = 'cursor';\n\n  constructor() {\n    super();\n  }\n\n  /**\n   * Find the next connection, field, or block.\n   *\n   * @returns The next element, or null if the current node is not set or there\n   *     is no next value.\n   */\n  next(): ASTNode | null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n\n    let newNode = curNode.next();\n    while (\n      newNode &&\n      newNode.next() &&\n      (newNode.getType() === ASTNode.types.NEXT ||\n        newNode.getType() === ASTNode.types.BLOCK)\n    ) {\n      newNode = newNode.next();\n    }\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * Find the in connection or field.\n   *\n   * @returns The in element, or null if the current node is not set or there is\n   *     no in value.\n   */\n  in(): ASTNode | null {\n    let curNode: ASTNode | null = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    // If we are on a previous or output connection, go to the block level\n    // before performing next operation.\n    if (\n      curNode.getType() === ASTNode.types.PREVIOUS ||\n      curNode.getType() === ASTNode.types.OUTPUT\n    ) {\n      curNode = curNode.next();\n    }\n    const newNode = curNode?.in() ?? null;\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * Find the previous connection, field, or block.\n   *\n   * @returns The previous element, or null if the current node is not set or\n   *     there is no previous value.\n   */\n  prev(): ASTNode | null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    let newNode = curNode.prev();\n\n    while (\n      newNode &&\n      newNode.prev() &&\n      (newNode.getType() === ASTNode.types.NEXT ||\n        newNode.getType() === ASTNode.types.BLOCK)\n    ) {\n      newNode = newNode.prev();\n    }\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * Find the out connection, field, or block.\n   *\n   * @returns The out element, or null if the current node is not set or there\n   *     is no out value.\n   */\n  out(): ASTNode | null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    let newNode = curNode.out();\n\n    if (newNode && newNode.getType() === ASTNode.types.BLOCK) {\n      newNode = newNode.prev() || newNode;\n    }\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n}\n\nregistry.register(registry.Type.CURSOR, registry.DEFAULT, Cursor);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a basic cursor.\n * Used to demo switching between different cursors.\n *\n * @class\n */\n// Former goog.module ID: Blockly.BasicCursor\n\nimport * as registry from '../registry.js';\n\nimport {ASTNode} from './ast_node.js';\nimport {Cursor} from './cursor.js';\n\n/**\n * Class for a basic cursor.\n * This will allow the user to get to all nodes in the AST by hitting next or\n * previous.\n */\nexport class BasicCursor extends Cursor {\n  /** Name used for registering a basic cursor. */\n  static readonly registrationName = 'basicCursor';\n\n  constructor() {\n    super();\n  }\n\n  /**\n   * Find the next node in the pre order traversal.\n   *\n   * @returns The next node, or null if the current node is not set or there is\n   *     no next value.\n   */\n  override next(): ASTNode | null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    const newNode = this.getNextNode_(curNode, this.validNode_);\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * For a basic cursor we only have the ability to go next and previous, so\n   * in will also allow the user to get to the next node in the pre order\n   * traversal.\n   *\n   * @returns The next node, or null if the current node is not set or there is\n   *     no next value.\n   */\n  override in(): ASTNode | null {\n    return this.next();\n  }\n\n  /**\n   * Find the previous node in the pre order traversal.\n   *\n   * @returns The previous node, or null if the current node is not set or there\n   *     is no previous value.\n   */\n  override prev(): ASTNode | null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    const newNode = this.getPreviousNode_(curNode, this.validNode_);\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * For a basic cursor we only have the ability to go next and previous, so\n   * out will allow the user to get to the previous node in the pre order\n   * traversal.\n   *\n   * @returns The previous node, or null if the current node is not set or there\n   *     is no previous value.\n   */\n  override out(): ASTNode | null {\n    return this.prev();\n  }\n\n  /**\n   * Uses pre order traversal to navigate the Blockly AST. This will allow\n   * a user to easily navigate the entire Blockly AST without having to go in\n   * and out levels on the tree.\n   *\n   * @param node The current position in the AST.\n   * @param isValid A function true/false depending on whether the given node\n   *     should be traversed.\n   * @returns The next node in the traversal.\n   */\n  protected getNextNode_(\n    node: ASTNode | null,\n    isValid: (p1: ASTNode | null) => boolean,\n  ): ASTNode | null {\n    if (!node) {\n      return null;\n    }\n    const newNode = node.in() || node.next();\n    if (isValid(newNode)) {\n      return newNode;\n    } else if (newNode) {\n      return this.getNextNode_(newNode, isValid);\n    }\n    const siblingOrParent = this.findSiblingOrParent(node.out());\n    if (isValid(siblingOrParent)) {\n      return siblingOrParent;\n    } else if (siblingOrParent) {\n      return this.getNextNode_(siblingOrParent, isValid);\n    }\n    return null;\n  }\n\n  /**\n   * Reverses the pre order traversal in order to find the previous node. This\n   * will allow a user to easily navigate the entire Blockly AST without having\n   * to go in and out levels on the tree.\n   *\n   * @param node The current position in the AST.\n   * @param isValid A function true/false depending on whether the given node\n   *     should be traversed.\n   * @returns The previous node in the traversal or null if no previous node\n   *     exists.\n   */\n  protected getPreviousNode_(\n    node: ASTNode | null,\n    isValid: (p1: ASTNode | null) => boolean,\n  ): ASTNode | null {\n    if (!node) {\n      return null;\n    }\n    let newNode: ASTNode | null = node.prev();\n\n    if (newNode) {\n      newNode = this.getRightMostChild(newNode);\n    } else {\n      newNode = node.out();\n    }\n    if (isValid(newNode)) {\n      return newNode;\n    } else if (newNode) {\n      return this.getPreviousNode_(newNode, isValid);\n    }\n    return null;\n  }\n\n  /**\n   * Decides what nodes to traverse and which ones to skip. Currently, it\n   * skips output, stack and workspace nodes.\n   *\n   * @param node The AST node to check whether it is valid.\n   * @returns True if the node should be visited, false otherwise.\n   */\n  protected validNode_(node: ASTNode | null): boolean {\n    let isValid = false;\n    const type = node && node.getType();\n    if (\n      type === ASTNode.types.OUTPUT ||\n      type === ASTNode.types.INPUT ||\n      type === ASTNode.types.FIELD ||\n      type === ASTNode.types.NEXT ||\n      type === ASTNode.types.PREVIOUS ||\n      type === ASTNode.types.WORKSPACE\n    ) {\n      isValid = true;\n    }\n    return isValid;\n  }\n\n  /**\n   * From the given node find either the next valid sibling or parent.\n   *\n   * @param node The current position in the AST.\n   * @returns The parent AST node or null if there are no valid parents.\n   */\n  private findSiblingOrParent(node: ASTNode | null): ASTNode | null {\n    if (!node) {\n      return null;\n    }\n    const nextNode = node.next();\n    if (nextNode) {\n      return nextNode;\n    }\n    return this.findSiblingOrParent(node.out());\n  }\n\n  /**\n   * Get the right most child of a node.\n   *\n   * @param node The node to find the right most child of.\n   * @returns The right most child of the given node, or the node if no child\n   *     exists.\n   */\n  private getRightMostChild(node: ASTNode | null): ASTNode | null {\n    if (!node!.in()) {\n      return node;\n    }\n    let newNode = node!.in();\n    while (newNode && newNode.next()) {\n      newNode = newNode.next();\n    }\n    return this.getRightMostChild(newNode);\n  }\n}\n\nregistry.register(\n  registry.Type.CURSOR,\n  BasicCursor.registrationName,\n  BasicCursor,\n);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a cursor that is used to navigate\n * between tab navigable fields.\n *\n * @class\n */\n// Former goog.module ID: Blockly.TabNavigateCursor\n\nimport type {Field} from '../field.js';\n\nimport {ASTNode} from './ast_node.js';\nimport {BasicCursor} from './basic_cursor.js';\n\n/**\n * A cursor for navigating between tab navigable fields.\n */\nexport class TabNavigateCursor extends BasicCursor {\n  /**\n   * Skip all nodes except for tab navigable fields.\n   *\n   * @param node The AST node to check whether it is valid.\n   * @returns True if the node should be visited, false otherwise.\n   */\n  override validNode_(node: ASTNode | null): boolean {\n    let isValid = false;\n    const type = node && node.getType();\n    if (node) {\n      const location = node.getLocation() as Field;\n      if (\n        type === ASTNode.types.FIELD &&\n        location &&\n        location.isTabNavigable() &&\n        location.isClickable()\n      ) {\n        isValid = true;\n      }\n    }\n    return isValid;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Components for creating connections between blocks.\n *\n * @class\n */\n// Former goog.module ID: Blockly.RenderedConnection\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as common from './common.js';\nimport {config} from './config.js';\nimport {Connection} from './connection.js';\nimport type {ConnectionDB} from './connection_db.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as eventUtils from './events/utils.js';\nimport {hasBubble} from './interfaces/i_has_bubble.js';\nimport * as internalConstants from './internal_constants.js';\nimport {Coordinate} from './utils/coordinate.js';\n\n/** Maximum randomness in workspace units for bumping a block. */\nconst BUMP_RANDOMNESS = 10;\n\n/**\n * Class for a connection between blocks that may be rendered on screen.\n */\nexport class RenderedConnection extends Connection {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  sourceBlock_!: BlockSvg;\n  private readonly db: ConnectionDB;\n  private readonly dbOpposite: ConnectionDB;\n  private readonly offsetInBlock: Coordinate;\n  private trackedState: TrackedState;\n  private highlighted: boolean = false;\n\n  /** Connection this connection connects to.  Null if not connected. */\n  override targetConnection: RenderedConnection | null = null;\n\n  /**\n   * @param source The block establishing this connection.\n   * @param type The type of the connection.\n   */\n  constructor(source: BlockSvg, type: number) {\n    super(source, type);\n\n    /**\n     * Connection database for connections of this type on the current\n     * workspace.\n     */\n    this.db = source.workspace.connectionDBList[type];\n\n    /**\n     * Connection database for connections compatible with this type on the\n     * current workspace.\n     */\n    this.dbOpposite =\n      source.workspace.connectionDBList[internalConstants.OPPOSITE_TYPE[type]];\n\n    /** Workspace units, (0, 0) is top left of block. */\n    this.offsetInBlock = new Coordinate(0, 0);\n\n    /** Describes the state of this connection's tracked-ness. */\n    this.trackedState = RenderedConnection.TrackedState.WILL_TRACK;\n  }\n\n  /**\n   * Dispose of this connection. Remove it from the database (if it is\n   * tracked) and call the super-function to deal with connected blocks.\n   *\n   * @internal\n   */\n  override dispose() {\n    super.dispose();\n    if (this.trackedState === RenderedConnection.TrackedState.TRACKED) {\n      this.db.removeConnection(this, this.y);\n    }\n    this.sourceBlock_.pathObject.removeConnectionHighlight?.(this);\n  }\n\n  /**\n   * Get the source block for this connection.\n   *\n   * @returns The source block.\n   */\n  override getSourceBlock(): BlockSvg {\n    return super.getSourceBlock() as BlockSvg;\n  }\n\n  /**\n   * Returns the block that this connection connects to.\n   *\n   * @returns The connected block or null if none is connected.\n   */\n  override targetBlock(): BlockSvg | null {\n    return super.targetBlock() as BlockSvg;\n  }\n\n  /**\n   * Returns the distance between this connection and another connection in\n   * workspace units.\n   *\n   * @param otherConnection The other connection to measure the distance to.\n   * @returns The distance between connections, in workspace units.\n   */\n  distanceFrom(otherConnection: Connection): number {\n    const xDiff = this.x - otherConnection.x;\n    const yDiff = this.y - otherConnection.y;\n    return Math.sqrt(xDiff * xDiff + yDiff * yDiff);\n  }\n\n  /**\n   * Move the block(s) belonging to the connection to a point where they don't\n   * visually interfere with the specified connection.\n   *\n   * @param staticConnection The connection to move away from.\n   * @internal\n   */\n  bumpAwayFrom(staticConnection: RenderedConnection) {\n    if (this.sourceBlock_.workspace.isDragging()) {\n      // Don't move blocks around while the user is doing the same.\n      return;\n    }\n    // Move the root block.\n    let rootBlock = this.sourceBlock_.getRootBlock();\n    if (rootBlock.isInFlyout) {\n      // Don't move blocks around in a flyout.\n      return;\n    }\n    let reverse = false;\n    if (!rootBlock.isMovable()) {\n      // Can't bump an uneditable block away.\n      // Check to see if the other block is movable.\n      rootBlock = staticConnection.getSourceBlock().getRootBlock();\n      if (!rootBlock.isMovable()) {\n        return;\n      }\n      // Swap the connections and move the 'static' connection instead.\n      /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n      staticConnection = this;\n      reverse = true;\n    }\n    // Raise it to the top for extra visibility.\n    const selected = common.getSelected() == rootBlock;\n    selected || rootBlock.addSelect();\n    let dx =\n      staticConnection.x +\n      config.snapRadius +\n      Math.floor(Math.random() * BUMP_RANDOMNESS) -\n      this.x;\n    let dy =\n      staticConnection.y +\n      config.snapRadius +\n      Math.floor(Math.random() * BUMP_RANDOMNESS) -\n      this.y;\n    if (reverse) {\n      // When reversing a bump due to an uneditable block, bump up.\n      dy = -dy;\n    }\n    if (rootBlock.RTL) {\n      dx =\n        staticConnection.x -\n        config.snapRadius -\n        Math.floor(Math.random() * BUMP_RANDOMNESS) -\n        this.x;\n    }\n    rootBlock.moveBy(dx, dy, ['bump']);\n    selected || rootBlock.removeSelect();\n  }\n\n  /**\n   * Change the connection's coordinates.\n   *\n   * @param x New absolute x coordinate, in workspace coordinates.\n   * @param y New absolute y coordinate, in workspace coordinates.\n   * @returns True if the position of the connection in the connection db\n   *     was updated.\n   */\n  moveTo(x: number, y: number): boolean {\n    // TODO(#6922): Readd this optimization.\n    // const moved = this.x !== x || this.y !== y;\n    const moved = true;\n    let updated = false;\n\n    if (this.trackedState === RenderedConnection.TrackedState.WILL_TRACK) {\n      this.db.addConnection(this, y);\n      this.trackedState = RenderedConnection.TrackedState.TRACKED;\n      updated = true;\n    } else if (\n      this.trackedState === RenderedConnection.TrackedState.TRACKED &&\n      moved\n    ) {\n      this.db.removeConnection(this, this.y);\n      this.db.addConnection(this, y);\n      updated = true;\n    }\n\n    this.x = x;\n    this.y = y;\n\n    return updated;\n  }\n\n  /**\n   * Change the connection's coordinates.\n   *\n   * @param dx Change to x coordinate, in workspace units.\n   * @param dy Change to y coordinate, in workspace units.\n   * @returns True if the position of the connection in the connection db\n   *     was updated.\n   */\n  moveBy(dx: number, dy: number): boolean {\n    return this.moveTo(this.x + dx, this.y + dy);\n  }\n\n  /**\n   * Move this connection to the location given by its offset within the block\n   * and the location of the block's top left corner.\n   *\n   * @param blockTL The location of the top left corner of the block, in\n   *     workspace coordinates.\n   * @returns True if the position of the connection in the connection db\n   *     was updated.\n   */\n  moveToOffset(blockTL: Coordinate): boolean {\n    return this.moveTo(\n      blockTL.x + this.offsetInBlock.x,\n      blockTL.y + this.offsetInBlock.y,\n    );\n  }\n\n  /**\n   * Set the offset of this connection relative to the top left of its block.\n   *\n   * @param x The new relative x, in workspace units.\n   * @param y The new relative y, in workspace units.\n   */\n  setOffsetInBlock(x: number, y: number) {\n    this.offsetInBlock.x = x;\n    this.offsetInBlock.y = y;\n  }\n\n  /**\n   * Get the offset of this connection relative to the top left of its block.\n   *\n   * @returns The offset of the connection.\n   */\n  getOffsetInBlock(): Coordinate {\n    return this.offsetInBlock;\n  }\n\n  /**\n   * Moves the blocks on either side of this connection right next to\n   * each other, based on their local offsets, not global positions.\n   *\n   * @internal\n   */\n  tightenEfficiently() {\n    const target = this.targetConnection;\n    const block = this.targetBlock();\n    if (!target || !block) return;\n    const offset = Coordinate.difference(\n      this.offsetInBlock,\n      target.offsetInBlock,\n    );\n    block.translate(offset.x, offset.y);\n  }\n\n  /**\n   * Find the closest compatible connection to this connection.\n   * All parameters are in workspace units.\n   *\n   * @param maxLimit The maximum radius to another connection.\n   * @param dxy Offset between this connection's location in the database and\n   *     the current location (as a result of dragging).\n   * @returns Contains two properties: 'connection' which is either another\n   *     connection or null, and 'radius' which is the distance.\n   */\n  closest(\n    maxLimit: number,\n    dxy: Coordinate,\n  ): {connection: RenderedConnection | null; radius: number} {\n    return this.dbOpposite.searchForClosest(this, maxLimit, dxy);\n  }\n\n  /** Add highlighting around this connection. */\n  highlight() {\n    this.highlighted = true;\n    this.getSourceBlock().queueRender();\n  }\n\n  /** Remove the highlighting around this connection. */\n  unhighlight() {\n    this.highlighted = false;\n    this.getSourceBlock().queueRender();\n  }\n\n  /** Returns true if this connection is highlighted, false otherwise. */\n  isHighlighted(): boolean {\n    return this.highlighted;\n  }\n\n  /**\n   * Set whether this connections is tracked in the database or not.\n   *\n   * @param doTracking If true, start tracking. If false, stop tracking.\n   * @internal\n   */\n  setTracking(doTracking: boolean) {\n    if (\n      (doTracking &&\n        this.trackedState === RenderedConnection.TrackedState.TRACKED) ||\n      (!doTracking &&\n        this.trackedState === RenderedConnection.TrackedState.UNTRACKED)\n    ) {\n      return;\n    }\n    if (this.sourceBlock_.isInFlyout) {\n      // Don't bother maintaining a database of connections in a flyout.\n      return;\n    }\n    if (doTracking) {\n      this.db.addConnection(this, this.y);\n      this.trackedState = RenderedConnection.TrackedState.TRACKED;\n      return;\n    }\n    if (this.trackedState === RenderedConnection.TrackedState.TRACKED) {\n      this.db.removeConnection(this, this.y);\n    }\n    this.trackedState = RenderedConnection.TrackedState.UNTRACKED;\n  }\n\n  /**\n   * Stop tracking this connection, as well as all down-stream connections on\n   * any block attached to this connection. This happens when a block is\n   * collapsed.\n   *\n   * Also closes down-stream icons/bubbles.\n   *\n   * @internal\n   */\n  stopTrackingAll() {\n    this.setTracking(false);\n    if (this.targetConnection) {\n      const blocks = this.targetBlock()!.getDescendants(false);\n      for (let i = 0; i < blocks.length; i++) {\n        const block = blocks[i];\n        // Stop tracking connections of all children.\n        const connections = block.getConnections_(true);\n        for (let j = 0; j < connections.length; j++) {\n          connections[j].setTracking(false);\n        }\n        // Close all bubbles of all children.\n        for (const icon of block.getIcons()) {\n          if (hasBubble(icon)) icon.setBubbleVisible(false);\n        }\n      }\n    }\n  }\n\n  /**\n   * Start tracking this connection, as well as all down-stream connections on\n   * any block attached to this connection. This happens when a block is\n   * expanded.\n   *\n   * @returns List of blocks to render.\n   */\n  startTrackingAll(): Block[] {\n    this.setTracking(true);\n    // All blocks that are not tracked must start tracking before any\n    // rendering takes place, since rendering requires knowing the dimensions\n    // of lower blocks. Also, since rendering a block renders all its parents,\n    // we only need to render the leaf nodes.\n    let renderList: Block[] = [];\n    if (\n      this.type !== ConnectionType.INPUT_VALUE &&\n      this.type !== ConnectionType.NEXT_STATEMENT\n    ) {\n      // Only spider down.\n      return renderList;\n    }\n    const block = this.targetBlock();\n    if (block) {\n      let connections;\n      if (block.isCollapsed()) {\n        // This block should only be partially revealed since it is collapsed.\n        connections = [];\n        block.outputConnection && connections.push(block.outputConnection);\n        block.nextConnection && connections.push(block.nextConnection);\n        block.previousConnection && connections.push(block.previousConnection);\n      } else {\n        // Show all connections of this block.\n        connections = block.getConnections_(true);\n      }\n      for (let i = 0; i < connections.length; i++) {\n        renderList.push(...connections[i].startTrackingAll());\n      }\n      if (!renderList.length) {\n        // Leaf block.\n        renderList = [block];\n      }\n    }\n    return renderList;\n  }\n\n  /**\n   * Behaviour after a connection attempt fails.\n   * Bumps this connection away from the other connection. Called when an\n   * attempted connection fails.\n   *\n   * @param otherConnection Connection that this connection failed to connect\n   *     to.\n   * @internal\n   */\n  override onFailedConnect(otherConnection: Connection) {\n    const block = this.getSourceBlock();\n    if (eventUtils.getRecordUndo()) {\n      const group = eventUtils.getGroup();\n      setTimeout(\n        function (this: RenderedConnection) {\n          if (!block.isDisposed() && !block.getParent()) {\n            eventUtils.setGroup(group);\n            this.bumpAwayFrom(otherConnection as RenderedConnection);\n            eventUtils.setGroup(false);\n          }\n        }.bind(this),\n        config.bumpDelay,\n      );\n    }\n  }\n\n  /**\n   * Disconnect two blocks that are connected by this connection.\n   *\n   * @param setParent Whether to set the parent of the disconnected block or\n   *     not, defaults to true.\n   *     If you do not set the parent, ensure that a subsequent action does,\n   *     otherwise the view and model will be out of sync.\n   */\n  override disconnectInternal(setParent = true) {\n    const {parentConnection, childConnection} =\n      this.getParentAndChildConnections();\n    if (!parentConnection || !childConnection) return;\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) eventUtils.setGroup(true);\n\n    const parent = parentConnection.getSourceBlock() as BlockSvg;\n    const child = childConnection.getSourceBlock() as BlockSvg;\n    super.disconnectInternal(setParent);\n\n    parent.queueRender();\n    child.updateDisabled();\n    child.queueRender();\n    // Reset visibility, since the child is now a top block.\n    child.getSvgRoot().style.display = 'block';\n\n    eventUtils.setGroup(existingGroup);\n  }\n\n  /**\n   * Respawn the shadow block if there was one connected to the this connection.\n   * Render/rerender blocks as needed.\n   */\n  protected override respawnShadow_() {\n    super.respawnShadow_();\n    const blockShadow = this.targetBlock();\n    if (!blockShadow) {\n      return;\n    }\n    blockShadow.initSvg();\n    blockShadow.queueRender();\n  }\n\n  /**\n   * Find all nearby compatible connections to this connection.\n   * Type checking does not apply, since this function is used for bumping.\n   *\n   * @param maxLimit The maximum radius to another connection, in workspace\n   *     units.\n   * @returns List of connections.\n   * @internal\n   */\n  override neighbours(maxLimit: number): RenderedConnection[] {\n    return this.dbOpposite.getNeighbours(this, maxLimit);\n  }\n\n  /**\n   * Connect two connections together.  This is the connection on the superior\n   * block.  Rerender blocks as needed.\n   *\n   * @param childConnection Connection on inferior block.\n   */\n  protected override connect_(childConnection: Connection) {\n    super.connect_(childConnection);\n\n    const renderedChildConnection = childConnection as RenderedConnection;\n\n    const parentBlock = this.getSourceBlock();\n    const childBlock = renderedChildConnection.getSourceBlock();\n\n    parentBlock.updateDisabled();\n    childBlock.updateDisabled();\n    childBlock.queueRender();\n\n    // The input the child block is connected to (if any).\n    const parentInput = parentBlock.getInputWithBlock(childBlock);\n    if (parentInput) {\n      const visible = parentInput.isVisible();\n      childBlock.getSvgRoot().style.display = visible ? 'block' : 'none';\n    }\n  }\n\n  /**\n   * Function to be called when this connection's compatible types have changed.\n   */\n  protected override onCheckChanged_() {\n    // The new value type may not be compatible with the existing connection.\n    if (\n      this.isConnected() &&\n      (!this.targetConnection ||\n        !this.getConnectionChecker().canConnect(\n          this,\n          this.targetConnection,\n          false,\n        ))\n    ) {\n      const child = this.isSuperior() ? this.targetBlock() : this.sourceBlock_;\n      child!.unplug();\n    }\n  }\n\n  /**\n   * Change a connection's compatibility.\n   * Rerender blocks as needed.\n   *\n   * @param check Compatible value type or list of value types. Null if all\n   *     types are compatible.\n   * @returns The connection being modified (to allow chaining).\n   */\n  override setCheck(check: string | string[] | null): RenderedConnection {\n    super.setCheck(check);\n    this.sourceBlock_.queueRender();\n    return this;\n  }\n}\n\nexport namespace RenderedConnection {\n  /**\n   * Enum for different kinds of tracked states.\n   *\n   * WILL_TRACK means that this connection will add itself to\n   * the db on the next moveTo call it receives.\n   *\n   * UNTRACKED means that this connection will not add\n   * itself to the database until setTracking(true) is explicitly called.\n   *\n   * TRACKED means that this connection is currently being tracked.\n   */\n  export enum TrackedState {\n    WILL_TRACK = -1,\n    UNTRACKED = 0,\n    TRACKED = 1,\n  }\n}\n\nexport type TrackedState = RenderedConnection.TrackedState;\nexport const TrackedState = RenderedConnection.TrackedState;\n","/**\n * @license\n * Copyright 2024 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport {IDragStrategy} from '../interfaces/i_draggable.js';\nimport {Coordinate} from '../utils.js';\nimport * as eventUtils from '../events/utils.js';\nimport {BlockSvg} from '../block_svg.js';\nimport {RenderedConnection} from '../rendered_connection.js';\nimport * as dom from '../utils/dom.js';\nimport * as blockAnimation from '../block_animations.js';\nimport {ConnectionType} from '../connection_type.js';\nimport * as bumpObjects from '../bump_objects.js';\nimport * as registry from '../registry.js';\nimport {IConnectionPreviewer} from '../interfaces/i_connection_previewer.js';\nimport {Connection} from '../connection.js';\nimport type {Block} from '../block.js';\nimport {config} from '../config.js';\nimport type {BlockMove} from '../events/events_block_move.js';\nimport {finishQueuedRenders} from '../render_management.js';\nimport * as layers from '../layers.js';\n\n/** Represents a nearby valid connection. */\ninterface ConnectionCandidate {\n  /** A connection on the dragging stack that is compatible with neighbour. */\n  local: RenderedConnection;\n\n  /** A nearby connection that is compatible with local. */\n  neighbour: RenderedConnection;\n\n  /** The distance between the local connection and the neighbour connection. */\n  distance: number;\n}\n\nexport class BlockDragStrategy implements IDragStrategy {\n  private workspace: WorkspaceSvg;\n\n  /** The parent block at the start of the drag. */\n  private startParentConn: RenderedConnection | null = null;\n\n  /**\n   * The child block at the start of the drag. Only gets set if\n   * `healStack` is true.\n   */\n  private startChildConn: RenderedConnection | null = null;\n\n  private startLoc: Coordinate | null = null;\n\n  private connectionCandidate: ConnectionCandidate | null = null;\n\n  private connectionPreviewer: IConnectionPreviewer | null = null;\n\n  private dragging = false;\n\n  /**\n   * If this is a shadow block, the offset between this block and the parent\n   * block, to add to the drag location. In workspace units.\n   */\n  private dragOffset = new Coordinate(0, 0);\n\n  constructor(private block: BlockSvg) {\n    this.workspace = block.workspace;\n  }\n\n  /** Returns true if the block is currently movable. False otherwise. */\n  isMovable(): boolean {\n    if (this.block.isShadow()) {\n      return this.block.getParent()?.isMovable() ?? false;\n    }\n\n    return (\n      this.block.isOwnMovable() &&\n      !this.block.isDeadOrDying() &&\n      !this.workspace.options.readOnly &&\n      // We never drag blocks in the flyout, only create new blocks that are\n      // dragged.\n      !this.block.isInFlyout\n    );\n  }\n\n  /**\n   * Handles any setup for starting the drag, including disconnecting the block\n   * from any parent blocks.\n   */\n  startDrag(e?: PointerEvent): void {\n    if (this.block.isShadow()) {\n      this.startDraggingShadow(e);\n      return;\n    }\n\n    this.dragging = true;\n    if (!eventUtils.getGroup()) {\n      eventUtils.setGroup(true);\n    }\n    this.fireDragStartEvent();\n\n    this.startLoc = this.block.getRelativeToSurfaceXY();\n\n    this.connectionCandidate = null;\n    const previewerConstructor = registry.getClassFromOptions(\n      registry.Type.CONNECTION_PREVIEWER,\n      this.workspace.options,\n    );\n    this.connectionPreviewer = new previewerConstructor!(this.block);\n\n    // During a drag there may be a lot of rerenders, but not field changes.\n    // Turn the cache on so we don't do spurious remeasures during the drag.\n    dom.startTextWidthCache();\n    this.workspace.setResizesEnabled(false);\n    blockAnimation.disconnectUiStop();\n\n    const healStack = !!e && (e.altKey || e.ctrlKey || e.metaKey);\n\n    if (this.shouldDisconnect(healStack)) {\n      this.disconnectBlock(healStack);\n    }\n    this.block.setDragging(true);\n    this.workspace.getLayerManager()?.moveToDragLayer(this.block);\n  }\n\n  /** Starts a drag on a shadow, recording the drag offset. */\n  private startDraggingShadow(e?: PointerEvent) {\n    const parent = this.block.getParent();\n    if (!parent) {\n      throw new Error(\n        'Tried to drag a shadow block with no parent. ' +\n          'Shadow blocks should always have parents.',\n      );\n    }\n    this.dragOffset = Coordinate.difference(\n      parent.getRelativeToSurfaceXY(),\n      this.block.getRelativeToSurfaceXY(),\n    );\n    parent.startDrag(e);\n  }\n\n  /**\n   * Whether or not we should disconnect the block when a drag is started.\n   *\n   * @param healStack Whether or not to heal the stack after disconnecting.\n   * @returns True to disconnect the block, false otherwise.\n   */\n  private shouldDisconnect(healStack: boolean): boolean {\n    return !!(\n      this.block.getParent() ||\n      (healStack &&\n        this.block.nextConnection &&\n        this.block.nextConnection.targetBlock())\n    );\n  }\n\n  /**\n   * Disconnects the block from any parents. If `healStack` is true and this is\n   * a stack block, we also disconnect from any next blocks and attempt to\n   * attach them to any parent.\n   *\n   * @param healStack Whether or not to heal the stack after disconnecting.\n   */\n  private disconnectBlock(healStack: boolean) {\n    this.startParentConn =\n      this.block.outputConnection?.targetConnection ??\n      this.block.previousConnection?.targetConnection;\n    if (healStack) {\n      this.startChildConn = this.block.nextConnection?.targetConnection;\n    }\n\n    this.block.unplug(healStack);\n    blockAnimation.disconnectUiEffect(this.block);\n  }\n\n  /** Fire a UI event at the start of a block drag. */\n  private fireDragStartEvent() {\n    const event = new (eventUtils.get(eventUtils.BLOCK_DRAG))(\n      this.block,\n      true,\n      this.block.getDescendants(false),\n    );\n    eventUtils.fire(event);\n  }\n\n  /** Fire a UI event at the end of a block drag. */\n  private fireDragEndEvent() {\n    const event = new (eventUtils.get(eventUtils.BLOCK_DRAG))(\n      this.block,\n      false,\n      this.block.getDescendants(false),\n    );\n    eventUtils.fire(event);\n  }\n\n  /** Fire a move event at the end of a block drag. */\n  private fireMoveEvent() {\n    if (this.block.isDeadOrDying()) return;\n    const event = new (eventUtils.get(eventUtils.BLOCK_MOVE))(\n      this.block,\n    ) as BlockMove;\n    event.setReason(['drag']);\n    event.oldCoordinate = this.startLoc!;\n    event.recordNew();\n    eventUtils.fire(event);\n  }\n\n  /** Moves the block and updates any connection previews. */\n  drag(newLoc: Coordinate): void {\n    if (this.block.isShadow()) {\n      this.block.getParent()?.drag(Coordinate.sum(newLoc, this.dragOffset));\n      return;\n    }\n\n    this.block.moveDuringDrag(newLoc);\n    this.updateConnectionPreview(\n      this.block,\n      Coordinate.difference(newLoc, this.startLoc!),\n    );\n  }\n\n  /**\n   * @param draggingBlock The block being dragged.\n   * @param delta How far the pointer has moved from the position\n   *     at the start of the drag, in workspace units.\n   */\n  private updateConnectionPreview(draggingBlock: BlockSvg, delta: Coordinate) {\n    const currCandidate = this.connectionCandidate;\n    const newCandidate = this.getConnectionCandidate(draggingBlock, delta);\n    if (!newCandidate) {\n      this.connectionPreviewer!.hidePreview();\n      this.connectionCandidate = null;\n      return;\n    }\n    const candidate =\n      currCandidate &&\n      this.currCandidateIsBetter(currCandidate, delta, newCandidate)\n        ? currCandidate\n        : newCandidate;\n    this.connectionCandidate = candidate;\n\n    const {local, neighbour} = candidate;\n    const localIsOutputOrPrevious =\n      local.type === ConnectionType.OUTPUT_VALUE ||\n      local.type === ConnectionType.PREVIOUS_STATEMENT;\n    const neighbourIsConnectedToRealBlock =\n      neighbour.isConnected() && !neighbour.targetBlock()!.isInsertionMarker();\n    if (\n      localIsOutputOrPrevious &&\n      neighbourIsConnectedToRealBlock &&\n      !this.orphanCanConnectAtEnd(\n        draggingBlock,\n        neighbour.targetBlock()!,\n        local.type,\n      )\n    ) {\n      this.connectionPreviewer!.previewReplacement(\n        local,\n        neighbour,\n        neighbour.targetBlock()!,\n      );\n      return;\n    }\n    this.connectionPreviewer!.previewConnection(local, neighbour);\n  }\n\n  /**\n   * Returns true if the given orphan block can connect at the end of the\n   * top block's stack or row, false otherwise.\n   */\n  private orphanCanConnectAtEnd(\n    topBlock: BlockSvg,\n    orphanBlock: BlockSvg,\n    localType: number,\n  ): boolean {\n    const orphanConnection =\n      localType === ConnectionType.OUTPUT_VALUE\n        ? orphanBlock.outputConnection\n        : orphanBlock.previousConnection;\n    return !!Connection.getConnectionForOrphanedConnection(\n      topBlock as Block,\n      orphanConnection as Connection,\n    );\n  }\n\n  /**\n   * Returns true if the current candidate is better than the new candidate.\n   *\n   * We slightly prefer the current candidate even if it is farther away.\n   */\n  private currCandidateIsBetter(\n    currCandiate: ConnectionCandidate,\n    delta: Coordinate,\n    newCandidate: ConnectionCandidate,\n  ): boolean {\n    const {local: currLocal, neighbour: currNeighbour} = currCandiate;\n    const localPos = new Coordinate(currLocal.x, currLocal.y);\n    const neighbourPos = new Coordinate(currNeighbour.x, currNeighbour.y);\n    const currDistance = Coordinate.distance(\n      Coordinate.sum(localPos, delta),\n      neighbourPos,\n    );\n    return (\n      newCandidate.distance > currDistance - config.currentConnectionPreference\n    );\n  }\n\n  /**\n   * Returns the closest valid candidate connection, if one can be found.\n   *\n   * Valid neighbour connections are within the configured start radius, with a\n   * compatible type (input, output, etc) and connection check.\n   */\n  private getConnectionCandidate(\n    draggingBlock: BlockSvg,\n    delta: Coordinate,\n  ): ConnectionCandidate | null {\n    const localConns = this.getLocalConnections(draggingBlock);\n    let radius = this.connectionCandidate\n      ? config.connectingSnapRadius\n      : config.snapRadius;\n    let candidate = null;\n\n    for (const conn of localConns) {\n      const {connection: neighbour, radius: rad} = conn.closest(radius, delta);\n      if (neighbour) {\n        candidate = {\n          local: conn,\n          neighbour: neighbour,\n          distance: rad,\n        };\n        radius = rad;\n      }\n    }\n\n    return candidate;\n  }\n\n  /**\n   * Returns all of the connections we might connect to blocks on the workspace.\n   *\n   * Includes any connections on the dragging block, and any last next\n   * connection on the stack (if one exists).\n   */\n  private getLocalConnections(draggingBlock: BlockSvg): RenderedConnection[] {\n    const available = draggingBlock.getConnections_(false);\n    const lastOnStack = draggingBlock.lastConnectionInStack(true);\n    if (lastOnStack && lastOnStack !== draggingBlock.nextConnection) {\n      available.push(lastOnStack);\n    }\n    return available;\n  }\n\n  /**\n   * Cleans up any state at the end of the drag. Applies any pending\n   * connections.\n   */\n  endDrag(e?: PointerEvent): void {\n    if (this.block.isShadow()) {\n      this.block.getParent()?.endDrag(e);\n      return;\n    }\n\n    this.fireDragEndEvent();\n    this.fireMoveEvent();\n\n    dom.stopTextWidthCache();\n\n    blockAnimation.disconnectUiStop();\n    this.connectionPreviewer!.hidePreview();\n\n    if (!this.block.isDeadOrDying() && this.dragging) {\n      // These are expensive and don't need to be done if we're deleting, or\n      // if we've already stopped dragging because we moved back to the start.\n      this.workspace\n        .getLayerManager()\n        ?.moveOffDragLayer(this.block, layers.BLOCK);\n      this.block.setDragging(false);\n    }\n\n    if (this.connectionCandidate) {\n      // Applying connections also rerenders the relevant blocks.\n      this.applyConnections(this.connectionCandidate);\n    } else {\n      this.block.queueRender();\n    }\n    this.block.snapToGrid();\n\n    // Must dispose after connections are applied to not break the dynamic\n    // connections plugin. See #7859\n    this.connectionPreviewer!.dispose();\n    this.workspace.setResizesEnabled(true);\n\n    eventUtils.setGroup(false);\n  }\n\n  /** Connects the given candidate connections. */\n  private applyConnections(candidate: ConnectionCandidate) {\n    const {local, neighbour} = candidate;\n    local.connect(neighbour);\n\n    const inferiorConnection = local.isSuperior() ? neighbour : local;\n    const rootBlock = this.block.getRootBlock();\n\n    finishQueuedRenders().then(() => {\n      blockAnimation.connectionUiEffect(inferiorConnection.getSourceBlock());\n      // bringToFront is incredibly expensive. Delay until the next frame.\n      setTimeout(() => {\n        rootBlock.bringToFront();\n      }, 0);\n    });\n  }\n\n  /**\n   * Moves the block back to where it was at the beginning of the drag,\n   * including reconnecting connections.\n   */\n  revertDrag(): void {\n    if (this.block.isShadow()) {\n      this.block.getParent()?.revertDrag();\n      return;\n    }\n\n    this.startChildConn?.connect(this.block.nextConnection);\n    if (this.startParentConn) {\n      switch (this.startParentConn.type) {\n        case ConnectionType.INPUT_VALUE:\n          this.startParentConn.connect(this.block.outputConnection);\n          break;\n        case ConnectionType.NEXT_STATEMENT:\n          this.startParentConn.connect(this.block.previousConnection);\n      }\n    } else {\n      this.block.moveTo(this.startLoc!, ['drag']);\n      this.workspace\n        .getLayerManager()\n        ?.moveOffDragLayer(this.block, layers.BLOCK);\n      // Blocks dragged directly from a flyout may need to be bumped into\n      // bounds.\n      bumpObjects.bumpIntoBounds(\n        this.workspace,\n        this.workspace.getMetricsManager().getScrollMetrics(true),\n        this.block,\n      );\n    }\n\n    this.startChildConn = null;\n    this.startParentConn = null;\n\n    this.connectionPreviewer!.hidePreview();\n    this.connectionCandidate = null;\n\n    this.block.setDragging(false);\n    this.dragging = false;\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for graphically rendering a block as SVG.\n *\n * @class\n */\n// Former goog.module ID: Blockly.BlockSvg\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_selected.js';\n\nimport {Block} from './block.js';\nimport * as blockAnimations from './block_animations.js';\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\nimport {config} from './config.js';\nimport type {Connection} from './connection.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as constants from './constants.js';\nimport * as ContextMenu from './contextmenu.js';\nimport {\n  ContextMenuOption,\n  ContextMenuRegistry,\n  LegacyContextMenuOption,\n} from './contextmenu_registry.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport * as deprecation from './utils/deprecation.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Field} from './field.js';\nimport {FieldLabel} from './field_label.js';\nimport type {Input} from './inputs/input.js';\nimport type {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport type {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport type {ICopyable} from './interfaces/i_copyable.js';\nimport type {IDragStrategy, IDraggable} from './interfaces/i_draggable.js';\nimport {IIcon} from './interfaces/i_icon.js';\nimport * as internalConstants from './internal_constants.js';\nimport {ASTNode} from './keyboard_nav/ast_node.js';\nimport {TabNavigateCursor} from './keyboard_nav/tab_navigate_cursor.js';\nimport {MarkerManager} from './marker_manager.js';\nimport {Msg} from './msg.js';\nimport {MutatorIcon} from './icons/mutator_icon.js';\nimport {RenderedConnection} from './rendered_connection.js';\nimport type {IPathObject} from './renderers/common/i_path_object.js';\nimport * as blocks from './serialization/blocks.js';\nimport type {BlockStyle} from './theme.js';\nimport * as Tooltip from './tooltip.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport {WarningIcon} from './icons/warning_icon.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as renderManagement from './render_management.js';\nimport {IconType} from './icons/icon_types.js';\nimport {BlockCopyData, BlockPaster} from './clipboard/block_paster.js';\nimport {BlockDragStrategy} from './dragging/block_drag_strategy.js';\nimport {IDeletable} from './blockly.js';\nimport {FlyoutItemInfo} from './utils/toolbox.js';\n\n/**\n * Class for a block's SVG representation.\n * Not normally called directly, workspace.newBlock() is preferred.\n */\nexport class BlockSvg\n  extends Block\n  implements\n    IASTNodeLocationSvg,\n    IBoundedElement,\n    ICopyable<BlockCopyData>,\n    IDraggable,\n    IDeletable\n{\n  /**\n   * Constant for identifying rows that are to be rendered inline.\n   * Don't collide with Blockly.inputTypes.\n   */\n  static readonly INLINE = -1;\n\n  /**\n   * ID to give the \"collapsed warnings\" warning. Allows us to remove the\n   * \"collapsed warnings\" warning without removing any warnings that belong to\n   * the block.\n   */\n  static readonly COLLAPSED_WARNING_ID = 'TEMP_COLLAPSED_WARNING_';\n  override decompose?: (p1: Workspace) => BlockSvg;\n  // override compose?: ((p1: BlockSvg) => void)|null;\n  saveConnections?: (p1: BlockSvg) => void;\n  customContextMenu?: (\n    p1: Array<ContextMenuOption | LegacyContextMenuOption>,\n  ) => void;\n\n  /**\n   * Height of this block, not including any statement blocks above or below.\n   * Height is in workspace units.\n   */\n  height = 0;\n\n  /**\n   * Width of this block, including any connected value blocks.\n   * Width is in workspace units.\n   */\n  width = 0;\n\n  /**\n   * Map from IDs for warnings text to PIDs of functions to apply them.\n   * Used to be able to maintain multiple warnings.\n   */\n  private warningTextDb = new Map<string, ReturnType<typeof setTimeout>>();\n\n  /** Block's mutator icon (if any). */\n  mutator: MutatorIcon | null = null;\n\n  private svgGroup_: SVGGElement;\n  style: BlockStyle;\n  /** @internal */\n  pathObject: IPathObject;\n\n  /** Is this block a BlockSVG? */\n  override readonly rendered = true;\n\n  private visuallyDisabled = false;\n\n  /**\n   * Is this block currently rendering? Used to stop recursive render calls\n   * from actually triggering a re-render.\n   */\n  private renderIsInProgress_ = false;\n\n  /** Whether mousedown events have been bound yet. */\n  private eventsInit_ = false;\n\n  override workspace: WorkspaceSvg;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override outputConnection!: RenderedConnection;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override nextConnection!: RenderedConnection;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override previousConnection!: RenderedConnection;\n\n  private translation = '';\n\n  /** Whether this block is currently being dragged. */\n  private dragging = false;\n\n  /**\n   * The location of the top left of this block (in workspace coordinates)\n   * relative to either its parent block, or the workspace origin if it has no\n   * parent.\n   *\n   * @internal\n   */\n  relativeCoords = new Coordinate(0, 0);\n\n  private dragStrategy: IDragStrategy = new BlockDragStrategy(this);\n\n  /**\n   * @param workspace The block's workspace.\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   */\n  constructor(workspace: WorkspaceSvg, prototypeName: string, opt_id?: string) {\n    super(workspace, prototypeName, opt_id);\n    if (!workspace.rendered) {\n      throw TypeError('Cannot create a rendered block in a headless workspace');\n    }\n    this.workspace = workspace;\n    this.svgGroup_ = dom.createSvgElement(Svg.G, {});\n\n    /** A block style object. */\n    this.style = workspace.getRenderer().getConstants().getBlockStyle(null);\n\n    /** The renderer's path object. */\n    this.pathObject = workspace\n      .getRenderer()\n      .makePathObject(this.svgGroup_, this.style);\n\n    const svgPath = this.pathObject.svgPath;\n    (svgPath as any).tooltip = this;\n    Tooltip.bindMouseEvents(svgPath);\n\n    // Expose this block's ID on its top-level SVG group.\n    this.svgGroup_.setAttribute('data-id', this.id);\n\n    this.doInit_();\n  }\n\n  /**\n   * Create and initialize the SVG representation of the block.\n   * May be called more than once.\n   */\n  initSvg() {\n    if (this.initialized) return;\n    for (const input of this.inputList) {\n      input.init();\n    }\n    for (const icon of this.getIcons()) {\n      icon.initView(this.createIconPointerDownListener(icon));\n      icon.updateEditable();\n    }\n    this.applyColour();\n    this.pathObject.updateMovable(this.isMovable() || this.isInFlyout);\n    const svg = this.getSvgRoot();\n    if (!this.workspace.options.readOnly && svg) {\n      browserEvents.conditionalBind(\n        svg,\n        'pointerdown',\n        this,\n        this.onMouseDown_,\n      );\n    }\n\n    if (!svg.parentNode) {\n      this.workspace.getCanvas().appendChild(svg);\n    }\n    this.initialized = true;\n  }\n\n  /**\n   * Get the secondary colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  getColourSecondary(): string | undefined {\n    return this.style.colourSecondary;\n  }\n\n  /**\n   * Get the tertiary colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  getColourTertiary(): string | undefined {\n    return this.style.colourTertiary;\n  }\n\n  /** Selects this block. Highlights the block visually. */\n  select() {\n    if (this.isShadow()) {\n      this.getParent()?.select();\n      return;\n    }\n    this.addSelect();\n  }\n\n  /** Unselects this block. Unhighlights the blockv visually.   */\n  unselect() {\n    if (this.isShadow()) {\n      this.getParent()?.unselect();\n      return;\n    }\n    this.removeSelect();\n  }\n\n  /**\n   * Sets the parent of this block to be a new block or null.\n   *\n   * @param newParent New parent block.\n   * @internal\n   */\n  override setParent(newParent: this | null) {\n    const oldParent = this.parentBlock_;\n    if (newParent === oldParent) {\n      return;\n    }\n\n    dom.startTextWidthCache();\n    super.setParent(newParent);\n    dom.stopTextWidthCache();\n\n    const svgRoot = this.getSvgRoot();\n\n    // Bail early if workspace is clearing, or we aren't rendered.\n    // We won't need to reattach ourselves anywhere.\n    if (this.workspace.isClearing || !svgRoot) {\n      return;\n    }\n\n    const oldXY = this.getRelativeToSurfaceXY();\n    if (newParent) {\n      (newParent as BlockSvg).getSvgRoot().appendChild(svgRoot);\n    } else if (oldParent) {\n      // If we are losing a parent, we want to move our DOM element to the\n      // root of the workspace.\n      const draggingBlock = this.workspace\n        .getCanvas()\n        .querySelector('.blocklyDragging');\n      if (draggingBlock) {\n        this.workspace.getCanvas().insertBefore(svgRoot, draggingBlock);\n      } else {\n        this.workspace.getCanvas().appendChild(svgRoot);\n      }\n      this.translate(oldXY.x, oldXY.y);\n    }\n\n    this.applyColour();\n  }\n\n  /**\n   * Return the coordinates of the top-left corner of this block relative to the\n   * drawing surface's origin (0,0), in workspace units.\n   * If the block is on the workspace, (0, 0) is the origin of the workspace\n   * coordinate system.\n   * This does not change with workspace scale.\n   *\n   * @returns Object with .x and .y properties in workspace coordinates.\n   */\n  override getRelativeToSurfaceXY(): Coordinate {\n    const layerManger = this.workspace.getLayerManager();\n    if (!layerManger) {\n      throw new Error(\n        'Cannot calculate position because the workspace has not been appended',\n      );\n    }\n    let x = 0;\n    let y = 0;\n\n    let element: SVGElement = this.getSvgRoot();\n    if (element) {\n      do {\n        // Loop through this block and every parent.\n        const xy = svgMath.getRelativeXY(element);\n        x += xy.x;\n        y += xy.y;\n        element = element.parentNode as SVGElement;\n      } while (element && !layerManger.hasLayer(element));\n    }\n    return new Coordinate(x, y);\n  }\n\n  /**\n   * Move a block by a relative offset.\n   *\n   * @param dx Horizontal offset in workspace units.\n   * @param dy Vertical offset in workspace units.\n   * @param reason Why is this move happening?  'drag', 'bump', 'snap', ...\n   */\n  override moveBy(dx: number, dy: number, reason?: string[]) {\n    if (this.parentBlock_) {\n      throw Error('Block has parent');\n    }\n    const eventsEnabled = eventUtils.isEnabled();\n    let event: BlockMove | null = null;\n    if (eventsEnabled) {\n      event = new (eventUtils.get(eventUtils.BLOCK_MOVE)!)(this) as BlockMove;\n      reason && event.setReason(reason);\n    }\n\n    const delta = new Coordinate(dx, dy);\n    const currLoc = this.getRelativeToSurfaceXY();\n    const newLoc = Coordinate.sum(currLoc, delta);\n    this.translate(newLoc.x, newLoc.y);\n    this.updateComponentLocations(newLoc);\n\n    if (eventsEnabled && event) {\n      event!.recordNew();\n      eventUtils.fire(event);\n    }\n    this.workspace.resizeContents();\n  }\n\n  /**\n   * Transforms a block by setting the translation on the transform attribute\n   * of the block's SVG.\n   *\n   * @param x The x coordinate of the translation in workspace units.\n   * @param y The y coordinate of the translation in workspace units.\n   */\n  translate(x: number, y: number) {\n    this.translation = `translate(${x}, ${y})`;\n    this.relativeCoords = new Coordinate(x, y);\n    this.getSvgRoot().setAttribute('transform', this.getTranslation());\n  }\n\n  /**\n   * Returns the SVG translation of this block.\n   *\n   * @internal\n   */\n  getTranslation(): string {\n    return this.translation;\n  }\n\n  /**\n   * Move a block to a position.\n   *\n   * @param xy The position to move to in workspace units.\n   * @param reason Why is this move happening?  'drag', 'bump', 'snap', ...\n   */\n  moveTo(xy: Coordinate, reason?: string[]) {\n    const curXY = this.getRelativeToSurfaceXY();\n    this.moveBy(xy.x - curXY.x, xy.y - curXY.y, reason);\n  }\n\n  /**\n   * Move this block during a drag.\n   * This block must be a top-level block.\n   *\n   * @param newLoc The location to translate to, in workspace coordinates.\n   * @internal\n   */\n  moveDuringDrag(newLoc: Coordinate) {\n    this.translate(newLoc.x, newLoc.y);\n    this.getSvgRoot().setAttribute('transform', this.getTranslation());\n    this.updateComponentLocations(newLoc);\n  }\n\n  /** Snap this block to the nearest grid point. */\n  snapToGrid() {\n    if (this.isDeadOrDying()) return;\n    if (this.getParent()) return;\n    if (this.isInFlyout) return;\n    const grid = this.workspace.getGrid();\n    if (!grid?.shouldSnap()) return;\n    const currentXY = this.getRelativeToSurfaceXY();\n    const alignedXY = grid.alignXY(currentXY);\n    if (alignedXY !== currentXY) {\n      this.moveTo(alignedXY, ['snap']);\n    }\n  }\n\n  /**\n   * Returns the coordinates of a bounding box describing the dimensions of this\n   * block and any blocks stacked below it.\n   * Coordinate system: workspace coordinates.\n   *\n   * @returns Object with coordinates of the bounding box.\n   */\n  getBoundingRectangle(): Rect {\n    const blockXY = this.getRelativeToSurfaceXY();\n    const blockBounds = this.getHeightWidth();\n    let left;\n    let right;\n    if (this.RTL) {\n      left = blockXY.x - blockBounds.width;\n      right = blockXY.x;\n    } else {\n      left = blockXY.x;\n      right = blockXY.x + blockBounds.width;\n    }\n    return new Rect(blockXY.y, blockXY.y + blockBounds.height, left, right);\n  }\n\n  /**\n   * Notify every input on this block to mark its fields as dirty.\n   * A dirty field is a field that needs to be re-rendered.\n   */\n  markDirty() {\n    this.pathObject.constants = this.workspace.getRenderer().getConstants();\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      input.markDirty();\n    }\n  }\n\n  /**\n   * Set whether the block is collapsed or not.\n   *\n   * @param collapsed True if collapsed.\n   */\n  override setCollapsed(collapsed: boolean) {\n    if (this.collapsed_ === collapsed) {\n      return;\n    }\n    super.setCollapsed(collapsed);\n    this.updateCollapsed_();\n  }\n\n  /**\n   * Makes sure that when the block is collapsed, it is rendered correctly\n   * for that state.\n   */\n  private updateCollapsed_() {\n    const collapsed = this.isCollapsed();\n    const collapsedInputName = constants.COLLAPSED_INPUT_NAME;\n    const collapsedFieldName = constants.COLLAPSED_FIELD_NAME;\n\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.name !== collapsedInputName) {\n        input.setVisible(!collapsed);\n      }\n    }\n\n    for (const icon of this.getIcons()) {\n      icon.updateCollapsed();\n    }\n\n    if (!collapsed) {\n      this.updateDisabled();\n      this.removeInput(collapsedInputName);\n      return;\n    }\n\n    const text = this.toString(internalConstants.COLLAPSE_CHARS);\n    const field = this.getField(collapsedFieldName);\n    if (field) {\n      field.setValue(text);\n      return;\n    }\n    const input =\n      this.getInput(collapsedInputName) ||\n      this.appendDummyInput(collapsedInputName);\n    input.appendField(new FieldLabel(text), collapsedFieldName);\n  }\n\n  /**\n   * Open the next (or previous) FieldTextInput.\n   *\n   * @param start Current field.\n   * @param forward If true go forward, otherwise backward.\n   */\n  tab(start: Field, forward: boolean) {\n    const tabCursor = new TabNavigateCursor();\n    tabCursor.setCurNode(ASTNode.createFieldNode(start)!);\n    const currentNode = tabCursor.getCurNode();\n\n    if (forward) {\n      tabCursor.next();\n    } else {\n      tabCursor.prev();\n    }\n\n    const nextNode = tabCursor.getCurNode();\n    if (nextNode && nextNode !== currentNode) {\n      const nextField = nextNode.getLocation() as Field;\n      nextField.showEditor();\n\n      // Also move the cursor if we're in keyboard nav mode.\n      if (this.workspace.keyboardAccessibilityMode) {\n        this.workspace.getCursor()!.setCurNode(nextNode);\n      }\n    }\n  }\n\n  /**\n   * Handle a pointerdown on an SVG block.\n   *\n   * @param e Pointer down event.\n   */\n  private onMouseDown_(e: PointerEvent) {\n    const gesture = this.workspace.getGesture(e);\n    if (gesture) {\n      gesture.handleBlockStart(e, this);\n    }\n  }\n\n  /**\n   * Load the block's help page in a new window.\n   *\n   * @internal\n   */\n  showHelp() {\n    const url =\n      typeof this.helpUrl === 'function' ? this.helpUrl() : this.helpUrl;\n    if (url) {\n      window.open(url);\n    }\n  }\n\n  /**\n   * Generate the context menu for this block.\n   *\n   * @returns Context menu options or null if no menu.\n   */\n  protected generateContextMenu(): Array<\n    ContextMenuOption | LegacyContextMenuOption\n  > | null {\n    if (this.workspace.options.readOnly || !this.contextMenu) {\n      return null;\n    }\n    const menuOptions = ContextMenuRegistry.registry.getContextMenuOptions(\n      ContextMenuRegistry.ScopeType.BLOCK,\n      {block: this},\n    );\n\n    // Allow the block to add or modify menuOptions.\n    if (this.customContextMenu) {\n      this.customContextMenu(menuOptions);\n    }\n\n    return menuOptions;\n  }\n\n  /**\n   * Show the context menu for this block.\n   *\n   * @param e Mouse event.\n   * @internal\n   */\n  showContextMenu(e: PointerEvent) {\n    const menuOptions = this.generateContextMenu();\n\n    if (menuOptions && menuOptions.length) {\n      ContextMenu.show(e, menuOptions, this.RTL, this.workspace);\n      ContextMenu.setCurrentBlock(this);\n    }\n  }\n\n  /**\n   * Updates the locations of any parts of the block that need to know where\n   * they are (e.g. connections, icons).\n   *\n   * @param blockOrigin The top-left of this block in workspace coordinates.\n   * @internal\n   */\n  updateComponentLocations(blockOrigin: Coordinate) {\n    if (!this.dragging) this.updateConnectionLocations(blockOrigin);\n    this.updateIconLocations(blockOrigin);\n    this.updateFieldLocations(blockOrigin);\n\n    for (const child of this.getChildren(false)) {\n      child.updateComponentLocations(\n        Coordinate.sum(blockOrigin, child.relativeCoords),\n      );\n    }\n  }\n\n  private updateConnectionLocations(blockOrigin: Coordinate) {\n    for (const conn of this.getConnections_(false)) {\n      conn.moveToOffset(blockOrigin);\n    }\n  }\n\n  private updateIconLocations(blockOrigin: Coordinate) {\n    for (const icon of this.getIcons()) {\n      icon.onLocationChange(blockOrigin);\n    }\n  }\n\n  private updateFieldLocations(blockOrigin: Coordinate) {\n    for (const input of this.inputList) {\n      for (const field of input.fieldRow) {\n        field.onLocationChange(blockOrigin);\n      }\n    }\n  }\n\n  /**\n   * Recursively adds or removes the dragging class to this node and its\n   * children.\n   *\n   * @param adding True if adding, false if removing.\n   * @internal\n   */\n  setDragging(adding: boolean) {\n    this.dragging = adding;\n    if (adding) {\n      this.translation = '';\n      common.draggingConnections.push(...this.getConnections_(true));\n      dom.addClass(this.svgGroup_, 'blocklyDragging');\n    } else {\n      common.draggingConnections.length = 0;\n      dom.removeClass(this.svgGroup_, 'blocklyDragging');\n    }\n    // Recurse through all blocks attached under this one.\n    for (let i = 0; i < this.childBlocks_.length; i++) {\n      (this.childBlocks_[i] as BlockSvg).setDragging(adding);\n    }\n  }\n\n  /**\n   * Set whether this block is movable or not.\n   *\n   * @param movable True if movable.\n   */\n  override setMovable(movable: boolean) {\n    super.setMovable(movable);\n    this.pathObject.updateMovable(movable);\n  }\n\n  /**\n   * Set whether this block is editable or not.\n   *\n   * @param editable True if editable.\n   */\n  override setEditable(editable: boolean) {\n    super.setEditable(editable);\n    const icons = this.getIcons();\n    for (let i = 0; i < icons.length; i++) {\n      icons[i].updateEditable();\n    }\n  }\n\n  /**\n   * Sets whether this block is a shadow block or not.\n   * This method is internal and should not be called by users of Blockly. To\n   * create shadow blocks programmatically call connection.setShadowState\n   *\n   * @param shadow True if a shadow.\n   * @internal\n   */\n  override setShadow(shadow: boolean) {\n    super.setShadow(shadow);\n    this.applyColour();\n  }\n\n  /**\n   * Set whether this block is an insertion marker block or not.\n   * Once set this cannot be unset.\n   *\n   * @param insertionMarker True if an insertion marker.\n   * @internal\n   */\n  override setInsertionMarker(insertionMarker: boolean) {\n    if (this.isInsertionMarker_ === insertionMarker) {\n      return; // No change.\n    }\n    this.isInsertionMarker_ = insertionMarker;\n    if (this.isInsertionMarker_) {\n      this.setColour(\n        this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR,\n      );\n      this.pathObject.updateInsertionMarker(true);\n    }\n  }\n\n  /**\n   * Return the root node of the SVG or null if none exists.\n   *\n   * @returns The root SVG node (probably a group).\n   */\n  getSvgRoot(): SVGGElement {\n    return this.svgGroup_;\n  }\n\n  /**\n   * Dispose of this block.\n   *\n   * @param healStack If true, then try to heal any gap by connecting the next\n   *     statement with the previous statement.  Otherwise, dispose of all\n   *     children of this block.\n   * @param animate If true, show a disposal animation and sound.\n   */\n  override dispose(healStack?: boolean, animate?: boolean) {\n    this.disposing = true;\n\n    Tooltip.dispose();\n    ContextMenu.hide();\n\n    if (animate) {\n      this.unplug(healStack);\n      blockAnimations.disposeUiEffect(this);\n    }\n\n    super.dispose(!!healStack);\n    dom.removeNode(this.svgGroup_);\n  }\n\n  /**\n   * Disposes of this block without doing things required by the top block.\n   * E.g. does trigger UI effects, remove nodes, etc.\n   */\n  override disposeInternal() {\n    this.disposing = true;\n    super.disposeInternal();\n\n    if (common.getSelected() === this) {\n      this.unselect();\n      this.workspace.cancelCurrentGesture();\n    }\n\n    [...this.warningTextDb.values()].forEach((n) => clearTimeout(n));\n    this.warningTextDb.clear();\n\n    this.getIcons().forEach((i) => i.dispose());\n  }\n\n  /**\n   * Delete a block and hide chaff when doing so. The block will not be deleted\n   * if it's in a flyout. This is called from the context menu and keyboard\n   * shortcuts as the full delete action. If you are disposing of a block from\n   * the workspace and don't need to perform flyout checks, handle event\n   * grouping, or hide chaff, then use `block.dispose()` directly.\n   */\n  checkAndDelete() {\n    if (this.workspace.isFlyout) {\n      return;\n    }\n    eventUtils.setGroup(true);\n    this.workspace.hideChaff();\n    if (this.outputConnection) {\n      // Do not attempt to heal rows\n      // (https://github.com/google/blockly/issues/4832)\n      this.dispose(false, true);\n    } else {\n      this.dispose(/* heal */ true, true);\n    }\n    eventUtils.setGroup(false);\n  }\n\n  /**\n   * Encode a block for copying.\n   *\n   * @returns Copy metadata, or null if the block is an insertion marker.\n   */\n  toCopyData(): BlockCopyData | null {\n    if (this.isInsertionMarker_) {\n      return null;\n    }\n    return {\n      paster: BlockPaster.TYPE,\n      blockState: blocks.save(this, {\n        addCoordinates: true,\n        addNextBlocks: false,\n      }) as blocks.State,\n      typeCounts: common.getBlockTypeCounts(this, true),\n    };\n  }\n\n  /**\n   * Updates the colour of the block to match the block's state.\n   *\n   * @internal\n   */\n  applyColour() {\n    this.pathObject.applyColour(this);\n\n    const icons = this.getIcons();\n    for (let i = 0; i < icons.length; i++) {\n      icons[i].applyColour();\n    }\n\n    for (let x = 0, input; (input = this.inputList[x]); x++) {\n      for (let y = 0, field; (field = input.fieldRow[y]); y++) {\n        field.applyColour();\n      }\n    }\n  }\n\n  /**\n   * Updates the colour of the block (and children) to match the current\n   * disabled state.\n   *\n   * @internal\n   */\n  updateDisabled() {\n    const disabled = !this.isEnabled() || this.getInheritedDisabled();\n\n    if (this.visuallyDisabled === disabled) {\n      this.getNextBlock()?.updateDisabled();\n      return;\n    }\n\n    this.applyColour();\n    this.visuallyDisabled = disabled;\n    for (const child of this.getChildren(false)) {\n      child.updateDisabled();\n    }\n  }\n\n  /**\n   * Set this block's warning text.\n   *\n   * @param text The text, or null to delete.\n   * @param id An optional ID for the warning text to be able to maintain\n   *     multiple warnings.\n   */\n  override setWarningText(text: string | null, id: string = '') {\n    if (!id) {\n      // Kill all previous pending processes, this edit supersedes them all.\n      for (const timeout of this.warningTextDb.values()) {\n        clearTimeout(timeout);\n      }\n      this.warningTextDb.clear();\n    } else if (this.warningTextDb.has(id)) {\n      // Only queue up the latest change.  Kill any earlier pending process.\n      clearTimeout(this.warningTextDb.get(id)!);\n      this.warningTextDb.delete(id);\n    }\n    if (this.workspace.isDragging()) {\n      // Don't change the warning text during a drag.\n      // Wait until the drag finishes.\n      this.warningTextDb.set(\n        id,\n        setTimeout(() => {\n          if (!this.isDeadOrDying()) {\n            this.warningTextDb.delete(id);\n            this.setWarningText(text, id);\n          }\n        }, 100),\n      );\n      return;\n    }\n    if (this.isInFlyout) {\n      text = null;\n    }\n\n    const icon = this.getIcon(WarningIcon.TYPE) as WarningIcon | undefined;\n    if (text) {\n      // Bubble up to add a warning on top-most collapsed block.\n      // TODO(#6020): This warning is never removed.\n      let parent = this.getSurroundParent();\n      let collapsedParent = null;\n      while (parent) {\n        if (parent.isCollapsed()) {\n          collapsedParent = parent;\n        }\n        parent = parent.getSurroundParent();\n      }\n      if (collapsedParent) {\n        collapsedParent.setWarningText(\n          Msg['COLLAPSED_WARNINGS_WARNING'],\n          BlockSvg.COLLAPSED_WARNING_ID,\n        );\n      }\n\n      if (icon) {\n        (icon as WarningIcon).addMessage(text, id);\n      } else {\n        this.addIcon(new WarningIcon(this).addMessage(text, id));\n      }\n    } else if (icon) {\n      // Dispose all warnings if no ID is given.\n      if (!id) {\n        this.removeIcon(WarningIcon.TYPE);\n      } else {\n        // Remove just this warning id's message.\n        icon.addMessage('', id);\n        // Then remove the entire icon if there is no longer any text.\n        if (!icon.getText()) this.removeIcon(WarningIcon.TYPE);\n      }\n    }\n  }\n\n  /**\n   * Give this block a mutator dialog.\n   *\n   * @param mutator A mutator dialog instance or null to remove.\n   */\n  override setMutator(mutator: MutatorIcon | null) {\n    this.removeIcon(MutatorIcon.TYPE);\n    if (mutator) this.addIcon(mutator);\n  }\n\n  override addIcon<T extends IIcon>(icon: T): T {\n    super.addIcon(icon);\n\n    if (icon instanceof MutatorIcon) this.mutator = icon;\n\n    icon.initView(this.createIconPointerDownListener(icon));\n    icon.applyColour();\n    icon.updateEditable();\n    this.queueRender();\n\n    return icon;\n  }\n\n  /**\n   * Creates a pointer down event listener for the icon to append to its\n   * root svg.\n   */\n  private createIconPointerDownListener(icon: IIcon) {\n    return (e: PointerEvent) => {\n      if (this.isDeadOrDying()) return;\n      const gesture = this.workspace.getGesture(e);\n      if (gesture) {\n        gesture.setStartIcon(icon);\n      }\n    };\n  }\n\n  override removeIcon(type: IconType<IIcon>): boolean {\n    const removed = super.removeIcon(type);\n\n    if (type.equals(MutatorIcon.TYPE)) this.mutator = null;\n\n    this.queueRender();\n\n    return removed;\n  }\n\n  /**\n   * @deprecated v11 - Set whether the block is manually enabled or disabled.\n   * The user can toggle whether a block is disabled from a context menu\n   * option. A block may still be disabled for other reasons even if the user\n   * attempts to manually enable it, such as when the block is in an invalid\n   * location. This method is deprecated and setDisabledReason should be used\n   * instead.\n   *\n   * @param enabled True if enabled.\n   */\n  override setEnabled(enabled: boolean) {\n    deprecation.warn(\n      'setEnabled',\n      'v11',\n      'v12',\n      'the setDisabledReason method of BlockSvg',\n    );\n    const wasEnabled = this.isEnabled();\n    super.setEnabled(enabled);\n    if (this.isEnabled() !== wasEnabled && !this.getInheritedDisabled()) {\n      this.updateDisabled();\n    }\n  }\n\n  /**\n   * Add or remove a reason why the block might be disabled. If a block has\n   * any reasons to be disabled, then the block itself will be considered\n   * disabled. A block could be disabled for multiple independent reasons\n   * simultaneously, such as when the user manually disables it, or the block\n   * is invalid.\n   *\n   * @param disabled If true, then the block should be considered disabled for\n   *     at least the provided reason, otherwise the block is no longer disabled\n   *     for that reason.\n   * @param reason A language-neutral identifier for a reason why the block\n   *     could be disabled. Call this method again with the same identifier to\n   *     update whether the block is currently disabled for this reason.\n   */\n  override setDisabledReason(disabled: boolean, reason: string): void {\n    const wasEnabled = this.isEnabled();\n    super.setDisabledReason(disabled, reason);\n    if (this.isEnabled() !== wasEnabled && !this.getInheritedDisabled()) {\n      this.updateDisabled();\n    }\n  }\n\n  /**\n   * Set whether the block is highlighted or not.  Block highlighting is\n   * often used to visually mark blocks currently being executed.\n   *\n   * @param highlighted True if highlighted.\n   */\n  setHighlighted(highlighted: boolean) {\n    this.pathObject.updateHighlighted(highlighted);\n  }\n\n  /**\n   * Adds the visual \"select\" effect to the block, but does not actually select\n   * it or fire an event.\n   *\n   * @see BlockSvg#select\n   */\n  addSelect() {\n    this.pathObject.updateSelected(true);\n  }\n\n  /**\n   * Removes the visual \"select\" effect from the block, but does not actually\n   * unselect it or fire an event.\n   *\n   * @see BlockSvg#unselect\n   */\n  removeSelect() {\n    this.pathObject.updateSelected(false);\n  }\n\n  /**\n   * Update the cursor over this block by adding or removing a class.\n   *\n   * @param enable True if the delete cursor should be shown, false otherwise.\n   * @internal\n   */\n  setDeleteStyle(enable: boolean) {\n    this.pathObject.updateDraggingDelete(enable);\n  }\n\n  // Overrides of functions on Blockly.Block that take into account whether the\n  // block has been rendered.\n\n  /**\n   * Get the colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  override getColour(): string {\n    return this.style.colourPrimary;\n  }\n\n  /**\n   * Change the colour of a block.\n   *\n   * @param colour HSV hue value, or #RRGGBB string.\n   */\n  override setColour(colour: number | string) {\n    super.setColour(colour);\n    const styleObj = this.workspace\n      .getRenderer()\n      .getConstants()\n      .getBlockStyleForColour(this.colour_);\n\n    this.pathObject.setStyle(styleObj.style);\n    this.style = styleObj.style;\n    this.styleName_ = styleObj.name;\n\n    this.applyColour();\n  }\n\n  /**\n   * Set the style and colour values of a block.\n   *\n   * @param blockStyleName Name of the block style.\n   * @throws {Error} if the block style does not exist.\n   */\n  override setStyle(blockStyleName: string) {\n    const blockStyle = this.workspace\n      .getRenderer()\n      .getConstants()\n      .getBlockStyle(blockStyleName);\n    this.styleName_ = blockStyleName;\n\n    if (blockStyle) {\n      this.hat = blockStyle.hat;\n      this.pathObject.setStyle(blockStyle);\n      // Set colour to match Block.\n      this.colour_ = blockStyle.colourPrimary;\n      this.style = blockStyle;\n\n      this.applyColour();\n    } else {\n      throw Error('Invalid style name: ' + blockStyleName);\n    }\n  }\n\n  /**\n   * Move this block to the front of the visible workspace.\n   * <g> tags do not respect z-index so SVG renders them in the\n   * order that they are in the DOM.  By placing this block first within the\n   * block group's <g>, it will render on top of any other blocks.\n   *\n   * @param blockOnly: True to only move this block to the front without\n   *     adjusting its parents.\n   * @internal\n   */\n  bringToFront(blockOnly = false) {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block: this | null = this;\n    if (block.isDeadOrDying()) {\n      return;\n    }\n    do {\n      const root = block.getSvgRoot();\n      const parent = root.parentNode;\n      const childNodes = parent!.childNodes;\n      // Avoid moving the block if it's already at the bottom.\n      if (childNodes[childNodes.length - 1] !== root) {\n        parent!.appendChild(root);\n      }\n      if (blockOnly) break;\n      block = block.getParent();\n    } while (block);\n  }\n\n  /**\n   * Set whether this block can chain onto the bottom of another block.\n   *\n   * @param newBoolean True if there can be a previous statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  override setPreviousStatement(\n    newBoolean: boolean,\n    opt_check?: string | string[] | null,\n  ) {\n    super.setPreviousStatement(newBoolean, opt_check);\n    this.queueRender();\n  }\n\n  /**\n   * Set whether another block can chain onto the bottom of this block.\n   *\n   * @param newBoolean True if there can be a next statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  override setNextStatement(\n    newBoolean: boolean,\n    opt_check?: string | string[] | null,\n  ) {\n    super.setNextStatement(newBoolean, opt_check);\n    this.queueRender();\n  }\n\n  /**\n   * Set whether this block returns a value.\n   *\n   * @param newBoolean True if there is an output.\n   * @param opt_check Returned type or list of returned types.  Null or\n   *     undefined if any type could be returned (e.g. variable get).\n   */\n  override setOutput(\n    newBoolean: boolean,\n    opt_check?: string | string[] | null,\n  ) {\n    super.setOutput(newBoolean, opt_check);\n    this.queueRender();\n  }\n\n  /**\n   * Set whether value inputs are arranged horizontally or vertically.\n   *\n   * @param newBoolean True if inputs are horizontal.\n   */\n  override setInputsInline(newBoolean: boolean) {\n    super.setInputsInline(newBoolean);\n    this.queueRender();\n  }\n\n  /**\n   * Remove an input from this block.\n   *\n   * @param name The name of the input.\n   * @param opt_quiet True to prevent error if input is not present.\n   * @returns True if operation succeeds, false if input is not present and\n   *     opt_quiet is true\n   * @throws {Error} if the input is not present and opt_quiet is not true.\n   */\n  override removeInput(name: string, opt_quiet?: boolean): boolean {\n    const removed = super.removeInput(name, opt_quiet);\n    this.queueRender();\n    return removed;\n  }\n\n  /**\n   * Move a numbered input to a different location on this block.\n   *\n   * @param inputIndex Index of the input to move.\n   * @param refIndex Index of input that should be after the moved input.\n   */\n  override moveNumberedInputBefore(inputIndex: number, refIndex: number) {\n    super.moveNumberedInputBefore(inputIndex, refIndex);\n    this.queueRender();\n  }\n\n  /** @override */\n  override appendInput(input: Input): Input {\n    super.appendInput(input);\n    this.queueRender();\n    return input;\n  }\n\n  /**\n   * Sets whether this block's connections are tracked in the database or not.\n   *\n   * Used by the deserializer to be more efficient. Setting a connection's\n   * tracked_ value to false keeps it from adding itself to the db when it\n   * gets its first moveTo call, saving expensive ops for later.\n   *\n   * @param track If true, start tracking. If false, stop tracking.\n   * @internal\n   */\n  setConnectionTracking(track: boolean) {\n    if (this.previousConnection) {\n      this.previousConnection.setTracking(track);\n    }\n    if (this.outputConnection) {\n      this.outputConnection.setTracking(track);\n    }\n    if (this.nextConnection) {\n      this.nextConnection.setTracking(track);\n      const child = this.nextConnection.targetBlock();\n      if (child) {\n        child.setConnectionTracking(track);\n      }\n    }\n\n    if (this.collapsed_) {\n      // When track is true, we don't want to start tracking collapsed\n      // connections. When track is false, we're already not tracking\n      // collapsed connections, so no need to update.\n      return;\n    }\n\n    for (let i = 0; i < this.inputList.length; i++) {\n      const conn = this.inputList[i].connection as RenderedConnection;\n      if (conn) {\n        conn.setTracking(track);\n\n        // Pass tracking on down the chain.\n        const block = conn.targetBlock();\n        if (block) {\n          block.setConnectionTracking(track);\n        }\n      }\n    }\n  }\n\n  /**\n   * Returns connections originating from this block.\n   *\n   * @param all If true, return all connections even hidden ones.\n   *     Otherwise, for a collapsed block don't return inputs connections.\n   * @returns Array of connections.\n   * @internal\n   */\n  override getConnections_(all: boolean): RenderedConnection[] {\n    const myConnections = [];\n    if (this.outputConnection) {\n      myConnections.push(this.outputConnection);\n    }\n    if (this.previousConnection) {\n      myConnections.push(this.previousConnection);\n    }\n    if (this.nextConnection) {\n      myConnections.push(this.nextConnection);\n    }\n    if (all || !this.collapsed_) {\n      for (let i = 0, input; (input = this.inputList[i]); i++) {\n        if (input.connection) {\n          myConnections.push(input.connection as RenderedConnection);\n        }\n      }\n    }\n    return myConnections;\n  }\n\n  /**\n   * Walks down a stack of blocks and finds the last next connection on the\n   * stack.\n   *\n   * @param ignoreShadows If true,the last connection on a non-shadow block will\n   *     be returned. If false, this will follow shadows to find the last\n   *     connection.\n   * @returns The last next connection on the stack, or null.\n   * @internal\n   */\n  override lastConnectionInStack(\n    ignoreShadows: boolean,\n  ): RenderedConnection | null {\n    return super.lastConnectionInStack(ignoreShadows) as RenderedConnection;\n  }\n\n  /**\n   * Find the connection on this block that corresponds to the given connection\n   * on the other block.\n   * Used to match connections between a block and its insertion marker.\n   *\n   * @param otherBlock The other block to match against.\n   * @param conn The other connection to match.\n   * @returns The matching connection on this block, or null.\n   * @internal\n   */\n  override getMatchingConnection(\n    otherBlock: Block,\n    conn: Connection,\n  ): RenderedConnection | null {\n    return super.getMatchingConnection(otherBlock, conn) as RenderedConnection;\n  }\n\n  /**\n   * Create a connection of the specified type.\n   *\n   * @param type The type of the connection to create.\n   * @returns A new connection of the specified type.\n   * @internal\n   */\n  override makeConnection_(type: ConnectionType): RenderedConnection {\n    return new RenderedConnection(this, type);\n  }\n\n  /**\n   * Return the next statement block directly connected to this block.\n   *\n   * @returns The next statement block or null.\n   */\n  override getNextBlock(): BlockSvg | null {\n    return super.getNextBlock() as BlockSvg;\n  }\n\n  /**\n   * Returns the block connected to the previous connection.\n   *\n   * @returns The previous statement block or null.\n   */\n  override getPreviousBlock(): BlockSvg | null {\n    return super.getPreviousBlock() as BlockSvg;\n  }\n\n  /**\n   * Bumps unconnected blocks out of alignment.\n   *\n   * Two blocks which aren't actually connected should not coincidentally line\n   * up on screen, because that creates confusion for end-users.\n   */\n  override bumpNeighbours() {\n    const root = this.getRootBlock();\n    if (\n      this.isDeadOrDying() ||\n      this.workspace.isDragging() ||\n      root.isInFlyout\n    ) {\n      return;\n    }\n\n    function neighbourIsInStack(neighbour: RenderedConnection) {\n      return neighbour.getSourceBlock().getRootBlock() === root;\n    }\n\n    for (const conn of this.getConnections_(false)) {\n      if (conn.isSuperior()) {\n        // Recurse down the block stack.\n        conn.targetBlock()?.bumpNeighbours();\n      }\n\n      for (const neighbour of conn.neighbours(config.snapRadius)) {\n        if (neighbourIsInStack(neighbour)) continue;\n        if (conn.isConnected() && neighbour.isConnected()) continue;\n\n        if (conn.isSuperior()) {\n          neighbour.bumpAwayFrom(conn);\n        } else {\n          conn.bumpAwayFrom(neighbour);\n        }\n      }\n    }\n  }\n\n  /**\n   * Snap to grid, and then bump neighbouring blocks away at the end of the next\n   * render.\n   */\n  scheduleSnapAndBump() {\n    this.snapToGrid();\n    this.bumpNeighbours();\n  }\n\n  /**\n   * Position a block so that it doesn't move the target block when connected.\n   * The block to position is usually either the first block in a dragged stack\n   * or an insertion marker.\n   *\n   * @param sourceConnection The connection on the moving block's stack.\n   * @param originalOffsetToTarget The connection original offset to the target connection\n   * @param originalOffsetInBlock The connection original offset in its block\n   * @internal\n   */\n  positionNearConnection(\n    sourceConnection: RenderedConnection,\n    originalOffsetToTarget: {x: number; y: number},\n    originalOffsetInBlock: Coordinate,\n  ) {\n    // We only need to position the new block if it's before the existing one,\n    // otherwise its position is set by the previous block.\n    if (\n      sourceConnection.type === ConnectionType.NEXT_STATEMENT ||\n      sourceConnection.type === ConnectionType.INPUT_VALUE\n    ) {\n      // First move the block to match the orginal target connection position\n      let dx = originalOffsetToTarget.x;\n      let dy = originalOffsetToTarget.y;\n      // Then adjust its position according to the connection resize\n      dx += originalOffsetInBlock.x - sourceConnection.getOffsetInBlock().x;\n      dy += originalOffsetInBlock.y - sourceConnection.getOffsetInBlock().y;\n\n      this.moveBy(dx, dy);\n    }\n  }\n\n  /**\n   * Find all the blocks that are directly nested inside this one.\n   * Includes value and statement inputs, as well as any following statement.\n   * Excludes any connection on an output tab or any preceding statement.\n   * Blocks are optionally sorted by position; top to bottom.\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  override getChildren(ordered: boolean): BlockSvg[] {\n    return super.getChildren(ordered) as BlockSvg[];\n  }\n\n  /**\n   * Triggers a rerender after a delay to allow for batching.\n   *\n   * @returns A promise that resolves after the currently queued renders have\n   *     been completed. Used for triggering other behavior that relies on\n   *     updated size/position location for the block.\n   * @internal\n   */\n  queueRender(): Promise<void> {\n    return renderManagement.queueRender(this);\n  }\n\n  /**\n   * Immediately lays out and reflows a block based on its contents and\n   * settings.\n   */\n  render() {\n    this.queueRender();\n    renderManagement.triggerQueuedRenders();\n  }\n\n  /**\n   * Renders this block in a way that's compatible with the more efficient\n   * render management system.\n   *\n   * @internal\n   */\n  renderEfficiently() {\n    dom.startTextWidthCache();\n\n    if (this.isCollapsed()) {\n      this.updateCollapsed_();\n    }\n\n    if (!this.isEnabled()) {\n      this.updateDisabled();\n    }\n\n    this.workspace.getRenderer().render(this);\n    this.tightenChildrenEfficiently();\n\n    dom.stopTextWidthCache();\n    this.updateMarkers_();\n  }\n\n  /**\n   * Tightens all children of this block so they are snuggly rendered against\n   * their parent connections.\n   *\n   * Does not update connection locations, so that they can be updated more\n   * efficiently by the render management system.\n   *\n   * @internal\n   */\n  tightenChildrenEfficiently() {\n    for (const input of this.inputList) {\n      const conn = input.connection as RenderedConnection;\n      if (conn) conn.tightenEfficiently();\n    }\n    if (this.nextConnection) this.nextConnection.tightenEfficiently();\n  }\n\n  /** Redraw any attached marker or cursor svgs if needed. */\n  protected updateMarkers_() {\n    if (this.workspace.keyboardAccessibilityMode && this.pathObject.cursorSvg) {\n      this.workspace.getCursor()!.draw();\n    }\n    if (this.workspace.keyboardAccessibilityMode && this.pathObject.markerSvg) {\n      // TODO(#4592): Update all markers on the block.\n      this.workspace.getMarker(MarkerManager.LOCAL_MARKER)!.draw();\n    }\n    for (const input of this.inputList) {\n      for (const field of input.fieldRow) {\n        field.updateMarkers_();\n      }\n    }\n  }\n\n  /**\n   * Add the cursor SVG to this block's SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the block SVG\n   *     group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    this.pathObject.setCursorSvg(cursorSvg);\n  }\n\n  /**\n   * Add the marker SVG to this block's SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the block SVG\n   *     group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    this.pathObject.setMarkerSvg(markerSvg);\n  }\n\n  /**\n   * Returns a bounding box describing the dimensions of this block\n   * and any blocks stacked below it.\n   *\n   * @returns Object with height and width properties in workspace units.\n   * @internal\n   */\n  getHeightWidth(): {height: number; width: number} {\n    let height = this.height;\n    let width = this.width;\n    // Recursively add size of subsequent blocks.\n    const nextBlock = this.getNextBlock();\n    if (nextBlock) {\n      const nextHeightWidth = nextBlock.getHeightWidth();\n      const tabHeight = this.workspace\n        .getRenderer()\n        .getConstants().NOTCH_HEIGHT;\n      height += nextHeightWidth.height - tabHeight;\n      width = Math.max(width, nextHeightWidth.width);\n    }\n    return {height, width};\n  }\n\n  /**\n   * Visual effect to show that if the dragging block is dropped, this block\n   * will be replaced.  If a shadow block, it will disappear.  Otherwise it will\n   * bump.\n   *\n   * @param add True if highlighting should be added.\n   * @internal\n   */\n  fadeForReplacement(add: boolean) {\n    // TODO (7204): Remove these internal methods.\n    (this.pathObject as AnyDuringMigration).updateReplacementFade(add);\n  }\n\n  /**\n   * Visual effect to show that if the dragging block is dropped it will connect\n   * to this input.\n   *\n   * @param conn The connection on the input to highlight.\n   * @param add True if highlighting should be added.\n   * @internal\n   */\n  highlightShapeForInput(conn: RenderedConnection, add: boolean) {\n    // TODO (7204): Remove these internal methods.\n    (this.pathObject as AnyDuringMigration).updateShapeForInputHighlight(\n      conn,\n      add,\n    );\n  }\n\n  /** Sets the drag strategy for this block. */\n  setDragStrategy(dragStrategy: IDragStrategy) {\n    this.dragStrategy = dragStrategy;\n  }\n\n  /** Returns whether this block is movable or not. */\n  override isMovable(): boolean {\n    return this.dragStrategy.isMovable();\n  }\n\n  /** Starts a drag on the block. */\n  startDrag(e?: PointerEvent): void {\n    this.dragStrategy.startDrag(e);\n  }\n\n  /** Drags the block to the given location. */\n  drag(newLoc: Coordinate, e?: PointerEvent): void {\n    this.dragStrategy.drag(newLoc, e);\n  }\n\n  /** Ends the drag on the block. */\n  endDrag(e?: PointerEvent): void {\n    this.dragStrategy.endDrag(e);\n  }\n\n  /** Moves the block back to where it was at the start of a drag. */\n  revertDrag(): void {\n    this.dragStrategy.revertDrag();\n  }\n\n  /**\n   * Returns a representation of this block that can be displayed in a flyout.\n   */\n  toFlyoutInfo(): FlyoutItemInfo[] {\n    const json: FlyoutItemInfo = {\n      kind: 'BLOCK',\n      ...blocks.save(this),\n    };\n\n    const toRemove = new Set(['id', 'height', 'width', 'pinned', 'enabled']);\n\n    // Traverse the JSON recursively.\n    const traverseJson = function (json: {[key: string]: unknown}) {\n      for (const key in json) {\n        if (toRemove.has(key)) {\n          delete json[key];\n        } else if (typeof json[key] === 'object') {\n          traverseJson(json[key] as {[key: string]: unknown});\n        }\n      }\n    };\n\n    traverseJson(json as unknown as {[key: string]: unknown});\n    return [json];\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The abstract class for a component with custom behaviour when a\n * block or bubble is dragged over or dropped on top of it.\n *\n * @class\n */\n// Former goog.module ID: Blockly.DragTarget\n\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {IDraggable} from './interfaces/i_draggable.js';\nimport type {Rect} from './utils/rect.js';\n\n/**\n * Abstract class for a component with custom behaviour when a block or bubble\n * is dragged over or dropped on top of it.\n */\nexport class DragTarget implements IDragTarget {\n  /**\n   * The unique id for this component that is used to register with the\n   * ComponentManager.\n   */\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  id!: string;\n\n  /**\n   * Constructor for DragTarget. It exists to add the id property and should not\n   * be called directly, only by a subclass.\n   */\n  constructor() {}\n\n  /**\n   * Handles when a cursor with a block or bubble enters this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDragEnter(_dragElement: IDraggable) {\n    // no-op\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble is dragged over this drag\n   * target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDragOver(_dragElement: IDraggable) {\n    // no-op\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble exits this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDragExit(_dragElement: IDraggable) {\n    // no-op\n  }\n  /**\n   * Handles when a block or bubble is dropped on this component.\n   * Should not handle delete here.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDrop(_dragElement: IDraggable) {\n    // no-op\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to the Blockly injection div.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  getClientRect(): Rect | null {\n    return null;\n  }\n\n  /**\n   * Returns whether the provided block or bubble should not be moved after\n   * being dropped on this component. If true, the element will return to where\n   * it was when the drag started.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   * @returns Whether the block or bubble provided should be returned to drag\n   *     start.\n   */\n  shouldPreventMove(_dragElement: IDraggable): boolean {\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The abstract class for a component that can delete a block or\n * bubble that is dropped on top of it.\n *\n * @class\n */\n// Former goog.module ID: Blockly.DeleteArea\n\nimport {BlockSvg} from './block_svg.js';\nimport {DragTarget} from './drag_target.js';\nimport type {IDeleteArea} from './interfaces/i_delete_area.js';\nimport type {IDraggable} from './interfaces/i_draggable.js';\nimport {isDeletable} from './interfaces/i_deletable.js';\n\n/**\n * Abstract class for a component that can delete a block or bubble that is\n * dropped on top of it.\n */\nexport class DeleteArea extends DragTarget implements IDeleteArea {\n  /**\n   * Whether the last block or bubble dragged over this delete area would be\n   * deleted if dropped on this component.\n   * This property is not updated after the block or bubble is deleted.\n   */\n  protected wouldDelete_ = false;\n\n  /**\n   * The unique id for this component that is used to register with the\n   * ComponentManager.\n   */\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override id!: string;\n\n  /**\n   * Constructor for DeleteArea. Should not be called directly, only by a\n   * subclass.\n   */\n  constructor() {\n    super();\n  }\n\n  /**\n   * Returns whether the provided block or bubble would be deleted if dropped on\n   * this area.\n   * This method should check if the element is deletable and is always called\n   * before onDragEnter/onDragOver/onDragExit.\n   *\n   * @param element The block or bubble currently being dragged.\n   * @returns Whether the element provided would be deleted if dropped on this\n   *     area.\n   */\n  wouldDelete(element: IDraggable): boolean {\n    if (element instanceof BlockSvg) {\n      const block = element;\n      const couldDeleteBlock = !block.getParent() && block.isDeletable();\n      this.updateWouldDelete_(couldDeleteBlock);\n    } else {\n      this.updateWouldDelete_(isDeletable(element) && element.isDeletable());\n    }\n    return this.wouldDelete_;\n  }\n\n  /**\n   * Updates the internal wouldDelete_ state.\n   *\n   * @param wouldDelete The new value for the wouldDelete state.\n   */\n  protected updateWouldDelete_(wouldDelete: boolean) {\n    this.wouldDelete_ = wouldDelete;\n  }\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a trash can icon.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Trashcan\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_trashcan_open.js';\n\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as browserEvents from './browser_events.js';\nimport {ComponentManager} from './component_manager.js';\nimport {DeleteArea} from './delete_area.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BlockDelete} from './events/events_block_delete.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IAutoHideable} from './interfaces/i_autohideable.js';\nimport type {IDraggable} from './interfaces/i_draggable.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IPositionable} from './interfaces/i_positionable.js';\nimport type {UiMetrics} from './metrics_manager.js';\nimport {Options} from './options.js';\nimport * as uiPosition from './positionable_helpers.js';\nimport * as registry from './registry.js';\nimport type * as blocks from './serialization/blocks.js';\nimport {SPRITE} from './sprites.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\nimport {BlockInfo} from './utils/toolbox.js';\nimport * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for a trash can.\n */\nexport class Trashcan\n  extends DeleteArea\n  implements IAutoHideable, IPositionable\n{\n  /**\n   * The unique id for this component that is used to register with the\n   * ComponentManager.\n   */\n  override id = 'trashcan';\n\n  /**\n   * A list of JSON (stored as strings) representing blocks in the trashcan.\n   */\n  private readonly contents: string[] = [];\n\n  /**\n   * The trashcan flyout.\n   *\n   * @internal\n   */\n  flyout: IFlyout | null = null;\n\n  /** Current open/close state of the lid. */\n  isLidOpen = false;\n\n  /**\n   * The minimum openness of the lid. Used to indicate if the trashcan\n   * contains blocks.\n   */\n  private minOpenness = 0;\n\n  /** The SVG group containing the trash can. */\n  private svgGroup: SVGElement | null = null;\n\n  /** The SVG image element of the trash can lid. */\n  private svgLid: SVGElement | null = null;\n\n  /** Task ID of opening/closing animation. */\n  private lidTask: ReturnType<typeof setTimeout> | null = null;\n\n  /** Current state of lid opening (0.0 = closed, 1.0 = open). */\n  private lidOpen = 0;\n\n  /** Left coordinate of the trash can. */\n  private left = 0;\n\n  /** Top coordinate of the trash can. */\n  private top = 0;\n\n  /** Whether this trash can has been initialized. */\n  private initialized = false;\n\n  /** @param workspace The workspace to sit in. */\n  constructor(private workspace: WorkspaceSvg) {\n    super();\n\n    if (this.workspace.options.maxTrashcanContents <= 0) {\n      return;\n    }\n\n    // Create flyout options.\n    const flyoutWorkspaceOptions = new Options({\n      'scrollbars': true,\n      'parentWorkspace': this.workspace,\n      'rtl': this.workspace.RTL,\n      'oneBasedIndex': this.workspace.options.oneBasedIndex,\n      'renderer': this.workspace.options.renderer,\n      'rendererOverrides': this.workspace.options.rendererOverrides,\n      'move': {\n        'scrollbars': true,\n      },\n    } as BlocklyOptions);\n    // Create vertical or horizontal flyout.\n    if (this.workspace.horizontalLayout) {\n      flyoutWorkspaceOptions.toolboxPosition =\n        this.workspace.toolboxPosition === toolbox.Position.TOP\n          ? toolbox.Position.BOTTOM\n          : toolbox.Position.TOP;\n      const HorizontalFlyout = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,\n        this.workspace.options,\n        true,\n      );\n      this.flyout = new HorizontalFlyout!(flyoutWorkspaceOptions);\n    } else {\n      flyoutWorkspaceOptions.toolboxPosition =\n        this.workspace.toolboxPosition === toolbox.Position.RIGHT\n          ? toolbox.Position.LEFT\n          : toolbox.Position.RIGHT;\n      const VerticalFlyout = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_VERTICAL_TOOLBOX,\n        this.workspace.options,\n        true,\n      );\n      this.flyout = new VerticalFlyout!(flyoutWorkspaceOptions);\n    }\n    this.workspace.addChangeListener(this.onDelete.bind(this));\n  }\n\n  /**\n   * Create the trash can elements.\n   *\n   * @returns The trash can's SVG group.\n   */\n  createDom(): SVGElement {\n    /* Here's the markup that will be generated:\n        <g class=\"blocklyTrash\">\n          <clippath id=\"blocklyTrashBodyClipPath837493\">\n            <rect width=\"47\" height=\"45\" y=\"15\"></rect>\n          </clippath>\n          <image width=\"64\" height=\"92\" y=\"-32\" xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyTrashBodyClipPath837493)\"></image>\n          <clippath id=\"blocklyTrashLidClipPath837493\">\n            <rect width=\"47\" height=\"15\"></rect>\n          </clippath>\n          <image width=\"84\" height=\"92\" y=\"-32\" xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyTrashLidClipPath837493)\"></image>\n        </g>\n        */\n    this.svgGroup = dom.createSvgElement(Svg.G, {'class': 'blocklyTrash'});\n    let clip;\n    const rnd = String(Math.random()).substring(2);\n    clip = dom.createSvgElement(\n      Svg.CLIPPATH,\n      {'id': 'blocklyTrashBodyClipPath' + rnd},\n      this.svgGroup,\n    );\n    dom.createSvgElement(\n      Svg.RECT,\n      {'width': WIDTH, 'height': BODY_HEIGHT, 'y': LID_HEIGHT},\n      clip,\n    );\n    const body = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'width': SPRITE.width,\n        'x': -SPRITE_LEFT,\n        'height': SPRITE.height,\n        'y': -SPRITE_TOP,\n        'clip-path': 'url(#blocklyTrashBodyClipPath' + rnd + ')',\n      },\n      this.svgGroup,\n    );\n    body.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.workspace.options.pathToMedia + SPRITE.url,\n    );\n\n    clip = dom.createSvgElement(\n      Svg.CLIPPATH,\n      {'id': 'blocklyTrashLidClipPath' + rnd},\n      this.svgGroup,\n    );\n    dom.createSvgElement(\n      Svg.RECT,\n      {'width': WIDTH, 'height': LID_HEIGHT},\n      clip,\n    );\n    this.svgLid = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'width': SPRITE.width,\n        'x': -SPRITE_LEFT,\n        'height': SPRITE.height,\n        'y': -SPRITE_TOP,\n        'clip-path': 'url(#blocklyTrashLidClipPath' + rnd + ')',\n      },\n      this.svgGroup,\n    );\n    this.svgLid.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.workspace.options.pathToMedia + SPRITE.url,\n    );\n\n    // bindEventWithChecks_ quashes events too aggressively. See:\n    // https://groups.google.com/forum/#!topic/blockly/QF4yB9Wx00s\n    // Using bindEventWithChecks_ for blocking mousedown causes issue in mobile.\n    // See #4303\n    browserEvents.bind(\n      this.svgGroup,\n      'pointerdown',\n      this,\n      this.blockMouseDownWhenOpenable,\n    );\n    browserEvents.bind(this.svgGroup, 'pointerup', this, this.click);\n    // Bind to body instead of this.svgGroup so that we don't get lid jitters\n    browserEvents.bind(body, 'pointerover', this, this.mouseOver);\n    browserEvents.bind(body, 'pointerout', this, this.mouseOut);\n    this.animateLid();\n    return this.svgGroup;\n  }\n\n  /** Initializes the trash can. */\n  init() {\n    if (this.workspace.options.maxTrashcanContents > 0) {\n      dom.insertAfter(\n        this.flyout!.createDom(Svg.SVG)!,\n        this.workspace.getParentSvg(),\n      );\n      this.flyout!.init(this.workspace);\n    }\n    this.workspace.getComponentManager().addComponent({\n      component: this,\n      weight: 1,\n      capabilities: [\n        ComponentManager.Capability.AUTOHIDEABLE,\n        ComponentManager.Capability.DELETE_AREA,\n        ComponentManager.Capability.DRAG_TARGET,\n        ComponentManager.Capability.POSITIONABLE,\n      ],\n    });\n    this.initialized = true;\n    this.setLidOpen(false);\n  }\n\n  /**\n   * Dispose of this trash can.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    this.workspace.getComponentManager().removeComponent('trashcan');\n    if (this.svgGroup) {\n      dom.removeNode(this.svgGroup);\n    }\n    if (this.lidTask) {\n      clearTimeout(this.lidTask);\n    }\n  }\n\n  /**\n   * Whether the trashcan has contents.\n   *\n   * @returns True if the trashcan has contents.\n   */\n  private hasContents(): boolean {\n    return !!this.contents.length;\n  }\n\n  /**\n   * Returns true if the trashcan contents-flyout is currently open.\n   *\n   * @returns True if the trashcan contents-flyout is currently open.\n   */\n  contentsIsOpen(): boolean {\n    return !!this.flyout && this.flyout.isVisible();\n  }\n\n  /** Opens the trashcan flyout. */\n  openFlyout() {\n    if (this.contentsIsOpen()) {\n      return;\n    }\n    const contents = this.contents.map(function (string) {\n      return JSON.parse(string);\n    });\n    // Trashcans with lots of blocks can take a second to render.\n    const blocklyStyle = this.workspace.getParentSvg().style;\n    blocklyStyle.cursor = 'wait';\n    setTimeout(() => {\n      this.flyout?.show(contents);\n      blocklyStyle.cursor = '';\n      this.workspace.scrollbar?.setVisible(false);\n    }, 10);\n    this.fireUiEvent(true);\n  }\n\n  /** Closes the trashcan flyout. */\n  closeFlyout() {\n    if (!this.contentsIsOpen()) {\n      return;\n    }\n    this.flyout?.hide();\n    this.workspace.scrollbar?.setVisible(true);\n    this.fireUiEvent(false);\n    this.workspace.recordDragTargets();\n  }\n\n  /**\n   * Hides the component. Called in WorkspaceSvg.hideChaff.\n   *\n   * @param onlyClosePopups Whether only popups should be closed.\n   *     Flyouts should not be closed if this is true.\n   */\n  autoHide(onlyClosePopups: boolean) {\n    // For now the trashcan flyout always autocloses because it overlays the\n    // trashcan UI (no trashcan to click to close it).\n    if (!onlyClosePopups && this.flyout) {\n      this.closeFlyout();\n    }\n  }\n\n  /**\n   * Empties the trashcan's contents. If the contents-flyout is currently open\n   * it will be closed.\n   */\n  emptyContents() {\n    if (!this.hasContents()) {\n      return;\n    }\n    this.contents.length = 0;\n    this.setMinOpenness(0);\n    this.closeFlyout();\n  }\n\n  /**\n   * Positions the trashcan.\n   * It is positioned in the opposite corner to the corner the\n   * categories/toolbox starts at.\n   *\n   * @param metrics The workspace metrics.\n   * @param savedPositions List of rectangles that are already on the workspace.\n   */\n  position(metrics: UiMetrics, savedPositions: Rect[]) {\n    // Not yet initialized.\n    if (!this.initialized) {\n      return;\n    }\n\n    const cornerPosition = uiPosition.getCornerOppositeToolbox(\n      this.workspace,\n      metrics,\n    );\n\n    const height = BODY_HEIGHT + LID_HEIGHT;\n    const startRect = uiPosition.getStartPositionRect(\n      cornerPosition,\n      new Size(WIDTH, height),\n      MARGIN_HORIZONTAL,\n      MARGIN_VERTICAL,\n      metrics,\n      this.workspace,\n    );\n\n    const verticalPosition = cornerPosition.vertical;\n    const bumpDirection =\n      verticalPosition === uiPosition.verticalPosition.TOP\n        ? uiPosition.bumpDirection.DOWN\n        : uiPosition.bumpDirection.UP;\n    const positionRect = uiPosition.bumpPositionRect(\n      startRect,\n      MARGIN_VERTICAL,\n      bumpDirection,\n      savedPositions,\n    );\n\n    this.top = positionRect.top;\n    this.left = positionRect.left;\n    this.svgGroup?.setAttribute(\n      'transform',\n      'translate(' + this.left + ',' + this.top + ')',\n    );\n  }\n\n  /**\n   * Returns the bounding rectangle of the UI element in pixel units relative to\n   * the Blockly injection div.\n   *\n   * @returns The UI elements's bounding box. Null if bounding box should be\n   *     ignored by other UI elements.\n   */\n  getBoundingRectangle(): Rect | null {\n    const bottom = this.top + BODY_HEIGHT + LID_HEIGHT;\n    const right = this.left + WIDTH;\n    return new Rect(this.top, bottom, this.left, right);\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect | null {\n    if (!this.svgGroup) {\n      return null;\n    }\n\n    const trashRect = this.svgGroup.getBoundingClientRect();\n    const top = trashRect.top + SPRITE_TOP - MARGIN_HOTSPOT;\n    const bottom = top + LID_HEIGHT + BODY_HEIGHT + 2 * MARGIN_HOTSPOT;\n    const left = trashRect.left + SPRITE_LEFT - MARGIN_HOTSPOT;\n    const right = left + WIDTH + 2 * MARGIN_HOTSPOT;\n    return new Rect(top, bottom, left, right);\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble is dragged over this drag\n   * target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragOver(_dragElement: IDraggable) {\n    this.setLidOpen(this.wouldDelete_);\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble exits this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragExit(_dragElement: IDraggable) {\n    this.setLidOpen(false);\n  }\n\n  /**\n   * Handles when a block or bubble is dropped on this component.\n   * Should not handle delete here.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDrop(_dragElement: IDraggable) {\n    setTimeout(this.setLidOpen.bind(this, false), 100);\n  }\n\n  /**\n   * Flip the lid open or shut.\n   *\n   * @param state True if open.\n   * @internal\n   */\n  setLidOpen(state: boolean) {\n    if (this.isLidOpen === state) {\n      return;\n    }\n    if (this.lidTask) {\n      clearTimeout(this.lidTask);\n    }\n    this.isLidOpen = state;\n    this.animateLid();\n  }\n\n  /** Rotate the lid open or closed by one step.  Then wait and recurse. */\n  private animateLid() {\n    const frames = ANIMATION_FRAMES;\n\n    const delta = 1 / (frames + 1);\n    this.lidOpen += this.isLidOpen ? delta : -delta;\n    this.lidOpen = Math.min(Math.max(this.lidOpen, this.minOpenness), 1);\n\n    this.setLidAngle(this.lidOpen * MAX_LID_ANGLE);\n\n    // Linear interpolation between min and max.\n    const opacity = OPACITY_MIN + this.lidOpen * (OPACITY_MAX - OPACITY_MIN);\n    if (this.svgGroup) {\n      this.svgGroup.style.opacity = `${opacity}`;\n    }\n\n    if (this.lidOpen > this.minOpenness && this.lidOpen < 1) {\n      this.lidTask = setTimeout(\n        this.animateLid.bind(this),\n        ANIMATION_LENGTH / frames,\n      );\n    }\n  }\n\n  /**\n   * Set the angle of the trashcan's lid.\n   *\n   * @param lidAngle The angle at which to set the lid.\n   */\n  private setLidAngle(lidAngle: number) {\n    const openAtRight =\n      this.workspace.toolboxPosition === toolbox.Position.RIGHT ||\n      (this.workspace.horizontalLayout && this.workspace.RTL);\n    this.svgLid?.setAttribute(\n      'transform',\n      'rotate(' +\n        (openAtRight ? -lidAngle : lidAngle) +\n        ',' +\n        (openAtRight ? 4 : WIDTH - 4) +\n        ',' +\n        (LID_HEIGHT - 2) +\n        ')',\n    );\n  }\n\n  /**\n   * Sets the minimum openness of the trashcan lid. If the lid is currently\n   * closed, this will update lid's position.\n   *\n   * @param newMin The new minimum openness of the lid. Should be between 0\n   *     and 1.\n   */\n  private setMinOpenness(newMin: number) {\n    this.minOpenness = newMin;\n    if (!this.isLidOpen) {\n      this.setLidAngle(newMin * MAX_LID_ANGLE);\n    }\n  }\n\n  /**\n   * Flip the lid shut.\n   * Called externally after a drag.\n   */\n  closeLid() {\n    this.setLidOpen(false);\n  }\n\n  /** Inspect the contents of the trash. */\n  click() {\n    if (!this.hasContents() || this.workspace.isDragging()) {\n      return;\n    }\n    this.openFlyout();\n  }\n\n  /**\n   * Fires a UI event for trashcan flyout open or close.\n   *\n   * @param trashcanOpen Whether the flyout is opening.\n   */\n  private fireUiEvent(trashcanOpen: boolean) {\n    const uiEvent = new (eventUtils.get(eventUtils.TRASHCAN_OPEN))(\n      trashcanOpen,\n      this.workspace.id,\n    );\n    eventUtils.fire(uiEvent);\n  }\n\n  /**\n   * Prevents a workspace scroll and click event if the trashcan has blocks.\n   *\n   * @param e A mouse down event.\n   */\n  private blockMouseDownWhenOpenable(e: PointerEvent) {\n    if (!this.contentsIsOpen() && this.hasContents()) {\n      // Don't start a workspace scroll.\n      e.stopPropagation();\n    }\n  }\n\n  /**\n   * Indicate that the trashcan can be clicked (by opening it) if it has blocks.\n   */\n  private mouseOver() {\n    if (this.hasContents()) {\n      this.setLidOpen(true);\n    }\n  }\n\n  /**\n   * Close the lid of the trashcan if it was open (Vis. it was indicating it had\n   *    blocks).\n   */\n  private mouseOut() {\n    // No need to do a .hasBlocks check here because if it doesn't the trashcan\n    // won't be open in the first place, and setOpen won't run.\n    this.setLidOpen(false);\n  }\n\n  /**\n   * Handle a BLOCK_DELETE event. Adds deleted blocks oldXml to the content\n   * array.\n   *\n   * @param event Workspace event.\n   */\n  private onDelete(event: Abstract) {\n    if (\n      this.workspace.options.maxTrashcanContents <= 0 ||\n      event.type !== eventUtils.BLOCK_DELETE\n    ) {\n      return;\n    }\n    const deleteEvent = event as BlockDelete;\n    if (event.type === eventUtils.BLOCK_DELETE && !deleteEvent.wasShadow) {\n      if (!deleteEvent.oldJson) {\n        throw new Error('Encountered a delete event without proper oldJson');\n      }\n      const cleanedJson = JSON.stringify(\n        this.cleanBlockJson(deleteEvent.oldJson),\n      );\n      if (this.contents.includes(cleanedJson)) {\n        return;\n      }\n      this.contents.unshift(cleanedJson);\n      while (\n        this.contents.length > this.workspace.options.maxTrashcanContents\n      ) {\n        this.contents.pop();\n      }\n\n      this.setMinOpenness(HAS_BLOCKS_LID_ANGLE);\n    }\n  }\n\n  /**\n   * Converts JSON representing a block into text that can be stored in the\n   * content array.\n   *\n   * @param json A JSON representation of a block's state.\n   * @returns A BlockInfo object corresponding to the JSON, cleaned of all\n   *     unnecessary attributes.\n   */\n  private cleanBlockJson(json: blocks.State): BlockInfo {\n    // Create a deep copy.\n    json = JSON.parse(JSON.stringify(json)) as blocks.State;\n\n    /**\n     * Reshape JSON into a nicer format.\n     *\n     * @param json The JSON to clean.\n     */\n    function cleanRec(json: blocks.State) {\n      if (!json) {\n        return;\n      }\n\n      delete json['id'];\n      delete json['x'];\n      delete json['y'];\n      delete json['enabled'];\n      delete json['disabledReasons'];\n\n      if (json['icons'] && json['icons']['comment']) {\n        const comment = json['icons']['comment'];\n        delete comment['height'];\n        delete comment['width'];\n        delete comment['pinned'];\n      }\n\n      const inputs = json['inputs'];\n      for (const name in inputs) {\n        const input = inputs[name];\n        const block = input['block'];\n        const shadow = input['shadow'];\n        if (block) {\n          cleanRec(block);\n        }\n        if (shadow) {\n          cleanRec(shadow);\n        }\n      }\n      if (json['next']) {\n        const next = json['next'];\n        const block = next['block'];\n        const shadow = next['shadow'];\n        if (block) {\n          cleanRec(block);\n        }\n        if (shadow) {\n          cleanRec(shadow);\n        }\n      }\n    }\n\n    cleanRec(json);\n\n    const blockInfo: BlockInfo = {\n      'kind': 'BLOCK',\n      ...json,\n    };\n    return blockInfo;\n  }\n}\n\n/** Width of both the trash can and lid images. */\nconst WIDTH = 47;\n\n/** Height of the trashcan image (minus lid). */\nconst BODY_HEIGHT = 44;\n\n/** Height of the lid image. */\nconst LID_HEIGHT = 16;\n\n/** Distance between trashcan and bottom or top edge of workspace. */\nconst MARGIN_VERTICAL = 20;\n\n/** Distance between trashcan and right or left edge of workspace. */\nconst MARGIN_HORIZONTAL = 20;\n\n/** Extent of hotspot on all sides beyond the size of the image. */\nconst MARGIN_HOTSPOT = 10;\n\n/** Location of trashcan in sprite image. */\nconst SPRITE_LEFT = 0;\n\n/** Location of trashcan in sprite image. */\nconst SPRITE_TOP = 32;\n\n/**\n * The openness of the lid when the trashcan contains blocks.\n *    (0.0 = closed, 1.0 = open)\n */\nconst HAS_BLOCKS_LID_ANGLE = 0.1;\n\n/** The length of the lid open/close animation in milliseconds. */\nconst ANIMATION_LENGTH = 80;\n\n/** The number of frames in the animation. */\nconst ANIMATION_FRAMES = 4;\n\n/** The minimum (resting) opacity of the trashcan and lid. */\nconst OPACITY_MIN = 0.4;\n\n/** The maximum (hovered) opacity of the trashcan and lid. */\nconst OPACITY_MAX = 0.8;\n\n/**\n * The maximum angle the trashcan lid can opens to. At the end of the open\n * animation the lid will be open to this angle.\n */\nconst MAX_LID_ANGLE = 45;\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The namespace used to keep track of keyboard shortcuts and the\n * key codes used to execute those shortcuts.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ShortcutRegistry\n\nimport {KeyCodes} from './utils/keycodes.js';\nimport * as object from './utils/object.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for the registry of keyboard shortcuts. This is intended to be a\n * singleton. You should not create a new instance, and only access this class\n * from ShortcutRegistry.registry.\n */\nexport class ShortcutRegistry {\n  static readonly registry = new ShortcutRegistry();\n\n  /** Registry of all keyboard shortcuts, keyed by name of shortcut. */\n  private shortcuts = new Map<string, KeyboardShortcut>();\n\n  /** Map of key codes to an array of shortcut names. */\n  private keyMap = new Map<string, string[]>();\n\n  /** Resets the existing ShortcutRegistry singleton. */\n  private constructor() {\n    this.reset();\n  }\n\n  /** Clear and recreate the registry and keyMap. */\n  reset() {\n    this.shortcuts.clear();\n    this.keyMap.clear();\n  }\n\n  /**\n   * Registers a keyboard shortcut.\n   *\n   * @param shortcut The shortcut for this key code.\n   * @param opt_allowOverrides True to prevent a warning when overriding an\n   *     already registered item.\n   * @throws {Error} if a shortcut with the same name already exists.\n   */\n  register(shortcut: KeyboardShortcut, opt_allowOverrides?: boolean) {\n    const registeredShortcut = this.shortcuts.get(shortcut.name);\n    if (registeredShortcut && !opt_allowOverrides) {\n      throw new Error(`Shortcut named \"${shortcut.name}\" already exists.`);\n    }\n    this.shortcuts.set(shortcut.name, shortcut);\n\n    const keyCodes = shortcut.keyCodes;\n    if (keyCodes && keyCodes.length > 0) {\n      for (let i = 0; i < keyCodes.length; i++) {\n        this.addKeyMapping(\n          keyCodes[i],\n          shortcut.name,\n          !!shortcut.allowCollision,\n        );\n      }\n    }\n  }\n\n  /**\n   * Unregisters a keyboard shortcut registered with the given key code. This\n   * will also remove any key mappings that reference this shortcut.\n   *\n   * @param shortcutName The name of the shortcut to unregister.\n   * @returns True if an item was unregistered, false otherwise.\n   */\n  unregister(shortcutName: string): boolean {\n    const shortcut = this.shortcuts.get(shortcutName);\n\n    if (!shortcut) {\n      console.warn(`Keyboard shortcut named \"${shortcutName}\" not found.`);\n      return false;\n    }\n\n    this.removeAllKeyMappings(shortcutName);\n\n    this.shortcuts.delete(shortcutName);\n    return true;\n  }\n\n  /**\n   * Adds a mapping between a keycode and a keyboard shortcut.\n   *\n   * @param keyCode The key code for the keyboard shortcut. If registering a key\n   *     code with a modifier (ex: ctrl+c) use\n   *     ShortcutRegistry.registry.createSerializedKey;\n   * @param shortcutName The name of the shortcut to execute when the given\n   *     keycode is pressed.\n   * @param opt_allowCollision True to prevent an error when adding a shortcut\n   *     to a key that is already mapped to a shortcut.\n   * @throws {Error} if the given key code is already mapped to a shortcut.\n   */\n  addKeyMapping(\n    keyCode: string | number | KeyCodes,\n    shortcutName: string,\n    opt_allowCollision?: boolean,\n  ) {\n    keyCode = `${keyCode}`;\n    const shortcutNames = this.keyMap.get(keyCode);\n    if (shortcutNames && !opt_allowCollision) {\n      throw new Error(\n        `Shortcut named \"${shortcutName}\" collides with shortcuts \"${shortcutNames}\"`,\n      );\n    } else if (shortcutNames && opt_allowCollision) {\n      shortcutNames.unshift(shortcutName);\n    } else {\n      this.keyMap.set(keyCode, [shortcutName]);\n    }\n  }\n\n  /**\n   * Removes a mapping between a keycode and a keyboard shortcut.\n   *\n   * @param keyCode The key code for the keyboard shortcut. If registering a key\n   *     code with a modifier (ex: ctrl+c) use\n   *     ShortcutRegistry.registry.createSerializedKey;\n   * @param shortcutName The name of the shortcut to execute when the given\n   *     keycode is pressed.\n   * @param opt_quiet True to not console warn when there is no shortcut to\n   *     remove.\n   * @returns True if a key mapping was removed, false otherwise.\n   */\n  removeKeyMapping(\n    keyCode: string,\n    shortcutName: string,\n    opt_quiet?: boolean,\n  ): boolean {\n    const shortcutNames = this.keyMap.get(keyCode);\n\n    if (!shortcutNames) {\n      if (!opt_quiet) {\n        console.warn(\n          `No keyboard shortcut named \"${shortcutName}\" registered with key code \"${keyCode}\"`,\n        );\n      }\n      return false;\n    }\n\n    const shortcutIdx = shortcutNames.indexOf(shortcutName);\n    if (shortcutIdx > -1) {\n      shortcutNames.splice(shortcutIdx, 1);\n      if (shortcutNames.length === 0) {\n        this.keyMap.delete(keyCode);\n      }\n      return true;\n    }\n    if (!opt_quiet) {\n      console.warn(\n        `No keyboard shortcut named \"${shortcutName}\" registered with key code \"${keyCode}\"`,\n      );\n    }\n    return false;\n  }\n\n  /**\n   * Removes all the key mappings for a shortcut with the given name.\n   * Useful when changing the default key mappings and the key codes registered\n   * to the shortcut are unknown.\n   *\n   * @param shortcutName The name of the shortcut to remove from the key map.\n   */\n  removeAllKeyMappings(shortcutName: string) {\n    for (const keyCode of this.keyMap.keys()) {\n      this.removeKeyMapping(keyCode, shortcutName, true);\n    }\n  }\n\n  /**\n   * Sets the key map. Setting the key map will override any default key\n   * mappings.\n   *\n   * @param newKeyMap The object with key code to shortcut names.\n   */\n  setKeyMap(newKeyMap: {[key: string]: string[]}) {\n    this.keyMap.clear();\n    for (const key in newKeyMap) {\n      this.keyMap.set(key, newKeyMap[key]);\n    }\n  }\n\n  /**\n   * Gets the current key map.\n   *\n   * @returns The object holding key codes to ShortcutRegistry.KeyboardShortcut.\n   */\n  getKeyMap(): {[key: string]: string[]} {\n    const legacyKeyMap: {[key: string]: string[]} = Object.create(null);\n    for (const [key, value] of this.keyMap) {\n      legacyKeyMap[key] = value;\n    }\n    return legacyKeyMap;\n  }\n\n  /**\n   * Gets the registry of keyboard shortcuts.\n   *\n   * @returns The registry of keyboard shortcuts.\n   */\n  getRegistry(): {[key: string]: KeyboardShortcut} {\n    const legacyRegistry: {[key: string]: KeyboardShortcut} =\n      Object.create(null);\n    for (const [key, value] of this.shortcuts) {\n      legacyRegistry[key] = value;\n    }\n    return object.deepMerge(Object.create(null), legacyRegistry);\n  }\n\n  /**\n   * Handles key down events.\n   *\n   * @param workspace The main workspace where the event was captured.\n   * @param e The key down event.\n   * @returns True if the event was handled, false otherwise.\n   */\n  onKeyDown(workspace: WorkspaceSvg, e: KeyboardEvent): boolean {\n    const key = this.serializeKeyEvent_(e);\n    const shortcutNames = this.getShortcutNamesByKeyCode(key);\n    if (!shortcutNames) {\n      return false;\n    }\n    for (let i = 0, shortcutName; (shortcutName = shortcutNames[i]); i++) {\n      const shortcut = this.shortcuts.get(shortcutName);\n      if (!shortcut?.preconditionFn || shortcut?.preconditionFn(workspace)) {\n        // If the key has been handled, stop processing shortcuts.\n        if (shortcut?.callback && shortcut?.callback(workspace, e, shortcut)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Gets the shortcuts registered to the given key code.\n   *\n   * @param keyCode The serialized key code.\n   * @returns The list of shortcuts to call when the given keyCode is used.\n   *     Undefined if no shortcuts exist.\n   */\n  getShortcutNamesByKeyCode(keyCode: string): string[] | undefined {\n    return this.keyMap.get(keyCode) || [];\n  }\n\n  /**\n   * Gets the serialized key codes that the shortcut with the given name is\n   * registered under.\n   *\n   * @param shortcutName The name of the shortcut.\n   * @returns An array with all the key codes the shortcut is registered under.\n   */\n  getKeyCodesByShortcutName(shortcutName: string): string[] {\n    const keys = [];\n    for (const [keyCode, shortcuts] of this.keyMap) {\n      const shortcutIdx = shortcuts.indexOf(shortcutName);\n      if (shortcutIdx > -1) {\n        keys.push(keyCode);\n      }\n    }\n    return keys;\n  }\n\n  /**\n   * Serializes a key event.\n   *\n   * @param e A key down event.\n   * @returns The serialized key code for the given event.\n   */\n  private serializeKeyEvent_(e: KeyboardEvent): string {\n    let serializedKey = '';\n    for (const modifier in ShortcutRegistry.modifierKeys) {\n      if (e.getModifierState(modifier)) {\n        if (serializedKey !== '') {\n          serializedKey += '+';\n        }\n        serializedKey += modifier;\n      }\n    }\n    if (serializedKey !== '' && e.keyCode) {\n      serializedKey += '+' + e.keyCode;\n    } else if (e.keyCode) {\n      serializedKey = String(e.keyCode);\n    }\n    return serializedKey;\n  }\n\n  /**\n   * Checks whether any of the given modifiers are not valid.\n   *\n   * @param modifiers List of modifiers to be used with the key.\n   * @throws {Error} if the modifier is not in the valid modifiers list.\n   */\n  private checkModifiers_(modifiers: KeyCodes[]) {\n    for (let i = 0, modifier; (modifier = modifiers[i]); i++) {\n      if (!(modifier in ShortcutRegistry.modifierKeys)) {\n        throw new Error(modifier + ' is not a valid modifier key.');\n      }\n    }\n  }\n\n  /**\n   * Creates the serialized key code that will be used in the key map.\n   *\n   * @param keyCode Number code representing the key.\n   * @param modifiers List of modifier key codes to be used with the key. All\n   *     valid modifiers can be found in the ShortcutRegistry.modifierKeys.\n   * @returns The serialized key code for the given modifiers and key.\n   */\n  createSerializedKey(keyCode: number, modifiers: KeyCodes[] | null): string {\n    let serializedKey = '';\n\n    if (modifiers) {\n      this.checkModifiers_(modifiers);\n      for (const modifier in ShortcutRegistry.modifierKeys) {\n        const modifierKeyCode = (\n          ShortcutRegistry.modifierKeys as AnyDuringMigration\n        )[modifier];\n        if (modifiers.includes(modifierKeyCode)) {\n          if (serializedKey !== '') {\n            serializedKey += '+';\n          }\n          serializedKey += modifier;\n        }\n      }\n    }\n\n    if (serializedKey !== '' && keyCode) {\n      serializedKey += '+' + keyCode;\n    } else if (keyCode) {\n      serializedKey = `${keyCode}`;\n    }\n    return serializedKey;\n  }\n}\n\nexport namespace ShortcutRegistry {\n  export interface KeyboardShortcut {\n    callback?: (p1: WorkspaceSvg, p2: Event, p3: KeyboardShortcut) => boolean;\n    name: string;\n    preconditionFn?: (p1: WorkspaceSvg) => boolean;\n    metadata?: object;\n    keyCodes?: (number | string)[];\n    allowCollision?: boolean;\n  }\n\n  /** Supported modifiers. */\n  export enum modifierKeys {\n    Shift = KeyCodes.SHIFT,\n    Control = KeyCodes.CTRL,\n    Alt = KeyCodes.ALT,\n    Meta = KeyCodes.META,\n  }\n}\n\nexport type KeyboardShortcut = ShortcutRegistry.KeyboardShortcut;\n// No need to export ShorcutRegistry.modifierKeys from the module at this time\n// because (1) it wasn't automatically converted by the automatic migration\n// script, (2) the name doesn't follow the styleguide.\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.serialization.variables\n\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport type {Workspace} from '../workspace.js';\n\nimport * as priorities from './priorities.js';\nimport * as serializationRegistry from './registry.js';\n\n/**\n * Represents the state of a given variable.\n */\nexport interface State {\n  name: string;\n  id: string;\n  type: string | undefined;\n}\n\n/**\n * Serializer for saving and loading variable state.\n */\nexport class VariableSerializer implements ISerializer {\n  priority: number;\n\n  /* eslint-disable-next-line require-jsdoc */\n  constructor() {\n    /** The priority for deserializing variables. */\n    this.priority = priorities.VARIABLES;\n  }\n\n  /**\n   * Serializes the variables of the given workspace.\n   *\n   * @param workspace The workspace to save the variables of.\n   * @returns The state of the workspace's variables, or null if there are no\n   *     variables.\n   */\n  save(workspace: Workspace): State[] | null {\n    const variableStates = [];\n    for (const variable of workspace.getAllVariables()) {\n      const state = {\n        'name': variable.name,\n        'id': variable.getId(),\n      };\n      if (variable.type) {\n        (state as AnyDuringMigration)['type'] = variable.type;\n      }\n      variableStates.push(state);\n    }\n    // AnyDuringMigration because:  Type '{ name: string; id: string; }[] |\n    // null' is not assignable to type 'State[] | null'.\n    return (\n      variableStates.length ? variableStates : null\n    ) as AnyDuringMigration;\n  }\n\n  /**\n   * Deserializes the variable defined by the given state into the given\n   * workspace.\n   *\n   * @param state The state of the variables to deserialize.\n   * @param workspace The workspace to deserialize into.\n   */\n  load(state: State[], workspace: Workspace) {\n    for (const varState of state) {\n      workspace.createVariable(\n        varState['name'],\n        varState['type'],\n        varState['id'],\n      );\n    }\n  }\n\n  /**\n   * Disposes of any variables that exist on the workspace.\n   *\n   * @param workspace The workspace to clear the variables of.\n   */\n  clear(workspace: Workspace) {\n    workspace.getVariableMap().clear();\n  }\n}\n\nserializationRegistry.register('variables', new VariableSerializer());\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Serialization methods.\n */\n// Former goog.module ID: Blockly.serialization\n\nimport * as blocks from './serialization/blocks.js';\nimport * as exceptions from './serialization/exceptions.js';\nimport * as priorities from './serialization/priorities.js';\nimport * as procedures from './serialization/procedures.js';\nimport * as registry from './serialization/registry.js';\nimport * as variables from './serialization/variables.js';\nimport * as workspaces from './serialization/workspaces.js';\nimport * as workspaceComments from './serialization/workspace_comments.js';\nimport {ISerializer} from './interfaces/i_serializer.js';\n\nexport {\n  blocks,\n  exceptions,\n  priorities,\n  procedures,\n  registry,\n  variables,\n  workspaces,\n  workspaceComments,\n  ISerializer,\n};\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a pair of scrollbars.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ScrollbarPair\n\nimport * as eventUtils from './events/utils.js';\nimport {Scrollbar} from './scrollbar.js';\nimport * as dom from './utils/dom.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Svg} from './utils/svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for a pair of scrollbars.  Horizontal and vertical.\n */\nexport class ScrollbarPair {\n  hScroll: Scrollbar | null = null;\n  vScroll: Scrollbar | null = null;\n  corner_: SVGRectElement | null = null;\n\n  /** Previously recorded metrics from the workspace. */\n  private oldHostMetrics_: Metrics | null = null;\n\n  /**\n   * @param workspace Workspace to bind the scrollbars to.\n   * @param addHorizontal Whether to add a horizontal scrollbar.\n   *    Defaults to true.\n   * @param addVertical Whether to add a vertical scrollbar. Defaults to true.\n   * @param opt_class A class to be applied to these scrollbars.\n   * @param opt_margin The margin to apply to these scrollbars.\n   */\n  constructor(\n    private workspace: WorkspaceSvg,\n    addHorizontal?: boolean,\n    addVertical?: boolean,\n    opt_class?: string,\n    opt_margin?: number,\n  ) {\n    addHorizontal = addHorizontal === undefined ? true : addHorizontal;\n    addVertical = addVertical === undefined ? true : addVertical;\n    const isPair = addHorizontal && addVertical;\n\n    if (addHorizontal) {\n      this.hScroll = new Scrollbar(\n        workspace,\n        true,\n        isPair,\n        opt_class,\n        opt_margin,\n      );\n    }\n    if (addVertical) {\n      this.vScroll = new Scrollbar(\n        workspace,\n        false,\n        isPair,\n        opt_class,\n        opt_margin,\n      );\n    }\n\n    if (isPair) {\n      this.corner_ = dom.createSvgElement(Svg.RECT, {\n        'height': Scrollbar.scrollbarThickness,\n        'width': Scrollbar.scrollbarThickness,\n        'class': 'blocklyScrollbarBackground',\n      });\n      dom.insertAfter(this.corner_, workspace.getBubbleCanvas());\n    }\n  }\n\n  /**\n   * Dispose of this pair of scrollbars.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    dom.removeNode(this.corner_);\n    this.corner_ = null;\n    this.oldHostMetrics_ = null;\n    if (this.hScroll) {\n      this.hScroll.dispose();\n      this.hScroll = null;\n    }\n    if (this.vScroll) {\n      this.vScroll.dispose();\n      this.vScroll = null;\n    }\n  }\n\n  /**\n   * Recalculate both of the scrollbars' locations and lengths.\n   * Also reposition the corner rectangle.\n   */\n  resize() {\n    // Look up the host metrics once, and use for both scrollbars.\n    const hostMetrics = this.workspace.getMetrics();\n    if (!hostMetrics) {\n      // Host element is likely not visible.\n      return;\n    }\n\n    // Only change the scrollbars if there has been a change in metrics.\n    let resizeH = false;\n    let resizeV = false;\n    if (\n      !this.oldHostMetrics_ ||\n      this.oldHostMetrics_.viewWidth !== hostMetrics.viewWidth ||\n      this.oldHostMetrics_.viewHeight !== hostMetrics.viewHeight ||\n      this.oldHostMetrics_.absoluteTop !== hostMetrics.absoluteTop ||\n      this.oldHostMetrics_.absoluteLeft !== hostMetrics.absoluteLeft\n    ) {\n      // The window has been resized or repositioned.\n      resizeH = true;\n      resizeV = true;\n    } else {\n      // Has the content been resized or moved?\n      if (\n        !this.oldHostMetrics_ ||\n        this.oldHostMetrics_.scrollWidth !== hostMetrics.scrollWidth ||\n        this.oldHostMetrics_.viewLeft !== hostMetrics.viewLeft ||\n        this.oldHostMetrics_.scrollLeft !== hostMetrics.scrollLeft\n      ) {\n        resizeH = true;\n      }\n      if (\n        !this.oldHostMetrics_ ||\n        this.oldHostMetrics_.scrollHeight !== hostMetrics.scrollHeight ||\n        this.oldHostMetrics_.viewTop !== hostMetrics.viewTop ||\n        this.oldHostMetrics_.scrollTop !== hostMetrics.scrollTop\n      ) {\n        resizeV = true;\n      }\n    }\n\n    if (resizeH || resizeV) {\n      try {\n        eventUtils.disable();\n        if (this.hScroll && resizeH) {\n          this.hScroll.resize(hostMetrics);\n        }\n        if (this.vScroll && resizeV) {\n          this.vScroll.resize(hostMetrics);\n        }\n      } finally {\n        eventUtils.enable();\n      }\n      this.workspace.maybeFireViewportChangeEvent();\n    }\n\n    if (this.hScroll && this.vScroll) {\n      // Reposition the corner square.\n      if (\n        !this.oldHostMetrics_ ||\n        this.oldHostMetrics_.viewWidth !== hostMetrics.viewWidth ||\n        this.oldHostMetrics_.absoluteLeft !== hostMetrics.absoluteLeft\n      ) {\n        this.corner_?.setAttribute('x', String(this.vScroll.position.x));\n      }\n      if (\n        !this.oldHostMetrics_ ||\n        this.oldHostMetrics_.viewHeight !== hostMetrics.viewHeight ||\n        this.oldHostMetrics_.absoluteTop !== hostMetrics.absoluteTop\n      ) {\n        this.corner_?.setAttribute('y', String(this.hScroll.position.y));\n      }\n    }\n\n    // Cache the current metrics to potentially short-cut the next resize event.\n    this.oldHostMetrics_ = hostMetrics;\n  }\n\n  /**\n   * Returns whether scrolling horizontally is enabled.\n   *\n   * @returns True if horizontal scroll is enabled.\n   */\n  canScrollHorizontally(): boolean {\n    return !!this.hScroll;\n  }\n\n  /**\n   * Returns whether scrolling vertically is enabled.\n   *\n   * @returns True if vertical scroll is enabled.\n   */\n  canScrollVertically(): boolean {\n    return !!this.vScroll;\n  }\n\n  /**\n   * Record the origin of the workspace that the scrollbar is in, in pixels\n   * relative to the injection div origin. This is for times when the scrollbar\n   * is used in an object whose origin isn't the same as the main workspace\n   * (e.g. in a flyout.)\n   *\n   * @param x The x coordinate of the scrollbar's origin, in CSS pixels.\n   * @param y The y coordinate of the scrollbar's origin, in CSS pixels.\n   * @internal\n   */\n  setOrigin(x: number, y: number) {\n    if (this.hScroll) {\n      this.hScroll.setOrigin(x, y);\n    }\n    if (this.vScroll) {\n      this.vScroll.setOrigin(x, y);\n    }\n  }\n\n  /**\n   * Set the handles of both scrollbars.\n   *\n   * @param x The horizontal content displacement, relative to the view in\n   *     pixels.\n   * @param y The vertical content displacement, relative to the view in pixels.\n   * @param updateMetrics Whether to update metrics on this set call.\n   *    Defaults to true.\n   */\n  set(x: number, y: number, updateMetrics: boolean) {\n    // This function is equivalent to:\n    //   this.hScroll.set(x);\n    //   this.vScroll.set(y);\n    // However, that calls setMetrics twice which causes a chain of\n    // getAttribute->setAttribute->getAttribute resulting in an extra layout\n    // pass. Combining them speeds up rendering.\n    if (this.hScroll) {\n      this.hScroll.set(x, false);\n    }\n    if (this.vScroll) {\n      this.vScroll.set(y, false);\n    }\n\n    if (updateMetrics || updateMetrics === undefined) {\n      // Update metrics.\n      const xyRatio: {x?: number; y?: number} = {};\n      if (this.hScroll) {\n        xyRatio.x = this.hScroll.getRatio_();\n      }\n      if (this.vScroll) {\n        xyRatio.y = this.vScroll.getRatio_();\n      }\n      this.workspace.setMetrics(xyRatio);\n    }\n  }\n\n  /**\n   * Set the handle of the horizontal scrollbar to be at a certain position in\n   *    CSS pixels relative to its parents.\n   *\n   * @param x Horizontal scroll value.\n   */\n  setX(x: number) {\n    if (this.hScroll) {\n      this.hScroll.set(x, true);\n    }\n  }\n\n  /**\n   * Set the handle of the vertical scrollbar to be at a certain position in\n   *    CSS pixels relative to its parents.\n   *\n   * @param y Vertical scroll value.\n   */\n  setY(y: number) {\n    if (this.vScroll) {\n      this.vScroll.set(y, true);\n    }\n  }\n\n  /**\n   * Set whether this scrollbar's container is visible.\n   *\n   * @param visible Whether the container is visible.\n   */\n  setContainerVisible(visible: boolean) {\n    if (this.hScroll) {\n      this.hScroll.setContainerVisible(visible);\n    }\n    if (this.vScroll) {\n      this.vScroll.setContainerVisible(visible);\n    }\n  }\n\n  /**\n   * If any of the scrollbars are visible. Non-paired scrollbars may disappear\n   * when they aren't needed.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    let isVisible = false;\n    if (this.hScroll) {\n      isVisible = this.hScroll.isVisible();\n    }\n    if (this.vScroll) {\n      isVisible = isVisible || this.vScroll.isVisible();\n    }\n    return isVisible;\n  }\n\n  /**\n   * Sets the visibility of any existing scrollbars.\n   *\n   * @param visible True if visible.\n   */\n  setVisible(visible: boolean) {\n    if (this.hScroll) this.hScroll.setVisibleInternal(visible);\n    if (this.vScroll) this.vScroll.setVisibleInternal(visible);\n  }\n\n  /**\n   * Recalculates the scrollbars' locations within their path and length.\n   * This should be called when the contents of the workspace have changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeContent(hostMetrics: Metrics) {\n    if (this.hScroll) {\n      this.hScroll.resizeContentHorizontal(hostMetrics);\n    }\n    if (this.vScroll) {\n      this.vScroll.resizeContentVertical(hostMetrics);\n    }\n  }\n\n  /**\n   * Recalculates the scrollbars' locations on the screen and path length.\n   * This should be called when the layout or size of the window has changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeView(hostMetrics: Metrics) {\n    if (this.hScroll) {\n      this.hScroll.resizeViewHorizontal(hostMetrics);\n    }\n    if (this.vScroll) {\n      this.vScroll.resizeViewVertical(hostMetrics);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Calculates and reports workspace metrics.\n *\n * @class\n */\n// Former goog.module ID: Blockly.MetricsManager\n\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport type {IToolbox} from './interfaces/i_toolbox.js';\nimport * as registry from './registry.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Size} from './utils/size.js';\nimport * as toolboxUtils from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * The manager for all workspace metrics calculations.\n */\nexport class MetricsManager implements IMetricsManager {\n  /** The workspace to calculate metrics for. */\n  protected readonly workspace_: WorkspaceSvg;\n\n  /** @param workspace The workspace to calculate metrics for. */\n  constructor(workspace: WorkspaceSvg) {\n    this.workspace_ = workspace;\n  }\n\n  /**\n   * Gets the dimensions of the given workspace component, in pixel coordinates.\n   *\n   * @param elem The element to get the dimensions of, or null.  It should be a\n   *     toolbox or flyout, and should implement getWidth() and getHeight().\n   * @returns An object containing width and height attributes, which will both\n   *     be zero if elem did not exist.\n   */\n  protected getDimensionsPx_(elem: IToolbox | null | IFlyout): Size {\n    let width = 0;\n    let height = 0;\n    if (elem) {\n      width = elem.getWidth();\n      height = elem.getHeight();\n    }\n    return new Size(width, height);\n  }\n\n  /**\n   * Gets the width and the height of the flyout in pixel\n   * coordinates. By default, will get metrics for either a simple flyout (owned\n   * directly by the workspace) or for the flyout owned by the toolbox. If you\n   * pass `opt_own` as `true` then only metrics for the simple flyout will be\n   * returned, and it will return 0 for the width and height if the workspace\n   * has a category toolbox instead of a simple toolbox.\n   *\n   * @param opt_own Whether to only return the workspace's own flyout metrics.\n   * @returns The width and height of the flyout.\n   */\n  getFlyoutMetrics(opt_own?: boolean): ToolboxMetrics {\n    const flyoutDimensions = this.getDimensionsPx_(\n      this.workspace_.getFlyout(opt_own),\n    );\n    return {\n      width: flyoutDimensions.width,\n      height: flyoutDimensions.height,\n      position: this.workspace_.toolboxPosition,\n    };\n  }\n\n  /**\n   * Gets the width, height and position of the toolbox on the workspace in\n   * pixel coordinates. Returns 0 for the width and height if the workspace has\n   * a simple toolbox instead of a category toolbox. To get the width and height\n   * of a simple toolbox, see {@link MetricsManager#getFlyoutMetrics}.\n   *\n   * @returns The object with the width, height and position of the toolbox.\n   */\n  getToolboxMetrics(): ToolboxMetrics {\n    const toolboxDimensions = this.getDimensionsPx_(\n      this.workspace_.getToolbox(),\n    );\n\n    return {\n      width: toolboxDimensions.width,\n      height: toolboxDimensions.height,\n      position: this.workspace_.toolboxPosition,\n    };\n  }\n\n  /**\n   * Gets the width and height of the workspace's parent SVG element in pixel\n   * coordinates. This area includes the toolbox and the visible workspace area.\n   *\n   * @returns The width and height of the workspace's parent SVG element.\n   */\n  getSvgMetrics(): Size {\n    return this.workspace_.getCachedParentSvgSize();\n  }\n\n  /**\n   * Gets the absolute left and absolute top in pixel coordinates.\n   * This is where the visible workspace starts in relation to the SVG\n   * container.\n   *\n   * @returns The absolute metrics for the workspace.\n   */\n  getAbsoluteMetrics(): AbsoluteMetrics {\n    let absoluteLeft = 0;\n    let absoluteTop = 0;\n\n    const toolboxMetrics = this.getToolboxMetrics();\n    const flyoutMetrics = this.getFlyoutMetrics();\n    const respectToolbox = !!this.workspace_.getToolbox();\n    const respectFlyout = !this.workspace_.getFlyout()?.autoClose;\n    const toolboxPosition = respectToolbox\n      ? toolboxMetrics.position\n      : flyoutMetrics.position;\n\n    const atLeft = toolboxPosition === toolboxUtils.Position.LEFT;\n    const atTop = toolboxPosition === toolboxUtils.Position.TOP;\n    if (atLeft) {\n      if (respectToolbox) absoluteLeft += toolboxMetrics.width;\n      if (respectFlyout) absoluteLeft += flyoutMetrics.width;\n    }\n    if (atTop) {\n      if (respectToolbox) absoluteTop += toolboxMetrics.height;\n      if (respectFlyout) absoluteTop += flyoutMetrics.height;\n    }\n\n    return {\n      top: absoluteTop,\n      left: absoluteLeft,\n    };\n  }\n\n  /**\n   * Gets the metrics for the visible workspace in either pixel or workspace\n   * coordinates. The visible workspace does not include the toolbox or flyout.\n   *\n   * @param opt_getWorkspaceCoordinates True to get the view metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @returns The width, height, top and left of the viewport in either\n   *     workspace coordinates or pixel coordinates.\n   */\n  getViewMetrics(opt_getWorkspaceCoordinates?: boolean): ContainerRegion {\n    const scale = opt_getWorkspaceCoordinates ? this.workspace_.scale : 1;\n    const svgMetrics = this.getSvgMetrics();\n    const toolboxMetrics = this.getToolboxMetrics();\n    const flyoutMetrics = this.getFlyoutMetrics();\n    const respectToolbox = !!this.workspace_.getToolbox();\n    const respectFlyout = !this.workspace_.getFlyout()?.autoClose;\n    const toolboxPosition = respectToolbox\n      ? toolboxMetrics.position\n      : flyoutMetrics.position;\n\n    const horizToolbox =\n      toolboxPosition === toolboxUtils.Position.TOP ||\n      toolboxPosition === toolboxUtils.Position.BOTTOM;\n    const vertToolbox =\n      toolboxPosition === toolboxUtils.Position.LEFT ||\n      toolboxPosition === toolboxUtils.Position.RIGHT;\n    if (horizToolbox) {\n      if (respectToolbox) svgMetrics.height -= toolboxMetrics.height;\n      if (respectFlyout) svgMetrics.height -= flyoutMetrics.height;\n    }\n    if (vertToolbox) {\n      if (respectToolbox) svgMetrics.width -= toolboxMetrics.width;\n      if (respectFlyout) svgMetrics.width -= flyoutMetrics.width;\n    }\n    return {\n      height: svgMetrics.height / scale,\n      width: svgMetrics.width / scale,\n      top: -this.workspace_.scrollY / scale,\n      left: -this.workspace_.scrollX / scale,\n    };\n  }\n\n  /**\n   * Gets content metrics in either pixel or workspace coordinates.\n   * The content area is a rectangle around all the top bounded elements on the\n   * workspace (workspace comments and blocks).\n   *\n   * @param opt_getWorkspaceCoordinates True to get the content metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @returns The metrics for the content container.\n   */\n  getContentMetrics(opt_getWorkspaceCoordinates?: boolean): ContainerRegion {\n    const scale = opt_getWorkspaceCoordinates ? 1 : this.workspace_.scale;\n    // Block bounding box is in workspace coordinates.\n    const blockBox = this.workspace_.getBlocksBoundingBox();\n\n    return {\n      height: (blockBox.bottom - blockBox.top) * scale,\n      width: (blockBox.right - blockBox.left) * scale,\n      top: blockBox.top * scale,\n      left: blockBox.left * scale,\n    };\n  }\n\n  /**\n   * Returns whether the scroll area has fixed edges.\n   *\n   * @returns Whether the scroll area has fixed edges.\n   * @internal\n   */\n  hasFixedEdges(): boolean {\n    // This exists for optimization of bump logic.\n    return (\n      !this.workspace_.isMovableHorizontally() ||\n      !this.workspace_.isMovableVertically()\n    );\n  }\n\n  /**\n   * Computes the fixed edges of the scroll area.\n   *\n   * @param opt_viewMetrics The view metrics if they have been previously\n   *     computed. Passing in null may cause the view metrics to be computed\n   *     again, if it is needed.\n   * @returns The fixed edges of the scroll area.\n   */\n  protected getComputedFixedEdges_(\n    opt_viewMetrics?: ContainerRegion,\n  ): FixedEdges {\n    if (!this.hasFixedEdges()) {\n      // Return early if there are no edges.\n      return {};\n    }\n\n    const hScrollEnabled = this.workspace_.isMovableHorizontally();\n    const vScrollEnabled = this.workspace_.isMovableVertically();\n\n    const viewMetrics = opt_viewMetrics || this.getViewMetrics(false);\n\n    const edges = {} as FixedEdges;\n    if (!vScrollEnabled) {\n      edges.top = viewMetrics.top;\n      edges.bottom = viewMetrics.top + viewMetrics.height;\n    }\n    if (!hScrollEnabled) {\n      edges.left = viewMetrics.left;\n      edges.right = viewMetrics.left + viewMetrics.width;\n    }\n    return edges;\n  }\n\n  /**\n   * Returns the content area with added padding.\n   *\n   * @param viewMetrics The view metrics.\n   * @param contentMetrics The content metrics.\n   * @returns The padded content area.\n   */\n  protected getPaddedContent_(\n    viewMetrics: ContainerRegion,\n    contentMetrics: ContainerRegion,\n  ): {top: number; bottom: number; left: number; right: number} {\n    const contentBottom = contentMetrics.top + contentMetrics.height;\n    const contentRight = contentMetrics.left + contentMetrics.width;\n\n    const viewWidth = viewMetrics.width;\n    const viewHeight = viewMetrics.height;\n    const halfWidth = viewWidth / 2;\n    const halfHeight = viewHeight / 2;\n\n    // Add a padding around the content that is at least half a screen wide.\n    // Ensure padding is wide enough that blocks can scroll over entire screen.\n    const top = Math.min(\n      contentMetrics.top - halfHeight,\n      contentBottom - viewHeight,\n    );\n    const left = Math.min(\n      contentMetrics.left - halfWidth,\n      contentRight - viewWidth,\n    );\n    const bottom = Math.max(\n      contentBottom + halfHeight,\n      contentMetrics.top + viewHeight,\n    );\n    const right = Math.max(\n      contentRight + halfWidth,\n      contentMetrics.left + viewWidth,\n    );\n\n    return {top, bottom, left, right};\n  }\n\n  /**\n   * Returns the metrics for the scroll area of the workspace.\n   *\n   * @param opt_getWorkspaceCoordinates True to get the scroll metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @param opt_viewMetrics The view metrics if they have been previously\n   *     computed. Passing in null may cause the view metrics to be computed\n   *     again, if it is needed.\n   * @param opt_contentMetrics The content metrics if they have been previously\n   *     computed. Passing in null may cause the content metrics to be computed\n   *     again, if it is needed.\n   * @returns The metrics for the scroll container.\n   */\n  getScrollMetrics(\n    opt_getWorkspaceCoordinates?: boolean,\n    opt_viewMetrics?: ContainerRegion,\n    opt_contentMetrics?: ContainerRegion,\n  ): ContainerRegion {\n    const scale = opt_getWorkspaceCoordinates ? this.workspace_.scale : 1;\n    const viewMetrics = opt_viewMetrics || this.getViewMetrics(false);\n    const contentMetrics = opt_contentMetrics || this.getContentMetrics();\n    const fixedEdges = this.getComputedFixedEdges_(viewMetrics);\n\n    // Add padding around content.\n    const paddedContent = this.getPaddedContent_(viewMetrics, contentMetrics);\n\n    // Use combination of fixed bounds and padded content to make scroll area.\n    const top =\n      fixedEdges.top !== undefined ? fixedEdges.top : paddedContent.top;\n    const left =\n      fixedEdges.left !== undefined ? fixedEdges.left : paddedContent.left;\n    const bottom =\n      fixedEdges.bottom !== undefined\n        ? fixedEdges.bottom\n        : paddedContent.bottom;\n    const right =\n      fixedEdges.right !== undefined ? fixedEdges.right : paddedContent.right;\n\n    return {\n      top: top / scale,\n      left: left / scale,\n      width: (right - left) / scale,\n      height: (bottom - top) / scale,\n    };\n  }\n\n  /**\n   * Returns common metrics used by UI elements.\n   *\n   * @returns The UI metrics.\n   */\n  getUiMetrics(): UiMetrics {\n    return {\n      viewMetrics: this.getViewMetrics(),\n      absoluteMetrics: this.getAbsoluteMetrics(),\n      toolboxMetrics: this.getToolboxMetrics(),\n    };\n  }\n\n  /**\n   * Returns an object with all the metrics required to size scrollbars for a\n   * top level workspace.  The following properties are computed:\n   * Coordinate system: pixel coordinates, -left, -up, +right, +down\n   * .viewHeight: Height of the visible portion of the workspace.\n   * .viewWidth: Width of the visible portion of the workspace.\n   * .contentHeight: Height of the content.\n   * .contentWidth: Width of the content.\n   * .scrollHeight: Height of the scroll area.\n   * .scrollWidth: Width of the scroll area.\n   * .svgHeight: Height of the Blockly div (the view + the toolbox,\n   *    simple or otherwise),\n   * .svgWidth: Width of the Blockly div (the view + the toolbox,\n   *    simple or otherwise),\n   * .viewTop: Top-edge of the visible portion of the workspace, relative to\n   *     the workspace origin.\n   * .viewLeft: Left-edge of the visible portion of the workspace, relative to\n   *     the workspace origin.\n   * .contentTop: Top-edge of the content, relative to the workspace origin.\n   * .contentLeft: Left-edge of the content relative to the workspace origin.\n   * .scrollTop: Top-edge of the scroll area, relative to the workspace origin.\n   * .scrollLeft: Left-edge of the scroll area relative to the workspace origin.\n   * .absoluteTop: Top-edge of the visible portion of the workspace, relative\n   *     to the blocklyDiv.\n   * .absoluteLeft: Left-edge of the visible portion of the workspace, relative\n   *     to the blocklyDiv.\n   * .toolboxWidth: Width of the toolbox, if it exists.  Otherwise zero.\n   * .toolboxHeight: Height of the toolbox, if it exists.  Otherwise zero.\n   * .flyoutWidth: Width of the flyout if it is always open.  Otherwise zero.\n   * .flyoutHeight: Height of the flyout if it is always open.  Otherwise zero.\n   * .toolboxPosition: Top, bottom, left or right. Use TOOLBOX_AT constants to\n   *     compare.\n   *\n   * @returns Contains size and position metrics of a top level workspace.\n   */\n  getMetrics(): Metrics {\n    const toolboxMetrics = this.getToolboxMetrics();\n    const flyoutMetrics = this.getFlyoutMetrics(true);\n    const svgMetrics = this.getSvgMetrics();\n    const absoluteMetrics = this.getAbsoluteMetrics();\n    const viewMetrics = this.getViewMetrics();\n    const contentMetrics = this.getContentMetrics();\n    const scrollMetrics = this.getScrollMetrics(\n      false,\n      viewMetrics,\n      contentMetrics,\n    );\n\n    return {\n      contentHeight: contentMetrics.height,\n      contentWidth: contentMetrics.width,\n      contentTop: contentMetrics.top,\n      contentLeft: contentMetrics.left,\n\n      scrollHeight: scrollMetrics.height,\n      scrollWidth: scrollMetrics.width,\n      scrollTop: scrollMetrics.top,\n      scrollLeft: scrollMetrics.left,\n\n      viewHeight: viewMetrics.height,\n      viewWidth: viewMetrics.width,\n      viewTop: viewMetrics.top,\n      viewLeft: viewMetrics.left,\n\n      absoluteTop: absoluteMetrics.top,\n      absoluteLeft: absoluteMetrics.left,\n\n      svgHeight: svgMetrics.height,\n      svgWidth: svgMetrics.width,\n\n      toolboxWidth: toolboxMetrics.width,\n      toolboxHeight: toolboxMetrics.height,\n      toolboxPosition: toolboxMetrics.position,\n\n      flyoutWidth: flyoutMetrics.width,\n      flyoutHeight: flyoutMetrics.height,\n    };\n  }\n}\n\nexport namespace MetricsManager {\n  /**\n   * Describes the width, height and location of the toolbox on the main\n   * workspace.\n   */\n  export interface ToolboxMetrics {\n    width: number;\n    height: number;\n    position: toolboxUtils.Position;\n  }\n\n  /** Describes where the viewport starts in relation to the workspace SVG. */\n  export interface AbsoluteMetrics {\n    left: number;\n    top: number;\n  }\n\n  /**\n   * All the measurements needed to describe the size and location of a\n   * container.\n   */\n  export interface ContainerRegion {\n    height: number;\n    width: number;\n    top: number;\n    left: number;\n  }\n\n  /** Describes fixed edges of the workspace. */\n  export interface FixedEdges {\n    top?: number;\n    bottom?: number;\n    left?: number;\n    right?: number;\n  }\n\n  /** Common metrics used for UI elements. */\n  export interface UiMetrics {\n    viewMetrics: ContainerRegion;\n    absoluteMetrics: AbsoluteMetrics;\n    toolboxMetrics: ToolboxMetrics;\n  }\n}\n\nexport type ToolboxMetrics = MetricsManager.ToolboxMetrics;\nexport type AbsoluteMetrics = MetricsManager.AbsoluteMetrics;\nexport type ContainerRegion = MetricsManager.ContainerRegion;\nexport type FixedEdges = MetricsManager.FixedEdges;\nexport type UiMetrics = MetricsManager.UiMetrics;\n\nregistry.register(\n  registry.Type.METRICS_MANAGER,\n  registry.DEFAULT,\n  MetricsManager,\n);\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @file The entrypoint for blockly_compressed.js.  Provides various\n * backwards-compatibility hacks.  Not used when loading in\n * uncompressed mode.\n */\n\n// Former goog.module ID: Blockly.main\n\nimport * as Msg from './msg.js';\n\n// If Blockly is compiled with ADVANCED_COMPILATION and/or loaded as a\n// CJS or ES module there will not be a Blockly global variable\n// created.  This can cause problems because a very common way of\n// loading translations is to use a <script> tag to load one of\n// the generated msg/*.js files, which consists of lines like:\n//\n// Blockly.Msg[\"ADD_COMMENT\"] = \"Add Comment\";\n// Blockly.Msg[\"CLEAN_UP\"] = \"Clean up Blocks\";\n//\n// This obviously only works if Blockly.Msg is the Msg export from the\n// Blockly.Msg module - so make sure it is, but only if there is not\n// yet a Blockly global variable.\nif (!('Blockly' in globalThis)) {\n  (globalThis as any)['Blockly'] = {'Msg': Msg};\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.ConstantProvider\n\nimport {ConnectionType} from '../../connection_type.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {Theme} from '../../theme.js';\nimport * as utilsColour from '../../utils/colour.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport {ConstantProvider as BaseConstantProvider} from '../common/constants.js';\nimport type {Shape} from '../common/constants.js';\n\n/** An object containing sizing and path information about inside corners. */\nexport interface InsideCorners {\n  width: number;\n  height: number;\n  pathTop: string;\n  pathBottom: string;\n  rightWidth: number;\n  rightHeight: number;\n  pathTopRight: string;\n  pathBottomRight: string;\n}\n\n/**\n * An object that provides constants for rendering blocks in Zelos mode.\n */\nexport class ConstantProvider extends BaseConstantProvider {\n  GRID_UNIT = 4;\n  STATEMENT_INPUT_SPACER_MIN_WIDTH: number;\n\n  override CURSOR_COLOUR = '#ffa200';\n\n  /**\n   * Radius of the cursor for input and output connections.\n   */\n  CURSOR_RADIUS = 5;\n\n  override JAGGED_TEETH_HEIGHT = 0;\n\n  override JAGGED_TEETH_WIDTH = 0;\n  override START_HAT_HEIGHT = 22;\n\n  override START_HAT_WIDTH = 96;\n\n  override SHAPES = {HEXAGONAL: 1, ROUND: 2, SQUARE: 3, PUZZLE: 4, NOTCH: 5};\n\n  /**\n   * Map of output/input shapes and the amount they should cause a block to be\n   * padded. Outer key is the outer shape, inner key is the inner shape.\n   * When a block with the outer shape contains an input block with the inner\n   * shape on its left or right edge, the block elements are aligned such that\n   * the padding specified is reached.\n   */\n  SHAPE_IN_SHAPE_PADDING: {[key: number]: {[key: number]: number}} = {\n    1: {\n      // Outer shape: hexagon.\n      0: 5 * this.GRID_UNIT, // Field in hexagon.\n      1: 2 * this.GRID_UNIT, // Hexagon in hexagon.\n      2: 5 * this.GRID_UNIT, // Round in hexagon.\n      3: 5 * this.GRID_UNIT, // Square in hexagon.\n    },\n    2: {\n      // Outer shape: round.\n      0: 3 * this.GRID_UNIT, // Field in round.\n      1: 3 * this.GRID_UNIT, // Hexagon in round.\n      2: 1 * this.GRID_UNIT, // Round in round.\n      3: 2 * this.GRID_UNIT, // Square in round.\n    },\n    3: {\n      // Outer shape: square.\n      0: 2 * this.GRID_UNIT, // Field in square.\n      1: 2 * this.GRID_UNIT, // Hexagon in square.\n      2: 2 * this.GRID_UNIT, // Round in square.\n      3: 2 * this.GRID_UNIT, // Square in square.\n    },\n  };\n\n  override FULL_BLOCK_FIELDS = true;\n\n  override FIELD_TEXT_FONTWEIGHT = 'bold';\n\n  override FIELD_TEXT_FONTFAMILY =\n    '\"Helvetica Neue\", \"Segoe UI\", Helvetica, sans-serif';\n\n  override FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW = true;\n\n  override FIELD_DROPDOWN_COLOURED_DIV = true;\n\n  override FIELD_DROPDOWN_SVG_ARROW = true;\n  override FIELD_TEXTINPUT_BOX_SHADOW = true;\n\n  override FIELD_COLOUR_FULL_BLOCK = true;\n  MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH: number;\n\n  /** The selected glow colour. */\n  SELECTED_GLOW_COLOUR = '#fff200';\n\n  /** The size of the selected glow. */\n  SELECTED_GLOW_SIZE = 0.5;\n\n  /** The replacement glow colour. */\n  REPLACEMENT_GLOW_COLOUR = '#fff200';\n\n  /** The size of the selected glow. */\n  REPLACEMENT_GLOW_SIZE = 2;\n\n  /**\n   * The ID of the selected glow filter, or the empty string if no filter is\n   * set.\n   */\n  selectedGlowFilterId = '';\n\n  /**\n   * The <filter> element to use for a selected glow, or null if not set.\n   */\n  private selectedGlowFilter: SVGElement | null = null;\n\n  /**\n   * The ID of the replacement glow filter, or the empty string if no filter\n   * is set.\n   */\n  replacementGlowFilterId = '';\n\n  /**\n   * The <filter> element to use for a replacement glow, or null if not set.\n   */\n  private replacementGlowFilter: SVGElement | null = null;\n\n  /**\n   * The object containing information about the hexagon used for a boolean\n   * reporter block. Null before init is called.\n   */\n  HEXAGONAL: Shape | null = null;\n\n  /**\n   * The object containing information about the hexagon used for a number or\n   * string reporter block. Null before init is called.\n   */\n  ROUNDED: Shape | null = null;\n\n  /**\n   * The object containing information about the hexagon used for a\n   * rectangular reporter block. Null before init is called.\n   */\n  SQUARED: Shape | null = null;\n\n  constructor() {\n    super();\n\n    this.SMALL_PADDING = this.GRID_UNIT;\n\n    this.MEDIUM_PADDING = 2 * this.GRID_UNIT;\n\n    this.MEDIUM_LARGE_PADDING = 3 * this.GRID_UNIT;\n\n    this.LARGE_PADDING = 4 * this.GRID_UNIT;\n\n    this.CORNER_RADIUS = 1 * this.GRID_UNIT;\n\n    this.NOTCH_WIDTH = 9 * this.GRID_UNIT;\n\n    this.NOTCH_HEIGHT = 2 * this.GRID_UNIT;\n\n    this.NOTCH_OFFSET_LEFT = 3 * this.GRID_UNIT;\n\n    this.STATEMENT_INPUT_NOTCH_OFFSET = this.NOTCH_OFFSET_LEFT;\n\n    this.MIN_BLOCK_WIDTH = 2 * this.GRID_UNIT;\n\n    this.MIN_BLOCK_HEIGHT = 12 * this.GRID_UNIT;\n\n    this.EMPTY_STATEMENT_INPUT_HEIGHT = 6 * this.GRID_UNIT;\n\n    this.TOP_ROW_MIN_HEIGHT = this.CORNER_RADIUS;\n\n    this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT = this.LARGE_PADDING;\n\n    this.BOTTOM_ROW_MIN_HEIGHT = this.CORNER_RADIUS;\n\n    this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT = 6 * this.GRID_UNIT;\n\n    this.STATEMENT_BOTTOM_SPACER = -this.NOTCH_HEIGHT;\n\n    /** Minimum statement input spacer width. */\n    this.STATEMENT_INPUT_SPACER_MIN_WIDTH = 40 * this.GRID_UNIT;\n\n    this.STATEMENT_INPUT_PADDING_LEFT = 4 * this.GRID_UNIT;\n\n    this.EMPTY_INLINE_INPUT_PADDING = 4 * this.GRID_UNIT;\n\n    this.EMPTY_INLINE_INPUT_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.DUMMY_INPUT_MIN_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.DUMMY_INPUT_SHADOW_MIN_HEIGHT = 6 * this.GRID_UNIT;\n\n    this.CURSOR_WS_WIDTH = 20 * this.GRID_UNIT;\n\n    this.FIELD_TEXT_FONTSIZE = 3 * this.GRID_UNIT;\n\n    this.FIELD_BORDER_RECT_RADIUS = this.CORNER_RADIUS;\n\n    this.FIELD_BORDER_RECT_X_PADDING = 2 * this.GRID_UNIT;\n\n    this.FIELD_BORDER_RECT_Y_PADDING = 1.625 * this.GRID_UNIT;\n\n    this.FIELD_BORDER_RECT_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.FIELD_DROPDOWN_SVG_ARROW_PADDING = this.FIELD_BORDER_RECT_X_PADDING;\n\n    this.FIELD_COLOUR_DEFAULT_WIDTH = 6 * this.GRID_UNIT;\n\n    this.FIELD_COLOUR_DEFAULT_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.FIELD_CHECKBOX_X_OFFSET = 1 * this.GRID_UNIT;\n\n    /** The maximum width of a dynamic connection shape. */\n    this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH = 12 * this.GRID_UNIT;\n  }\n\n  override setFontConstants_(theme: Theme) {\n    super.setFontConstants_(theme);\n\n    this.FIELD_BORDER_RECT_HEIGHT =\n      this.FIELD_TEXT_HEIGHT + this.FIELD_BORDER_RECT_Y_PADDING * 2;\n    this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT = this.FIELD_BORDER_RECT_HEIGHT;\n  }\n\n  override init() {\n    super.init();\n    this.HEXAGONAL = this.makeHexagonal();\n    this.ROUNDED = this.makeRounded();\n    this.SQUARED = this.makeSquared();\n\n    this.STATEMENT_INPUT_NOTCH_OFFSET =\n      this.NOTCH_OFFSET_LEFT +\n      (this.INSIDE_CORNERS as InsideCorners).rightWidth;\n  }\n\n  override setDynamicProperties_(theme: Theme) {\n    super.setDynamicProperties_(theme);\n\n    this.SELECTED_GLOW_COLOUR =\n      theme.getComponentStyle('selectedGlowColour') ||\n      this.SELECTED_GLOW_COLOUR;\n    const selectedGlowSize = Number(\n      theme.getComponentStyle('selectedGlowSize'),\n    );\n    this.SELECTED_GLOW_SIZE =\n      selectedGlowSize && !isNaN(selectedGlowSize)\n        ? selectedGlowSize\n        : this.SELECTED_GLOW_SIZE;\n    this.REPLACEMENT_GLOW_COLOUR =\n      theme.getComponentStyle('replacementGlowColour') ||\n      this.REPLACEMENT_GLOW_COLOUR;\n    const replacementGlowSize = Number(\n      theme.getComponentStyle('replacementGlowSize'),\n    );\n    this.REPLACEMENT_GLOW_SIZE =\n      replacementGlowSize && !isNaN(replacementGlowSize)\n        ? replacementGlowSize\n        : this.REPLACEMENT_GLOW_SIZE;\n  }\n\n  override dispose() {\n    super.dispose();\n    if (this.selectedGlowFilter) {\n      dom.removeNode(this.selectedGlowFilter);\n    }\n    if (this.replacementGlowFilter) {\n      dom.removeNode(this.replacementGlowFilter);\n    }\n  }\n\n  override makeStartHat() {\n    const height = this.START_HAT_HEIGHT;\n    const width = this.START_HAT_WIDTH;\n\n    const mainPath = svgPaths.curve('c', [\n      svgPaths.point(25, -height),\n      svgPaths.point(71, -height),\n      svgPaths.point(width, 0),\n    ]);\n    return {height, width, path: mainPath};\n  }\n\n  /**\n   * Create sizing and path information about a hexagonal shape.\n   *\n   * @returns An object containing sizing and path information about a hexagonal\n   *     shape for connections.\n   */\n  protected makeHexagonal(): Shape {\n    const maxWidth = this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;\n\n    /**\n     * Make the main path for the hexagonal connection shape out of two lines.\n     * The lines are defined with relative positions and require the block\n     * height. The 'up' and 'down' versions of the paths are the same, but the Y\n     * sign flips.  The 'left' and 'right' versions of the path are also the\n     * same, but the X sign flips.\n     *\n     * @param height The height of the block the connection is on.\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @param right True if the path is for the right side of the block.\n     * @returns A path fragment describing a rounded connection.\n     */\n    function makeMainPath(height: number, up: boolean, right: boolean): string {\n      const halfHeight = height / 2;\n      const width = halfHeight > maxWidth ? maxWidth : halfHeight;\n      const forward = up ? -1 : 1;\n      const direction = right ? -1 : 1;\n      const dy = (forward * height) / 2;\n      return (\n        svgPaths.lineTo(-direction * width, dy) +\n        svgPaths.lineTo(direction * width, dy)\n      );\n    }\n\n    return {\n      type: this.SHAPES.HEXAGONAL,\n      isDynamic: true,\n      width(height: number): number {\n        const halfHeight = height / 2;\n        return halfHeight > maxWidth ? maxWidth : halfHeight;\n      },\n      height(height: number): number {\n        return height;\n      },\n      connectionOffsetY(connectionHeight: number): number {\n        return connectionHeight / 2;\n      },\n      connectionOffsetX(connectionWidth: number): number {\n        return -connectionWidth;\n      },\n      pathDown(height: number): string {\n        return makeMainPath(height, false, false);\n      },\n      pathUp(height: number): string {\n        return makeMainPath(height, true, false);\n      },\n      pathRightDown(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n      pathRightUp(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n    };\n  }\n\n  /**\n   * Create sizing and path information about a rounded shape.\n   *\n   * @returns An object containing sizing and path information about a rounded\n   *     shape for connections.\n   */\n  protected makeRounded(): Shape {\n    const maxWidth = this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;\n    const maxHeight = maxWidth * 2;\n\n    /**\n     * Make the main path for the rounded connection shape out of two arcs and\n     * a line that joins them.  The arcs are defined with relative positions.\n     * Usually, the height of the block is split between the two arcs. In the\n     * case where the height of the block exceeds the maximum height, a line is\n     * drawn in between the two arcs. The 'up' and 'down' versions of the paths\n     * are the same, but the Y sign flips.  The 'up' and 'right' versions of the\n     * path flip the sweep-flag which moves the arc at negative angles.\n     *\n     * @param blockHeight The height of the block the connection is on.\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @param right True if the path is for the right side of the block.\n     * @returns A path fragment describing a rounded connection.\n     */\n    function makeMainPath(\n      blockHeight: number,\n      up: boolean,\n      right: boolean,\n    ): string {\n      const remainingHeight =\n        blockHeight > maxHeight ? blockHeight - maxHeight : 0;\n      const height = blockHeight > maxHeight ? maxHeight : blockHeight;\n      const radius = height / 2;\n      const sweep = right === up ? '0' : '1';\n      return (\n        svgPaths.arc(\n          'a',\n          '0 0,' + sweep,\n          radius,\n          svgPaths.point((right ? 1 : -1) * radius, (up ? -1 : 1) * radius),\n        ) +\n        svgPaths.lineOnAxis('v', (up ? -1 : 1) * remainingHeight) +\n        svgPaths.arc(\n          'a',\n          '0 0,' + sweep,\n          radius,\n          svgPaths.point((right ? -1 : 1) * radius, (up ? -1 : 1) * radius),\n        )\n      );\n    }\n\n    return {\n      type: this.SHAPES.ROUND,\n      isDynamic: true,\n      width(height: number): number {\n        const halfHeight = height / 2;\n        return halfHeight > maxWidth ? maxWidth : halfHeight;\n      },\n      height(height: number): number {\n        return height;\n      },\n      connectionOffsetY(connectionHeight: number): number {\n        return connectionHeight / 2;\n      },\n      connectionOffsetX(connectionWidth: number): number {\n        return -connectionWidth;\n      },\n      pathDown(height: number): string {\n        return makeMainPath(height, false, false);\n      },\n      pathUp(height: number): string {\n        return makeMainPath(height, true, false);\n      },\n      pathRightDown(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n      pathRightUp(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n    };\n  }\n\n  /**\n   * Create sizing and path information about a squared shape.\n   *\n   * @returns An object containing sizing and path information about a squared\n   *     shape for connections.\n   */\n  protected makeSquared(): Shape {\n    const radius = this.CORNER_RADIUS;\n\n    /**\n     * Make the main path for the squared connection shape out of two corners\n     * and a single line in-between (a and v). These are defined in relative\n     * positions and require the height of the block.\n     * The 'left' and 'right' versions of the paths are the same, but the Y sign\n     * flips.  The 'up' and 'down' versions of the path determine where the\n     * corner point is placed and in turn the direction of the corners.\n     *\n     * @param height The height of the block the connection is on.\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @param right True if the path is for the right side of the block.\n     * @returns A path fragment describing a squared connection.\n     */\n    function makeMainPath(height: number, up: boolean, right: boolean): string {\n      const innerHeight = height - radius * 2;\n      const sweep = right === up ? '0' : '1';\n      return (\n        svgPaths.arc(\n          'a',\n          '0 0,' + sweep,\n          radius,\n          svgPaths.point((right ? 1 : -1) * radius, (up ? -1 : 1) * radius),\n        ) +\n        svgPaths.lineOnAxis('v', (up ? -1 : 1) * innerHeight) +\n        svgPaths.arc(\n          'a',\n          '0 0,' + sweep,\n          radius,\n          svgPaths.point((right ? -1 : 1) * radius, (up ? -1 : 1) * radius),\n        )\n      );\n    }\n\n    return {\n      type: this.SHAPES.SQUARE,\n      isDynamic: true,\n      width(_height: number): number {\n        return radius;\n      },\n      height(height: number): number {\n        return height;\n      },\n      connectionOffsetY(connectionHeight: number): number {\n        return connectionHeight / 2;\n      },\n      connectionOffsetX(connectionWidth: number): number {\n        return -connectionWidth;\n      },\n      pathDown(height: number): string {\n        return makeMainPath(height, false, false);\n      },\n      pathUp(height: number): string {\n        return makeMainPath(height, true, false);\n      },\n      pathRightDown(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n      pathRightUp(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n    };\n  }\n\n  override shapeFor(connection: RenderedConnection): Shape {\n    let checks = connection.getCheck();\n    if (!checks && connection.targetConnection) {\n      checks = connection.targetConnection.getCheck();\n    }\n    let outputShape;\n    switch (connection.type) {\n      case ConnectionType.INPUT_VALUE:\n      case ConnectionType.OUTPUT_VALUE:\n        outputShape = connection.getSourceBlock().getOutputShape();\n        // If the block has an output shape set, use that instead.\n        if (outputShape !== null) {\n          switch (outputShape) {\n            case this.SHAPES.HEXAGONAL:\n              return this.HEXAGONAL!;\n            case this.SHAPES.ROUND:\n              return this.ROUNDED!;\n            case this.SHAPES.SQUARE:\n              return this.SQUARED!;\n          }\n        }\n        // Includes doesn't work in IE.\n        if (checks && checks.includes('Boolean')) {\n          return this.HEXAGONAL!;\n        }\n        if (checks && checks.includes('Number')) {\n          return this.ROUNDED!;\n        }\n        if (checks && checks.includes('String')) {\n          return this.ROUNDED!;\n        }\n        return this.ROUNDED!;\n      case ConnectionType.PREVIOUS_STATEMENT:\n      case ConnectionType.NEXT_STATEMENT:\n        return this.NOTCH!;\n      default:\n        throw Error('Unknown type');\n    }\n  }\n\n  override makeNotch() {\n    const width = this.NOTCH_WIDTH;\n    const height = this.NOTCH_HEIGHT;\n\n    const innerWidth = width / 3;\n    const curveWidth = innerWidth / 3;\n\n    const halfHeight = height / 2;\n    const quarterHeight = halfHeight / 2;\n\n    /**\n     * Make the main path for the notch.\n     *\n     * @param dir Direction multiplier to apply to horizontal offsets along the\n     *     path. Either 1 or -1.\n     * @returns A path fragment describing a notch.\n     */\n    function makeMainPath(dir: number): string {\n      return (\n        svgPaths.curve('c', [\n          svgPaths.point((dir * curveWidth) / 2, 0),\n          svgPaths.point((dir * curveWidth * 3) / 4, quarterHeight / 2),\n          svgPaths.point(dir * curveWidth, quarterHeight),\n        ]) +\n        svgPaths.line([svgPaths.point(dir * curveWidth, halfHeight)]) +\n        svgPaths.curve('c', [\n          svgPaths.point((dir * curveWidth) / 4, quarterHeight / 2),\n          svgPaths.point((dir * curveWidth) / 2, quarterHeight),\n          svgPaths.point(dir * curveWidth, quarterHeight),\n        ]) +\n        svgPaths.lineOnAxis('h', dir * innerWidth) +\n        svgPaths.curve('c', [\n          svgPaths.point((dir * curveWidth) / 2, 0),\n          svgPaths.point((dir * curveWidth * 3) / 4, -(quarterHeight / 2)),\n          svgPaths.point(dir * curveWidth, -quarterHeight),\n        ]) +\n        svgPaths.line([svgPaths.point(dir * curveWidth, -halfHeight)]) +\n        svgPaths.curve('c', [\n          svgPaths.point((dir * curveWidth) / 4, -(quarterHeight / 2)),\n          svgPaths.point((dir * curveWidth) / 2, -quarterHeight),\n          svgPaths.point(dir * curveWidth, -quarterHeight),\n        ])\n      );\n    }\n\n    const pathLeft = makeMainPath(1);\n    const pathRight = makeMainPath(-1);\n\n    return {\n      type: this.SHAPES.NOTCH,\n      width,\n      height,\n      pathLeft,\n      pathRight,\n    };\n  }\n\n  override makeInsideCorners() {\n    const radius = this.CORNER_RADIUS;\n\n    const innerTopLeftCorner = svgPaths.arc(\n      'a',\n      '0 0,0',\n      radius,\n      svgPaths.point(-radius, radius),\n    );\n\n    const innerTopRightCorner = svgPaths.arc(\n      'a',\n      '0 0,1',\n      radius,\n      svgPaths.point(-radius, radius),\n    );\n\n    const innerBottomLeftCorner = svgPaths.arc(\n      'a',\n      '0 0,0',\n      radius,\n      svgPaths.point(radius, radius),\n    );\n\n    const innerBottomRightCorner = svgPaths.arc(\n      'a',\n      '0 0,1',\n      radius,\n      svgPaths.point(radius, radius),\n    );\n\n    return {\n      width: radius,\n      height: radius,\n      pathTop: innerTopLeftCorner,\n      pathBottom: innerBottomLeftCorner,\n      rightWidth: radius,\n      rightHeight: radius,\n      pathTopRight: innerTopRightCorner,\n      pathBottomRight: innerBottomRightCorner,\n    };\n  }\n\n  override generateSecondaryColour_(colour: string) {\n    return utilsColour.blend('#000', colour, 0.15) || colour;\n  }\n\n  override generateTertiaryColour_(colour: string) {\n    return utilsColour.blend('#000', colour, 0.25) || colour;\n  }\n\n  override createDom(svg: SVGElement, tagName: string, selector: string) {\n    super.createDom(svg, tagName, selector);\n    /*\n        <defs>\n          ... filters go here ...\n        </defs>\n        */\n    const defs = dom.createSvgElement(Svg.DEFS, {}, svg);\n    // Using a dilate distorts the block shape.\n    // Instead use a gaussian blur, and then set all alpha to 1 with a transfer.\n    const selectedGlowFilter = dom.createSvgElement(\n      Svg.FILTER,\n      {\n        'id': 'blocklySelectedGlowFilter' + this.randomIdentifier,\n        'height': '160%',\n        'width': '180%',\n        'y': '-30%',\n        'x': '-40%',\n      },\n      defs,\n    );\n    dom.createSvgElement(\n      Svg.FEGAUSSIANBLUR,\n      {'in': 'SourceGraphic', 'stdDeviation': this.SELECTED_GLOW_SIZE},\n      selectedGlowFilter,\n    );\n    // Set all gaussian blur pixels to 1 opacity before applying flood\n    const selectedComponentTransfer = dom.createSvgElement(\n      Svg.FECOMPONENTTRANSFER,\n      {'result': 'outBlur'},\n      selectedGlowFilter,\n    );\n    dom.createSvgElement(\n      Svg.FEFUNCA,\n      {'type': 'table', 'tableValues': '0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1'},\n      selectedComponentTransfer,\n    );\n    // Color the highlight\n    dom.createSvgElement(\n      Svg.FEFLOOD,\n      {\n        'flood-color': this.SELECTED_GLOW_COLOUR,\n        'flood-opacity': 1,\n        'result': 'outColor',\n      },\n      selectedGlowFilter,\n    );\n    dom.createSvgElement(\n      Svg.FECOMPOSITE,\n      {\n        'in': 'outColor',\n        'in2': 'outBlur',\n        'operator': 'in',\n        'result': 'outGlow',\n      },\n      selectedGlowFilter,\n    );\n    this.selectedGlowFilterId = selectedGlowFilter.id;\n    this.selectedGlowFilter = selectedGlowFilter;\n\n    // Using a dilate distorts the block shape.\n    // Instead use a gaussian blur, and then set all alpha to 1 with a transfer.\n    const replacementGlowFilter = dom.createSvgElement(\n      Svg.FILTER,\n      {\n        'id': 'blocklyReplacementGlowFilter' + this.randomIdentifier,\n        'height': '160%',\n        'width': '180%',\n        'y': '-30%',\n        'x': '-40%',\n      },\n      defs,\n    );\n    dom.createSvgElement(\n      Svg.FEGAUSSIANBLUR,\n      {'in': 'SourceGraphic', 'stdDeviation': this.REPLACEMENT_GLOW_SIZE},\n      replacementGlowFilter,\n    );\n    // Set all gaussian blur pixels to 1 opacity before applying flood\n    const replacementComponentTransfer = dom.createSvgElement(\n      Svg.FECOMPONENTTRANSFER,\n      {'result': 'outBlur'},\n      replacementGlowFilter,\n    );\n    dom.createSvgElement(\n      Svg.FEFUNCA,\n      {'type': 'table', 'tableValues': '0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1'},\n      replacementComponentTransfer,\n    );\n    // Color the highlight\n    dom.createSvgElement(\n      Svg.FEFLOOD,\n      {\n        'flood-color': this.REPLACEMENT_GLOW_COLOUR,\n        'flood-opacity': 1,\n        'result': 'outColor',\n      },\n      replacementGlowFilter,\n    );\n    dom.createSvgElement(\n      Svg.FECOMPOSITE,\n      {\n        'in': 'outColor',\n        'in2': 'outBlur',\n        'operator': 'in',\n        'result': 'outGlow',\n      },\n      replacementGlowFilter,\n    );\n    dom.createSvgElement(\n      Svg.FECOMPOSITE,\n      {\n        'in': 'SourceGraphic',\n        'in2': 'outGlow',\n        'operator': 'over',\n      },\n      replacementGlowFilter,\n    );\n    this.replacementGlowFilterId = replacementGlowFilter.id;\n    this.replacementGlowFilter = replacementGlowFilter;\n  }\n\n  override getCSS_(selector: string) {\n    return [\n      /* eslint-disable indent */\n      // Text.\n      `${selector} .blocklyText,`,\n      `${selector} .blocklyFlyoutLabelText {`,\n      `font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}` +\n        `pt ${this.FIELD_TEXT_FONTFAMILY};`,\n      `}`,\n\n      `${selector} .blocklyTextInputBubble textarea {`,\n      `font-weight: normal;`,\n      `}`,\n\n      // Fields.\n      `${selector} .blocklyText {`,\n      `fill: #fff;`,\n      `}`,\n      `${selector} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,\n      `${selector} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,\n      `fill: ${this.FIELD_BORDER_RECT_COLOUR};`,\n      `}`,\n      `${selector} .blocklyNonEditableText>text,`,\n      `${selector} .blocklyEditableText>text,`,\n      `${selector} .blocklyNonEditableText>g>text,`,\n      `${selector} .blocklyEditableText>g>text {`,\n      `fill: #575E75;`,\n      `}`,\n\n      // Flyout labels.\n      `${selector} .blocklyFlyoutLabelText {`,\n      `fill: #575E75;`,\n      `}`,\n\n      // Bubbles.\n      `${selector} .blocklyText.blocklyBubbleText {`,\n      `fill: #575E75;`,\n      `}`,\n\n      // Editable field hover.\n      `${selector} .blocklyDraggable:not(.blocklyDisabled)`,\n      ` .blocklyEditableText:not(.editing):hover>rect,`,\n      `${selector} .blocklyDraggable:not(.blocklyDisabled)`,\n      ` .blocklyEditableText:not(.editing):hover>.blocklyPath {`,\n      `stroke: #fff;`,\n      `stroke-width: 2;`,\n      `}`,\n\n      // Text field input.\n      `${selector} .blocklyHtmlInput {`,\n      `font-family: ${this.FIELD_TEXT_FONTFAMILY};`,\n      `font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,\n      `color: #575E75;`,\n      `}`,\n\n      // Dropdown field.\n      `${selector} .blocklyDropdownText {`,\n      `fill: #fff !important;`,\n      `}`,\n\n      // Widget and Dropdown Div\n      `${selector}.blocklyWidgetDiv .goog-menuitem,`,\n      `${selector}.blocklyDropDownDiv .goog-menuitem {`,\n      `font-family: ${this.FIELD_TEXT_FONTFAMILY};`,\n      `}`,\n      `${selector}.blocklyDropDownDiv .goog-menuitem-content {`,\n      `color: #fff;`,\n      `}`,\n\n      // Connection highlight.\n      `${selector} .blocklyHighlightedConnectionPath {`,\n      `stroke: ${this.SELECTED_GLOW_COLOUR};`,\n      `}`,\n\n      // Disabled outline paths.\n      `${selector} .blocklyDisabled > .blocklyOutlinePath {`,\n      `fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,\n      `}`,\n\n      // Insertion marker.\n      `${selector} .blocklyInsertionMarker>.blocklyPath {`,\n      `fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,\n      `stroke: none;`,\n      `}`,\n    ];\n  }\n}\n/* eslint-enable indent */\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.Drawer\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {ConnectionType} from '../../connection_type.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {BaseShape, DynamicShape, Notch} from '../common/constants.js';\nimport {Drawer as BaseDrawer} from '../common/drawer.js';\nimport {Connection} from '../measurables/connection.js';\nimport type {InlineInput} from '../measurables/inline_input.js';\nimport {OutputConnection} from '../measurables/output_connection.js';\nimport type {Row} from '../measurables/row.js';\nimport type {SpacerRow} from '../measurables/spacer_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {InsideCorners} from './constants.js';\nimport type {RenderInfo} from './info.js';\nimport type {StatementInput} from './measurables/inputs.js';\nimport type {PathObject} from './path_object.js';\n\n/**\n * An object that draws a block based on the given rendering information.\n */\nexport class Drawer extends BaseDrawer {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override info_!: RenderInfo;\n\n  /**\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   */\n  constructor(block: BlockSvg, info: RenderInfo) {\n    super(block, info);\n  }\n\n  override draw() {\n    const pathObject = this.block_.pathObject as PathObject;\n    pathObject.beginDrawing();\n    this.drawOutline_();\n    this.drawInternals_();\n    this.updateConnectionHighlights();\n\n    pathObject.setPath(this.outlinePath_ + '\\n' + this.inlinePath_);\n    if (this.info_.RTL) {\n      pathObject.flipRTL();\n    }\n    this.recordSizeOnBlock_();\n    if (this.info_.outputConnection) {\n      // Store the output connection shape type for parent blocks to use during\n      // rendering.\n      pathObject.outputShapeType = this.info_.outputConnection.shape.type;\n    }\n    pathObject.endDrawing();\n  }\n\n  override drawOutline_() {\n    if (\n      this.info_.outputConnection &&\n      this.info_.outputConnection.isDynamicShape &&\n      !this.info_.hasStatementInput &&\n      !this.info_.bottomRow.hasNextConnection\n    ) {\n      this.drawFlatTop_();\n      this.drawRightDynamicConnection_();\n      this.drawFlatBottom_();\n      this.drawLeftDynamicConnection_();\n    } else {\n      super.drawOutline_();\n    }\n  }\n\n  override drawLeft_() {\n    if (\n      this.info_.outputConnection &&\n      this.info_.outputConnection.isDynamicShape\n    ) {\n      this.drawLeftDynamicConnection_();\n    } else {\n      super.drawLeft_();\n    }\n  }\n\n  /**\n   * Add steps for the right side of a row that does not have value or\n   * statement input connections.\n   *\n   * @param row The row to draw the side of.\n   */\n  protected override drawRightSideRow_(row: Row) {\n    if (row.height <= 0) {\n      return;\n    }\n    if (Types.isSpacer(row)) {\n      const spacerRow = row as SpacerRow;\n      const precedesStatement = spacerRow.precedesStatement;\n      const followsStatement = spacerRow.followsStatement;\n      if (precedesStatement || followsStatement) {\n        const insideCorners = this.constants_.INSIDE_CORNERS as InsideCorners;\n        const cornerHeight = insideCorners.rightHeight;\n        const remainingHeight =\n          spacerRow.height - (precedesStatement ? cornerHeight : 0);\n        const bottomRightPath = followsStatement\n          ? insideCorners.pathBottomRight\n          : '';\n        const verticalPath =\n          remainingHeight > 0\n            ? svgPaths.lineOnAxis('V', spacerRow.yPos + remainingHeight)\n            : '';\n        const topRightPath = precedesStatement\n          ? insideCorners.pathTopRight\n          : '';\n        // Put all of the partial paths together.\n        this.outlinePath_ += bottomRightPath + verticalPath + topRightPath;\n        return;\n      }\n    }\n    this.outlinePath_ += svgPaths.lineOnAxis('V', row.yPos + row.height);\n  }\n\n  /**\n   * Add steps to draw the right side of an output with a dynamic connection.\n   */\n  protected drawRightDynamicConnection_() {\n    if (!this.info_.outputConnection) {\n      throw new Error(\n        `Cannot draw the output connection of a block that doesn't have one`,\n      );\n    }\n    this.outlinePath_ += (\n      this.info_.outputConnection.shape as DynamicShape\n    ).pathRightDown(this.info_.outputConnection.height);\n  }\n\n  /**\n   * Add steps to draw the left side of an output with a dynamic connection.\n   */\n  protected drawLeftDynamicConnection_() {\n    if (!this.info_.outputConnection) {\n      throw new Error(\n        `Cannot draw the output connection of a block that doesn't have one`,\n      );\n    }\n    this.positionOutputConnection_();\n\n    this.outlinePath_ += (\n      this.info_.outputConnection.shape as DynamicShape\n    ).pathUp(this.info_.outputConnection.height);\n\n    // Close off the path.  This draws a vertical line up to the start of the\n    // block's path, which may be either a rounded or a sharp corner.\n    this.outlinePath_ += 'z';\n  }\n\n  /** Add steps to draw a flat top row. */\n  protected drawFlatTop_() {\n    const topRow = this.info_.topRow;\n    this.positionPreviousConnection_();\n\n    this.outlinePath_ += svgPaths.moveBy(topRow.xPos, this.info_.startY);\n    this.outlinePath_ += svgPaths.lineOnAxis('h', topRow.width);\n  }\n\n  /** Add steps to draw a flat bottom row. */\n  protected drawFlatBottom_() {\n    const bottomRow = this.info_.bottomRow;\n    this.positionNextConnection_();\n\n    this.outlinePath_ += svgPaths.lineOnAxis('V', bottomRow.baseline);\n    this.outlinePath_ += svgPaths.lineOnAxis('h', -bottomRow.width);\n  }\n\n  override drawInlineInput_(input: InlineInput) {\n    this.positionInlineInputConnection_(input);\n\n    const inputName = input.input.name;\n    if (input.connectedBlock || this.info_.isInsertionMarker) {\n      return;\n    }\n\n    const yPos = input.centerline - input.height / 2;\n    const connectionRight = input.xPos + input.connectionWidth;\n\n    const path =\n      svgPaths.moveTo(connectionRight, yPos) + this.getInlineInputPath(input);\n\n    const pathObject = this.block_.pathObject as PathObject;\n    pathObject.setOutlinePath(inputName, path);\n  }\n\n  private getInlineInputPath(input: InlineInput) {\n    const width = input.width - input.connectionWidth * 2;\n    const height = input.height;\n\n    return (\n      svgPaths.lineOnAxis('h', width) +\n      (input.shape as DynamicShape).pathRightDown(height) +\n      svgPaths.lineOnAxis('h', -width) +\n      (input.shape as DynamicShape).pathUp(height) +\n      'z'\n    );\n  }\n\n  override drawStatementInput_(row: Row) {\n    const input = row.getLastInput() as StatementInput;\n    // Where to start drawing the notch, which is on the right side in LTR.\n    const x = input.xPos + input.notchOffset + (input.shape as BaseShape).width;\n\n    const insideCorners = this.constants_.INSIDE_CORNERS;\n    const innerTopLeftCorner =\n      (input.shape as Notch).pathRight +\n      svgPaths.lineOnAxis('h', -(input.notchOffset - insideCorners.width)) +\n      insideCorners.pathTop;\n\n    const innerHeight = row.height - 2 * insideCorners.height;\n\n    const innerBottomLeftCorner =\n      insideCorners.pathBottom +\n      svgPaths.lineOnAxis('h', input.notchOffset - insideCorners.width) +\n      (input.connectedBottomNextConnection\n        ? ''\n        : (input.shape as Notch).pathLeft);\n\n    this.outlinePath_ +=\n      svgPaths.lineOnAxis('H', x) +\n      innerTopLeftCorner +\n      svgPaths.lineOnAxis('v', innerHeight) +\n      innerBottomLeftCorner +\n      svgPaths.lineOnAxis('H', row.xPos + row.width);\n\n    this.positionStatementInputConnection_(row);\n  }\n\n  /** Returns a path to highlight the given connection. */\n  drawConnectionHighlightPath(measurable: Connection) {\n    const conn = measurable.connectionModel;\n    if (\n      conn.type === ConnectionType.NEXT_STATEMENT ||\n      conn.type === ConnectionType.PREVIOUS_STATEMENT ||\n      (conn.type === ConnectionType.OUTPUT_VALUE && !measurable.isDynamicShape)\n    ) {\n      super.drawConnectionHighlightPath(measurable);\n      return;\n    }\n\n    let path = '';\n    if (conn.type === ConnectionType.INPUT_VALUE) {\n      const input = measurable as InlineInput;\n      const xPos = input.connectionWidth;\n      const yPos = -input.height / 2;\n      path = svgPaths.moveTo(xPos, yPos) + this.getInlineInputPath(input);\n    } else {\n      // Dynamic output.\n      const output = measurable as OutputConnection;\n      const xPos = output.width;\n      const yPos = -output.height / 2;\n      path =\n        svgPaths.moveTo(xPos, yPos) +\n        (output.shape as DynamicShape).pathDown(output.height);\n    }\n    const block = conn.getSourceBlock();\n    block.pathObject.addConnectionHighlight?.(\n      conn,\n      path,\n      conn.getOffsetInBlock(),\n      block.RTL,\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Image field.  Used for pictures, icons, etc.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldImage\n\nimport {Field, FieldConfig} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\n\n/**\n * Class for an image on a block.\n */\nexport class FieldImage extends Field<string> {\n  /**\n   * Vertical padding below the image, which is included in the reported height\n   * of the field.\n   */\n  private static readonly Y_PADDING = 1;\n  protected override size_: Size;\n  protected readonly imageHeight: number;\n\n  /** The function to be called when this field is clicked. */\n  private clickHandler: ((p1: FieldImage) => void) | null = null;\n\n  /** The rendered field's image element. */\n  protected imageElement: SVGImageElement | null = null;\n\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. This field should not.\n   */\n  override readonly EDITABLE = false;\n\n  /**\n   * Used to tell if the field needs to be rendered the next time the block is\n   * rendered. Image fields are statically sized, and only need to be\n   * rendered at initialization.\n   */\n  protected override isDirty_ = false;\n\n  /** Whether to flip this image in RTL. */\n  private flipRtl = false;\n\n  /** Alt text of this image. */\n  private altText = '';\n\n  /**\n   * @param src The URL of the image.\n   *     Also accepts Field.SKIP_SETUP if you wish to skip setup (only used by\n   * subclasses that want to handle configuration and setting the field value\n   * after their own constructors have run).\n   * @param width Width of the image.\n   * @param height Height of the image.\n   * @param alt Optional alt text for when block is collapsed.\n   * @param onClick Optional function to be called when the image is\n   *     clicked. If onClick is defined, alt must also be defined.\n   * @param flipRtl Whether to flip the icon in RTL.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/image#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    src: string | typeof Field.SKIP_SETUP,\n    width: string | number,\n    height: string | number,\n    alt?: string,\n    onClick?: (p1: FieldImage) => void,\n    flipRtl?: boolean,\n    config?: FieldImageConfig,\n  ) {\n    super(Field.SKIP_SETUP);\n\n    const imageHeight = Number(parsing.replaceMessageReferences(height));\n    const imageWidth = Number(parsing.replaceMessageReferences(width));\n    if (isNaN(imageHeight) || isNaN(imageWidth)) {\n      throw Error(\n        'Height and width values of an image field must cast to' + ' numbers.',\n      );\n    }\n    if (imageHeight <= 0 || imageWidth <= 0) {\n      throw Error(\n        'Height and width values of an image field must be greater' +\n          ' than 0.',\n      );\n    }\n\n    /** The size of the area rendered by the field. */\n    this.size_ = new Size(imageWidth, imageHeight + FieldImage.Y_PADDING);\n\n    /**\n     * Store the image height, since it is different from the field height.\n     */\n    this.imageHeight = imageHeight;\n\n    if (typeof onClick === 'function') {\n      this.clickHandler = onClick;\n    }\n\n    if (src === Field.SKIP_SETUP) return;\n\n    if (config) {\n      this.configure_(config);\n    } else {\n      this.flipRtl = !!flipRtl;\n      this.altText = parsing.replaceMessageReferences(alt) || '';\n    }\n    this.setValue(parsing.replaceMessageReferences(src));\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldImageConfig) {\n    super.configure_(config);\n    if (config.flipRtl) this.flipRtl = config.flipRtl;\n    if (config.alt) {\n      this.altText = parsing.replaceMessageReferences(config.alt);\n    }\n  }\n\n  /**\n   * Create the block UI for this image.\n   */\n  override initView() {\n    this.imageElement = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'height': this.imageHeight + 'px',\n        'width': this.size_.width + 'px',\n        'alt': this.altText,\n      },\n      this.fieldGroup_,\n    );\n    this.imageElement.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.value_ as string,\n    );\n\n    if (this.clickHandler) {\n      this.imageElement.style.cursor = 'pointer';\n    }\n  }\n\n  override updateSize_() {}\n  // NOP\n\n  /**\n   * Ensure that the input value (the source URL) is a string.\n   *\n   * @param newValue The input value.\n   * @returns A string, or null if invalid.\n   */\n  protected override doClassValidation_(newValue?: any): string | null {\n    if (typeof newValue !== 'string') {\n      return null;\n    }\n    return newValue;\n  }\n\n  /**\n   * Update the value of this image field, and update the displayed image.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a string.\n   */\n  protected override doValueUpdate_(newValue: string) {\n    this.value_ = newValue;\n    if (this.imageElement) {\n      this.imageElement.setAttributeNS(dom.XLINK_NS, 'xlink:href', this.value_);\n    }\n  }\n\n  /**\n   * Get whether to flip this image in RTL\n   *\n   * @returns True if we should flip in RTL.\n   */\n  override getFlipRtl(): boolean {\n    return this.flipRtl;\n  }\n\n  /**\n   * Set the alt text of this image.\n   *\n   * @param alt New alt text.\n   */\n  setAlt(alt: string | null) {\n    if (alt === this.altText) {\n      return;\n    }\n    this.altText = alt || '';\n    if (this.imageElement) {\n      this.imageElement.setAttribute('alt', this.altText);\n    }\n  }\n\n  /**\n   * If field click is called, and click handler defined,\n   * call the handler.\n   */\n  protected override showEditor_() {\n    if (this.clickHandler) {\n      this.clickHandler(this);\n    }\n  }\n\n  /**\n   * Set the function that is called when this image  is clicked.\n   *\n   * @param func The function that is called when the image is clicked, or null\n   *     to remove.\n   */\n  setOnClickHandler(func: ((p1: FieldImage) => void) | null) {\n    this.clickHandler = func;\n  }\n\n  /**\n   * Use the `getText_` developer hook to override the field's text\n   * representation.\n   * Return the image alt text instead.\n   *\n   * @returns The image alt text.\n   */\n  protected override getText_(): string | null {\n    return this.altText;\n  }\n\n  /**\n   * Construct a FieldImage from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (src, width, height, alt, and\n   *     flipRtl).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(options: FieldImageFromJsonConfig): FieldImage {\n    if (!options.src || !options.width || !options.height) {\n      throw new Error(\n        'src, width, and height values for an image field are' +\n          'required. The width and height must be non-zero.',\n      );\n    }\n    // `this` might be a subclass of FieldImage if that class doesn't override\n    // the static fromJson method.\n    return new this(\n      options.src,\n      options.width,\n      options.height,\n      undefined,\n      undefined,\n      undefined,\n      options,\n    );\n  }\n}\n\nfieldRegistry.register('field_image', FieldImage);\n\nFieldImage.prototype.DEFAULT_VALUE = '';\n\n/**\n * Config options for the image field.\n */\nexport interface FieldImageConfig extends FieldConfig {\n  flipRtl?: boolean;\n  alt?: string;\n}\n\n/**\n * fromJson config options for the image field.\n */\nexport interface FieldImageFromJsonConfig extends FieldImageConfig {\n  src?: string;\n  width?: number;\n  height?: number;\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Text input field.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldInput\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport {BlockSvg} from './block_svg.js';\nimport * as bumpObjects from './bump_objects.js';\nimport * as browserEvents from './browser_events.js';\nimport * as dialog from './dialog.js';\nimport * as dom from './utils/dom.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport {\n  Field,\n  FieldConfig,\n  FieldValidator,\n  UnattachedFieldError,\n} from './field.js';\nimport {Msg} from './msg.js';\nimport * as aria from './utils/aria.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport {Size} from './utils/size.js';\n\n/**\n * Supported types for FieldInput subclasses.\n *\n * @internal\n */\ntype InputTypes = string | number;\n\n/**\n * Abstract class for an editable input field.\n *\n * @typeParam T - The value stored on the field.\n * @internal\n */\nexport abstract class FieldInput<T extends InputTypes> extends Field<\n  string | T\n> {\n  /**\n   * Pixel size of input border radius.\n   * Should match blocklyText's border-radius in CSS.\n   */\n  static BORDERRADIUS = 4;\n\n  /** Allow browser to spellcheck this field. */\n  protected spellcheck_ = true;\n\n  /** The HTML input element. */\n  protected htmlInput_: HTMLInputElement | null = null;\n\n  /** True if the field's value is currently being edited via the UI. */\n  protected isBeingEdited_ = false;\n\n  /**\n   * True if the value currently displayed in the field's editory UI is valid.\n   */\n  protected isTextValid_ = false;\n\n  /**\n   * The intial value of the field when the user opened an editor to change its\n   * value. When the editor is disposed, an event will be fired that uses this\n   * as the event's oldValue.\n   */\n  protected valueWhenEditorWasOpened_: string | T | null = null;\n\n  /** Key down event data. */\n  private onKeyDownWrapper_: browserEvents.Data | null = null;\n\n  /** Key input event data. */\n  private onKeyInputWrapper_: browserEvents.Data | null = null;\n\n  /**\n   * Whether the field should consider the whole parent block to be its click\n   * target.\n   */\n  fullBlockClickTarget_: boolean = false;\n\n  /** The workspace that this field belongs to. */\n  protected workspace_: WorkspaceSvg | null = null;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /** Mouse cursor style when over the hotspot that initiates the editor. */\n  override CURSOR = 'text';\n\n  /**\n   * @param value The initial value of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a string & returns a validated string, or null\n   *     to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/text-input#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | typeof Field.SKIP_SETUP,\n    validator?: FieldInputValidator<T> | null,\n    config?: FieldInputConfig,\n  ) {\n    super(Field.SKIP_SETUP);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  protected override configure_(config: FieldInputConfig) {\n    super.configure_(config);\n    if (config.spellcheck !== undefined) {\n      this.spellcheck_ = config.spellcheck;\n    }\n  }\n\n  override initView() {\n    const block = this.getSourceBlock();\n    if (!block) throw new UnattachedFieldError();\n    super.initView();\n\n    if (this.isFullBlockField()) {\n      this.clickTarget_ = (this.sourceBlock_ as BlockSvg).getSvgRoot();\n    }\n  }\n\n  protected override isFullBlockField(): boolean {\n    const block = this.getSourceBlock();\n    if (!block) throw new UnattachedFieldError();\n\n    // Side effect for backwards compatibility.\n    this.fullBlockClickTarget_ =\n      !!this.getConstants()?.FULL_BLOCK_FIELDS && block.isSimpleReporter();\n    return this.fullBlockClickTarget_;\n  }\n\n  /**\n   * Called by setValue if the text input is not valid. If the field is\n   * currently being edited it reverts value of the field to the previous\n   * value while allowing the display text to be handled by the htmlInput_.\n   *\n   * @param _invalidValue The input value that was determined to be invalid.\n   *     This is not used by the text input because its display value is stored\n   *     on the htmlInput_.\n   * @param fireChangeEvent Whether to fire a change event if the value changes.\n   */\n  protected override doValueInvalid_(\n    _invalidValue: AnyDuringMigration,\n    fireChangeEvent: boolean = true,\n  ) {\n    if (this.isBeingEdited_) {\n      this.isDirty_ = true;\n      this.isTextValid_ = false;\n      const oldValue = this.value_;\n      // Revert value when the text becomes invalid.\n      this.value_ = this.valueWhenEditorWasOpened_;\n      if (\n        this.sourceBlock_ &&\n        eventUtils.isEnabled() &&\n        this.value_ !== oldValue &&\n        fireChangeEvent\n      ) {\n        eventUtils.fire(\n          new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n            this.sourceBlock_,\n            'field',\n            this.name || null,\n            oldValue,\n            this.value_,\n          ),\n        );\n      }\n    }\n  }\n\n  /**\n   * Called by setValue if the text input is valid. Updates the value of the\n   * field, and updates the text of the field if it is not currently being\n   * edited (i.e. handled by the htmlInput_).\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a string.\n   */\n  protected override doValueUpdate_(newValue: string | T) {\n    this.isDirty_ = true;\n    this.isTextValid_ = true;\n    this.value_ = newValue;\n  }\n\n  /**\n   * Updates text field to match the colour/style of the block.\n   */\n  override applyColour() {\n    const block = this.getSourceBlock() as BlockSvg | null;\n    if (!block) throw new UnattachedFieldError();\n\n    if (!this.getConstants()!.FULL_BLOCK_FIELDS) return;\n    if (!this.fieldGroup_) return;\n\n    if (!this.isFullBlockField() && this.borderRect_) {\n      this.borderRect_!.style.display = 'block';\n      this.borderRect_.setAttribute('stroke', block.style.colourTertiary);\n    } else {\n      this.borderRect_!.style.display = 'none';\n      // In general, do *not* let fields control the color of blocks. Having the\n      // field control the color is unexpected, and could have performance\n      // impacts.\n      block.pathObject.svgPath.setAttribute(\n        'fill',\n        this.getConstants()!.FIELD_BORDER_RECT_COLOUR,\n      );\n    }\n  }\n\n  /**\n   * Returns the height and width of the field.\n   *\n   * This should *in general* be the only place render_ gets called from.\n   *\n   * @returns Height and width.\n   */\n  override getSize(): Size {\n    if (this.getConstants()?.FULL_BLOCK_FIELDS) {\n      // In general, do *not* let fields control the color of blocks. Having the\n      // field control the color is unexpected, and could have performance\n      // impacts.\n      // Full block fields have more control of the block than they should\n      // (i.e. updating fill colour). Whenever we get the size, the field may\n      // no longer be a full-block field, so we need to rerender.\n      this.render_();\n      this.isDirty_ = false;\n    }\n    return super.getSize();\n  }\n\n  /**\n   * Notifies the field that it has changed locations. Moves the widget div to\n   * be in the correct place if it is open.\n   */\n  onLocationChange(): void {\n    if (this.isBeingEdited_) this.resizeEditor_();\n  }\n\n  /**\n   * Updates the colour of the htmlInput given the current validity of the\n   * field's value.\n   *\n   * Also updates the colour of the block to reflect whether this is a full\n   * block field or not.\n   */\n  protected override render_() {\n    super.render_();\n    // This logic is done in render_ rather than doValueInvalid_ or\n    // doValueUpdate_ so that the code is more centralized.\n    if (this.isBeingEdited_) {\n      const htmlInput = this.htmlInput_ as HTMLElement;\n      if (!this.isTextValid_) {\n        dom.addClass(htmlInput, 'blocklyInvalidInput');\n        aria.setState(htmlInput, aria.State.INVALID, true);\n      } else {\n        dom.removeClass(htmlInput, 'blocklyInvalidInput');\n        aria.setState(htmlInput, aria.State.INVALID, false);\n      }\n    }\n\n    const block = this.getSourceBlock() as BlockSvg | null;\n    if (!block) throw new UnattachedFieldError();\n    // In general, do *not* let fields control the color of blocks. Having the\n    // field control the color is unexpected, and could have performance\n    // impacts.\n    // Whenever we render, the field may no longer be a full-block-field so\n    // we need to update the colour.\n    if (this.getConstants()!.FULL_BLOCK_FIELDS) block.applyColour();\n  }\n\n  /**\n   * Set whether this field is spellchecked by the browser.\n   *\n   * @param check True if checked.\n   */\n  setSpellcheck(check: boolean) {\n    if (check === this.spellcheck_) {\n      return;\n    }\n    this.spellcheck_ = check;\n    if (this.htmlInput_) {\n      // AnyDuringMigration because:  Argument of type 'boolean' is not\n      // assignable to parameter of type 'string'.\n      this.htmlInput_.setAttribute(\n        'spellcheck',\n        this.spellcheck_ as AnyDuringMigration,\n      );\n    }\n  }\n\n  /**\n   * Show an editor for the field.\n   * Shows the inline free-text editor on top of the text by default.\n   * Shows a prompt editor for mobile browsers if the modalInputs option is\n   * enabled.\n   *\n   * @param _e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   * @param quietInput True if editor should be created without focus.\n   *     Defaults to false.\n   */\n  protected override showEditor_(_e?: Event, quietInput = false) {\n    this.workspace_ = (this.sourceBlock_ as BlockSvg).workspace;\n    if (\n      !quietInput &&\n      this.workspace_.options.modalInputs &&\n      (userAgent.MOBILE || userAgent.ANDROID || userAgent.IPAD)\n    ) {\n      this.showPromptEditor_();\n    } else {\n      this.showInlineEditor_(quietInput);\n    }\n  }\n\n  /**\n   * Create and show a text input editor that is a prompt (usually a popup).\n   * Mobile browsers may have issues with in-line textareas (focus and\n   * keyboards).\n   */\n  private showPromptEditor_() {\n    dialog.prompt(\n      Msg['CHANGE_VALUE_TITLE'],\n      this.getText(),\n      (text: string | null) => {\n        // Text is null if user pressed cancel button.\n        if (text !== null) {\n          this.setValue(this.getValueFromEditorText_(text));\n        }\n        this.onFinishEditing_(this.value_);\n      },\n    );\n  }\n\n  /**\n   * Create and show a text input editor that sits directly over the text input.\n   *\n   * @param quietInput True if editor should be created without focus.\n   */\n  private showInlineEditor_(quietInput: boolean) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    WidgetDiv.show(\n      this,\n      block.RTL,\n      this.widgetDispose_.bind(this),\n      this.workspace_,\n    );\n    this.htmlInput_ = this.widgetCreate_() as HTMLInputElement;\n    this.isBeingEdited_ = true;\n    this.valueWhenEditorWasOpened_ = this.value_;\n\n    if (!quietInput) {\n      (this.htmlInput_ as HTMLElement).focus({\n        preventScroll: true,\n      });\n      this.htmlInput_.select();\n    }\n  }\n\n  /**\n   * Create the text input editor widget.\n   *\n   * @returns The newly created text input editor.\n   */\n  protected widgetCreate_(): HTMLInputElement | HTMLTextAreaElement {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    eventUtils.setGroup(true);\n    const div = WidgetDiv.getDiv();\n\n    const clickTarget = this.getClickTarget_();\n    if (!clickTarget) throw new Error('A click target has not been set.');\n    dom.addClass(clickTarget, 'editing');\n\n    const htmlInput = document.createElement('input');\n    htmlInput.className = 'blocklyHtmlInput';\n    // AnyDuringMigration because:  Argument of type 'boolean' is not assignable\n    // to parameter of type 'string'.\n    htmlInput.setAttribute(\n      'spellcheck',\n      this.spellcheck_ as AnyDuringMigration,\n    );\n    const scale = this.workspace_!.getScale();\n    const fontSize = this.getConstants()!.FIELD_TEXT_FONTSIZE * scale + 'pt';\n    div!.style.fontSize = fontSize;\n    htmlInput.style.fontSize = fontSize;\n    let borderRadius = FieldInput.BORDERRADIUS * scale + 'px';\n\n    if (this.isFullBlockField()) {\n      const bBox = this.getScaledBBox();\n\n      // Override border radius.\n      borderRadius = (bBox.bottom - bBox.top) / 2 + 'px';\n      // Pull stroke colour from the existing shadow block\n      const strokeColour = block.getParent()\n        ? (block.getParent() as BlockSvg).style.colourTertiary\n        : (this.sourceBlock_ as BlockSvg).style.colourTertiary;\n      htmlInput.style.border = 1 * scale + 'px solid ' + strokeColour;\n      div!.style.borderRadius = borderRadius;\n      div!.style.transition = 'box-shadow 0.25s ease 0s';\n      if (this.getConstants()!.FIELD_TEXTINPUT_BOX_SHADOW) {\n        div!.style.boxShadow =\n          'rgba(255, 255, 255, 0.3) 0 0 0 ' + 4 * scale + 'px';\n      }\n    }\n    htmlInput.style.borderRadius = borderRadius;\n\n    div!.appendChild(htmlInput);\n\n    htmlInput.value = htmlInput.defaultValue = this.getEditorText_(this.value_);\n    htmlInput.setAttribute('data-untyped-default-value', String(this.value_));\n\n    this.resizeEditor_();\n\n    this.bindInputEvents_(htmlInput);\n\n    return htmlInput;\n  }\n\n  /**\n   * Closes the editor, saves the results, and disposes of any events or\n   * DOM-references belonging to the editor.\n   */\n  protected widgetDispose_() {\n    // Non-disposal related things that we do when the editor closes.\n    this.isBeingEdited_ = false;\n    this.isTextValid_ = true;\n    // Make sure the field's node matches the field's internal value.\n    this.forceRerender();\n    this.onFinishEditing_(this.value_);\n\n    if (\n      this.sourceBlock_ &&\n      eventUtils.isEnabled() &&\n      this.valueWhenEditorWasOpened_ !== null &&\n      this.valueWhenEditorWasOpened_ !== this.value_\n    ) {\n      // When closing a field input widget, fire an event indicating that the\n      // user has completed a sequence of changes. The value may have changed\n      // multiple times while the editor was open, but this will fire an event\n      // containing the value when the editor was opened as well as the new one.\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this.sourceBlock_,\n          'field',\n          this.name || null,\n          this.valueWhenEditorWasOpened_,\n          this.value_,\n        ),\n      );\n      this.valueWhenEditorWasOpened_ = null;\n    }\n\n    eventUtils.setGroup(false);\n\n    // Actual disposal.\n    this.unbindInputEvents_();\n    const style = WidgetDiv.getDiv()!.style;\n    style.width = 'auto';\n    style.height = 'auto';\n    style.fontSize = '';\n    style.transition = '';\n    style.boxShadow = '';\n    this.htmlInput_ = null;\n\n    const clickTarget = this.getClickTarget_();\n    if (!clickTarget) throw new Error('A click target has not been set.');\n    dom.removeClass(clickTarget, 'editing');\n  }\n\n  /**\n   * A callback triggered when the user is done editing the field via the UI.\n   *\n   * @param _value The new value of the field.\n   */\n  onFinishEditing_(_value: AnyDuringMigration) {}\n\n  /**\n   * Bind handlers for user input on the text input field's editor.\n   *\n   * @param htmlInput The htmlInput to which event handlers will be bound.\n   */\n  protected bindInputEvents_(htmlInput: HTMLElement) {\n    // Trap Enter without IME and Esc to hide.\n    this.onKeyDownWrapper_ = browserEvents.conditionalBind(\n      htmlInput,\n      'keydown',\n      this,\n      this.onHtmlInputKeyDown_,\n    );\n    // Resize after every input change.\n    this.onKeyInputWrapper_ = browserEvents.conditionalBind(\n      htmlInput,\n      'input',\n      this,\n      this.onHtmlInputChange_,\n    );\n  }\n\n  /** Unbind handlers for user input and workspace size changes. */\n  protected unbindInputEvents_() {\n    if (this.onKeyDownWrapper_) {\n      browserEvents.unbind(this.onKeyDownWrapper_);\n      this.onKeyDownWrapper_ = null;\n    }\n    if (this.onKeyInputWrapper_) {\n      browserEvents.unbind(this.onKeyInputWrapper_);\n      this.onKeyInputWrapper_ = null;\n    }\n  }\n\n  /**\n   * Handle key down to the editor.\n   *\n   * @param e Keyboard event.\n   */\n  protected onHtmlInputKeyDown_(e: KeyboardEvent) {\n    if (e.key === 'Enter') {\n      WidgetDiv.hideIfOwner(this);\n      dropDownDiv.hideWithoutAnimation();\n    } else if (e.key === 'Escape') {\n      this.setValue(\n        this.htmlInput_!.getAttribute('data-untyped-default-value'),\n        false,\n      );\n      WidgetDiv.hideIfOwner(this);\n      dropDownDiv.hideWithoutAnimation();\n    } else if (e.key === 'Tab') {\n      WidgetDiv.hideIfOwner(this);\n      dropDownDiv.hideWithoutAnimation();\n      (this.sourceBlock_ as BlockSvg).tab(this, !e.shiftKey);\n      e.preventDefault();\n    }\n  }\n\n  /**\n   * Handle a change to the editor.\n   *\n   * @param _e Keyboard event.\n   */\n  private onHtmlInputChange_(_e: Event) {\n    // Intermediate value changes from user input are not confirmed until the\n    // user closes the editor, and may be numerous. Inhibit reporting these as\n    // normal block change events, and instead report them as special\n    // intermediate changes that do not get recorded in undo history.\n    const oldValue = this.value_;\n    // Change the field's value without firing the normal change event.\n    this.setValue(\n      this.getValueFromEditorText_(this.htmlInput_!.value),\n      /* fireChangeEvent= */ false,\n    );\n    if (\n      this.sourceBlock_ &&\n      eventUtils.isEnabled() &&\n      this.value_ !== oldValue\n    ) {\n      // Fire a special event indicating that the value changed but the change\n      // isn't complete yet and normal field change listeners can wait.\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_FIELD_INTERMEDIATE_CHANGE))(\n          this.sourceBlock_,\n          this.name || null,\n          oldValue,\n          this.value_,\n        ),\n      );\n    }\n  }\n\n  /**\n   * Set the HTML input value and the field's internal value. The difference\n   * between this and `setValue` is that this also updates the HTML input\n   * value whilst editing.\n   *\n   * @param newValue New value.\n   * @param fireChangeEvent Whether to fire a change event. Defaults to true.\n   *     Should usually be true unless the change will be reported some other\n   *     way, e.g. an intermediate field change event.\n   */\n  protected setEditorValue_(\n    newValue: AnyDuringMigration,\n    fireChangeEvent = true,\n  ) {\n    this.isDirty_ = true;\n    if (this.isBeingEdited_) {\n      // In the case this method is passed an invalid value, we still\n      // pass it through the transformation method `getEditorText` to deal\n      // with. Otherwise, the internal field's state will be inconsistent\n      // with what's shown to the user.\n      this.htmlInput_!.value = this.getEditorText_(newValue);\n    }\n    this.setValue(newValue, fireChangeEvent);\n  }\n\n  /** Resize the editor to fit the text. */\n  protected resizeEditor_() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const div = WidgetDiv.getDiv();\n    const bBox = this.getScaledBBox();\n    div!.style.width = bBox.right - bBox.left + 'px';\n    div!.style.height = bBox.bottom - bBox.top + 'px';\n\n    // In RTL mode block fields and LTR input fields the left edge moves,\n    // whereas the right edge is fixed.  Reposition the editor.\n    const x = block.RTL ? bBox.right - div!.offsetWidth : bBox.left;\n    const xy = new Coordinate(x, bBox.top);\n\n    div!.style.left = xy.x + 'px';\n    div!.style.top = xy.y + 'px';\n  }\n\n  /**\n   * Handles repositioning the WidgetDiv used for input fields when the\n   * workspace is resized. Will bump the block into the viewport and update the\n   * position of the text input if necessary.\n   *\n   * @returns True for rendered workspaces, as we never want to hide the widget\n   *     div.\n   */\n  override repositionForWindowResize(): boolean {\n    const block = this.getSourceBlock();\n    // This shouldn't be possible. We should never have a WidgetDiv if not using\n    // rendered blocks.\n    if (!(block instanceof BlockSvg)) return false;\n\n    const bumped = bumpObjects.bumpIntoBounds(\n      this.workspace_!,\n      this.workspace_!.getMetricsManager().getViewMetrics(true),\n      block,\n    );\n\n    if (!bumped) this.resizeEditor_();\n\n    return true;\n  }\n\n  /**\n   * Returns whether or not the field is tab navigable.\n   *\n   * @returns True if the field is tab navigable.\n   */\n  override isTabNavigable(): boolean {\n    return true;\n  }\n\n  /**\n   * Use the `getText_` developer hook to override the field's text\n   * representation. When we're currently editing, return the current HTML value\n   * instead. Otherwise, return null which tells the field to use the default\n   * behaviour (which is a string cast of the field's value).\n   *\n   * @returns The HTML value if we're editing, otherwise null.\n   */\n  protected override getText_(): string | null {\n    if (this.isBeingEdited_ && this.htmlInput_) {\n      // We are currently editing, return the HTML input value instead.\n      return this.htmlInput_.value;\n    }\n    return null;\n  }\n\n  /**\n   * Transform the provided value into a text to show in the HTML input.\n   * Override this method if the field's HTML input representation is different\n   * than the field's value. This should be coupled with an override of\n   * `getValueFromEditorText_`.\n   *\n   * @param value The value stored in this field.\n   * @returns The text to show on the HTML input.\n   */\n  protected getEditorText_(value: AnyDuringMigration): string {\n    return `${value}`;\n  }\n\n  /**\n   * Transform the text received from the HTML input into a value to store\n   * in this field.\n   * Override this method if the field's HTML input representation is different\n   * than the field's value. This should be coupled with an override of\n   * `getEditorText_`.\n   *\n   * @param text Text received from the HTML input.\n   * @returns The value to store.\n   */\n  protected getValueFromEditorText_(text: string): AnyDuringMigration {\n    return text;\n  }\n}\n\n/**\n * Config options for the input field.\n *\n * @internal\n */\nexport interface FieldInputConfig extends FieldConfig {\n  spellcheck?: boolean;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n * @internal\n */\nexport type FieldInputValidator<T extends InputTypes> = FieldValidator<\n  string | T\n>;\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Text input field.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldTextInput\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport {Field} from './field.js';\nimport {\n  FieldInput,\n  FieldInputConfig,\n  FieldInputValidator,\n} from './field_input.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as parsing from './utils/parsing.js';\n\n/**\n * Class for an editable text field.\n */\nexport class FieldTextInput extends FieldInput<string> {\n  /**\n   * @param value The initial value of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a string & returns a validated string, or null\n   *     to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/text-input#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | typeof Field.SKIP_SETUP,\n    validator?: FieldTextInputValidator | null,\n    config?: FieldTextInputConfig,\n  ) {\n    super(value, validator, config);\n  }\n\n  /**\n   * Ensure that the input value casts to a valid string.\n   *\n   * @param newValue The input value.\n   * @returns A valid string, or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue?: AnyDuringMigration,\n  ): string | null {\n    if (newValue === undefined) {\n      return null;\n    }\n    return `${newValue}`;\n  }\n\n  /**\n   * Construct a FieldTextInput from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (text, and spellcheck).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(\n    options: FieldTextInputFromJsonConfig,\n  ): FieldTextInput {\n    const text = parsing.replaceMessageReferences(options.text);\n    // `this` might be a subclass of FieldTextInput if that class doesn't\n    // override the static fromJson method.\n    return new this(text, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_input', FieldTextInput);\n\nFieldTextInput.prototype.DEFAULT_VALUE = '';\n\n/**\n *  Config options for the text input field.\n */\nexport type FieldTextInputConfig = FieldInputConfig;\n\n/**\n * fromJson config options for the text input field.\n */\nexport interface FieldTextInputFromJsonConfig extends FieldTextInputConfig {\n  text?: string;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldTextInputValidator = FieldInputValidator<string>;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.BottomRow\n\nimport type {BlockSvg} from '../../../block_svg.js';\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {BottomRow as BaseBottomRow} from '../../../renderers/measurables/bottom_row.js';\n\n/**\n * An object containing information about what elements are in the bottom row of\n * a block as well as spacing information for the top row.\n * Elements in a bottom row can consist of corners, spacers and next\n * connections.\n */\nexport class BottomRow extends BaseBottomRow {\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasLeftSquareCorner(block: BlockSvg) {\n    return !!block.outputConnection;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasRightSquareCorner(block: BlockSvg) {\n    return (\n      !!block.outputConnection &&\n      !block.statementInputCount &&\n      !block.nextConnection\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.StatementInput\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../../inputs/input.js';\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {StatementInput as BaseStatementInput} from '../../../renderers/measurables/statement_input.js';\n\n/**\n * An object containing information about the space a statement input takes up\n * during rendering.\n */\nexport class StatementInput extends BaseStatementInput {\n  connectedBottomNextConnection = false;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The statement input to measure and store information for.\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n\n    if (this.connectedBlock) {\n      // Find the bottom-most connected block in the stack.\n      let block = this.connectedBlock;\n      let nextBlock;\n      while ((nextBlock = block.getNextBlock())) {\n        block = nextBlock;\n      }\n      if (!block.nextConnection) {\n        this.height = this.connectedBlockHeight;\n        this.connectedBottomNextConnection = true;\n      }\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.RightConnectionShape\n\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {Measurable} from '../../../renderers/measurables/base.js';\nimport {Types} from '../../../renderers/measurables/types.js';\n\n/**\n * An object containing information about the space a right connection shape\n * takes up during rendering.\n */\nexport class RightConnectionShape extends Measurable {\n  // Size is dynamic\n  override height = 0;\n  override width = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.getType('RIGHT_CONNECTION');\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.TopRow\n\nimport type {BlockSvg} from '../../../block_svg.js';\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {TopRow as BaseTopRow} from '../../../renderers/measurables/top_row.js';\n\n/**\n * An object containing information about what elements are in the top row of a\n * block as well as sizing information for the top row.\n * Elements in a top row can consist of corners, hats, spacers, and previous\n * connections.\n * After this constructor is called, the row will contain all non-spacer\n * elements it needs.\n */\nexport class TopRow extends BaseTopRow {\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasLeftSquareCorner(block: BlockSvg) {\n    const hasHat =\n      (block.hat ? block.hat === 'cap' : this.constants_.ADD_START_HATS) &&\n      !block.outputConnection &&\n      !block.previousConnection;\n    return !!block.outputConnection || hasHat;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasRightSquareCorner(block: BlockSvg) {\n    return (\n      !!block.outputConnection &&\n      !block.statementInputCount &&\n      !block.nextConnection\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.RenderInfo\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {DummyInput} from '../../inputs/dummy_input.js';\nimport {EndRowInput} from '../../inputs/end_row_input.js';\nimport {FieldImage} from '../../field_image.js';\nimport {FieldLabel} from '../../field_label.js';\nimport {FieldTextInput} from '../../field_textinput.js';\nimport {Input} from '../../inputs/input.js';\nimport {Align} from '../../inputs/align.js';\nimport {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport type {Measurable} from '../measurables/base.js';\nimport {Field} from '../measurables/field.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport {InputConnection} from '../measurables/input_connection.js';\nimport {StatementInput} from '../../inputs/statement_input.js';\nimport type {Row} from '../measurables/row.js';\nimport type {SpacerRow} from '../measurables/spacer_row.js';\nimport {Types} from '../measurables/types.js';\nimport {ValueInput} from '../../inputs/value_input.js';\n\nimport type {ConstantProvider, InsideCorners} from './constants.js';\nimport {BottomRow} from './measurables/bottom_row.js';\nimport {StatementInput as StatementInputMeasurable} from './measurables/inputs.js';\nimport {RightConnectionShape} from './measurables/row_elements.js';\nimport {TopRow} from './measurables/top_row.js';\nimport type {PathObject} from './path_object.js';\nimport type {Renderer} from './renderer.js';\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n */\nexport class RenderInfo extends BaseRenderInfo {\n  override topRow: TopRow;\n  override bottomRow: BottomRow;\n  override constants_: ConstantProvider;\n  override renderer_: Renderer;\n\n  override isInline = true;\n  isMultiRow: boolean;\n  hasStatementInput: boolean;\n  rightSide: RightConnectionShape | null;\n  private readonly rightAlignedDummyInputs: WeakMap<Row, Input>;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    super(renderer, block);\n\n    this.renderer_ = renderer;\n\n    this.constants_ = this.renderer_.getConstants();\n\n    /**\n     * An object with rendering information about the top row of the block.\n     */\n    this.topRow = new TopRow(this.constants_);\n\n    /**\n     * An object with rendering information about the bottom row of the block.\n     */\n    this.bottomRow = new BottomRow(this.constants_);\n\n    /**\n     * Whether the block should be rendered as a multi-line block, either\n     * because it's not inline or because it has been collapsed.\n     */\n    this.isMultiRow = !block.getInputsInline() || block.isCollapsed();\n\n    /**\n     * Whether or not the block has a statement input in one of its rows.\n     */\n    this.hasStatementInput = block.statementInputCount > 0;\n\n    /**\n     * An object with rendering information about the right connection shape.\n     */\n    this.rightSide = this.outputConnection\n      ? new RightConnectionShape(this.constants_)\n      : null;\n\n    /**\n     * A map of rows to right aligned dummy inputs within those rows. Used to\n     * add padding between left and right aligned inputs.\n     */\n    this.rightAlignedDummyInputs = new WeakMap();\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   */\n  override getRenderer(): Renderer {\n    return this.renderer_ as Renderer;\n  }\n\n  override measure() {\n    // Modifying parent measure method to add `adjustXPosition_`.\n    this.createRows_();\n    this.addElemSpacing_();\n    this.addRowSpacing_();\n    this.adjustXPosition_();\n    this.computeBounds_();\n    this.alignRowElements_();\n    this.finalize_();\n  }\n\n  override shouldStartNewRow_(currInput: Input, prevInput: Input): boolean {\n    // If this is the first input, just add to the existing row.\n    // That row is either empty or has some icons in it.\n    if (!prevInput) {\n      return false;\n    }\n    // If the previous input was an end-row input, then any following input\n    // should always be rendered on the next row.\n    if (prevInput instanceof EndRowInput) {\n      return true;\n    }\n    // A statement input or an input following one always gets a new row.\n    if (\n      currInput instanceof StatementInput ||\n      prevInput instanceof StatementInput\n    ) {\n      return true;\n    }\n    // Value, dummy, and end-row inputs get new row if inputs are not inlined.\n    if (\n      currInput instanceof ValueInput ||\n      currInput instanceof DummyInput ||\n      currInput instanceof EndRowInput\n    ) {\n      return !this.isInline || this.isMultiRow;\n    }\n    return false;\n  }\n\n  override getDesiredRowWidth_(row: Row): number {\n    if (row.hasStatement) {\n      const rightCornerWidth =\n        (this.constants_.INSIDE_CORNERS as InsideCorners).rightWidth || 0;\n      return this.width - this.startX - rightCornerWidth;\n    }\n    return super.getDesiredRowWidth_(row);\n  }\n\n  override getInRowSpacing_(\n    prev: Measurable | null,\n    next: Measurable | null,\n  ): number {\n    if (!prev || !next) {\n      // No need for padding at the beginning or end of the row if the\n      // output shape is dynamic.\n      if (\n        this.outputConnection &&\n        this.outputConnection.isDynamicShape &&\n        !this.hasStatementInput &&\n        !this.bottomRow.hasNextConnection\n      ) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n    if (!prev) {\n      // Statement input padding.\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n    }\n    // Spacing between a rounded corner and a previous or next connection.\n    if (prev && Types.isLeftRoundedCorner(prev) && next) {\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset - this.constants_.CORNER_RADIUS;\n      }\n    }\n    // Spacing between a square corner and a hat.\n    if (prev && Types.isLeftSquareCorner(prev) && next && Types.isHat(next)) {\n      return this.constants_.NO_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowHeight_(prev: Row, next: Row): number {\n    // If we have an empty block add a spacer to increase the height.\n    if (Types.isTopRow(prev) && Types.isBottomRow(next)) {\n      return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;\n    }\n    const followsStatement = Types.isInputRow(prev) && prev.hasStatement;\n    const precedesStatement = Types.isInputRow(next) && next.hasStatement;\n    if (precedesStatement || followsStatement) {\n      const cornerHeight =\n        (this.constants_.INSIDE_CORNERS as InsideCorners).rightHeight || 0;\n      const height = Math.max(this.constants_.NOTCH_HEIGHT, cornerHeight);\n      return precedesStatement && followsStatement\n        ? Math.max(height, this.constants_.DUMMY_INPUT_MIN_HEIGHT)\n        : height;\n    }\n    // Top and bottom rows act as a spacer so we don't need any extra padding.\n    if (Types.isTopRow(prev)) {\n      const topRow = prev as TopRow;\n      if (\n        !topRow.hasPreviousConnection &&\n        (!this.outputConnection || this.hasStatementInput)\n      ) {\n        return Math.abs(\n          this.constants_.NOTCH_HEIGHT - this.constants_.CORNER_RADIUS,\n        );\n      }\n      return this.constants_.NO_PADDING;\n    }\n    if (Types.isBottomRow(next)) {\n      const bottomRow = next as BottomRow;\n      if (!this.outputConnection) {\n        const topHeight =\n          Math.max(\n            this.topRow.minHeight,\n            Math.max(\n              this.constants_.NOTCH_HEIGHT,\n              this.constants_.CORNER_RADIUS,\n            ),\n          ) - this.constants_.CORNER_RADIUS;\n        return topHeight;\n      } else if (!bottomRow.hasNextConnection && this.hasStatementInput) {\n        return Math.abs(\n          this.constants_.NOTCH_HEIGHT - this.constants_.CORNER_RADIUS,\n        );\n      }\n      return this.constants_.NO_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowWidth_(prev: Row, next: Row): number {\n    const width = this.width - this.startX;\n    if (\n      (Types.isInputRow(prev) && prev.hasStatement) ||\n      (Types.isInputRow(next) && next.hasStatement)\n    ) {\n      return Math.max(width, this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH);\n    }\n    return width;\n  }\n\n  override getElemCenterline_(row: Row, elem: Measurable): number {\n    if (\n      row.hasStatement &&\n      !Types.isSpacer(elem) &&\n      !Types.isStatementInput(elem)\n    ) {\n      return row.yPos + this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT / 2;\n    }\n    if (Types.isInlineInput(elem) && elem instanceof InputConnection) {\n      const connectedBlock = elem.connectedBlock;\n      if (\n        connectedBlock &&\n        connectedBlock.outputConnection &&\n        connectedBlock.nextConnection\n      ) {\n        return row.yPos + connectedBlock.height / 2;\n      }\n    }\n    return super.getElemCenterline_(row, elem);\n  }\n\n  override addInput_(input: Input, activeRow: Row) {\n    // If we have two dummy inputs on the same row, one aligned left and the\n    // other right, keep track of the right aligned dummy input so we can add\n    // padding later. An end-row input after a dummy input also counts.\n    if (\n      (input instanceof DummyInput || input instanceof EndRowInput) &&\n      activeRow.hasDummyInput &&\n      activeRow.align === Align.LEFT &&\n      input.align === Align.RIGHT\n    ) {\n      this.rightAlignedDummyInputs.set(activeRow, input);\n    } else if (input instanceof StatementInput) {\n      // Handle statements without next connections correctly.\n      activeRow.elements.push(\n        new StatementInputMeasurable(this.constants_, input),\n      );\n      activeRow.hasStatement = true;\n\n      if (activeRow.align === null) {\n        activeRow.align = input.align;\n      }\n      return;\n    }\n    super.addInput_(input, activeRow);\n  }\n\n  override addAlignmentPadding_(row: Row, missingSpace: number) {\n    if (this.rightAlignedDummyInputs.get(row)) {\n      let alignmentDivider;\n      for (let i = 0; i < row.elements.length; i++) {\n        const elem = row.elements[i];\n        if (Types.isSpacer(elem)) {\n          alignmentDivider = elem;\n        }\n        if (\n          Types.isField(elem) &&\n          elem instanceof Field &&\n          elem.parentInput === this.rightAlignedDummyInputs.get(row)\n        ) {\n          break;\n        }\n      }\n      if (alignmentDivider) {\n        alignmentDivider.width += missingSpace;\n        row.width += missingSpace;\n        return;\n      }\n    }\n    super.addAlignmentPadding_(row, missingSpace);\n  }\n\n  /**\n   * Adjust the x position of fields to bump all non-label fields in the first\n   * row past the notch position.  This must be called before `computeBounds`\n   * is called.\n   */\n  protected adjustXPosition_() {\n    const notchTotalWidth =\n      this.constants_.NOTCH_OFFSET_LEFT + this.constants_.NOTCH_WIDTH;\n    let minXPos = notchTotalWidth;\n    // Run through every input row on the block and only apply bump logic to the\n    // first input row (if the block has prev connection) and every input row\n    // that has a prev and next notch.\n    for (let i = 2; i < this.rows.length - 1; i += 2) {\n      const prevSpacer = this.rows[i - 1] as SpacerRow;\n      const row = this.rows[i];\n      const nextSpacer = this.rows[i + 1] as SpacerRow;\n\n      const hasPrevNotch =\n        i === 2\n          ? !!this.topRow.hasPreviousConnection\n          : !!prevSpacer.followsStatement;\n      const hasNextNotch =\n        i + 2 >= this.rows.length - 1\n          ? !!this.bottomRow.hasNextConnection\n          : !!nextSpacer.precedesStatement;\n\n      if (Types.isInputRow(row) && row.hasStatement) {\n        row.measure();\n        minXPos =\n          row.width - (row.getLastInput()?.width ?? 0) + notchTotalWidth;\n      } else if (\n        hasPrevNotch &&\n        (i === 2 || hasNextNotch) &&\n        Types.isInputRow(row) &&\n        !row.hasStatement\n      ) {\n        let xCursor = row.xPos;\n        let prevInRowSpacer = null;\n        for (let j = 0; j < row.elements.length; j++) {\n          const elem = row.elements[j];\n          if (Types.isSpacer(elem)) {\n            prevInRowSpacer = elem;\n          }\n          if (prevInRowSpacer && (Types.isField(elem) || Types.isInput(elem))) {\n            if (\n              xCursor < minXPos &&\n              !(\n                Types.isField(elem) &&\n                elem instanceof Field &&\n                (elem.field instanceof FieldLabel ||\n                  elem.field instanceof FieldImage)\n              )\n            ) {\n              const difference = minXPos - xCursor;\n              prevInRowSpacer.width += difference;\n            }\n          }\n          xCursor += elem.width;\n        }\n      }\n    }\n  }\n\n  /**\n   * Finalize the output connection info.  In particular, set the height of the\n   * output connection to match that of the block.  For the right side, add a\n   * right connection shape element and have it match the dimensions of the\n   * output connection.\n   */\n  protected finalizeOutputConnection_() {\n    // Dynamic output connections depend on the height of the block.\n    if (!this.outputConnection || !this.outputConnection.isDynamicShape) {\n      return;\n    }\n    const outputConnectionShape = this.outputConnection.shape;\n    if (\n      !('isDynamic' in outputConnectionShape && outputConnectionShape.isDynamic)\n    ) {\n      return;\n    }\n\n    let yCursor = 0;\n    // Determine the block height.\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      row.yPos = yCursor;\n      yCursor += row.height;\n    }\n    this.height = yCursor;\n\n    // Adjust the height of the output connection.\n    const blockHeight = this.bottomRow.hasNextConnection\n      ? this.height - this.bottomRow.descenderHeight\n      : this.height;\n    const connectionHeight = outputConnectionShape.height(blockHeight);\n    const connectionWidth = outputConnectionShape.width(blockHeight);\n\n    this.outputConnection.height = connectionHeight;\n    this.outputConnection.width = connectionWidth;\n    this.outputConnection.startX = connectionWidth;\n    this.outputConnection.connectionOffsetY =\n      outputConnectionShape.connectionOffsetY(connectionHeight);\n    this.outputConnection.connectionOffsetX =\n      outputConnectionShape.connectionOffsetX(connectionWidth);\n\n    // Add the right connection measurable.\n    // Don't add it if we have a value-to-statement or a value-to-stack block.\n    let rightConnectionWidth = 0;\n    if (!this.hasStatementInput && !this.bottomRow.hasNextConnection) {\n      rightConnectionWidth = connectionWidth;\n      this.rightSide!.height = connectionHeight;\n      this.rightSide!.width = rightConnectionWidth;\n      this.rightSide!.centerline = connectionHeight / 2;\n      this.rightSide!.xPos = this.width + rightConnectionWidth;\n    }\n    this.startX = connectionWidth;\n    this.width += connectionWidth + rightConnectionWidth;\n    this.widthWithChildren += connectionWidth + rightConnectionWidth;\n  }\n\n  /**\n   * Finalize horizontal alignment of elements on the block.  In particular,\n   * reduce the implicit spacing created by the left and right output connection\n   * shapes by adding setting negative spacing onto the leftmost and rightmost\n   * spacers.\n   */\n  protected finalizeHorizontalAlignment_() {\n    if (\n      !this.outputConnection ||\n      this.hasStatementInput ||\n      this.bottomRow.hasNextConnection\n    ) {\n      return;\n    }\n    let totalNegativeSpacing = 0;\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      if (!Types.isInputRow(row)) {\n        continue;\n      }\n      const firstElem = row.elements[1];\n      const lastElem = row.elements[row.elements.length - 2];\n      let leftNegPadding = this.getNegativeSpacing_(firstElem);\n      let rightNegPadding = this.getNegativeSpacing_(lastElem);\n      totalNegativeSpacing = leftNegPadding + rightNegPadding;\n      const minBlockWidth =\n        this.constants_.MIN_BLOCK_WIDTH + this.outputConnection.width * 2;\n      if (this.width - totalNegativeSpacing < minBlockWidth) {\n        // Maintain a minimum block width, split negative spacing between left\n        // and right edge.\n        totalNegativeSpacing = this.width - minBlockWidth;\n        leftNegPadding = totalNegativeSpacing / 2;\n        rightNegPadding = totalNegativeSpacing / 2;\n      }\n      // Add a negative spacer on the start and end of the block.\n      row.elements.unshift(new InRowSpacer(this.constants_, -leftNegPadding));\n      row.elements.push(new InRowSpacer(this.constants_, -rightNegPadding));\n    }\n    if (totalNegativeSpacing) {\n      this.width -= totalNegativeSpacing;\n      this.widthWithChildren -= totalNegativeSpacing;\n      this.rightSide!.xPos -= totalNegativeSpacing;\n      for (let i = 0; i < this.rows.length; i++) {\n        const row = this.rows[i];\n        if (Types.isTopOrBottomRow(row)) {\n          row.elements[1].width -= totalNegativeSpacing;\n        }\n        row.width -= totalNegativeSpacing;\n        row.widthWithConnectedBlocks -= totalNegativeSpacing;\n      }\n    }\n  }\n\n  /**\n   * Calculate the spacing to reduce the left and right edges by based on the\n   * outer and inner connection shape.\n   *\n   * @param elem The first or last element on a block.\n   * @returns The amount of spacing to reduce the first or last spacer.\n   */\n  protected getNegativeSpacing_(elem: Measurable): number {\n    if (!elem || !this.outputConnection) {\n      return 0;\n    }\n    const connectionWidth = this.outputConnection.width;\n    const outerShape = this.outputConnection.shape.type;\n    const constants = this.constants_;\n    if (this.inputRows.length > 1) {\n      switch (outerShape) {\n        case constants.SHAPES.ROUND: {\n          // Special case for multi-row round reporter blocks.\n          const maxWidth = this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;\n          const width = this.height / 2 > maxWidth ? maxWidth : this.height / 2;\n          const topPadding = this.constants_.SMALL_PADDING;\n          const roundPadding =\n            width * (1 - Math.sin(Math.acos((width - topPadding) / width)));\n          return connectionWidth - roundPadding;\n        }\n        default:\n          return 0;\n      }\n    }\n    if (Types.isInlineInput(elem) && elem instanceof InputConnection) {\n      const connectedBlock = elem.connectedBlock;\n      const innerShape = connectedBlock\n        ? (connectedBlock.pathObject as PathObject).outputShapeType\n        : elem.shape.type;\n      if (innerShape == null) {\n        return 0;\n      }\n      // Special case for value to stack / value to statement blocks.\n      if (\n        connectedBlock &&\n        connectedBlock.outputConnection &&\n        (connectedBlock.statementInputCount || connectedBlock.nextConnection)\n      ) {\n        return 0;\n      }\n      // Special case for hexagonal output.\n      if (\n        outerShape === constants.SHAPES.HEXAGONAL &&\n        outerShape !== innerShape\n      ) {\n        return 0;\n      }\n      return (\n        connectionWidth -\n        this.constants_.SHAPE_IN_SHAPE_PADDING[outerShape][innerShape]\n      );\n    } else if (Types.isField(elem) && elem instanceof Field) {\n      // Special case for text inputs.\n      if (\n        outerShape === constants.SHAPES.ROUND &&\n        elem.field instanceof FieldTextInput\n      ) {\n        return connectionWidth - 2.75 * constants.GRID_UNIT;\n      }\n      return (\n        connectionWidth - this.constants_.SHAPE_IN_SHAPE_PADDING[outerShape][0]\n      );\n    } else if (Types.isIcon(elem)) {\n      return this.constants_.SMALL_PADDING;\n    }\n    return 0;\n  }\n\n  /**\n   * Finalize vertical alignment of rows on a block.  In particular, reduce the\n   * implicit spacing when a non-shadow block is connected to any of an input\n   * row's inline inputs.\n   */\n  protected finalizeVerticalAlignment_() {\n    if (this.outputConnection) {\n      return;\n    }\n    // Run through every input row on the block and only apply tight nesting\n    // logic to input rows that have a prev and next notch.\n    for (let i = 2; i < this.rows.length - 1; i += 2) {\n      const prevSpacer = this.rows[i - 1] as SpacerRow;\n      const row = this.rows[i];\n      const nextSpacer = this.rows[i + 1] as SpacerRow;\n\n      const firstRow = i === 2;\n      const hasPrevNotch = firstRow\n        ? !!this.topRow.hasPreviousConnection\n        : !!prevSpacer.followsStatement;\n      const hasNextNotch =\n        i + 2 >= this.rows.length - 1\n          ? !!this.bottomRow.hasNextConnection\n          : !!nextSpacer.precedesStatement;\n\n      if (hasPrevNotch) {\n        const elem = row.elements[1];\n        const hasSingleTextOrImageField =\n          row.elements.length === 3 &&\n          elem instanceof Field &&\n          (elem.field instanceof FieldLabel ||\n            elem.field instanceof FieldImage);\n        if (!firstRow && hasSingleTextOrImageField) {\n          // Remove some padding if we have a single image or text field.\n          prevSpacer.height -= this.constants_.SMALL_PADDING;\n          nextSpacer.height -= this.constants_.SMALL_PADDING;\n          row.height -= this.constants_.MEDIUM_PADDING;\n        } else if (!firstRow && !hasNextNotch) {\n          // Add a small padding so the notch doesn't clash with inputs/fields.\n          prevSpacer.height += this.constants_.SMALL_PADDING;\n        } else if (hasNextNotch) {\n          // Determine if the input row has non-shadow connected blocks.\n          let hasNonShadowConnectedBlocks = false;\n          const minVerticalTightNestingHeight = 40;\n          for (let j = 0; j < row.elements.length; j++) {\n            const elem = row.elements[j];\n            if (\n              elem instanceof InputConnection &&\n              Types.isInlineInput(elem) &&\n              elem.connectedBlock &&\n              !elem.connectedBlock.isShadow() &&\n              elem.connectedBlock.getHeightWidth().height >=\n                minVerticalTightNestingHeight\n            ) {\n              hasNonShadowConnectedBlocks = true;\n              break;\n            }\n          }\n          // Apply tight-nesting if we have both a prev and next notch and the\n          // block has non-shadow connected blocks.\n          if (hasNonShadowConnectedBlocks) {\n            prevSpacer.height -= this.constants_.SMALL_PADDING;\n            nextSpacer.height -= this.constants_.SMALL_PADDING;\n          }\n        }\n      }\n    }\n  }\n\n  override finalize_() {\n    this.finalizeOutputConnection_();\n    this.finalizeHorizontalAlignment_();\n    this.finalizeVerticalAlignment_();\n    super.finalize_();\n\n    if (this.rightSide) {\n      this.widthWithChildren += this.rightSide.width;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.MarkerSvg\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {ASTNode} from '../../keyboard_nav/ast_node.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\nimport type {ConstantProvider as BaseConstantProvider} from '../common/constants.js';\nimport {MarkerSvg as BaseMarkerSvg} from '../common/marker_svg.js';\n\nimport type {ConstantProvider as ZelosConstantProvider} from './constants.js';\n\n/**\n * Class to draw a marker.\n */\nexport class MarkerSvg extends BaseMarkerSvg {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  constants_!: ZelosConstantProvider;\n\n  private markerCircle: SVGCircleElement | null = null;\n\n  /**\n   * @param workspace The workspace the marker belongs to.\n   * @param constants The constants for the renderer.\n   * @param marker The marker to draw.\n   */\n  constructor(\n    workspace: WorkspaceSvg,\n    constants: BaseConstantProvider,\n    marker: Marker,\n  ) {\n    super(workspace, constants, marker);\n  }\n\n  /**\n   * Position and display the marker for an input or an output connection.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  private showWithInputOutput(curNode: ASTNode) {\n    const block = curNode.getSourceBlock() as BlockSvg;\n    const connection = curNode.getLocation() as RenderedConnection;\n    const offsetInBlock = connection.getOffsetInBlock();\n\n    this.positionCircle(offsetInBlock.x, offsetInBlock.y);\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  override showWithOutput_(curNode: ASTNode) {\n    this.showWithInputOutput(curNode);\n  }\n\n  override showWithInput_(curNode: ASTNode) {\n    this.showWithInputOutput(curNode);\n  }\n\n  /**\n   * Draw a rectangle around the block.\n   *\n   * @param curNode The current node of the marker.\n   */\n  override showWithBlock_(curNode: ASTNode) {\n    const block = curNode.getLocation() as BlockSvg;\n\n    // Gets the height and width of entire stack.\n    const heightWidth = block.getHeightWidth();\n    // Add padding so that being on a stack looks different than being on a\n    // block.\n    this.positionRect_(0, 0, heightWidth.width, heightWidth.height);\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position the circle we use for input and output connections.\n   *\n   * @param x The x position of the circle.\n   * @param y The y position of the circle.\n   */\n  private positionCircle(x: number, y: number) {\n    this.markerCircle?.setAttribute('cx', `${x}`);\n    this.markerCircle?.setAttribute('cy', `${y}`);\n    this.currentMarkerSvg = this.markerCircle;\n  }\n\n  override hide() {\n    super.hide();\n    if (this.markerCircle) {\n      this.markerCircle.style.display = 'none';\n    }\n  }\n\n  override createDomInternal_() {\n    /* clang-format off */\n    /* This markup will be generated and added to the .svgGroup_:\n        <g>\n          <rect width=\"100\" height=\"5\">\n            <animate attributeType=\"XML\" attributeName=\"fill\" dur=\"1s\"\n              values=\"transparent;transparent;#fff;transparent\" repeatCount=\"indefinite\" />\n          </rect>\n        </g>\n        */\n    /* clang-format on */\n    super.createDomInternal_();\n\n    this.markerCircle = dom.createSvgElement(\n      Svg.CIRCLE,\n      {\n        'r': this.constants_.CURSOR_RADIUS,\n        'stroke-width': this.constants_.CURSOR_STROKE_WIDTH,\n      },\n      this.markerSvg_,\n    );\n    this.hide();\n\n    // Markers and stack cursors don't blink.\n    if (this.isCursor()) {\n      const blinkProperties = this.getBlinkProperties_();\n      dom.createSvgElement(Svg.ANIMATE, blinkProperties, this.markerCircle!);\n    }\n\n    return this.markerSvg_!;\n  }\n\n  override applyColour_(curNode: ASTNode) {\n    super.applyColour_(curNode);\n\n    this.markerCircle?.setAttribute('fill', this.colour_);\n    this.markerCircle?.setAttribute('stroke', this.colour_);\n\n    if (this.isCursor()) {\n      const values = this.colour_ + ';transparent;transparent;';\n      this.markerCircle?.firstElementChild!.setAttribute('values', values);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.PathObject\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Connection} from '../../connection.js';\nimport type {BlockStyle} from '../../theme.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport {PathObject as BasePathObject} from '../common/path_object.js';\n\nimport type {ConstantProvider} from './constants.js';\n\n/**\n * An object that handles creating and setting each of the SVG elements\n * used by the renderer.\n */\nexport class PathObject extends BasePathObject {\n  /** The selected path of the block. */\n  private svgPathSelected: SVGElement | null = null;\n\n  /** The outline paths on the block. */\n  private readonly outlines = new Map<string, SVGElement>();\n\n  /**\n   * A set used to determine which outlines were used during a draw pass.  The\n   * set is initialized with a reference to all the outlines in\n   * `this.outlines`. Every time we use an outline during the draw pass, the\n   * reference is removed from this set.\n   */\n  private remainingOutlines = new Set<string>();\n\n  /**\n   * The type of block's output connection shape.  This is set when a block\n   * with an output connection is drawn.\n   */\n  outputShapeType: number | null = null;\n\n  public override constants: ConstantProvider;\n\n  /**\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @param constants The renderer's constants.\n   */\n  constructor(\n    root: SVGElement,\n    style: BlockStyle,\n    constants: ConstantProvider,\n  ) {\n    super(root, style, constants);\n\n    this.constants = constants;\n  }\n\n  override setPath(pathString: string) {\n    super.setPath(pathString);\n    if (this.svgPathSelected) {\n      this.svgPathSelected.setAttribute('d', pathString);\n    }\n  }\n\n  override applyColour(block: BlockSvg) {\n    super.applyColour(block);\n    // Set shadow stroke colour.\n    const parent = block.getParent();\n    if (block.isShadow() && parent) {\n      this.svgPath.setAttribute('stroke', parent.style.colourTertiary);\n    }\n\n    // Apply colour to outlines.\n    for (const outline of this.outlines.values()) {\n      outline.setAttribute('fill', this.style.colourTertiary);\n    }\n  }\n\n  override flipRTL() {\n    super.flipRTL();\n    // Mirror each input outline path.\n    for (const outline of this.outlines.values()) {\n      outline.setAttribute('transform', 'scale(-1 1)');\n    }\n  }\n\n  override updateSelected(enable: boolean) {\n    this.setClass_('blocklySelected', enable);\n    if (enable) {\n      if (!this.svgPathSelected) {\n        this.svgPathSelected = this.svgPath.cloneNode(true) as SVGElement;\n        this.svgPathSelected.setAttribute('fill', 'none');\n        this.svgPathSelected.setAttribute(\n          'filter',\n          'url(#' + this.constants.selectedGlowFilterId + ')',\n        );\n        this.svgRoot.appendChild(this.svgPathSelected);\n      }\n    } else {\n      if (this.svgPathSelected) {\n        this.svgRoot.removeChild(this.svgPathSelected);\n        this.svgPathSelected = null;\n      }\n    }\n  }\n\n  override updateReplacementFade(enable: boolean) {\n    this.setClass_('blocklyReplaceable', enable);\n    if (enable) {\n      this.svgPath.setAttribute(\n        'filter',\n        'url(#' + this.constants.replacementGlowFilterId + ')',\n      );\n    } else {\n      this.svgPath.removeAttribute('filter');\n    }\n  }\n\n  override updateShapeForInputHighlight(conn: Connection, enable: boolean) {\n    const name = conn.getParentInput()!.name;\n    const outlinePath = this.getOutlinePath(name);\n    if (!outlinePath) {\n      return;\n    }\n    if (enable) {\n      outlinePath.setAttribute(\n        'filter',\n        'url(#' + this.constants.replacementGlowFilterId + ')',\n      );\n    } else {\n      outlinePath.removeAttribute('filter');\n    }\n  }\n\n  /**\n   * Method that's called when the drawer is about to draw the block.\n   */\n  beginDrawing() {\n    this.remainingOutlines.clear();\n    for (const key of this.outlines.keys()) {\n      this.remainingOutlines.add(key);\n    }\n  }\n\n  /**\n   * Method that's called when the drawer is done drawing.\n   */\n  endDrawing() {\n    // Go through all remaining outlines that were not used this draw pass, and\n    // remove them.\n    if (this.remainingOutlines.size) {\n      for (const key of this.remainingOutlines) {\n        this.removeOutlinePath(key);\n      }\n    }\n    this.remainingOutlines.clear();\n  }\n\n  /**\n   * Set the path generated by the renderer for an outline path on the\n   * respective outline path SVG element.\n   *\n   * @param name The input name.\n   * @param pathString The path.\n   */\n  setOutlinePath(name: string, pathString: string) {\n    const outline = this.getOutlinePath(name);\n    outline.setAttribute('d', pathString);\n    outline.setAttribute('fill', this.style.colourTertiary);\n  }\n\n  /**\n   * Create's an outline path for the specified input.\n   *\n   * @param name The input name.\n   * @returns The SVG outline path.\n   */\n  private getOutlinePath(name: string): SVGElement {\n    if (!this.outlines.has(name)) {\n      this.outlines.set(\n        name,\n        dom.createSvgElement(\n          Svg.PATH,\n          {\n            'class': 'blocklyOutlinePath', // IE doesn't like paths without the\n            // data definition, set empty\n            // default\n            'd': '',\n          },\n          this.svgRoot,\n        ),\n      );\n    }\n    this.remainingOutlines.delete(name);\n    return this.outlines.get(name)!;\n  }\n\n  /**\n   * Remove an outline path that is associated with the specified input.\n   *\n   * @param name The input name.\n   */\n  private removeOutlinePath(name: string) {\n    this.outlines.get(name)?.parentNode?.removeChild(this.outlines.get(name)!);\n    this.outlines.delete(name);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos.Renderer\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {ConnectionType} from '../../connection_type.js';\nimport {InsertionMarkerManager} from '../../insertion_marker_manager.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {BlockStyle} from '../../theme.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\nimport * as blockRendering from '../common/block_rendering.js';\nimport type {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport {Renderer as BaseRenderer} from '../common/renderer.js';\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {PathObject} from './path_object.js';\nimport * as deprecation from '../../utils/deprecation.js';\n\n/**\n * The zelos renderer. This renderer emulates Scratch-style and MakeCode-style\n * rendering.\n *\n * Zelos is the ancient Greek spirit of rivalry and emulation.\n */\nexport class Renderer extends BaseRenderer {\n  protected override constants_!: ConstantProvider;\n\n  /**\n   * @param name The renderer name.\n   */\n  constructor(name: string) {\n    super(name);\n  }\n\n  /**\n   * Create a new instance of the renderer's constant provider.\n   *\n   * @returns The constant provider.\n   */\n  protected override makeConstants_(): ConstantProvider {\n    return new ConstantProvider();\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected override makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n\n  /**\n   * Create a new instance of the renderer's drawer.\n   *\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @returns The drawer.\n   */\n  protected override makeDrawer_(\n    block: BlockSvg,\n    info: BaseRenderInfo,\n  ): Drawer {\n    return new Drawer(block, info as RenderInfo);\n  }\n\n  /**\n   * Create a new instance of the renderer's cursor drawer.\n   *\n   * @param workspace The workspace the cursor belongs to.\n   * @param marker The marker.\n   * @returns The object in charge of drawing the marker.\n   */\n  override makeMarkerDrawer(\n    workspace: WorkspaceSvg,\n    marker: Marker,\n  ): MarkerSvg {\n    return new MarkerSvg(workspace, this.getConstants(), marker);\n  }\n\n  /**\n   * Create a new instance of a renderer path object.\n   *\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @returns The renderer path object.\n   */\n  override makePathObject(root: SVGElement, style: BlockStyle): PathObject {\n    return new PathObject(root, style, this.getConstants() as ConstantProvider);\n  }\n\n  /**\n   * Get the current renderer's constant provider.  We assume that when this is\n   * called, the renderer has already been initialized.\n   *\n   * @returns The constant provider.\n   */\n  override getConstants(): ConstantProvider {\n    return this.constants_;\n  }\n\n  /**\n   * @deprecated v10 - This function is no longer respected. A custom\n   *    IConnectionPreviewer may be able to fulfill the functionality.\n   */\n  override getConnectionPreviewMethod(\n    closest: RenderedConnection,\n    local: RenderedConnection,\n    topBlock: BlockSvg,\n  ) {\n    deprecation.warn(\n      'getConnectionPreviewMethod',\n      'v10',\n      'v12',\n      'an IConnectionPreviewer, if it fulfills your use case.',\n    );\n    if (local.type === ConnectionType.OUTPUT_VALUE) {\n      if (!closest.isConnected()) {\n        return InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE;\n      }\n      // TODO: Returning this is a total hack, because we don't want to show\n      //   a replacement fade, we want to show an outline affect.\n      //   Sadly zelos does not support showing an outline around filled\n      //   inputs, so we have to pretend like the connected block is getting\n      //   replaced.\n      return InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE;\n    }\n\n    return super.getConnectionPreviewMethod(closest, local, topBlock);\n  }\n}\n\nblockRendering.register('zelos', Renderer);\n","/**\n * @license\n * Copyright 2024 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {BlockSvg} from './block_svg.js';\nimport {IConnectionPreviewer} from './interfaces/i_connection_previewer.js';\nimport {RenderedConnection} from './rendered_connection.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\nimport * as blocks from './serialization/blocks.js';\nimport * as eventUtils from './events/utils.js';\nimport * as renderManagement from './render_management.js';\nimport * as registry from './registry.js';\nimport {Renderer as ZelosRenderer} from './renderers/zelos/renderer.js';\nimport {ConnectionType} from './connection_type.js';\n\nexport class InsertionMarkerPreviewer implements IConnectionPreviewer {\n  private readonly workspace: WorkspaceSvg;\n\n  private fadedBlock: BlockSvg | null = null;\n\n  private markerConn: RenderedConnection | null = null;\n\n  private draggedConn: RenderedConnection | null = null;\n\n  private staticConn: RenderedConnection | null = null;\n\n  constructor(draggedBlock: BlockSvg) {\n    this.workspace = draggedBlock.workspace;\n  }\n\n  /**\n   * Display a connection preview where the draggedCon connects to the\n   * staticCon, replacing the replacedBlock (currently connected to the\n   * staticCon).\n   *\n   * @param draggedConn The connection on the block stack being dragged.\n   * @param staticConn The connection not being dragged that we are\n   *     connecting to.\n   * @param replacedBlock The block currently connected to the staticCon that\n   *     is being replaced.\n   */\n  previewReplacement(\n    draggedConn: RenderedConnection,\n    staticConn: RenderedConnection,\n    replacedBlock: BlockSvg,\n  ) {\n    eventUtils.disable();\n    try {\n      this.hidePreview();\n      this.fadedBlock = replacedBlock;\n      replacedBlock.fadeForReplacement(true);\n      if (this.workspace.getRenderer().shouldHighlightConnection(staticConn)) {\n        staticConn.highlight();\n        this.staticConn = staticConn;\n      }\n    } finally {\n      eventUtils.enable();\n    }\n  }\n\n  /**\n   * Display a connection preview where the draggedCon connects to the\n   * staticCon, and no block is being relaced.\n   *\n   * @param draggedConn The connection on the block stack being dragged.\n   * @param staticConn The connection not being dragged that we are\n   *     connecting to.\n   */\n  previewConnection(\n    draggedConn: RenderedConnection,\n    staticConn: RenderedConnection,\n  ) {\n    if (draggedConn === this.draggedConn && staticConn === this.staticConn) {\n      return;\n    }\n\n    eventUtils.disable();\n    try {\n      this.hidePreview();\n\n      // TODO(7898): Instead of special casing, we should change the dragger to\n      //   track the change in distance between the dragged connection and the\n      //   static connection, so that it doesn't disconnect  unless that\n      //   (+ a bit) has been exceeded.\n      if (this.shouldUseMarkerPreview(draggedConn, staticConn)) {\n        this.markerConn = this.previewMarker(draggedConn, staticConn);\n      }\n\n      if (this.workspace.getRenderer().shouldHighlightConnection(staticConn)) {\n        staticConn.highlight();\n      }\n\n      this.draggedConn = draggedConn;\n      this.staticConn = staticConn;\n    } finally {\n      eventUtils.enable();\n    }\n  }\n\n  private shouldUseMarkerPreview(\n    _draggedConn: RenderedConnection,\n    staticConn: RenderedConnection,\n  ): boolean {\n    return (\n      staticConn.type === ConnectionType.PREVIOUS_STATEMENT ||\n      staticConn.type === ConnectionType.NEXT_STATEMENT ||\n      !(this.workspace.getRenderer() instanceof ZelosRenderer)\n    );\n  }\n\n  private previewMarker(\n    draggedConn: RenderedConnection,\n    staticConn: RenderedConnection,\n  ): RenderedConnection | null {\n    const dragged = draggedConn.getSourceBlock();\n    const marker = this.createInsertionMarker(dragged);\n    const markerConn = this.getMatchingConnection(dragged, marker, draggedConn);\n    if (!markerConn) return null;\n\n    // Render disconnected from everything else so that we have a valid\n    // connection location.\n    marker.queueRender();\n    renderManagement.triggerQueuedRenders();\n\n    // Connect() also renders the insertion marker.\n    markerConn.connect(staticConn);\n\n    const originalOffsetToTarget = {\n      x: staticConn.x - markerConn.x,\n      y: staticConn.y - markerConn.y,\n    };\n    const originalOffsetInBlock = markerConn.getOffsetInBlock().clone();\n    renderManagement.finishQueuedRenders().then(() => {\n      if (marker.isDeadOrDying()) return;\n      eventUtils.disable();\n      try {\n        // Position so that the existing block doesn't move.\n        marker?.positionNearConnection(\n          markerConn,\n          originalOffsetToTarget,\n          originalOffsetInBlock,\n        );\n        marker?.getSvgRoot().setAttribute('visibility', 'visible');\n      } finally {\n        eventUtils.enable();\n      }\n    });\n    return markerConn;\n  }\n\n  private createInsertionMarker(origBlock: BlockSvg) {\n    const blockJson = blocks.save(origBlock, {\n      addCoordinates: false,\n      addInputBlocks: false,\n      addNextBlocks: false,\n      doFullSerialization: false,\n    });\n\n    if (!blockJson) {\n      throw new Error(\n        `Failed to serialize source block. ${origBlock.toDevString()}`,\n      );\n    }\n\n    const result = blocks.append(blockJson, this.workspace) as BlockSvg;\n\n    // Turn shadow blocks that are created programmatically during\n    // initalization to insertion markers too.\n    for (const block of result.getDescendants(false)) {\n      block.setInsertionMarker(true);\n    }\n\n    result.initSvg();\n    result.getSvgRoot().setAttribute('visibility', 'hidden');\n    return result;\n  }\n\n  /**\n   * Gets the connection on the marker block that matches the original\n   * connection on the original block.\n   *\n   * @param orig The original block.\n   * @param marker The marker block (where we want to find the matching\n   *     connection).\n   * @param origConn The original connection.\n   */\n  private getMatchingConnection(\n    orig: BlockSvg,\n    marker: BlockSvg,\n    origConn: RenderedConnection,\n  ): RenderedConnection | null {\n    const origConns = orig.getConnections_(true);\n    const markerConns = marker.getConnections_(true);\n    if (origConns.length !== markerConns.length) return null;\n    for (let i = 0; i < origConns.length; i++) {\n      if (origConns[i] === origConn) {\n        return markerConns[i];\n      }\n    }\n    return null;\n  }\n\n  /** Hide any previews that are currently displayed. */\n  hidePreview() {\n    eventUtils.disable();\n    try {\n      if (this.staticConn) {\n        this.staticConn.unhighlight();\n        this.staticConn = null;\n      }\n      if (this.fadedBlock) {\n        this.fadedBlock.fadeForReplacement(false);\n        this.fadedBlock = null;\n      }\n      if (this.markerConn) {\n        this.hideInsertionMarker(this.markerConn);\n        this.markerConn = null;\n        this.draggedConn = null;\n      }\n    } finally {\n      eventUtils.enable();\n    }\n  }\n\n  private hideInsertionMarker(markerConn: RenderedConnection) {\n    const marker = markerConn.getSourceBlock();\n    const markerPrev = marker.previousConnection;\n    const markerOutput = marker.outputConnection;\n\n    if (!markerPrev?.targetConnection && !markerOutput?.targetConnection) {\n      // If we are the top block, unplugging doesn't do anything.\n      // The marker connection may not have a target block if we are hiding\n      // as part of applying connections.\n      markerConn.targetBlock()?.unplug(false);\n    } else {\n      marker.unplug(true);\n    }\n\n    marker.dispose();\n  }\n\n  /** Dispose of any references held by this connection previewer. */\n  dispose() {\n    this.hidePreview();\n  }\n}\n\nregistry.register(\n  registry.Type.CONNECTION_PREVIEWER,\n  registry.DEFAULT,\n  InsertionMarkerPreviewer,\n);\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Align} from './inputs/align.js';\nimport {Input} from './inputs/input.js';\nimport {DummyInput} from './inputs/dummy_input.js';\nimport {EndRowInput} from './inputs/end_row_input.js';\nimport {StatementInput} from './inputs/statement_input.js';\nimport {ValueInput} from './inputs/value_input.js';\nimport {inputTypes} from './inputs/input_types.js';\n\nexport {\n  Align,\n  Input,\n  DummyInput,\n  EndRowInput,\n  StatementInput,\n  ValueInput,\n  inputTypes,\n};\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility functions for generating executable code from\n * Blockly code.\n *\n * @class\n */\n// Former goog.module ID: Blockly.CodeGenerator\n\nimport type {Block} from './block.js';\nimport * as common from './common.js';\nimport {Names, NameType} from './names.js';\nimport type {Workspace} from './workspace.js';\n\n/**\n * Deprecated, no-longer used type declaration for per-block-type generator\n * functions.\n *\n * @deprecated\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/generating-code}\n * @param block The Block instance to generate code for.\n * @param genearator The CodeGenerator calling the function.\n * @returns A string containing the generated code (for statement blocks),\n *     or a [code, precedence] tuple (for value/expression blocks), or\n *     null if no code should be emitted for block.\n */\nexport type BlockGenerator = (\n  block: Block,\n  generator: CodeGenerator,\n) => [string, number] | string | null;\n\n/**\n * Class for a code generator that translates the blocks into a language.\n */\nexport class CodeGenerator {\n  name_: string;\n\n  /**\n   * A dictionary of block generator functions, keyed by block type.\n   * Each block generator function takes two parameters:\n   *\n   * - the Block to generate code for, and\n   * - the calling CodeGenerator (or subclass) instance, so the\n   *   function can call methods defined below (e.g. blockToCode) or\n   *   on the relevant subclass (e.g. JavascripGenerator),\n   *\n   * and returns:\n   *\n   * - a [code, precedence] tuple (for value/expression blocks), or\n   * - a string containing the generated code (for statement blocks), or\n   * - null if no code should be emitted for block.\n   */\n  forBlock: Record<\n    string,\n    (block: Block, generator: this) => [string, number] | string | null\n  > = Object.create(null);\n\n  /**\n   * This is used as a placeholder in functions defined using\n   * CodeGenerator.provideFunction_.  It must not be legal code that could\n   * legitimately appear in a function definition (or comment), and it must\n   * not confuse the regular expression parser.\n   */\n  FUNCTION_NAME_PLACEHOLDER_ = '{leCUI8hutHZI4480Dc}';\n  FUNCTION_NAME_PLACEHOLDER_REGEXP_: RegExp;\n\n  /**\n   * Arbitrary code to inject into locations that risk causing infinite loops.\n   * Any instances of '%1' will be replaced by the block ID that failed.\n   * E.g. `  checkTimeout(%1);\\n`\n   */\n  INFINITE_LOOP_TRAP: string | null = null;\n\n  /**\n   * Arbitrary code to inject before every statement.\n   * Any instances of '%1' will be replaced by the block ID of the statement.\n   * E.g. `highlight(%1);\\n`\n   */\n  STATEMENT_PREFIX: string | null = null;\n\n  /**\n   * Arbitrary code to inject after every statement.\n   * Any instances of '%1' will be replaced by the block ID of the statement.\n   * E.g. `highlight(%1);\\n`\n   */\n  STATEMENT_SUFFIX: string | null = null;\n\n  /**\n   * The method of indenting.  Defaults to two spaces, but language generators\n   * may override this to increase indent or change to tabs.\n   */\n  INDENT = '  ';\n\n  /**\n   * Maximum length for a comment before wrapping.  Does not account for\n   * indenting level.\n   */\n  COMMENT_WRAP = 60;\n\n  /** List of outer-inner pairings that do NOT require parentheses. */\n  ORDER_OVERRIDES: number[][] = [];\n\n  /**\n   * Whether the init method has been called.\n   * Generators that set this flag to false after creation and true in init\n   * will cause blockToCode to emit a warning if the generator has not been\n   * initialized. If this flag is untouched, it will have no effect.\n   */\n  isInitialized: boolean | null = null;\n\n  /** Comma-separated list of reserved words. */\n  protected RESERVED_WORDS_ = '';\n\n  /** A dictionary of definitions to be printed before the code. */\n  protected definitions_: {[key: string]: string} = Object.create(null);\n\n  /**\n   * A dictionary mapping desired function names in definitions_ to actual\n   * function names (to avoid collisions with user functions).\n   */\n  protected functionNames_: {[key: string]: string} = Object.create(null);\n\n  /** A database of variable and procedure names. */\n  nameDB_?: Names = undefined;\n\n  /** @param name Language name of this generator. */\n  constructor(name: string) {\n    this.name_ = name;\n\n    this.FUNCTION_NAME_PLACEHOLDER_REGEXP_ = new RegExp(\n      this.FUNCTION_NAME_PLACEHOLDER_,\n      'g',\n    );\n  }\n\n  /**\n   * Generate code for all blocks in the workspace to the specified language.\n   *\n   * @param workspace Workspace to generate code from.\n   * @returns Generated code.\n   */\n  workspaceToCode(workspace?: Workspace): string {\n    if (!workspace) {\n      // Backwards compatibility from before there could be multiple workspaces.\n      console.warn(\n        'No workspace specified in workspaceToCode call.  Guessing.',\n      );\n      workspace = common.getMainWorkspace();\n    }\n    const code = [];\n    this.init(workspace);\n    const blocks = workspace.getTopBlocks(true);\n    for (let i = 0, block; (block = blocks[i]); i++) {\n      let line = this.blockToCode(block);\n      if (Array.isArray(line)) {\n        // Value blocks return tuples of code and operator order.\n        // Top-level blocks don't care about operator order.\n        line = line[0];\n      }\n      if (line) {\n        if (block.outputConnection) {\n          // This block is a naked value.  Ask the language's code generator if\n          // it wants to append a semicolon, or something.\n          line = this.scrubNakedValue(line);\n          if (this.STATEMENT_PREFIX && !block.suppressPrefixSuffix) {\n            line = this.injectId(this.STATEMENT_PREFIX, block) + line;\n          }\n          if (this.STATEMENT_SUFFIX && !block.suppressPrefixSuffix) {\n            line = line + this.injectId(this.STATEMENT_SUFFIX, block);\n          }\n        }\n        code.push(line);\n      }\n    }\n    // Blank line between each section.\n    let codeString = code.join('\\n');\n    codeString = this.finish(codeString);\n    // Final scrubbing of whitespace.\n    codeString = codeString.replace(/^\\s+\\n/, '');\n    codeString = codeString.replace(/\\n\\s+$/, '\\n');\n    codeString = codeString.replace(/[ \\t]+\\n/g, '\\n');\n    return codeString;\n  }\n\n  /**\n   * Prepend a common prefix onto each line of code.\n   * Intended for indenting code or adding comment markers.\n   *\n   * @param text The lines of code.\n   * @param prefix The common prefix.\n   * @returns The prefixed lines of code.\n   */\n  prefixLines(text: string, prefix: string): string {\n    return prefix + text.replace(/(?!\\n$)\\n/g, '\\n' + prefix);\n  }\n\n  /**\n   * Recursively spider a tree of blocks, returning all their comments.\n   *\n   * @param block The block from which to start spidering.\n   * @returns Concatenated list of comments.\n   */\n  allNestedComments(block: Block): string {\n    const comments = [];\n    const blocks = block.getDescendants(true);\n    for (let i = 0; i < blocks.length; i++) {\n      const comment = blocks[i].getCommentText();\n      if (comment) {\n        comments.push(comment);\n      }\n    }\n    // Append an empty string to create a trailing line break when joined.\n    if (comments.length) {\n      comments.push('');\n    }\n    return comments.join('\\n');\n  }\n\n  /**\n   * Generate code for the specified block (and attached blocks).\n   * The generator must be initialized before calling this function.\n   *\n   * @param block The block to generate code for.\n   * @param opt_thisOnly True to generate code for only this statement.\n   * @returns For statement blocks, the generated code.\n   *     For value blocks, an array containing the generated code and an\n   * operator order value.  Returns '' if block is null.\n   */\n  blockToCode(\n    block: Block | null,\n    opt_thisOnly?: boolean,\n  ): string | [string, number] {\n    if (this.isInitialized === false) {\n      console.warn(\n        'CodeGenerator init was not called before blockToCode was called.',\n      );\n    }\n    if (!block) {\n      return '';\n    }\n    if (!block.isEnabled()) {\n      // Skip past this block if it is disabled.\n      return opt_thisOnly ? '' : this.blockToCode(block.getNextBlock());\n    }\n    if (block.isInsertionMarker()) {\n      // Skip past insertion markers.\n      return opt_thisOnly ? '' : this.blockToCode(block.getChildren(false)[0]);\n    }\n\n    // Look up block generator function in dictionary - but fall back\n    // to looking up on this if not found, for backwards compatibility.\n    const func = this.forBlock[block.type];\n    if (typeof func !== 'function') {\n      throw Error(\n        `${this.name_} generator does not know how to generate code ` +\n          `for block type \"${block.type}\".`,\n      );\n    }\n    // First argument to func.call is the value of 'this' in the generator.\n    // Prior to 24 September 2013 'this' was the only way to access the block.\n    // The current preferred method of accessing the block is through the second\n    // argument to func.call, which becomes the first parameter to the\n    // generator.\n    let code = func.call(block, block, this);\n    if (Array.isArray(code)) {\n      // Value blocks return tuples of code and operator order.\n      if (!block.outputConnection) {\n        throw TypeError('Expecting string from statement block: ' + block.type);\n      }\n      return [this.scrub_(block, code[0], opt_thisOnly), code[1]];\n    } else if (typeof code === 'string') {\n      if (this.STATEMENT_PREFIX && !block.suppressPrefixSuffix) {\n        code = this.injectId(this.STATEMENT_PREFIX, block) + code;\n      }\n      if (this.STATEMENT_SUFFIX && !block.suppressPrefixSuffix) {\n        code = code + this.injectId(this.STATEMENT_SUFFIX, block);\n      }\n      return this.scrub_(block, code, opt_thisOnly);\n    } else if (code === null) {\n      // Block has handled code generation itself.\n      return '';\n    }\n    throw SyntaxError('Invalid code generated: ' + code);\n  }\n\n  /**\n   * Generate code representing the specified value input.\n   *\n   * @param block The block containing the input.\n   * @param name The name of the input.\n   * @param outerOrder The maximum binding strength (minimum order value) of any\n   *     operators adjacent to \"block\".\n   * @returns Generated code or '' if no blocks are connected or the specified\n   *     input does not exist.\n   */\n  valueToCode(block: Block, name: string, outerOrder: number): string {\n    if (isNaN(outerOrder)) {\n      throw TypeError('Expecting valid order from block: ' + block.type);\n    }\n    const targetBlock = block.getInputTargetBlock(name);\n    if (!targetBlock && !block.getInput(name)) {\n      throw ReferenceError(`Input \"${name}\" doesn't exist on \"${block.type}\"`);\n    }\n    if (!targetBlock) {\n      return '';\n    }\n    const tuple = this.blockToCode(targetBlock);\n    if (tuple === '') {\n      // Disabled block.\n      return '';\n    }\n    // Value blocks must return code and order of operations info.\n    // Statement blocks must only return code.\n    if (!Array.isArray(tuple)) {\n      throw TypeError(\n        `Expecting tuple from value block: ${targetBlock.type} See ` +\n          `developers.google.com/blockly/guides/create-custom-blocks/generating-code ` +\n          `for more information`,\n      );\n    }\n    let code = tuple[0];\n    const innerOrder = tuple[1];\n    if (isNaN(innerOrder)) {\n      throw TypeError(\n        'Expecting valid order from value block: ' + targetBlock.type,\n      );\n    }\n    if (!code) {\n      return '';\n    }\n\n    // Add parentheses if needed.\n    let parensNeeded = false;\n    const outerOrderClass = Math.floor(outerOrder);\n    const innerOrderClass = Math.floor(innerOrder);\n    if (outerOrderClass <= innerOrderClass) {\n      if (\n        outerOrderClass === innerOrderClass &&\n        (outerOrderClass === 0 || outerOrderClass === 99)\n      ) {\n        // Don't generate parens around NONE-NONE and ATOMIC-ATOMIC pairs.\n        // 0 is the atomic order, 99 is the none order.  No parentheses needed.\n        // In all known languages multiple such code blocks are not order\n        // sensitive.  In fact in Python ('a' 'b') 'c' would fail.\n      } else {\n        // The operators outside this code are stronger than the operators\n        // inside this code.  To prevent the code from being pulled apart,\n        // wrap the code in parentheses.\n        parensNeeded = true;\n        // Check for special exceptions.\n        for (let i = 0; i < this.ORDER_OVERRIDES.length; i++) {\n          if (\n            this.ORDER_OVERRIDES[i][0] === outerOrder &&\n            this.ORDER_OVERRIDES[i][1] === innerOrder\n          ) {\n            parensNeeded = false;\n            break;\n          }\n        }\n      }\n    }\n    if (parensNeeded) {\n      // Technically, this should be handled on a language-by-language basis.\n      // However all known (sane) languages use parentheses for grouping.\n      code = '(' + code + ')';\n    }\n    return code;\n  }\n\n  /**\n   * Generate a code string representing the blocks attached to the named\n   * statement input. Indent the code.\n   * This is mainly used in generators. When trying to generate code to evaluate\n   * look at using workspaceToCode or blockToCode.\n   *\n   * @param block The block containing the input.\n   * @param name The name of the input.\n   * @returns Generated code or '' if no blocks are connected.\n   */\n  statementToCode(block: Block, name: string): string {\n    const targetBlock = block.getInputTargetBlock(name);\n    if (!targetBlock && !block.getInput(name)) {\n      throw ReferenceError(`Input \"${name}\" doesn't exist on \"${block.type}\"`);\n    }\n    let code = this.blockToCode(targetBlock);\n    // Value blocks must return code and order of operations info.\n    // Statement blocks must only return code.\n    if (typeof code !== 'string') {\n      throw TypeError(\n        'Expecting code from statement block: ' +\n          (targetBlock && targetBlock.type),\n      );\n    }\n    if (code) {\n      code = this.prefixLines(code, this.INDENT);\n    }\n    return code;\n  }\n\n  /**\n   * Add an infinite loop trap to the contents of a loop.\n   * Add statement suffix at the start of the loop block (right after the loop\n   * statement executes), and a statement prefix to the end of the loop block\n   * (right before the loop statement executes).\n   *\n   * @param branch Code for loop contents.\n   * @param block Enclosing block.\n   * @returns Loop contents, with infinite loop trap added.\n   */\n  addLoopTrap(branch: string, block: Block): string {\n    if (this.INFINITE_LOOP_TRAP) {\n      branch =\n        this.prefixLines(\n          this.injectId(this.INFINITE_LOOP_TRAP, block),\n          this.INDENT,\n        ) + branch;\n    }\n    if (this.STATEMENT_SUFFIX && !block.suppressPrefixSuffix) {\n      branch =\n        this.prefixLines(\n          this.injectId(this.STATEMENT_SUFFIX, block),\n          this.INDENT,\n        ) + branch;\n    }\n    if (this.STATEMENT_PREFIX && !block.suppressPrefixSuffix) {\n      branch =\n        branch +\n        this.prefixLines(\n          this.injectId(this.STATEMENT_PREFIX, block),\n          this.INDENT,\n        );\n    }\n    return branch;\n  }\n\n  /**\n   * Inject a block ID into a message to replace '%1'.\n   * Used for STATEMENT_PREFIX, STATEMENT_SUFFIX, and INFINITE_LOOP_TRAP.\n   *\n   * @param msg Code snippet with '%1'.\n   * @param block Block which has an ID.\n   * @returns Code snippet with ID.\n   */\n  injectId(msg: string, block: Block): string {\n    const id = block.id.replace(/\\$/g, '$$$$'); // Issue 251.\n    return msg.replace(/%1/g, \"'\" + id + \"'\");\n  }\n\n  /**\n   * Add one or more words to the list of reserved words for this language.\n   *\n   * @param words Comma-separated list of words to add to the list.\n   *     No spaces.  Duplicates are ok.\n   */\n  addReservedWords(words: string) {\n    this.RESERVED_WORDS_ += words + ',';\n  }\n\n  /**\n   * Define a developer-defined function (not a user-defined procedure) to be\n   * included in the generated code.  Used for creating private helper\n   * functions. The first time this is called with a given desiredName, the code\n   * is saved and an actual name is generated.  Subsequent calls with the same\n   * desiredName have no effect but have the same return value.\n   *\n   * It is up to the caller to make sure the same desiredName is not\n   * used for different helper functions (e.g. use \"colourRandom\" and\n   * \"listRandom\", not \"random\").  There is no danger of colliding with reserved\n   * words, or user-defined variable or procedure names.\n   *\n   * The code gets output when CodeGenerator.finish() is called.\n   *\n   * @param desiredName The desired name of the function (e.g. mathIsPrime).\n   * @param code A list of statements or one multi-line code string.  Use '  '\n   *     for indents (they will be replaced).\n   * @returns The actual name of the new function.  This may differ from\n   *     desiredName if the former has already been taken by the user.\n   */\n  provideFunction_(desiredName: string, code: string[] | string): string {\n    if (!this.definitions_[desiredName]) {\n      const functionName = this.nameDB_!.getDistinctName(\n        desiredName,\n        NameType.PROCEDURE,\n      );\n      this.functionNames_[desiredName] = functionName;\n      if (Array.isArray(code)) {\n        code = code.join('\\n');\n      }\n      let codeText = code\n        .trim()\n        .replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_, functionName);\n      // Change all '  ' indents into the desired indent.\n      // To avoid an infinite loop of replacements, change all indents to '\\0'\n      // character first, then replace them all with the indent.\n      // We are assuming that no provided functions contain a literal null char.\n      let oldCodeText;\n      while (oldCodeText !== codeText) {\n        oldCodeText = codeText;\n        codeText = codeText.replace(/^(( {2})*) {2}/gm, '$1\\0');\n      }\n      codeText = codeText.replace(/\\0/g, this.INDENT);\n      this.definitions_[desiredName] = codeText;\n    }\n    return this.functionNames_[desiredName];\n  }\n\n  /**\n   * Gets a unique, legal name for a user-defined variable.\n   * Before calling this method, the `nameDB_` property of the class\n   * must have been initialized already. This is typically done in\n   * the `init` function of the code generator class.\n   *\n   * @param nameOrId The ID of the variable to get a name for,\n   *    or the proposed name for a variable not associated with an id.\n   * @returns A unique, legal name for the variable.\n   */\n  getVariableName(nameOrId: string): string {\n    return this.getName(nameOrId, NameType.VARIABLE);\n  }\n\n  /**\n   * Gets a unique, legal name for a user-defined procedure.\n   * Before calling this method, the `nameDB_` property of the class\n   * must have been initialized already. This is typically done in\n   * the `init` function of the code generator class.\n   *\n   * @param name The proposed name for a procedure.\n   * @returns A unique, legal name for the procedure.\n   */\n  getProcedureName(name: string): string {\n    return this.getName(name, NameType.PROCEDURE);\n  }\n\n  private getName(nameOrId: string, type: NameType): string {\n    if (!this.nameDB_) {\n      throw new Error(\n        'Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.',\n      );\n    }\n    return this.nameDB_.getName(nameOrId, type);\n  }\n\n  /**\n   * Hook for code to run before code generation starts.\n   * Subclasses may override this, e.g. to initialise the database of variable\n   * names.\n   *\n   * @param _workspace Workspace to generate code from.\n   */\n  init(_workspace: Workspace) {\n    // Optionally override\n    // Create a dictionary of definitions to be printed before the code.\n    this.definitions_ = Object.create(null);\n    // Create a dictionary mapping desired developer-defined function names in\n    // definitions_ to actual function names (to avoid collisions with\n    // user-defined procedures).\n    this.functionNames_ = Object.create(null);\n  }\n\n  /**\n   * Common tasks for generating code from blocks.  This is called from\n   * blockToCode and is called on every block, not just top level blocks.\n   * Subclasses may override this, e.g. to generate code for statements\n   * following the block, or to handle comments for the specified block and any\n   * connected value blocks.\n   *\n   * @param _block The current block.\n   * @param code The code created for this block.\n   * @param _opt_thisOnly True to generate code for only this statement.\n   * @returns Code with comments and subsequent blocks added.\n   */\n  scrub_(_block: Block, code: string, _opt_thisOnly?: boolean): string {\n    // Optionally override\n    return code;\n  }\n\n  /**\n   * Hook for code to run at end of code generation.\n   * Subclasses may override this, e.g. to prepend the generated code with\n   * import statements or variable definitions.\n   *\n   * @param code Generated code.\n   * @returns Completed code.\n   */\n  finish(code: string): string {\n    // Optionally override\n    // Clean up temporary data.\n    this.definitions_ = Object.create(null);\n    this.functionNames_ = Object.create(null);\n    return code;\n  }\n\n  /**\n   * Naked values are top-level blocks with outputs that aren't plugged into\n   * anything.\n   * Subclasses may override this, e.g. if their language does not allow\n   * naked values.\n   *\n   * @param line Line of generated code.\n   * @returns Legal line of code.\n   */\n  scrubNakedValue(line: string): string {\n    // Optionally override\n    return line;\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Calculates and reports flyout workspace metrics.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FlyoutMetricsManager\n\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport {ContainerRegion, MetricsManager} from './metrics_manager.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Calculates metrics for a flyout's workspace.\n * The metrics are mainly used to size scrollbars for the flyout.\n */\nexport class FlyoutMetricsManager extends MetricsManager {\n  /** The flyout that owns the workspace to calculate metrics for. */\n  protected flyout_: IFlyout;\n\n  /**\n   * @param workspace The flyout's workspace.\n   * @param flyout The flyout.\n   */\n  constructor(workspace: WorkspaceSvg, flyout: IFlyout) {\n    super(workspace);\n    this.flyout_ = flyout;\n  }\n\n  /**\n   * Gets the bounding box of the blocks on the flyout's workspace.\n   * This is in workspace coordinates.\n   *\n   * @returns The bounding box of the blocks on the workspace.\n   */\n  private getBoundingBox_():\n    | SVGRect\n    | {height: number; y: number; width: number; x: number} {\n    let blockBoundingBox;\n    try {\n      blockBoundingBox = this.workspace_.getCanvas().getBBox();\n    } catch (e) {\n      // Firefox has trouble with hidden elements (Bug 528969).\n      // 2021 Update: It looks like this was fixed around Firefox 77 released in\n      // 2020.\n      blockBoundingBox = {height: 0, y: 0, width: 0, x: 0};\n    }\n    return blockBoundingBox;\n  }\n\n  override getContentMetrics(opt_getWorkspaceCoordinates?: boolean) {\n    // The bounding box is in workspace coordinates.\n    const blockBoundingBox = this.getBoundingBox_();\n    const scale = opt_getWorkspaceCoordinates ? 1 : this.workspace_.scale;\n\n    return {\n      height: blockBoundingBox.height * scale,\n      width: blockBoundingBox.width * scale,\n      top: blockBoundingBox.y * scale,\n      left: blockBoundingBox.x * scale,\n    };\n  }\n\n  override getScrollMetrics(\n    opt_getWorkspaceCoordinates?: boolean,\n    opt_viewMetrics?: ContainerRegion,\n    opt_contentMetrics?: ContainerRegion,\n  ) {\n    const contentMetrics = opt_contentMetrics || this.getContentMetrics();\n    const margin = this.flyout_.MARGIN * this.workspace_.scale;\n    const scale = opt_getWorkspaceCoordinates ? this.workspace_.scale : 1;\n\n    // The left padding isn't just the margin. Some blocks are also offset by\n    // tabWidth so that value and statement blocks line up.\n    // The contentMetrics.left value is equivalent to the variable left padding.\n    const leftPadding = contentMetrics.left;\n\n    return {\n      height: (contentMetrics.height + 2 * margin) / scale,\n      width: (contentMetrics.width + leftPadding + margin) / scale,\n      top: 0,\n      left: 0,\n    };\n  }\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Flyout tray containing blocks which may be created.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Flyout\n\nimport type {Abstract as AbstractEvent} from './events/events_abstract.js';\nimport type {Block} from './block.js';\nimport {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {DeleteArea} from './delete_area.js';\nimport * as eventUtils from './events/utils.js';\nimport {FlyoutButton} from './flyout_button.js';\nimport {FlyoutMetricsManager} from './flyout_metrics_manager.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport {MANUALLY_DISABLED} from './constants.js';\nimport type {Options} from './options.js';\nimport {ScrollbarPair} from './scrollbar_pair.js';\nimport * as blocks from './serialization/blocks.js';\nimport * as Tooltip from './tooltip.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport {Svg} from './utils/svg.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as Variables from './variables.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\nimport * as utilsXml from './utils/xml.js';\nimport * as Xml from './xml.js';\nimport * as renderManagement from './render_management.js';\nimport {IAutoHideable} from './interfaces/i_autohideable.js';\n\nenum FlyoutItemType {\n  BLOCK = 'block',\n  BUTTON = 'button',\n}\n\n/**\n * The language-neutral ID for when the reason why a block is disabled is\n * because the workspace is at block capacity.\n */\nconst WORKSPACE_AT_BLOCK_CAPACITY_DISABLED_REASON =\n  'WORKSPACE_AT_BLOCK_CAPACITY';\n\n/**\n * Class for a flyout.\n */\nexport abstract class Flyout\n  extends DeleteArea\n  implements IAutoHideable, IFlyout\n{\n  /**\n   * Position the flyout.\n   */\n  abstract position(): void;\n\n  /**\n   * Determine if a drag delta is toward the workspace, based on the position\n   * and orientation of the flyout. This is used in determineDragIntention_ to\n   * determine if a new block should be created or if the flyout should scroll.\n   *\n   * @param currentDragDeltaXY How far the pointer has\n   *     moved from the position at mouse down, in pixel units.\n   * @returns True if the drag is toward the workspace.\n   */\n  abstract isDragTowardWorkspace(currentDragDeltaXY: Coordinate): boolean;\n\n  /**\n   * Sets the translation of the flyout to match the scrollbars.\n   *\n   * @param xyRatio Contains a y property which is a float\n   *     between 0 and 1 specifying the degree of scrolling and a\n   *     similar x property.\n   */\n  protected abstract setMetrics_(xyRatio: {x?: number; y?: number}): void;\n\n  /**\n   * Lay out the blocks in the flyout.\n   *\n   * @param contents The blocks and buttons to lay out.\n   * @param gaps The visible gaps between blocks.\n   */\n  protected abstract layout_(contents: FlyoutItem[], gaps: number[]): void;\n\n  /**\n   * Scroll the flyout.\n   *\n   * @param e Mouse wheel scroll event.\n   */\n  protected abstract wheel_(e: WheelEvent): void;\n\n  /**\n   * Compute height of flyout.  Position mat under each block.\n   * For RTL: Lay out the blocks right-aligned.\n   */\n  protected abstract reflowInternal_(): void;\n\n  /**\n   * Calculates the x coordinate for the flyout position.\n   *\n   * @returns X coordinate.\n   */\n  abstract getX(): number;\n\n  /**\n   * Calculates the y coordinate for the flyout position.\n   *\n   * @returns Y coordinate.\n   */\n  abstract getY(): number;\n\n  /**\n   * Scroll the flyout to the beginning of its contents.\n   */\n  abstract scrollToStart(): void;\n\n  /**\n   * The type of a flyout content item.\n   */\n  static FlyoutItemType = FlyoutItemType;\n\n  protected workspace_: WorkspaceSvg;\n  RTL: boolean;\n  /**\n   * Whether the flyout should be laid out horizontally or not.\n   *\n   * @internal\n   */\n  horizontalLayout = false;\n  protected toolboxPosition_: number;\n\n  /**\n   * Array holding info needed to unbind events.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  private boundEvents: browserEvents.Data[] = [];\n\n  /**\n   * Function that will be registered as a change listener on the workspace\n   * to reflow when blocks in the flyout workspace change.\n   */\n  private reflowWrapper: ((e: AbstractEvent) => void) | null = null;\n\n  /**\n   * Function that disables blocks in the flyout based on max block counts\n   * allowed in the target workspace. Registered as a change listener on the\n   * target workspace.\n   */\n  private filterWrapper: ((e: AbstractEvent) => void) | null = null;\n\n  /**\n   * List of background mats that lurk behind each block to catch clicks\n   * landing in the blocks' lakes and bays.\n   */\n  private mats: SVGElement[] = [];\n\n  /**\n   * List of visible buttons.\n   */\n  protected buttons_: FlyoutButton[] = [];\n\n  /**\n   * List of visible buttons and blocks.\n   */\n  protected contents: FlyoutItem[] = [];\n\n  /**\n   * List of event listeners.\n   */\n  private listeners: browserEvents.Data[] = [];\n\n  /**\n   * List of blocks that should always be disabled.\n   */\n  private permanentlyDisabled: Block[] = [];\n\n  protected readonly tabWidth_: number;\n\n  /**\n   * The target workspace.\n   *\n   * @internal\n   */\n  targetWorkspace!: WorkspaceSvg;\n\n  /**\n   * A list of blocks that can be reused.\n   */\n  private recycledBlocks: BlockSvg[] = [];\n\n  /**\n   * Does the flyout automatically close when a block is created?\n   */\n  autoClose = true;\n\n  /**\n   * Whether the flyout is visible.\n   */\n  private isVisible_ = false;\n\n  /**\n   * Whether the workspace containing this flyout is visible.\n   */\n  private containerVisible = true;\n  protected rectMap_: WeakMap<BlockSvg, SVGElement>;\n\n  /**\n   * Corner radius of the flyout background.\n   */\n  readonly CORNER_RADIUS: number = 8;\n  readonly MARGIN: number;\n  readonly GAP_X: number;\n  readonly GAP_Y: number;\n\n  /**\n   * Top/bottom padding between scrollbar and edge of flyout background.\n   */\n  readonly SCROLLBAR_MARGIN: number = 2.5;\n\n  /**\n   * Width of flyout.\n   */\n  protected width_ = 0;\n\n  /**\n   * Height of flyout.\n   */\n  protected height_ = 0;\n  // clang-format off\n  /**\n   * Range of a drag angle from a flyout considered \"dragging toward\n   * workspace\". Drags that are within the bounds of this many degrees from\n   * the orthogonal line to the flyout edge are considered to be \"drags toward\n   * the workspace\".\n   *\n   * @example\n   *\n   * ```\n   * Flyout                                                 Edge   Workspace\n   * [block] /  <-within this angle, drags \"toward workspace\" |\n   * [block] ---- orthogonal to flyout boundary ----          |\n   * [block] \\                                                |\n   * ```\n   *\n   * The angle is given in degrees from the orthogonal.\n   *\n   * This is used to know when to create a new block and when to scroll the\n   * flyout. Setting it to 360 means that all drags create a new block.\n   */\n  // clang-format on\n  protected dragAngleRange_ = 70;\n\n  /**\n   * The path around the background of the flyout, which will be filled with a\n   * background colour.\n   */\n  protected svgBackground_: SVGPathElement | null = null;\n\n  /**\n   * The root SVG group for the button or label.\n   */\n  protected svgGroup_: SVGGElement | null = null;\n  /**\n   * @param workspaceOptions Dictionary of options for the\n   *     workspace.\n   */\n  constructor(workspaceOptions: Options) {\n    super();\n    workspaceOptions.setMetrics = this.setMetrics_.bind(this);\n\n    this.workspace_ = new WorkspaceSvg(workspaceOptions);\n    this.workspace_.setMetricsManager(\n      new FlyoutMetricsManager(this.workspace_, this),\n    );\n\n    this.workspace_.internalIsFlyout = true;\n    // Keep the workspace visibility consistent with the flyout's visibility.\n    this.workspace_.setVisible(this.isVisible_);\n\n    /**\n     * The unique id for this component that is used to register with the\n     * ComponentManager.\n     */\n    this.id = idGenerator.genUid();\n\n    /**\n     * Is RTL vs LTR.\n     */\n    this.RTL = !!workspaceOptions.RTL;\n\n    /**\n     * Position of the toolbox and flyout relative to the workspace.\n     */\n    this.toolboxPosition_ = workspaceOptions.toolboxPosition;\n\n    /**\n     * Width of output tab.\n     */\n    this.tabWidth_ = this.workspace_.getRenderer().getConstants().TAB_WIDTH;\n\n    /**\n     * A map from blocks to the rects which are beneath them to act as input\n     * targets.\n     *\n     * @internal\n     */\n    this.rectMap_ = new WeakMap();\n\n    /**\n     * Margin around the edges of the blocks in the flyout.\n     */\n    this.MARGIN = this.CORNER_RADIUS;\n\n    // TODO: Move GAP_X and GAP_Y to their appropriate files.\n    /**\n     * Gap between items in horizontal flyouts. Can be overridden with the \"sep\"\n     * element.\n     */\n    this.GAP_X = this.MARGIN * 3;\n\n    /**\n     * Gap between items in vertical flyouts. Can be overridden with the \"sep\"\n     * element.\n     */\n    this.GAP_Y = this.MARGIN * 3;\n  }\n\n  /**\n   * Creates the flyout's DOM.  Only needs to be called once.  The flyout can\n   * either exist as its own SVG element or be a g element nested inside a\n   * separate SVG element.\n   *\n   * @param tagName The type of tag to\n   *     put the flyout in. This should be <svg> or <g>.\n   * @returns The flyout's SVG group.\n   */\n  createDom(\n    tagName: string | Svg<SVGSVGElement> | Svg<SVGGElement>,\n  ): SVGElement {\n    /*\n        <svg | g>\n          <path class=\"blocklyFlyoutBackground\"/>\n          <g class=\"blocklyFlyout\"></g>\n        </ svg | g>\n        */\n    // Setting style to display:none to start. The toolbox and flyout\n    // hide/show code will set up proper visibility and size later.\n    this.svgGroup_ = dom.createSvgElement(tagName, {\n      'class': 'blocklyFlyout',\n    });\n    this.svgGroup_.style.display = 'none';\n    this.svgBackground_ = dom.createSvgElement(\n      Svg.PATH,\n      {'class': 'blocklyFlyoutBackground'},\n      this.svgGroup_,\n    );\n    this.svgGroup_.appendChild(this.workspace_.createDom());\n    this.workspace_\n      .getThemeManager()\n      .subscribe(this.svgBackground_, 'flyoutBackgroundColour', 'fill');\n    this.workspace_\n      .getThemeManager()\n      .subscribe(this.svgBackground_, 'flyoutOpacity', 'fill-opacity');\n    return this.svgGroup_;\n  }\n\n  /**\n   * Initializes the flyout.\n   *\n   * @param targetWorkspace The workspace in which to\n   *     create new blocks.\n   */\n  init(targetWorkspace: WorkspaceSvg) {\n    this.targetWorkspace = targetWorkspace;\n    this.workspace_.targetWorkspace = targetWorkspace;\n\n    this.workspace_.scrollbar = new ScrollbarPair(\n      this.workspace_,\n      this.horizontalLayout,\n      !this.horizontalLayout,\n      'blocklyFlyoutScrollbar',\n      this.SCROLLBAR_MARGIN,\n    );\n\n    this.hide();\n\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        this.svgGroup_ as SVGGElement,\n        'wheel',\n        this,\n        this.wheel_,\n      ),\n    );\n    this.filterWrapper = this.filterForCapacity.bind(this);\n    this.targetWorkspace.addChangeListener(this.filterWrapper);\n\n    // Dragging the flyout up and down.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        this.svgBackground_ as SVGPathElement,\n        'pointerdown',\n        this,\n        this.onMouseDown,\n      ),\n    );\n\n    // A flyout connected to a workspace doesn't have its own current gesture.\n    this.workspace_.getGesture = this.targetWorkspace.getGesture.bind(\n      this.targetWorkspace,\n    );\n\n    // Get variables from the main workspace rather than the target workspace.\n    this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap());\n\n    this.workspace_.createPotentialVariableMap();\n\n    targetWorkspace.getComponentManager().addComponent({\n      component: this,\n      weight: 1,\n      capabilities: [\n        ComponentManager.Capability.AUTOHIDEABLE,\n        ComponentManager.Capability.DELETE_AREA,\n        ComponentManager.Capability.DRAG_TARGET,\n      ],\n    });\n  }\n\n  /**\n   * Dispose of this flyout.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    this.hide();\n    this.targetWorkspace.getComponentManager().removeComponent(this.id);\n    for (const event of this.boundEvents) {\n      browserEvents.unbind(event);\n    }\n    this.boundEvents.length = 0;\n    if (this.filterWrapper) {\n      this.targetWorkspace.removeChangeListener(this.filterWrapper);\n    }\n    if (this.workspace_) {\n      this.workspace_.getThemeManager().unsubscribe(this.svgBackground_!);\n      this.workspace_.dispose();\n    }\n    if (this.svgGroup_) {\n      dom.removeNode(this.svgGroup_);\n    }\n  }\n\n  /**\n   * Get the width of the flyout.\n   *\n   * @returns The width of the flyout.\n   */\n  getWidth(): number {\n    return this.width_;\n  }\n\n  /**\n   * Get the height of the flyout.\n   *\n   * @returns The width of the flyout.\n   */\n  getHeight(): number {\n    return this.height_;\n  }\n\n  /**\n   * Get the scale (zoom level) of the flyout. By default,\n   * this matches the target workspace scale, but this can be overridden.\n   *\n   * @returns Flyout workspace scale.\n   */\n  getFlyoutScale(): number {\n    return this.targetWorkspace.scale;\n  }\n\n  /**\n   * Get the workspace inside the flyout.\n   *\n   * @returns The workspace inside the flyout.\n   */\n  getWorkspace(): WorkspaceSvg {\n    return this.workspace_;\n  }\n\n  /**\n   * Sets whether this flyout automatically closes when blocks are dragged out,\n   * the workspace is clicked, etc, or not.\n   */\n  setAutoClose(autoClose: boolean) {\n    this.autoClose = autoClose;\n    this.targetWorkspace.recordDragTargets();\n    this.targetWorkspace.resizeContents();\n  }\n\n  /** Automatically hides the flyout if it is an autoclosing flyout. */\n  autoHide(onlyClosePopups: boolean): void {\n    if (\n      !onlyClosePopups &&\n      this.targetWorkspace.getFlyout(true) === this &&\n      this.autoClose\n    )\n      this.hide();\n  }\n\n  /**\n   * Get the target workspace inside the flyout.\n   *\n   * @returns The target workspace inside the flyout.\n   */\n  getTargetWorkspace(): WorkspaceSvg {\n    return this.targetWorkspace;\n  }\n\n  /**\n   * Is the flyout visible?\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.isVisible_;\n  }\n\n  /**\n   * Set whether the flyout is visible. A value of true does not necessarily\n   * mean that the flyout is shown. It could be hidden because its container is\n   * hidden.\n   *\n   * @param visible True if visible.\n   */\n  setVisible(visible: boolean) {\n    const visibilityChanged = visible !== this.isVisible();\n\n    this.isVisible_ = visible;\n    if (visibilityChanged) {\n      if (!this.autoClose) {\n        // Auto-close flyouts are ignored as drag targets, so only non\n        // auto-close flyouts need to have their drag target updated.\n        this.targetWorkspace.recordDragTargets();\n      }\n      this.updateDisplay();\n    }\n  }\n\n  /**\n   * Set whether this flyout's container is visible.\n   *\n   * @param visible Whether the container is visible.\n   */\n  setContainerVisible(visible: boolean) {\n    const visibilityChanged = visible !== this.containerVisible;\n    this.containerVisible = visible;\n    if (visibilityChanged) {\n      this.updateDisplay();\n    }\n  }\n\n  /**\n   * Get the list of buttons and blocks of the current flyout.\n   *\n   * @returns The array of flyout buttons and blocks.\n   */\n  getContents(): FlyoutItem[] {\n    return this.contents;\n  }\n\n  /**\n   * Store the list of buttons and blocks on the flyout.\n   *\n   * @param contents - The array of items for the flyout.\n   */\n  setContents(contents: FlyoutItem[]): void {\n    this.contents = contents;\n  }\n  /**\n   * Update the display property of the flyout based whether it thinks it should\n   * be visible and whether its containing workspace is visible.\n   */\n  private updateDisplay() {\n    let show = true;\n    if (!this.containerVisible) {\n      show = false;\n    } else {\n      show = this.isVisible();\n    }\n    if (this.svgGroup_) {\n      this.svgGroup_.style.display = show ? 'block' : 'none';\n    }\n    // Update the scrollbar's visibility too since it should mimic the\n    // flyout's visibility.\n    this.workspace_.scrollbar?.setContainerVisible(show);\n  }\n\n  /**\n   * Update the view based on coordinates calculated in position().\n   *\n   * @param width The computed width of the flyout's SVG group\n   * @param height The computed height of the flyout's SVG group.\n   * @param x The computed x origin of the flyout's SVG group.\n   * @param y The computed y origin of the flyout's SVG group.\n   */\n  protected positionAt_(width: number, height: number, x: number, y: number) {\n    this.svgGroup_?.setAttribute('width', `${width}`);\n    this.svgGroup_?.setAttribute('height', `${height}`);\n    this.workspace_.setCachedParentSvgSize(width, height);\n\n    if (this.svgGroup_) {\n      const transform = 'translate(' + x + 'px,' + y + 'px)';\n      dom.setCssTransform(this.svgGroup_, transform);\n    }\n\n    // Update the scrollbar (if one exists).\n    const scrollbar = this.workspace_.scrollbar;\n    if (scrollbar) {\n      // Set the scrollbars origin to be the top left of the flyout.\n      scrollbar.setOrigin(x, y);\n      scrollbar.resize();\n      // If origin changed and metrics haven't changed enough to trigger\n      // reposition in resize, we need to call setPosition. See issue #4692.\n      if (scrollbar.hScroll) {\n        scrollbar.hScroll.setPosition(\n          scrollbar.hScroll.position.x,\n          scrollbar.hScroll.position.y,\n        );\n      }\n      if (scrollbar.vScroll) {\n        scrollbar.vScroll.setPosition(\n          scrollbar.vScroll.position.x,\n          scrollbar.vScroll.position.y,\n        );\n      }\n    }\n  }\n\n  /**\n   * Hide and empty the flyout.\n   */\n  hide() {\n    if (!this.isVisible()) {\n      return;\n    }\n    this.setVisible(false);\n    // Delete all the event listeners.\n    for (const listen of this.listeners) {\n      browserEvents.unbind(listen);\n    }\n    this.listeners.length = 0;\n    if (this.reflowWrapper) {\n      this.workspace_.removeChangeListener(this.reflowWrapper);\n      this.reflowWrapper = null;\n    }\n    // Do NOT delete the blocks here.  Wait until Flyout.show.\n    // https://neil.fraser.name/news/2014/08/09/\n  }\n\n  /**\n   * Show and populate the flyout.\n   *\n   * @param flyoutDef Contents to display\n   *     in the flyout. This is either an array of Nodes, a NodeList, a\n   *     toolbox definition, or a string with the name of the dynamic category.\n   */\n  show(flyoutDef: toolbox.FlyoutDefinition | string) {\n    this.workspace_.setResizesEnabled(false);\n    this.hide();\n    this.clearOldBlocks();\n\n    // Handle dynamic categories, represented by a name instead of a list.\n    if (typeof flyoutDef === 'string') {\n      flyoutDef = this.getDynamicCategoryContents(flyoutDef);\n    }\n    this.setVisible(true);\n\n    // Parse the Array, Node or NodeList into a a list of flyout items.\n    const parsedContent = toolbox.convertFlyoutDefToJsonArray(flyoutDef);\n    const flyoutInfo = this.createFlyoutInfo(parsedContent);\n\n    renderManagement.triggerQueuedRenders(this.workspace_);\n\n    this.setContents(flyoutInfo.contents);\n\n    this.layout_(flyoutInfo.contents, flyoutInfo.gaps);\n\n    if (this.horizontalLayout) {\n      this.height_ = 0;\n    } else {\n      this.width_ = 0;\n    }\n    this.workspace_.setResizesEnabled(true);\n    this.reflow();\n\n    this.filterForCapacity();\n\n    // Correctly position the flyout's scrollbar when it opens.\n    this.position();\n\n    this.reflowWrapper = this.reflow.bind(this);\n    this.workspace_.addChangeListener(this.reflowWrapper);\n    this.emptyRecycledBlocks();\n  }\n\n  /**\n   * Create the contents array and gaps array necessary to create the layout for\n   * the flyout.\n   *\n   * @param parsedContent The array\n   *     of objects to show in the flyout.\n   * @returns The list of contents and gaps needed to lay out the flyout.\n   */\n  private createFlyoutInfo(parsedContent: toolbox.FlyoutItemInfoArray): {\n    contents: FlyoutItem[];\n    gaps: number[];\n  } {\n    const contents: FlyoutItem[] = [];\n    const gaps: number[] = [];\n    this.permanentlyDisabled.length = 0;\n    const defaultGap = this.horizontalLayout ? this.GAP_X : this.GAP_Y;\n    for (const info of parsedContent) {\n      if ('custom' in info) {\n        const customInfo = info as toolbox.DynamicCategoryInfo;\n        const categoryName = customInfo['custom'];\n        const flyoutDef = this.getDynamicCategoryContents(categoryName);\n        const parsedDynamicContent =\n          toolbox.convertFlyoutDefToJsonArray(flyoutDef);\n        const {contents: dynamicContents, gaps: dynamicGaps} =\n          this.createFlyoutInfo(parsedDynamicContent);\n        contents.push(...dynamicContents);\n        gaps.push(...dynamicGaps);\n      }\n\n      switch (info['kind'].toUpperCase()) {\n        case 'BLOCK': {\n          const blockInfo = info as toolbox.BlockInfo;\n          const block = this.createFlyoutBlock(blockInfo);\n          contents.push({type: FlyoutItemType.BLOCK, block: block});\n          this.addBlockGap(blockInfo, gaps, defaultGap);\n          break;\n        }\n        case 'SEP': {\n          const sepInfo = info as toolbox.SeparatorInfo;\n          this.addSeparatorGap(sepInfo, gaps, defaultGap);\n          break;\n        }\n        case 'LABEL': {\n          const labelInfo = info as toolbox.LabelInfo;\n          // A label is a button with different styling.\n          const label = this.createButton(labelInfo, /** isLabel */ true);\n          contents.push({type: FlyoutItemType.BUTTON, button: label});\n          gaps.push(defaultGap);\n          break;\n        }\n        case 'BUTTON': {\n          const buttonInfo = info as toolbox.ButtonInfo;\n          const button = this.createButton(buttonInfo, /** isLabel */ false);\n          contents.push({type: FlyoutItemType.BUTTON, button: button});\n          gaps.push(defaultGap);\n          break;\n        }\n      }\n    }\n\n    return {contents: contents, gaps: gaps};\n  }\n\n  /**\n   * Gets the flyout definition for the dynamic category.\n   *\n   * @param categoryName The name of the dynamic category.\n   * @returns The definition of the\n   *     flyout in one of its many forms.\n   */\n  private getDynamicCategoryContents(\n    categoryName: string,\n  ): toolbox.FlyoutDefinition {\n    // Look up the correct category generation function and call that to get a\n    // valid XML list.\n    const fnToApply =\n      this.workspace_.targetWorkspace!.getToolboxCategoryCallback(categoryName);\n    if (typeof fnToApply !== 'function') {\n      throw TypeError(\n        \"Couldn't find a callback function when opening\" +\n          ' a toolbox category.',\n      );\n    }\n    return fnToApply(this.workspace_.targetWorkspace!);\n  }\n\n  /**\n   * Creates a flyout button or a flyout label.\n   *\n   * @param btnInfo The object holding information about a button or a label.\n   * @param isLabel True if the button is a label, false otherwise.\n   * @returns The object used to display the button in the\n   *    flyout.\n   */\n  private createButton(\n    btnInfo: toolbox.ButtonOrLabelInfo,\n    isLabel: boolean,\n  ): FlyoutButton {\n    const curButton = new FlyoutButton(\n      this.workspace_,\n      this.targetWorkspace as WorkspaceSvg,\n      btnInfo,\n      isLabel,\n    );\n    return curButton;\n  }\n\n  /**\n   * Create a block from the xml and permanently disable any blocks that were\n   * defined as disabled.\n   *\n   * @param blockInfo The info of the block.\n   * @returns The block created from the blockInfo.\n   */\n  private createFlyoutBlock(blockInfo: toolbox.BlockInfo): BlockSvg {\n    let block;\n    if (blockInfo['blockxml']) {\n      const xml = (\n        typeof blockInfo['blockxml'] === 'string'\n          ? utilsXml.textToDom(blockInfo['blockxml'])\n          : blockInfo['blockxml']\n      ) as Element;\n      block = this.getRecycledBlock(xml.getAttribute('type')!);\n      if (!block) {\n        block = Xml.domToBlockInternal(xml, this.workspace_);\n      }\n    } else {\n      block = this.getRecycledBlock(blockInfo['type']!);\n      if (!block) {\n        if (blockInfo['enabled'] === undefined) {\n          blockInfo['enabled'] =\n            blockInfo['disabled'] !== 'true' && blockInfo['disabled'] !== true;\n        }\n        if (\n          blockInfo['disabledReasons'] === undefined &&\n          blockInfo['enabled'] === false\n        ) {\n          blockInfo['disabledReasons'] = [MANUALLY_DISABLED];\n        }\n        block = blocks.appendInternal(\n          blockInfo as blocks.State,\n          this.workspace_,\n        );\n      }\n    }\n\n    if (!block.isEnabled()) {\n      // Record blocks that were initially disabled.\n      // Do not enable these blocks as a result of capacity filtering.\n      this.permanentlyDisabled.push(block);\n    }\n    return block as BlockSvg;\n  }\n\n  /**\n   * Returns a block from the array of recycled blocks with the given type, or\n   * undefined if one cannot be found.\n   *\n   * @param blockType The type of the block to try to recycle.\n   * @returns The recycled block, or undefined if\n   *     one could not be recycled.\n   */\n  private getRecycledBlock(blockType: string): BlockSvg | undefined {\n    let index = -1;\n    for (let i = 0; i < this.recycledBlocks.length; i++) {\n      if (this.recycledBlocks[i].type === blockType) {\n        index = i;\n        break;\n      }\n    }\n    return index === -1 ? undefined : this.recycledBlocks.splice(index, 1)[0];\n  }\n\n  /**\n   * Adds a gap in the flyout based on block info.\n   *\n   * @param blockInfo Information about a block.\n   * @param gaps The list of gaps between items in the flyout.\n   * @param defaultGap The default gap between one element and the\n   *     next.\n   */\n  private addBlockGap(\n    blockInfo: toolbox.BlockInfo,\n    gaps: number[],\n    defaultGap: number,\n  ) {\n    let gap;\n    if (blockInfo['gap']) {\n      gap = parseInt(String(blockInfo['gap']));\n    } else if (blockInfo['blockxml']) {\n      const xml = (\n        typeof blockInfo['blockxml'] === 'string'\n          ? utilsXml.textToDom(blockInfo['blockxml'])\n          : blockInfo['blockxml']\n      ) as Element;\n      gap = parseInt(xml.getAttribute('gap')!);\n    }\n    gaps.push(!gap || isNaN(gap) ? defaultGap : gap);\n  }\n\n  /**\n   * Add the necessary gap in the flyout for a separator.\n   *\n   * @param sepInfo The object holding\n   *    information about a separator.\n   * @param gaps The list gaps between items in the flyout.\n   * @param defaultGap The default gap between the button and next\n   *     element.\n   */\n  private addSeparatorGap(\n    sepInfo: toolbox.SeparatorInfo,\n    gaps: number[],\n    defaultGap: number,\n  ) {\n    // Change the gap between two toolbox elements.\n    // <sep gap=\"36\"></sep>\n    // The default gap is 24, can be set larger or smaller.\n    // This overwrites the gap attribute on the previous element.\n    const newGap = parseInt(String(sepInfo['gap']));\n    // Ignore gaps before the first block.\n    if (!isNaN(newGap) && gaps.length > 0) {\n      gaps[gaps.length - 1] = newGap;\n    } else {\n      gaps.push(defaultGap);\n    }\n  }\n\n  /**\n   * Delete blocks, mats and buttons from a previous showing of the flyout.\n   */\n  private clearOldBlocks() {\n    // Delete any blocks from a previous showing.\n    const oldBlocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; (block = oldBlocks[i]); i++) {\n      if (this.blockIsRecyclable_(block)) {\n        this.recycleBlock(block);\n      } else {\n        block.dispose(false, false);\n      }\n    }\n    // Delete any mats from a previous showing.\n    for (let j = 0; j < this.mats.length; j++) {\n      const rect = this.mats[j];\n      if (rect) {\n        Tooltip.unbindMouseEvents(rect);\n        dom.removeNode(rect);\n      }\n    }\n    this.mats.length = 0;\n    // Delete any buttons from a previous showing.\n    for (let i = 0, button; (button = this.buttons_[i]); i++) {\n      button.dispose();\n    }\n    this.buttons_.length = 0;\n\n    // Clear potential variables from the previous showing.\n    this.workspace_.getPotentialVariableMap()?.clear();\n  }\n\n  /**\n   * Empties all of the recycled blocks, properly disposing of them.\n   */\n  private emptyRecycledBlocks() {\n    for (let i = 0; i < this.recycledBlocks.length; i++) {\n      this.recycledBlocks[i].dispose();\n    }\n    this.recycledBlocks = [];\n  }\n\n  /**\n   * Returns whether the given block can be recycled or not.\n   *\n   * @param _block The block to check for recyclability.\n   * @returns True if the block can be recycled. False otherwise.\n   */\n  protected blockIsRecyclable_(_block: BlockSvg): boolean {\n    // By default, recycling is disabled.\n    return false;\n  }\n\n  /**\n   * Puts a previously created block into the recycle bin and moves it to the\n   * top of the workspace. Used during large workspace swaps to limit the number\n   * of new DOM elements we need to create.\n   *\n   * @param block The block to recycle.\n   */\n  private recycleBlock(block: BlockSvg) {\n    const xy = block.getRelativeToSurfaceXY();\n    block.moveBy(-xy.x, -xy.y);\n    this.recycledBlocks.push(block);\n  }\n\n  /**\n   * Add listeners to a block that has been added to the flyout.\n   *\n   * @param root The root node of the SVG group the block is in.\n   * @param block The block to add listeners for.\n   * @param rect The invisible rectangle under the block that acts\n   *     as a mat for that block.\n   */\n  protected addBlockListeners_(\n    root: SVGElement,\n    block: BlockSvg,\n    rect: SVGElement,\n  ) {\n    this.listeners.push(\n      browserEvents.conditionalBind(\n        root,\n        'pointerdown',\n        null,\n        this.blockMouseDown(block),\n      ),\n    );\n    this.listeners.push(\n      browserEvents.conditionalBind(\n        rect,\n        'pointerdown',\n        null,\n        this.blockMouseDown(block),\n      ),\n    );\n    this.listeners.push(\n      browserEvents.bind(root, 'pointerenter', block, () => {\n        if (!this.targetWorkspace.isDragging()) {\n          block.addSelect();\n        }\n      }),\n    );\n    this.listeners.push(\n      browserEvents.bind(root, 'pointerleave', block, () => {\n        if (!this.targetWorkspace.isDragging()) {\n          block.removeSelect();\n        }\n      }),\n    );\n    this.listeners.push(\n      browserEvents.bind(rect, 'pointerenter', block, () => {\n        if (!this.targetWorkspace.isDragging()) {\n          block.addSelect();\n        }\n      }),\n    );\n    this.listeners.push(\n      browserEvents.bind(rect, 'pointerleave', block, () => {\n        if (!this.targetWorkspace.isDragging()) {\n          block.removeSelect();\n        }\n      }),\n    );\n  }\n\n  /**\n   * Handle a pointerdown on an SVG block in a non-closing flyout.\n   *\n   * @param block The flyout block to copy.\n   * @returns Function to call when block is clicked.\n   */\n  private blockMouseDown(block: BlockSvg): Function {\n    return (e: PointerEvent) => {\n      const gesture = this.targetWorkspace.getGesture(e);\n      if (gesture) {\n        gesture.setStartBlock(block);\n        gesture.handleFlyoutStart(e, this);\n      }\n    };\n  }\n\n  /**\n   * Pointer down on the flyout background.  Start a vertical scroll drag.\n   *\n   * @param e Pointer down event.\n   */\n  private onMouseDown(e: PointerEvent) {\n    const gesture = this.targetWorkspace.getGesture(e);\n    if (gesture) {\n      gesture.handleFlyoutStart(e, this);\n    }\n  }\n\n  /**\n   * Does this flyout allow you to create a new instance of the given block?\n   * Used for deciding if a block can be \"dragged out of\" the flyout.\n   *\n   * @param block The block to copy from the flyout.\n   * @returns True if you can create a new instance of the block, false\n   *    otherwise.\n   * @internal\n   */\n  isBlockCreatable(block: BlockSvg): boolean {\n    return block.isEnabled();\n  }\n\n  /**\n   * Create a copy of this block on the workspace.\n   *\n   * @param originalBlock The block to copy from the flyout.\n   * @returns The newly created block.\n   * @throws {Error} if something went wrong with deserialization.\n   * @internal\n   */\n  createBlock(originalBlock: BlockSvg): BlockSvg {\n    let newBlock = null;\n    eventUtils.disable();\n    const variablesBeforeCreation = this.targetWorkspace.getAllVariables();\n    this.targetWorkspace.setResizesEnabled(false);\n    try {\n      newBlock = this.placeNewBlock(originalBlock);\n    } finally {\n      eventUtils.enable();\n    }\n\n    // Close the flyout.\n    this.targetWorkspace.hideChaff();\n\n    const newVariables = Variables.getAddedVariables(\n      this.targetWorkspace,\n      variablesBeforeCreation,\n    );\n\n    if (eventUtils.isEnabled()) {\n      eventUtils.setGroup(true);\n      // Fire a VarCreate event for each (if any) new variable created.\n      for (let i = 0; i < newVariables.length; i++) {\n        const thisVariable = newVariables[i];\n        eventUtils.fire(\n          new (eventUtils.get(eventUtils.VAR_CREATE))(thisVariable),\n        );\n      }\n\n      // Block events come after var events, in case they refer to newly created\n      // variables.\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(newBlock));\n    }\n    if (this.autoClose) {\n      this.hide();\n    } else {\n      this.filterForCapacity();\n    }\n    return newBlock;\n  }\n\n  /**\n   * Initialize the given button: move it to the correct location,\n   * add listeners, etc.\n   *\n   * @param button The button to initialize and place.\n   * @param x The x position of the cursor during this layout pass.\n   * @param y The y position of the cursor during this layout pass.\n   */\n  protected initFlyoutButton_(button: FlyoutButton, x: number, y: number) {\n    const buttonSvg = button.createDom();\n    button.moveTo(x, y);\n    button.show();\n    // Clicking on a flyout button or label is a lot like clicking on the\n    // flyout background.\n    this.listeners.push(\n      browserEvents.conditionalBind(\n        buttonSvg,\n        'pointerdown',\n        this,\n        this.onMouseDown,\n      ),\n    );\n\n    this.buttons_.push(button);\n  }\n\n  /**\n   * Create and place a rectangle corresponding to the given block.\n   *\n   * @param block The block to associate the rect to.\n   * @param x The x position of the cursor during this layout pass.\n   * @param y The y position of the cursor during this layout pass.\n   * @param blockHW The height and width of\n   *     the block.\n   * @param index The index into the mats list where this rect should\n   *     be placed.\n   * @returns Newly created SVG element for the rectangle behind\n   *     the block.\n   */\n  protected createRect_(\n    block: BlockSvg,\n    x: number,\n    y: number,\n    blockHW: {height: number; width: number},\n    index: number,\n  ): SVGElement {\n    // Create an invisible rectangle under the block to act as a button.  Just\n    // using the block as a button is poor, since blocks have holes in them.\n    const rect = dom.createSvgElement(Svg.RECT, {\n      'fill-opacity': 0,\n      'x': x,\n      'y': y,\n      'height': blockHW.height,\n      'width': blockHW.width,\n    });\n    (rect as AnyDuringMigration).tooltip = block;\n    Tooltip.bindMouseEvents(rect);\n    // Add the rectangles under the blocks, so that the blocks' tooltips work.\n    this.workspace_.getCanvas().insertBefore(rect, block.getSvgRoot());\n\n    this.rectMap_.set(block, rect);\n    this.mats[index] = rect;\n    return rect;\n  }\n\n  /**\n   * Move a rectangle to sit exactly behind a block, taking into account tabs,\n   * hats, and any other protrusions we invent.\n   *\n   * @param rect The rectangle to move directly behind the block.\n   * @param block The block the rectangle should be behind.\n   */\n  protected moveRectToBlock_(rect: SVGElement, block: BlockSvg) {\n    const blockHW = block.getHeightWidth();\n    rect.setAttribute('width', String(blockHW.width));\n    rect.setAttribute('height', String(blockHW.height));\n\n    const blockXY = block.getRelativeToSurfaceXY();\n    rect.setAttribute('y', String(blockXY.y));\n    rect.setAttribute(\n      'x',\n      String(this.RTL ? blockXY.x - blockHW.width : blockXY.x),\n    );\n  }\n\n  /**\n   * Filter the blocks on the flyout to disable the ones that are above the\n   * capacity limit.  For instance, if the user may only place two more blocks\n   * on the workspace, an \"a + b\" block that has two shadow blocks would be\n   * disabled.\n   */\n  private filterForCapacity() {\n    const blocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; (block = blocks[i]); i++) {\n      if (!this.permanentlyDisabled.includes(block)) {\n        const enable = this.targetWorkspace.isCapacityAvailable(\n          common.getBlockTypeCounts(block),\n        );\n        while (block) {\n          block.setDisabledReason(\n            !enable,\n            WORKSPACE_AT_BLOCK_CAPACITY_DISABLED_REASON,\n          );\n          block = block.getNextBlock();\n        }\n      }\n    }\n  }\n\n  /**\n   * Reflow blocks and their mats.\n   */\n  reflow() {\n    if (this.reflowWrapper) {\n      this.workspace_.removeChangeListener(this.reflowWrapper);\n    }\n    this.reflowInternal_();\n    if (this.reflowWrapper) {\n      this.workspace_.addChangeListener(this.reflowWrapper);\n    }\n  }\n\n  /**\n   * @returns True if this flyout may be scrolled with a scrollbar or\n   *     by dragging.\n   * @internal\n   */\n  isScrollable(): boolean {\n    return this.workspace_.scrollbar\n      ? this.workspace_.scrollbar.isVisible()\n      : false;\n  }\n\n  /**\n   * Copy a block from the flyout to the workspace and position it correctly.\n   *\n   * @param oldBlock The flyout block to copy.\n   * @returns The new block in the main workspace.\n   */\n  private placeNewBlock(oldBlock: BlockSvg): BlockSvg {\n    const targetWorkspace = this.targetWorkspace;\n    const svgRootOld = oldBlock.getSvgRoot();\n    if (!svgRootOld) {\n      throw Error('oldBlock is not rendered');\n    }\n\n    // Clone the block.\n    const json = this.serializeBlock(oldBlock);\n    // Normally this resizes leading to weird jumps. Save it for terminateDrag.\n    targetWorkspace.setResizesEnabled(false);\n    const block = blocks.append(json, targetWorkspace) as BlockSvg;\n\n    this.positionNewBlock(oldBlock, block);\n\n    return block;\n  }\n\n  /**\n   * Serialize a block to JSON.\n   *\n   * @param block The block to serialize.\n   * @returns A serialized representation of the block.\n   */\n  protected serializeBlock(block: BlockSvg): blocks.State {\n    return blocks.save(block) as blocks.State;\n  }\n\n  /**\n   * Positions a block on the target workspace.\n   *\n   * @param oldBlock The flyout block being copied.\n   * @param block The block to posiiton.\n   */\n  private positionNewBlock(oldBlock: BlockSvg, block: BlockSvg) {\n    const targetWorkspace = this.targetWorkspace;\n\n    // The offset in pixels between the main workspace's origin and the upper\n    // left corner of the injection div.\n    const mainOffsetPixels = targetWorkspace.getOriginOffsetInPixels();\n\n    // The offset in pixels between the flyout workspace's origin and the upper\n    // left corner of the injection div.\n    const flyoutOffsetPixels = this.workspace_.getOriginOffsetInPixels();\n\n    // The position of the old block in flyout workspace coordinates.\n    const oldBlockPos = oldBlock.getRelativeToSurfaceXY();\n    // The position of the old block in pixels relative to the flyout\n    // workspace's origin.\n    oldBlockPos.scale(this.workspace_.scale);\n\n    // The position of the old block in pixels relative to the upper left corner\n    // of the injection div.\n    const oldBlockOffsetPixels = Coordinate.sum(\n      flyoutOffsetPixels,\n      oldBlockPos,\n    );\n\n    // The position of the old block in pixels relative to the origin of the\n    // main workspace.\n    const finalOffset = Coordinate.difference(\n      oldBlockOffsetPixels,\n      mainOffsetPixels,\n    );\n    // The position of the old block in main workspace coordinates.\n    finalOffset.scale(1 / targetWorkspace.scale);\n\n    // No 'reason' provided since events are disabled.\n    block.moveTo(new Coordinate(finalOffset.x, finalOffset.y));\n  }\n}\n\n/**\n * A flyout content item.\n */\nexport interface FlyoutItem {\n  type: FlyoutItemType;\n  button?: FlyoutButton | undefined;\n  block?: BlockSvg | undefined;\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Layout code for a vertical variant of the flyout.\n *\n * @class\n */\n// Former goog.module ID: Blockly.VerticalFlyout\n\nimport * as browserEvents from './browser_events.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {Flyout, FlyoutItem} from './flyout_base.js';\nimport type {FlyoutButton} from './flyout_button.js';\nimport type {Options} from './options.js';\nimport * as registry from './registry.js';\nimport {Scrollbar} from './scrollbar.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport {Rect} from './utils/rect.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as WidgetDiv from './widgetdiv.js';\n\n/**\n * Class for a flyout.\n */\nexport class VerticalFlyout extends Flyout {\n  /** The name of the vertical flyout in the registry. */\n  static registryName = 'verticalFlyout';\n\n  /** @param workspaceOptions Dictionary of options for the workspace. */\n  constructor(workspaceOptions: Options) {\n    super(workspaceOptions);\n  }\n\n  /**\n   * Sets the translation of the flyout to match the scrollbars.\n   *\n   * @param xyRatio Contains a y property which is a float between 0 and 1\n   *     specifying the degree of scrolling and a similar x property.\n   */\n  protected override setMetrics_(xyRatio: {x: number; y: number}) {\n    if (!this.isVisible()) {\n      return;\n    }\n    const metricsManager = this.workspace_.getMetricsManager();\n    const scrollMetrics = metricsManager.getScrollMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n\n    if (typeof xyRatio.y === 'number') {\n      this.workspace_.scrollY = -(\n        scrollMetrics.top +\n        (scrollMetrics.height - viewMetrics.height) * xyRatio.y\n      );\n    }\n    this.workspace_.translate(\n      this.workspace_.scrollX + absoluteMetrics.left,\n      this.workspace_.scrollY + absoluteMetrics.top,\n    );\n  }\n\n  /**\n   * Calculates the x coordinate for the flyout position.\n   *\n   * @returns X coordinate.\n   */\n  override getX(): number {\n    if (!this.isVisible()) {\n      return 0;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const toolboxMetrics = metricsManager.getToolboxMetrics();\n    let x = 0;\n\n    // If this flyout is not the trashcan flyout (e.g. toolbox or mutator).\n    // Trashcan flyout is opposite the main flyout.\n    if (this.targetWorkspace!.toolboxPosition === this.toolboxPosition_) {\n      // If there is a category toolbox.\n      // Simple (flyout-only) toolbox.\n      if (this.targetWorkspace!.getToolbox()) {\n        if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n          x = toolboxMetrics.width;\n        } else {\n          x = viewMetrics.width - this.width_;\n        }\n      } else {\n        if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n          x = 0;\n        } else {\n          // The simple flyout does not cover the workspace.\n          x = viewMetrics.width;\n        }\n      }\n    } else {\n      if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n        x = 0;\n      } else {\n        // Because the anchor point of the flyout is on the left, but we want\n        // to align the right edge of the flyout with the right edge of the\n        // blocklyDiv, we calculate the full width of the div minus the width\n        // of the flyout.\n        x = viewMetrics.width + absoluteMetrics.left - this.width_;\n      }\n    }\n\n    return x;\n  }\n\n  /**\n   * Calculates the y coordinate for the flyout position.\n   *\n   * @returns Y coordinate.\n   */\n  override getY(): number {\n    // Y is always 0 since this is a vertical flyout.\n    return 0;\n  }\n\n  /** Move the flyout to the edge of the workspace. */\n  override position() {\n    if (!this.isVisible() || !this.targetWorkspace!.isVisible()) {\n      return;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const targetWorkspaceViewMetrics = metricsManager.getViewMetrics();\n    this.height_ = targetWorkspaceViewMetrics.height;\n\n    const edgeWidth = this.width_ - this.CORNER_RADIUS;\n    const edgeHeight =\n      targetWorkspaceViewMetrics.height - 2 * this.CORNER_RADIUS;\n    this.setBackgroundPath(edgeWidth, edgeHeight);\n\n    const x = this.getX();\n    const y = this.getY();\n\n    this.positionAt_(this.width_, this.height_, x, y);\n  }\n\n  /**\n   * Create and set the path for the visible boundaries of the flyout.\n   *\n   * @param width The width of the flyout, not including the rounded corners.\n   * @param height The height of the flyout, not including rounded corners.\n   */\n  private setBackgroundPath(width: number, height: number) {\n    const atRight = this.toolboxPosition_ === toolbox.Position.RIGHT;\n    const totalWidth = width + this.CORNER_RADIUS;\n\n    // Decide whether to start on the left or right.\n    const path: Array<string | number> = [\n      'M ' + (atRight ? totalWidth : 0) + ',0',\n    ];\n    // Top.\n    path.push('h', atRight ? -width : width);\n    // Rounded corner.\n    path.push(\n      'a',\n      this.CORNER_RADIUS,\n      this.CORNER_RADIUS,\n      0,\n      0,\n      atRight ? 0 : 1,\n      atRight ? -this.CORNER_RADIUS : this.CORNER_RADIUS,\n      this.CORNER_RADIUS,\n    );\n    // Side closest to workspace.\n    path.push('v', Math.max(0, height));\n    // Rounded corner.\n    path.push(\n      'a',\n      this.CORNER_RADIUS,\n      this.CORNER_RADIUS,\n      0,\n      0,\n      atRight ? 0 : 1,\n      atRight ? this.CORNER_RADIUS : -this.CORNER_RADIUS,\n      this.CORNER_RADIUS,\n    );\n    // Bottom.\n    path.push('h', atRight ? width : -width);\n    path.push('z');\n    this.svgBackground_!.setAttribute('d', path.join(' '));\n  }\n\n  /** Scroll the flyout to the top. */\n  override scrollToStart() {\n    this.workspace_.scrollbar?.setY(0);\n  }\n\n  /**\n   * Scroll the flyout.\n   *\n   * @param e Mouse wheel scroll event.\n   */\n  protected override wheel_(e: WheelEvent) {\n    const scrollDelta = browserEvents.getScrollDeltaPixels(e);\n\n    if (scrollDelta.y) {\n      const metricsManager = this.workspace_.getMetricsManager();\n      const scrollMetrics = metricsManager.getScrollMetrics();\n      const viewMetrics = metricsManager.getViewMetrics();\n      const pos = viewMetrics.top - scrollMetrics.top + scrollDelta.y;\n\n      this.workspace_.scrollbar?.setY(pos);\n      // When the flyout moves from a wheel event, hide WidgetDiv and\n      // dropDownDiv.\n      WidgetDiv.hideIfOwnerIsInWorkspace(this.workspace_);\n      dropDownDiv.hideWithoutAnimation();\n    }\n    // Don't scroll the page.\n    e.preventDefault();\n    // Don't propagate mousewheel event (zooming).\n    e.stopPropagation();\n  }\n\n  /**\n   * Lay out the blocks in the flyout.\n   *\n   * @param contents The blocks and buttons to lay out.\n   * @param gaps The visible gaps between blocks.\n   */\n  protected override layout_(contents: FlyoutItem[], gaps: number[]) {\n    this.workspace_.scale = this.targetWorkspace!.scale;\n    const margin = this.MARGIN;\n    const cursorX = this.RTL ? margin : margin + this.tabWidth_;\n    let cursorY = margin;\n\n    for (let i = 0, item; (item = contents[i]); i++) {\n      if (item.type === 'block') {\n        const block = item.block;\n        if (!block) {\n          continue;\n        }\n        const allBlocks = block.getDescendants(false);\n        for (let j = 0, child; (child = allBlocks[j]); j++) {\n          // Mark blocks as being inside a flyout.  This is used to detect and\n          // prevent the closure of the flyout if the user right-clicks on such\n          // a block.\n          child.isInFlyout = true;\n        }\n        const root = block.getSvgRoot();\n        const blockHW = block.getHeightWidth();\n        const moveX = block.outputConnection\n          ? cursorX - this.tabWidth_\n          : cursorX;\n        block.moveBy(moveX, cursorY);\n\n        const rect = this.createRect_(\n          block,\n          this.RTL ? moveX - blockHW.width : moveX,\n          cursorY,\n          blockHW,\n          i,\n        );\n\n        this.addBlockListeners_(root, block, rect);\n\n        cursorY += blockHW.height + gaps[i];\n      } else if (item.type === 'button') {\n        const button = item.button as FlyoutButton;\n        this.initFlyoutButton_(button, cursorX, cursorY);\n        cursorY += button.height + gaps[i];\n      }\n    }\n  }\n\n  /**\n   * Determine if a drag delta is toward the workspace, based on the position\n   * and orientation of the flyout. This is used in determineDragIntention_ to\n   * determine if a new block should be created or if the flyout should scroll.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   * @returns True if the drag is toward the workspace.\n   */\n  override isDragTowardWorkspace(currentDragDeltaXY: Coordinate): boolean {\n    const dx = currentDragDeltaXY.x;\n    const dy = currentDragDeltaXY.y;\n    // Direction goes from -180 to 180, with 0 toward the right and 90 on top.\n    const dragDirection = (Math.atan2(dy, dx) / Math.PI) * 180;\n\n    const range = this.dragAngleRange_;\n    // Check for left or right dragging.\n    if (\n      (dragDirection < range && dragDirection > -range) ||\n      dragDirection < -180 + range ||\n      dragDirection > 180 - range\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect | null {\n    if (!this.svgGroup_ || this.autoClose || !this.isVisible()) {\n      // The bounding rectangle won't compute correctly if the flyout is closed\n      // and auto-close flyouts aren't valid drag targets (or delete areas).\n      return null;\n    }\n\n    const flyoutRect = this.svgGroup_.getBoundingClientRect();\n    // BIG_NUM is offscreen padding so that blocks dragged beyond the shown\n    // flyout area are still deleted.  Must be larger than the largest screen\n    // size, but be smaller than half Number.MAX_SAFE_INTEGER (not available on\n    // IE).\n    const BIG_NUM = 1000000000;\n    const left = flyoutRect.left;\n\n    if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n      const width = flyoutRect.width;\n      return new Rect(-BIG_NUM, BIG_NUM, -BIG_NUM, left + width);\n    } else {\n      // Right\n      return new Rect(-BIG_NUM, BIG_NUM, left, BIG_NUM);\n    }\n  }\n\n  /**\n   * Compute width of flyout.  toolbox.Position mat under each block.\n   * For RTL: Lay out the blocks and buttons to be right-aligned.\n   */\n  protected override reflowInternal_() {\n    this.workspace_.scale = this.getFlyoutScale();\n    let flyoutWidth = 0;\n    const blocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; (block = blocks[i]); i++) {\n      let width = block.getHeightWidth().width;\n      if (block.outputConnection) {\n        width -= this.tabWidth_;\n      }\n      flyoutWidth = Math.max(flyoutWidth, width);\n    }\n    for (let i = 0, button; (button = this.buttons_[i]); i++) {\n      flyoutWidth = Math.max(flyoutWidth, button.width);\n    }\n    flyoutWidth += this.MARGIN * 1.5 + this.tabWidth_;\n    flyoutWidth *= this.workspace_.scale;\n    flyoutWidth += Scrollbar.scrollbarThickness;\n\n    if (this.width_ !== flyoutWidth) {\n      for (let i = 0, block; (block = blocks[i]); i++) {\n        if (this.RTL) {\n          // With the flyoutWidth known, right-align the blocks.\n          const oldX = block.getRelativeToSurfaceXY().x;\n          let newX = flyoutWidth / this.workspace_.scale - this.MARGIN;\n          if (!block.outputConnection) {\n            newX -= this.tabWidth_;\n          }\n          block.moveBy(newX - oldX, 0);\n        }\n        if (this.rectMap_.has(block)) {\n          this.moveRectToBlock_(this.rectMap_.get(block)!, block);\n        }\n      }\n      if (this.RTL) {\n        // With the flyoutWidth known, right-align the buttons.\n        for (let i = 0, button; (button = this.buttons_[i]); i++) {\n          const y = button.getPosition().y;\n          const x =\n            flyoutWidth / this.workspace_.scale -\n            button.width -\n            this.MARGIN -\n            this.tabWidth_;\n          button.moveTo(x, y);\n        }\n      }\n\n      // TODO(#7689): Remove this.\n      // Workspace with no scrollbars where this is permanently\n      // open on the left.\n      // If scrollbars exist they properly update the metrics.\n      if (\n        !this.targetWorkspace.scrollbar &&\n        !this.autoClose &&\n        this.targetWorkspace.getFlyout() === this &&\n        this.toolboxPosition_ === toolbox.Position.LEFT\n      ) {\n        this.targetWorkspace.translate(\n          this.targetWorkspace.scrollX + flyoutWidth,\n          this.targetWorkspace.scrollY,\n        );\n      }\n\n      this.width_ = flyoutWidth;\n      this.position();\n      this.targetWorkspace.resizeContents();\n      this.targetWorkspace.recordDragTargets();\n    }\n  }\n}\n\nregistry.register(\n  registry.Type.FLYOUTS_VERTICAL_TOOLBOX,\n  registry.DEFAULT,\n  VerticalFlyout,\n);\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Horizontal flyout tray containing blocks which may be created.\n *\n * @class\n */\n// Former goog.module ID: Blockly.HorizontalFlyout\n\nimport * as browserEvents from './browser_events.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {Flyout, FlyoutItem} from './flyout_base.js';\nimport type {FlyoutButton} from './flyout_button.js';\nimport type {Options} from './options.js';\nimport * as registry from './registry.js';\nimport {Scrollbar} from './scrollbar.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport {Rect} from './utils/rect.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as WidgetDiv from './widgetdiv.js';\n\n/**\n * Class for a flyout.\n */\nexport class HorizontalFlyout extends Flyout {\n  override horizontalLayout = true;\n\n  /** @param workspaceOptions Dictionary of options for the workspace. */\n  constructor(workspaceOptions: Options) {\n    super(workspaceOptions);\n  }\n\n  /**\n   * Sets the translation of the flyout to match the scrollbars.\n   *\n   * @param xyRatio Contains a y property which is a float between 0 and 1\n   *     specifying the degree of scrolling and a similar x property.\n   */\n  protected override setMetrics_(xyRatio: {x: number; y: number}) {\n    if (!this.isVisible()) {\n      return;\n    }\n\n    const metricsManager = this.workspace_.getMetricsManager();\n    const scrollMetrics = metricsManager.getScrollMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n\n    if (typeof xyRatio.x === 'number') {\n      this.workspace_.scrollX = -(\n        scrollMetrics.left +\n        (scrollMetrics.width - viewMetrics.width) * xyRatio.x\n      );\n    }\n\n    this.workspace_.translate(\n      this.workspace_.scrollX + absoluteMetrics.left,\n      this.workspace_.scrollY + absoluteMetrics.top,\n    );\n  }\n\n  /**\n   * Calculates the x coordinate for the flyout position.\n   *\n   * @returns X coordinate.\n   */\n  override getX(): number {\n    // X is always 0 since this is a horizontal flyout.\n    return 0;\n  }\n\n  /**\n   * Calculates the y coordinate for the flyout position.\n   *\n   * @returns Y coordinate.\n   */\n  override getY(): number {\n    if (!this.isVisible()) {\n      return 0;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const toolboxMetrics = metricsManager.getToolboxMetrics();\n\n    let y = 0;\n    const atTop = this.toolboxPosition_ === toolbox.Position.TOP;\n    // If this flyout is not the trashcan flyout (e.g. toolbox or mutator).\n    // Trashcan flyout is opposite the main flyout.\n    if (this.targetWorkspace!.toolboxPosition === this.toolboxPosition_) {\n      // If there is a category toolbox.\n      // Simple (flyout-only) toolbox.\n      if (this.targetWorkspace!.getToolbox()) {\n        if (atTop) {\n          y = toolboxMetrics.height;\n        } else {\n          y = viewMetrics.height - this.height_;\n        }\n      } else {\n        if (atTop) {\n          y = 0;\n        } else {\n          // The simple flyout does not cover the workspace.\n          y = viewMetrics.height;\n        }\n      }\n    } else {\n      if (atTop) {\n        y = 0;\n      } else {\n        // Because the anchor point of the flyout is on the top, but we want\n        // to align the bottom edge of the flyout with the bottom edge of the\n        // blocklyDiv, we calculate the full height of the div minus the height\n        // of the flyout.\n        y = viewMetrics.height + absoluteMetrics.top - this.height_;\n      }\n    }\n\n    return y;\n  }\n\n  /** Move the flyout to the edge of the workspace. */\n  override position() {\n    if (!this.isVisible() || !this.targetWorkspace!.isVisible()) {\n      return;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const targetWorkspaceViewMetrics = metricsManager.getViewMetrics();\n    this.width_ = targetWorkspaceViewMetrics.width;\n\n    const edgeWidth = targetWorkspaceViewMetrics.width - 2 * this.CORNER_RADIUS;\n    const edgeHeight = this.height_ - this.CORNER_RADIUS;\n    this.setBackgroundPath(edgeWidth, edgeHeight);\n\n    const x = this.getX();\n    const y = this.getY();\n\n    this.positionAt_(this.width_, this.height_, x, y);\n  }\n\n  /**\n   * Create and set the path for the visible boundaries of the flyout.\n   *\n   * @param width The width of the flyout, not including the rounded corners.\n   * @param height The height of the flyout, not including rounded corners.\n   */\n  private setBackgroundPath(width: number, height: number) {\n    const atTop = this.toolboxPosition_ === toolbox.Position.TOP;\n    // Start at top left.\n    const path: (string | number)[] = [\n      'M 0,' + (atTop ? 0 : this.CORNER_RADIUS),\n    ];\n\n    if (atTop) {\n      // Top.\n      path.push('h', width + 2 * this.CORNER_RADIUS);\n      // Right.\n      path.push('v', height);\n      // Bottom.\n      path.push(\n        'a',\n        this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n        0,\n        0,\n        1,\n        -this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n      );\n      path.push('h', -width);\n      // Left.\n      path.push(\n        'a',\n        this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n        0,\n        0,\n        1,\n        -this.CORNER_RADIUS,\n        -this.CORNER_RADIUS,\n      );\n      path.push('z');\n    } else {\n      // Top.\n      path.push(\n        'a',\n        this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n        0,\n        0,\n        1,\n        this.CORNER_RADIUS,\n        -this.CORNER_RADIUS,\n      );\n      path.push('h', width);\n      // Right.\n      path.push(\n        'a',\n        this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n        0,\n        0,\n        1,\n        this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n      );\n      path.push('v', height);\n      // Bottom.\n      path.push('h', -width - 2 * this.CORNER_RADIUS);\n      // Left.\n      path.push('z');\n    }\n    this.svgBackground_!.setAttribute('d', path.join(' '));\n  }\n\n  /** Scroll the flyout to the top. */\n  override scrollToStart() {\n    this.workspace_.scrollbar?.setX(this.RTL ? Infinity : 0);\n  }\n\n  /**\n   * Scroll the flyout.\n   *\n   * @param e Mouse wheel scroll event.\n   */\n  protected override wheel_(e: WheelEvent) {\n    const scrollDelta = browserEvents.getScrollDeltaPixels(e);\n    const delta = scrollDelta.x || scrollDelta.y;\n\n    if (delta) {\n      const metricsManager = this.workspace_.getMetricsManager();\n      const scrollMetrics = metricsManager.getScrollMetrics();\n      const viewMetrics = metricsManager.getViewMetrics();\n\n      const pos = viewMetrics.left - scrollMetrics.left + delta;\n      this.workspace_.scrollbar?.setX(pos);\n      // When the flyout moves from a wheel event, hide WidgetDiv and\n      // dropDownDiv.\n      WidgetDiv.hideIfOwnerIsInWorkspace(this.workspace_);\n      dropDownDiv.hideWithoutAnimation();\n    }\n    // Don't scroll the page.\n    e.preventDefault();\n    // Don't propagate mousewheel event (zooming).\n    e.stopPropagation();\n  }\n\n  /**\n   * Lay out the blocks in the flyout.\n   *\n   * @param contents The blocks and buttons to lay out.\n   * @param gaps The visible gaps between blocks.\n   */\n  protected override layout_(contents: FlyoutItem[], gaps: number[]) {\n    this.workspace_.scale = this.targetWorkspace!.scale;\n    const margin = this.MARGIN;\n    let cursorX = margin + this.tabWidth_;\n    const cursorY = margin;\n    if (this.RTL) {\n      contents = contents.reverse();\n    }\n\n    for (let i = 0, item; (item = contents[i]); i++) {\n      if (item.type === 'block') {\n        const block = item.block;\n\n        if (block === undefined || block === null) {\n          continue;\n        }\n\n        const allBlocks = block.getDescendants(false);\n\n        for (let j = 0, child; (child = allBlocks[j]); j++) {\n          // Mark blocks as being inside a flyout.  This is used to detect and\n          // prevent the closure of the flyout if the user right-clicks on such\n          // a block.\n          child.isInFlyout = true;\n        }\n        const root = block.getSvgRoot();\n        const blockHW = block.getHeightWidth();\n        // Figure out where to place the block.\n        const tab = block.outputConnection ? this.tabWidth_ : 0;\n        let moveX;\n        if (this.RTL) {\n          moveX = cursorX + blockHW.width;\n        } else {\n          moveX = cursorX - tab;\n        }\n        block.moveBy(moveX, cursorY);\n\n        const rect = this.createRect_(block, moveX, cursorY, blockHW, i);\n        cursorX += blockHW.width + gaps[i];\n\n        this.addBlockListeners_(root, block, rect);\n      } else if (item.type === 'button') {\n        const button = item.button as FlyoutButton;\n        this.initFlyoutButton_(button, cursorX, cursorY);\n        cursorX += button.width + gaps[i];\n      }\n    }\n  }\n\n  /**\n   * Determine if a drag delta is toward the workspace, based on the position\n   * and orientation of the flyout. This is used in determineDragIntention_ to\n   * determine if a new block should be created or if the flyout should scroll.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   * @returns True if the drag is toward the workspace.\n   */\n  override isDragTowardWorkspace(currentDragDeltaXY: Coordinate): boolean {\n    const dx = currentDragDeltaXY.x;\n    const dy = currentDragDeltaXY.y;\n    // Direction goes from -180 to 180, with 0 toward the right and 90 on top.\n    const dragDirection = (Math.atan2(dy, dx) / Math.PI) * 180;\n\n    const range = this.dragAngleRange_;\n    // Check for up or down dragging.\n    if (\n      (dragDirection < 90 + range && dragDirection > 90 - range) ||\n      (dragDirection > -90 - range && dragDirection < -90 + range)\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect | null {\n    if (!this.svgGroup_ || this.autoClose || !this.isVisible()) {\n      // The bounding rectangle won't compute correctly if the flyout is closed\n      // and auto-close flyouts aren't valid drag targets (or delete areas).\n      return null;\n    }\n\n    const flyoutRect = this.svgGroup_.getBoundingClientRect();\n    // BIG_NUM is offscreen padding so that blocks dragged beyond the shown\n    // flyout area are still deleted.  Must be larger than the largest screen\n    // size, but be smaller than half Number.MAX_SAFE_INTEGER (not available on\n    // IE).\n    const BIG_NUM = 1000000000;\n    const top = flyoutRect.top;\n\n    if (this.toolboxPosition_ === toolbox.Position.TOP) {\n      const height = flyoutRect.height;\n      return new Rect(-BIG_NUM, top + height, -BIG_NUM, BIG_NUM);\n    } else {\n      // Bottom.\n      return new Rect(top, BIG_NUM, -BIG_NUM, BIG_NUM);\n    }\n  }\n\n  /**\n   * Compute height of flyout.  toolbox.Position mat under each block.\n   * For RTL: Lay out the blocks right-aligned.\n   */\n  protected override reflowInternal_() {\n    this.workspace_.scale = this.getFlyoutScale();\n    let flyoutHeight = 0;\n    const blocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; (block = blocks[i]); i++) {\n      flyoutHeight = Math.max(flyoutHeight, block.getHeightWidth().height);\n    }\n    const buttons = this.buttons_;\n    for (let i = 0, button; (button = buttons[i]); i++) {\n      flyoutHeight = Math.max(flyoutHeight, button.height);\n    }\n    flyoutHeight += this.MARGIN * 1.5;\n    flyoutHeight *= this.workspace_.scale;\n    flyoutHeight += Scrollbar.scrollbarThickness;\n\n    if (this.height_ !== flyoutHeight) {\n      for (let i = 0, block; (block = blocks[i]); i++) {\n        if (this.rectMap_.has(block)) {\n          this.moveRectToBlock_(this.rectMap_.get(block)!, block);\n        }\n      }\n\n      // TODO(#7689): Remove this.\n      // Workspace with no scrollbars where this is permanently open on the top.\n      // If scrollbars exist they properly update the metrics.\n      if (\n        !this.targetWorkspace.scrollbar &&\n        !this.autoClose &&\n        this.targetWorkspace.getFlyout() === this &&\n        this.toolboxPosition_ === toolbox.Position.TOP\n      ) {\n        this.targetWorkspace.translate(\n          this.targetWorkspace.scrollX,\n          this.targetWorkspace.scrollY + flyoutHeight,\n        );\n      }\n\n      this.height_ = flyoutHeight;\n      this.position();\n      this.targetWorkspace.resizeContents();\n      this.targetWorkspace.recordDragTargets();\n    }\n  }\n}\n\nregistry.register(\n  registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,\n  registry.DEFAULT,\n  HorizontalFlyout,\n);\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Variable input field.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldVariable\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport type {Block} from './block.js';\nimport {Field, FieldConfig, UnattachedFieldError} from './field.js';\nimport {\n  FieldDropdown,\n  FieldDropdownValidator,\n  MenuGenerator,\n  MenuOption,\n} from './field_dropdown.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as internalConstants from './internal_constants.js';\nimport type {Menu} from './menu.js';\nimport type {MenuItem} from './menuitem.js';\nimport {Msg} from './msg.js';\nimport * as parsing from './utils/parsing.js';\nimport {Size} from './utils/size.js';\nimport {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport * as Xml from './xml.js';\n\n/**\n * Class for a variable's dropdown field.\n */\nexport class FieldVariable extends FieldDropdown {\n  protected override menuGenerator_: MenuGenerator | undefined;\n  defaultVariableName: string;\n\n  /** The type of the default variable for this field. */\n  private defaultType = '';\n\n  /**\n   * All of the types of variables that will be available in this field's\n   * dropdown.\n   */\n  variableTypes: string[] | null = [];\n  protected override size_: Size;\n\n  /** The variable model associated with this field. */\n  private variable: VariableModel | null = null;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /**\n   * @param varName The default name for the variable.\n   *     If null, a unique variable name will be generated.\n   *     Also accepts Field.SKIP_SETUP if you wish to skip setup (only used by\n   * subclasses that want to handle configuration and setting the field value\n   * after their own constructors have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a variable ID  & returns a validated variable\n   *     ID, or null to abort the change.\n   * @param variableTypes A list of the types of variables to include in the\n   *     dropdown. Will only be used if config is not provided.\n   * @param defaultType The type of variable to create if this field's value\n   *     is not explicitly set.  Defaults to ''. Will only be used if config\n   *     is not provided.\n   * @param config A map of options used to configure the field.\n   *    See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/variable#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    varName: string | null | typeof Field.SKIP_SETUP,\n    validator?: FieldVariableValidator,\n    variableTypes?: string[],\n    defaultType?: string,\n    config?: FieldVariableConfig,\n  ) {\n    super(Field.SKIP_SETUP);\n\n    /**\n     * An array of options for a dropdown list,\n     * or a function which generates these options.\n     */\n    this.menuGenerator_ = FieldVariable.dropdownCreate as MenuGenerator;\n\n    /**\n     * The initial variable name passed to this field's constructor, or an\n     * empty string if a name wasn't provided. Used to create the initial\n     * variable.\n     */\n    this.defaultVariableName = typeof varName === 'string' ? varName : '';\n\n    /** The size of the area rendered by the field. */\n    this.size_ = new Size(0, 0);\n\n    if (varName === Field.SKIP_SETUP) return;\n\n    if (config) {\n      this.configure_(config);\n    } else {\n      this.setTypes(variableTypes, defaultType);\n    }\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldVariableConfig) {\n    super.configure_(config);\n    this.setTypes(config.variableTypes, config.defaultType);\n  }\n\n  /**\n   * Initialize the model for this field if it has not already been initialized.\n   * If the value has not been set to a variable by the first render, we make up\n   * a variable rather than let the value be invalid.\n   */\n  override initModel() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    if (this.variable) {\n      return; // Initialization already happened.\n    }\n    const variable = Variables.getOrCreateVariablePackage(\n      block.workspace,\n      null,\n      this.defaultVariableName,\n      this.defaultType,\n    );\n    // Don't call setValue because we don't want to cause a rerender.\n    this.doValueUpdate_(variable.getId());\n  }\n\n  override shouldAddBorderRect_() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    return (\n      super.shouldAddBorderRect_() &&\n      (!this.getConstants()!.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW ||\n        block.type !== 'variables_get')\n    );\n  }\n\n  /**\n   * Initialize this field based on the given XML.\n   *\n   * @param fieldElement The element containing information about the variable\n   *     field's state.\n   */\n  override fromXml(fieldElement: Element) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const id = fieldElement.getAttribute('id');\n    const variableName = fieldElement.textContent;\n    // 'variabletype' should be lowercase, but until July 2019 it was sometimes\n    // recorded as 'variableType'.  Thus we need to check for both.\n    const variableType =\n      fieldElement.getAttribute('variabletype') ||\n      fieldElement.getAttribute('variableType') ||\n      '';\n\n    // AnyDuringMigration because:  Argument of type 'string | null' is not\n    // assignable to parameter of type 'string | undefined'.\n    const variable = Variables.getOrCreateVariablePackage(\n      block.workspace,\n      id,\n      variableName as AnyDuringMigration,\n      variableType,\n    );\n\n    // This should never happen :)\n    if (variableType !== null && variableType !== variable.type) {\n      throw Error(\n        \"Serialized variable type with id '\" +\n          variable.getId() +\n          \"' had type \" +\n          variable.type +\n          ', and ' +\n          'does not match variable field that references it: ' +\n          Xml.domToText(fieldElement) +\n          '.',\n      );\n    }\n\n    this.setValue(variable.getId());\n  }\n\n  /**\n   * Serialize this field to XML.\n   *\n   * @param fieldElement The element to populate with info about the field's\n   *     state.\n   * @returns The element containing info about the field's state.\n   */\n  override toXml(fieldElement: Element): Element {\n    // Make sure the variable is initialized.\n    this.initModel();\n\n    fieldElement.id = this.variable!.getId();\n    fieldElement.textContent = this.variable!.name;\n    if (this.variable!.type) {\n      fieldElement.setAttribute('variabletype', this.variable!.type);\n    }\n    return fieldElement;\n  }\n\n  /**\n   * Saves this field's value.\n   *\n   * @param doFullSerialization If true, the variable field will serialize the\n   *     full state of the field being referenced (ie ID, name, and type) rather\n   *     than just a reference to it (ie ID).\n   * @returns The state of the variable field.\n   * @internal\n   */\n  override saveState(doFullSerialization?: boolean): AnyDuringMigration {\n    const legacyState = this.saveLegacyState(FieldVariable);\n    if (legacyState !== null) {\n      return legacyState;\n    }\n    // Make sure the variable is initialized.\n    this.initModel();\n    const state = {'id': this.variable!.getId()};\n    if (doFullSerialization) {\n      (state as AnyDuringMigration)['name'] = this.variable!.name;\n      (state as AnyDuringMigration)['type'] = this.variable!.type;\n    }\n    return state;\n  }\n\n  /**\n   * Sets the field's value based on the given state.\n   *\n   * @param state The state of the variable to assign to this variable field.\n   * @internal\n   */\n  override loadState(state: AnyDuringMigration) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    if (this.loadLegacyState(FieldVariable, state)) {\n      return;\n    }\n    // This is necessary so that blocks in the flyout can have custom var names.\n    const variable = Variables.getOrCreateVariablePackage(\n      block.workspace,\n      state['id'] || null,\n      state['name'],\n      state['type'] || '',\n    );\n    this.setValue(variable.getId());\n  }\n\n  /**\n   * Attach this field to a block.\n   *\n   * @param block The block containing this field.\n   */\n  override setSourceBlock(block: Block) {\n    if (block.isShadow()) {\n      throw Error('Variable fields are not allowed to exist on shadow blocks.');\n    }\n    super.setSourceBlock(block);\n  }\n\n  /**\n   * Get the variable's ID.\n   *\n   * @returns Current variable's ID.\n   */\n  override getValue(): string | null {\n    return this.variable ? this.variable.getId() : null;\n  }\n\n  /**\n   * Get the text from this field, which is the selected variable's name.\n   *\n   * @returns The selected variable's name, or the empty string if no variable\n   *     is selected.\n   */\n  override getText(): string {\n    return this.variable ? this.variable.name : '';\n  }\n\n  /**\n   * Get the variable model for the selected variable.\n   * Not guaranteed to be in the variable map on the workspace (e.g. if accessed\n   * after the variable has been deleted).\n   *\n   * @returns The selected variable, or null if none was selected.\n   * @internal\n   */\n  getVariable(): VariableModel | null {\n    return this.variable;\n  }\n\n  /**\n   * Gets the validation function for this field, or null if not set.\n   * Returns null if the variable is not set, because validators should not\n   * run on the initial setValue call, because the field won't be attached to\n   * a block and workspace at that point.\n   *\n   * @returns Validation function, or null.\n   */\n  override getValidator(): FieldVariableValidator | null {\n    // Validators shouldn't operate on the initial setValue call.\n    // Normally this is achieved by calling setValidator after setValue, but\n    // this is not a possibility with variable fields.\n    if (this.variable) {\n      return this.validator_;\n    }\n    return null;\n  }\n\n  /**\n   * Ensure that the ID belongs to a valid variable of an allowed type.\n   *\n   * @param newValue The ID of the new variable to set.\n   * @returns The validated ID, or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue?: AnyDuringMigration,\n  ): string | null {\n    if (newValue === null) {\n      return null;\n    }\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const newId = newValue as string;\n    const variable = Variables.getVariable(block.workspace, newId);\n    if (!variable) {\n      console.warn(\n        \"Variable id doesn't point to a real variable! \" + 'ID was ' + newId,\n      );\n      return null;\n    }\n    // Type Checks.\n    const type = variable.type;\n    if (!this.typeIsAllowed(type)) {\n      console.warn(\"Variable type doesn't match this field!  Type was \" + type);\n      return null;\n    }\n    return newId;\n  }\n\n  /**\n   * Update the value of this variable field, as well as its variable and text.\n   *\n   * The variable ID should be valid at this point, but if a variable field\n   * validator returns a bad ID, this could break.\n   *\n   * @param newId The value to be saved.\n   */\n  protected override doValueUpdate_(newId: string) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    this.variable = Variables.getVariable(block.workspace, newId as string);\n    super.doValueUpdate_(newId);\n  }\n\n  /**\n   * Check whether the given variable type is allowed on this field.\n   *\n   * @param type The type to check.\n   * @returns True if the type is in the list of allowed types.\n   */\n  private typeIsAllowed(type: string): boolean {\n    const typeList = this.getVariableTypes();\n    if (!typeList) {\n      return true; // If it's null, all types are valid.\n    }\n    for (let i = 0; i < typeList.length; i++) {\n      if (type === typeList[i]) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Return a list of variable types to include in the dropdown.\n   *\n   * @returns Array of variable types.\n   * @throws {Error} if variableTypes is an empty array.\n   */\n  private getVariableTypes(): string[] {\n    let variableTypes = this.variableTypes;\n    if (variableTypes === null) {\n      // If variableTypes is null, return all variable types.\n      if (this.sourceBlock_ && !this.sourceBlock_.isDeadOrDying()) {\n        return this.sourceBlock_.workspace.getVariableTypes();\n      }\n    }\n    variableTypes = variableTypes || [''];\n    if (variableTypes.length === 0) {\n      // Throw an error if variableTypes is an empty list.\n      const name = this.getText();\n      throw Error(\n        \"'variableTypes' of field variable \" + name + ' was an empty list',\n      );\n    }\n    return variableTypes;\n  }\n\n  /**\n   * Parse the optional arguments representing the allowed variable types and\n   * the default variable type.\n   *\n   * @param variableTypes A list of the types of variables to include in the\n   *     dropdown.  If null or undefined, variables of all types will be\n   *     displayed in the dropdown.\n   * @param defaultType The type of the variable to create if this field's\n   *     value is not explicitly set.  Defaults to ''.\n   */\n  private setTypes(variableTypes: string[] | null = null, defaultType = '') {\n    // If you expected that the default type would be the same as the only entry\n    // in the variable types array, tell the Blockly team by commenting on\n    // #1499.\n    // Set the allowable variable types.  Null means all types on the workspace.\n    if (Array.isArray(variableTypes)) {\n      // Make sure the default type is valid.\n      let isInArray = false;\n      for (let i = 0; i < variableTypes.length; i++) {\n        if (variableTypes[i] === defaultType) {\n          isInArray = true;\n        }\n      }\n      if (!isInArray) {\n        throw Error(\n          \"Invalid default type '\" +\n            defaultType +\n            \"' in \" +\n            'the definition of a FieldVariable',\n        );\n      }\n    } else if (variableTypes !== null) {\n      throw Error(\n        \"'variableTypes' was not an array in the definition of \" +\n          'a FieldVariable',\n      );\n    }\n    // Only update the field once all checks pass.\n    this.defaultType = defaultType;\n    this.variableTypes = variableTypes;\n  }\n\n  /**\n   * Refreshes the name of the variable by grabbing the name of the model.\n   * Used when a variable gets renamed, but the ID stays the same. Should only\n   * be called by the block.\n   *\n   * @internal\n   */\n  override refreshVariableName() {\n    this.forceRerender();\n  }\n\n  /**\n   * Handle the selection of an item in the variable dropdown menu.\n   * Special case the 'Rename variable...' and 'Delete variable...' options.\n   * In the rename case, prompt the user for a new name.\n   *\n   * @param menu The Menu component clicked.\n   * @param menuItem The MenuItem selected within menu.\n   */\n  protected override onItemSelected_(menu: Menu, menuItem: MenuItem) {\n    const id = menuItem.getValue();\n    // Handle special cases.\n    if (this.sourceBlock_ && !this.sourceBlock_.isDeadOrDying()) {\n      if (id === internalConstants.RENAME_VARIABLE_ID) {\n        // Rename variable.\n        Variables.renameVariable(\n          this.sourceBlock_.workspace,\n          this.variable as VariableModel,\n        );\n        return;\n      } else if (id === internalConstants.DELETE_VARIABLE_ID) {\n        // Delete variable.\n        this.sourceBlock_.workspace.deleteVariableById(this.variable!.getId());\n        return;\n      }\n    }\n    // Handle unspecial case.\n    this.setValue(id);\n  }\n\n  /**\n   * Overrides referencesVariables(), indicating this field refers to a\n   * variable.\n   *\n   * @returns True.\n   * @internal\n   */\n  override referencesVariables(): boolean {\n    return true;\n  }\n\n  /**\n   * Construct a FieldVariable from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (variable, variableTypes, and\n   *     defaultType).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(\n    options: FieldVariableFromJsonConfig,\n  ): FieldVariable {\n    const varName = parsing.replaceMessageReferences(options.variable);\n    // `this` might be a subclass of FieldVariable if that class doesn't\n    // override the static fromJson method.\n    return new this(varName, undefined, undefined, undefined, options);\n  }\n\n  /**\n   * Return a sorted list of variable names for variable dropdown menus.\n   * Include a special option at the end for creating a new variable name.\n   *\n   * @returns Array of variable names/id tuples.\n   */\n  static dropdownCreate(this: FieldVariable): MenuOption[] {\n    if (!this.variable) {\n      throw Error(\n        'Tried to call dropdownCreate on a variable field with no' +\n          ' variable selected.',\n      );\n    }\n    const name = this.getText();\n    let variableModelList: VariableModel[] = [];\n    if (this.sourceBlock_ && !this.sourceBlock_.isDeadOrDying()) {\n      const variableTypes = this.getVariableTypes();\n      // Get a copy of the list, so that adding rename and new variable options\n      // doesn't modify the workspace's list.\n      for (let i = 0; i < variableTypes.length; i++) {\n        const variableType = variableTypes[i];\n        const variables =\n          this.sourceBlock_.workspace.getVariablesOfType(variableType);\n        variableModelList = variableModelList.concat(variables);\n      }\n    }\n    variableModelList.sort(VariableModel.compareByName);\n\n    const options: [string, string][] = [];\n    for (let i = 0; i < variableModelList.length; i++) {\n      // Set the UUID as the internal representation of the variable.\n      options[i] = [variableModelList[i].name, variableModelList[i].getId()];\n    }\n    options.push([\n      Msg['RENAME_VARIABLE'],\n      internalConstants.RENAME_VARIABLE_ID,\n    ]);\n    if (Msg['DELETE_VARIABLE']) {\n      options.push([\n        Msg['DELETE_VARIABLE'].replace('%1', name),\n        internalConstants.DELETE_VARIABLE_ID,\n      ]);\n    }\n\n    return options;\n  }\n}\n\nfieldRegistry.register('field_variable', FieldVariable);\n\n/**\n * Config options for the variable field.\n */\nexport interface FieldVariableConfig extends FieldConfig {\n  variableTypes?: string[];\n  defaultType?: string;\n}\n\n/**\n * fromJson config options for the variable field.\n */\nexport interface FieldVariableFromJsonConfig extends FieldVariableConfig {\n  variable?: string;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldVariableValidator = FieldDropdownValidator;\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Number input field\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldNumber\n\nimport {Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {\n  FieldInput,\n  FieldInputConfig,\n  FieldInputValidator,\n} from './field_input.js';\nimport * as aria from './utils/aria.js';\n\n/**\n * Class for an editable number field.\n */\nexport class FieldNumber extends FieldInput<number> {\n  /** The minimum value this number field can contain. */\n  protected min_ = -Infinity;\n\n  /** The maximum value this number field can contain. */\n  protected max_ = Infinity;\n\n  /** The multiple to which this fields value is rounded. */\n  protected precision_ = 0;\n\n  /**\n   * The number of decimal places to allow, or null to allow any number of\n   * decimal digits.\n   */\n  private decimalPlaces: number | null = null;\n\n  /** Don't spellcheck numbers.  Our validator does a better job. */\n  protected override spellcheck_ = false;\n\n  /**\n   * @param value The initial value of the field. Should cast to a number.\n   *     Defaults to 0. Also accepts Field.SKIP_SETUP if you wish to skip setup\n   *     (only used by subclasses that want to handle configuration and setting\n   *     the field value after their own constructors have run).\n   * @param min Minimum value. Will only be used if config is not\n   *     provided.\n   * @param max Maximum value. Will only be used if config is not\n   *     provided.\n   * @param precision Precision for value. Will only be used if config\n   *     is not provided.\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a number & returns a validated number, or null\n   *     to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/number#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | number | typeof Field.SKIP_SETUP,\n    min?: string | number | null,\n    max?: string | number | null,\n    precision?: string | number | null,\n    validator?: FieldNumberValidator | null,\n    config?: FieldNumberConfig,\n  ) {\n    // Pass SENTINEL so that we can define properties before value validation.\n    super(Field.SKIP_SETUP);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    } else {\n      this.setConstraints(min, max, precision);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldNumberConfig) {\n    super.configure_(config);\n    this.setMinInternal(config.min);\n    this.setMaxInternal(config.max);\n    this.setPrecisionInternal(config.precision);\n  }\n\n  /**\n   * Set the maximum, minimum and precision constraints on this field.\n   * Any of these properties may be undefined or NaN to be disabled.\n   * Setting precision (usually a power of 10) enforces a minimum step between\n   * values. That is, the user's value will rounded to the closest multiple of\n   * precision. The least significant digit place is inferred from the\n   * precision. Integers values can be enforces by choosing an integer\n   * precision.\n   *\n   * @param min Minimum value.\n   * @param max Maximum value.\n   * @param precision Precision for value.\n   */\n  setConstraints(\n    min: number | string | undefined | null,\n    max: number | string | undefined | null,\n    precision: number | string | undefined | null,\n  ) {\n    this.setMinInternal(min);\n    this.setMaxInternal(max);\n    this.setPrecisionInternal(precision);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the minimum value this field can contain. Updates the value to\n   * reflect.\n   *\n   * @param min Minimum value.\n   */\n  setMin(min: number | string | undefined | null) {\n    this.setMinInternal(min);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the minimum value this field can contain. Called internally to avoid\n   * value updates.\n   *\n   * @param min Minimum value.\n   */\n  private setMinInternal(min: number | string | undefined | null) {\n    if (min == null) {\n      this.min_ = -Infinity;\n    } else {\n      min = Number(min);\n      if (!isNaN(min)) {\n        this.min_ = min;\n      }\n    }\n  }\n\n  /**\n   * Returns the current minimum value this field can contain. Default is\n   * -Infinity.\n   *\n   * @returns The current minimum value this field can contain.\n   */\n  getMin(): number {\n    return this.min_;\n  }\n\n  /**\n   * Sets the maximum value this field can contain. Updates the value to\n   * reflect.\n   *\n   * @param max Maximum value.\n   */\n  setMax(max: number | string | undefined | null) {\n    this.setMaxInternal(max);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the maximum value this field can contain. Called internally to avoid\n   * value updates.\n   *\n   * @param max Maximum value.\n   */\n  private setMaxInternal(max: number | string | undefined | null) {\n    if (max == null) {\n      this.max_ = Infinity;\n    } else {\n      max = Number(max);\n      if (!isNaN(max)) {\n        this.max_ = max;\n      }\n    }\n  }\n\n  /**\n   * Returns the current maximum value this field can contain. Default is\n   * Infinity.\n   *\n   * @returns The current maximum value this field can contain.\n   */\n  getMax(): number {\n    return this.max_;\n  }\n\n  /**\n   * Sets the precision of this field's value, i.e. the number to which the\n   * value is rounded. Updates the field to reflect.\n   *\n   * @param precision The number to which the field's value is rounded.\n   */\n  setPrecision(precision: number | string | undefined | null) {\n    this.setPrecisionInternal(precision);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the precision of this field's value. Called internally to avoid\n   * value updates.\n   *\n   * @param precision The number to which the field's value is rounded.\n   */\n  private setPrecisionInternal(precision: number | string | undefined | null) {\n    this.precision_ = Number(precision) || 0;\n    let precisionString = String(this.precision_);\n    if (precisionString.includes('e')) {\n      // String() is fast.  But it turns .0000001 into '1e-7'.\n      // Use the much slower toLocaleString to access all the digits.\n      precisionString = this.precision_.toLocaleString('en-US', {\n        maximumFractionDigits: 20,\n      });\n    }\n    const decimalIndex = precisionString.indexOf('.');\n    if (decimalIndex === -1) {\n      // If the precision is 0 (float) allow any number of decimals,\n      // otherwise allow none.\n      this.decimalPlaces = precision ? 0 : null;\n    } else {\n      this.decimalPlaces = precisionString.length - decimalIndex - 1;\n    }\n  }\n\n  /**\n   * Returns the current precision of this field. The precision being the\n   * number to which the field's value is rounded. A precision of 0 means that\n   * the value is not rounded.\n   *\n   * @returns The number to which this field's value is rounded.\n   */\n  getPrecision(): number {\n    return this.precision_;\n  }\n\n  /**\n   * Ensure that the input value is a valid number (must fulfill the\n   * constraints placed on the field).\n   *\n   * @param newValue The input value.\n   * @returns A valid number, or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue?: AnyDuringMigration,\n  ): number | null {\n    if (newValue === null) {\n      return null;\n    }\n\n    // Clean up text.\n    newValue = `${newValue}`;\n    // TODO: Handle cases like 'ten', '1.203,14', etc.\n    // 'O' is sometimes mistaken for '0' by inexperienced users.\n    newValue = newValue.replace(/O/gi, '0');\n    // Strip out thousands separators.\n    newValue = newValue.replace(/,/g, '');\n    // Ignore case of 'Infinity'.\n    newValue = newValue.replace(/infinity/i, 'Infinity');\n\n    // Clean up number.\n    let n = Number(newValue || 0);\n    if (isNaN(n)) {\n      // Invalid number.\n      return null;\n    }\n    // Get the value in range.\n    n = Math.min(Math.max(n, this.min_), this.max_);\n    // Round to nearest multiple of precision.\n    if (this.precision_ && isFinite(n)) {\n      n = Math.round(n / this.precision_) * this.precision_;\n    }\n    // Clean up floating point errors.\n    if (this.decimalPlaces !== null) {\n      n = Number(n.toFixed(this.decimalPlaces));\n    }\n    return n;\n  }\n\n  /**\n   * Create the number input editor widget.\n   *\n   * @returns The newly created number input editor.\n   */\n  protected override widgetCreate_(): HTMLInputElement {\n    const htmlInput = super.widgetCreate_() as HTMLInputElement;\n\n    // Set the accessibility state\n    if (this.min_ > -Infinity) {\n      htmlInput.min = `${this.min_}`;\n      aria.setState(htmlInput, aria.State.VALUEMIN, this.min_);\n    }\n    if (this.max_ < Infinity) {\n      htmlInput.max = `${this.max_}`;\n      aria.setState(htmlInput, aria.State.VALUEMAX, this.max_);\n    }\n    return htmlInput;\n  }\n\n  /**\n   * Construct a FieldNumber from a JSON arg object.\n   *\n   * @param options A JSON object with options (value, min, max, and precision).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(options: FieldNumberFromJsonConfig): FieldNumber {\n    // `this` might be a subclass of FieldNumber if that class doesn't override\n    // the static fromJson method.\n    return new this(\n      options.value,\n      undefined,\n      undefined,\n      undefined,\n      undefined,\n      options,\n    );\n  }\n}\n\nfieldRegistry.register('field_number', FieldNumber);\n\nFieldNumber.prototype.DEFAULT_VALUE = 0;\n\n/**\n * Config options for the number field.\n */\nexport interface FieldNumberConfig extends FieldInputConfig {\n  min?: number;\n  max?: number;\n  precision?: number;\n}\n\n/**\n * fromJson config options for the number field.\n */\nexport interface FieldNumberFromJsonConfig extends FieldNumberConfig {\n  value?: number;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldNumberValidator = FieldInputValidator<number>;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Non-editable, serializable text field. Behaves like a\n *    normal label but is serialized to XML. It may only be\n *    edited programmatically.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldLabelSerializable\n\nimport {\n  FieldLabel,\n  FieldLabelConfig,\n  FieldLabelFromJsonConfig,\n} from './field_label.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as parsing from './utils/parsing.js';\n\n/**\n * Class for a non-editable, serializable text field.\n */\nexport class FieldLabelSerializable extends FieldLabel {\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. This field should not.\n   */\n  override EDITABLE = false;\n\n  /**\n   * Serializable fields are saved by the XML renderer, non-serializable\n   * fields are not.  This field should be serialized, but only edited\n   * programmatically.\n   */\n  override SERIALIZABLE = true;\n\n  /**\n   * @param value The initial value of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined.\n   * @param textClass Optional CSS class for the field's text.\n   * @param config A map of options used to configure the field.\n   *    See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/label-serializable#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(value?: string, textClass?: string, config?: FieldLabelConfig) {\n    super(String(value ?? ''), textClass, config);\n  }\n\n  /**\n   * Construct a FieldLabelSerializable from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (text, and class).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(\n    options: FieldLabelFromJsonConfig,\n  ): FieldLabelSerializable {\n    const text = parsing.replaceMessageReferences(options.text);\n    // `this` might be a subclass of FieldLabelSerializable if that class\n    // doesn't override the static fromJson method.\n    return new this(text, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_label_serializable', FieldLabelSerializable);\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Checkbox field.  Checked or not checked.\n *\n * @class\n */\n// Former goog.module ID: Blockly.FieldCheckbox\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport * as dom from './utils/dom.js';\nimport {Field, FieldConfig, FieldValidator} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\n\ntype BoolString = 'TRUE' | 'FALSE';\ntype CheckboxBool = BoolString | boolean;\n\n/**\n * Class for a checkbox field.\n */\nexport class FieldCheckbox extends Field<CheckboxBool> {\n  /** Default character for the checkmark. */\n  static readonly CHECK_CHAR = '';\n  private checkChar: string;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /**\n   * Mouse cursor style when over the hotspot that initiates editability.\n   */\n  override CURSOR = 'default';\n\n  /**\n   * NOTE: The default value is set in `Field`, so maintain that value instead\n   * of overwriting it here or in the constructor.\n   */\n  override value_: boolean | null = this.value_;\n\n  /**\n   * @param value The initial value of the field. Should either be 'TRUE',\n   *     'FALSE' or a boolean. Defaults to 'FALSE'. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param validator  A function that is called to validate changes to the\n   *     field's value. Takes in a value ('TRUE' or 'FALSE') & returns a\n   *     validated value ('TRUE' or 'FALSE'), or null to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/checkbox#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: CheckboxBool | typeof Field.SKIP_SETUP,\n    validator?: FieldCheckboxValidator,\n    config?: FieldCheckboxConfig,\n  ) {\n    super(Field.SKIP_SETUP);\n\n    /**\n     * Character for the check mark. Used to apply a different check mark\n     * character to individual fields.\n     */\n    this.checkChar = FieldCheckbox.CHECK_CHAR;\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldCheckboxConfig) {\n    super.configure_(config);\n    if (config.checkCharacter) this.checkChar = config.checkCharacter;\n  }\n\n  /**\n   * Saves this field's value.\n   *\n   * @returns The boolean value held by this field.\n   * @internal\n   */\n  override saveState(): AnyDuringMigration {\n    const legacyState = this.saveLegacyState(FieldCheckbox);\n    if (legacyState !== null) {\n      return legacyState;\n    }\n    return this.getValueBoolean();\n  }\n\n  /**\n   * Create the block UI for this checkbox.\n   */\n  override initView() {\n    super.initView();\n\n    const textElement = this.getTextElement();\n    dom.addClass(textElement, 'blocklyCheckbox');\n    textElement.style.display = this.value_ ? 'block' : 'none';\n  }\n\n  override render_() {\n    if (this.textContent_) {\n      this.textContent_.nodeValue = this.getDisplayText_();\n    }\n    this.updateSize_(this.getConstants()!.FIELD_CHECKBOX_X_OFFSET);\n  }\n\n  override getDisplayText_() {\n    return this.checkChar;\n  }\n\n  /**\n   * Set the character used for the check mark.\n   *\n   * @param character The character to use for the check mark, or null to use\n   *     the default.\n   */\n  setCheckCharacter(character: string | null) {\n    this.checkChar = character || FieldCheckbox.CHECK_CHAR;\n    this.forceRerender();\n  }\n\n  /** Toggle the state of the checkbox on click. */\n  protected override showEditor_() {\n    this.setValue(!this.value_);\n  }\n\n  /**\n   * Ensure that the input value is valid ('TRUE' or 'FALSE').\n   *\n   * @param newValue The input value.\n   * @returns A valid value ('TRUE' or 'FALSE), or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue?: AnyDuringMigration,\n  ): BoolString | null {\n    if (newValue === true || newValue === 'TRUE') {\n      return 'TRUE';\n    }\n    if (newValue === false || newValue === 'FALSE') {\n      return 'FALSE';\n    }\n    return null;\n  }\n\n  /**\n   * Update the value of the field, and update the checkElement.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a either 'TRUE' or 'FALSE'.\n   */\n  protected override doValueUpdate_(newValue: BoolString) {\n    this.value_ = this.convertValueToBool_(newValue);\n    // Update visual.\n    if (this.textElement_) {\n      this.textElement_.style.display = this.value_ ? 'block' : 'none';\n    }\n  }\n\n  /**\n   * Get the value of this field, either 'TRUE' or 'FALSE'.\n   *\n   * @returns The value of this field.\n   */\n  override getValue(): BoolString {\n    return this.value_ ? 'TRUE' : 'FALSE';\n  }\n\n  /**\n   * Get the boolean value of this field.\n   *\n   * @returns The boolean value of this field.\n   */\n  getValueBoolean(): boolean | null {\n    return this.value_;\n  }\n\n  /**\n   * Get the text of this field. Used when the block is collapsed.\n   *\n   * @returns Text representing the value of this field ('true' or 'false').\n   */\n  override getText(): string {\n    return String(this.convertValueToBool_(this.value_));\n  }\n\n  /**\n   * Convert a value into a pure boolean.\n   *\n   * Converts 'TRUE' to true and 'FALSE' to false correctly, everything else\n   * is cast to a boolean.\n   *\n   * @param value The value to convert.\n   * @returns The converted value.\n   */\n  private convertValueToBool_(value: CheckboxBool | null): boolean {\n    if (typeof value === 'string') return value === 'TRUE';\n    return !!value;\n  }\n\n  /**\n   * Construct a FieldCheckbox from a JSON arg object.\n   *\n   * @param options A JSON object with options (checked).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(\n    options: FieldCheckboxFromJsonConfig,\n  ): FieldCheckbox {\n    // `this` might be a subclass of FieldCheckbox if that class doesn't\n    // 'override' the static fromJson method.\n    return new this(options.checked, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_checkbox', FieldCheckbox);\n\nFieldCheckbox.prototype.DEFAULT_VALUE = false;\n\n/**\n * Config options for the checkbox field.\n */\nexport interface FieldCheckboxConfig extends FieldConfig {\n  checkCharacter?: string;\n}\n\n/**\n * fromJson config options for the checkbox field.\n */\nexport interface FieldCheckboxFromJsonConfig extends FieldCheckboxConfig {\n  checked?: boolean;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldCheckboxValidator = FieldValidator<CheckboxBool>;\n","/**\n * @license\n * Copyright 2024 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IDragTarget} from '../interfaces/i_drag_target.js';\nimport {IDeletable, isDeletable} from '../interfaces/i_deletable.js';\nimport {IDragger} from '../interfaces/i_dragger.js';\nimport {IDraggable} from '../interfaces/i_draggable.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport {ComponentManager} from '../component_manager.js';\nimport {IDeleteArea} from '../interfaces/i_delete_area.js';\nimport * as registry from '../registry.js';\nimport * as eventUtils from '../events/utils.js';\nimport * as blockAnimations from '../block_animations.js';\nimport {BlockSvg} from '../block_svg.js';\n\nexport class Dragger implements IDragger {\n  protected startLoc: Coordinate;\n\n  protected dragTarget: IDragTarget | null = null;\n\n  constructor(\n    protected draggable: IDraggable,\n    protected workspace: WorkspaceSvg,\n  ) {\n    this.startLoc = draggable.getRelativeToSurfaceXY();\n  }\n\n  /** Handles any drag startup. */\n  onDragStart(e: PointerEvent) {\n    this.draggable.startDrag(e);\n  }\n\n  /**\n   * Handles calculating where the element should actually be moved to.\n   *\n   * @param totalDelta The total amount in pixel coordinates the mouse has moved\n   *     since the start of the drag.\n   */\n  onDrag(e: PointerEvent, totalDelta: Coordinate) {\n    this.moveDraggable(e, totalDelta);\n    const root = this.getRoot(this.draggable);\n\n    // Must check `wouldDelete` before calling other hooks on drag targets\n    // since we have documented that we would do so.\n    if (isDeletable(root)) {\n      root.setDeleteStyle(this.wouldDeleteDraggable(e, root));\n    }\n    this.updateDragTarget(e);\n  }\n\n  /** Updates the drag target under the pointer (if there is one). */\n  protected updateDragTarget(e: PointerEvent) {\n    const newDragTarget = this.workspace.getDragTarget(e);\n    const root = this.getRoot(this.draggable);\n    if (this.dragTarget !== newDragTarget) {\n      this.dragTarget?.onDragExit(root);\n      newDragTarget?.onDragEnter(root);\n    }\n    newDragTarget?.onDragOver(root);\n    this.dragTarget = newDragTarget;\n  }\n\n  /**\n   * Calculates the correct workspace coordinate for the movable and tells\n   * the draggable to go to that location.\n   */\n  private moveDraggable(e: PointerEvent, totalDelta: Coordinate) {\n    const delta = this.pixelsToWorkspaceUnits(totalDelta);\n    const newLoc = Coordinate.sum(this.startLoc, delta);\n    this.draggable.drag(newLoc, e);\n  }\n\n  /**\n   * Returns true if we would delete the draggable if it was dropped\n   * at the current location.\n   */\n  protected wouldDeleteDraggable(\n    e: PointerEvent,\n    rootDraggable: IDraggable & IDeletable,\n  ) {\n    const dragTarget = this.workspace.getDragTarget(e);\n    if (!dragTarget) return false;\n\n    const componentManager = this.workspace.getComponentManager();\n    const isDeleteArea = componentManager.hasCapability(\n      dragTarget.id,\n      ComponentManager.Capability.DELETE_AREA,\n    );\n    if (!isDeleteArea) return false;\n\n    return (dragTarget as IDeleteArea).wouldDelete(rootDraggable);\n  }\n\n  /** Handles any drag cleanup. */\n  onDragEnd(e: PointerEvent) {\n    const origGroup = eventUtils.getGroup();\n    const dragTarget = this.workspace.getDragTarget(e);\n    const root = this.getRoot(this.draggable);\n\n    if (dragTarget) {\n      this.dragTarget?.onDrop(root);\n    }\n\n    if (this.shouldReturnToStart(e, root)) {\n      this.draggable.revertDrag();\n    }\n\n    const wouldDelete = isDeletable(root) && this.wouldDeleteDraggable(e, root);\n\n    // TODO(#8148): use a generalized API instead of an instanceof check.\n    if (wouldDelete && this.draggable instanceof BlockSvg) {\n      blockAnimations.disposeUiEffect(this.draggable.getRootBlock());\n    }\n\n    this.draggable.endDrag(e);\n\n    if (wouldDelete && isDeletable(root)) {\n      // We want to make sure the delete gets grouped with any possible\n      // move event.\n      const newGroup = eventUtils.getGroup();\n      eventUtils.setGroup(origGroup);\n      root.dispose();\n      eventUtils.setGroup(newGroup);\n    }\n  }\n\n  // We need to special case blocks for now so that we look at the root block\n  // instead of the one actually being dragged in most cases.\n  private getRoot(draggable: IDraggable): IDraggable {\n    return draggable instanceof BlockSvg ? draggable.getRootBlock() : draggable;\n  }\n\n  /**\n   * Returns true if we should return the draggable to its original location\n   * at the end of the drag.\n   */\n  protected shouldReturnToStart(e: PointerEvent, rootDraggable: IDraggable) {\n    const dragTarget = this.workspace.getDragTarget(e);\n    if (!dragTarget) return false;\n    return dragTarget.shouldPreventMove(rootDraggable);\n  }\n\n  protected pixelsToWorkspaceUnits(pixelCoord: Coordinate): Coordinate {\n    const result = new Coordinate(\n      pixelCoord.x / this.workspace.scale,\n      pixelCoord.y / this.workspace.scale,\n    );\n    if (this.workspace.isMutator) {\n      // If we're in a mutator, its scale is always 1, purely because of some\n      // oddities in our rendering optimizations.  The actual scale is the same\n      // as the scale on the parent workspace. Fix that for dragging.\n      const mainScale = this.workspace.options.parentWorkspace!.scale;\n      result.scale(1 / mainScale);\n    }\n    return result;\n  }\n}\n\nregistry.register(registry.Type.BLOCK_DRAGGER, registry.DEFAULT, Dragger);\n","/**\n * @license\n * Copyright 2024 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Dragger} from './dragging/dragger.js';\nimport {BlockDragStrategy} from './dragging/block_drag_strategy.js';\nimport {BubbleDragStrategy} from './dragging/bubble_drag_strategy.js';\nimport {CommentDragStrategy} from './dragging/comment_drag_strategy.js';\n\nexport {Dragger, BlockDragStrategy, BubbleDragStrategy, CommentDragStrategy};\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a block drag.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BlockDrag\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners when a block is being manually dragged/dropped.\n */\nexport class BlockDrag extends UiBase {\n  /** The ID of the top-level block being dragged. */\n  blockId?: string;\n\n  /** True if this is the start of a drag, false if this is the end of one. */\n  isStart?: boolean;\n\n  /**\n   * A list of all of the blocks (i.e. all descendants of the block associated\n   * with the block ID) being dragged.\n   */\n  blocks?: Block[];\n\n  override type = eventUtils.BLOCK_DRAG;\n\n  /**\n   * @param opt_block The top block in the stack that is being dragged.\n   *     Undefined for a blank event.\n   * @param opt_isStart Whether this is the start of a block drag.\n   *    Undefined for a blank event.\n   * @param opt_blocks The blocks affected by this drag. Undefined for a blank\n   *     event.\n   */\n  constructor(opt_block?: Block, opt_isStart?: boolean, opt_blocks?: Block[]) {\n    const workspaceId = opt_block ? opt_block.workspace.id : undefined;\n    super(workspaceId);\n    if (!opt_block) return;\n\n    this.blockId = opt_block.id;\n    this.isStart = opt_isStart;\n    this.blocks = opt_blocks;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockDragJson {\n    const json = super.toJson() as BlockDragJson;\n    if (this.isStart === undefined) {\n      throw new Error(\n        'Whether this event is the start of a drag is undefined. ' +\n          'Either pass the value to the constructor, or call fromJson',\n      );\n    }\n    if (this.blockId === undefined) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['isStart'] = this.isStart;\n    json['blockId'] = this.blockId;\n    // TODO: I don't think we should actually apply the blocks array to the JSON\n    //   object b/c they have functions and aren't actually serializable.\n    json['blocks'] = this.blocks;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockDrag, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses..\n   * @internal\n   */\n  static fromJson(\n    json: BlockDragJson,\n    workspace: Workspace,\n    event?: any,\n  ): BlockDrag {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockDrag(),\n    ) as BlockDrag;\n    newEvent.isStart = json['isStart'];\n    newEvent.blockId = json['blockId'];\n    newEvent.blocks = json['blocks'];\n    return newEvent;\n  }\n}\n\nexport interface BlockDragJson extends AbstractEventJson {\n  isStart: boolean;\n  blockId: string;\n  blocks?: Block[];\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.BLOCK_DRAG, BlockDrag);\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for an event representing an intermediate change to a block's field's\n * value.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BlockFieldIntermediateChange\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport {Workspace} from '../workspace.js';\n\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\n\n/**\n * Notifies listeners when the value of a block's field has changed but the\n * change is not yet complete, and is expected to be followed by a block change\n * event.\n */\nexport class BlockFieldIntermediateChange extends BlockBase {\n  override type = eventUtils.BLOCK_FIELD_INTERMEDIATE_CHANGE;\n\n  // Intermediate events do not undo or redo. They may be fired frequently while\n  // the field editor widget is open. A separate BLOCK_CHANGE event is fired\n  // when the editor is closed, which combines all of the field value changes\n  // into a single change that is recorded in the undo history instead. The\n  // intermediate changes are important for reacting to immediate changes, but\n  // some event handlers would prefer to handle the less frequent final events,\n  // like when triggering workspace serialization. Technically, this method of\n  // grouping changes can result in undo perfoming actions out of order if some\n  // other event occurs between opening and closing the field editor, but such\n  // events are unlikely to cause a broken state.\n  override recordUndo = false;\n\n  /** The name of the field that changed. */\n  name?: string;\n\n  /** The original value of the element. */\n  oldValue: unknown;\n\n  /** The new value of the element. */\n  newValue: unknown;\n\n  /**\n   * @param opt_block The changed block. Undefined for a blank event.\n   * @param opt_name Name of the field affected.\n   * @param opt_oldValue Previous value of element.\n   * @param opt_newValue New value of element.\n   */\n  constructor(\n    opt_block?: Block,\n    opt_name?: string,\n    opt_oldValue?: unknown,\n    opt_newValue?: unknown,\n  ) {\n    super(opt_block);\n    if (!opt_block) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    this.name = opt_name;\n    this.oldValue = opt_oldValue;\n    this.newValue = opt_newValue;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockFieldIntermediateChangeJson {\n    const json = super.toJson() as BlockFieldIntermediateChangeJson;\n    if (!this.name) {\n      throw new Error(\n        'The changed field name is undefined. Either pass a ' +\n          'name to the constructor, or call fromJson.',\n      );\n    }\n    json['name'] = this.name;\n    json['oldValue'] = this.oldValue;\n    json['newValue'] = this.newValue;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockFieldIntermediateChange, but we can't specify that due to the\n   *     fact that parameters to static methods in subclasses must be supertypes\n   *     of parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockFieldIntermediateChangeJson,\n    workspace: Workspace,\n    event?: any,\n  ): BlockFieldIntermediateChange {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockFieldIntermediateChange(),\n    ) as BlockFieldIntermediateChange;\n    newEvent.name = json['name'];\n    newEvent.oldValue = json['oldValue'];\n    newEvent.newValue = json['newValue'];\n    return newEvent;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return this.oldValue === this.newValue;\n  }\n\n  /**\n   * Run a change event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.blockId) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    const block = workspace.getBlockById(this.blockId);\n    if (!block) {\n      throw new Error(\n        'The associated block is undefined. Either pass a ' +\n          'block to the constructor, or call fromJson',\n      );\n    }\n\n    const value = forward ? this.newValue : this.oldValue;\n    const field = block.getField(this.name!);\n    if (field) {\n      field.setValue(value);\n    } else {\n      console.warn(\"Can't set non-existent field: \" + this.name);\n    }\n  }\n}\n\nexport interface BlockFieldIntermediateChangeJson extends BlockBaseJson {\n  name: string;\n  newValue: unknown;\n  oldValue: unknown;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.BLOCK_FIELD_INTERMEDIATE_CHANGE,\n  BlockFieldIntermediateChange,\n);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block move event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BlockMove\n\nimport type {Block} from '../block.js';\nimport {ConnectionType} from '../connection_type.js';\nimport * as registry from '../registry.js';\nimport {Coordinate} from '../utils/coordinate.js';\n\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\ninterface BlockLocation {\n  parentId?: string;\n  inputName?: string;\n  coordinate?: Coordinate;\n}\n\n/**\n * Notifies listeners when a block is moved. This could be from one\n * connection to another, or from one location on the workspace to another.\n */\nexport class BlockMove extends BlockBase {\n  override type = eventUtils.BLOCK_MOVE;\n\n  /** The ID of the old parent block. Undefined if it was a top-level block. */\n  oldParentId?: string;\n\n  /**\n   * The name of the old input. Undefined if it was a top-level block or the\n   * parent's next block.\n   */\n  oldInputName?: string;\n\n  /**\n   * The old X and Y workspace coordinates of the block if it was a top level\n   * block. Undefined if it was not a top level block.\n   */\n  oldCoordinate?: Coordinate;\n\n  /** The ID of the new parent block. Undefined if it is a top-level block. */\n  newParentId?: string;\n\n  /**\n   * The name of the new input. Undefined if it is a top-level block or the\n   * parent's next block.\n   */\n  newInputName?: string;\n\n  /**\n   * The new X and Y workspace coordinates of the block if it is a top-level\n   * block. Undefined if it is not a top level block.\n   */\n  newCoordinate?: Coordinate;\n\n  /**\n   * An explanation of what this move is for.  Known values include:\n   *  'drag' -- A drag operation completed.\n   *  'bump' -- Block got bumped away from an invalid connection.\n   *  'snap' -- Block got shifted to line up with the grid.\n   *  'inbounds' -- Block got pushed back into a non-scrolling workspace.\n   *  'connect' -- Block got connected to another block.\n   *  'disconnect' -- Block got disconnected from another block.\n   *  'create' -- Block created via XML.\n   *  'cleanup' -- Workspace aligned top-level blocks.\n   * Event merging may create multiple reasons: ['drag', 'bump', 'snap'].\n   */\n  reason?: string[];\n\n  /** @param opt_block The moved block.  Undefined for a blank event. */\n  constructor(opt_block?: Block) {\n    super(opt_block);\n\n    if (!opt_block) {\n      return;\n    }\n    // Blank event to be populated by fromJson.\n    if (opt_block.isShadow()) {\n      // Moving shadow blocks is handled via disconnection.\n      this.recordUndo = false;\n    }\n\n    const location = this.currentLocation_();\n    this.oldParentId = location.parentId;\n    this.oldInputName = location.inputName;\n    this.oldCoordinate = location.coordinate;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockMoveJson {\n    const json = super.toJson() as BlockMoveJson;\n    json['oldParentId'] = this.oldParentId;\n    json['oldInputName'] = this.oldInputName;\n    if (this.oldCoordinate) {\n      json['oldCoordinate'] =\n        `${Math.round(this.oldCoordinate.x)}, ` +\n        `${Math.round(this.oldCoordinate.y)}`;\n    }\n    json['newParentId'] = this.newParentId;\n    json['newInputName'] = this.newInputName;\n    if (this.newCoordinate) {\n      json['newCoordinate'] =\n        `${Math.round(this.newCoordinate.x)}, ` +\n        `${Math.round(this.newCoordinate.y)}`;\n    }\n    if (this.reason) {\n      json['reason'] = this.reason;\n    }\n    if (!this.recordUndo) {\n      json['recordUndo'] = this.recordUndo;\n    }\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockMove, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockMoveJson,\n    workspace: Workspace,\n    event?: any,\n  ): BlockMove {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockMove(),\n    ) as BlockMove;\n    newEvent.oldParentId = json['oldParentId'];\n    newEvent.oldInputName = json['oldInputName'];\n    if (json['oldCoordinate']) {\n      const xy = json['oldCoordinate'].split(',');\n      newEvent.oldCoordinate = new Coordinate(Number(xy[0]), Number(xy[1]));\n    }\n    newEvent.newParentId = json['newParentId'];\n    newEvent.newInputName = json['newInputName'];\n    if (json['newCoordinate']) {\n      const xy = json['newCoordinate'].split(',');\n      newEvent.newCoordinate = new Coordinate(Number(xy[0]), Number(xy[1]));\n    }\n    if (json['reason'] !== undefined) {\n      newEvent.reason = json['reason'];\n    }\n    if (json['recordUndo'] !== undefined) {\n      newEvent.recordUndo = json['recordUndo'];\n    }\n    return newEvent;\n  }\n\n  /** Record the block's new location.  Called after the move. */\n  recordNew() {\n    const location = this.currentLocation_();\n    this.newParentId = location.parentId;\n    this.newInputName = location.inputName;\n    this.newCoordinate = location.coordinate;\n  }\n\n  /**\n   * Set the reason for a move event.\n   *\n   * @param reason Why is this move happening?  'drag', 'bump', 'snap', ...\n   */\n  setReason(reason: string[]) {\n    this.reason = reason;\n  }\n\n  /**\n   * Returns the parentId and input if the block is connected,\n   *   or the XY location if disconnected.\n   *\n   * @returns Collection of location info.\n   */\n  private currentLocation_(): BlockLocation {\n    const workspace = this.getEventWorkspace_();\n    if (!this.blockId) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    const block = workspace.getBlockById(this.blockId);\n    if (!block) {\n      throw new Error(\n        'The block associated with the block move event ' +\n          'could not be found',\n      );\n    }\n    const location = {} as BlockLocation;\n    const parent = block.getParent();\n    if (parent) {\n      location.parentId = parent.id;\n      const input = parent.getInputWithBlock(block);\n      if (input) {\n        location.inputName = input.name;\n      }\n    } else {\n      location.coordinate = block.getRelativeToSurfaceXY();\n    }\n    return location;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return (\n      this.oldParentId === this.newParentId &&\n      this.oldInputName === this.newInputName &&\n      Coordinate.equals(this.oldCoordinate, this.newCoordinate)\n    );\n  }\n\n  /**\n   * Run a move event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.blockId) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    const block = workspace.getBlockById(this.blockId);\n    if (!block) {\n      console.warn(\"Can't move non-existent block: \" + this.blockId);\n      return;\n    }\n    const parentId = forward ? this.newParentId : this.oldParentId;\n    const inputName = forward ? this.newInputName : this.oldInputName;\n    const coordinate = forward ? this.newCoordinate : this.oldCoordinate;\n    let parentBlock: Block | null;\n    if (parentId) {\n      parentBlock = workspace.getBlockById(parentId);\n      if (!parentBlock) {\n        console.warn(\"Can't connect to non-existent block: \" + parentId);\n        return;\n      }\n    }\n    if (block.getParent()) {\n      block.unplug();\n    }\n    if (coordinate) {\n      const xy = block.getRelativeToSurfaceXY();\n      block.moveBy(coordinate.x - xy.x, coordinate.y - xy.y, this.reason);\n    } else {\n      let blockConnection = block.outputConnection;\n      if (\n        !blockConnection ||\n        (block.previousConnection && block.previousConnection.isConnected())\n      ) {\n        blockConnection = block.previousConnection;\n      }\n      let parentConnection;\n      const connectionType = blockConnection?.type;\n      if (inputName) {\n        const input = parentBlock!.getInput(inputName);\n        if (input) {\n          parentConnection = input.connection;\n        }\n      } else if (connectionType === ConnectionType.PREVIOUS_STATEMENT) {\n        parentConnection = parentBlock!.nextConnection;\n      }\n      if (parentConnection && blockConnection) {\n        blockConnection.connect(parentConnection);\n      } else {\n        console.warn(\"Can't connect to non-existent input: \" + inputName);\n      }\n    }\n  }\n}\n\nexport interface BlockMoveJson extends BlockBaseJson {\n  oldParentId?: string;\n  oldInputName?: string;\n  oldCoordinate?: string;\n  newParentId?: string;\n  newInputName?: string;\n  newCoordinate?: string;\n  reason?: string[];\n  recordUndo?: boolean;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.MOVE, BlockMove);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of bubble open.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.BubbleOpen\n\nimport type {AbstractEventJson} from './events_abstract.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport * as registry from '../registry.js';\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Class for a bubble open event.\n */\nexport class BubbleOpen extends UiBase {\n  /** The ID of the block the bubble is attached to. */\n  blockId?: string;\n\n  /** True if the bubble is opening, false if closing. */\n  isOpen?: boolean;\n\n  /** The type of bubble; one of 'mutator', 'comment', or 'warning'. */\n  bubbleType?: BubbleType;\n\n  override type = eventUtils.BUBBLE_OPEN;\n\n  /**\n   * @param opt_block The associated block. Undefined for a blank event.\n   * @param opt_isOpen Whether the bubble is opening (false if closing).\n   *     Undefined for a blank event.\n   * @param opt_bubbleType The type of bubble. One of 'mutator', 'comment' or\n   *     'warning'. Undefined for a blank event.\n   */\n  constructor(\n    opt_block?: BlockSvg,\n    opt_isOpen?: boolean,\n    opt_bubbleType?: BubbleType,\n  ) {\n    const workspaceId = opt_block ? opt_block.workspace.id : undefined;\n    super(workspaceId);\n    if (!opt_block) return;\n\n    this.blockId = opt_block.id;\n    this.isOpen = opt_isOpen;\n    this.bubbleType = opt_bubbleType;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BubbleOpenJson {\n    const json = super.toJson() as BubbleOpenJson;\n    if (this.isOpen === undefined) {\n      throw new Error(\n        'Whether this event is for opening the bubble is undefined. ' +\n          'Either pass the value to the constructor, or call fromJson',\n      );\n    }\n    if (!this.bubbleType) {\n      throw new Error(\n        'The type of bubble is undefined. Either pass the ' +\n          'value to the constructor, or call fromJson',\n      );\n    }\n    json['isOpen'] = this.isOpen;\n    json['bubbleType'] = this.bubbleType;\n    json['blockId'] = this.blockId || '';\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BubbleOpen, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BubbleOpenJson,\n    workspace: Workspace,\n    event?: any,\n  ): BubbleOpen {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BubbleOpen(),\n    ) as BubbleOpen;\n    newEvent.isOpen = json['isOpen'];\n    newEvent.bubbleType = json['bubbleType'];\n    newEvent.blockId = json['blockId'];\n    return newEvent;\n  }\n}\n\nexport enum BubbleType {\n  MUTATOR = 'mutator',\n  COMMENT = 'comment',\n  WARNING = 'warning',\n}\n\nexport interface BubbleOpenJson extends AbstractEventJson {\n  isOpen: boolean;\n  bubbleType: BubbleType;\n  blockId: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.BUBBLE_OPEN, BubbleOpen);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Base class for comment events.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.CommentBase\n\nimport type {WorkspaceComment} from '../comments/workspace_comment.js';\nimport * as comments from '../serialization/workspace_comments.js';\nimport {\n  Abstract as AbstractEvent,\n  AbstractEventJson,\n} from './events_abstract.js';\nimport type {CommentCreate} from './events_comment_create.js';\nimport type {CommentDelete} from './events_comment_delete.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Abstract class for a comment event.\n */\nexport class CommentBase extends AbstractEvent {\n  override isBlank = true;\n\n  /** The ID of the comment that this event references. */\n  commentId?: string;\n\n  /**\n   * @param opt_comment The comment this event corresponds to.  Undefined for a\n   *     blank event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super();\n    /** Whether or not an event is blank. */\n    this.isBlank = !opt_comment;\n\n    if (!opt_comment) return;\n\n    this.commentId = opt_comment.id;\n    this.workspaceId = opt_comment.workspace.id;\n    this.group = eventUtils.getGroup();\n    this.recordUndo = eventUtils.getRecordUndo();\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentBaseJson {\n    const json = super.toJson() as CommentBaseJson;\n    if (!this.commentId) {\n      throw new Error(\n        'The comment ID is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['commentId'] = this.commentId;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentBase, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentBaseJson,\n    workspace: Workspace,\n    event?: any,\n  ): CommentBase {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentBase(),\n    ) as CommentBase;\n    newEvent.commentId = json['commentId'];\n    return newEvent;\n  }\n\n  /**\n   * Helper function for Comment[Create|Delete]\n   *\n   * @param event The event to run.\n   * @param create if True then Create, if False then Delete\n   */\n  static CommentCreateDeleteHelper(\n    event: CommentCreate | CommentDelete,\n    create: boolean,\n  ) {\n    const workspace = event.getEventWorkspace_();\n    if (create) {\n      if (!event.json) {\n        throw new Error('Encountered a comment event without proper json');\n      }\n      comments.append(event.json, workspace);\n    } else {\n      if (!event.commentId) {\n        throw new Error(\n          'The comment ID is undefined. Either pass a comment to ' +\n            'the constructor, or call fromJson',\n        );\n      }\n      const comment = workspace.getCommentById(event.commentId);\n      if (comment) {\n        comment.dispose();\n      } else {\n        console.warn(\"Can't delete non-existent comment: \" + event.commentId);\n      }\n    }\n  }\n}\n\nexport interface CommentBaseJson extends AbstractEventJson {\n  commentId: string;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment change event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.CommentChange\n\nimport * as registry from '../registry.js';\nimport type {WorkspaceComment} from '../comments/workspace_comment.js';\n\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that the contents of a workspace comment has changed.\n */\nexport class CommentChange extends CommentBase {\n  override type = eventUtils.COMMENT_CHANGE;\n\n  // TODO(#6774): We should remove underscores.\n  /** The previous contents of the comment. */\n  oldContents_?: string;\n\n  /** The new contents of the comment. */\n  newContents_?: string;\n\n  /**\n   * @param opt_comment The comment that is being changed.  Undefined for a\n   *     blank event.\n   * @param opt_oldContents Previous contents of the comment.\n   * @param opt_newContents New contents of the comment.\n   */\n  constructor(\n    opt_comment?: WorkspaceComment,\n    opt_oldContents?: string,\n    opt_newContents?: string,\n  ) {\n    super(opt_comment);\n\n    if (!opt_comment) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    this.oldContents_ =\n      typeof opt_oldContents === 'undefined' ? '' : opt_oldContents;\n    this.newContents_ =\n      typeof opt_newContents === 'undefined' ? '' : opt_newContents;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentChangeJson {\n    const json = super.toJson() as CommentChangeJson;\n    if (!this.oldContents_) {\n      throw new Error(\n        'The old contents is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.newContents_) {\n      throw new Error(\n        'The new contents is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['oldContents'] = this.oldContents_;\n    json['newContents'] = this.newContents_;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentChange, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentChangeJson,\n    workspace: Workspace,\n    event?: any,\n  ): CommentChange {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentChange(),\n    ) as CommentChange;\n    newEvent.oldContents_ = json['oldContents'];\n    newEvent.newContents_ = json['newContents'];\n    return newEvent;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return this.oldContents_ === this.newContents_;\n  }\n\n  /**\n   * Run a change event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.commentId) {\n      throw new Error(\n        'The comment ID is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    // TODO: Remove the cast when we fix the type of getCommentById.\n    const comment = workspace.getCommentById(\n      this.commentId,\n    ) as unknown as WorkspaceComment;\n    if (!comment) {\n      console.warn(\"Can't change non-existent comment: \" + this.commentId);\n      return;\n    }\n    const contents = forward ? this.newContents_ : this.oldContents_;\n    if (contents === undefined) {\n      if (forward) {\n        throw new Error(\n          'The new contents is undefined. Either pass a value to ' +\n            'the constructor, or call fromJson',\n        );\n      }\n      throw new Error(\n        'The old contents is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    comment.setText(contents);\n  }\n}\n\nexport interface CommentChangeJson extends CommentBaseJson {\n  oldContents: string;\n  newContents: string;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.COMMENT_CHANGE,\n  CommentChange,\n);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment creation event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.CommentCreate\n\nimport * as registry from '../registry.js';\nimport type {WorkspaceComment} from '../comments/workspace_comment.js';\nimport * as comments from '../serialization/workspace_comments.js';\nimport * as utilsXml from '../utils/xml.js';\nimport * as Xml from '../xml.js';\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a workspace comment was created.\n */\nexport class CommentCreate extends CommentBase {\n  override type = eventUtils.COMMENT_CREATE;\n\n  /** The XML representation of the created workspace comment. */\n  xml?: Element | DocumentFragment;\n\n  /** The JSON representation of the created workspace comment. */\n  json?: comments.State;\n\n  /**\n   * @param opt_comment The created comment.\n   *     Undefined for a blank event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super(opt_comment);\n\n    if (!opt_comment) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    this.xml = Xml.saveWorkspaceComment(opt_comment);\n    this.json = comments.save(opt_comment, {addCoordinates: true});\n  }\n\n  // TODO (#1266): \"Full\" and \"minimal\" serialization.\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentCreateJson {\n    const json = super.toJson() as CommentCreateJson;\n    if (!this.xml) {\n      throw new Error(\n        'The comment XML is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.json) {\n      throw new Error(\n        'The comment JSON is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['xml'] = Xml.domToText(this.xml);\n    json['json'] = this.json;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentCreate, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentCreateJson,\n    workspace: Workspace,\n    event?: any,\n  ): CommentCreate {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentCreate(),\n    ) as CommentCreate;\n    newEvent.xml = utilsXml.textToDom(json['xml']);\n    newEvent.json = json['json'];\n    return newEvent;\n  }\n\n  /**\n   * Run a creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    CommentBase.CommentCreateDeleteHelper(this, forward);\n  }\n}\n\nexport interface CommentCreateJson extends CommentBaseJson {\n  xml: string;\n  json: object;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.COMMENT_CREATE,\n  CommentCreate,\n);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment deletion event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.CommentDelete\n\nimport * as registry from '../registry.js';\nimport type {WorkspaceComment} from '../comments/workspace_comment.js';\nimport * as comments from '../serialization/workspace_comments.js';\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\nimport * as utilsXml from '../utils/xml.js';\nimport * as Xml from '../xml.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a workspace comment has been deleted.\n */\nexport class CommentDelete extends CommentBase {\n  override type = eventUtils.COMMENT_DELETE;\n\n  /** The XML representation of the deleted workspace comment. */\n  xml?: Element;\n\n  /** The JSON representation of the created workspace comment. */\n  json?: comments.State;\n\n  /**\n   * @param opt_comment The deleted comment.\n   *     Undefined for a blank event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super(opt_comment);\n\n    if (!opt_comment) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    this.xml = Xml.saveWorkspaceComment(opt_comment);\n    this.json = comments.save(opt_comment, {addCoordinates: true});\n  }\n\n  /**\n   * Run a creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    CommentBase.CommentCreateDeleteHelper(this, !forward);\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentDeleteJson {\n    const json = super.toJson() as CommentDeleteJson;\n    if (!this.xml) {\n      throw new Error(\n        'The comment XML is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.json) {\n      throw new Error(\n        'The comment JSON is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    json['xml'] = Xml.domToText(this.xml);\n    json['json'] = this.json;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentDelete, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentDeleteJson,\n    workspace: Workspace,\n    event?: any,\n  ): CommentDelete {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentDelete(),\n    ) as CommentDelete;\n    newEvent.xml = utilsXml.textToDom(json['xml']);\n    newEvent.json = json['json'];\n    return newEvent;\n  }\n}\n\nexport interface CommentDeleteJson extends CommentBaseJson {\n  xml: string;\n  json: object;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.COMMENT_DELETE,\n  CommentDelete,\n);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment move event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.CommentMove\n\nimport * as registry from '../registry.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport type {WorkspaceComment} from '../comments/workspace_comment.js';\n\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a workspace comment has moved.\n */\nexport class CommentMove extends CommentBase {\n  override type = eventUtils.COMMENT_MOVE;\n\n  /** The comment that is being moved. */\n  comment_?: WorkspaceComment;\n\n  // TODO(#6774): We should remove underscores.\n  /** The location of the comment before the move, in workspace coordinates. */\n  oldCoordinate_?: Coordinate;\n\n  /** The location of the comment after the move, in workspace coordinates. */\n  newCoordinate_?: Coordinate;\n\n  /**\n   * An explanation of what this move is for.  Known values include:\n   *  'drag' -- A drag operation completed.\n   *  'snap' -- Comment got shifted to line up with the grid.\n   *  'inbounds' -- Block got pushed back into a non-scrolling workspace.\n   *  'create' -- Block created via deserialization.\n   *  'cleanup' -- Workspace aligned top-level blocks.\n   * Event merging may create multiple reasons: ['drag', 'inbounds', 'snap'].\n   */\n  reason?: string[];\n\n  /**\n   * @param opt_comment The comment that is being moved.  Undefined for a blank\n   *     event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super(opt_comment);\n\n    if (!opt_comment) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    this.comment_ = opt_comment;\n    this.oldCoordinate_ = opt_comment.getRelativeToSurfaceXY();\n  }\n\n  /**\n   * Record the comment's new location.  Called after the move.  Can only be\n   * called once.\n   */\n  recordNew() {\n    if (this.newCoordinate_) {\n      throw Error(\n        'Tried to record the new position of a comment on the ' +\n          'same event twice.',\n      );\n    }\n    if (!this.comment_) {\n      throw new Error(\n        'The comment is undefined. Pass a comment to ' +\n          'the constructor if you want to use the record functionality',\n      );\n    }\n    this.newCoordinate_ = this.comment_.getRelativeToSurfaceXY();\n  }\n\n  /**\n   * Sets the reason for a move event.\n   *\n   * @param reason Why is this move happening?  'drag', 'bump', 'snap', ...\n   */\n  setReason(reason: string[]) {\n    this.reason = reason;\n  }\n\n  /**\n   * Override the location before the move.  Use this if you don't create the\n   * event until the end of the move, but you know the original location.\n   *\n   * @param xy The location before the move, in workspace coordinates.\n   */\n  setOldCoordinate(xy: Coordinate) {\n    this.oldCoordinate_ = xy;\n  }\n\n  // TODO (#1266): \"Full\" and \"minimal\" serialization.\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentMoveJson {\n    const json = super.toJson() as CommentMoveJson;\n    if (!this.oldCoordinate_) {\n      throw new Error(\n        'The old comment position is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    if (!this.newCoordinate_) {\n      throw new Error(\n        'The new comment position is undefined. Either call recordNew, or ' +\n          'call fromJson',\n      );\n    }\n    json['oldCoordinate'] =\n      `${Math.round(this.oldCoordinate_.x)}, ` +\n      `${Math.round(this.oldCoordinate_.y)}`;\n    json['newCoordinate'] =\n      Math.round(this.newCoordinate_.x) +\n      ',' +\n      Math.round(this.newCoordinate_.y);\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentMove, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentMoveJson,\n    workspace: Workspace,\n    event?: any,\n  ): CommentMove {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentMove(),\n    ) as CommentMove;\n    let xy = json['oldCoordinate'].split(',');\n    newEvent.oldCoordinate_ = new Coordinate(Number(xy[0]), Number(xy[1]));\n    xy = json['newCoordinate'].split(',');\n    newEvent.newCoordinate_ = new Coordinate(Number(xy[0]), Number(xy[1]));\n    return newEvent;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return Coordinate.equals(this.oldCoordinate_, this.newCoordinate_);\n  }\n\n  /**\n   * Run a move event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.commentId) {\n      throw new Error(\n        'The comment ID is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    // TODO: Remove cast when we update getCommentById.\n    const comment = workspace.getCommentById(\n      this.commentId,\n    ) as unknown as WorkspaceComment;\n    if (!comment) {\n      console.warn(\"Can't move non-existent comment: \" + this.commentId);\n      return;\n    }\n\n    const target = forward ? this.newCoordinate_ : this.oldCoordinate_;\n    if (!target) {\n      throw new Error(\n        'Either oldCoordinate_ or newCoordinate_ is undefined. ' +\n          'Either pass a comment to the constructor and call recordNew, ' +\n          'or call fromJson',\n      );\n    }\n    comment.moveTo(target);\n  }\n}\n\nexport interface CommentMoveJson extends CommentBaseJson {\n  oldCoordinate: string;\n  newCoordinate: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.COMMENT_MOVE, CommentMove);\n","/**\n * @license\n * Copyright 2024 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as registry from '../registry.js';\nimport {WorkspaceComment} from '../comments/workspace_comment.js';\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\nexport class CommentCollapse extends CommentBase {\n  override type = eventUtils.COMMENT_COLLAPSE;\n\n  constructor(\n    comment?: WorkspaceComment,\n    public newCollapsed?: boolean,\n  ) {\n    super(comment);\n\n    if (!comment) {\n      return; // Blank event to be populated by fromJson.\n    }\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentCollapseJson {\n    const json = super.toJson() as CommentCollapseJson;\n    if (this.newCollapsed === undefined) {\n      throw new Error(\n        'The new collapse value undefined. Either call recordNew, or ' +\n          'call fromJson',\n      );\n    }\n    json['newCollapsed'] = this.newCollapsed;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentCollapse, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentCollapseJson,\n    workspace: Workspace,\n    event?: any,\n  ): CommentCollapse {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentCollapse(),\n    ) as CommentCollapse;\n    newEvent.newCollapsed = json.newCollapsed;\n    return newEvent;\n  }\n\n  /**\n   * Run a collapse event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.commentId) {\n      throw new Error(\n        'The comment ID is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson',\n      );\n    }\n    // TODO: Remove cast when we update getCommentById.\n    const comment = workspace.getCommentById(\n      this.commentId,\n    ) as unknown as WorkspaceComment;\n    if (!comment) {\n      console.warn(\n        \"Can't collapse or uncollapse non-existent comment: \" + this.commentId,\n      );\n      return;\n    }\n\n    comment.setCollapsed(forward ? !!this.newCollapsed : !this.newCollapsed);\n  }\n}\n\nexport interface CommentCollapseJson extends CommentBaseJson {\n  newCollapsed: boolean;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.COMMENT_COLLAPSE,\n  CommentCollapse,\n);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of selecting an item on the toolbox.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.ToolboxItemSelect\n\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a toolbox item has been selected.\n */\nexport class ToolboxItemSelect extends UiBase {\n  /** The previously selected toolbox item. */\n  oldItem?: string;\n\n  /** The newly selected toolbox item. */\n  newItem?: string;\n\n  override type = eventUtils.TOOLBOX_ITEM_SELECT;\n\n  /**\n   * @param opt_oldItem The previously selected toolbox item.\n   *     Undefined for a blank event.\n   * @param opt_newItem The newly selected toolbox item. Undefined for a blank\n   *     event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   */\n  constructor(\n    opt_oldItem?: string | null,\n    opt_newItem?: string | null,\n    opt_workspaceId?: string,\n  ) {\n    super(opt_workspaceId);\n    this.oldItem = opt_oldItem ?? undefined;\n    this.newItem = opt_newItem ?? undefined;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): ToolboxItemSelectJson {\n    const json = super.toJson() as ToolboxItemSelectJson;\n    json['oldItem'] = this.oldItem;\n    json['newItem'] = this.newItem;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of ToolboxItemSelect, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: ToolboxItemSelectJson,\n    workspace: Workspace,\n    event?: any,\n  ): ToolboxItemSelect {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new ToolboxItemSelect(),\n    ) as ToolboxItemSelect;\n    newEvent.oldItem = json['oldItem'];\n    newEvent.newItem = json['newItem'];\n    return newEvent;\n  }\n}\n\nexport interface ToolboxItemSelectJson extends AbstractEventJson {\n  oldItem?: string;\n  newItem?: string;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.TOOLBOX_ITEM_SELECT,\n  ToolboxItemSelect,\n);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a finished loading workspace event.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Events.FinishedLoading\n\nimport * as registry from '../registry.js';\nimport type {Workspace} from '../workspace.js';\nimport {Abstract as AbstractEvent} from './events_abstract.js';\nimport * as eventUtils from './utils.js';\n\n/**\n * Notifies listeners when the workspace has finished deserializing from\n * JSON/XML.\n */\nexport class FinishedLoading extends AbstractEvent {\n  override isBlank = true;\n  override recordUndo = false;\n  override type = eventUtils.FINISHED_LOADING;\n\n  /**\n   * @param opt_workspace The workspace that has finished loading.  Undefined\n   *     for a blank event.\n   */\n  constructor(opt_workspace?: Workspace) {\n    super();\n    this.isBlank = !!opt_workspace;\n\n    if (!opt_workspace) return;\n\n    this.workspaceId = opt_workspace.id;\n  }\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.FINISHED_LOADING,\n  FinishedLoading,\n);\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Events\n\nimport {Abstract, AbstractEventJson} from './events_abstract.js';\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport {BlockChange, BlockChangeJson} from './events_block_change.js';\nimport {BlockCreate, BlockCreateJson} from './events_block_create.js';\nimport {BlockDelete, BlockDeleteJson} from './events_block_delete.js';\nimport {BlockDrag, BlockDragJson} from './events_block_drag.js';\nimport {\n  BlockFieldIntermediateChange,\n  BlockFieldIntermediateChangeJson,\n} from './events_block_field_intermediate_change.js';\nimport {BlockMove, BlockMoveJson} from './events_block_move.js';\nimport {BubbleOpen, BubbleOpenJson, BubbleType} from './events_bubble_open.js';\nimport {Click, ClickJson, ClickTarget} from './events_click.js';\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport {CommentChange, CommentChangeJson} from './events_comment_change.js';\nimport {CommentCreate, CommentCreateJson} from './events_comment_create.js';\nimport {CommentDelete} from './events_comment_delete.js';\nimport {CommentMove, CommentMoveJson} from './events_comment_move.js';\nimport {\n  CommentCollapse,\n  CommentCollapseJson,\n} from './events_comment_collapse.js';\nimport {MarkerMove, MarkerMoveJson} from './events_marker_move.js';\nimport {Selected, SelectedJson} from './events_selected.js';\nimport {ThemeChange, ThemeChangeJson} from './events_theme_change.js';\nimport {\n  ToolboxItemSelect,\n  ToolboxItemSelectJson,\n} from './events_toolbox_item_select.js';\nimport {TrashcanOpen, TrashcanOpenJson} from './events_trashcan_open.js';\nimport {UiBase} from './events_ui_base.js';\nimport {VarBase, VarBaseJson} from './events_var_base.js';\nimport {VarCreate, VarCreateJson} from './events_var_create.js';\nimport {VarDelete, VarDeleteJson} from './events_var_delete.js';\nimport {VarRename, VarRenameJson} from './events_var_rename.js';\nimport {ViewportChange, ViewportChangeJson} from './events_viewport.js';\nimport * as eventUtils from './utils.js';\nimport {FinishedLoading} from './workspace_events.js';\n\n// Events.\nexport {Abstract};\nexport {AbstractEventJson};\nexport {BubbleOpen};\nexport {BubbleOpenJson};\nexport {BubbleType};\nexport {BlockBase};\nexport {BlockBaseJson};\nexport {BlockChange};\nexport {BlockChangeJson};\nexport {BlockCreate};\nexport {BlockCreateJson};\nexport {BlockDelete};\nexport {BlockDeleteJson};\nexport {BlockDrag};\nexport {BlockDragJson};\nexport {BlockFieldIntermediateChange};\nexport {BlockFieldIntermediateChangeJson};\nexport {BlockMove};\nexport {BlockMoveJson};\nexport {Click};\nexport {ClickJson};\nexport {ClickTarget};\nexport {CommentBase};\nexport {CommentBaseJson};\nexport {CommentChange};\nexport {CommentChangeJson};\nexport {CommentCreate};\nexport {CommentCreateJson};\nexport {CommentDelete};\nexport {CommentMove};\nexport {CommentMoveJson};\nexport {CommentCollapse};\nexport {CommentCollapseJson};\nexport {FinishedLoading};\nexport {MarkerMove};\nexport {MarkerMoveJson};\nexport {Selected};\nexport {SelectedJson};\nexport {ThemeChange};\nexport {ThemeChangeJson};\nexport {ToolboxItemSelect};\nexport {ToolboxItemSelectJson};\nexport {TrashcanOpen};\nexport {TrashcanOpenJson};\nexport {UiBase};\nexport {VarBase};\nexport {VarBaseJson};\nexport {VarCreate};\nexport {VarCreateJson};\nexport {VarDelete};\nexport {VarDeleteJson};\nexport {VarRename};\nexport {VarRenameJson};\nexport {ViewportChange};\nexport {ViewportChangeJson};\n\n// Event types.\nexport const BLOCK_CHANGE = eventUtils.BLOCK_CHANGE;\nexport const BLOCK_CREATE = eventUtils.BLOCK_CREATE;\nexport const BLOCK_DELETE = eventUtils.BLOCK_DELETE;\nexport const BLOCK_DRAG = eventUtils.BLOCK_DRAG;\nexport const BLOCK_MOVE = eventUtils.BLOCK_MOVE;\nexport const BLOCK_FIELD_INTERMEDIATE_CHANGE =\n  eventUtils.BLOCK_FIELD_INTERMEDIATE_CHANGE;\nexport const BUBBLE_OPEN = eventUtils.BUBBLE_OPEN;\nexport type BumpEvent = eventUtils.BumpEvent;\nexport const BUMP_EVENTS = eventUtils.BUMP_EVENTS;\nexport const CHANGE = eventUtils.CHANGE;\nexport const CLICK = eventUtils.CLICK;\nexport const COMMENT_CHANGE = eventUtils.COMMENT_CHANGE;\nexport const COMMENT_CREATE = eventUtils.COMMENT_CREATE;\nexport const COMMENT_DELETE = eventUtils.COMMENT_DELETE;\nexport const COMMENT_MOVE = eventUtils.COMMENT_MOVE;\nexport const CREATE = eventUtils.CREATE;\nexport const DELETE = eventUtils.DELETE;\nexport const FINISHED_LOADING = eventUtils.FINISHED_LOADING;\nexport const MARKER_MOVE = eventUtils.MARKER_MOVE;\nexport const MOVE = eventUtils.MOVE;\nexport const SELECTED = eventUtils.SELECTED;\nexport const THEME_CHANGE = eventUtils.THEME_CHANGE;\nexport const TOOLBOX_ITEM_SELECT = eventUtils.TOOLBOX_ITEM_SELECT;\nexport const TRASHCAN_OPEN = eventUtils.TRASHCAN_OPEN;\nexport const UI = eventUtils.UI;\nexport const VAR_CREATE = eventUtils.VAR_CREATE;\nexport const VAR_DELETE = eventUtils.VAR_DELETE;\nexport const VAR_RENAME = eventUtils.VAR_RENAME;\nexport const VIEWPORT_CHANGE = eventUtils.VIEWPORT_CHANGE;\n\n// Event utils.\nexport const clearPendingUndo = eventUtils.clearPendingUndo;\nexport const disable = eventUtils.disable;\nexport const enable = eventUtils.enable;\nexport const filter = eventUtils.filter;\nexport const fire = eventUtils.fire;\nexport const fromJson = eventUtils.fromJson;\nexport const getDescendantIds = eventUtils.getDescendantIds;\nexport const get = eventUtils.get;\nexport const getGroup = eventUtils.getGroup;\nexport const getRecordUndo = eventUtils.getRecordUndo;\nexport const isEnabled = eventUtils.isEnabled;\nexport const setGroup = eventUtils.setGroup;\nexport const setRecordUndo = eventUtils.setRecordUndo;\nexport const disableOrphans = eventUtils.disableOrphans;\n","/** @file Re-exports of Blockly.zelos.* modules. */\n\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.zelos\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {BottomRow} from './measurables/bottom_row.js';\nimport {StatementInput} from './measurables/inputs.js';\nimport {RightConnectionShape} from './measurables/row_elements.js';\nimport {TopRow} from './measurables/top_row.js';\nimport {PathObject} from './path_object.js';\nimport {Renderer} from './renderer.js';\n\nexport {\n  BottomRow,\n  ConstantProvider,\n  Drawer,\n  MarkerSvg,\n  PathObject,\n  Renderer,\n  RenderInfo,\n  RightConnectionShape,\n  StatementInput,\n  TopRow,\n};\n","/**\n * @license\n * Copyright 2024 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport {CommentView} from './comments/comment_view.js';\nexport {WorkspaceComment} from './comments/workspace_comment.js';\nexport {RenderedWorkspaceComment} from './comments/rendered_workspace_comment.js';\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Bubble} from './bubbles/bubble.js';\nimport {TextBubble} from './bubbles/text_bubble.js';\nimport {TextInputBubble} from './bubbles/textinput_bubble.js';\nimport {MiniWorkspaceBubble} from './bubbles/mini_workspace_bubble.js';\n\nexport {Bubble, TextBubble, TextInputBubble, MiniWorkspaceBubble};\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.BlocklyOptions\n\nimport type {Theme, ITheme} from './theme.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport type {ToolboxDefinition} from './utils/toolbox.js';\n\n/**\n * Blockly options.\n */\nexport interface BlocklyOptions {\n  collapse?: boolean;\n  comments?: boolean;\n  css?: boolean;\n  disable?: boolean;\n  grid?: GridOptions;\n  horizontalLayout?: boolean;\n  maxBlocks?: number;\n  maxInstances?: {[blockType: string]: number};\n  media?: string;\n  modalInputs?: boolean;\n  move?: MoveOptions;\n  oneBasedIndex?: boolean;\n  readOnly?: boolean;\n  renderer?: string;\n  rendererOverrides?: {[rendererConstant: string]: any};\n  rtl?: boolean;\n  scrollbars?: ScrollbarOptions | boolean;\n  sounds?: boolean;\n  theme?: Theme | string | ITheme;\n  toolbox?: string | ToolboxDefinition | Element;\n  toolboxPosition?: string;\n  trashcan?: boolean;\n  maxTrashcanContents?: number;\n  plugins?: {[key: string]: (new (...p1: any[]) => any) | string};\n  zoom?: ZoomOptions;\n  parentWorkspace?: WorkspaceSvg;\n}\n\nexport interface GridOptions {\n  colour?: string;\n  length?: number;\n  snap?: boolean;\n  spacing?: number;\n}\n\nexport interface MoveOptions {\n  drag?: boolean;\n  scrollbars?: boolean | ScrollbarOptions;\n  wheel?: boolean;\n}\n\nexport interface ScrollbarOptions {\n  horizontal?: boolean;\n  vertical?: boolean;\n}\n\nexport interface ZoomOptions {\n  controls?: boolean;\n  maxScale?: number;\n  minScale?: number;\n  pinch?: boolean;\n  scaleSpeed?: number;\n  startScale?: number;\n  wheel?: boolean;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.ConstantProvider\n\nimport {ConstantProvider as BaseConstantProvider} from '../common/constants.js';\n\n/**\n * An object that provides constants for rendering blocks in Geras mode.\n */\nexport class ConstantProvider extends BaseConstantProvider {\n  override FIELD_TEXT_BASELINE_CENTER = false;\n\n  // The dark/shadow path in classic rendering is the same as the normal block\n  // path, but translated down one and right one.\n  DARK_PATH_OFFSET = 1;\n\n  /**\n   * The maximum width of a bottom row that follows a statement input and has\n   * inputs inline.\n   */\n  MAX_BOTTOM_WIDTH = 30;\n  override STATEMENT_BOTTOM_SPACER = -this.NOTCH_HEIGHT / 2;\n\n  constructor() {\n    super();\n  }\n\n  override getCSS_(selector: string) {\n    return super.getCSS_(selector).concat([\n      /* eslint-disable indent */\n      /* clang-format off */\n      // Insertion marker.\n      `${selector} .blocklyInsertionMarker>.blocklyPathLight,`,\n      `${selector} .blocklyInsertionMarker>.blocklyPathDark {`,\n      `fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,\n      `stroke: none;`,\n      '}',\n      /* clang-format on */\n      /* eslint-enable indent */\n    ]);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.Highlighter\n\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {ConstantProvider} from '../common/constants.js';\nimport type {BottomRow} from '../measurables/bottom_row.js';\nimport type {Row} from '../measurables/row.js';\nimport {SpacerRow} from '../measurables/spacer_row.js';\nimport type {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {\n  HighlightConstantProvider,\n  InsideCorner,\n  JaggedTeeth,\n  Notch,\n  OutsideCorner,\n  PuzzleTab,\n  StartHat,\n} from './highlight_constants.js';\nimport type {RenderInfo} from './info.js';\nimport type {InlineInput} from './measurables/inline_input.js';\n\n/**\n * An object that adds highlights to a block based on the given rendering\n * information.\n *\n * Highlighting is interesting because the highlights do not fully enclose the\n * block.  Instead, they are positioned based on a light source in the top left.\n * This means that rendering highlights requires exact information about the\n * position of each part of the block.  The resulting paths are not continuous\n * or closed paths.  The highlights for tabs and notches are loosely based on\n * tab and notch shapes, but are not exactly the same.\n */\nexport class Highlighter {\n  info_: RenderInfo;\n  steps_ = '';\n  inlineSteps_ = '';\n  RTL_: boolean;\n  constants_: ConstantProvider;\n  highlightConstants_: HighlightConstantProvider;\n  private readonly highlightOffset: number;\n  outsideCornerPaths_: OutsideCorner;\n  insideCornerPaths_: InsideCorner;\n  puzzleTabPaths_: PuzzleTab;\n  notchPaths_: Notch;\n  startPaths_: StartHat;\n  jaggedTeethPaths_: JaggedTeeth;\n\n  /**\n   * @param info An object containing all information needed to render this\n   *     block.\n   */\n  constructor(info: RenderInfo) {\n    this.info_ = info;\n\n    this.RTL_ = this.info_.RTL;\n\n    const renderer = info.getRenderer();\n\n    /** The renderer's constant provider. */\n    this.constants_ = renderer.getConstants();\n\n    this.highlightConstants_ = renderer.getHighlightConstants();\n    /** The offset between the block's main path and highlight path. */\n    this.highlightOffset = this.highlightConstants_.OFFSET;\n\n    this.outsideCornerPaths_ = this.highlightConstants_.OUTSIDE_CORNER;\n    this.insideCornerPaths_ = this.highlightConstants_.INSIDE_CORNER;\n    this.puzzleTabPaths_ = this.highlightConstants_.PUZZLE_TAB;\n    this.notchPaths_ = this.highlightConstants_.NOTCH;\n    this.startPaths_ = this.highlightConstants_.START_HAT;\n    this.jaggedTeethPaths_ = this.highlightConstants_.JAGGED_TEETH;\n  }\n\n  /**\n   * Get the steps for the highlight path.\n   *\n   * @returns The steps for the highlight path.\n   */\n  getPath(): string {\n    return this.steps_ + '\\n' + this.inlineSteps_;\n  }\n\n  /**\n   * Add a highlight to the top corner of a block.\n   *\n   * @param row The top row of the block.\n   */\n  drawTopCorner(row: TopRow) {\n    this.steps_ += svgPaths.moveBy(row.xPos, this.info_.startY);\n    for (let i = 0, elem; (elem = row.elements[i]); i++) {\n      if (Types.isLeftSquareCorner(elem)) {\n        this.steps_ += this.highlightConstants_.START_POINT;\n      } else if (Types.isLeftRoundedCorner(elem)) {\n        this.steps_ += this.outsideCornerPaths_.topLeft(this.RTL_);\n      } else if (Types.isPreviousConnection(elem)) {\n        this.steps_ += this.notchPaths_.pathLeft;\n      } else if (Types.isHat(elem)) {\n        this.steps_ += this.startPaths_.path(this.RTL_);\n      } else if (Types.isSpacer(elem) && elem.width !== 0) {\n        // The end point of the spacer needs to be offset by the highlight\n        // amount. So instead of using the spacer's width for a relative\n        // horizontal, use its width and position for an absolute horizontal\n        // move.\n        this.steps_ += svgPaths.lineOnAxis(\n          'H',\n          elem.xPos + elem.width - this.highlightOffset,\n        );\n      }\n    }\n\n    const right = row.xPos + row.width - this.highlightOffset;\n    this.steps_ += svgPaths.lineOnAxis('H', right);\n  }\n\n  /**\n   * Add a highlight on a jagged edge for a collapsed block.\n   *\n   * @param row  The row to highlight.\n   */\n  drawJaggedEdge_(row: Row) {\n    if (this.info_.RTL) {\n      const remainder =\n        row.height - this.jaggedTeethPaths_.height - this.highlightOffset;\n      this.steps_ +=\n        this.jaggedTeethPaths_.pathLeft + svgPaths.lineOnAxis('v', remainder);\n    }\n  }\n\n  /**\n   * Add a highlight on a value input.\n   *\n   * @param row The row the input belongs to.\n   */\n  drawValueInput(row: Row) {\n    const input = row.getLastInput() as InlineInput;\n    if (this.RTL_) {\n      const belowTabHeight = row.height - input.connectionHeight;\n\n      this.steps_ +=\n        svgPaths.moveTo(\n          input.xPos + input.width - this.highlightOffset,\n          row.yPos,\n        ) +\n        this.puzzleTabPaths_.pathDown(this.RTL_) +\n        svgPaths.lineOnAxis('v', belowTabHeight);\n    } else {\n      this.steps_ +=\n        svgPaths.moveTo(input.xPos + input.width, row.yPos) +\n        this.puzzleTabPaths_.pathDown(this.RTL_);\n    }\n  }\n\n  /**\n   * Add a highlight on a statement input.\n   *\n   * @param row The row to highlight.\n   */\n  drawStatementInput(row: Row) {\n    const input = row.getLastInput();\n    if (!input) return;\n    if (this.RTL_) {\n      const innerHeight = row.height - 2 * this.insideCornerPaths_.height;\n      this.steps_ +=\n        svgPaths.moveTo(input.xPos, row.yPos) +\n        this.insideCornerPaths_.pathTop(this.RTL_) +\n        svgPaths.lineOnAxis('v', innerHeight) +\n        this.insideCornerPaths_.pathBottom(this.RTL_) +\n        svgPaths.lineTo(\n          row.width - input.xPos - this.insideCornerPaths_.width,\n          0,\n        );\n    } else {\n      this.steps_ +=\n        svgPaths.moveTo(input.xPos, row.yPos + row.height) +\n        this.insideCornerPaths_.pathBottom(this.RTL_) +\n        svgPaths.lineTo(\n          row.width - input.xPos - this.insideCornerPaths_.width,\n          0,\n        );\n    }\n  }\n\n  /**\n   * Add a highlight on the right side of a row.\n   *\n   * @param row The row to highlight.\n   */\n  drawRightSideRow(row: Row) {\n    const rightEdge = row.xPos + row.width - this.highlightOffset;\n    if (row instanceof SpacerRow && row.followsStatement) {\n      this.steps_ += svgPaths.lineOnAxis('H', rightEdge);\n    }\n    if (this.RTL_) {\n      this.steps_ += svgPaths.lineOnAxis('H', rightEdge);\n      if (row.height > this.highlightOffset) {\n        this.steps_ += svgPaths.lineOnAxis(\n          'V',\n          row.yPos + row.height - this.highlightOffset,\n        );\n      }\n    }\n  }\n\n  /**\n   * Add a highlight to the bottom row.\n   *\n   * @param row The row to highlight.\n   */\n  drawBottomRow(row: BottomRow) {\n    // Highlight the vertical edge of the bottom row on the input side.\n    // Highlighting is always from the top left, both in LTR and RTL.\n    if (this.RTL_) {\n      this.steps_ += svgPaths.lineOnAxis(\n        'V',\n        row.baseline - this.highlightOffset,\n      );\n    } else {\n      const cornerElem = this.info_.bottomRow.elements[0];\n      if (Types.isLeftSquareCorner(cornerElem)) {\n        this.steps_ += svgPaths.moveTo(\n          row.xPos + this.highlightOffset,\n          row.baseline - this.highlightOffset,\n        );\n      } else if (Types.isLeftRoundedCorner(cornerElem)) {\n        this.steps_ += svgPaths.moveTo(row.xPos, row.baseline);\n        this.steps_ += this.outsideCornerPaths_.bottomLeft();\n      }\n    }\n  }\n\n  /**\n   * Draw the highlight on the left side of the block.\n   */\n  drawLeft() {\n    const outputConnection = this.info_.outputConnection;\n    if (outputConnection) {\n      const tabBottom =\n        outputConnection.connectionOffsetY + outputConnection.height;\n      // Draw a line up to the bottom of the tab.\n      if (this.RTL_) {\n        this.steps_ += svgPaths.moveTo(this.info_.startX, tabBottom);\n      } else {\n        const left = this.info_.startX + this.highlightOffset;\n        const bottom = this.info_.bottomRow.baseline - this.highlightOffset;\n        this.steps_ += svgPaths.moveTo(left, bottom);\n        this.steps_ += svgPaths.lineOnAxis('V', tabBottom);\n      }\n      this.steps_ += this.puzzleTabPaths_.pathUp(this.RTL_);\n    }\n\n    if (!this.RTL_) {\n      const topRow = this.info_.topRow;\n      if (Types.isLeftRoundedCorner(topRow.elements[0])) {\n        this.steps_ += svgPaths.lineOnAxis(\n          'V',\n          this.outsideCornerPaths_.height,\n        );\n      } else {\n        this.steps_ += svgPaths.lineOnAxis(\n          'V',\n          topRow.capline + this.highlightOffset,\n        );\n      }\n    }\n  }\n\n  /**\n   * Add a highlight to an inline input.\n   *\n   * @param input The input to highlight.\n   */\n  drawInlineInput(input: InlineInput) {\n    const offset = this.highlightOffset;\n\n    // Relative to the block's left.\n    const connectionRight = input.xPos + input.connectionWidth;\n    const yPos = input.centerline - input.height / 2;\n    const bottomHighlightWidth = input.width - input.connectionWidth;\n    const startY = yPos + offset;\n\n    if (this.RTL_) {\n      const aboveTabHeight = input.connectionOffsetY - offset;\n      const belowTabHeight =\n        input.height -\n        (input.connectionOffsetY + input.connectionHeight) +\n        offset;\n\n      const startX = connectionRight - offset;\n\n      this.inlineSteps_ +=\n        svgPaths.moveTo(startX, startY) + // Right edge above tab.\n        svgPaths.lineOnAxis('v', aboveTabHeight) + // Back of tab.\n        this.puzzleTabPaths_.pathDown(this.RTL_) + // Right edge below tab.\n        svgPaths.lineOnAxis('v', belowTabHeight) + // Bottom.\n        svgPaths.lineOnAxis('h', bottomHighlightWidth);\n    } else {\n      this.inlineSteps_ += // Go to top right corner.\n        svgPaths.moveTo(input.xPos + input.width + offset, startY) + // Highlight right edge, bottom.\n        svgPaths.lineOnAxis('v', input.height) +\n        svgPaths.lineOnAxis('h', -bottomHighlightWidth) + // Go to top of tab.\n        svgPaths.moveTo(connectionRight, yPos + input.connectionOffsetY) + // Short highlight glint at\n        // bottom of tab.\n        this.puzzleTabPaths_.pathDown(this.RTL_);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.Drawer\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport {Drawer as BaseDrawer} from '../common/drawer.js';\nimport type {Row} from '../measurables/row.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport {Highlighter} from './highlighter.js';\nimport type {RenderInfo} from './info.js';\nimport type {InlineInput} from './measurables/inline_input.js';\nimport type {PathObject} from './path_object.js';\n\n/**\n * An object that draws a block based on the given rendering information,\n * customized for the geras renderer.\n */\nexport class Drawer extends BaseDrawer {\n  highlighter_: Highlighter;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override constants_!: ConstantProvider;\n\n  /**\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   */\n  constructor(block: BlockSvg, info: RenderInfo) {\n    super(block, info);\n    // Unlike Thrasos, Geras has highlights and drop shadows.\n    this.highlighter_ = new Highlighter(info);\n  }\n\n  override draw() {\n    this.drawOutline_();\n    this.drawInternals_();\n    this.updateConnectionHighlights();\n\n    const pathObject = this.block_.pathObject as PathObject;\n    pathObject.setPath(this.outlinePath_ + '\\n' + this.inlinePath_);\n    pathObject.setHighlightPath(this.highlighter_.getPath());\n    if (this.info_.RTL) {\n      pathObject.flipRTL();\n    }\n    this.recordSizeOnBlock_();\n  }\n\n  override drawTop_() {\n    this.highlighter_.drawTopCorner(this.info_.topRow);\n    this.highlighter_.drawRightSideRow(this.info_.topRow);\n\n    super.drawTop_();\n  }\n\n  override drawJaggedEdge_(row: Row) {\n    this.highlighter_.drawJaggedEdge_(row);\n\n    super.drawJaggedEdge_(row);\n  }\n\n  override drawValueInput_(row: Row) {\n    this.highlighter_.drawValueInput(row);\n\n    super.drawValueInput_(row);\n  }\n\n  override drawStatementInput_(row: Row) {\n    this.highlighter_.drawStatementInput(row);\n\n    super.drawStatementInput_(row);\n  }\n\n  override drawRightSideRow_(row: Row) {\n    this.highlighter_.drawRightSideRow(row);\n\n    this.outlinePath_ +=\n      svgPaths.lineOnAxis('H', row.xPos + row.width) +\n      svgPaths.lineOnAxis('V', row.yPos + row.height);\n  }\n\n  override drawBottom_() {\n    this.highlighter_.drawBottomRow(this.info_.bottomRow);\n\n    super.drawBottom_();\n  }\n\n  /**\n   * Add steps for the left side of the block, which may include an output\n   * connection\n   */\n  protected override drawLeft_() {\n    this.highlighter_.drawLeft();\n\n    super.drawLeft_();\n  }\n\n  override drawInlineInput_(input: InlineInput) {\n    this.highlighter_.drawInlineInput(input as InlineInput);\n\n    super.drawInlineInput_(input);\n  }\n\n  override positionInlineInputConnection_(input: InlineInput) {\n    const yPos = input.centerline - input.height / 2;\n    // Move the connection.\n    if (input.connectionModel) {\n      // xPos already contains info about startX\n      let connX =\n        input.xPos + input.connectionWidth + this.constants_.DARK_PATH_OFFSET;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(\n        connX,\n        yPos + input.connectionOffsetY + this.constants_.DARK_PATH_OFFSET,\n      );\n    }\n  }\n\n  override positionStatementInputConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input?.connectionModel) {\n      let connX = row.xPos + row.statementEdge + input.notchOffset;\n      if (this.info_.RTL) {\n        connX *= -1;\n      } else {\n        connX += this.constants_.DARK_PATH_OFFSET;\n      }\n      input.connectionModel.setOffsetInBlock(\n        connX,\n        row.yPos + this.constants_.DARK_PATH_OFFSET,\n      );\n    }\n  }\n\n  override positionExternalValueConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input && input.connectionModel) {\n      let connX = row.xPos + row.width + this.constants_.DARK_PATH_OFFSET;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(connX, row.yPos);\n    }\n  }\n\n  override positionNextConnection_() {\n    const bottomRow = this.info_.bottomRow;\n\n    if (bottomRow.connection) {\n      const connInfo = bottomRow.connection;\n      const x = connInfo.xPos; // Already contains info about startX.\n      const connX =\n        (this.info_.RTL ? -x : x) + this.constants_.DARK_PATH_OFFSET / 2;\n      connInfo.connectionModel.setOffsetInBlock(\n        connX,\n        bottomRow.baseline + this.constants_.DARK_PATH_OFFSET,\n      );\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.HighlightConstantProvider\n\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\n/** An object containing sizing and path information about an outside corner. */\nexport interface OutsideCorner {\n  height: number;\n  topLeft: (p1: boolean) => string;\n  bottomLeft: () => string;\n}\n\n/** An object containing sizing and path information about an inside corner. */\nexport interface InsideCorner {\n  width: number;\n  height: number;\n  pathTop: (p1: boolean) => string;\n  pathBottom: (p1: boolean) => string;\n}\n\n/** An object containing sizing and path information about a start hat. */\nexport interface StartHat {\n  path: (p1: boolean) => string;\n}\n\n/** An object containing sizing and path information about a notch. */\nexport interface Notch {\n  pathLeft: string;\n}\n\n/** An object containing sizing and path information about a puzzle tab. */\nexport interface PuzzleTab {\n  width: number;\n  height: number;\n  pathDown: (p1: boolean) => string;\n  pathUp: (p1: boolean) => string;\n}\n\n/**\n * An object containing sizing and path information about collapsed block\n * indicators.\n */\nexport interface JaggedTeeth {\n  height: number;\n  width: number;\n  pathLeft: string;\n}\n\n/**\n * An object that provides constants for rendering highlights on blocks.\n * Some highlights are simple offsets of the parent paths and can be generated\n * programmatically.  Others, especially on curves, are just made out of piles\n * of constants and are hard to tweak.\n */\nexport class HighlightConstantProvider {\n  constantProvider: ConstantProvider;\n\n  /** The offset between the block's main path and highlight path. */\n  OFFSET = 0.5;\n  START_POINT: string;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  INSIDE_CORNER!: InsideCorner;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  OUTSIDE_CORNER!: OutsideCorner;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  PUZZLE_TAB!: PuzzleTab;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  NOTCH!: Notch;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  JAGGED_TEETH!: JaggedTeeth;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  START_HAT!: StartHat;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    /** The renderer's constant provider. */\n    this.constantProvider = constants;\n\n    /**\n     * The start point, which is offset in both X and Y, as an SVG path chunk.\n     */\n    this.START_POINT = svgPaths.moveBy(this.OFFSET, this.OFFSET);\n  }\n\n  /**\n   * Initialize shape objects based on the constants set in the constructor.\n   */\n  init() {\n    /**\n     * An object containing sizing and path information about inside corner\n     * highlights.\n     */\n    this.INSIDE_CORNER = this.makeInsideCorner();\n\n    /**\n     * An object containing sizing and path information about outside corner\n     * highlights.\n     */\n    this.OUTSIDE_CORNER = this.makeOutsideCorner();\n\n    /**\n     * An object containing sizing and path information about puzzle tab\n     * highlights.\n     */\n    this.PUZZLE_TAB = this.makePuzzleTab();\n\n    /**\n     * An object containing sizing and path information about notch highlights.\n     */\n    this.NOTCH = this.makeNotch();\n\n    /**\n     * An object containing sizing and path information about highlights for\n     * collapsed block indicators.\n     */\n    this.JAGGED_TEETH = this.makeJaggedTeeth();\n\n    /**\n     * An object containing sizing and path information about start hat\n     * highlights.\n     */\n    this.START_HAT = this.makeStartHat();\n  }\n\n  /**\n   * @returns An object containing sizing and path information about inside\n   *     corner highlights.\n   */\n  protected makeInsideCorner(): InsideCorner {\n    const radius = this.constantProvider.CORNER_RADIUS;\n    const offset = this.OFFSET;\n\n    /**\n     * Distance from shape edge to intersect with a curved corner at 45 degrees.\n     * Applies to highlighting on around the outside of a curve.\n     */\n    const distance45outside = (1 - Math.SQRT1_2) * (radius + offset) - offset;\n\n    const pathTopRtl =\n      svgPaths.moveBy(distance45outside, distance45outside) +\n      svgPaths.arc(\n        'a',\n        '0 0,0',\n        radius,\n        svgPaths.point(-distance45outside - offset, radius - distance45outside),\n      );\n\n    const pathBottomRtl = svgPaths.arc(\n      'a',\n      '0 0,0',\n      radius + offset,\n      svgPaths.point(radius + offset, radius + offset),\n    );\n\n    const pathBottomLtr =\n      svgPaths.moveBy(distance45outside, -distance45outside) +\n      svgPaths.arc(\n        'a',\n        '0 0,0',\n        radius + offset,\n        svgPaths.point(radius - distance45outside, distance45outside + offset),\n      );\n\n    return {\n      width: radius + offset,\n      height: radius,\n      pathTop(rtl) {\n        return rtl ? pathTopRtl : '';\n      },\n      pathBottom(rtl) {\n        return rtl ? pathBottomRtl : pathBottomLtr;\n      },\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about outside\n   *     corner highlights.\n   */\n  protected makeOutsideCorner(): OutsideCorner {\n    const radius = this.constantProvider.CORNER_RADIUS;\n    const offset = this.OFFSET;\n\n    /**\n     * Distance from shape edge to intersect with a curved corner at 45 degrees.\n     * Applies to highlighting on around the inside of a curve.\n     */\n    const distance45inside = (1 - Math.SQRT1_2) * (radius - offset) + offset;\n\n    const topLeftStartX = distance45inside;\n    const topLeftStartY = distance45inside;\n    const topLeftCornerHighlightRtl =\n      svgPaths.moveBy(topLeftStartX, topLeftStartY) +\n      svgPaths.arc(\n        'a',\n        '0 0,1',\n        radius - offset,\n        svgPaths.point(radius - topLeftStartX, -topLeftStartY + offset),\n      );\n    /**\n     * SVG path for drawing the highlight on the rounded top-left corner.\n     */\n    const topLeftCornerHighlightLtr =\n      svgPaths.moveBy(offset, radius) +\n      svgPaths.arc(\n        'a',\n        '0 0,1',\n        radius - offset,\n        svgPaths.point(radius, -radius + offset),\n      );\n\n    const bottomLeftStartX = distance45inside;\n    const bottomLeftStartY = -distance45inside;\n    const bottomLeftPath =\n      svgPaths.moveBy(bottomLeftStartX, bottomLeftStartY) +\n      svgPaths.arc(\n        'a',\n        '0 0,1',\n        radius - offset,\n        svgPaths.point(-bottomLeftStartX + offset, -bottomLeftStartY - radius),\n      );\n\n    return {\n      height: radius,\n      topLeft(rtl) {\n        return rtl ? topLeftCornerHighlightRtl : topLeftCornerHighlightLtr;\n      },\n      bottomLeft() {\n        return bottomLeftPath;\n      },\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about puzzle tab\n   *     highlights.\n   */\n  protected makePuzzleTab(): PuzzleTab {\n    const width = this.constantProvider.TAB_WIDTH;\n    const height = this.constantProvider.TAB_HEIGHT;\n\n    // This is how much of the vertical block edge is actually drawn by the\n    // puzzle tab.\n    const verticalOverlap = 2.5;\n\n    const highlightRtlUp =\n      svgPaths.moveBy(-2, -height + verticalOverlap + 0.9) +\n      svgPaths.lineTo(width * -0.45, -2.1);\n\n    const highlightRtlDown =\n      svgPaths.lineOnAxis('v', verticalOverlap) +\n      svgPaths.moveBy(-width * 0.97, 2.5) +\n      svgPaths.curve('q', [\n        svgPaths.point(-width * 0.05, 10),\n        svgPaths.point(width * 0.3, 9.5),\n      ]) +\n      svgPaths.moveBy(width * 0.67, -1.9) +\n      svgPaths.lineOnAxis('v', verticalOverlap);\n\n    const highlightLtrUp =\n      svgPaths.lineOnAxis('v', -1.5) +\n      svgPaths.moveBy(width * -0.92, -0.5) +\n      svgPaths.curve('q', [\n        svgPaths.point(width * -0.19, -5.5),\n        svgPaths.point(0, -11),\n      ]) +\n      svgPaths.moveBy(width * 0.92, 1);\n\n    const highlightLtrDown =\n      svgPaths.moveBy(-5, height - 0.7) + svgPaths.lineTo(width * 0.46, -2.1);\n\n    return {\n      width,\n      height,\n      pathUp(rtl) {\n        return rtl ? highlightRtlUp : highlightLtrUp;\n      },\n      pathDown(rtl) {\n        return rtl ? highlightRtlDown : highlightLtrDown;\n      },\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about notch\n   *     highlights.\n   */\n  protected makeNotch(): Notch {\n    // This is only for the previous connection.\n    const pathLeft =\n      svgPaths.lineOnAxis('h', this.OFFSET) +\n      this.constantProvider.NOTCH.pathLeft;\n    return {pathLeft};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about collapsed\n   *     block edge highlights.\n   */\n  protected makeJaggedTeeth(): JaggedTeeth {\n    const pathLeft =\n      svgPaths.lineTo(5.1, 2.6) +\n      svgPaths.moveBy(-10.2, 6.8) +\n      svgPaths.lineTo(5.1, 2.6);\n    return {pathLeft, height: 12, width: 10.2};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about start\n   *     highlights.\n   */\n  protected makeStartHat(): StartHat {\n    const hatHeight = this.constantProvider.START_HAT.height;\n    const pathRtl =\n      svgPaths.moveBy(25, -8.7) +\n      svgPaths.curve('c', [\n        svgPaths.point(29.7, -6.2),\n        svgPaths.point(57.2, -0.5),\n        svgPaths.point(75, 8.7),\n      ]);\n\n    const pathLtr =\n      svgPaths.curve('c', [\n        svgPaths.point(17.8, -9.2),\n        svgPaths.point(45.3, -14.9),\n        svgPaths.point(75, -8.7),\n      ]) + svgPaths.moveTo(100.5, hatHeight + 0.5);\n    return {\n      path(rtl) {\n        return rtl ? pathRtl : pathLtr;\n      },\n    };\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.InlineInput\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../../inputs/input.js';\nimport type {ConstantProvider as BaseConstantProvider} from '../../../renderers/common/constants.js';\nimport {InlineInput as BaseInlineInput} from '../../../renderers/measurables/inline_input.js';\nimport type {ConstantProvider as GerasConstantProvider} from '../constants.js';\n\n/**\n * An object containing information about the space an inline input takes up\n * during rendering.\n */\nexport class InlineInput extends BaseInlineInput {\n  override constants_: GerasConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The inline input to measure and store information for.\n   */\n  constructor(constants: BaseConstantProvider, input: Input) {\n    super(constants, input);\n    this.constants_ = constants as GerasConstantProvider;\n\n    if (this.connectedBlock) {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.width += this.constants_.DARK_PATH_OFFSET;\n      this.height += this.constants_.DARK_PATH_OFFSET;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.StatementInput\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../../inputs/input.js';\nimport type {ConstantProvider as BaseConstantProvider} from '../../../renderers/common/constants.js';\nimport {StatementInput as BaseStatementInput} from '../../../renderers/measurables/statement_input.js';\nimport type {ConstantProvider as GerasConstantProvider} from '../constants.js';\n\n/**\n * An object containing information about the space a statement input takes up\n * during rendering.\n */\nexport class StatementInput extends BaseStatementInput {\n  override constants_: GerasConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The statement input to measure and store information for.\n   */\n  constructor(constants: BaseConstantProvider, input: Input) {\n    super(constants, input);\n    this.constants_ = constants as GerasConstantProvider;\n\n    if (this.connectedBlock) {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.height += this.constants_.DARK_PATH_OFFSET;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.RenderInfo\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Input} from '../../inputs/input.js';\nimport {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport type {Measurable} from '../measurables/base.js';\nimport type {BottomRow} from '../measurables/bottom_row.js';\nimport {DummyInput} from '../../inputs/dummy_input.js';\nimport {EndRowInput} from '../../inputs/end_row_input.js';\nimport {ExternalValueInput} from '../measurables/external_value_input.js';\nimport type {Field} from '../measurables/field.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport type {InputRow} from '../measurables/input_row.js';\nimport type {Row} from '../measurables/row.js';\nimport {StatementInput} from '../../inputs/statement_input.js';\nimport type {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\nimport {ValueInput} from '../../inputs/value_input.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport {InlineInput} from './measurables/inline_input.js';\nimport {StatementInput as StatementInputMeasurable} from './measurables/statement_input.js';\nimport type {Renderer} from './renderer.js';\n\n/**\n * An object containing all sizing information needed to draw this block,\n * customized for the geras renderer.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n */\nexport class RenderInfo extends BaseRenderInfo {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override constants_!: ConstantProvider;\n\n  protected override readonly renderer_: Renderer;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    super(renderer, block);\n    this.renderer_ = renderer;\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   */\n  override getRenderer(): Renderer {\n    return this.renderer_;\n  }\n\n  override populateBottomRow_() {\n    super.populateBottomRow_();\n\n    const followsStatement =\n      this.block_.inputList.length &&\n      this.block_.inputList[this.block_.inputList.length - 1] instanceof\n        StatementInput;\n    // The minimum height of the bottom row is smaller in Geras than in other\n    // renderers, because the dark path adds a pixel.\n    // If one of the row's elements has a greater height this will be\n    // overwritten in the compute pass.\n    if (!followsStatement) {\n      this.bottomRow.minHeight =\n        this.constants_.MEDIUM_PADDING - this.constants_.DARK_PATH_OFFSET;\n    }\n  }\n\n  override addInput_(input: Input, activeRow: Row) {\n    // Non-dummy inputs have visual representations onscreen.\n    if (this.isInline && input instanceof ValueInput) {\n      activeRow.elements.push(new InlineInput(this.constants_, input));\n      activeRow.hasInlineInput = true;\n    } else if (input instanceof StatementInput) {\n      activeRow.elements.push(\n        new StatementInputMeasurable(this.constants_, input),\n      );\n      activeRow.hasStatement = true;\n    } else if (input instanceof ValueInput) {\n      activeRow.elements.push(new ExternalValueInput(this.constants_, input));\n      activeRow.hasExternalInput = true;\n    } else if (input instanceof DummyInput || input instanceof EndRowInput) {\n      // Dummy and end-row inputs have no visual representation, but the\n      // information is still important.\n      activeRow.minHeight = Math.max(\n        activeRow.minHeight,\n        this.constants_.DUMMY_INPUT_MIN_HEIGHT,\n      );\n      activeRow.hasDummyInput = true;\n    }\n    // Ignore row alignment if inline.\n    if (!this.isInline && activeRow.align === null) {\n      activeRow.align = input.align;\n    }\n  }\n\n  override addElemSpacing_() {\n    let hasExternalInputs = false;\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      if (row.hasExternalInput) {\n        hasExternalInputs = true;\n      }\n    }\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      const oldElems = row.elements;\n      row.elements = [];\n      // No spacing needed before the corner on the top row or the bottom row.\n      if (row.startsWithElemSpacer()) {\n        // There's a spacer before the first element in the row.\n        row.elements.push(\n          new InRowSpacer(\n            this.constants_,\n            this.getInRowSpacing_(null, oldElems[0]),\n          ),\n        );\n      }\n      if (!oldElems.length) {\n        continue;\n      }\n      for (let e = 0; e < oldElems.length - 1; e++) {\n        row.elements.push(oldElems[e]);\n        const spacing = this.getInRowSpacing_(oldElems[e], oldElems[e + 1]);\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n      row.elements.push(oldElems[oldElems.length - 1]);\n      if (row.endsWithElemSpacer()) {\n        let spacing = this.getInRowSpacing_(\n          oldElems[oldElems.length - 1],\n          null,\n        );\n        if (hasExternalInputs && row.hasDummyInput) {\n          spacing += this.constants_.TAB_WIDTH;\n        }\n        // There's a spacer after the last element in the row.\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n    }\n  }\n\n  override getInRowSpacing_(prev: Measurable | null, next: Measurable | null) {\n    if (!prev) {\n      // Between an editable field and the beginning of the row.\n      if (next && Types.isField(next) && (next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Inline input at the beginning of the row.\n      if (next && Types.isInlineInput(next)) {\n        return this.constants_.MEDIUM_LARGE_PADDING;\n      }\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n      // Anything else at the beginning of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between a non-input and the end of the row or a statement input.\n    if (!Types.isInput(prev) && (!next || Types.isStatementInput(next))) {\n      // Between an editable field and the end of the row.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Padding at the end of an icon-only row to make the block shape clearer.\n      if (Types.isIcon(prev)) {\n        return this.constants_.LARGE_PADDING * 2 + 1;\n      }\n      if (Types.isHat(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Establish a minimum width for a block with a previous or next\n      // connection.\n      if (Types.isPreviousOrNextConnection(prev)) {\n        return this.constants_.LARGE_PADDING;\n      }\n      // Between rounded corner and the end of the row.\n      if (Types.isLeftRoundedCorner(prev)) {\n        return this.constants_.MIN_BLOCK_WIDTH;\n      }\n      // Between a jagged edge and the end of the row.\n      if (Types.isJaggedEdge(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Between noneditable fields and icons and the end of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Between inputs and the end of the row.\n    if (Types.isInput(prev) && !next) {\n      if (Types.isExternalInput(prev)) {\n        return this.constants_.NO_PADDING;\n      } else if (Types.isInlineInput(prev)) {\n        return this.constants_.LARGE_PADDING;\n      } else if (Types.isStatementInput(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n\n    // Spacing between a non-input and an input.\n    if (!Types.isInput(prev) && next && Types.isInput(next)) {\n      // Between an editable field and an input.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.SMALL_PADDING;\n        } else if (Types.isExternalInput(next)) {\n          return this.constants_.SMALL_PADDING;\n        }\n      } else {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n        } else if (Types.isExternalInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n        } else if (Types.isStatementInput(next)) {\n          return this.constants_.LARGE_PADDING;\n        }\n      }\n      return this.constants_.LARGE_PADDING - 1;\n    }\n\n    // Spacing between an icon and an icon or field.\n    if (Types.isIcon(prev) && next && !Types.isInput(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n    // Spacing between an inline input and a field.\n    if (Types.isInlineInput(prev) && next && Types.isField(next)) {\n      // Editable field after inline input.\n      if ((next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      } else {\n        // Noneditable field after inline input.\n        return this.constants_.LARGE_PADDING;\n      }\n    }\n\n    if (Types.isLeftSquareCorner(prev) && next) {\n      // Spacing between a hat and a corner\n      if (Types.isHat(next)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Spacing between a square corner and a previous or next connection\n      if (Types.isPreviousConnection(next)) {\n        return next.notchOffset;\n      } else if (Types.isNextConnection(next)) {\n        // Next connections are shifted slightly to the left (in both LTR and\n        // RTL) to make the dark path under the previous connection show\n        // through.\n        const offset =\n          ((this.RTL ? 1 : -1) * this.constants_.DARK_PATH_OFFSET) / 2;\n        return next.notchOffset + offset;\n      }\n    }\n\n    // Spacing between a rounded corner and a previous or next connection.\n    if (Types.isLeftRoundedCorner(prev) && next) {\n      if (Types.isPreviousConnection(next)) {\n        return next.notchOffset - this.constants_.CORNER_RADIUS;\n      } else if (Types.isNextConnection(next)) {\n        // Next connections are shifted slightly to the left (in both LTR and\n        // RTL) to make the dark path under the previous connection show\n        // through.\n        const offset =\n          ((this.RTL ? 1 : -1) * this.constants_.DARK_PATH_OFFSET) / 2;\n        return next.notchOffset - this.constants_.CORNER_RADIUS + offset;\n      }\n    }\n\n    // Spacing between two fields of the same editability.\n    if (\n      Types.isField(prev) &&\n      next &&\n      Types.isField(next) &&\n      (prev as Field).isEditable === (next as Field).isEditable\n    ) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between anything and a jagged edge.\n    if (next && Types.isJaggedEdge(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowHeight_(prev: Row, next: Row) {\n    // If we have an empty block add a spacer to increase the height.\n    if (Types.isTopRow(prev) && Types.isBottomRow(next)) {\n      return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;\n    }\n    // Top and bottom rows act as a spacer so we don't need any extra padding.\n    if (Types.isTopRow(prev) || Types.isBottomRow(next)) {\n      return this.constants_.NO_PADDING;\n    }\n    if (prev.hasExternalInput && next.hasExternalInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (!prev.hasStatement && next.hasStatement) {\n      return this.constants_.BETWEEN_STATEMENT_PADDING_Y;\n    }\n    if (prev.hasStatement && next.hasStatement) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (!prev.hasStatement && next.hasDummyInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (prev.hasDummyInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getElemCenterline_(row: Row, elem: Measurable) {\n    if (Types.isSpacer(elem)) {\n      return row.yPos + elem.height / 2;\n    }\n    if (Types.isBottomRow(row)) {\n      const bottomRow = row as BottomRow;\n      const baseline =\n        bottomRow.yPos + bottomRow.height - bottomRow.descenderHeight;\n      if (Types.isNextConnection(elem)) {\n        return baseline + elem.height / 2;\n      }\n      return baseline - elem.height / 2;\n    }\n    if (Types.isTopRow(row)) {\n      const topRow = row as TopRow;\n      if (Types.isHat(elem)) {\n        return topRow.capline - elem.height / 2;\n      }\n      return topRow.capline + elem.height / 2;\n    }\n\n    let result = row.yPos;\n    if (Types.isField(elem) || Types.isIcon(elem)) {\n      result += elem.height / 2;\n      if (\n        (row.hasInlineInput || row.hasStatement) &&\n        elem.height + this.constants_.TALL_INPUT_FIELD_OFFSET_Y <= row.height\n      ) {\n        result += this.constants_.TALL_INPUT_FIELD_OFFSET_Y;\n      }\n    } else if (Types.isInlineInput(elem)) {\n      result += elem.height / 2;\n    } else {\n      result += row.height / 2;\n    }\n    return result;\n  }\n\n  override alignRowElements_() {\n    if (!this.isInline) {\n      super.alignRowElements_();\n      return;\n    }\n    // Walk backgrounds through rows on the block, keeping track of the right\n    // input edge.\n    let nextRightEdge = 0;\n    const rowNextRightEdges = new WeakMap();\n    let prevInput = null;\n    for (let i = this.rows.length - 1, row; (row = this.rows[i]); i--) {\n      rowNextRightEdges.set(row, nextRightEdge);\n      if (Types.isInputRow(row)) {\n        if (row.hasStatement) {\n          this.alignStatementRow_(row as InputRow);\n        }\n        if (\n          prevInput &&\n          prevInput.hasStatement &&\n          row.width < prevInput.width\n        ) {\n          rowNextRightEdges.set(row, prevInput.width);\n        } else if (row.hasStatement) {\n          nextRightEdge = row.width;\n        } else {\n          // To keep right edges of consecutive non-statement rows aligned, use\n          // the maximum width.\n          nextRightEdge = Math.max(nextRightEdge, row.width);\n        }\n        prevInput = row;\n      }\n    }\n    // Walk down each row from the top, comparing the prev and next right input\n    // edges and setting the desired width to the max of the two.\n    let prevRightEdge = 0;\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      if (row.hasStatement) {\n        prevRightEdge = this.getDesiredRowWidth_(row);\n      } else if (Types.isSpacer(row)) {\n        // Set the spacer row to the max of the prev or next input width.\n        row.width = Math.max(prevRightEdge, rowNextRightEdges.get(row));\n      } else {\n        const currentWidth = row.width;\n        const desiredWidth = Math.max(\n          prevRightEdge,\n          rowNextRightEdges.get(row),\n        );\n        const missingSpace = desiredWidth - currentWidth;\n        if (missingSpace > 0) {\n          this.addAlignmentPadding_(row, missingSpace);\n        }\n        prevRightEdge = row.width;\n      }\n    }\n  }\n\n  override getDesiredRowWidth_(row: Row) {\n    // Limit the width of a statement row when a block is inline.\n    if (this.isInline && row.hasStatement) {\n      return (\n        this.statementEdge + this.constants_.MAX_BOTTOM_WIDTH + this.startX\n      );\n    }\n    return super.getDesiredRowWidth_(row);\n  }\n\n  override finalize_() {\n    // Performance note: this could be combined with the draw pass, if the time\n    // that this takes is excessive.  But it shouldn't be, because it only\n    // accesses and sets properties that already exist on the objects.\n    let widestRowWithConnectedBlocks = 0;\n    let yCursor = 0;\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      row.yPos = yCursor;\n      row.xPos = this.startX;\n      yCursor += row.height;\n\n      widestRowWithConnectedBlocks = Math.max(\n        widestRowWithConnectedBlocks,\n        row.widthWithConnectedBlocks,\n      );\n      // Add padding to the bottom row if block height is less than minimum\n      const heightWithoutHat = yCursor - this.topRow.ascenderHeight;\n      if (\n        row === this.bottomRow &&\n        heightWithoutHat < this.constants_.MIN_BLOCK_HEIGHT\n      ) {\n        // But the hat height shouldn't be part of this.\n        const diff = this.constants_.MIN_BLOCK_HEIGHT - heightWithoutHat;\n        this.bottomRow.height += diff;\n        yCursor += diff;\n      }\n      this.recordElemPositions_(row);\n    }\n    if (\n      this.outputConnection &&\n      this.block_.nextConnection &&\n      this.block_.nextConnection.isConnected()\n    ) {\n      const target = this.block_.nextConnection.targetBlock();\n      if (target) {\n        // Include width of connected block in value to stack width measurement.\n        widestRowWithConnectedBlocks = Math.max(\n          widestRowWithConnectedBlocks,\n          target.getHeightWidth().width - this.constants_.DARK_PATH_OFFSET,\n        );\n      }\n    }\n\n    this.bottomRow.baseline = yCursor - this.bottomRow.descenderHeight;\n    this.widthWithChildren =\n      widestRowWithConnectedBlocks +\n      this.startX +\n      this.constants_.DARK_PATH_OFFSET;\n    this.width += this.constants_.DARK_PATH_OFFSET;\n    this.height = yCursor + this.constants_.DARK_PATH_OFFSET;\n    this.startY = this.topRow.capline;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.PathObject\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {BlockStyle} from '../../theme.js';\nimport * as colour from '../../utils/colour.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport {PathObject as BasePathObject} from '../common/path_object.js';\n\nimport type {ConstantProvider} from './constants.js';\n\n/**\n * An object that handles creating and setting each of the SVG elements\n * used by the renderer.\n */\nexport class PathObject extends BasePathObject {\n  svgPathDark: SVGElement;\n  svgPathLight: SVGElement;\n\n  /**\n   * The colour of the dark path on the block in '#RRGGBB' format.\n   */\n  colourDark = '#000000';\n\n  /**\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @param constants The renderer's constants.\n   */\n  constructor(\n    root: SVGElement,\n    style: BlockStyle,\n    public override constants: ConstantProvider,\n  ) {\n    super(root, style, constants);\n\n    /** The dark path of the block. */\n    this.svgPathDark = dom.createSvgElement(Svg.PATH, {\n      'class': 'blocklyPathDark',\n      'transform': 'translate(1,1)',\n    });\n    // SVG draw order is based on the order of elements (top most = back most)\n    // So we need to insert the dark path before the base path to make sure it\n    // gets drawn first.\n    this.svgRoot.insertBefore(this.svgPathDark, this.svgPath);\n\n    /** The light path of the block. */\n    this.svgPathLight = dom.createSvgElement(\n      Svg.PATH,\n      {'class': 'blocklyPathLight'},\n      this.svgRoot,\n    );\n  }\n\n  override setPath(mainPath: string) {\n    this.svgPath.setAttribute('d', mainPath);\n    this.svgPathDark.setAttribute('d', mainPath);\n  }\n\n  /**\n   * Set the highlight path generated by the renderer onto the SVG element.\n   *\n   * @param highlightPath The highlight path.\n   */\n  setHighlightPath(highlightPath: string) {\n    this.svgPathLight.setAttribute('d', highlightPath);\n  }\n\n  override flipRTL() {\n    // Mirror the block's path.\n    this.svgPath.setAttribute('transform', 'scale(-1 1)');\n    this.svgPathLight.setAttribute('transform', 'scale(-1 1)');\n    this.svgPathDark.setAttribute('transform', 'translate(1,1) scale(-1 1)');\n  }\n\n  override applyColour(block: BlockSvg) {\n    this.svgPathLight.style.display = '';\n    this.svgPathDark.style.display = '';\n    if (!this.style.colourTertiary) {\n      throw new Error(\n        'The renderer did not properly initialize the tertiary colour of ' +\n          'the block style',\n      );\n    }\n    this.svgPathLight.setAttribute('stroke', this.style.colourTertiary);\n    this.svgPathDark.setAttribute('fill', this.colourDark);\n\n    super.applyColour(block);\n\n    this.svgPath.setAttribute('stroke', 'none');\n  }\n\n  override setStyle(blockStyle: BlockStyle) {\n    this.style = blockStyle;\n    this.colourDark =\n      colour.blend('#000', this.style.colourPrimary, 0.2) || this.colourDark;\n  }\n\n  override updateHighlighted(highlighted: boolean) {\n    if (highlighted) {\n      this.svgPath.setAttribute(\n        'filter',\n        'url(#' + this.constants.embossFilterId + ')',\n      );\n      this.svgPathLight.style.display = 'none';\n    } else {\n      this.svgPath.setAttribute('filter', 'none');\n      this.svgPathLight.style.display = 'inline';\n    }\n  }\n\n  override updateShadow_(shadow: boolean) {\n    if (shadow) {\n      this.svgPathLight.style.display = 'none';\n      if (!this.style.colourSecondary) {\n        throw new Error(\n          'The renderer did not properly initialize the secondary colour ' +\n            'of the block style block style',\n        );\n      }\n      this.svgPathDark.setAttribute('fill', this.style.colourSecondary);\n      this.svgPath.setAttribute('stroke', 'none');\n      this.svgPath.setAttribute('fill', this.style.colourSecondary);\n    }\n  }\n\n  override updateDisabled_(disabled: boolean) {\n    super.updateDisabled_(disabled);\n    if (disabled) {\n      this.svgPath.setAttribute('stroke', 'none');\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras.Renderer\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {BlockStyle, Theme} from '../../theme.js';\nimport * as blockRendering from '../common/block_rendering.js';\nimport type {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport {Renderer as BaseRenderer} from '../common/renderer.js';\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {HighlightConstantProvider} from './highlight_constants.js';\nimport {RenderInfo} from './info.js';\nimport {PathObject} from './path_object.js';\n\n/**\n * The geras renderer. This renderer was designed to be backwards compatible\n * with pre-2019 Blockly. Newer projects that are not constrained by backwards\n * compatibility should use thrasos, which is a more modern take on this\n * renderer.\n *\n * Geras is the ancient Greek spirit of old age.\n */\nexport class Renderer extends BaseRenderer {\n  /** The renderer's highlight constant provider. */\n  private highlightConstants: HighlightConstantProvider | null = null;\n\n  /**\n   * @param name The renderer name.\n   */\n  constructor(name: string) {\n    super(name);\n  }\n\n  /**\n   * Initialize the renderer.  Geras has a highlight provider in addition to\n   * the normal constant provider.\n   */\n  override init(\n    theme: Theme,\n    opt_rendererOverrides?: {[rendererConstant: string]: any},\n  ) {\n    super.init(theme, opt_rendererOverrides);\n    this.highlightConstants = this.makeHighlightConstants_();\n    this.highlightConstants.init();\n  }\n\n  override refreshDom(svg: SVGElement, theme: Theme) {\n    super.refreshDom(svg, theme);\n    this.getHighlightConstants().init();\n  }\n\n  override makeConstants_() {\n    return new ConstantProvider();\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected override makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n\n  /**\n   * Create a new instance of the renderer's drawer.\n   *\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @returns The drawer.\n   */\n  protected override makeDrawer_(\n    block: BlockSvg,\n    info: BaseRenderInfo,\n  ): Drawer {\n    return new Drawer(block, info as RenderInfo);\n  }\n\n  /**\n   * Create a new instance of a renderer path object.\n   *\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @returns The renderer path object.\n   */\n  override makePathObject(root: SVGElement, style: BlockStyle): PathObject {\n    return new PathObject(root, style, this.getConstants() as ConstantProvider);\n  }\n\n  /**\n   * Create a new instance of the renderer's highlight constant provider.\n   *\n   * @returns The highlight constant provider.\n   */\n  protected makeHighlightConstants_(): HighlightConstantProvider {\n    return new HighlightConstantProvider(this.getConstants());\n  }\n\n  /**\n   * Get the renderer's highlight constant provider.  We assume that when this\n   * is called, the renderer has already been initialized.\n   *\n   * @returns The highlight constant provider.\n   */\n  getHighlightConstants(): HighlightConstantProvider {\n    if (!this.highlightConstants) {\n      throw new Error(\n        'Cannot access the highlight constants because init has not ' +\n          'been called',\n      );\n    }\n    return this.highlightConstants;\n  }\n}\n\nblockRendering.register('geras', Renderer);\n","/** @file Re-exports of Blockly.geras.* modules. */\n\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.geras\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {HighlightConstantProvider} from './highlight_constants.js';\nimport {Highlighter} from './highlighter.js';\nimport {RenderInfo} from './info.js';\nimport {InlineInput} from './measurables/inline_input.js';\nimport {StatementInput} from './measurables/statement_input.js';\nimport {PathObject} from './path_object.js';\nimport {Renderer} from './renderer.js';\n\nexport {\n  ConstantProvider,\n  Drawer,\n  HighlightConstantProvider,\n  Highlighter,\n  InlineInput,\n  PathObject,\n  Renderer,\n  RenderInfo,\n  StatementInput,\n};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.thrasos.RenderInfo\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport type {Measurable} from '../measurables/base.js';\nimport type {BottomRow} from '../measurables/bottom_row.js';\nimport type {Field} from '../measurables/field.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport type {Row} from '../measurables/row.js';\nimport type {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {Renderer} from './renderer.js';\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n */\nexport class RenderInfo extends BaseRenderInfo {\n  // Exclamation is fine b/c this is assigned by the super constructor.\n  protected override renderer_!: Renderer;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    super(renderer, block);\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   */\n  override getRenderer(): Renderer {\n    return this.renderer_;\n  }\n\n  override addElemSpacing_() {\n    let hasExternalInputs = false;\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      if (row.hasExternalInput) {\n        hasExternalInputs = true;\n        break;\n      }\n    }\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      const oldElems = row.elements;\n      row.elements = [];\n      // No spacing needed before the corner on the top row or the bottom row.\n      if (row.startsWithElemSpacer()) {\n        // There's a spacer before the first element in the row.\n        row.elements.push(\n          new InRowSpacer(\n            this.constants_,\n            this.getInRowSpacing_(null, oldElems[0]),\n          ),\n        );\n      }\n      if (!oldElems.length) {\n        continue;\n      }\n      for (let e = 0; e < oldElems.length - 1; e++) {\n        row.elements.push(oldElems[e]);\n        const spacing = this.getInRowSpacing_(oldElems[e], oldElems[e + 1]);\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n      row.elements.push(oldElems[oldElems.length - 1]);\n      if (row.endsWithElemSpacer()) {\n        let spacing = this.getInRowSpacing_(\n          oldElems[oldElems.length - 1],\n          null,\n        );\n        if (hasExternalInputs && row.hasDummyInput) {\n          spacing += this.constants_.TAB_WIDTH;\n        }\n        // There's a spacer after the last element in the row.\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n    }\n  }\n\n  override getInRowSpacing_(prev: Measurable | null, next: Measurable | null) {\n    if (!prev) {\n      // Between an editable field and the beginning of the row.\n      if (next && Types.isField(next) && (next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Inline input at the beginning of the row.\n      if (next && Types.isInlineInput(next)) {\n        return this.constants_.MEDIUM_LARGE_PADDING;\n      }\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n      // Anything else at the beginning of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between a non-input and the end of the row.\n    if (!Types.isInput(prev) && !next) {\n      // Between an editable field and the end of the row.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Padding at the end of an icon-only row to make the block shape clearer.\n      if (Types.isIcon(prev)) {\n        return this.constants_.LARGE_PADDING * 2 + 1;\n      }\n      if (Types.isHat(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Establish a minimum width for a block with a previous or next\n      // connection.\n      if (Types.isPreviousOrNextConnection(prev)) {\n        return this.constants_.LARGE_PADDING;\n      }\n      // Between rounded corner and the end of the row.\n      if (Types.isLeftRoundedCorner(prev)) {\n        return this.constants_.MIN_BLOCK_WIDTH;\n      }\n      // Between a jagged edge and the end of the row.\n      if (Types.isJaggedEdge(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Between noneditable fields and icons and the end of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n    // Between inputs and the end of the row.\n    if (Types.isInput(prev) && !next) {\n      if (Types.isExternalInput(prev)) {\n        return this.constants_.NO_PADDING;\n      } else if (Types.isInlineInput(prev)) {\n        return this.constants_.LARGE_PADDING;\n      } else if (Types.isStatementInput(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n\n    // Spacing between a non-input and an input.\n    if (!Types.isInput(prev) && next && Types.isInput(next)) {\n      // Between an editable field and an input.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.SMALL_PADDING;\n        } else if (Types.isExternalInput(next)) {\n          return this.constants_.SMALL_PADDING;\n        }\n      } else {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n        } else if (Types.isExternalInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n        } else if (Types.isStatementInput(next)) {\n          return this.constants_.LARGE_PADDING;\n        }\n      }\n      return this.constants_.LARGE_PADDING - 1;\n    }\n\n    // Spacing between an icon and an icon or field.\n    if (Types.isIcon(prev) && next && !Types.isInput(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between an inline input and a field.\n    if (Types.isInlineInput(prev) && next && Types.isField(next)) {\n      // Editable field after inline input.\n      if ((next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      } else {\n        // Noneditable field after inline input.\n        return this.constants_.LARGE_PADDING;\n      }\n    }\n\n    if (Types.isLeftSquareCorner(prev) && next) {\n      // Spacing between a hat and a corner\n      if (Types.isHat(next)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Spacing between a square corner and a previous or next connection\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset;\n      }\n    }\n    // Spacing between a rounded corner and a previous or next connection.\n    if (Types.isLeftRoundedCorner(prev) && next) {\n      return next.notchOffset - this.constants_.CORNER_RADIUS;\n    }\n\n    // Spacing between two fields of the same editability.\n    if (\n      Types.isField(prev) &&\n      next &&\n      Types.isField(next) &&\n      (prev as Field).isEditable === (next as Field).isEditable\n    ) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between anything and a jagged edge.\n    if (next && Types.isJaggedEdge(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowHeight_(prev: Row, next: Row) {\n    // If we have an empty block add a spacer to increase the height.\n    if (Types.isTopRow(prev) && Types.isBottomRow(next)) {\n      return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;\n    }\n    // Top and bottom rows act as a spacer so we don't need any extra padding.\n    if (Types.isTopRow(prev) || Types.isBottomRow(next)) {\n      return this.constants_.NO_PADDING;\n    }\n    if (prev.hasExternalInput && next.hasExternalInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (!prev.hasStatement && next.hasStatement) {\n      return this.constants_.BETWEEN_STATEMENT_PADDING_Y;\n    }\n    if (prev.hasStatement && next.hasStatement) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (prev.hasDummyInput || next.hasDummyInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getElemCenterline_(row: Row, elem: Measurable) {\n    if (Types.isSpacer(elem)) {\n      return row.yPos + elem.height / 2;\n    }\n    if (Types.isBottomRow(row)) {\n      const bottomRow = row as BottomRow;\n      const baseline =\n        bottomRow.yPos + bottomRow.height - bottomRow.descenderHeight;\n      if (Types.isNextConnection(elem)) {\n        return baseline + elem.height / 2;\n      }\n      return baseline - elem.height / 2;\n    }\n    if (Types.isTopRow(row)) {\n      const topRow = row as TopRow;\n      if (Types.isHat(elem)) {\n        return topRow.capline - elem.height / 2;\n      }\n      return topRow.capline + elem.height / 2;\n    }\n\n    let result = row.yPos;\n    if (Types.isField(elem) && row.hasStatement) {\n      const offset =\n        this.constants_.TALL_INPUT_FIELD_OFFSET_Y + elem.height / 2;\n      result += offset;\n    } else {\n      result += row.height / 2;\n    }\n    return result;\n  }\n\n  override finalize_() {\n    // Performance note: this could be combined with the draw pass, if the time\n    // that this takes is excessive.  But it shouldn't be, because it only\n    // accesses and sets properties that already exist on the objects.\n    let widestRowWithConnectedBlocks = 0;\n    let yCursor = 0;\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      row.yPos = yCursor;\n      row.xPos = this.startX;\n      yCursor += row.height;\n\n      widestRowWithConnectedBlocks = Math.max(\n        widestRowWithConnectedBlocks,\n        row.widthWithConnectedBlocks,\n      );\n      // Add padding to the bottom row if block height is less than minimum\n      const heightWithoutHat = yCursor - this.topRow.ascenderHeight;\n      if (\n        row === this.bottomRow &&\n        heightWithoutHat < this.constants_.MIN_BLOCK_HEIGHT\n      ) {\n        // But the hat height shouldn't be part of this.\n        const diff = this.constants_.MIN_BLOCK_HEIGHT - heightWithoutHat;\n        this.bottomRow.height += diff;\n        yCursor += diff;\n      }\n      this.recordElemPositions_(row);\n    }\n    if (\n      this.outputConnection &&\n      this.block_.nextConnection &&\n      this.block_.nextConnection.isConnected()\n    ) {\n      const target = this.block_.nextConnection.targetBlock();\n      if (target) {\n        // Include width of connected block in value to stack width measurement.\n        widestRowWithConnectedBlocks = Math.max(\n          widestRowWithConnectedBlocks,\n          target.getHeightWidth().width,\n        );\n      }\n    }\n\n    this.bottomRow.baseline = yCursor - this.bottomRow.descenderHeight;\n    this.widthWithChildren = widestRowWithConnectedBlocks + this.startX;\n\n    this.height = yCursor;\n    this.startY = this.topRow.capline;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.thrasos.Renderer\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport * as blockRendering from '../common/block_rendering.js';\nimport {Renderer as BaseRenderer} from '../common/renderer.js';\n\nimport {RenderInfo} from './info.js';\n\n/**\n * The thrasos renderer. This is a more modern take on the legacy geras\n * renderer.\n *\n * Thrasos is the ancient Greek spirit of boldness.\n */\nexport class Renderer extends BaseRenderer {\n  /**\n   * @param name The renderer name.\n   */\n  constructor(name: string) {\n    super(name);\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected override makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n}\n\nblockRendering.register('thrasos', Renderer);\n","/** @file Re-exports of Blockly.thrasos.* modules. */\n\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.thrasos\n\nimport {RenderInfo} from './info.js';\nimport {Renderer} from './renderer.js';\n\nexport {Renderer, RenderInfo};\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Themes.Zelos\n\nimport {Theme} from '../theme.js';\n\nconst defaultBlockStyles = {\n  'colour_blocks': {\n    'colourPrimary': '#CF63CF',\n    'colourSecondary': '#C94FC9',\n    'colourTertiary': '#BD42BD',\n  },\n  'list_blocks': {\n    'colourPrimary': '#9966FF',\n    'colourSecondary': '#855CD6',\n    'colourTertiary': '#774DCB',\n  },\n  'logic_blocks': {\n    'colourPrimary': '#4C97FF',\n    'colourSecondary': '#4280D7',\n    'colourTertiary': '#3373CC',\n  },\n  'loop_blocks': {\n    'colourPrimary': '#0fBD8C',\n    'colourSecondary': '#0DA57A',\n    'colourTertiary': '#0B8E69',\n  },\n  'math_blocks': {\n    'colourPrimary': '#59C059',\n    'colourSecondary': '#46B946',\n    'colourTertiary': '#389438',\n  },\n  'procedure_blocks': {\n    'colourPrimary': '#FF6680',\n    'colourSecondary': '#FF4D6A',\n    'colourTertiary': '#FF3355',\n  },\n  'text_blocks': {\n    'colourPrimary': '#FFBF00',\n    'colourSecondary': '#E6AC00',\n    'colourTertiary': '#CC9900',\n  },\n  'variable_blocks': {\n    'colourPrimary': '#FF8C1A',\n    'colourSecondary': '#FF8000',\n    'colourTertiary': '#DB6E00',\n  },\n  'variable_dynamic_blocks': {\n    'colourPrimary': '#FF8C1A',\n    'colourSecondary': '#FF8000',\n    'colourTertiary': '#DB6E00',\n  },\n  'hat_blocks': {\n    'colourPrimary': '#4C97FF',\n    'colourSecondary': '#4280D7',\n    'colourTertiary': '#3373CC',\n    'hat': 'cap',\n  },\n};\n\nconst categoryStyles = {\n  'colour_category': {'colour': '#CF63CF'},\n  'list_category': {'colour': '#9966FF'},\n  'logic_category': {'colour': '#4C97FF'},\n  'loop_category': {'colour': '#0fBD8C'},\n  'math_category': {'colour': '#59C059'},\n  'procedure_category': {'colour': '#FF6680'},\n  'text_category': {'colour': '#FFBF00'},\n  'variable_category': {'colour': '#FF8C1A'},\n  'variable_dynamic_category': {'colour': '#FF8C1A'},\n};\n\n/**\n * Zelos theme.\n */\nexport const Zelos = new Theme('zelos', defaultBlockStyles, categoryStyles);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.Themes\n\nimport {Classic} from './classic.js';\nimport {Zelos} from './zelos.js';\n\nexport {Classic, Zelos};\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An item in the toolbox.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ToolboxItem\n\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport * as idGenerator from '../utils/idgenerator.js';\nimport type * as toolbox from '../utils/toolbox.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\n/**\n * Class for an item in the toolbox.\n */\nexport class ToolboxItem implements IToolboxItem {\n  protected id_: string;\n  protected parent_: ICollapsibleToolboxItem | null;\n  protected level_: number;\n  protected toolboxItemDef_: toolbox.ToolboxItemInfo | null;\n  protected workspace_: WorkspaceSvg;\n  /** The toolbox this category belongs to. */\n  protected readonly parentToolbox_: IToolbox;\n\n  /**\n   * @param toolboxItemDef The JSON defining the toolbox item.\n   * @param parentToolbox The toolbox that holds the toolbox item.\n   * @param opt_parent The parent toolbox item or null if the category does not\n   *     have a parent.\n   */\n  constructor(\n    toolboxItemDef: toolbox.ToolboxItemInfo,\n    parentToolbox: IToolbox,\n    opt_parent?: ICollapsibleToolboxItem,\n  ) {\n    /** The ID for the category. */\n    this.id_ =\n      (toolboxItemDef as AnyDuringMigration)['toolboxitemid'] ||\n      idGenerator.getNextUniqueId();\n\n    /** The parent of the category. */\n    this.parent_ = opt_parent || null;\n\n    /** The level that the category is nested at. */\n    this.level_ = this.parent_ ? this.parent_.getLevel() + 1 : 0;\n\n    /** The JSON definition of the toolbox item. */\n    this.toolboxItemDef_ = toolboxItemDef;\n\n    this.parentToolbox_ = parentToolbox;\n\n    /** The workspace of the parent toolbox. */\n    this.workspace_ = this.parentToolbox_.getWorkspace();\n  }\n\n  /**\n   * Initializes the toolbox item.\n   * This includes creating the DOM and updating the state of any items based\n   * on the info object.\n   */\n  init() {}\n  // No-op by default.\n\n  /**\n   * Gets the div for the toolbox item.\n   *\n   * @returns The div for the toolbox item.\n   */\n  getDiv(): Element | null {\n    return null;\n  }\n\n  /**\n   * Gets the HTML element that is clickable.\n   * The parent toolbox element receives clicks. The parent toolbox will add an\n   * ID to this element so it can pass the onClick event to the correct\n   * toolboxItem.\n   *\n   * @returns The HTML element that receives clicks, or null if this item should\n   *     not receive clicks.\n   */\n  getClickTarget(): Element | null {\n    return null;\n  }\n\n  /**\n   * Gets a unique identifier for this toolbox item.\n   *\n   * @returns The ID for the toolbox item.\n   */\n  getId(): string {\n    return this.id_;\n  }\n\n  /**\n   * Gets the parent if the toolbox item is nested.\n   *\n   * @returns The parent toolbox item, or null if this toolbox item is not\n   *     nested.\n   */\n  getParent(): ICollapsibleToolboxItem | null {\n    return null;\n  }\n\n  /**\n   * Gets the nested level of the category.\n   *\n   * @returns The nested level of the category.\n   * @internal\n   */\n  getLevel(): number {\n    return this.level_;\n  }\n\n  /**\n   * Whether the toolbox item is selectable.\n   *\n   * @returns True if the toolbox item can be selected.\n   */\n  isSelectable(): boolean {\n    return false;\n  }\n\n  /**\n   * Whether the toolbox item is collapsible.\n   *\n   * @returns True if the toolbox item is collapsible.\n   */\n  isCollapsible(): boolean {\n    return false;\n  }\n\n  /** Dispose of this toolbox item. No-op by default. */\n  dispose() {}\n\n  /**\n   * Sets whether the category is visible or not.\n   * For a category to be visible its parent category must also be expanded.\n   *\n   * @param _isVisible True if category should be visible.\n   */\n  setVisible_(_isVisible: boolean) {}\n}\n// nop by default\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A toolbox category used to organize blocks in the toolbox.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ToolboxCategory\n\nimport * as Css from '../css.js';\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {ISelectableToolboxItem} from '../interfaces/i_selectable_toolbox_item.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport type {\n  CategoryInfo,\n  DynamicCategoryInfo,\n  FlyoutDefinition,\n  FlyoutItemInfo,\n  FlyoutItemInfoArray,\n  StaticCategoryInfo,\n} from '../utils/toolbox.js';\nimport * as registry from '../registry.js';\nimport * as aria from '../utils/aria.js';\nimport * as colourUtils from '../utils/colour.js';\nimport * as dom from '../utils/dom.js';\nimport * as parsing from '../utils/parsing.js';\nimport * as toolbox from '../utils/toolbox.js';\n\nimport {ToolboxItem} from './toolbox_item.js';\n\n/**\n * Class for a category in a toolbox.\n */\nexport class ToolboxCategory\n  extends ToolboxItem\n  implements ISelectableToolboxItem\n{\n  /** Name used for registering a toolbox category. */\n  static registrationName = 'category';\n\n  /** The number of pixels to move the category over at each nested level. */\n  static nestedPadding = 19;\n\n  /** The width in pixels of the strip of colour next to each category. */\n  static borderWidth = 8;\n\n  /**\n   * The default colour of the category. This is used as the background colour\n   * of the category when it is selected.\n   */\n  static defaultBackgroundColour = '#57e';\n\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override toolboxItemDef_!: CategoryInfo;\n\n  /** The name that will be displayed on the category. */\n  protected name_ = '';\n\n  /** The colour of the category. */\n  protected colour_ = '';\n\n  /** The HTML container for the category. */\n  protected htmlDiv_: HTMLDivElement | null = null;\n\n  /** The HTML element for the category row. */\n  protected rowDiv_: HTMLDivElement | null = null;\n\n  /** The HTML element that holds children elements of the category row. */\n  protected rowContents_: HTMLDivElement | null = null;\n\n  /** The HTML element for the toolbox icon. */\n  protected iconDom_: Element | null = null;\n\n  /** The HTML element for the toolbox label. */\n  protected labelDom_: Element | null = null;\n  protected cssConfig_: CssConfig;\n\n  /** True if the category is meant to be hidden, false otherwise. */\n  protected isHidden_ = false;\n\n  /** True if this category is disabled, false otherwise. */\n  protected isDisabled_ = false;\n\n  /** The flyout items for this category. */\n  protected flyoutItems_: string | FlyoutItemInfoArray = [];\n\n  /**\n   * @param categoryDef The information needed to create a category in the\n   *     toolbox.\n   * @param parentToolbox The parent toolbox for the category.\n   * @param opt_parent The parent category or null if the category does not have\n   *     a parent.\n   */\n  constructor(\n    categoryDef: CategoryInfo,\n    parentToolbox: IToolbox,\n    opt_parent?: ICollapsibleToolboxItem,\n  ) {\n    super(categoryDef, parentToolbox, opt_parent);\n\n    /** All the css class names that are used to create a category. */\n    this.cssConfig_ = this.makeDefaultCssConfig_();\n  }\n\n  /**\n   * Initializes the toolbox item.\n   * This includes creating the DOM and updating the state of any items based\n   * on the info object.\n   * Init should be called immediately after the construction of the toolbox\n   * item, to ensure that the category contents are properly parsed.\n   */\n  override init() {\n    this.parseCategoryDef_(this.toolboxItemDef_);\n    this.parseContents_(this.toolboxItemDef_);\n    this.createDom_();\n    if (this.toolboxItemDef_['hidden'] === 'true') {\n      this.hide();\n    }\n  }\n\n  /**\n   * Creates an object holding the default classes for a category.\n   *\n   * @returns The configuration object holding all the CSS classes for a\n   *     category.\n   */\n  protected makeDefaultCssConfig_(): CssConfig {\n    return {\n      'container': 'blocklyToolboxCategory',\n      'row': 'blocklyTreeRow',\n      'rowcontentcontainer': 'blocklyTreeRowContentContainer',\n      'icon': 'blocklyTreeIcon',\n      'label': 'blocklyTreeLabel',\n      'contents': 'blocklyToolboxContents',\n      'selected': 'blocklyTreeSelected',\n      'openicon': 'blocklyTreeIconOpen',\n      'closedicon': 'blocklyTreeIconClosed',\n    };\n  }\n\n  /**\n   * Parses the contents array depending on if the category is a dynamic\n   * category, or if its contents are meant to be shown in the flyout.\n   *\n   * @param categoryDef The information needed to create a category.\n   */\n  protected parseContents_(categoryDef: CategoryInfo) {\n    if ('custom' in categoryDef) {\n      this.flyoutItems_ = categoryDef['custom'];\n    } else {\n      const contents = categoryDef['contents'];\n      if (!contents) return;\n\n      for (let i = 0; i < contents.length; i++) {\n        const itemDef = contents[i];\n        const flyoutItem = itemDef as FlyoutItemInfo;\n        if (Array.isArray(this.flyoutItems_)) {\n          this.flyoutItems_.push(flyoutItem);\n        }\n      }\n    }\n  }\n\n  /**\n   * Parses the non-contents parts of the category def.\n   *\n   * @param categoryDef The information needed to create a category.\n   */\n  protected parseCategoryDef_(categoryDef: CategoryInfo) {\n    this.name_ =\n      'name' in categoryDef\n        ? parsing.replaceMessageReferences(categoryDef['name'])\n        : '';\n    this.colour_ = this.getColour_(categoryDef);\n    Object.assign(\n      this.cssConfig_,\n      categoryDef['cssconfig'] || (categoryDef as any)['cssConfig'],\n    );\n  }\n\n  /**\n   * Creates the DOM for the category.\n   *\n   * @returns The parent element for the category.\n   */\n  protected createDom_(): HTMLDivElement {\n    this.htmlDiv_ = this.createContainer_();\n    aria.setRole(this.htmlDiv_, aria.Role.TREEITEM);\n    aria.setState(this.htmlDiv_, aria.State.SELECTED, false);\n    aria.setState(this.htmlDiv_, aria.State.LEVEL, this.level_ + 1);\n\n    this.rowDiv_ = this.createRowContainer_();\n    this.rowDiv_.style.pointerEvents = 'auto';\n    this.htmlDiv_.appendChild(this.rowDiv_);\n\n    this.rowContents_ = this.createRowContentsContainer_();\n    this.rowContents_.style.pointerEvents = 'none';\n    this.rowDiv_.appendChild(this.rowContents_);\n\n    this.iconDom_ = this.createIconDom_();\n    aria.setRole(this.iconDom_, aria.Role.PRESENTATION);\n    this.rowContents_.appendChild(this.iconDom_);\n\n    this.labelDom_ = this.createLabelDom_(this.name_);\n    this.rowContents_.appendChild(this.labelDom_);\n\n    const id = this.labelDom_.getAttribute('id');\n    if (id) {\n      aria.setState(this.htmlDiv_, aria.State.LABELLEDBY, id);\n    }\n\n    this.addColourBorder_(this.colour_);\n\n    return this.htmlDiv_;\n  }\n\n  /**\n   * Creates the container that holds the row and any subcategories.\n   *\n   * @returns The div that holds the icon and the label.\n   */\n  protected createContainer_(): HTMLDivElement {\n    const container = document.createElement('div');\n    const className = this.cssConfig_['container'];\n    if (className) {\n      dom.addClass(container, className);\n    }\n    return container;\n  }\n\n  /**\n   * Creates the parent of the contents container. All clicks will happen on\n   * this div.\n   *\n   * @returns The div that holds the contents container.\n   */\n  protected createRowContainer_(): HTMLDivElement {\n    const rowDiv = document.createElement('div');\n    const className = this.cssConfig_['row'];\n    if (className) {\n      dom.addClass(rowDiv, className);\n    }\n    const nestedPadding = `${\n      ToolboxCategory.nestedPadding * this.getLevel()\n    }px`;\n    this.workspace_.RTL\n      ? (rowDiv.style.paddingRight = nestedPadding)\n      : (rowDiv.style.paddingLeft = nestedPadding);\n    return rowDiv;\n  }\n\n  /**\n   * Creates the container for the label and icon.\n   * This is necessary so we can set all subcategory pointer events to none.\n   *\n   * @returns The div that holds the icon and the label.\n   */\n  protected createRowContentsContainer_(): HTMLDivElement {\n    const contentsContainer = document.createElement('div');\n    const className = this.cssConfig_['rowcontentcontainer'];\n    if (className) {\n      dom.addClass(contentsContainer, className);\n    }\n    return contentsContainer;\n  }\n\n  /**\n   * Creates the span that holds the category icon.\n   *\n   * @returns The span that holds the category icon.\n   */\n  protected createIconDom_(): Element {\n    const toolboxIcon = document.createElement('span');\n    if (!this.parentToolbox_.isHorizontal()) {\n      const className = this.cssConfig_['icon'];\n      if (className) {\n        dom.addClass(toolboxIcon, className);\n      }\n    }\n\n    toolboxIcon.style.display = 'inline-block';\n    return toolboxIcon;\n  }\n\n  /**\n   * Creates the span that holds the category label.\n   * This should have an ID for accessibility purposes.\n   *\n   * @param name The name of the category.\n   * @returns The span that holds the category label.\n   */\n  protected createLabelDom_(name: string): Element {\n    const toolboxLabel = document.createElement('span');\n    toolboxLabel.setAttribute('id', this.getId() + '.label');\n    toolboxLabel.textContent = name;\n    const className = this.cssConfig_['label'];\n    if (className) {\n      dom.addClass(toolboxLabel, className);\n    }\n    return toolboxLabel;\n  }\n\n  /** Updates the colour for this category. */\n  refreshTheme() {\n    this.colour_ = this.getColour_(this.toolboxItemDef_);\n    this.addColourBorder_(this.colour_);\n  }\n\n  /**\n   * Add the strip of colour to the toolbox category.\n   *\n   * @param colour The category colour.\n   */\n  protected addColourBorder_(colour: string) {\n    if (colour) {\n      const border =\n        ToolboxCategory.borderWidth + 'px solid ' + (colour || '#ddd');\n      if (this.workspace_.RTL) {\n        this.rowDiv_!.style.borderRight = border;\n      } else {\n        this.rowDiv_!.style.borderLeft = border;\n      }\n    }\n  }\n\n  /**\n   * Gets either the colour or the style for a category.\n   *\n   * @param categoryDef The object holding information on the category.\n   * @returns The hex colour for the category.\n   */\n  protected getColour_(categoryDef: CategoryInfo): string {\n    const styleName =\n      categoryDef['categorystyle'] || (categoryDef as any)['categoryStyle'];\n    const colour = categoryDef['colour'];\n\n    if (colour && styleName) {\n      console.warn(\n        'Toolbox category \"' +\n          this.name_ +\n          '\" must not have both a style and a colour',\n      );\n    } else if (styleName) {\n      return this.getColourfromStyle_(styleName);\n    } else if (colour) {\n      return this.parseColour_(colour);\n    }\n    return '';\n  }\n\n  /**\n   * Sets the colour for the category using the style name and returns the new\n   * colour as a hex string.\n   *\n   * @param styleName Name of the style.\n   * @returns The hex colour for the category.\n   */\n  private getColourfromStyle_(styleName: string): string {\n    const theme = this.workspace_.getTheme();\n    if (styleName && theme) {\n      const style = theme.categoryStyles[styleName];\n      if (style && style.colour) {\n        return this.parseColour_(style.colour);\n      } else {\n        console.warn(\n          'Style \"' + styleName + '\" must exist and contain a colour value',\n        );\n      }\n    }\n    return '';\n  }\n\n  /**\n   * Gets the HTML element that is clickable.\n   * The parent toolbox element receives clicks. The parent toolbox will add an\n   * ID to this element so it can pass the onClick event to the correct\n   * toolboxItem.\n   *\n   * @returns The HTML element that receives clicks.\n   */\n  override getClickTarget(): Element {\n    return this.rowDiv_ as Element;\n  }\n\n  /**\n   * Parses the colour on the category.\n   *\n   * @param colourValue HSV hue value (0 to 360), #RRGGBB string, or a message\n   *     reference string pointing to one of those two values.\n   * @returns The hex colour for the category.\n   */\n  private parseColour_(colourValue: number | string): string {\n    // Decode the colour for any potential message references\n    // (eg. `%{BKY_MATH_HUE}`).\n    const colour = parsing.replaceMessageReferences(colourValue);\n    if (colour == null || colour === '') {\n      // No attribute. No colour.\n      return '';\n    } else {\n      const hue = Number(colour);\n      if (!isNaN(hue)) {\n        return colourUtils.hueToHex(hue);\n      } else {\n        const hex = colourUtils.parse(colour);\n        if (hex) {\n          return hex;\n        } else {\n          console.warn(\n            'Toolbox category \"' +\n              this.name_ +\n              '\" has unrecognized colour attribute: ' +\n              colour,\n          );\n          return '';\n        }\n      }\n    }\n  }\n\n  /**\n   * Adds appropriate classes to display an open icon.\n   *\n   * @param iconDiv The div that holds the icon.\n   */\n  protected openIcon_(iconDiv: Element | null) {\n    if (!iconDiv) {\n      return;\n    }\n    const closedIconClass = this.cssConfig_['closedicon'];\n    if (closedIconClass) {\n      dom.removeClasses(iconDiv, closedIconClass);\n    }\n    const className = this.cssConfig_['openicon'];\n    if (className) {\n      dom.addClass(iconDiv, className);\n    }\n  }\n\n  /**\n   * Adds appropriate classes to display a closed icon.\n   *\n   * @param iconDiv The div that holds the icon.\n   */\n  protected closeIcon_(iconDiv: Element | null) {\n    if (!iconDiv) {\n      return;\n    }\n    const openIconClass = this.cssConfig_['openicon'];\n    if (openIconClass) {\n      dom.removeClasses(iconDiv, openIconClass);\n    }\n    const className = this.cssConfig_['closedicon'];\n    if (className) {\n      dom.addClass(iconDiv, className);\n    }\n  }\n\n  /**\n   * Sets whether the category is visible or not.\n   * For a category to be visible its parent category must also be expanded.\n   *\n   * @param isVisible True if category should be visible.\n   */\n  override setVisible_(isVisible: boolean) {\n    this.htmlDiv_!.style.display = isVisible ? 'block' : 'none';\n    this.isHidden_ = !isVisible;\n\n    if (this.parentToolbox_.getSelectedItem() === this) {\n      this.parentToolbox_.clearSelection();\n    }\n  }\n\n  /** Hide the category. */\n  hide() {\n    this.setVisible_(false);\n  }\n\n  /**\n   * Show the category. Category will only appear if its parent category is also\n   * expanded.\n   */\n  show() {\n    this.setVisible_(true);\n  }\n\n  /**\n   * Whether the category is visible.\n   * A category is only visible if all of its ancestors are expanded and\n   * isHidden_ is false.\n   *\n   * @returns True if the category is visible, false otherwise.\n   */\n  isVisible(): boolean {\n    return !this.isHidden_ && this.allAncestorsExpanded_();\n  }\n\n  /**\n   * Whether all ancestors of a category (parent and parent's parent, etc.) are\n   * expanded.\n   *\n   * @returns True only if every ancestor is expanded\n   */\n  protected allAncestorsExpanded_(): boolean {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let category: IToolboxItem = this;\n    while (category.getParent()) {\n      category = category.getParent()!;\n      if (!(category as ICollapsibleToolboxItem).isExpanded()) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  override isSelectable() {\n    return this.isVisible() && !this.isDisabled_;\n  }\n\n  /**\n   * Handles when the toolbox item is clicked.\n   *\n   * @param _e Click event to handle.\n   */\n  onClick(_e: Event) {}\n  // No-op\n\n  /**\n   * Sets the current category as selected.\n   *\n   * @param isSelected True if this category is selected, false otherwise.\n   */\n  setSelected(isSelected: boolean) {\n    if (!this.rowDiv_) {\n      return;\n    }\n    const className = this.cssConfig_['selected'];\n    if (isSelected) {\n      const defaultColour = this.parseColour_(\n        ToolboxCategory.defaultBackgroundColour,\n      );\n      this.rowDiv_.style.backgroundColor = this.colour_ || defaultColour;\n      if (className) {\n        dom.addClass(this.rowDiv_, className);\n      }\n    } else {\n      this.rowDiv_.style.backgroundColor = '';\n      if (className) {\n        dom.removeClass(this.rowDiv_, className);\n      }\n    }\n    aria.setState(this.htmlDiv_ as Element, aria.State.SELECTED, isSelected);\n  }\n\n  /**\n   * Sets whether the category is disabled.\n   *\n   * @param isDisabled True to disable the category, false otherwise.\n   */\n  setDisabled(isDisabled: boolean) {\n    this.isDisabled_ = isDisabled;\n    this.getDiv()!.setAttribute('disabled', `${isDisabled}`);\n    isDisabled\n      ? this.getDiv()!.setAttribute('disabled', 'true')\n      : this.getDiv()!.removeAttribute('disabled');\n  }\n\n  /**\n   * Gets the name of the category. Used for emitting events.\n   *\n   * @returns The name of the toolbox item.\n   */\n  getName(): string {\n    return this.name_;\n  }\n\n  override getParent() {\n    return this.parent_;\n  }\n\n  override getDiv() {\n    return this.htmlDiv_;\n  }\n\n  /**\n   * Gets the contents of the category. These are items that are meant to be\n   * displayed in the flyout.\n   *\n   * @returns The definition of items to be displayed in the flyout.\n   */\n  getContents(): FlyoutItemInfoArray | string {\n    return this.flyoutItems_;\n  }\n\n  /**\n   * Updates the contents to be displayed in the flyout.\n   * If the flyout is open when the contents are updated, refreshSelection on\n   * the toolbox must also be called.\n   *\n   * @param contents The contents to be displayed in the flyout. A string can be\n   *     supplied to create a dynamic category.\n   */\n  updateFlyoutContents(contents: FlyoutDefinition | string) {\n    this.flyoutItems_ = [];\n\n    if (typeof contents === 'string') {\n      const newDefinition: DynamicCategoryInfo = {\n        kind: this.toolboxItemDef_.kind,\n        custom: contents,\n        id: this.toolboxItemDef_.id,\n        categorystyle: this.toolboxItemDef_.categorystyle,\n        colour: this.toolboxItemDef_.colour,\n        cssconfig: this.toolboxItemDef_.cssconfig,\n        hidden: this.toolboxItemDef_.hidden,\n      };\n      this.toolboxItemDef_ = newDefinition;\n    } else {\n      const newDefinition: StaticCategoryInfo = {\n        kind: this.toolboxItemDef_.kind,\n        name:\n          'name' in this.toolboxItemDef_ ? this.toolboxItemDef_['name'] : '',\n        contents: toolbox.convertFlyoutDefToJsonArray(contents),\n        id: this.toolboxItemDef_.id,\n        categorystyle: this.toolboxItemDef_.categorystyle,\n        colour: this.toolboxItemDef_.colour,\n        cssconfig: this.toolboxItemDef_.cssconfig,\n        hidden: this.toolboxItemDef_.hidden,\n      };\n      this.toolboxItemDef_ = newDefinition;\n    }\n    this.parseContents_(this.toolboxItemDef_);\n  }\n\n  override dispose() {\n    dom.removeNode(this.htmlDiv_);\n  }\n}\n\nexport namespace ToolboxCategory {\n  /** All the CSS class names that are used to create a category. */\n  export interface CssConfig {\n    container?: string;\n    row?: string;\n    rowcontentcontainer?: string;\n    icon?: string;\n    label?: string;\n    contents?: string;\n    selected?: string;\n    openicon?: string;\n    closedicon?: string;\n  }\n}\n\nexport type CssConfig = ToolboxCategory.CssConfig;\n\n/** CSS for Toolbox.  See css.js for use. */\nCss.register(`\n.blocklyTreeRow:not(.blocklyTreeSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolboxDiv[layout=\"h\"] .blocklyToolboxCategory {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"][layout=\"h\"] .blocklyToolboxCategory {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyTreeRow {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeRow {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyTreeIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyTreeIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyTreeIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyTreeLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyTreeLabel {\n  cursor: url(\"<<<PATH>>>/handdelete.cur\"), auto;\n}\n\n.blocklyTreeSelected .blocklyTreeLabel {\n  color: #fff;\n}\n`);\n\nregistry.register(\n  registry.Type.TOOLBOX_ITEM,\n  ToolboxCategory.registrationName,\n  ToolboxCategory,\n);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A separator used for separating toolbox categories.\n *\n * @class\n */\n// Former goog.module ID: Blockly.ToolboxSeparator\n\nimport * as Css from '../css.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport * as registry from '../registry.js';\nimport * as dom from '../utils/dom.js';\nimport type * as toolbox from '../utils/toolbox.js';\n\nimport {ToolboxItem} from './toolbox_item.js';\n\n/**\n * Class for a toolbox separator. This is the thin visual line that appears on\n * the toolbox. This item is not interactable.\n */\nexport class ToolboxSeparator extends ToolboxItem {\n  /** Name used for registering a toolbox separator. */\n  static registrationName = 'sep';\n\n  /** All the CSS class names that are used to create a separator. */\n  protected cssConfig_: CssConfig = {'container': 'blocklyTreeSeparator'};\n\n  private htmlDiv_: HTMLDivElement | null = null;\n\n  /**\n   * @param separatorDef The information needed to create a separator.\n   * @param toolbox The parent toolbox for the separator.\n   */\n  constructor(separatorDef: toolbox.SeparatorInfo, toolbox: IToolbox) {\n    super(separatorDef, toolbox);\n\n    const cssConfig =\n      separatorDef['cssconfig'] || (separatorDef as any)['cssConfig'];\n    Object.assign(this.cssConfig_, cssConfig);\n  }\n\n  override init() {\n    this.createDom_();\n  }\n\n  /**\n   * Creates the DOM for a separator.\n   *\n   * @returns The parent element for the separator.\n   */\n  protected createDom_(): HTMLDivElement {\n    const container = document.createElement('div');\n    const className = this.cssConfig_['container'];\n    if (className) {\n      dom.addClass(container, className);\n    }\n    this.htmlDiv_ = container;\n    return container;\n  }\n\n  override getDiv() {\n    return this.htmlDiv_ as HTMLDivElement;\n  }\n\n  override dispose() {\n    dom.removeNode(this.htmlDiv_ as HTMLDivElement);\n  }\n}\n\nexport namespace ToolboxSeparator {\n  export interface CssConfig {\n    container: string | undefined;\n  }\n}\n\nexport type CssConfig = ToolboxSeparator.CssConfig;\n\n/** CSS for Toolbox.  See css.js for use. */\nCss.register(`\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolboxDiv[layout=\"h\"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n`);\n\nregistry.register(\n  registry.Type.TOOLBOX_ITEM,\n  ToolboxSeparator.registrationName,\n  ToolboxSeparator,\n);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A toolbox category used to organize blocks in the toolbox.\n *\n * @class\n */\n// Former goog.module ID: Blockly.CollapsibleToolboxCategory\n\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport * as registry from '../registry.js';\nimport * as aria from '../utils/aria.js';\nimport * as dom from '../utils/dom.js';\nimport * as toolbox from '../utils/toolbox.js';\n\nimport {ToolboxCategory} from './category.js';\nimport {ToolboxSeparator} from './separator.js';\n\n/**\n * Class for a category in a toolbox that can be collapsed.\n */\nexport class CollapsibleToolboxCategory\n  extends ToolboxCategory\n  implements ICollapsibleToolboxItem\n{\n  /** Name used for registering a collapsible toolbox category. */\n  static override registrationName = 'collapsibleCategory';\n\n  /** Container for any child categories. */\n  protected subcategoriesDiv_: HTMLDivElement | null = null;\n\n  /** Whether or not the category should display its subcategories. */\n  protected expanded_ = false;\n\n  /** The child toolbox items for this category. */\n  protected toolboxItems_: IToolboxItem[] = [];\n\n  /**\n   * @param categoryDef The information needed to create a category in the\n   *     toolbox.\n   * @param toolbox The parent toolbox for the category.\n   * @param opt_parent The parent category or null if the category does not have\n   *     a parent.\n   */\n  constructor(\n    categoryDef: toolbox.CategoryInfo,\n    toolbox: IToolbox,\n    opt_parent?: ICollapsibleToolboxItem,\n  ) {\n    super(categoryDef, toolbox, opt_parent);\n  }\n\n  override makeDefaultCssConfig_() {\n    const cssConfig = super.makeDefaultCssConfig_();\n    cssConfig['contents'] = 'blocklyToolboxContents';\n    return cssConfig;\n  }\n\n  override parseContents_(categoryDef: toolbox.CategoryInfo) {\n    if ('custom' in categoryDef) {\n      this.flyoutItems_ = categoryDef['custom'];\n    } else {\n      const contents = categoryDef['contents'];\n      if (!contents) return;\n      this.flyoutItems_ = [];\n      let prevIsFlyoutItem = true;\n      for (let i = 0; i < contents.length; i++) {\n        const itemDef = contents[i];\n        // Separators can exist as either a flyout item or a toolbox item so\n        // decide where it goes based on the type of the previous item.\n        if (\n          !registry.hasItem(registry.Type.TOOLBOX_ITEM, itemDef['kind']) ||\n          (itemDef['kind'].toLowerCase() ===\n            ToolboxSeparator.registrationName &&\n            prevIsFlyoutItem)\n        ) {\n          const flyoutItem = itemDef as toolbox.FlyoutItemInfo;\n          this.flyoutItems_.push(flyoutItem);\n          prevIsFlyoutItem = true;\n        } else {\n          this.createToolboxItem_(itemDef);\n          prevIsFlyoutItem = false;\n        }\n      }\n    }\n  }\n\n  /**\n   * Creates a toolbox item and adds it to the list of toolbox items.\n   *\n   * @param itemDef The information needed to create a toolbox item.\n   */\n  private createToolboxItem_(itemDef: toolbox.ToolboxItemInfo) {\n    let registryName = itemDef['kind'];\n    const categoryDef = itemDef as toolbox.CategoryInfo;\n    // Categories that are collapsible are created using a class registered\n    // under a different name.\n    if (\n      registryName.toUpperCase() === 'CATEGORY' &&\n      toolbox.isCategoryCollapsible(categoryDef)\n    ) {\n      registryName = CollapsibleToolboxCategory.registrationName;\n    }\n    const ToolboxItemClass = registry.getClass(\n      registry.Type.TOOLBOX_ITEM,\n      registryName,\n    );\n    const toolboxItem = new ToolboxItemClass!(\n      itemDef,\n      this.parentToolbox_,\n      this,\n    );\n    this.toolboxItems_.push(toolboxItem);\n  }\n\n  override init() {\n    super.init();\n\n    this.setExpanded(\n      this.toolboxItemDef_['expanded'] === 'true' ||\n        this.toolboxItemDef_['expanded'] === true,\n    );\n  }\n\n  override createDom_() {\n    super.createDom_();\n\n    const subCategories = this.getChildToolboxItems();\n    this.subcategoriesDiv_ = this.createSubCategoriesDom_(subCategories);\n    aria.setRole(this.subcategoriesDiv_, aria.Role.GROUP);\n    this.htmlDiv_!.appendChild(this.subcategoriesDiv_);\n    this.closeIcon_(this.iconDom_);\n    aria.setState(this.htmlDiv_ as HTMLDivElement, aria.State.EXPANDED, false);\n\n    return this.htmlDiv_!;\n  }\n\n  override createIconDom_() {\n    const toolboxIcon = document.createElement('span');\n    if (!this.parentToolbox_.isHorizontal()) {\n      const className = this.cssConfig_['icon'];\n      if (className) {\n        dom.addClass(toolboxIcon, className);\n      }\n      toolboxIcon.style.visibility = 'visible';\n    }\n\n    toolboxIcon.style.display = 'inline-block';\n    return toolboxIcon;\n  }\n\n  /**\n   * Create the DOM for all subcategories.\n   *\n   * @param subcategories The subcategories.\n   * @returns The div holding all the subcategories.\n   */\n  protected createSubCategoriesDom_(\n    subcategories: IToolboxItem[],\n  ): HTMLDivElement {\n    const contentsContainer = document.createElement('div');\n    contentsContainer.style.display = 'none';\n    const className = this.cssConfig_['contents'];\n    if (className) {\n      dom.addClass(contentsContainer, className);\n    }\n\n    for (let i = 0; i < subcategories.length; i++) {\n      const newCategory = subcategories[i];\n      newCategory.init();\n      const newCategoryDiv = newCategory.getDiv();\n      contentsContainer.appendChild(newCategoryDiv!);\n      if (newCategory.getClickTarget) {\n        newCategory.getClickTarget()?.setAttribute('id', newCategory.getId());\n      }\n    }\n    return contentsContainer;\n  }\n\n  /**\n   * Opens or closes the current category and the associated flyout.\n   *\n   * @param isExpanded True to expand the category, false to close.\n   */\n  setExpanded(isExpanded: boolean) {\n    if (this.expanded_ === isExpanded) return;\n\n    this.expanded_ = isExpanded;\n    if (isExpanded) {\n      this.subcategoriesDiv_!.style.display = 'block';\n      this.openIcon_(this.iconDom_);\n    } else {\n      this.parentToolbox_.getFlyout()?.setVisible(false);\n      this.subcategoriesDiv_!.style.display = 'none';\n      this.closeIcon_(this.iconDom_);\n    }\n    aria.setState(\n      this.htmlDiv_ as HTMLDivElement,\n      aria.State.EXPANDED,\n      isExpanded,\n    );\n\n    this.parentToolbox_.handleToolboxItemResize();\n  }\n\n  override setVisible_(isVisible: boolean) {\n    this.htmlDiv_!.style.display = isVisible ? 'block' : 'none';\n    const childToolboxItems = this.getChildToolboxItems();\n    for (let i = 0; i < childToolboxItems.length; i++) {\n      const child = childToolboxItems[i];\n      child.setVisible_(isVisible);\n    }\n    this.isHidden_ = !isVisible;\n\n    if (this.parentToolbox_.getSelectedItem() === this) {\n      this.parentToolbox_.clearSelection();\n    }\n  }\n\n  /**\n   * Whether the category is expanded to show its child subcategories.\n   *\n   * @returns True if the toolbox item shows its children, false if it is\n   *     collapsed.\n   */\n  isExpanded(): boolean {\n    return this.expanded_;\n  }\n\n  override isCollapsible() {\n    return true;\n  }\n\n  override onClick(_e: Event) {\n    this.toggleExpanded();\n  }\n\n  /** Toggles whether or not the category is expanded. */\n  toggleExpanded() {\n    this.setExpanded(!this.expanded_);\n  }\n\n  override getDiv() {\n    return this.htmlDiv_;\n  }\n\n  /**\n   * Gets any children toolbox items. (ex. Gets the subcategories)\n   *\n   * @returns The child toolbox items.\n   */\n  getChildToolboxItems(): IToolboxItem[] {\n    return this.toolboxItems_;\n  }\n}\n\nexport namespace CollapsibleToolboxCategory {\n  /**\n   * All the CSS class names that are used to create a collapsible\n   * category. This is all the properties from the regular category plus\n   * contents.\n   */\n  export interface CssConfig {\n    container: string | null;\n    row: string | null;\n    rowcontentcontainer: string | null;\n    icon: string | null;\n    label: string | null;\n    selected: string | null;\n    openicon: string | null;\n    closedicon: string | null;\n    contents: string | null;\n  }\n}\n\nexport type CssConfig = CollapsibleToolboxCategory.CssConfig;\n\nregistry.register(\n  registry.Type.TOOLBOX_ITEM,\n  CollapsibleToolboxCategory.registrationName,\n  CollapsibleToolboxCategory,\n);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Toolbox from whence to create blocks.\n *\n * @class\n */\n// Former goog.module ID: Blockly.Toolbox\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport '../events/events_toolbox_item_select.js';\n\nimport {BlockSvg} from '../block_svg.js';\nimport type {BlocklyOptions} from '../blockly_options.js';\nimport * as browserEvents from '../browser_events.js';\nimport * as common from '../common.js';\nimport {ComponentManager} from '../component_manager.js';\nimport * as Css from '../css.js';\nimport {DeleteArea} from '../delete_area.js';\nimport * as eventUtils from '../events/utils.js';\nimport type {IAutoHideable} from '../interfaces/i_autohideable.js';\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {IDraggable} from '../interfaces/i_draggable.js';\nimport type {IFlyout} from '../interfaces/i_flyout.js';\nimport type {IKeyboardAccessible} from '../interfaces/i_keyboard_accessible.js';\nimport type {ISelectableToolboxItem} from '../interfaces/i_selectable_toolbox_item.js';\nimport {isSelectableToolboxItem} from '../interfaces/i_selectable_toolbox_item.js';\nimport type {IStyleable} from '../interfaces/i_styleable.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport {Options} from '../options.js';\nimport * as registry from '../registry.js';\nimport type {KeyboardShortcut} from '../shortcut_registry.js';\nimport * as Touch from '../touch.js';\nimport * as aria from '../utils/aria.js';\nimport * as dom from '../utils/dom.js';\nimport {Rect} from '../utils/rect.js';\nimport * as toolbox from '../utils/toolbox.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\nimport type {ToolboxCategory} from './category.js';\nimport {CollapsibleToolboxCategory} from './collapsible_category.js';\nimport {isDeletable} from '../interfaces/i_deletable.js';\n\n/**\n * Class for a Toolbox.\n * Creates the toolbox's DOM.\n */\nexport class Toolbox\n  extends DeleteArea\n  implements IAutoHideable, IKeyboardAccessible, IStyleable, IToolbox\n{\n  /**\n   * The unique ID for this component that is used to register with the\n   * ComponentManager.\n   */\n  override id = 'toolbox';\n  protected toolboxDef_: toolbox.ToolboxInfo;\n  private readonly horizontalLayout_: boolean;\n\n  /** The HTML container for the toolbox. */\n  HtmlDiv: HTMLDivElement | null = null;\n\n  /** The HTML container for the contents of a toolbox. */\n  protected contentsDiv_: HTMLDivElement | null = null;\n\n  /** Whether the Toolbox is visible. */\n  protected isVisible_ = false;\n\n  /** The list of items in the toolbox. */\n  protected contents_: IToolboxItem[] = [];\n\n  /** The width of the toolbox. */\n  protected width_ = 0;\n\n  /** The height of the toolbox. */\n  protected height_ = 0;\n  RTL: boolean;\n\n  /** The flyout for the toolbox. */\n  private flyout_: IFlyout | null = null;\n  protected contentMap_: {[key: string]: IToolboxItem};\n  toolboxPosition: toolbox.Position;\n\n  /** The currently selected item. */\n  protected selectedItem_: ISelectableToolboxItem | null = null;\n\n  /** The previously selected item. */\n  protected previouslySelectedItem_: ISelectableToolboxItem | null = null;\n\n  /**\n   * Array holding info needed to unbind event handlers.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  protected boundEvents_: browserEvents.Data[] = [];\n\n  /** The workspace this toolbox is on. */\n  protected readonly workspace_: WorkspaceSvg;\n\n  /** @param workspace The workspace in which to create new blocks. */\n  constructor(workspace: WorkspaceSvg) {\n    super();\n\n    this.workspace_ = workspace;\n\n    /** The JSON describing the contents of this toolbox. */\n    this.toolboxDef_ = workspace.options.languageTree || {\n      contents: new Array<toolbox.ToolboxItemInfo>(),\n    };\n\n    /** Whether the toolbox should be laid out horizontally. */\n    this.horizontalLayout_ = workspace.options.horizontalLayout;\n\n    /** Is RTL vs LTR. */\n    this.RTL = workspace.options.RTL;\n\n    /** A map from toolbox item IDs to toolbox items. */\n    this.contentMap_ = Object.create(null);\n\n    /** Position of the toolbox and flyout relative to the workspace. */\n    this.toolboxPosition = workspace.options.toolboxPosition;\n  }\n\n  /**\n   * Handles the given keyboard shortcut.\n   *\n   * @param _shortcut The shortcut to be handled.\n   * @returns True if the shortcut has been handled, false otherwise.\n   */\n  onShortcut(_shortcut: KeyboardShortcut): boolean {\n    return false;\n  }\n\n  /** Initializes the toolbox */\n  init() {\n    const workspace = this.workspace_;\n    const svg = workspace.getParentSvg();\n\n    this.flyout_ = this.createFlyout_();\n\n    this.HtmlDiv = this.createDom_(this.workspace_);\n    dom.insertAfter(this.flyout_.createDom('svg'), svg);\n    this.setVisible(true);\n    this.flyout_.init(workspace);\n\n    this.render(this.toolboxDef_);\n    const themeManager = workspace.getThemeManager();\n    themeManager.subscribe(\n      this.HtmlDiv,\n      'toolboxBackgroundColour',\n      'background-color',\n    );\n    themeManager.subscribe(this.HtmlDiv, 'toolboxForegroundColour', 'color');\n    this.workspace_.getComponentManager().addComponent({\n      component: this,\n      weight: 1,\n      capabilities: [\n        ComponentManager.Capability.AUTOHIDEABLE,\n        ComponentManager.Capability.DELETE_AREA,\n        ComponentManager.Capability.DRAG_TARGET,\n      ],\n    });\n  }\n\n  /**\n   * Creates the DOM for the toolbox.\n   *\n   * @param workspace The workspace this toolbox is on.\n   * @returns The HTML container for the toolbox.\n   */\n  protected createDom_(workspace: WorkspaceSvg): HTMLDivElement {\n    const svg = workspace.getParentSvg();\n\n    const container = this.createContainer_();\n\n    this.contentsDiv_ = this.createContentsContainer_();\n    this.contentsDiv_.tabIndex = 0;\n    aria.setRole(this.contentsDiv_, aria.Role.TREE);\n    container.appendChild(this.contentsDiv_);\n\n    svg.parentNode!.insertBefore(container, svg);\n\n    this.attachEvents_(container, this.contentsDiv_);\n    return container;\n  }\n\n  /**\n   * Creates the container div for the toolbox.\n   *\n   * @returns The HTML container for the toolbox.\n   */\n  protected createContainer_(): HTMLDivElement {\n    const toolboxContainer = document.createElement('div');\n    toolboxContainer.setAttribute('layout', this.isHorizontal() ? 'h' : 'v');\n    dom.addClass(toolboxContainer, 'blocklyToolboxDiv');\n    dom.addClass(toolboxContainer, 'blocklyNonSelectable');\n    toolboxContainer.setAttribute('dir', this.RTL ? 'RTL' : 'LTR');\n    return toolboxContainer;\n  }\n\n  /**\n   * Creates the container for all the contents in the toolbox.\n   *\n   * @returns The HTML container for the toolbox contents.\n   */\n  protected createContentsContainer_(): HTMLDivElement {\n    const contentsContainer = document.createElement('div');\n    dom.addClass(contentsContainer, 'blocklyToolboxContents');\n    if (this.isHorizontal()) {\n      contentsContainer.style.flexDirection = 'row';\n    }\n    return contentsContainer;\n  }\n\n  /**\n   * Adds event listeners to the toolbox container div.\n   *\n   * @param container The HTML container for the toolbox.\n   * @param contentsContainer The HTML container for the contents of the\n   *     toolbox.\n   */\n  protected attachEvents_(\n    container: HTMLDivElement,\n    contentsContainer: HTMLDivElement,\n  ) {\n    // Clicking on toolbox closes popups.\n    const clickEvent = browserEvents.conditionalBind(\n      container,\n      'pointerdown',\n      this,\n      this.onClick_,\n      /* opt_noCaptureIdentifier */ false,\n    );\n    this.boundEvents_.push(clickEvent);\n\n    const keyDownEvent = browserEvents.conditionalBind(\n      contentsContainer,\n      'keydown',\n      this,\n      this.onKeyDown_,\n      /* opt_noCaptureIdentifier */ false,\n    );\n    this.boundEvents_.push(keyDownEvent);\n  }\n\n  /**\n   * Handles on click events for when the toolbox or toolbox items are clicked.\n   *\n   * @param e Click event to handle.\n   */\n  protected onClick_(e: PointerEvent) {\n    if (browserEvents.isRightButton(e) || e.target === this.HtmlDiv) {\n      // Close flyout.\n      (common.getMainWorkspace() as WorkspaceSvg).hideChaff(false);\n    } else {\n      const targetElement = e.target;\n      const itemId = (targetElement as Element).getAttribute('id');\n      if (itemId) {\n        const item = this.getToolboxItemById(itemId);\n        if (item!.isSelectable()) {\n          this.setSelectedItem(item);\n          (item as ISelectableToolboxItem).onClick(e);\n        }\n      }\n      // Just close popups.\n      (common.getMainWorkspace() as WorkspaceSvg).hideChaff(true);\n    }\n    Touch.clearTouchIdentifier();\n  }\n\n  /**\n   * Handles key down events for the toolbox.\n   *\n   * @param e The key down event.\n   */\n  protected onKeyDown_(e: KeyboardEvent) {\n    let handled = false;\n    switch (e.key) {\n      case 'ArrowDown':\n        handled = this.selectNext_();\n        break;\n      case 'ArrowUp':\n        handled = this.selectPrevious_();\n        break;\n      case 'ArrowLeft':\n        handled = this.selectParent_();\n        break;\n      case 'ArrowRight':\n        handled = this.selectChild_();\n        break;\n      case 'Enter':\n      case ' ':\n        if (this.selectedItem_ && this.selectedItem_.isCollapsible()) {\n          const collapsibleItem = this.selectedItem_ as ICollapsibleToolboxItem;\n          collapsibleItem.toggleExpanded();\n          handled = true;\n        }\n        break;\n      default:\n        handled = false;\n        break;\n    }\n    if (!handled && this.selectedItem_) {\n      // TODO(#6097): Figure out who implements onKeyDown and which interface it\n      // should be part of.\n      if ((this.selectedItem_ as any).onKeyDown) {\n        handled = (this.selectedItem_ as any).onKeyDown(e);\n      }\n    }\n\n    if (handled) {\n      e.preventDefault();\n    }\n  }\n\n  /**\n   * Creates the flyout based on the toolbox layout.\n   *\n   * @returns The flyout for the toolbox.\n   * @throws {Error} If missing a require for `Blockly.HorizontalFlyout`,\n   *     `Blockly.VerticalFlyout`, and no flyout plugin is specified.\n   */\n  protected createFlyout_(): IFlyout {\n    const workspace = this.workspace_;\n    // TODO (#4247): Look into adding a makeFlyout method to Blockly Options.\n    const workspaceOptions = new Options({\n      'parentWorkspace': workspace,\n      'rtl': workspace.RTL,\n      'oneBasedIndex': workspace.options.oneBasedIndex,\n      'horizontalLayout': workspace.horizontalLayout,\n      'renderer': workspace.options.renderer,\n      'rendererOverrides': workspace.options.rendererOverrides,\n      'move': {\n        'scrollbars': true,\n      },\n    } as BlocklyOptions);\n    // Options takes in either 'end' or 'start'. This has already been parsed to\n    // be either 0 or 1, so set it after.\n    workspaceOptions.toolboxPosition = workspace.options.toolboxPosition;\n    let FlyoutClass = null;\n    if (workspace.horizontalLayout) {\n      FlyoutClass = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,\n        workspace.options,\n        true,\n      );\n    } else {\n      FlyoutClass = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_VERTICAL_TOOLBOX,\n        workspace.options,\n        true,\n      );\n    }\n    return new FlyoutClass!(workspaceOptions);\n  }\n\n  /**\n   * Fills the toolbox with new toolbox items and removes any old contents.\n   *\n   * @param toolboxDef Object holding information for creating a toolbox.\n   * @internal\n   */\n  render(toolboxDef: toolbox.ToolboxInfo) {\n    this.toolboxDef_ = toolboxDef;\n    for (let i = 0; i < this.contents_.length; i++) {\n      const toolboxItem = this.contents_[i];\n      if (toolboxItem) {\n        toolboxItem.dispose();\n      }\n    }\n    this.contents_ = [];\n    this.contentMap_ = Object.create(null);\n    this.renderContents_(toolboxDef['contents']);\n    this.position();\n    this.handleToolboxItemResize();\n  }\n\n  /**\n   * Adds all the toolbox items to the toolbox.\n   *\n   * @param toolboxDef Array holding objects containing information on the\n   *     contents of the toolbox.\n   */\n  protected renderContents_(toolboxDef: toolbox.ToolboxItemInfo[]) {\n    // This is for performance reasons. By using document fragment we only have\n    // to add to the DOM once.\n    const fragment = document.createDocumentFragment();\n    for (let i = 0; i < toolboxDef.length; i++) {\n      const toolboxItemDef = toolboxDef[i];\n      this.createToolboxItem_(toolboxItemDef, fragment);\n    }\n    this.contentsDiv_!.appendChild(fragment);\n  }\n\n  /**\n   * Creates and renders the toolbox item.\n   *\n   * @param toolboxItemDef Any information that can be used to create an item in\n   *     the toolbox.\n   * @param fragment The document fragment to add the child toolbox elements to.\n   */\n  private createToolboxItem_(\n    toolboxItemDef: toolbox.ToolboxItemInfo,\n    fragment: DocumentFragment,\n  ) {\n    let registryName = toolboxItemDef['kind'];\n\n    // Categories that are collapsible are created using a class registered\n    // under a different name.\n    if (\n      registryName.toUpperCase() === 'CATEGORY' &&\n      toolbox.isCategoryCollapsible(toolboxItemDef as toolbox.CategoryInfo)\n    ) {\n      registryName = CollapsibleToolboxCategory.registrationName;\n    }\n\n    const ToolboxItemClass = registry.getClass(\n      registry.Type.TOOLBOX_ITEM,\n      registryName.toLowerCase(),\n    );\n    if (ToolboxItemClass) {\n      const toolboxItem = new ToolboxItemClass(toolboxItemDef, this);\n      toolboxItem.init();\n      this.addToolboxItem_(toolboxItem);\n      const toolboxItemDom = toolboxItem.getDiv();\n      if (toolboxItemDom) {\n        fragment.appendChild(toolboxItemDom);\n      }\n      // Adds the ID to the HTML element that can receive a click.\n      // This is used in onClick_ to find the toolboxItem that was clicked.\n      if (toolboxItem.getClickTarget()) {\n        toolboxItem.getClickTarget()!.setAttribute('id', toolboxItem.getId());\n      }\n    }\n  }\n\n  /**\n   * Adds an item to the toolbox.\n   *\n   * @param toolboxItem The item in the toolbox.\n   */\n  protected addToolboxItem_(toolboxItem: IToolboxItem) {\n    this.contents_.push(toolboxItem);\n    this.contentMap_[toolboxItem.getId()] = toolboxItem;\n    if (toolboxItem.isCollapsible()) {\n      const collapsibleItem = toolboxItem as ICollapsibleToolboxItem;\n      const childToolboxItems = collapsibleItem.getChildToolboxItems();\n      for (let i = 0; i < childToolboxItems.length; i++) {\n        const child = childToolboxItems[i];\n        this.addToolboxItem_(child);\n      }\n    }\n  }\n\n  /**\n   * Gets the items in the toolbox.\n   *\n   * @returns The list of items in the toolbox.\n   */\n  getToolboxItems(): IToolboxItem[] {\n    return this.contents_;\n  }\n\n  /**\n   * Adds a style on the toolbox. Usually used to change the cursor.\n   *\n   * @param style The name of the class to add.\n   * @internal\n   */\n  addStyle(style: string) {\n    if (style && this.HtmlDiv) {\n      dom.addClass(this.HtmlDiv, style);\n    }\n  }\n\n  /**\n   * Removes a style from the toolbox. Usually used to change the cursor.\n   *\n   * @param style The name of the class to remove.\n   * @internal\n   */\n  removeStyle(style: string) {\n    if (style && this.HtmlDiv) {\n      dom.removeClass(this.HtmlDiv, style);\n    }\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect | null {\n    if (!this.HtmlDiv || !this.isVisible_) {\n      return null;\n    }\n    // BIG_NUM is offscreen padding so that blocks dragged beyond the toolbox\n    // area are still deleted.  Must be smaller than Infinity, but larger than\n    // the largest screen size.\n    const BIG_NUM = 10000000;\n    const toolboxRect = this.HtmlDiv.getBoundingClientRect();\n\n    const top = toolboxRect.top;\n    const bottom = top + toolboxRect.height;\n    const left = toolboxRect.left;\n    const right = left + toolboxRect.width;\n\n    // Assumes that the toolbox is on the SVG edge.  If this changes\n    // (e.g. toolboxes in mutators) then this code will need to be more complex.\n    if (this.toolboxPosition === toolbox.Position.TOP) {\n      return new Rect(-BIG_NUM, bottom, -BIG_NUM, BIG_NUM);\n    } else if (this.toolboxPosition === toolbox.Position.BOTTOM) {\n      return new Rect(top, BIG_NUM, -BIG_NUM, BIG_NUM);\n    } else if (this.toolboxPosition === toolbox.Position.LEFT) {\n      return new Rect(-BIG_NUM, BIG_NUM, -BIG_NUM, right);\n    } else {\n      // Right\n      return new Rect(-BIG_NUM, BIG_NUM, left, BIG_NUM);\n    }\n  }\n\n  /**\n   * Returns whether the provided block or bubble would be deleted if dropped on\n   * this area.\n   * This method should check if the element is deletable and is always called\n   * before onDragEnter/onDragOver/onDragExit.\n   *\n   * @param element The block or bubble currently being dragged.\n   * @returns Whether the element provided would be deleted if dropped on this\n   *     area.\n   */\n  override wouldDelete(element: IDraggable): boolean {\n    if (element instanceof BlockSvg) {\n      const block = element;\n      this.updateWouldDelete_(!block.getParent() && block.isDeletable());\n    } else {\n      this.updateWouldDelete_(isDeletable(element) && element.isDeletable());\n    }\n    return this.wouldDelete_;\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble enters this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragEnter(_dragElement: IDraggable) {\n    this.updateCursorDeleteStyle_(true);\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble exits this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragExit(_dragElement: IDraggable) {\n    this.updateCursorDeleteStyle_(false);\n  }\n\n  /**\n   * Handles when a block or bubble is dropped on this component.\n   * Should not handle delete here.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDrop(_dragElement: IDraggable) {\n    this.updateCursorDeleteStyle_(false);\n  }\n\n  /**\n   * Updates the internal wouldDelete_ state.\n   *\n   * @param wouldDelete The new value for the wouldDelete state.\n   */\n  protected override updateWouldDelete_(wouldDelete: boolean) {\n    if (wouldDelete === this.wouldDelete_) {\n      return;\n    }\n    // This logic handles updating the deleteStyle properly if the delete state\n    // changes while the block is over the Toolbox. This could happen if the\n    // implementation of wouldDeleteBlock depends on the couldConnect parameter\n    // or if the isDeletable property of the block currently being dragged\n    // changes during the drag.\n    this.updateCursorDeleteStyle_(false);\n    this.wouldDelete_ = wouldDelete;\n    this.updateCursorDeleteStyle_(true);\n  }\n\n  /**\n   * Adds or removes the CSS style of the cursor over the toolbox based whether\n   * the block or bubble over it is expected to be deleted if dropped (using the\n   * internal this.wouldDelete_ property).\n   *\n   * @param addStyle Whether the style should be added or removed.\n   */\n  protected updateCursorDeleteStyle_(addStyle: boolean) {\n    const style = this.wouldDelete_\n      ? 'blocklyToolboxDelete'\n      : 'blocklyToolboxGrab';\n    if (addStyle) {\n      this.addStyle(style);\n    } else {\n      this.removeStyle(style);\n    }\n  }\n\n  /**\n   * Gets the toolbox item with the given ID.\n   *\n   * @param id The ID of the toolbox item.\n   * @returns The toolbox item with the given ID, or null if no item exists.\n   */\n  getToolboxItemById(id: string): IToolboxItem | null {\n    return this.contentMap_[id] || null;\n  }\n\n  /**\n   * Gets the width of the toolbox.\n   *\n   * @returns The width of the toolbox.\n   */\n  getWidth(): number {\n    return this.width_;\n  }\n\n  /**\n   * Gets the height of the toolbox.\n   *\n   * @returns The width of the toolbox.\n   */\n  getHeight(): number {\n    return this.height_;\n  }\n\n  /**\n   * Gets the toolbox flyout.\n   *\n   * @returns The toolbox flyout.\n   */\n  getFlyout(): IFlyout | null {\n    return this.flyout_;\n  }\n\n  /**\n   * Gets the workspace for the toolbox.\n   *\n   * @returns The parent workspace for the toolbox.\n   */\n  getWorkspace(): WorkspaceSvg {\n    return this.workspace_;\n  }\n\n  /**\n   * Gets the selected item.\n   *\n   * @returns The selected item, or null if no item is currently selected.\n   */\n  getSelectedItem(): ISelectableToolboxItem | null {\n    return this.selectedItem_;\n  }\n\n  /**\n   * Gets the previously selected item.\n   *\n   * @returns The previously selected item, or null if no item was previously\n   *     selected.\n   */\n  getPreviouslySelectedItem(): ISelectableToolboxItem | null {\n    return this.previouslySelectedItem_;\n  }\n\n  /**\n   * Gets whether or not the toolbox is horizontal.\n   *\n   * @returns True if the toolbox is horizontal, false if the toolbox is\n   *     vertical.\n   */\n  isHorizontal(): boolean {\n    return this.horizontalLayout_;\n  }\n\n  /**\n   * Positions the toolbox based on whether it is a horizontal toolbox and\n   * whether the workspace is in rtl.\n   */\n  position() {\n    const workspaceMetrics = this.workspace_.getMetrics();\n    const toolboxDiv = this.HtmlDiv;\n    if (!toolboxDiv) {\n      // Not initialized yet.\n      return;\n    }\n\n    if (this.horizontalLayout_) {\n      toolboxDiv.style.left = '0';\n      toolboxDiv.style.height = 'auto';\n      toolboxDiv.style.width = '100%';\n      this.height_ = toolboxDiv.offsetHeight;\n      this.width_ = workspaceMetrics.viewWidth;\n      if (this.toolboxPosition === toolbox.Position.TOP) {\n        toolboxDiv.style.top = '0';\n      } else {\n        // Bottom\n        toolboxDiv.style.bottom = '0';\n      }\n    } else {\n      if (this.toolboxPosition === toolbox.Position.RIGHT) {\n        toolboxDiv.style.right = '0';\n      } else {\n        // Left\n        toolboxDiv.style.left = '0';\n      }\n      toolboxDiv.style.height = '100%';\n      this.width_ = toolboxDiv.offsetWidth;\n      this.height_ = workspaceMetrics.viewHeight;\n    }\n    this.flyout_!.position();\n  }\n\n  /**\n   * Handles resizing the toolbox when a toolbox item resizes.\n   *\n   * @internal\n   */\n  handleToolboxItemResize() {\n    // Reposition the workspace so that (0,0) is in the correct position\n    // relative to the new absolute edge (ie toolbox edge).\n    const workspace = this.workspace_;\n    const rect = this.HtmlDiv!.getBoundingClientRect();\n    const newX =\n      this.toolboxPosition === toolbox.Position.LEFT\n        ? workspace.scrollX + rect.width\n        : workspace.scrollX;\n    const newY =\n      this.toolboxPosition === toolbox.Position.TOP\n        ? workspace.scrollY + rect.height\n        : workspace.scrollY;\n    workspace.translate(newX, newY);\n\n    // Even though the div hasn't changed size, the visible workspace\n    // surface of the workspace has, so we may need to reposition everything.\n    common.svgResize(workspace);\n  }\n\n  /** Unhighlights any previously selected item. */\n  clearSelection() {\n    this.setSelectedItem(null);\n  }\n\n  /**\n   * Updates the category colours and background colour of selected categories.\n   *\n   * @internal\n   */\n  refreshTheme() {\n    for (let i = 0; i < this.contents_.length; i++) {\n      const child = this.contents_[i];\n      // TODO(#6097): Fix types or add refreshTheme to IToolboxItem.\n      const childAsCategory = child as ToolboxCategory;\n      if (childAsCategory.refreshTheme) {\n        childAsCategory.refreshTheme();\n      }\n    }\n  }\n\n  /**\n   * Updates the flyout's content without closing it.  Should be used in\n   * response to a change in one of the dynamic categories, such as variables or\n   * procedures.\n   */\n  refreshSelection() {\n    if (\n      this.selectedItem_ &&\n      this.selectedItem_.isSelectable() &&\n      this.selectedItem_.getContents().length\n    ) {\n      this.flyout_!.show(this.selectedItem_.getContents());\n    }\n  }\n\n  /**\n   * Shows or hides the toolbox.\n   *\n   * @param isVisible True if toolbox should be visible.\n   */\n  setVisible(isVisible: boolean) {\n    if (this.isVisible_ === isVisible) {\n      return;\n    }\n\n    this.HtmlDiv!.style.display = isVisible ? 'block' : 'none';\n    this.isVisible_ = isVisible;\n    // Invisible toolbox is ignored as drag targets and must have the drag\n    // target updated.\n    this.workspace_.recordDragTargets();\n  }\n\n  /**\n   * Hides the component. Called in WorkspaceSvg.hideChaff.\n   *\n   * @param onlyClosePopups Whether only popups should be closed.\n   *     Flyouts should not be closed if this is true.\n   */\n  autoHide(onlyClosePopups: boolean) {\n    if (!onlyClosePopups && this.flyout_ && this.flyout_.autoClose) {\n      this.clearSelection();\n    }\n  }\n\n  /**\n   * Sets the given item as selected.\n   * No-op if the item is not selectable.\n   *\n   * @param newItem The toolbox item to select.\n   */\n  setSelectedItem(newItem: IToolboxItem | null) {\n    const oldItem = this.selectedItem_;\n\n    if (\n      (!newItem && !oldItem) ||\n      (newItem && !isSelectableToolboxItem(newItem))\n    ) {\n      return;\n    }\n\n    if (this.shouldDeselectItem_(oldItem, newItem) && oldItem !== null) {\n      this.deselectItem_(oldItem);\n    }\n\n    if (this.shouldSelectItem_(oldItem, newItem) && newItem !== null) {\n      this.selectItem_(oldItem, newItem);\n    }\n\n    this.updateFlyout_(oldItem, newItem);\n    this.fireSelectEvent_(oldItem, newItem);\n  }\n\n  /**\n   * Decides whether the old item should be deselected.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   * @returns True if the old item should be deselected, false otherwise.\n   */\n  protected shouldDeselectItem_(\n    oldItem: ISelectableToolboxItem | null,\n    newItem: ISelectableToolboxItem | null,\n  ): boolean {\n    // Deselect the old item unless the old item is collapsible and has been\n    // previously clicked on.\n    return (\n      oldItem !== null && (!oldItem.isCollapsible() || oldItem !== newItem)\n    );\n  }\n\n  /**\n   * Decides whether the new item should be selected.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   * @returns True if the new item should be selected, false otherwise.\n   */\n  protected shouldSelectItem_(\n    oldItem: ISelectableToolboxItem | null,\n    newItem: ISelectableToolboxItem | null,\n  ): boolean {\n    // Select the new item unless the old item equals the new item.\n    return newItem !== null && newItem !== oldItem;\n  }\n\n  /**\n   * Deselects the given item, marks it as unselected, and updates aria state.\n   *\n   * @param item The previously selected toolbox item which should be\n   *     deselected.\n   */\n  protected deselectItem_(item: ISelectableToolboxItem) {\n    this.selectedItem_ = null;\n    this.previouslySelectedItem_ = item;\n    item.setSelected(false);\n    aria.setState(\n      this.contentsDiv_ as Element,\n      aria.State.ACTIVEDESCENDANT,\n      '',\n    );\n  }\n\n  /**\n   * Selects the given item, marks it selected, and updates aria state.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   */\n  protected selectItem_(\n    oldItem: ISelectableToolboxItem | null,\n    newItem: ISelectableToolboxItem,\n  ) {\n    this.selectedItem_ = newItem;\n    this.previouslySelectedItem_ = oldItem;\n    newItem.setSelected(true);\n    aria.setState(\n      this.contentsDiv_ as Element,\n      aria.State.ACTIVEDESCENDANT,\n      newItem.getId(),\n    );\n  }\n\n  /**\n   * Selects the toolbox item by its position in the list of toolbox items.\n   *\n   * @param position The position of the item to select.\n   */\n  selectItemByPosition(position: number) {\n    if (position > -1 && position < this.contents_.length) {\n      const item = this.contents_[position];\n      if (item.isSelectable()) {\n        this.setSelectedItem(item);\n      }\n    }\n  }\n\n  /**\n   * Decides whether to hide or show the flyout depending on the selected item.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   */\n  protected updateFlyout_(\n    oldItem: ISelectableToolboxItem | null,\n    newItem: ISelectableToolboxItem | null,\n  ) {\n    if (\n      !newItem ||\n      (oldItem === newItem && !newItem.isCollapsible()) ||\n      !newItem.getContents().length\n    ) {\n      this.flyout_!.hide();\n    } else {\n      this.flyout_!.show(newItem.getContents());\n      this.flyout_!.scrollToStart();\n    }\n  }\n\n  /**\n   * Emits an event when a new toolbox item is selected.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   */\n  private fireSelectEvent_(\n    oldItem: ISelectableToolboxItem | null,\n    newItem: ISelectableToolboxItem | null,\n  ) {\n    const oldElement = oldItem && oldItem.getName();\n    let newElement = newItem && newItem.getName();\n    // In this case the toolbox closes, so the newElement should be null.\n    if (oldItem === newItem) {\n      newElement = null;\n    }\n    const event = new (eventUtils.get(eventUtils.TOOLBOX_ITEM_SELECT))(\n      oldElement,\n      newElement,\n      this.workspace_.id,\n    );\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Closes the current item if it is expanded, or selects the parent.\n   *\n   * @returns True if a parent category was selected, false otherwise.\n   */\n  private selectParent_(): boolean {\n    if (!this.selectedItem_) {\n      return false;\n    }\n\n    if (\n      this.selectedItem_.isCollapsible() &&\n      (this.selectedItem_ as ICollapsibleToolboxItem).isExpanded()\n    ) {\n      const collapsibleItem = this.selectedItem_ as ICollapsibleToolboxItem;\n      collapsibleItem.toggleExpanded();\n      return true;\n    } else if (\n      this.selectedItem_.getParent() &&\n      this.selectedItem_.getParent()!.isSelectable()\n    ) {\n      this.setSelectedItem(this.selectedItem_.getParent());\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Selects the first child of the currently selected item, or nothing if the\n   * toolbox item has no children.\n   *\n   * @returns True if a child category was selected, false otherwise.\n   */\n  private selectChild_(): boolean {\n    if (!this.selectedItem_ || !this.selectedItem_.isCollapsible()) {\n      return false;\n    }\n    const collapsibleItem = this.selectedItem_ as ICollapsibleToolboxItem;\n    if (!collapsibleItem.isExpanded()) {\n      collapsibleItem.toggleExpanded();\n      return true;\n    } else {\n      this.selectNext_();\n      return true;\n    }\n  }\n\n  /**\n   * Selects the next visible toolbox item.\n   *\n   * @returns True if a next category was selected, false otherwise.\n   */\n  private selectNext_(): boolean {\n    if (!this.selectedItem_) {\n      return false;\n    }\n\n    let nextItemIdx = this.contents_.indexOf(this.selectedItem_) + 1;\n    if (nextItemIdx > -1 && nextItemIdx < this.contents_.length) {\n      let nextItem = this.contents_[nextItemIdx];\n      while (nextItem && !nextItem.isSelectable()) {\n        nextItem = this.contents_[++nextItemIdx];\n      }\n      if (nextItem && nextItem.isSelectable()) {\n        this.setSelectedItem(nextItem);\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Selects the previous visible toolbox item.\n   *\n   * @returns True if a previous category was selected, false otherwise.\n   */\n  private selectPrevious_(): boolean {\n    if (!this.selectedItem_) {\n      return false;\n    }\n\n    let prevItemIdx = this.contents_.indexOf(this.selectedItem_) - 1;\n    if (prevItemIdx > -1 && prevItemIdx < this.contents_.length) {\n      let prevItem = this.contents_[prevItemIdx];\n      while (prevItem && !prevItem.isSelectable()) {\n        prevItem = this.contents_[--prevItemIdx];\n      }\n      if (prevItem && prevItem.isSelectable()) {\n        this.setSelectedItem(prevItem);\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /** Disposes of this toolbox. */\n  dispose() {\n    this.workspace_.getComponentManager().removeComponent('toolbox');\n    this.flyout_!.dispose();\n    for (let i = 0; i < this.contents_.length; i++) {\n      const toolboxItem = this.contents_[i];\n      toolboxItem.dispose();\n    }\n\n    for (let j = 0; j < this.boundEvents_.length; j++) {\n      browserEvents.unbind(this.boundEvents_[j]);\n    }\n    this.boundEvents_ = [];\n    this.contents_ = [];\n\n    if (this.HtmlDiv) {\n      this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv);\n      dom.removeNode(this.HtmlDiv);\n    }\n  }\n}\n\n/** CSS for Toolbox.  See css.js for use. */\nCss.register(`\n.blocklyToolboxDelete {\n  cursor: url(\"<<<PATH>>>/handdelete.cur\"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url(\"<<<PATH>>>/handclosed.cur\"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolboxDiv {\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxContents {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxContents:focus {\n  outline: none;\n}\n`);\n\nregistry.register(registry.Type.TOOLBOX, registry.DEFAULT, Toolbox);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.utils.Metrics\n\nexport interface Metrics {\n  /** Height of the visible portion of the workspace. */\n  viewHeight: number;\n\n  /** Width of the visible portion of the workspace. */\n  viewWidth: number;\n\n  /** Height of the content. */\n  contentHeight: number;\n\n  /** Width of the content. */\n  contentWidth: number;\n\n  /** Height of the scroll area. */\n  scrollHeight: number;\n\n  /** Width of the scroll area. */\n  scrollWidth: number;\n\n  /**\n   * Top-edge of the visible portion of the workspace, relative to the workspace\n   * origin.\n   */\n  viewTop: number;\n\n  /**\n   * Left-edge of the visible portion of the workspace, relative to the\n   * workspace origin.\n   */\n  viewLeft: number;\n\n  /** Top-edge of the content, relative to the workspace origin. */\n  contentTop: number;\n\n  /** Left-edge of the content relative to the workspace origin. */\n  contentLeft: number;\n\n  /** Top-edge of the scroll area, relative to the workspace origin. */\n  scrollTop: number;\n\n  /** Left-edge of the scroll area relative to the workspace origin. */\n  scrollLeft: number;\n\n  /**\n   * Top-edge of the visible portion of the workspace, relative to the\n   * blocklyDiv.\n   */\n  absoluteTop: number;\n\n  /**\n   * Left-edge of the visible portion of the workspace, relative to the\n   * blocklyDiv.\n   */\n  absoluteLeft: number;\n\n  /**\n   * Height of the Blockly div (the view + the toolbox, simple of otherwise).\n   */\n  svgHeight: number;\n\n  /** Width of the Blockly div (the view + the toolbox, simple or otherwise). */\n  svgWidth: number;\n\n  /** Width of the toolbox, if it exists.  Otherwise zero. */\n  toolboxWidth: number;\n\n  /** Height of the toolbox, if it exists.  Otherwise zero. */\n  toolboxHeight: number;\n\n  /** Top, bottom, left or right. Use TOOLBOX_AT constants to compare. */\n  toolboxPosition: number;\n\n  /** Width of the flyout if it is always open.  Otherwise zero. */\n  flyoutWidth: number;\n\n  /** Height of the flyout if it is always open.  Otherwise zero. */\n  flyoutHeight: number;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.blockRendering.IPathObject\n\nimport type {BlockStyle} from '../../theme.js';\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {ConstantProvider} from './constants.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {Coordinate} from '../../utils/coordinate.js';\n\n/**\n * An interface for a block's path object.\n *\n * @param _root The root SVG element.\n * @param _constants The renderer's constants.\n */\nexport interface IPathObject {\n  /**\n   * The primary path of the block.\n   */\n  svgPath: SVGElement;\n\n  /** The renderer's constant provider. */\n  constants: ConstantProvider;\n\n  /** The primary path of the block. */\n  style: BlockStyle;\n\n  /**\n   * Holds the cursors SVG element when the cursor is attached to the block.\n   * This is null if there is no cursor on the block.\n   */\n  cursorSvg: SVGElement | null;\n\n  /**\n   * Holds the markers SVG element when the marker is attached to the block.\n   * This is null if there is no marker on the block.\n   */\n  markerSvg: SVGElement | null;\n\n  /**\n   * Set the path generated by the renderer onto the respective SVG element.\n   *\n   * @param pathString The path.\n   */\n  setPath(pathString: string): void;\n\n  /**\n   * Apply the stored colours to the block's path, taking into account whether\n   * the paths belong to a shadow block.\n   *\n   * @param block The source block.\n   */\n  applyColour(block: BlockSvg): void;\n\n  /**\n   * Update the style.\n   *\n   * @param blockStyle The block style to use.\n   */\n  setStyle(blockStyle: BlockStyle): void;\n\n  /**\n   * Flip the SVG paths in RTL.\n   */\n  flipRTL(): void;\n\n  /**\n   * Add the cursor SVG to this block's SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the block SVG\n   *     group.\n   */\n  setCursorSvg(cursorSvg: SVGElement): void;\n\n  /**\n   * Add the marker SVG to this block's SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the block SVG\n   *     group.\n   */\n  setMarkerSvg(markerSvg: SVGElement): void;\n\n  /**\n   * Set whether the block shows a highlight or not.  Block highlighting is\n   * often used to visually mark blocks currently being executed.\n   *\n   * @param highlighted True if highlighted.\n   */\n  updateHighlighted(highlighted: boolean): void;\n\n  /**\n   * Add or remove styling showing that a block is selected.\n   *\n   * @param enable True if selection is enabled, false otherwise.\n   */\n  updateSelected(enabled: boolean): void;\n\n  /**\n   * Add or remove styling showing that a block is dragged over a delete area.\n   *\n   * @param enable True if the block is being dragged over a delete area, false\n   *     otherwise.\n   */\n  updateDraggingDelete(enabled: boolean): void;\n\n  /**\n   * Add or remove styling showing that a block is an insertion marker.\n   *\n   * @param enable True if the block is an insertion marker, false otherwise.\n   */\n  updateInsertionMarker(enabled: boolean): void;\n\n  /**\n   * Add or remove styling showing that a block is movable.\n   *\n   * @param enable True if the block is movable, false otherwise.\n   */\n  updateMovable(enabled: boolean): void;\n\n  /** Adds the given path as a connection highlight for the given connection. */\n  addConnectionHighlight?(\n    connection: RenderedConnection,\n    connectionPath: string,\n    offset: Coordinate,\n    rtl: boolean,\n  ): void;\n\n  /**\n   * Removes any highlight associated with the given connection, if it exists.\n   */\n  removeConnectionHighlight?(connection: RenderedConnection): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IToolboxItem\n\n/**\n * Interface for an item in the toolbox.\n */\nexport interface IToolboxItem {\n  /**\n   * Initializes the toolbox item.\n   * This includes creating the DOM and updating the state of any items based\n   * on the info object.\n   */\n  init(): void;\n\n  /**\n   * Gets the div for the toolbox item.\n   *\n   * @returns The div for the toolbox item.\n   */\n  getDiv(): Element | null;\n\n  /**\n   * Gets a unique identifier for this toolbox item.\n   *\n   * @returns The ID for the toolbox item.\n   */\n  getId(): string;\n\n  /**\n   * Gets the parent if the toolbox item is nested.\n   *\n   * @returns The parent toolbox item, or null if this toolbox item is not\n   *     nested.\n   */\n  getParent(): IToolboxItem | null;\n\n  /**\n   * Gets the nested level of the category.\n   *\n   * @returns The nested level of the category.\n   * @internal\n   */\n  getLevel(): number;\n\n  /**\n   * Whether the toolbox item is selectable.\n   *\n   * @returns True if the toolbox item can be selected.\n   */\n  isSelectable(): boolean;\n\n  /**\n   * Whether the toolbox item is collapsible.\n   *\n   * @returns True if the toolbox item is collapsible.\n   */\n  isCollapsible(): boolean;\n\n  /** Dispose of this toolbox item. No-op by default. */\n  dispose(): void;\n\n  /**\n   * Gets the HTML element that is clickable.\n   *\n   * @returns The HTML element that receives clicks.\n   */\n  getClickTarget(): Element | null;\n\n  /**\n   * Sets whether the category is visible or not.\n   * For a category to be visible its parent category must also be expanded.\n   *\n   * @param isVisible True if category should be visible.\n   */\n  setVisible_(isVisible: boolean): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IToolbox\n\nimport type {IRegistrable} from './i_registrable.js';\nimport type {IToolboxItem} from './i_toolbox_item.js';\nimport type {ToolboxInfo} from '../utils/toolbox.js';\nimport type {IFlyout} from './i_flyout.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\n/**\n * Interface for a toolbox.\n */\nexport interface IToolbox extends IRegistrable {\n  /** Initializes the toolbox. */\n  init(): void;\n\n  /**\n   * Fills the toolbox with new toolbox items and removes any old contents.\n   *\n   * @param toolboxDef Object holding information for creating a toolbox.\n   */\n  render(toolboxDef: ToolboxInfo): void;\n\n  /**\n   * Gets the width of the toolbox.\n   *\n   * @returns The width of the toolbox.\n   */\n  getWidth(): number;\n\n  /**\n   * Gets the height of the toolbox.\n   *\n   * @returns The height of the toolbox.\n   */\n  getHeight(): number;\n\n  /**\n   * Gets the toolbox flyout.\n   *\n   * @returns The toolbox flyout.\n   */\n  getFlyout(): IFlyout | null;\n\n  /**\n   * Gets the workspace for the toolbox.\n   *\n   * @returns The parent workspace for the toolbox.\n   */\n  getWorkspace(): WorkspaceSvg;\n\n  /**\n   * Gets whether or not the toolbox is horizontal.\n   *\n   * @returns True if the toolbox is horizontal, false if the toolbox is\n   *     vertical.\n   */\n  isHorizontal(): boolean;\n\n  /**\n   * Positions the toolbox based on whether it is a horizontal toolbox and\n   * whether the workspace is in rtl.\n   */\n  position(): void;\n\n  /** Handles resizing the toolbox when a toolbox item resizes. */\n  handleToolboxItemResize(): void;\n\n  /** Unhighlights any previously selected item. */\n  clearSelection(): void;\n\n  /**\n   * Updates the category colours and background colour of selected categories.\n   */\n  refreshTheme(): void;\n\n  /**\n   * Updates the flyout's content without closing it.  Should be used in\n   * response to a change in one of the dynamic categories, such as variables or\n   * procedures.\n   */\n  refreshSelection(): void;\n\n  /**\n   * Sets the visibility of the toolbox.\n   *\n   * @param isVisible True if toolbox should be visible.\n   */\n  setVisible(isVisible: boolean): void;\n\n  /**\n   * Selects the toolbox item by it's position in the list of toolbox items.\n   *\n   * @param position The position of the item to select.\n   */\n  selectItemByPosition(position: number): void;\n\n  /**\n   * Gets the selected item.\n   *\n   * @returns The selected item, or null if no item is currently selected.\n   */\n  getSelectedItem(): IToolboxItem | null;\n\n  /** Disposes of this toolbox. */\n  dispose(): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IStyleable\n\n/**\n * Interface for an object that a style can be added to.\n */\nexport interface IStyleable {\n  /**\n   * Adds a style on the toolbox. Usually used to change the cursor.\n   *\n   * @param style The name of the class to add.\n   */\n  addStyle(style: string): void;\n\n  /**\n   * Removes a style from the toolbox. Usually used to change the cursor.\n   *\n   * @param style The name of the class to remove.\n   */\n  removeStyle(style: string): void;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.serialization.ISerializer\n\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Serializes and deserializes a plugin or system.\n */\nexport interface ISerializer {\n  /**\n   * A priority value used to determine the order of deserializing state.\n   * More positive priorities are deserialized before less positive\n   * priorities. Eg if you have priorities (0, -10, 10, 100) the order of\n   * deserialiation will be (100, 10, 0, -10).\n   * If two serializers have the same priority, they are deserialized in an\n   * arbitrary order relative to each other.\n   */\n  priority: number;\n\n  /* eslint-disable no-unused-vars, valid-jsdoc */\n\n  /**\n   * Saves the state of the plugin or system.\n   *\n   * @param workspace The workspace the system to serialize is associated with.\n   * @returns A JS object containing the system's state, or null if there is no\n   *     state to record.\n   */\n  save(workspace: Workspace): Object | null;\n  /* eslint-enable valid-jsdoc */\n\n  /**\n   * Loads the state of the plugin or system.\n   *\n   * @param state The state of the system to deserialize. This will always be\n   *     non-null.\n   * @param workspace The workspace the system to deserialize is associated\n   *     with.\n   */\n  load(state: Object, workspace: Workspace): void;\n\n  /**\n   * Clears the state of the plugin or system.\n   *\n   * @param workspace The workspace the system to clear the state of is\n   *     associated with.\n   */\n  clear(workspace: Workspace): void;\n}\n/* eslint-enable no-unused-vars */\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IRegistrable\n\n/**\n * The interface for a Blockly component that can be registered.\n */\nexport interface IRegistrable {}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {State} from '../serialization/procedures.js';\nimport {IParameterModel} from './i_parameter_model.js';\n\n/**\n * A data model for a procedure.\n */\nexport interface IProcedureModel {\n  /** Sets the human-readable name of the procedure. */\n  setName(name: string): this;\n\n  /**\n   * Inserts a parameter into the list of parameters.\n   *\n   * To move a parameter, first delete it, and then re-insert.\n   */\n  insertParameter(parameterModel: IParameterModel, index: number): this;\n\n  /** Removes the parameter at the given index from the parameter list. */\n  deleteParameter(index: number): this;\n\n  /**\n   * Sets the return type(s) of the procedure.\n   *\n   * Pass null to represent a procedure that does not return.\n   */\n  setReturnTypes(types: string[] | null): this;\n\n  /**\n   * Sets whether this procedure is enabled/disabled. If a procedure is disabled\n   * all procedure caller blocks should be disabled as well.\n   */\n  setEnabled(enabled: boolean): this;\n\n  /** Returns the unique language-neutral ID for the procedure. */\n  getId(): string;\n\n  /** Returns the human-readable name of the procedure. */\n  getName(): string;\n\n  /** Returns the parameter at the given index in the parameter list. */\n  getParameter(index: number): IParameterModel;\n\n  /** Returns an array of all of the parameters in the parameter list. */\n  getParameters(): IParameterModel[];\n\n  /**\n   * Returns the return type(s) of the procedure.\n   *\n   * Null represents a procedure that does not return a value.\n   */\n  getReturnTypes(): string[] | null;\n\n  /**\n   * Returns whether the procedure is enabled/disabled. If a procedure is\n   * disabled, all procedure caller blocks should be disabled as well.\n   */\n  getEnabled(): boolean;\n\n  /**\n   * Serializes the state of the procedure to JSON.\n   *\n   * @returns JSON serializable state of the procedure.\n   */\n  saveState(): State;\n}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IProcedureModel} from './i_procedure_model.js';\n\nexport interface IProcedureMap extends Map<string, IProcedureModel> {\n  /**\n   * Adds the given ProcedureModel to the map of procedure models, so that\n   * blocks can find it.\n   */\n  add(proc: IProcedureModel): this;\n\n  /** Returns all of the procedures stored in this map. */\n  getProcedures(): IProcedureModel[];\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Rect} from '../utils/rect.js';\nimport type {UiMetrics} from '../metrics_manager.js';\n// Former goog.module ID: Blockly.IPositionable\n\nimport type {IComponent} from './i_component.js';\n\n/**\n * Interface for a component that is positioned on top of the workspace.\n */\nexport interface IPositionable extends IComponent {\n  /**\n   * Positions the element. Called when the window is resized.\n   *\n   * @param metrics The workspace metrics.\n   * @param savedPositions List of rectangles that are already on the workspace.\n   */\n  position(metrics: UiMetrics, savedPositions: Rect[]): void;\n\n  /**\n   * Returns the bounding rectangle of the UI element in pixel units relative to\n   * the Blockly injection div.\n   *\n   * @returns The UI elements's bounding box. Null if bounding box should be\n   *     ignored by other UI elements.\n   */\n  getBoundingRectangle(): Rect | null;\n}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {ParameterState} from '../serialization/procedures';\nimport {IProcedureModel} from './i_procedure_model';\n\n/**\n * A data model for a procedure.\n */\nexport interface IParameterModel {\n  /**\n   * Sets the name of this parameter to the given name.\n   */\n  setName(name: string): this;\n\n  /**\n   * Sets the types of this parameter to the given type.\n   */\n  setTypes(types: string[]): this;\n\n  /**\n   * Returns the name of this parameter.\n   */\n  getName(): string;\n\n  /**\n   * Return the types of this parameter.\n   */\n  getTypes(): string[];\n\n  /**\n   * Returns the unique language-neutral ID for the parameter.\n   *\n   * This represents the identify of the variable model which does not change\n   * over time.\n   */\n  getId(): string;\n\n  /** Sets the procedure model this parameter is associated with. */\n  setProcedureModel(model: IProcedureModel): this;\n\n  /**\n   * Serializes the state of the parameter to JSON.\n   *\n   * @returns JSON serializable state of the parameter.\n   */\n  saveState(): ParameterState;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IMovable\n\n/**\n * The interface for an object that is movable.\n */\nexport interface IMovable {\n  /**\n   * Get whether this is movable or not.\n   *\n   * @returns True if movable.\n   */\n  isMovable(): boolean;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {\n  ContainerRegion,\n  ToolboxMetrics,\n  AbsoluteMetrics,\n  UiMetrics,\n} from '../metrics_manager.js';\nimport type {Size} from '../utils/size.js';\nimport type {Metrics} from '../utils/metrics.js';\n// Former goog.module ID: Blockly.IMetricsManager\n\n/**\n * Interface for a metrics manager.\n */\nexport interface IMetricsManager {\n  /**\n   * Returns whether the scroll area has fixed edges.\n   *\n   * @returns Whether the scroll area has fixed edges.\n   * @internal\n   */\n  hasFixedEdges(): boolean;\n\n  /**\n   * Returns the metrics for the scroll area of the workspace.\n   *\n   * @param opt_getWorkspaceCoordinates True to get the scroll metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @param opt_viewMetrics The view metrics if they have been previously\n   *     computed. Passing in null may cause the view metrics to be computed\n   *     again, if it is needed.\n   * @param opt_contentMetrics The content metrics if they have been previously\n   *     computed. Passing in null may cause the content metrics to be computed\n   *     again, if it is needed.\n   * @returns The metrics for the scroll container\n   */\n  getScrollMetrics(\n    opt_getWorkspaceCoordinates?: boolean,\n    opt_viewMetrics?: ContainerRegion,\n    opt_contentMetrics?: ContainerRegion,\n  ): ContainerRegion;\n\n  /**\n   * Gets the width and the height of the flyout in pixel\n   * coordinates. By default, will get metrics for either a simple flyout (owned\n   * directly by the workspace) or for the flyout owned by the toolbox. If you\n   * pass `opt_own` as `true` then only metrics for the simple flyout will be\n   * returned, and it will return 0 for the width and height if the workspace\n   * has a category toolbox instead of a simple toolbox.\n   *\n   * @param opt_own Whether to only return the workspace's own flyout metrics.\n   * @returns The width and height of the flyout.\n   */\n  getFlyoutMetrics(opt_own?: boolean): ToolboxMetrics;\n\n  /**\n   * Gets the width, height and position of the toolbox on the workspace in\n   * pixel coordinates. Returns 0 for the width and height if the workspace has\n   * a simple toolbox instead of a category toolbox. To get the width and height\n   * of a simple toolbox, see {@link IMetricsManager#getFlyoutMetrics}.\n   *\n   * @returns The object with the width, height and position of the toolbox.\n   */\n  getToolboxMetrics(): ToolboxMetrics;\n\n  /**\n   * Gets the width and height of the workspace's parent SVG element in pixel\n   * coordinates. This area includes the toolbox and the visible workspace area.\n   *\n   * @returns The width and height of the workspace's parent SVG element.\n   */\n  getSvgMetrics(): Size;\n\n  /**\n   * Gets the absolute left and absolute top in pixel coordinates.\n   * This is where the visible workspace starts in relation to the SVG\n   * container.\n   *\n   * @returns The absolute metrics for the workspace.\n   */\n  getAbsoluteMetrics(): AbsoluteMetrics;\n\n  /**\n   * Gets the metrics for the visible workspace in either pixel or workspace\n   * coordinates. The visible workspace does not include the toolbox or flyout.\n   *\n   * @param opt_getWorkspaceCoordinates True to get the view metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @returns The width, height, top and left of the viewport in either\n   *     workspace coordinates or pixel coordinates.\n   */\n  getViewMetrics(opt_getWorkspaceCoordinates?: boolean): ContainerRegion;\n\n  /**\n   * Gets content metrics in either pixel or workspace coordinates.\n   * The content area is a rectangle around all the top bounded elements on the\n   * workspace (workspace comments and blocks).\n   *\n   * @param opt_getWorkspaceCoordinates True to get the content metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @returns The metrics for the content container.\n   */\n  getContentMetrics(opt_getWorkspaceCoordinates?: boolean): ContainerRegion;\n\n  /**\n   * Returns an object with all the metrics required to size scrollbars for a\n   * top level workspace.  The following properties are computed:\n   * Coordinate system: pixel coordinates, -left, -up, +right, +down\n   * .viewHeight: Height of the visible portion of the workspace.\n   * .viewWidth: Width of the visible portion of the workspace.\n   * .contentHeight: Height of the content.\n   * .contentWidth: Width of the content.\n   * .svgHeight: Height of the Blockly div (the view + the toolbox,\n   *    simple or otherwise),\n   * .svgWidth: Width of the Blockly div (the view + the toolbox,\n   *    simple or otherwise),\n   * .viewTop: Top-edge of the visible portion of the workspace, relative to\n   *     the workspace origin.\n   * .viewLeft: Left-edge of the visible portion of the workspace, relative to\n   *     the workspace origin.\n   * .contentTop: Top-edge of the content, relative to the workspace origin.\n   * .contentLeft: Left-edge of the content relative to the workspace origin.\n   * .absoluteTop: Top-edge of the visible portion of the workspace, relative\n   *     to the blocklyDiv.\n   * .absoluteLeft: Left-edge of the visible portion of the workspace, relative\n   *     to the blocklyDiv.\n   * .toolboxWidth: Width of the toolbox, if it exists.  Otherwise zero.\n   * .toolboxHeight: Height of the toolbox, if it exists.  Otherwise zero.\n   * .flyoutWidth: Width of the flyout if it is always open.  Otherwise zero.\n   * .flyoutHeight: Height of the flyout if it is always open.  Otherwise zero.\n   * .toolboxPosition: Top, bottom, left or right. Use TOOLBOX_AT constants to\n   *     compare.\n   *\n   * @returns Contains size and position metrics of a top level workspace.\n   */\n  getMetrics(): Metrics;\n\n  /**\n   * Returns common metrics used by UI elements.\n   *\n   * @returns The UI metrics.\n   */\n  getUiMetrics(): UiMetrics;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {KeyboardShortcut} from '../shortcut_registry.js';\n// Former goog.module ID: Blockly.IKeyboardAccessible\n\n/**\n * An interface for an object that handles keyboard shortcuts.\n */\nexport interface IKeyboardAccessible {\n  /**\n   * Handles the given keyboard shortcut.\n   *\n   * @param shortcut The shortcut to be handled.\n   * @returns True if the shortcut has been handled, false otherwise.\n   */\n  onShortcut(shortcut: KeyboardShortcut): boolean;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IFlyout\n\nimport type {WorkspaceSvg} from '../workspace_svg.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport type {Coordinate} from '../utils/coordinate.js';\nimport type {FlyoutDefinition} from '../utils/toolbox.js';\nimport type {Svg} from '../utils/svg.js';\nimport type {IRegistrable} from './i_registrable.js';\nimport {FlyoutItem} from '../flyout_base.js';\n\n/**\n * Interface for a flyout.\n */\nexport interface IFlyout extends IRegistrable {\n  /** Whether the flyout is laid out horizontally or not. */\n  horizontalLayout: boolean;\n\n  /** Is RTL vs LTR. */\n  RTL: boolean;\n\n  /** The target workspace */\n  targetWorkspace: WorkspaceSvg | null;\n\n  /** Margin around the edges of the blocks in the flyout. */\n  readonly MARGIN: number;\n\n  /** Does the flyout automatically close when a block is created? */\n  autoClose: boolean;\n\n  /** Corner radius of the flyout background. */\n  readonly CORNER_RADIUS: number;\n\n  /**\n   * Creates the flyout's DOM.  Only needs to be called once.  The flyout can\n   * either exist as its own svg element or be a g element nested inside a\n   * separate svg element.\n   *\n   * @param tagName The type of tag to put the flyout in. This should be <svg>\n   *     or <g>.\n   * @returns The flyout's SVG group.\n   */\n  createDom(\n    tagName: string | Svg<SVGSVGElement> | Svg<SVGGElement>,\n  ): SVGElement;\n\n  /**\n   * Initializes the flyout.\n   *\n   * @param targetWorkspace The workspace in which to create new blocks.\n   */\n  init(targetWorkspace: WorkspaceSvg): void;\n\n  /**\n   * Dispose of this flyout.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose(): void;\n\n  /**\n   * Get the width of the flyout.\n   *\n   * @returns The width of the flyout.\n   */\n  getWidth(): number;\n\n  /**\n   * Get the height of the flyout.\n   *\n   * @returns The height of the flyout.\n   */\n  getHeight(): number;\n\n  /**\n   * Get the workspace inside the flyout.\n   *\n   * @returns The workspace inside the flyout.\n   */\n  getWorkspace(): WorkspaceSvg;\n\n  /**\n   * Is the flyout visible?\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean;\n\n  /**\n   * Set whether the flyout is visible. A value of true does not necessarily\n   * mean that the flyout is shown. It could be hidden because its container is\n   * hidden.\n   *\n   * @param visible True if visible.\n   */\n  setVisible(visible: boolean): void;\n\n  /**\n   * Set whether this flyout's container is visible.\n   *\n   * @param visible Whether the container is visible.\n   */\n  setContainerVisible(visible: boolean): void;\n\n  /** Hide and empty the flyout. */\n  hide(): void;\n\n  /**\n   * Show and populate the flyout.\n   *\n   * @param flyoutDef Contents to display in the flyout. This is either an array\n   *     of Nodes, a NodeList, a toolbox definition, or a string with the name\n   *     of the dynamic category.\n   */\n  show(flyoutDef: FlyoutDefinition | string): void;\n\n  /**\n   * Returns the list of flyout items currently present in the flyout.\n   * The `show` method parses the flyout definition into a list of actual\n   * flyout items. This method should return those concrete items, which\n   * may be used for e.g. keyboard navigation.\n   *\n   * @returns List of flyout items.\n   */\n  getContents(): FlyoutItem[];\n\n  /**\n   * Create a copy of this block on the workspace.\n   *\n   * @param originalBlock The block to copy from the flyout.\n   * @returns The newly created block.\n   * @throws {Error} if something went wrong with deserialization.\n   */\n  createBlock(originalBlock: BlockSvg): BlockSvg;\n\n  /** Reflow blocks and their mats. */\n  reflow(): void;\n\n  /**\n   * @returns True if this flyout may be scrolled with a scrollbar or by\n   *     dragging.\n   */\n  isScrollable(): boolean;\n\n  /**\n   * Calculates the x coordinate for the flyout position.\n   *\n   * @returns X coordinate.\n   */\n  getX(): number;\n\n  /**\n   * Calculates the y coordinate for the flyout position.\n   *\n   * @returns Y coordinate.\n   */\n  getY(): number;\n\n  /** Position the flyout. */\n  position(): void;\n\n  /**\n   * Determine if a drag delta is toward the workspace, based on the position\n   * and orientation of the flyout. This is used in determineDragIntention_ to\n   * determine if a new block should be created or if the flyout should scroll.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   * @returns True if the drag is toward the workspace.\n   */\n  isDragTowardWorkspace(currentDragDeltaXY: Coordinate): boolean;\n\n  /**\n   * Does this flyout allow you to create a new instance of the given block?\n   * Used for deciding if a block can be \"dragged out of\" the flyout.\n   *\n   * @param block The block to copy from the flyout.\n   * @returns True if you can create a new instance of the block, false\n   *     otherwise.\n   */\n  isBlockCreatable(block: BlockSvg): boolean;\n\n  /** Scroll the flyout to the beginning of its contents. */\n  scrollToStart(): void;\n}\n","/**\n * @license\n * Copyright 2024 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Coordinate} from '../utils/coordinate';\n\nexport interface IDragger {\n  /**\n   * Handles any drag startup.\n   *\n   * @param e PointerEvent that started the drag.\n   */\n  onDragStart(e: PointerEvent): void;\n\n  /**\n   * Handles dragging, including calculating where the element should\n   * actually be moved to.\n   *\n   * @param e PointerEvent that continued the drag.\n   * @param totalDelta The total distance, in pixels, that the mouse\n   *     has moved since the start of the drag.\n   */\n  onDrag(e: PointerEvent, totalDelta: Coordinate): void;\n\n  /**\n   * Handles any drag cleanup.\n   *\n   * @param e PointerEvent that finished the drag.\n   * @param totalDelta The total distance, in pixels, that the mouse\n   *     has moved since the start of the drag.\n   */\n  onDragEnd(e: PointerEvent, totalDelta: Coordinate): void;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Rect} from '../utils/rect.js';\n\nimport {IDraggable} from './i_draggable.js';\n\n// Former goog.module ID: Blockly.IDragTarget\n\nimport type {IComponent} from './i_component.js';\n\n/**\n * Interface for a component with custom behaviour when a block or bubble is\n * dragged over or dropped on top of it.\n */\nexport interface IDragTarget extends IComponent {\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  getClientRect(): Rect | null;\n\n  /**\n   * Handles when a cursor with a block or bubble enters this drag target.\n   *\n   * @param dragElement The block or bubble currently being dragged.\n   */\n  onDragEnter(dragElement: IDraggable): void;\n\n  /**\n   * Handles when a cursor with a block or bubble is dragged over this drag\n   * target.\n   *\n   * @param dragElement The block or bubble currently being dragged.\n   */\n  onDragOver(dragElement: IDraggable): void;\n\n  /**\n   * Handles when a cursor with a block or bubble exits this drag target.\n   *\n   * @param dragElement The block or bubble currently being dragged.\n   */\n  onDragExit(dragElement: IDraggable): void;\n\n  /**\n   * Handles when a block or bubble is dropped on this component.\n   * Should not handle delete here.\n   *\n   * @param dragElement The block or bubble currently being dragged.\n   */\n  onDrop(dragElement: IDraggable): void;\n\n  /**\n   * Returns whether the provided block or bubble should not be moved after\n   * being dropped on this component. If true, the element will return to where\n   * it was when the drag started.\n   *\n   * @param dragElement The block or bubble currently being dragged.\n   * @returns Whether the block or bubble provided should be returned to drag\n   *     start.\n   */\n  shouldPreventMove(dragElement: IDraggable): boolean;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IDeleteArea\n\nimport type {IDragTarget} from './i_drag_target.js';\nimport type {IDraggable} from './i_draggable.js';\n\n/**\n * Interface for a component that can delete a block or bubble that is dropped\n * on top of it.\n */\nexport interface IDeleteArea extends IDragTarget {\n  /**\n   * Returns whether the provided block or bubble would be deleted if dropped on\n   * this area.\n   * This method should check if the element is deletable and is always called\n   * before onDragEnter/onDragOver/onDragExit.\n   *\n   * @param element The block or bubble currently being dragged.\n   * @returns Whether the element provided would be deleted if dropped on this\n   *     area.\n   */\n  wouldDelete(element: IDraggable): boolean;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IContextMenu\n\nexport interface IContextMenu {\n  /**\n   * Show the context menu for this object.\n   *\n   * @param e Mouse event.\n   */\n  showContextMenu(e: Event): void;\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {BlockSvg} from '../block_svg';\nimport type {RenderedConnection} from '../rendered_connection';\n\n/**\n * Displays visual \"previews\" of where a block will be connected if it is\n * dropped.\n */\nexport interface IConnectionPreviewer {\n  /**\n   * Display a connection preview where the draggedCon connects to the\n   * staticCon, replacing the replacedBlock (currently connected to the\n   * staticCon).\n   *\n   * @param draggedCon The connection on the block stack being dragged.\n   * @param staticCon The connection not being dragged that we are\n   *     connecting to.\n   * @param replacedBlock The block currently connected to the staticCon that\n   *     is being replaced.\n   */\n  previewReplacement(\n    draggedConn: RenderedConnection,\n    staticConn: RenderedConnection,\n    replacedBlock: BlockSvg,\n  ): void;\n\n  /**\n   * Display a connection preview where the draggedCon connects to the\n   * staticCon, and no block is being relaced.\n   *\n   * @param draggedCon The connection on the block stack being dragged.\n   * @param staticCon The connection not being dragged that we are\n   *     connecting to.\n   */\n  previewConnection(\n    draggedConn: RenderedConnection,\n    staticConn: RenderedConnection,\n  ): void;\n\n  /** Hide any previews that are currently displayed. */\n  hidePreview(): void;\n\n  /** Dispose of any references held by this connection previewer. */\n  dispose(): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Connection} from '../connection.js';\nimport type {RenderedConnection} from '../rendered_connection.js';\n// Former goog.module ID: Blockly.IConnectionChecker\n\n/**\n * Class for connection type checking logic.\n */\nexport interface IConnectionChecker {\n  /**\n   * Check whether the current connection can connect with the target\n   * connection.\n   *\n   * @param a Connection to check compatibility with.\n   * @param b Connection to check compatibility with.\n   * @param isDragging True if the connection is being made by dragging a block.\n   * @param opt_distance The max allowable distance between the connections for\n   *     drag checks.\n   * @returns Whether the connection is legal.\n   */\n  canConnect(\n    a: Connection | null,\n    b: Connection | null,\n    isDragging: boolean,\n    opt_distance?: number,\n  ): boolean;\n\n  /**\n   * Checks whether the current connection can connect with the target\n   * connection, and return an error code if there are problems.\n   *\n   * @param a Connection to check compatibility with.\n   * @param b Connection to check compatibility with.\n   * @param isDragging True if the connection is being made by dragging a block.\n   * @param opt_distance The max allowable distance between the connections for\n   *     drag checks.\n   * @returns Connection.CAN_CONNECT if the connection is legal, an error code\n   *     otherwise.\n   */\n  canConnectWithReason(\n    a: Connection | null,\n    b: Connection | null,\n    isDragging: boolean,\n    opt_distance?: number,\n  ): number;\n\n  /**\n   * Helper method that translates a connection error code into a string.\n   *\n   * @param errorCode The error code.\n   * @param a One of the two connections being checked.\n   * @param b The second of the two connections being checked.\n   * @returns A developer-readable error string.\n   */\n  getErrorMessage(\n    errorCode: number,\n    a: Connection | null,\n    b: Connection | null,\n  ): string;\n\n  /**\n   * Check that connecting the given connections is safe, meaning that it would\n   * not break any of Blockly's basic assumptions (e.g. no self connections).\n   *\n   * @param a The first of the connections to check.\n   * @param b The second of the connections to check.\n   * @returns An enum with the reason this connection is safe or unsafe.\n   */\n  doSafetyChecks(a: Connection | null, b: Connection | null): number;\n\n  /**\n   * Check whether this connection is compatible with another connection with\n   * respect to the value type system.  E.g. square_root(\"Hello\") is not\n   * compatible.\n   *\n   * @param a Connection to compare.\n   * @param b Connection to compare against.\n   * @returns True if the connections share a type.\n   */\n  doTypeChecks(a: Connection, b: Connection): boolean;\n\n  /**\n   * Check whether this connection can be made by dragging.\n   *\n   * @param a Connection to compare.\n   * @param b Connection to compare against.\n   * @param distance The maximum allowable distance between connections.\n   * @returns True if the connection is allowed during a drag.\n   */\n  doDragChecks(\n    a: RenderedConnection,\n    b: RenderedConnection,\n    distance: number,\n  ): boolean;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IComponent\n\n/**\n * The interface for a workspace component that can be registered with the\n * ComponentManager.\n */\nexport interface IComponent {\n  /**\n   * The unique ID for this component that is used to register with the\n   * ComponentManager.\n   */\n  id: string;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.ICollapsibleToolboxItem\n\nimport type {ISelectableToolboxItem} from './i_selectable_toolbox_item.js';\nimport type {IToolboxItem} from './i_toolbox_item.js';\n\n/**\n * Interface for an item in the toolbox that can be collapsed.\n */\nexport interface ICollapsibleToolboxItem extends ISelectableToolboxItem {\n  /**\n   * Gets any children toolbox items. (ex. Gets the subcategories)\n   *\n   * @returns The child toolbox items.\n   */\n  getChildToolboxItems(): IToolboxItem[];\n\n  /**\n   * Whether the toolbox item is expanded to show its child subcategories.\n   *\n   * @returns True if the toolbox item shows its children, false if it is\n   *     collapsed.\n   */\n  isExpanded(): boolean;\n\n  /** Toggles whether or not the toolbox item is expanded. */\n  toggleExpanded(): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Coordinate} from '../utils/coordinate.js';\n// Former goog.module ID: Blockly.IBubble\n\nimport type {IContextMenu} from './i_contextmenu.js';\nimport type {IDraggable} from './i_draggable.js';\n\n/**\n * A bubble interface.\n */\nexport interface IBubble extends IDraggable, IContextMenu {\n  /**\n   * Return the coordinates of the top-left corner of this bubble's body\n   * relative to the drawing surface's origin (0,0), in workspace units.\n   *\n   * @returns Object with .x and .y properties.\n   */\n  getRelativeToSurfaceXY(): Coordinate;\n\n  /**\n   * Return the root node of the bubble's SVG group.\n   *\n   * @returns The root SVG node of the bubble's group.\n   */\n  getSvgRoot(): SVGElement;\n\n  /**\n   * Sets whether or not this bubble is being dragged.\n   *\n   * @param adding True if dragging, false otherwise.\n   */\n  setDragging(dragging: boolean): void;\n\n  /**\n   * Move this bubble during a drag.\n   *\n   * @param newLoc The location to translate to, in workspace coordinates.\n   */\n  moveDuringDrag(newLoc: Coordinate): void;\n\n  /**\n   * Move the bubble to the specified location in workspace coordinates.\n   *\n   * @param x The x position to move to.\n   * @param y The y position to move to.\n   */\n  moveTo(x: number, y: number): void;\n\n  /**\n   * Update the style of this bubble when it is dragged over a delete area.\n   *\n   * @param enable True if the bubble is about to be deleted, false otherwise.\n   */\n  setDeleteStyle(enable: boolean): void;\n\n  /** Dispose of this bubble. */\n  dispose(): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Rect} from '../utils/rect.js';\n// Former goog.module ID: Blockly.IBoundedElement\n\n/**\n * A bounded element interface.\n */\nexport interface IBoundedElement {\n  /**\n   * Returns the coordinates of a bounded element describing the dimensions of\n   * the element. Coordinate system: workspace coordinates.\n   *\n   * @returns Object with coordinates of the bounded element.\n   */\n  getBoundingRectangle(): Rect;\n\n  /**\n   * Move the element by a relative offset.\n   *\n   * @param dx Horizontal offset in workspace units.\n   * @param dy Vertical offset in workspace units.\n   * @param reason Why is this move happening?  'user', 'bump', 'snap'...\n   */\n  moveBy(dx: number, dy: number, reason?: string[]): void;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IAutoHideable\n\nimport type {IComponent} from './i_component.js';\n\n/**\n * Interface for a component that can be automatically hidden.\n */\nexport interface IAutoHideable extends IComponent {\n  /**\n   * Hides the component. Called in WorkspaceSvg.hideChaff.\n   *\n   * @param onlyClosePopups Whether only popups should be closed.\n   *   Flyouts should not be closed if this is true.\n   */\n  autoHide(onlyClosePopups: boolean): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IASTNodeLocationWithBlock\n\nimport type {IASTNodeLocation} from './i_ast_node_location.js';\nimport type {Block} from '../block.js';\n\n/**\n * An AST node location that has an associated block.\n */\nexport interface IASTNodeLocationWithBlock extends IASTNodeLocation {\n  /**\n   * Get the source block associated with this node.\n   *\n   * @returns The source block.\n   */\n  getSourceBlock(): Block | null;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IASTNodeLocationSvg\n\nimport type {IASTNodeLocation} from './i_ast_node_location.js';\n\n/**\n * An AST node location SVG interface.\n */\nexport interface IASTNodeLocationSvg extends IASTNodeLocation {\n  /**\n   * Add the marker SVG to this node's SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the SVG group.\n   */\n  setMarkerSvg(markerSvg: SVGElement | null): void;\n\n  /**\n   * Add the cursor SVG to this node's SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the SVG group.\n   */\n  setCursorSvg(cursorSvg: SVGElement | null): void;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// Former goog.module ID: Blockly.IASTNodeLocation\n\n/**\n * An AST node location interface.\n */\nexport interface IASTNodeLocation {}\n"]}